# Comparing `tmp/Geoarchpy-1.0.4.tar.gz` & `tmp/Geoarchpy-1.0.5.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "Geoarchpy-1.0.4.tar", last modified: Sun Oct 15 15:33:07 2023, max compression
+gzip compressed data, was "Geoarchpy-1.0.5.tar", last modified: Wed Jan  3 13:47:50 2024, max compression
```

## Comparing `Geoarchpy-1.0.4.tar` & `Geoarchpy-1.0.5.tar`

### file list

```diff
@@ -1,24 +1,24 @@
-drwxrwxrwx   0        0        0        0 2023-10-15 15:33:07.019722 Geoarchpy-1.0.4/
-drwxrwxrwx   0        0        0        0 2023-10-15 15:33:06.997701 Geoarchpy-1.0.4/ArchPy/
--rw-rw-rw-   0        0        0      157 2023-07-07 11:41:30.000000 Geoarchpy-1.0.4/ArchPy/__init__.py
--rw-rw-rw-   0        0        0      110 2023-10-15 15:10:53.000000 Geoarchpy-1.0.4/ArchPy/_version.py
--rw-rw-rw-   0        0        0     7245 2023-10-06 13:45:03.000000 Geoarchpy-1.0.4/ArchPy/automatic_pile.py
--rw-rw-rw-   0        0        0   287852 2023-10-15 14:30:30.000000 Geoarchpy-1.0.4/ArchPy/base.py
--rw-rw-rw-   0        0        0     3560 2023-06-13 06:37:51.000000 Geoarchpy-1.0.4/ArchPy/data_transfo.py
--rw-rw-rw-   0        0        0    29742 2023-07-10 12:07:46.000000 Geoarchpy-1.0.4/ArchPy/ineq.py
--rw-rw-rw-   0        0        0    29206 2023-06-20 11:25:31.000000 Geoarchpy-1.0.4/ArchPy/infer.py
--rw-rw-rw-   0        0        0    58723 2023-08-30 08:55:16.000000 Geoarchpy-1.0.4/ArchPy/inputs.py
--rw-rw-rw-   0        0        0     5667 2023-08-29 19:24:34.000000 Geoarchpy-1.0.4/ArchPy/parallel.py
--rw-rw-rw-   0        0        0    33566 2023-06-28 09:00:20.000000 Geoarchpy-1.0.4/ArchPy/tpgs.py
--rw-rw-rw-   0        0        0    30140 2023-08-30 07:37:31.000000 Geoarchpy-1.0.4/ArchPy/x_valid.py
-drwxrwxrwx   0        0        0        0 2023-10-15 15:33:07.016718 Geoarchpy-1.0.4/Geoarchpy.egg-info/
--rw-rw-rw-   0        0        0    44642 2023-10-15 15:33:06.000000 Geoarchpy-1.0.4/Geoarchpy.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      391 2023-10-15 15:33:06.000000 Geoarchpy-1.0.4/Geoarchpy.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-10-15 15:33:06.000000 Geoarchpy-1.0.4/Geoarchpy.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0      157 2023-10-15 15:33:06.000000 Geoarchpy-1.0.4/Geoarchpy.egg-info/requires.txt
--rw-rw-rw-   0        0        0        7 2023-10-15 15:33:06.000000 Geoarchpy-1.0.4/Geoarchpy.egg-info/top_level.txt
--rw-rw-rw-   0        0        0    35823 2022-10-14 09:39:26.000000 Geoarchpy-1.0.4/LICENSE
--rw-rw-rw-   0        0        0    44642 2023-10-15 15:33:07.018720 Geoarchpy-1.0.4/PKG-INFO
--rw-rw-rw-   0        0        0     2737 2023-10-15 15:14:03.000000 Geoarchpy-1.0.4/README.md
--rw-rw-rw-   0        0        0       42 2023-10-15 15:33:07.019722 Geoarchpy-1.0.4/setup.cfg
--rw-rw-rw-   0        0        0     1325 2023-10-15 14:47:34.000000 Geoarchpy-1.0.4/setup.py
+drwxrwxrwx   0        0        0        0 2024-01-03 13:47:50.263596 Geoarchpy-1.0.5/
+drwxrwxrwx   0        0        0        0 2024-01-03 13:47:49.959596 Geoarchpy-1.0.5/ArchPy/
+-rw-rw-rw-   0        0        0      221 2024-01-03 13:35:33.000000 Geoarchpy-1.0.5/ArchPy/__init__.py
+-rw-rw-rw-   0        0        0      110 2024-01-03 13:34:51.000000 Geoarchpy-1.0.5/ArchPy/_version.py
+-rw-rw-rw-   0        0        0     7245 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/automatic_pile.py
+-rw-rw-rw-   0        0        0   288516 2024-01-03 12:37:49.000000 Geoarchpy-1.0.5/ArchPy/base.py
+-rw-rw-rw-   0        0        0     3560 2023-06-13 06:37:51.000000 Geoarchpy-1.0.5/ArchPy/data_transfo.py
+-rw-rw-rw-   0        0        0    29742 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/ineq.py
+-rw-rw-rw-   0        0        0    29206 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/infer.py
+-rw-rw-rw-   0        0        0    58723 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/inputs.py
+-rw-rw-rw-   0        0        0     5667 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/parallel.py
+-rw-rw-rw-   0        0        0    33566 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/tpgs.py
+-rw-rw-rw-   0        0        0    30140 2023-10-18 19:57:55.000000 Geoarchpy-1.0.5/ArchPy/x_valid.py
+drwxrwxrwx   0        0        0        0 2024-01-03 13:47:49.963596 Geoarchpy-1.0.5/Geoarchpy.egg-info/
+-rw-rw-rw-   0        0        0    44649 2024-01-03 13:47:49.000000 Geoarchpy-1.0.5/Geoarchpy.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      391 2024-01-03 13:47:49.000000 Geoarchpy-1.0.5/Geoarchpy.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2024-01-03 13:47:49.000000 Geoarchpy-1.0.5/Geoarchpy.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0      148 2024-01-03 13:47:49.000000 Geoarchpy-1.0.5/Geoarchpy.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        7 2024-01-03 13:47:49.000000 Geoarchpy-1.0.5/Geoarchpy.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0    35823 2022-03-14 07:36:22.000000 Geoarchpy-1.0.5/LICENSE
+-rw-rw-rw-   0        0        0    44649 2024-01-03 13:47:50.256598 Geoarchpy-1.0.5/PKG-INFO
+-rw-rw-rw-   0        0        0     2753 2024-01-03 13:37:13.000000 Geoarchpy-1.0.5/README.md
+-rw-rw-rw-   0        0        0       42 2024-01-03 13:47:50.272597 Geoarchpy-1.0.5/setup.cfg
+-rw-rw-rw-   0        0        0     1314 2024-01-03 11:11:27.000000 Geoarchpy-1.0.5/setup.py
```

### Comparing `Geoarchpy-1.0.4/ArchPy/automatic_pile.py` & `Geoarchpy-1.0.5/ArchPy/automatic_pile.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/base.py` & `Geoarchpy-1.0.5/ArchPy/base.py`

 * *Files 1% similar despite different names*

```diff
@@ -943,17049 +943,17091 @@
 00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003af0: 2020 6d65 616e 3d28 6e70 2e6d 6561 6e28    mean=(np.mean(
 00003b00: 7a70 2929 0d0a 2020 2020 2020 2020 2020  zp))..          
 00003b10: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
 00003b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00003b30: 206d 6561 6e20 3d20 6b77 6172 6773 5b22   mean = kwargs["
 00003b40: 6d65 616e 225d 0d0a 0d0a 2020 2020 2020  mean"]....      
-00003b50: 2020 2020 2020 2372 6574 7572 6e20 785f        #return x_
-00003b60: 6571 2c20 765f 6571 2c20 7849 6e65 715f  eq, v_eq, xIneq_
-00003b70: 6d69 6e2c 2076 496e 6571 5f6d 696e 2c78  min, vIneq_min,x
-00003b80: 496e 6571 5f6d 6178 2c76 496e 6571 5f6d  Ineq_max,vIneq_m
-00003b90: 6178 2c20 6d61 736b 3244 2c20 6d65 616e  ax, mask2D, mean
-00003ba0: 2c20 286e 782c 206e 7929 2c20 2873 782c  , (nx, ny), (sx,
-00003bb0: 2073 7929 2c20 286f 782c 206f 7929 0d0a   sy), (ox, oy)..
-00003bc0: 2020 2020 2020 2020 2020 2020 7369 6d3d              sim=
-00003bd0: 6763 692e 7369 6d75 6c61 7465 3244 2863  gci.simulate2D(c
-00003be0: 6f76 6d6f 6465 6c2c 2028 6e78 2c20 6e79  ovmodel, (nx, ny
-00003bf0: 292c 2028 7378 2c20 7379 292c 2028 6f78  ), (sx, sy), (ox
-00003c00: 2c20 6f79 292c 206d 6574 686f 643d 6b77  , oy), method=kw
-00003c10: 6172 6773 5b22 6b72 6967 5f74 7970 6522  args["krig_type"
-00003c20: 5d2c 206d 6561 6e3d 6d65 616e 2c0d 0a20  ], mean=mean,.. 
-00003c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c40: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00003c50: 3d78 5f65 712c 2076 3d76 5f65 712c 0d0a  =x_eq, v=v_eq,..
-00003c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c80: 7849 6e65 714d 696e 3d78 496e 6571 5f6d  xIneqMin=xIneq_m
-00003c90: 696e 2c20 7649 6e65 714d 696e 3d76 496e  in, vIneqMin=vIn
-00003ca0: 6571 5f6d 696e 2c0d 0a20 2020 2020 2020  eq_min,..       
-00003cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003cc0: 2020 2020 2020 2020 2078 496e 6571 4d61           xIneqMa
-00003cd0: 783d 7849 6e65 715f 6d61 782c 2076 496e  x=xIneq_max, vIn
-00003ce0: 6571 4d61 783d 7649 6e65 715f 6d61 782c  eqMax=vIneq_max,
-00003cf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003b50: 2020 2020 2020 2320 7365 7420 4e6f 6e65        # set None
+00003b60: 2069 6620 6e6f 2064 6174 610d 0a20 2020   if no data..   
+00003b70: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00003b80: 765f 6571 2920 3d3d 2030 3a0d 0a20 2020  v_eq) == 0:..   
+00003b90: 2020 2020 2020 2020 2020 2020 2076 5f65               v_e
+00003ba0: 713d 4e6f 6e65 0d0a 2020 2020 2020 2020  q=None..        
+00003bb0: 2020 2020 2020 2020 785f 6571 3d4e 6f6e          x_eq=Non
+00003bc0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
+00003bd0: 6620 6c65 6e28 7649 6e65 715f 6d69 6e29  f len(vIneq_min)
+00003be0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+00003bf0: 2020 2020 2020 2020 7649 6e65 715f 6d69          vIneq_mi
+00003c00: 6e3d 4e6f 6e65 0d0a 2020 2020 2020 2020  n=None..        
+00003c10: 2020 2020 2020 2020 7849 6e65 715f 6d69          xIneq_mi
+00003c20: 6e3d 4e6f 6e65 0d0a 2020 2020 2020 2020  n=None..        
+00003c30: 2020 2020 6966 206c 656e 2876 496e 6571      if len(vIneq
+00003c40: 5f6d 6178 2920 3d3d 2030 3a0d 0a20 2020  _max) == 0:..   
+00003c50: 2020 2020 2020 2020 2020 2020 2076 496e               vIn
+00003c60: 6571 5f6d 6178 3d4e 6f6e 650d 0a20 2020  eq_max=None..   
+00003c70: 2020 2020 2020 2020 2020 2020 2078 496e               xIn
+00003c80: 6571 5f6d 6178 3d4e 6f6e 650d 0a20 2020  eq_max=None..   
+00003c90: 2020 2020 2020 2020 2073 696d 3d67 6369           sim=gci
+00003ca0: 2e73 696d 756c 6174 6532 4428 636f 766d  .simulate2D(covm
+00003cb0: 6f64 656c 2c20 286e 782c 206e 7929 2c20  odel, (nx, ny), 
+00003cc0: 2873 782c 2073 7929 2c20 286f 782c 206f  (sx, sy), (ox, o
+00003cd0: 7929 2c20 6d65 7468 6f64 3d6b 7761 7267  y), method=kwarg
+00003ce0: 735b 226b 7269 675f 7479 7065 225d 2c20  s["krig_type"], 
+00003cf0: 6d65 616e 3d6d 6561 6e2c 0d0a 2020 2020  mean=mean,..    
 00003d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d10: 2020 7365 6172 6368 5261 6469 7573 5265    searchRadiusRe
-00003d20: 6c61 7469 7665 3d31 2c20 7665 7262 6f73  lative=1, verbos
-00003d30: 653d 7665 7262 6f73 652c 0d0a 2020 2020  e=verbose,..    
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 2020 2020 2020 2020 2020 2020 6e47 6962              nGib
-00003d60: 6273 5361 6d70 6c65 7250 6174 684d 696e  bsSamplerPathMin
-00003d70: 3d6b 7761 7267 735b 226e 6974 225d 2c6e  =kwargs["nit"],n
-00003d80: 4769 6262 7353 616d 706c 6572 5061 7468  GibbsSamplerPath
-00003d90: 4d61 783d 322a 6b77 6172 6773 5b22 6e69  Max=2*kwargs["ni
-00003da0: 7422 5d2c 0d0a 2020 2020 2020 2020 2020  t"],..          
-00003db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003dc0: 2020 2020 2020 2073 6565 643d 7365 6564         seed=seed
-00003dd0: 2c20 6e6e 6569 6768 626f 724d 6178 3d6b  , nneighborMax=k
-00003de0: 7761 7267 735b 226e 6d61 7822 5d2c 206e  wargs["nmax"], n
-00003df0: 7468 7265 6164 733d 6e63 7075 2c20 6d61  threads=ncpu, ma
-00003e00: 736b 3d6d 6173 6b32 4429 5b22 696d 6167  sk=mask2D)["imag
-00003e10: 6522 5d2e 7661 6c5b 302c 2030 5d0d 0a0d  e"].val[0, 0]...
-00003e20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00003e30: 6c69 7468 6f2e 4e5f 7472 616e 7366 6f3a  litho.N_transfo:
-00003e40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003e50: 2020 733d 4e53 636f 7265 5f42 7472 7366    s=NScore_Btrsf
-00003e60: 2873 696d 2e66 6c61 7474 656e 2829 2c20  (sim.flatten(), 
-00003e70: 6469 290d 0a20 2020 2020 2020 2020 2020  di)..           
-00003e80: 2020 2020 2073 3d73 2e72 6573 6861 7065       s=s.reshape
-00003e90: 286e 792c 206e 7829 0d0a 2020 2020 2020  (ny, nx)..      
-00003ea0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00003eb0: 2020 2020 2020 2020 2020 2020 2073 3d73               s=s
-00003ec0: 696d 0d0a 0d0a 2020 2020 656c 6966 206d  im....    elif m
-00003ed0: 6574 686f 642e 6c6f 7765 7228 2920 3d3d  ethod.lower() ==
-00003ee0: 2022 6d70 7322 3a0d 0a0d 0a20 2020 2020   "mps":....     
-00003ef0: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
-00003f00: 616e 6365 286b 7761 7267 735b 2254 4922  ance(kwargs["TI"
-00003f10: 5d2c 2067 656f 6e65 2e69 6d67 2e49 6d67  ], geone.img.Img
-00003f20: 292c 2022 5449 2069 7320 6e6f 7420 6120  ), "TI is not a 
-00003f30: 6765 6f6e 6520 696d 6167 6520 6f62 6a65  geone image obje
-00003f40: 6374 220d 0a0d 0a20 2020 2020 2020 2023  ct"....        #
-00003f50: 6c6f 6164 2070 6172 616d 6574 6572 730d  load parameters.
-00003f60: 0a20 2020 2020 2020 2054 493d 6b77 6172  .        TI=kwar
-00003f70: 6773 5b22 5449 225d 2023 6765 7420 5449  gs["TI"] #get TI
-00003f80: 0d0a 0d0a 2020 2020 2020 2020 2365 7874  ....        #ext
-00003f90: 7261 6374 2068 6172 6420 6461 7461 0d0a  ract hard data..
-00003fa0: 2020 2020 2020 2020 6571 5f64 3d6e 702e          eq_d=np.
-00003fb0: 636f 6e63 6174 656e 6174 6528 5b78 5f65  concatenate([x_e
-00003fc0: 712c 2030 2e35 2a6e 702e 6f6e 6573 285b  q, 0.5*np.ones([
-00003fd0: 765f 6571 2e73 6861 7065 5b30 5d2c 2031  v_eq.shape[0], 1
-00003fe0: 5d29 2c20 765f 6571 2e72 6573 6861 7065  ]), v_eq.reshape
-00003ff0: 282d 312c 2031 292c 206e 702e 6e61 6e2a  (-1, 1), np.nan*
-00004000: 6e70 2e6f 6e65 7328 5b76 5f65 712e 7368  np.ones([v_eq.sh
-00004010: 6170 655b 305d 2c20 325d 295d 2c20 6178  ape[0], 2])], ax
-00004020: 6973 3d31 290d 0a20 2020 2020 2020 2069  is=1)..        i
-00004030: 6620 6c65 6e28 6c69 7468 6f2e 696e 6571  f len(litho.ineq
-00004040: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
-00004050: 2020 2020 2073 7570 5f64 203d 204e 6f6e       sup_d = Non
-00004060: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-00004070: 6e66 5f64 203d 204e 6f6e 650d 0a20 2020  nf_d = None..   
-00004080: 2020 2020 2020 2020 2061 6c6c 5f64 6174           all_dat
-00004090: 6120 3d20 6571 5f64 0d0a 0d0a 2020 2020  a = eq_d....    
-000040a0: 2020 2020 2020 2020 7661 726e 616d 653d          varname=
-000040b0: 5b27 7827 2c20 2779 272c 2027 7a27 2c20  ['x', 'y', 'z', 
-000040c0: 2763 6f64 6527 5d20 2320 6c69 7374 206f  'code'] # list o
-000040d0: 6620 7661 7269 6162 6c65 206e 616d 6573  f variable names
-000040e0: 0d0a 2020 2020 2020 2020 2020 2020 6864  ..            hd
-000040f0: 203d 2061 6c6c 5f64 6174 615b 3a2c 203a   = all_data[:, :
-00004100: 345d 2e54 0d0a 2020 2020 2020 2020 2020  4].T..          
-00004110: 2020 7074 203d 2069 6d67 2e50 6f69 6e74    pt = img.Point
-00004120: 5365 7428 6e70 743d 6864 2e73 6861 7065  Set(npt=hd.shape
-00004130: 5b31 5d2c 206e 763d 342c 2076 616c 3d68  [1], nv=4, val=h
-00004140: 642c 2076 6172 6e61 6d65 3d76 6172 6e61  d, varname=varna
-00004150: 6d65 290d 0a0d 0a20 2020 2020 2020 2065  me)....        e
-00004160: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00004170: 2020 7375 705f 643d 6e70 2e63 6f6e 6361    sup_d=np.conca
-00004180: 7465 6e61 7465 285b 7849 6e65 715f 6d61  tenate([xIneq_ma
-00004190: 782c 2030 2e35 2a6e 702e 6f6e 6573 285b  x, 0.5*np.ones([
-000041a0: 7649 6e65 715f 6d61 782e 7368 6170 655b  vIneq_max.shape[
-000041b0: 305d 2c20 315d 292c 206e 702e 6e61 6e2a  0], 1]), np.nan*
-000041c0: 6e70 2e6f 6e65 7328 5b76 496e 6571 5f6d  np.ones([vIneq_m
-000041d0: 6178 2e73 6861 7065 5b30 5d2c 2032 5d29  ax.shape[0], 2])
-000041e0: 2c20 7649 6e65 715f 6d61 782e 7265 7368  , vIneq_max.resh
-000041f0: 6170 6528 2d31 2c20 3129 5d2c 2061 7869  ape(-1, 1)], axi
-00004200: 733d 3129 0d0a 2020 2020 2020 2020 2020  s=1)..          
-00004210: 2020 696e 665f 643d 6e70 2e63 6f6e 6361    inf_d=np.conca
-00004220: 7465 6e61 7465 285b 7849 6e65 715f 6d69  tenate([xIneq_mi
-00004230: 6e2c 2030 2e35 2a6e 702e 6f6e 6573 285b  n, 0.5*np.ones([
-00004240: 7649 6e65 715f 6d69 6e2e 7368 6170 655b  vIneq_min.shape[
-00004250: 305d 2c20 315d 292c 206e 702e 6e61 6e2a  0], 1]), np.nan*
-00004260: 6e70 2e6f 6e65 7328 5b76 496e 6571 5f6d  np.ones([vIneq_m
-00004270: 696e 2e73 6861 7065 5b30 5d2c 2031 5d29  in.shape[0], 1])
-00004280: 2c20 7649 6e65 715f 6d69 6e2e 7265 7368  , vIneq_min.resh
-00004290: 6170 6528 2d31 2c20 3129 2c20 6e70 2e6e  ape(-1, 1), np.n
-000042a0: 616e 2a6e 702e 6f6e 6573 285b 7649 6e65  an*np.ones([vIne
-000042b0: 715f 6d69 6e2e 7368 6170 655b 305d 2c20  q_min.shape[0], 
-000042c0: 315d 295d 2c20 6178 6973 3d31 290d 0a20  1])], axis=1).. 
-000042d0: 2020 2020 2020 2020 2020 2061 6c6c 5f64             all_d
-000042e0: 6174 613d 6e70 2e63 6f6e 6361 7465 6e61  ata=np.concatena
-000042f0: 7465 285b 6571 5f64 2c20 7375 705f 642c  te([eq_d, sup_d,
-00004300: 2069 6e66 5f64 5d29 0d0a 0d0a 2020 2020   inf_d])....    
-00004310: 2020 2020 2020 2020 7661 726e 616d 653d          varname=
-00004320: 5b27 7827 2c20 2779 272c 2027 7a27 2c20  ['x', 'y', 'z', 
-00004330: 2763 6f64 6527 2c20 2763 6f64 655f 6d69  'code', 'code_mi
-00004340: 6e27 2c20 2763 6f64 655f 6d61 7827 5d20  n', 'code_max'] 
-00004350: 2320 6c69 7374 206f 6620 7661 7269 6162  # list of variab
-00004360: 6c65 206e 616d 6573 0d0a 2020 2020 2020  le names..      
-00004370: 2020 2020 2020 6864 3d61 6c6c 5f64 6174        hd=all_dat
-00004380: 612e 540d 0a20 2020 2020 2020 2020 2020  a.T..           
-00004390: 2070 743d 696d 672e 506f 696e 7453 6574   pt=img.PointSet
-000043a0: 286e 7074 3d68 642e 7368 6170 655b 315d  (npt=hd.shape[1]
-000043b0: 2c20 6e76 3d36 2c20 7661 6c3d 6864 2c20  , nv=6, val=hd, 
-000043c0: 7661 726e 616d 653d 7661 726e 616d 6529  varname=varname)
-000043d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000043e0: 2364 6566 696e 6520 6d6f 6465 2028 6f6e  #define mode (on
-000043f0: 6c79 2072 6573 6361 6c69 6e67 206d 696e  ly rescaling min
-00004400: 2d6d 6178 290d 0a20 2020 2020 2020 2020  -max)..         
-00004410: 2020 2069 6620 6b77 6172 6773 5b22 5461     if kwargs["Ta
-00004420: 7267 6574 4d69 6e22 5d20 6973 204e 6f6e  rgetMin"] is Non
-00004430: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00004440: 2020 2020 6b77 6172 6773 5b22 5461 7267      kwargs["Targ
-00004450: 6574 4d69 6e22 5d3d 6e70 2e6e 616e 6d69  etMin"]=np.nanmi
-00004460: 6e28 616c 6c5f 6461 7461 5b3a 2c33 3a20  n(all_data[:,3: 
-00004470: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00004480: 6966 206b 7761 7267 735b 2254 6172 6765  if kwargs["Targe
-00004490: 744d 6178 225d 2069 7320 4e6f 6e65 3a0d  tMax"] is None:.
-000044a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000044b0: 206b 7761 7267 735b 2254 6172 6765 744d   kwargs["TargetM
-000044c0: 696e 225d 3d6e 702e 6e61 6e6d 6178 2861  in"]=np.nanmax(a
-000044d0: 6c6c 5f64 6174 615b 3a2c 333a 205d 290d  ll_data[:,3: ]).
-000044e0: 0a0d 0a20 2020 2020 2020 2023 4453 2072  ...        #DS r
-000044f0: 6573 6561 7263 680d 0a20 2020 2020 2020  esearch..       
-00004500: 2073 6e70 3d64 7369 2e53 6561 7263 684e   snp=dsi.SearchN
-00004510: 6569 6768 626f 7268 6f6f 6450 6172 616d  eighborhoodParam
-00004520: 6574 6572 7328 0d0a 2020 2020 2020 2020  eters(..        
-00004530: 2020 2020 7261 6469 7573 4d6f 6465 3d6b      radiusMode=k
-00004540: 7761 7267 735b 2272 6164 6975 734d 6f64  wargs["radiusMod
-00004550: 6522 5d2c 2072 783d 6b77 6172 6773 5b22  e"], rx=kwargs["
-00004560: 7278 225d 2c20 7279 3d6b 7761 7267 735b  rx"], ry=kwargs[
-00004570: 2272 7922 5d2c 2072 7a3d 6b77 6172 6773  "ry"], rz=kwargs
-00004580: 5b22 727a 225d 2c0d 0a20 2020 2020 2020  ["rz"],..       
-00004590: 2020 2020 2061 6e69 736f 7472 6f70 7952       anisotropyR
-000045a0: 6174 696f 4d6f 6465 3d6b 7761 7267 735b  atioMode=kwargs[
-000045b0: 2261 6e69 736f 7472 6f70 7952 6174 696f  "anisotropyRatio
-000045c0: 4d6f 6465 225d 2c20 6178 3d6b 7761 7267  Mode"], ax=kwarg
-000045d0: 735b 2261 7822 5d2c 2061 793d 6b77 6172  s["ax"], ay=kwar
-000045e0: 6773 5b22 6179 225d 2c20 617a 3d6b 7761  gs["ay"], az=kwa
-000045f0: 7267 735b 2261 7a22 5d2c 0d0a 2020 2020  rgs["az"],..    
-00004600: 2020 2020 2020 2020 616e 676c 6531 3d6b          angle1=k
-00004610: 7761 7267 735b 2261 6e67 6c65 3122 5d2c  wargs["angle1"],
-00004620: 2061 6e67 6c65 323d 6b77 6172 6773 5b22   angle2=kwargs["
-00004630: 616e 676c 6532 225d 2c20 616e 676c 6533  angle2"], angle3
-00004640: 3d6b 7761 7267 735b 2261 6e67 6c65 3322  =kwargs["angle3"
-00004650: 5d29 0d0a 0d0a 2020 2020 2020 2020 2344  ])....        #D
-00004660: 5320 696e 7075 740d 0a20 2020 2020 2020  S input..       
-00004670: 2064 6565 7373 655f 696e 7075 743d 6473   deesse_input=ds
-00004680: 692e 4465 6573 7365 496e 7075 7428 0d0a  i.DeesseInput(..
-00004690: 2020 2020 2020 2020 2020 2020 6e78 3d6e              nx=n
-000046a0: 782c 206e 793d 6e79 2c20 6e7a 3d31 2c20  x, ny=ny, nz=1, 
-000046b0: 2020 2020 2020 2320 6469 6d65 6e73 696f        # dimensio
-000046c0: 6e20 6f66 2074 6865 2073 696d 756c 6174  n of the simulat
-000046d0: 696f 6e20 6772 6964 2028 6e75 6d62 6572  ion grid (number
-000046e0: 206f 6620 6365 6c6c 7329 0d0a 2020 2020   of cells)..    
-000046f0: 2020 2020 2020 2020 7378 3d73 782c 2073          sx=sx, s
-00004700: 793d 7379 2c20 737a 3d31 2c20 2020 2020  y=sy, sz=1,     
-00004710: 2320 6365 6c6c 7320 756e 6974 7320 696e  # cells units in
-00004720: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
-00004730: 6772 6964 2028 6865 7265 2061 7265 2074  grid (here are t
-00004740: 6865 2064 6566 6175 6c74 2076 616c 7565  he default value
-00004750: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00004760: 6f78 3d6f 782c 206f 793d 6f79 2c20 6f7a  ox=ox, oy=oy, oz
-00004770: 3d30 2e35 2c20 2020 2020 2320 6f72 6967  =0.5,     # orig
-00004780: 696e 206f 6620 7468 6520 7369 6d75 6c61  in of the simula
-00004790: 7469 6f6e 2067 7269 6420 2868 6572 6520  tion grid (here 
-000047a0: 6172 6520 7468 6520 6465 6661 756c 7420  are the default 
-000047b0: 7661 6c75 6573 290d 0a20 2020 2020 2020  values)..       
-000047c0: 2020 2020 206e 763d 312c 2076 6172 6e61       nv=1, varna
-000047d0: 6d65 3d27 636f 6465 272c 2020 2020 2020  me='code',      
-000047e0: 2023 206e 756d 6265 7220 6f66 2076 6172   # number of var
-000047f0: 6961 626c 6528 7329 2c20 6e61 6d65 206f  iable(s), name o
-00004800: 6620 7468 6520 7661 7269 6162 6c65 2873  f the variable(s
-00004810: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00004820: 5449 3d31 2c20 5449 3d54 492c 2020 2020  TI=1, TI=TI,    
-00004830: 2020 2020 2020 2020 2023 206e 756d 6265           # numbe
-00004840: 7220 6f66 2054 4928 7329 2c20 5449 2028  r of TI(s), TI (
-00004850: 636c 6173 7320 6473 692e 496d 6729 0d0a  class dsi.Img)..
-00004860: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00004870: 506f 696e 7453 6574 3d70 742c 2020 2020  PointSet=pt,    
-00004880: 2020 2020 2020 2020 2320 6861 7264 2064          # hard d
-00004890: 6174 6120 286f 7074 696f 6e61 6c29 0d0a  ata (optional)..
-000048a0: 2020 2020 2020 2020 2020 2020 7365 6172              sear
-000048b0: 6368 4e65 6967 6862 6f72 686f 6f64 5061  chNeighborhoodPa
-000048c0: 7261 6d65 7465 7273 3d73 6e70 2c0d 0a20  rameters=snp,.. 
-000048d0: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
-000048e0: 6865 7479 5573 6167 653d 6b77 6172 6773  hetyUsage=kwargs
-000048f0: 5b22 686f 6d6f 5f75 7361 6765 225d 2c0d  ["homo_usage"],.
-00004900: 0a20 2020 2020 2020 2020 2020 2068 6f6d  .            hom
-00004910: 6f74 6865 7479 584c 6f63 616c 3d6b 7761  othetyXLocal=kwa
-00004920: 7267 735b 2278 6c6f 6322 5d2c 0d0a 2020  rgs["xloc"],..  
-00004930: 2020 2020 2020 2020 2020 686f 6d6f 7468            homoth
-00004940: 6574 7958 5261 7469 6f3d 6b77 6172 6773  etyXRatio=kwargs
-00004950: 5b22 7872 225d 2c0d 0a20 2020 2020 2020  ["xr"],..       
-00004960: 2020 2020 2068 6f6d 6f74 6865 7479 594c       homothetyYL
-00004970: 6f63 616c 3d6b 7761 7267 735b 2279 6c6f  ocal=kwargs["ylo
-00004980: 6322 5d2c 0d0a 2020 2020 2020 2020 2020  c"],..          
-00004990: 2020 686f 6d6f 7468 6574 7959 5261 7469    homothetyYRati
-000049a0: 6f3d 6b77 6172 6773 5b22 7972 225d 2c0d  o=kwargs["yr"],.
-000049b0: 0a20 2020 2020 2020 2020 2020 2068 6f6d  .            hom
-000049c0: 6f74 6865 7479 5a4c 6f63 616c 3d6b 7761  othetyZLocal=kwa
-000049d0: 7267 735b 227a 6c6f 6322 5d2c 0d0a 2020  rgs["zloc"],..  
-000049e0: 2020 2020 2020 2020 2020 686f 6d6f 7468            homoth
-000049f0: 6574 795a 5261 7469 6f3d 6b77 6172 6773  etyZRatio=kwargs
-00004a00: 5b22 7a72 225d 2c0d 0a20 2020 2020 2020  ["zr"],..       
-00004a10: 2020 2020 2072 6f74 6174 696f 6e55 7361       rotationUsa
-00004a20: 6765 3d6b 7761 7267 735b 2272 6f74 5f75  ge=kwargs["rot_u
-00004a30: 7361 6765 225d 2c20 2020 2020 2020 2020  sage"],         
-00004a40: 2020 2023 2074 6f6c 6572 616e 6365 206f     # tolerance o
-00004a50: 7220 6e6f 740d 0a20 2020 2020 2020 2020  r not..         
-00004a60: 2020 2072 6f74 6174 696f 6e41 7a69 6d75     rotationAzimu
-00004a70: 7468 4c6f 6361 6c3d 6b77 6172 6773 5b22  thLocal=kwargs["
-00004a80: 726f 7441 7a69 4c6f 6322 5d2c 2023 2020  rotAziLoc"], #  
-00004a90: 2020 726f 7461 7469 6f6e 2061 6363 6f72    rotation accor
-00004aa0: 6469 6e67 2074 6f20 617a 696d 7574 683a  ding to azimuth:
-00004ab0: 2067 6c6f 6261 6c0d 0a20 2020 2020 2020   global..       
-00004ac0: 2020 2020 2072 6f74 6174 696f 6e41 7a69       rotationAzi
-00004ad0: 6d75 7468 3d6b 7761 7267 735b 2272 6f74  muth=kwargs["rot
-00004ae0: 417a 6922 5d2c 0d0a 2020 2020 2020 2020  Azi"],..        
-00004af0: 2020 2020 726f 7461 7469 6f6e 4469 704c      rotationDipL
-00004b00: 6f63 616c 3d6b 7761 7267 735b 2272 6f74  ocal=kwargs["rot
-00004b10: 4469 704c 6f63 225d 2c0d 0a20 2020 2020  DipLoc"],..     
-00004b20: 2020 2020 2020 2072 6f74 6174 696f 6e44         rotationD
-00004b30: 6970 3d6b 7761 7267 735b 2272 6f74 4469  ip=kwargs["rotDi
-00004b40: 7022 5d2c 0d0a 2020 2020 2020 2020 2020  p"],..          
-00004b50: 2020 726f 7461 7469 6f6e 506c 756e 6765    rotationPlunge
-00004b60: 4c6f 6361 6c3d 6b77 6172 6773 5b22 726f  Local=kwargs["ro
-00004b70: 7450 6c75 6e67 654c 6f63 225d 2c0d 0a20  tPlungeLoc"],.. 
-00004b80: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
-00004b90: 696f 6e50 6c75 6e67 653d 6b77 6172 6773  ionPlunge=kwargs
-00004ba0: 5b22 726f 7450 6c75 6e67 6522 5d2c 0d0a  ["rotPlunge"],..
-00004bb0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00004bc0: 616e 6365 5479 7065 3d27 636f 6e74 696e  anceType='contin
-00004bd0: 756f 7573 272c 2023 2064 6973 7461 6e63  uous', # distanc
-00004be0: 6520 7479 7065 3a20 7072 6f70 6f72 7469  e type: proporti
-00004bf0: 6f6e 206f 6620 6d69 736d 6174 6368 696e  on of mismatchin
-00004c00: 6720 6e6f 6465 7320 2863 6174 6567 6f72  g nodes (categor
-00004c10: 6963 616c 2076 6172 2e2c 2064 6566 6175  ical var., defau
-00004c20: 6c74 290d 0a20 2020 2020 2020 2020 2020  lt)..           
-00004c30: 2072 656c 6174 6976 6544 6973 7461 6e63   relativeDistanc
-00004c40: 6546 6c61 673d 6b77 6172 6773 5b22 7265  eFlag=kwargs["re
-00004c50: 6c61 7469 7665 4469 7374 616e 6365 466c  lativeDistanceFl
-00004c60: 6167 225d 2c0d 0a20 2020 2020 2020 2020  ag"],..         
-00004c70: 2020 2072 6573 6361 6c69 6e67 4d6f 6465     rescalingMode
-00004c80: 3d6b 7761 7267 735b 2272 6573 6361 6c69  =kwargs["rescali
-00004c90: 6e67 4d6f 6465 225d 2c0d 0a20 2020 2020  ngMode"],..     
-00004ca0: 2020 2020 2020 2072 6573 6361 6c69 6e67         rescaling
-00004cb0: 5461 7267 6574 4d69 6e3d 6b77 6172 6773  TargetMin=kwargs
-00004cc0: 5b22 5461 7267 6574 4d69 6e22 5d2c 2023  ["TargetMin"], #
-00004cd0: 206d 696e 206f 6620 7468 6520 7461 7267   min of the targ
-00004ce0: 6574 2069 6e74 6572 7661 6c0d 0a20 2020  et interval..   
-00004cf0: 2020 2020 2020 2020 2072 6573 6361 6c69           rescali
-00004d00: 6e67 5461 7267 6574 4d61 783d 6b77 6172  ngTargetMax=kwar
-00004d10: 6773 5b22 5461 7267 6574 4d61 7822 5d2c  gs["TargetMax"],
-00004d20: 2023 6d61 7820 6f66 2074 6865 2074 6172   #max of the tar
-00004d30: 6765 7420 696e 7465 7276 616c 0d0a 2020  get interval..  
-00004d40: 2020 2020 2020 2020 2020 7265 7363 616c            rescal
-00004d50: 696e 6754 6172 6765 744d 6561 6e3d 6b77  ingTargetMean=kw
-00004d60: 6172 6773 5b22 5461 7267 6574 4d65 616e  args["TargetMean
-00004d70: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
-00004d80: 2072 6573 6361 6c69 6e67 5461 7267 6574   rescalingTarget
-00004d90: 4c65 6e67 7468 3d6b 7761 7267 735b 2254  Length=kwargs["T
-00004da0: 6172 6765 744c 656e 6774 6822 5d2c 0d0a  argetLength"],..
-00004db0: 2020 2020 2020 2020 2020 2020 6e6e 6569              nnei
-00004dc0: 6768 626f 7269 6e67 4e6f 6465 3d6b 7761  ghboringNode=kwa
-00004dd0: 7267 735b 226e 6569 6722 5d2c 2020 2020  rgs["neig"],    
-00004de0: 2020 2020 2320 6d61 782e 206e 756d 6265      # max. numbe
-00004df0: 7220 6f66 206e 6569 6768 626f 7273 2028  r of neighbors (
-00004e00: 666f 7220 7468 6520 7061 7474 6572 6e73  for the patterns
-00004e10: 290d 0a20 2020 2020 2020 2020 2020 2064  )..            d
-00004e20: 6973 7461 6e63 6554 6872 6573 686f 6c64  istanceThreshold
-00004e30: 3d6b 7761 7267 735b 2274 6872 6573 6822  =kwargs["thresh"
-00004e40: 5d2c 2020 2020 2023 2061 6363 6570 7461  ],     # accepta
-00004e50: 7469 6f6e 2074 6872 6573 686f 6c64 2028  tion threshold (
-00004e60: 666f 7220 6469 7374 616e 6365 2062 6574  for distance bet
-00004e70: 7765 656e 2070 6174 7465 726e 7329 0d0a  ween patterns)..
-00004e80: 2020 2020 2020 2020 2020 2020 6d61 7853              maxS
-00004e90: 6361 6e46 7261 6374 696f 6e3d 6b77 6172  canFraction=kwar
-00004ea0: 6773 5b22 6d61 7873 6361 6e22 5d2c 2020  gs["maxscan"],  
-00004eb0: 2020 2020 2023 206d 6178 2e20 7363 616e       # max. scan
-00004ec0: 6e65 6420 6672 6163 7469 6f6e 206f 6620  ned fraction of 
-00004ed0: 7468 6520 5449 2028 666f 7220 7369 6d75  the TI (for simu
-00004ee0: 6c61 7469 6f6e 206f 6620 6561 6368 2063  lation of each c
-00004ef0: 656c 6c29 0d0a 2020 2020 2020 2020 2020  ell)..          
-00004f00: 2020 7365 6564 3d6e 702e 7261 6e64 6f6d    seed=np.random
-00004f10: 2e72 616e 6469 6e74 2831 6536 292c 0d0a  .randint(1e6),..
-00004f20: 2020 2020 2020 2020 2020 2020 6e70 6f73              npos
-00004f30: 7450 726f 6365 7373 696e 6750 6174 684d  tProcessingPathM
-00004f40: 6178 3d31 2c20 2020 2320 6e75 6d62 6572  ax=1,   # number
-00004f50: 206f 6620 706f 7374 2d70 726f 6365 7373   of post-process
-00004f60: 696e 6720 7061 7468 2873 290d 0a20 2020  ing path(s)..   
-00004f70: 2020 2020 2020 2020 206e 7265 616c 697a           nrealiz
-00004f80: 6174 696f 6e3d 3129 2020 2020 2020 2020  ation=1)        
-00004f90: 2020 2320 6e75 6d62 6572 206f 6620 7265    # number of re
-00004fa0: 616c 697a 6174 696f 6e28 7329 290d 0a0d  alization(s))...
-00004fb0: 0a20 2020 2020 2020 2023 2052 756e 2064  .        # Run d
-00004fc0: 6565 7373 650d 0a20 2020 2020 2020 2064  eesse..        d
-00004fd0: 6565 7373 655f 6f75 7470 7574 3d64 7369  eesse_output=dsi
-00004fe0: 2e64 6565 7373 6552 756e 2864 6565 7373  .deesseRun(deess
-00004ff0: 655f 696e 7075 742c 206e 7468 7265 6164  e_input, nthread
-00005000: 733d 6e63 7075 2c20 7665 7262 6f73 653d  s=ncpu, verbose=
-00005010: 3229 0d0a 2020 2020 2020 2020 7369 6d3d  2)..        sim=
-00005020: 6465 6573 7365 5f6f 7574 7075 745b 2273  deesse_output["s
-00005030: 696d 225d 5b30 5d0d 0a20 2020 2020 2020  im"][0]..       
-00005040: 2073 3d73 696d 2e76 616c 5b30 2c30 5d0d   s=sim.val[0,0].
-00005050: 0a0d 0a20 2020 2065 6c73 653a 0d0a 2020  ...    else:..  
-00005060: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00005070: 6545 7272 6f72 2028 2263 686f 6f73 6520  eError ("choose 
-00005080: 7072 6f70 6572 2069 6e74 6572 706f 6c61  proper interpola
-00005090: 7469 6f6e 206d 6574 686f 6422 290d 0a0d  tion method")...
-000050a0: 0a20 2020 2072 6574 7572 6e20 730d 0a0d  .    return s...
-000050b0: 0a64 6566 2073 706c 6974 5f6c 6f67 7328  .def split_logs(
-000050c0: 6268 293a 0d0a 0d0a 2020 2020 2222 220d  bh):....    """.
-000050d0: 0a20 2020 2054 616b 6520 6120 7261 7720  .    Take a raw 
-000050e0: 626f 7265 686f 6c65 2077 6974 6820 6869  borehole with hi
-000050f0: 6572 6172 6368 6963 616c 2075 6e69 7473  erarchical units
-00005100: 206d 6978 6564 0d0a 2020 2020 616e 6420   mixed..    and 
-00005110: 736f 7274 2074 6865 6d20 6279 2067 726f  sort them by gro
-00005120: 7570 2061 6e64 2068 6965 7261 7263 6879  up and hierarchy
-00005130: 2e0d 0a0d 0a20 2020 2050 6172 616d 6574  .....    Paramet
-00005140: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
-00005150: 2d2d 2d0d 0a20 2020 2062 683a 203a 7079  ---..    bh: :py
-00005160: 3a63 6c61 7373 3a60 626f 7265 686f 6c65  :class:`borehole
-00005170: 6020 6f62 6a65 6374 0d0a 0d0a 2020 2020  ` object....    
-00005180: 5265 7475 726e 730d 0a20 2020 202d 2d2d  Returns..    ---
-00005190: 2d2d 2d2d 0d0a 2020 2020 6c69 7374 0d0a  ----..    list..
-000051a0: 2020 2020 2020 2020 4120 6c69 7374 206f          A list o
-000051b0: 6620 6e65 7720 626f 7265 686f 6c65 730d  f new boreholes.
-000051c0: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
-000051d0: 6c5f 6268 733d 5b5d 0d0a 2020 2020 6c5f  l_bhs=[]..    l_
-000051e0: 6c6f 6773 3d5b 5d20 236c 6973 7420 6f66  logs=[] #list of
-000051f0: 206c 6f67 730d 0a20 2020 2062 6849 443d   logs..    bhID=
-00005200: 6268 2e49 440d 0a20 2020 2062 6878 2c20  bh.ID..    bhx, 
-00005210: 6268 792c 2062 687a 2c20 6465 7074 683d  bhy, bhz, depth=
-00005220: 6268 2e78 2c20 6268 2e79 2c20 6268 2e7a  bh.x, bh.y, bh.z
-00005230: 2c20 6268 2e64 6570 7468 0d0a 2020 2020  , bh.depth..    
-00005240: 6c6f 675f 733d 6268 2e6c 6f67 5f73 7472  log_s=bh.log_str
-00005250: 6174 690d 0a0d 0a0d 0a20 2020 206c 5f6c  ati......    l_l
-00005260: 6f67 733d 5b5d 0d0a 0d0a 2020 2020 236c  ogs=[]....    #l
-00005270: 6f67 7320 7374 7261 7469 730d 0a20 2020  ogs stratis..   
-00005280: 2068 5f6d 6178 3d6d 6178 285b 695b 305d   h_max=max([i[0]
-00005290: 2e67 6574 5f68 5f6c 6576 656c 2829 2066  .get_h_level() f
-000052a0: 6f72 2069 2069 6e20 6c6f 675f 7320 6966  or i in log_s if
-000052b0: 2069 5b30 5d20 6973 206e 6f74 204e 6f6e   i[0] is not Non
-000052c0: 655d 290d 0a20 2020 2066 6f72 2069 2069  e])..    for i i
-000052d0: 6e20 7261 6e67 6528 685f 6d61 7829 3a0d  n range(h_max):.
-000052e0: 0a20 2020 2020 2020 206c 5f6c 6f67 732e  .        l_logs.
-000052f0: 6170 7065 6e64 285b 5d29 0d0a 0d0a 2020  append([])....  
-00005300: 2020 6465 6620 6269 6475 6c65 2873 2c20    def bidule(s, 
-00005310: 685f 6c65 7629 3a0d 0a0d 0a20 2020 2020  h_lev):....     
-00005320: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00005330: 5265 6375 7273 6976 6520 6f70 6572 6174  Recursive operat
-00005340: 696f 6e20 746f 2069 6465 6e74 6966 6979  ion to identifiy
-00005350: 206c 6f67 2073 7472 6174 6920 6174 206c   log strati at l
-00005360: 6f77 6572 206f 7264 6572 206c 6576 656c  ower order level
-00005370: 2066 726f 6d20 6869 6768 6572 206c 6576   from higher lev
-00005380: 656c 732e 0d0a 2020 2020 2020 2020 4966  els...        If
-00005390: 2069 6e20 6120 626f 7265 686f 6c65 2077   in a borehole w
-000053a0: 6974 6820 6120 6365 7274 6169 6e20 7375  ith a certain su
-000053b0: 6273 7562 756e 6974 2028 652e 672e 2042  bsubunit (e.g. B
-000053c0: 3131 292c 2074 6869 7320 696e 666f 726d  11), this inform
-000053d0: 6174 696f 6e20 6d75 7374 2062 6520 616c  ation must be al
-000053e0: 736f 2074 7261 6e73 6665 7220 746f 2075  so transfer to u
-000053f0: 6e69 7420 4231 2061 6e64 2042 0d0a 2020  nit B1 and B..  
-00005400: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-00005410: 696f 6e20 646f 6573 2074 6861 7420 2849  ion does that (I
-00005420: 2067 7565 7373 2e2e 2e29 0d0a 2020 2020   guess...)..    
-00005430: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00005440: 200d 0a20 2020 2020 2020 2069 6620 685f   ..        if h_
-00005450: 6c65 7620 3e20 313a 0d0a 2020 2020 2020  lev > 1:..      
-00005460: 2020 2020 2020 6966 2073 2069 6e20 5b69        if s in [i
-00005470: 5b30 5d20 666f 7220 6920 696e 206c 5f6c  [0] for i in l_l
-00005480: 6f67 735b 685f 6c65 762d 315d 5d3a 2020  ogs[h_lev-1]]:  
-00005490: 2320 7375 625f 756e 6974 2061 6c72 6561  # sub_unit alrea
-000054a0: 6479 2070 7265 7365 6e74 0d0a 2020 2020  dy present..    
-000054b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000054c0: 203d 3d20 6c5f 6c6f 6773 5b68 5f6c 6576   == l_logs[h_lev
-000054d0: 2d31 5d5b 2d31 5d5b 305d 3a20 2023 206c  -1][-1][0]:  # l
-000054e0: 6173 7420 756e 6974 2061 6464 6564 2069  ast unit added i
-000054f0: 7320 7468 6520 7361 6d65 202d 2d3e 2061  s the same --> a
-00005500: 6461 7074 2062 6f74 0d0a 2020 2020 2020  dapt bot..      
-00005510: 2020 2020 2020 2020 2020 2020 2020 6c5f                l_
-00005520: 6c6f 6773 5b68 5f6c 6576 2d31 5d5b 2d31  logs[h_lev-1][-1
-00005530: 5d5b 2d31 5d3d 626f 7420 2023 2063 6861  ][-1]=bot  # cha
-00005540: 6e67 6520 626f 740d 0a20 2020 2020 2020  nge bot..       
-00005550: 2020 2020 2020 2020 2065 6c69 6620 732e           elif s.
-00005560: 6d75 6d6d 795f 756e 6974 2e53 7562 5069  mummy_unit.SubPi
-00005570: 6c65 2e6e 6174 7572 6520 3d3d 2022 3364  le.nature == "3d
-00005580: 5f63 6174 6567 6f72 6963 616c 223a 0d0a  _categorical":..
-00005590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000055a0: 2020 2020 6c5f 6c6f 6773 5b68 5f6c 6576      l_logs[h_lev
-000055b0: 2d31 5d2e 6170 7065 6e64 285b 732c 2074  -1].append([s, t
-000055c0: 6f70 2c20 626f 745d 2920 2023 2075 6e69  op, bot])  # uni
-000055d0: 7420 616c 7265 6164 7920 7072 6573 656e  t already presen
-000055e0: 7420 6275 740d 0a20 2020 2020 2020 2020  t but..         
-000055f0: 2020 2065 6c69 6620 7320 6e6f 7420 696e     elif s not in
-00005600: 205b 695b 305d 2066 6f72 2069 2069 6e20   [i[0] for i in 
-00005610: 6c5f 6c6f 6773 5b68 5f6c 6576 2d31 5d5d  l_logs[h_lev-1]]
-00005620: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00005630: 2020 206c 5f6c 6f67 735b 685f 6c65 762d     l_logs[h_lev-
-00005640: 315d 2e61 7070 656e 6428 5b73 2c20 746f  1].append([s, to
-00005650: 702c 2062 6f74 5d29 0d0a 2020 2020 2020  p, bot])..      
-00005660: 2020 2020 2020 685f 6c65 7620 2d3d 2031        h_lev -= 1
-00005670: 0d0a 2020 2020 2020 2020 2020 2020 6269  ..            bi
-00005680: 6475 6c65 2873 2e6d 756d 6d79 5f75 6e69  dule(s.mummy_uni
-00005690: 742c 2068 5f6c 6576 290d 0a20 2020 2020  t, h_lev)..     
-000056a0: 2020 2065 6c69 6620 685f 6c65 7620 3d3d     elif h_lev ==
-000056b0: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-000056c0: 2069 6620 7320 6e6f 7420 696e 205b 695b   if s not in [i[
-000056d0: 305d 2066 6f72 2069 2069 6e20 6c5f 6c6f  0] for i in l_lo
-000056e0: 6773 5b68 5f6c 6576 2d31 5d5d 3a20 2023  gs[h_lev-1]]:  #
-000056f0: 2061 6464 2075 6e69 7420 6f6e 6c79 2069   add unit only i
-00005700: 6620 6974 2773 206e 6f74 2069 6e20 6c6f  f it's not in lo
-00005710: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-00005720: 2020 206c 5f6c 6f67 735b 685f 6c65 762d     l_logs[h_lev-
-00005730: 315d 2e61 7070 656e 6428 5b73 2c20 746f  1].append([s, to
-00005740: 705d 290d 0a0d 0a20 2020 2066 6f72 2069  p])....    for i
-00005750: 2069 6e20 7261 6e67 6528 6c65 6e28 6c6f   in range(len(lo
-00005760: 675f 7329 293a 0d0a 2020 2020 2020 2020  g_s)):..        
-00005770: 733d 6c6f 675f 735b 695d 2023 6765 7420  s=log_s[i] #get 
-00005780: 756e 6974 2061 6e64 2063 6f6e 7461 6374  unit and contact
-00005790: 0d0a 2020 2020 2020 2020 6966 2069 203d  ..        if i =
-000057a0: 3d20 6c65 6e28 6c6f 675f 7329 2d31 3a20  = len(log_s)-1: 
-000057b0: 2369 6620 6c61 7374 2075 6e69 740d 0a20  #if last unit.. 
-000057c0: 2020 2020 2020 2020 2020 2062 6f74 203d             bot =
-000057d0: 2062 687a 202d 2064 6570 7468 0d0a 2020   bhz - depth..  
-000057e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000057f0: 2020 2020 2020 2020 2073 5f61 6674 203d           s_aft =
-00005800: 206c 6f67 5f73 5b69 2b31 5d0d 0a20 2020   log_s[i+1]..   
-00005810: 2020 2020 2020 2020 2062 6f74 203d 2073           bot = s
-00005820: 5f61 6674 5b31 5d0d 0a20 2020 2020 2020  _aft[1]..       
-00005830: 2075 6e69 743d 735b 305d 2023 6765 7420   unit=s[0] #get 
-00005840: 756e 6974 0d0a 2020 2020 2020 2020 6966  unit..        if
-00005850: 2075 6e69 7420 6973 206e 6f74 204e 6f6e   unit is not Non
-00005860: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00005870: 685f 6c65 763d 756e 6974 2e67 6574 5f68  h_lev=unit.get_h
-00005880: 5f6c 6576 656c 2829 0d0a 2020 2020 2020  _level()..      
-00005890: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000058a0: 2020 2020 2068 5f6c 6576 3d31 0d0a 2020       h_lev=1..  
-000058b0: 2020 2020 2020 746f 7020 3d73 5b31 5d0d        top =s[1].
-000058c0: 0a0d 0a20 2020 2020 2020 2069 6620 685f  ...        if h_
-000058d0: 6c65 7620 3d3d 2031 3a0d 0a20 2020 2020  lev == 1:..     
-000058e0: 2020 2020 2020 206c 5f6c 6f67 735b 685f         l_logs[h_
-000058f0: 6c65 762d 315d 2e61 7070 656e 6428 5b75  lev-1].append([u
-00005900: 6e69 742c 2074 6f70 5d29 0d0a 2020 2020  nit, top])..    
-00005910: 2020 2020 656c 6966 2068 5f6c 6576 203e      elif h_lev >
-00005920: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00005930: 2062 6964 756c 6528 756e 6974 2c20 685f   bidule(unit, h_
-00005940: 6c65 7629 0d0a 0d0a 2020 2020 2331 7374  lev)....    #1st
-00005950: 206f 7264 6572 206c 6f67 0d0a 2020 2020   order log..    
-00005960: 6268 3d62 6f72 6568 6f6c 6528 6268 4944  bh=borehole(bhID
-00005970: 2c20 6268 4944 2c20 6268 782c 2062 6879  , bhID, bhx, bhy
-00005980: 2c20 6268 7a2c 2064 6570 7468 2c20 6c6f  , bhz, depth, lo
-00005990: 675f 7374 7261 7469 3d6c 5f6c 6f67 735b  g_strati=l_logs[
-000059a0: 305d 2c20 6c6f 675f 6661 6369 6573 3d62  0], log_facies=b
-000059b0: 682e 6c6f 675f 6661 6369 6573 2920 2320  h.log_facies) # 
-000059c0: 6669 7273 7420 626f 7265 686f 6c65 0d0a  first borehole..
-000059d0: 2020 2020 6c5f 6268 732e 6170 7065 6e64      l_bhs.append
-000059e0: 2862 6829 0d0a 0d0a 2020 2020 2332 2061  (bh)....    #2 a
-000059f0: 6e64 206d 6f72 6520 6f72 6465 7220 6c6f  nd more order lo
-00005a00: 6773 0d0a 2020 2020 666f 7220 6c6f 6720  gs..    for log 
-00005a10: 696e 206c 5f6c 6f67 735b 313a 205d 3a20  in l_logs[1: ]: 
-00005a20: 236c 6f6f 7020 6f76 6572 2064 6966 6665  #loop over diffe
-00005a30: 7265 6e74 206c 6f67 7320 6869 6572 6172  rent logs hierar
-00005a40: 6368 7920 6c65 7665 6c73 0d0a 2020 2020  chy levels..    
-00005a50: 2020 2020 695f 303d 300d 0a20 2020 2020      i_0=0..     
-00005a60: 2020 2069 6620 6c65 6e28 6c6f 6729 203e     if len(log) >
-00005a70: 2031 3a20 236d 6f72 6520 7468 616e 2031   1: #more than 1
-00005a80: 2075 6e69 7420 6973 2070 7265 7365 6e74   unit is present
-00005a90: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00005aa0: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-00005ab0: 6c65 6e28 6c6f 6729 293a 0d0a 2020 2020  len(log)):..    
-00005ac0: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-00005ad0: 3d6c 6f67 5b69 2d31 5d5b 305d 0d0a 2020  =log[i-1][0]..  
-00005ae0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00005af0: 6974 5f61 6674 6572 3d6c 6f67 5b69 5d5b  it_after=log[i][
-00005b00: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00005b10: 2020 2020 6966 2075 6e69 742e 6d75 6d6d      if unit.mumm
-00005b20: 795f 756e 6974 2021 3d20 756e 6974 5f61  y_unit != unit_a
-00005b30: 6674 6572 2e6d 756d 6d79 5f75 6e69 743a  fter.mummy_unit:
-00005b40: 2020 2320 6368 6563 6b20 7468 6174 2074    # check that t
-00005b50: 776f 2073 7563 6365 7373 6976 6520 756e  wo successive un
-00005b60: 6974 7320 646f 6573 206e 6f74 2062 656c  its does not bel
-00005b70: 6f6e 6720 746f 2074 6865 2073 616d 6520  ong to the same 
-00005b80: 6869 6572 6172 6368 6963 2067 726f 7570  hierarchic group
-00005b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00005ba0: 2020 2020 2020 6e65 775f 6c6f 673d 6c6f        new_log=lo
-00005bb0: 675b 695f 303a 2069 5d0d 0a20 2020 2020  g[i_0: i]..     
-00005bc0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00005bd0: 6570 7468 3d6e 6577 5f6c 6f67 5b30 5d5b  epth=new_log[0][
-00005be0: 315d 202d 206e 6577 5f6c 6f67 5b2d 315d  1] - new_log[-1]
-00005bf0: 5b32 5d0d 0a20 2020 2020 2020 2020 2020  [2]..           
-00005c00: 2020 2020 2020 2020 206c 6f67 5f73 7472           log_str
-00005c10: 6174 693d 5b73 5b3a 202d 315d 2066 6f72  ati=[s[: -1] for
-00005c20: 2073 2069 6e20 6e65 775f 6c6f 675d 0d0a   s in new_log]..
-00005c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005c40: 2020 2020 6268 3d62 6f72 6568 6f6c 6528      bh=borehole(
-00005c50: 7374 7228 6268 4944 292b 225f 222b 756e  str(bhID)+"_"+un
-00005c60: 6974 2e6e 616d 652c 2073 7472 2862 6849  it.name, str(bhI
-00005c70: 4429 2b22 5f22 2b75 6e69 742e 6e61 6d65  D)+"_"+unit.name
-00005c80: 2c20 6268 782c 2062 6879 2c20 6c6f 675f  , bhx, bhy, log_
-00005c90: 7374 7261 7469 5b30 5d5b 315d 2c20 6465  strati[0][1], de
-00005ca0: 7074 682c 206c 6f67 5f73 7472 6174 693d  pth, log_strati=
-00005cb0: 6c6f 675f 7374 7261 7469 290d 0a20 2020  log_strati)..   
-00005cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005cd0: 206c 5f62 6873 2e61 7070 656e 6428 6268   l_bhs.append(bh
-00005ce0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00005cf0: 2020 2020 2020 2069 5f30 3d69 0d0a 2020         i_0=i..  
-00005d00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00005d10: 2069 203d 3d20 6c65 6e28 6c6f 6729 2d31   i == len(log)-1
-00005d20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00005d30: 2020 2020 2020 206e 6577 5f6c 6f67 3d6c         new_log=l
-00005d40: 6f67 5b69 5f30 3a20 5d0d 0a20 2020 2020  og[i_0: ]..     
-00005d50: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00005d60: 6570 7468 3d6e 6577 5f6c 6f67 5b30 5d5b  epth=new_log[0][
-00005d70: 315d 202d 206e 6577 5f6c 6f67 5b2d 315d  1] - new_log[-1]
-00005d80: 5b32 5d0d 0a20 2020 2020 2020 2020 2020  [2]..           
-00005d90: 2020 2020 2020 2020 206c 6f67 5f73 7472           log_str
-00005da0: 6174 693d 5b73 5b3a 202d 315d 2066 6f72  ati=[s[: -1] for
-00005db0: 2073 2069 6e20 6e65 775f 6c6f 675d 0d0a   s in new_log]..
-00005dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005dd0: 2020 2020 6268 3d62 6f72 6568 6f6c 6528      bh=borehole(
-00005de0: 7374 7228 6268 4944 292b 225f 222b 756e  str(bhID)+"_"+un
-00005df0: 6974 5f61 6674 6572 2e6e 616d 652c 2073  it_after.name, s
-00005e00: 7472 2862 6849 4429 2b22 5f22 2b75 6e69  tr(bhID)+"_"+uni
-00005e10: 745f 6166 7465 722e 6e61 6d65 2c20 6268  t_after.name, bh
-00005e20: 782c 2062 6879 2c20 6c6f 675f 7374 7261  x, bhy, log_stra
-00005e30: 7469 5b30 5d5b 315d 2c0d 0a20 2020 2020  ti[0][1],..     
-00005e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e50: 2020 2020 2020 2020 2020 2020 2064 6570               dep
-00005e60: 7468 2c20 6c6f 675f 7374 7261 7469 3d6c  th, log_strati=l
-00005e70: 6f67 5f73 7472 6174 6929 0d0a 2020 2020  og_strati)..    
-00005e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e90: 6c5f 6268 732e 6170 7065 6e64 2862 6829  l_bhs.append(bh)
-00005ea0: 0d0a 0d0a 2020 2020 2020 2020 656c 7365  ....        else
-00005eb0: 3a0d 0a20 2020 2020 2020 2020 2020 2075  :..            u
-00005ec0: 6e69 743d 6c6f 675b 305d 5b30 5d0d 0a20  nit=log[0][0].. 
-00005ed0: 2020 2020 2020 2020 2020 2064 6570 7468             depth
-00005ee0: 3d6c 6f67 5b30 5d5b 315d 202d 206c 6f67  =log[0][1] - log
-00005ef0: 5b2d 315d 5b32 5d0d 0a20 2020 2020 2020  [-1][2]..       
-00005f00: 2020 2020 206c 6f67 5f73 7472 6174 693d       log_strati=
-00005f10: 5b73 5b3a 202d 315d 2066 6f72 2073 2069  [s[: -1] for s i
-00005f20: 6e20 6c6f 675d 0d0a 2020 2020 2020 2020  n log]..        
-00005f30: 2020 2020 6268 3d62 6f72 6568 6f6c 6528      bh=borehole(
-00005f40: 7374 7228 6268 4944 292b 225f 222b 756e  str(bhID)+"_"+un
-00005f50: 6974 2e6e 616d 652c 2073 7472 2862 6849  it.name, str(bhI
-00005f60: 4429 2b22 5f22 2b75 6e69 742e 6e61 6d65  D)+"_"+unit.name
-00005f70: 2c20 6268 782c 2062 6879 2c20 6c6f 675f  , bhx, bhy, log_
-00005f80: 7374 7261 7469 5b30 5d5b 315d 2c0d 0a20  strati[0][1],.. 
-00005f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fa0: 2020 2020 2020 2020 2064 6570 7468 2c20           depth, 
-00005fb0: 6c6f 675f 7374 7261 7469 3d6c 6f67 5f73  log_strati=log_s
-00005fc0: 7472 6174 6929 0d0a 2020 2020 2020 2020  trati)..        
-00005fd0: 2020 2020 6c5f 6268 732e 6170 7065 6e64      l_bhs.append
-00005fe0: 2862 6829 0d0a 0d0a 2020 2020 7265 7475  (bh)....    retu
-00005ff0: 726e 206c 5f62 6873 0d0a 0d0a 6465 6620  rn l_bhs....def 
-00006000: 7275 6e6e 696e 675f 6d65 616e 5f32 4428  running_mean_2D(
-00006010: 782c 204e 293a 0d0a 0d0a 2020 2020 2222  x, N):....    ""
-00006020: 220d 0a20 2020 2053 6d6f 6f74 6820 6120  "..    Smooth a 
-00006030: 3264 2073 7572 6661 6365 0d0a 0d0a 2020  2d surface....  
-00006040: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00006050: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00006060: 2020 783a 2032 4420 6e64 6172 7261 790d    x: 2D ndarray.
-00006070: 0a20 2020 2020 2020 2041 7272 6179 2074  .        Array t
-00006080: 6f20 736d 6f6f 7468 0d0a 2020 2020 4e3a  o smooth..    N:
-00006090: 2069 6e74 0d0a 2020 2020 2020 2020 5769   int..        Wi
-000060a0: 6e64 6f77 2073 656d 692d 7369 7a65 0d0a  ndow semi-size..
-000060b0: 0d0a 2020 2020 5265 7475 726e 730d 0a20  ..    Returns.. 
-000060c0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-000060d0: 3244 206e 6461 7272 6179 0d0a 2020 2020  2D ndarray..    
-000060e0: 2222 220d 0a0d 0a20 2020 2073 3d78 2e63  """....    s=x.c
-000060f0: 6f70 7928 290d 0a20 2020 2073 3d75 6e69  opy()..    s=uni
-00006100: 666f 726d 5f66 696c 7465 7228 732c 2073  form_filter(s, s
-00006110: 697a 653d 4e2c 206d 6f64 653d 2272 6566  ize=N, mode="ref
-00006120: 6c65 6374 2229 0d0a 0d0a 2020 2020 7265  lect")....    re
-00006130: 7475 726e 2073 0d0a 0d0a 0d0a 2323 2323  turn s......####
-00006140: 2323 2320 434c 4153 5345 5320 2323 2323  ### CLASSES ####
-00006150: 2323 2323 0d0a 636c 6173 7320 4172 6368  ####..class Arch
-00006160: 5f74 6162 6c65 2829 3a0d 0a0d 0a20 2020  _table():....   
-00006170: 2022 2222 0d0a 0d0a 2020 2020 4d61 6a6f   """....    Majo
-00006180: 7220 636c 6173 7320 6f66 2041 7263 6850  r class of ArchP
-00006190: 792e 2041 7263 685f 7461 626c 6520 6973  y. Arch_table is
-000061a0: 2074 6865 2063 656e 7472 616c 206f 626a   the central obj
-000061b0: 6563 740d 0a20 2020 2074 6861 7420 6361  ect..    that ca
-000061c0: 6e20 6265 2061 7373 696d 696c 6174 6564  n be assimilated
-000061d0: 2061 7320 6120 2270 726f 6a65 6374 222e   as a "project".
-000061e0: 0d0a 2020 2020 5072 6163 7469 6361 6c6c  ..    Practicall
-000061f0: 7920 6576 6572 7920 6f70 6572 6174 696f  y every operatio
-00006200: 6e73 2061 7265 2064 6f6e 6520 7573 696e  ns are done usin
-00006210: 6720 616e 2041 7263 685f 7461 626c 650d  g an Arch_table.
-00006220: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00006230: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
-00006240: 2d0d 0a20 2020 206e 616d 653a 2073 7472  -..    name: str
-00006250: 0d0a 2020 2020 2020 2020 4e61 6d65 206f  ..        Name o
-00006260: 6620 7468 6520 7072 6f6a 6563 740d 0a20  f the project.. 
-00006270: 2020 2077 6f72 6b69 6e67 5f64 6972 6563     working_direc
-00006280: 746f 7279 3a20 7374 720d 0a20 2020 2020  tory: str..     
-00006290: 2020 2050 6174 6820 746f 2074 6865 2077     Path to the w
-000062a0: 6f72 6b69 6e67 2064 6972 6563 746f 7279  orking directory
-000062b0: 0d0a 2020 2020 7365 6564 3a20 696e 740d  ..    seed: int.
-000062c0: 0a20 2020 2020 2020 2053 6565 6420 666f  .        Seed fo
-000062d0: 7220 7261 6e64 6f6d 206e 756d 6265 7220  r random number 
-000062e0: 6765 6e65 7261 7469 6f6e 0d0a 2020 2020  generation..    
-000062f0: 7772 6974 655f 7265 7375 6c74 733a 2062  write_results: b
-00006300: 6f6f 6c0d 0a20 2020 2020 2020 2049 6620  ool..        If 
-00006310: 5472 7565 2c20 7265 7375 6c74 7320 7769  True, results wi
-00006320: 6c6c 2062 6520 7772 6974 7465 6e20 746f  ll be written to
-00006330: 2064 6973 6b0d 0a20 2020 2066 696c 6c5f   disk..    fill_
-00006340: 666c 6167 3a20 626f 6f6c 0d0a 2020 2020  flag: bool..    
-00006350: 2020 2020 4966 2054 7275 652c 2074 6865      If True, the
-00006360: 2074 6f70 2075 6e69 7420 7769 6c6c 2062   top unit will b
-00006370: 6520 6669 6c6c 6564 2077 6974 6820 7468  e filled with th
-00006380: 6520 6d6f 7374 2063 6f6d 6d6f 6e20 6661  e most common fa
-00006390: 6369 6573 0d0a 2020 2020 7665 7262 6f73  cies..    verbos
-000063a0: 653a 2069 6e74 0d0a 2020 2020 2020 2020  e: int..        
-000063b0: 5665 7262 6f73 6974 7920 6c65 7665 6c0d  Verbosity level.
-000063c0: 0a20 2020 206e 6370 753a 2069 6e74 0d0a  .    ncpu: int..
-000063d0: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
-000063e0: 6620 6370 7573 2074 6f20 7573 6520 666f  f cpus to use fo
-000063f0: 7220 7061 7261 6c6c 656c 206f 7065 7261  r parallel opera
-00006400: 7469 6f6e 732c 2069 6620 2d31 2c20 616c  tions, if -1, al
-00006410: 6c20 6370 7573 2077 696c 6c20 6265 2075  l cpus will be u
-00006420: 7365 640d 0a0d 0a20 2020 2022 2222 0d0a  sed....    """..
-00006430: 0d0a 0d0a 2020 2020 6465 6620 5f5f 696e  ....    def __in
-00006440: 6974 5f5f 2873 656c 662c 206e 616d 652c  it__(self, name,
-00006450: 2077 6f72 6b69 6e67 5f64 6972 6563 746f   working_directo
-00006460: 7279 3d22 4172 6368 5079 5f77 6f72 6b73  ry="ArchPy_works
-00006470: 7061 6365 222c 2073 6565 643d 6e70 2e72  pace", seed=np.r
-00006480: 616e 646f 6d2e 7261 6e64 696e 7428 3165  andom.randint(1e
-00006490: 3629 2c20 7772 6974 655f 7265 7375 6c74  6), write_result
-000064a0: 733d 4661 6c73 652c 2066 696c 6c5f 666c  s=False, fill_fl
-000064b0: 6167 3d46 616c 7365 2c20 7665 7262 6f73  ag=False, verbos
-000064c0: 653d 312c 206e 6370 753d 2d31 293a 0d0a  e=1, ncpu=-1):..
-000064d0: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000064e0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-000064f0: 652c 2022 4120 6e61 6d65 206d 7573 7420  e, "A name must 
-00006500: 6265 2070 726f 7669 6465 6422 0d0a 2020  be provided"..  
-00006510: 2020 2020 2020 2320 7075 7420 6173 7365        # put asse
-00006520: 7274 2073 6565 640d 0a0d 0a20 2020 2020  rt seed....     
-00006530: 2020 2073 656c 662e 6e61 6d65 3d6e 616d     self.name=nam
-00006540: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-00006550: 7773 3d77 6f72 6b69 6e67 5f64 6972 6563  ws=working_direc
-00006560: 746f 7279 2020 2377 6f72 6b69 6e67 2064  tory  #working d
-00006570: 6972 6563 7479 2077 6865 7265 2066 696c  irecty where fil
-00006580: 6573 2077 696c 6c20 6265 2063 7265 6174  es will be creat
-00006590: 6564 0d0a 2020 2020 2020 2020 7365 6c66  ed..        self
-000065a0: 2e6c 6973 745f 616c 6c5f 756e 6974 733d  .list_all_units=
-000065b0: 5b5d 0d0a 2020 2020 2020 2020 7365 6c66  []..        self
-000065c0: 2e6c 6973 745f 616c 6c5f 6661 6369 6573  .list_all_facies
-000065d0: 3d5b 5d0d 0a20 2020 2020 2020 2073 656c  =[]..        sel
-000065e0: 662e 6c69 7374 5f62 6873 3d5b 5d20 2320  f.list_bhs=[] # 
-000065f0: 6c69 7374 206f 6620 626f 7265 686f 6c65  list of borehole
-00006600: 7320 666f 7220 6864 0d0a 2020 2020 2020  s for hd..      
-00006610: 2020 7365 6c66 2e6c 6973 745f 6661 6b65    self.list_fake
-00006620: 5f62 6873 3d5b 5d20 2320 6c69 7374 206f  _bhs=[] # list o
-00006630: 6620 2266 616b 6522 2062 6f72 6568 6f6c  f "fake" borehol
-00006640: 6573 0d0a 2020 2020 2020 2020 7365 6c66  es..        self
-00006650: 2e6c 6973 745f 6d61 705f 6268 733d 5b5d  .list_map_bhs=[]
-00006660: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-00006670: 746f 5f68 6420 3d20 5b5d 2020 2320 7374  to_hd = []  # st
-00006680: 6f63 6861 7374 6963 2068 6172 6420 6461  ochastic hard da
-00006690: 7461 0d0a 2020 2020 2020 2020 7365 6c66  ta..        self
-000066a0: 2e6c 6973 745f 7072 6f70 733d 5b5d 0d0a  .list_props=[]..
-000066b0: 2020 2020 2020 2020 7365 6c66 2e73 6565          self.see
-000066c0: 643d 696e 7428 3165 362a 7365 6564 290d  d=int(1e6*seed).
-000066d0: 0a20 2020 2020 2020 2073 656c 662e 7665  .        self.ve
-000066e0: 7262 6f73 653d 7665 7262 6f73 6520 2023  rbose=verbose  #
-000066f0: 2030 3a20 7072 696e 7420 2871 7561 7369   0: print (quasi
-00006700: 292d 6e6f 7468 696e 672c 2031 3a20 7072  )-nothing, 1: pr
-00006710: 696e 7420 6576 6572 7974 6869 6e67 0d0a  int everything..
-00006720: 2020 2020 2020 2020 7365 6c66 2e6e 6370          self.ncp
-00006730: 753d 6e63 7075 0d0a 2020 2020 2020 2020  u=ncpu..        
-00006740: 7365 6c66 2e78 673d 4e6f 6e65 0d0a 2020  self.xg=None..  
-00006750: 2020 2020 2020 7365 6c66 2e79 673d 4e6f        self.yg=No
-00006760: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
-00006770: 2e7a 673d 4e6f 6e65 0d0a 2020 2020 2020  .zg=None..      
-00006780: 2020 7365 6c66 2e78 6763 203d 4e6f 6e65    self.xgc =None
-00006790: 0d0a 2020 2020 2020 2020 7365 6c66 2e79  ..        self.y
-000067a0: 6763 3d4e 6f6e 650d 0a20 2020 2020 2020  gc=None..       
-000067b0: 2073 656c 662e 7a67 633d 4e6f 6e65 0d0a   self.zgc=None..
-000067c0: 2020 2020 2020 2020 7365 6c66 2e73 783d          self.sx=
-000067d0: 4e6f 6e65 0d0a 2020 2020 2020 2020 7365  None..        se
-000067e0: 6c66 2e73 793d 4e6f 6e65 0d0a 2020 2020  lf.sy=None..    
-000067f0: 2020 2020 7365 6c66 2e73 7a3d 4e6f 6e65      self.sz=None
-00006800: 0d0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
-00006810: 783d 4e6f 6e65 0d0a 2020 2020 2020 2020  x=None..        
-00006820: 7365 6c66 2e6f 793d 4e6f 6e65 0d0a 2020  self.oy=None..  
-00006830: 2020 2020 2020 7365 6c66 2e6f 7a3d 4e6f        self.oz=No
-00006840: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
-00006850: 2e6e 783d 4e6f 6e65 0d0a 2020 2020 2020  .nx=None..      
-00006860: 2020 7365 6c66 2e6e 793d 4e6f 6e65 0d0a    self.ny=None..
-00006870: 2020 2020 2020 2020 7365 6c66 2e6e 7a3d          self.nz=
-00006880: 4e6f 6e65 0d0a 2020 2020 2020 2020 7365  None..        se
-00006890: 6c66 2e50 696c 655f 6d61 7374 6572 3d4e  lf.Pile_master=N
-000068a0: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
-000068b0: 662e 6765 6f6c 5f6d 6170 3d4e 6f6e 650d  f.geol_map=None.
-000068c0: 0a20 2020 2020 2020 2073 656c 662e 7772  .        self.wr
-000068d0: 6974 655f 7265 7375 6c74 733d 7772 6974  ite_results=writ
-000068e0: 655f 7265 7375 6c74 730d 0a20 2020 2020  e_results..     
-000068f0: 2020 2073 656c 662e 6268 735f 7072 6f63     self.bhs_proc
-00006900: 6573 7365 643d 3020 2023 2066 6c61 6720  essed=0  # flag 
-00006910: 746f 206b 6e6f 7720 6966 2062 6f72 6568  to know if boreh
-00006920: 6f6c 6573 2068 6176 6520 6265 656e 2070  oles have been p
-00006930: 726f 6365 7373 6564 0d0a 2020 2020 2020  rocessed..      
-00006940: 2020 7365 6c66 2e73 7572 6661 6365 735f    self.surfaces_
-00006950: 636f 6d70 7574 6564 3d30 0d0a 2020 2020  computed=0..    
-00006960: 2020 2020 7365 6c66 2e66 6163 6965 735f      self.facies_
-00006970: 636f 6d70 7574 6564 3d30 0d0a 2020 2020  computed=0..    
-00006980: 2020 2020 7365 6c66 2e70 726f 705f 636f      self.prop_co
-00006990: 6d70 7574 6564 3d30 0d0a 2020 2020 2020  mputed=0..      
-000069a0: 2020 7365 6c66 2e6e 7265 616c 5f75 6e69    self.nreal_uni
-000069b0: 7473 3d30 0d0a 2020 2020 2020 2020 7365  ts=0..        se
-000069c0: 6c66 2e6e 7265 616c 5f66 613d 300d 0a20  lf.nreal_fa=0.. 
-000069d0: 2020 2020 2020 2073 656c 662e 6e72 6561         self.nrea
-000069e0: 6c5f 7072 6f70 3d30 0d0a 2020 2020 2020  l_prop=0..      
-000069f0: 2020 7365 6c66 2e66 696c 6c5f 666c 6167    self.fill_flag
-00006a00: 203d 2066 696c 6c5f 666c 6167 0d0a 2020   = fill_flag..  
-00006a10: 2020 2020 2020 7365 6c66 2e47 656f 6c3d        self.Geol=
-00006a20: 4765 6f6c 2829 0d0a 0d0a 2020 2020 2367  Geol()....    #g
-00006a30: 6574 2066 756e 6374 696f 6e73 0d0a 2020  et functions..  
-00006a40: 2020 6465 6620 6765 745f 7069 6c65 5f6d    def get_pile_m
-00006a50: 6173 7465 7228 7365 6c66 293a 0d0a 0d0a  aster(self):....
-00006a60: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00006a70: 2020 2020 2052 6574 7572 6e73 2074 6865       Returns the
-00006a80: 2050 696c 655f 6d61 7374 6572 206f 626a   Pile_master obj
-00006a90: 6563 740d 0a20 2020 2020 2020 2022 2222  ect..        """
-00006aa0: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
-00006ab0: 656c 662e 5069 6c65 5f6d 6173 7465 7220  elf.Pile_master 
-00006ac0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00006ad0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00006ae0: 6545 7272 6f72 2028 224e 6f20 5069 6c65  eError ("No Pile
-00006af0: 206d 6173 7465 7220 6465 6669 6e65 6420   master defined 
-00006b00: 666f 7220 4172 6368 2054 6162 6c65 207b  for Arch Table {
-00006b10: 7d22 2e66 6f72 6d61 7428 7365 6c66 2e6e  }".format(self.n
-00006b20: 616d 6529 290d 0a20 2020 2020 2020 2072  ame))..        r
-00006b30: 6574 7572 6e20 7365 6c66 2e50 696c 655f  eturn self.Pile_
-00006b40: 6d61 7374 6572 0d0a 0d0a 2020 2020 6465  master....    de
-00006b50: 6620 6765 745f 7867 2873 656c 6629 3a0d  f get_xg(self):.
-00006b60: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00006b70: 726e 7320 7468 6520 6564 6765 7320 6f66  rns the edges of
-00006b80: 2074 6865 2067 7269 6420 696e 2078 2064   the grid in x d
-00006b90: 6972 6563 7469 6f6e 2222 220d 0a20 2020  irection"""..   
-00006ba0: 2020 2020 2069 6620 7365 6c66 2e78 6720       if self.xg 
-00006bb0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00006bc0: 2020 2020 2020 6173 7365 7274 2030 2c20        assert 0, 
-00006bd0: 2827 4572 726f 723a 2047 7269 6420 7761  ('Error: Grid wa
-00006be0: 7320 6e6f 7420 6164 6465 6427 290d 0a20  s not added').. 
-00006bf0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00006c00: 6c66 2e78 670d 0a0d 0a20 2020 2064 6566  lf.xg....    def
-00006c10: 2067 6574 5f79 6728 7365 6c66 293a 0d0a   get_yg(self):..
-00006c20: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00006c30: 6e73 2074 6865 2065 6467 6573 206f 6620  ns the edges of 
-00006c40: 7468 6520 6772 6964 2069 6e20 7920 6469  the grid in y di
-00006c50: 7265 6374 696f 6e22 2222 0d0a 2020 2020  rection"""..    
-00006c60: 2020 2020 6966 2073 656c 662e 7967 2069      if self.yg i
-00006c70: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-00006c80: 2020 2020 2061 7373 6572 7420 302c 2028       assert 0, (
-00006c90: 2745 7272 6f72 3a20 4772 6964 2077 6173  'Error: Grid was
-00006ca0: 206e 6f74 2061 6464 6564 2729 0d0a 2020   not added')..  
-00006cb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00006cc0: 662e 7967 0d0a 0d0a 2020 2020 6465 6620  f.yg....    def 
-00006cd0: 6765 745f 7a67 2873 656c 6629 3a0d 0a20  get_zg(self):.. 
-00006ce0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00006cf0: 7320 7468 6520 6564 6765 7320 6f66 2074  s the edges of t
-00006d00: 6865 2067 7269 6420 696e 207a 2064 6972  he grid in z dir
-00006d10: 6563 7469 6f6e 2222 220d 0a20 2020 2020  ection"""..     
-00006d20: 2020 2069 6620 7365 6c66 2e7a 6720 6973     if self.zg is
-00006d30: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00006d40: 2020 2020 6173 7365 7274 2030 2c20 2827      assert 0, ('
-00006d50: 4572 726f 723a 2047 7269 6420 7761 7320  Error: Grid was 
-00006d60: 6e6f 7420 6164 6465 6427 290d 0a20 2020  not added')..   
-00006d70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00006d80: 2e7a 670d 0a0d 0a20 2020 2064 6566 2067  .zg....    def g
-00006d90: 6574 5f78 6763 2873 656c 6629 3a0d 0a20  et_xgc(self):.. 
-00006da0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00006db0: 7320 7468 6520 6365 6e74 6572 7320 6f66  s the centers of
-00006dc0: 2074 6865 2067 7269 6420 696e 2078 2064   the grid in x d
-00006dd0: 6972 6563 7469 6f6e 2222 220d 0a20 2020  irection"""..   
-00006de0: 2020 2020 2069 6620 7365 6c66 2e78 6763       if self.xgc
-00006df0: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00006e00: 2020 2020 2020 2061 7373 6572 7420 302c         assert 0,
-00006e10: 2028 2745 7272 6f72 3a20 4772 6964 2077   ('Error: Grid w
-00006e20: 6173 206e 6f74 2061 6464 6564 2729 0d0a  as not added')..
-00006e30: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00006e40: 656c 662e 7867 630d 0a0d 0a20 2020 2064  elf.xgc....    d
-00006e50: 6566 2067 6574 5f79 6763 2873 656c 6629  ef get_ygc(self)
-00006e60: 3a0d 0a20 2020 2020 2020 2022 2222 5265  :..        """Re
-00006e70: 7475 726e 7320 7468 6520 6365 6e74 6572  turns the center
-00006e80: 7320 6f66 2074 6865 2067 7269 6420 696e  s of the grid in
-00006e90: 2079 2064 6972 6563 7469 6f6e 2222 220d   y direction""".
-00006ea0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00006eb0: 2e79 6763 2069 7320 4e6f 6e65 3a0d 0a20  .ygc is None:.. 
-00006ec0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00006ed0: 7420 302c 2028 2745 7272 6f72 3a20 4772  t 0, ('Error: Gr
-00006ee0: 6964 2077 6173 206e 6f74 2061 6464 6564  id was not added
-00006ef0: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
-00006f00: 726e 2073 656c 662e 7967 630d 0a0d 0a20  rn self.ygc.... 
-00006f10: 2020 2064 6566 2067 6574 5f7a 6763 2873     def get_zgc(s
-00006f20: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-00006f30: 2222 5265 7475 726e 7320 7468 6520 6365  ""Returns the ce
-00006f40: 6e74 6572 7320 6f66 2074 6865 2067 7269  nters of the gri
-00006f50: 6420 696e 207a 2064 6972 6563 7469 6f6e  d in z direction
-00006f60: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-00006f70: 7365 6c66 2e7a 6720 6973 204e 6f6e 653a  self.zg is None:
-00006f80: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
-00006f90: 7365 7274 2030 2c20 2827 4572 726f 723a  sert 0, ('Error:
-00006fa0: 2047 7269 6420 7761 7320 6e6f 7420 6164   Grid was not ad
-00006fb0: 6465 6427 290d 0a20 2020 2020 2020 2072  ded')..        r
-00006fc0: 6574 7572 6e20 7365 6c66 2e7a 6763 0d0a  eturn self.zgc..
-00006fd0: 2020 2020 6465 6620 6765 745f 6e78 2873      def get_nx(s
-00006fe0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-00006ff0: 2222 5265 7475 726e 7320 7468 6520 6e75  ""Returns the nu
-00007000: 6d62 6572 206f 6620 6365 6c6c 7320 696e  mber of cells in
-00007010: 2078 2064 6972 6563 7469 6f6e 2222 220d   x direction""".
-00007020: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00007030: 2e6e 7820 6973 204e 6f6e 653a 0d0a 2020  .nx is None:..  
-00007040: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00007050: 2030 2c20 2827 4572 726f 723a 2047 7269   0, ('Error: Gri
-00007060: 6420 7761 7320 6e6f 7420 6164 6465 6427  d was not added'
-00007070: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00007080: 6e20 7365 6c66 2e6e 780d 0a0d 0a20 2020  n self.nx....   
-00007090: 2064 6566 2067 6574 5f6e 7928 7365 6c66   def get_ny(self
-000070a0: 293a 0d0a 2020 2020 2020 2020 2222 2252  ):..        """R
-000070b0: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
-000070c0: 7220 6f66 2063 656c 6c73 2069 6e20 7920  r of cells in y 
-000070d0: 6469 7265 6374 696f 6e22 2222 0d0a 2020  direction"""..  
-000070e0: 2020 2020 2020 6966 2073 656c 662e 6e79        if self.ny
-000070f0: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00007100: 2020 2020 2020 2061 7373 6572 7420 302c         assert 0,
-00007110: 2028 2745 7272 6f72 3a20 4772 6964 2077   ('Error: Grid w
-00007120: 6173 206e 6f74 2061 6464 6564 2729 0d0a  as not added')..
-00007130: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00007140: 656c 662e 6e79 0d0a 0d0a 2020 2020 6465  elf.ny....    de
-00007150: 6620 6765 745f 6e7a 2873 656c 6629 3a0d  f get_nz(self):.
-00007160: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00007170: 726e 7320 7468 6520 6e75 6d62 6572 206f  rns the number o
-00007180: 6620 6365 6c6c 7320 696e 207a 2064 6972  f cells in z dir
-00007190: 6563 7469 6f6e 2222 220d 0a20 2020 2020  ection"""..     
-000071a0: 2020 2069 6620 7365 6c66 2e6e 7a20 6973     if self.nz is
-000071b0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-000071c0: 2020 2020 6173 7365 7274 2030 2c20 2827      assert 0, ('
-000071d0: 4572 726f 723a 2047 7269 6420 7761 7320  Error: Grid was 
-000071e0: 6e6f 7420 6164 6465 6427 290d 0a20 2020  not added')..   
-000071f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00007200: 2e6e 7a0d 0a20 2020 2064 6566 2067 6574  .nz..    def get
-00007210: 5f73 7828 7365 6c66 293a 0d0a 2020 2020  _sx(self):..    
-00007220: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-00007230: 6865 2073 697a 6520 6f66 2074 6865 2063  he size of the c
-00007240: 656c 6c73 2069 6e20 7820 6469 7265 6374  ells in x direct
-00007250: 696f 6e22 2222 0d0a 2020 2020 2020 2020  ion"""..        
-00007260: 6966 2073 656c 662e 7378 2069 7320 4e6f  if self.sx is No
-00007270: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00007280: 2061 7373 6572 7420 302c 2028 2745 7272   assert 0, ('Err
-00007290: 6f72 3a20 4772 6964 2077 6173 206e 6f74  or: Grid was not
-000072a0: 2061 6464 6564 2729 0d0a 2020 2020 2020   added')..      
-000072b0: 2020 7265 7475 726e 2073 656c 662e 7378    return self.sx
-000072c0: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
-000072d0: 7379 2873 656c 6629 3a0d 0a20 2020 2020  sy(self):..     
-000072e0: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-000072f0: 6520 7369 7a65 206f 6620 7468 6520 6365  e size of the ce
-00007300: 6c6c 7320 696e 2079 2064 6972 6563 7469  lls in y directi
-00007310: 6f6e 2222 220d 0a20 2020 2020 2020 2069  on"""..        i
-00007320: 6620 7365 6c66 2e73 7920 6973 204e 6f6e  f self.sy is Non
-00007330: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00007340: 6173 7365 7274 2030 2c20 2827 4572 726f  assert 0, ('Erro
-00007350: 723a 2047 7269 6420 7761 7320 6e6f 7420  r: Grid was not 
-00007360: 6164 6465 6427 290d 0a20 2020 2020 2020  added')..       
-00007370: 2072 6574 7572 6e20 7365 6c66 2e73 790d   return self.sy.
-00007380: 0a0d 0a20 2020 2064 6566 2067 6574 5f73  ...    def get_s
-00007390: 7a28 7365 6c66 293a 0d0a 2020 2020 2020  z(self):..      
-000073a0: 2020 2222 2252 6574 7572 6e73 2074 6865    """Returns the
-000073b0: 2073 697a 6520 6f66 2074 6865 2063 656c   size of the cel
-000073c0: 6c73 2069 6e20 7a20 6469 7265 6374 696f  ls in z directio
-000073d0: 6e22 2222 0d0a 2020 2020 2020 2020 6966  n"""..        if
-000073e0: 2073 656c 662e 737a 2069 7320 4e6f 6e65   self.sz is None
-000073f0: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-00007400: 7373 6572 7420 302c 2028 2745 7272 6f72  ssert 0, ('Error
-00007410: 3a20 4772 6964 2077 6173 206e 6f74 2061  : Grid was not a
-00007420: 6464 6564 2729 0d0a 2020 2020 2020 2020  dded')..        
-00007430: 7265 7475 726e 2073 656c 662e 737a 0d0a  return self.sz..
-00007440: 0d0a 2020 2020 6465 6620 6765 745f 6f78  ..    def get_ox
-00007450: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00007460: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00007470: 6f72 6967 696e 206f 6620 7468 6520 6772  origin of the gr
-00007480: 6964 2069 6e20 7820 6469 7265 6374 696f  id in x directio
-00007490: 6e22 2222 0d0a 2020 2020 2020 2020 6966  n"""..        if
-000074a0: 2073 656c 662e 6f78 2069 7320 4e6f 6e65   self.ox is None
-000074b0: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-000074c0: 7373 6572 7420 302c 2028 2745 7272 6f72  ssert 0, ('Error
-000074d0: 3a20 4772 6964 2077 6173 206e 6f74 2061  : Grid was not a
-000074e0: 6464 6564 2729 0d0a 2020 2020 2020 2020  dded')..        
-000074f0: 7265 7475 726e 2073 656c 662e 6f78 0d0a  return self.ox..
-00007500: 0d0a 2020 2020 6465 6620 6765 745f 6f79  ..    def get_oy
-00007510: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00007520: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-00007530: 6f72 6967 696e 206f 6620 7468 6520 6772  origin of the gr
-00007540: 6964 2069 6e20 7920 6469 7265 6374 696f  id in y directio
-00007550: 6e22 2222 0d0a 2020 2020 2020 2020 6966  n"""..        if
-00007560: 2073 656c 662e 6f79 2069 7320 4e6f 6e65   self.oy is None
-00007570: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-00007580: 7373 6572 7420 302c 2028 2745 7272 6f72  ssert 0, ('Error
-00007590: 3a20 4772 6964 2077 6173 206e 6f74 2061  : Grid was not a
-000075a0: 6464 6564 2729 0d0a 2020 2020 2020 2020  dded')..        
-000075b0: 7265 7475 726e 2073 656c 662e 6f79 0d0a  return self.oy..
-000075c0: 0d0a 2020 2020 6465 6620 6765 745f 6f7a  ..    def get_oz
-000075d0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-000075e0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
-000075f0: 6f72 6967 696e 206f 6620 7468 6520 6772  origin of the gr
-00007600: 6964 2069 6e20 7a20 6469 7265 6374 696f  id in z directio
-00007610: 6e22 2222 0d0a 2020 2020 2020 2020 6966  n"""..        if
-00007620: 2073 656c 662e 6f7a 2069 7320 4e6f 6e65   self.oz is None
-00007630: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-00007640: 7373 6572 7420 302c 2028 2745 7272 6f72  ssert 0, ('Error
-00007650: 3a20 4772 6964 2077 6173 206e 6f74 2061  : Grid was not a
-00007660: 6464 6564 2729 0d0a 2020 2020 2020 2020  dded')..        
-00007670: 7265 7475 726e 2073 656c 662e 6f7a 0d0a  return self.oz..
-00007680: 0d0a 2020 2020 6465 6620 6765 745f 6661  ..    def get_fa
-00007690: 6369 6573 2873 656c 662c 2069 753d 302c  cies(self, iu=0,
-000076a0: 2069 6661 3d30 2c20 616c 6c5f 6461 7461   ifa=0, all_data
-000076b0: 3d54 7275 6529 3a0d 0a0d 0a20 2020 2020  =True):....     
-000076c0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000076d0: 5265 7475 726e 2061 206e 756d 7079 2061  Return a numpy a
-000076e0: 7272 6179 206f 6620 3120 6f72 2061 6c6c  rray of 1 or all
-000076f0: 2066 6163 6965 7320 7265 616c 697a 6174   facies realizat
-00007700: 696f 6e28 7329 2e0d 0a0d 0a20 2020 2020  ion(s).....     
-00007710: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00007720: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00007730: 2d0d 0a20 2020 2020 2020 2069 753a 2069  -..        iu: i
-00007740: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
-00007750: 756e 6974 2069 6e64 6578 0d0a 2020 2020  unit index..    
-00007760: 2020 2020 6966 613a 2069 6e74 0d0a 2020      ifa: int..  
-00007770: 2020 2020 2020 2020 2020 6661 6369 6573            facies
-00007780: 2069 6e64 6578 0d0a 2020 2020 2020 2020   index..        
-00007790: 616c 6c5f 6461 7461 3a20 626f 6f6c 0d0a  all_data: bool..
-000077a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000077b0: 726e 2061 6c6c 2074 6865 2075 6e69 7473  rn all the units
-000077c0: 2073 696d 756c 6174 696f 6e73 0d0a 0d0a   simulations....
-000077d0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-000077e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000077f0: 0d0a 2020 2020 2020 2020 6e64 6172 7261  ..        ndarra
-00007800: 790d 0a20 2020 2020 2020 2020 2020 2066  y..            f
-00007810: 6163 6965 7320 646f 6d61 696e 730d 0a20  acies domains.. 
-00007820: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00007830: 2020 2020 2020 6966 2073 656c 662e 7772        if self.wr
-00007840: 6974 655f 7265 7375 6c74 733a 0d0a 2020  ite_results:..  
-00007850: 2020 2020 2020 2020 2020 6966 2022 6664            if "fd
-00007860: 2220 6e6f 7420 696e 205b 692e 7370 6c69  " not in [i.spli
-00007870: 7428 222e 2229 5b2d 315d 2066 6f72 2069  t(".")[-1] for i
-00007880: 2069 6e20 6f73 2e6c 6973 7464 6972 2873   in os.listdir(s
-00007890: 656c 662e 7773 295d 3a0d 0a20 2020 2020  elf.ws)]:..     
-000078a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000078b0: 2056 616c 7565 4572 726f 7228 2246 6163   ValueError("Fac
-000078c0: 6965 7320 6861 7665 206e 6f74 2062 6565  ies have not bee
-000078d0: 6e20 636f 6d70 7574 6564 2079 6574 2229  n computed yet")
-000078e0: 0d0a 0d0a 2020 2020 2020 2020 6966 2061  ....        if a
-000078f0: 6c6c 5f64 6174 613a 0d0a 2020 2020 2020  ll_data:..      
-00007900: 2020 2020 2020 2320 6765 7420 616c 6c20        # get all 
-00007910: 7265 616c 0d0a 2020 2020 2020 2020 2020  real..          
-00007920: 2020 6966 2073 656c 662e 7772 6974 655f    if self.write_
-00007930: 7265 7375 6c74 733a 0d0a 2020 2020 2020  results:..      
-00007940: 2020 2020 2020 2020 2020 6e72 6561 6c5f            nreal_
-00007950: 6661 3d73 656c 662e 6e72 6561 6c5f 6661  fa=self.nreal_fa
-00007960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007970: 2020 6e72 6561 6c5f 753d 7365 6c66 2e6e    nreal_u=self.n
-00007980: 7265 616c 5f75 6e69 7473 0d0a 2020 2020  real_units..    
-00007990: 2020 2020 2020 2020 2020 2020 6e78 3d73              nx=s
-000079a0: 656c 662e 6765 745f 6e78 2829 0d0a 2020  elf.get_nx()..  
-000079b0: 2020 2020 2020 2020 2020 2020 2020 6e79                ny
-000079c0: 3d73 656c 662e 6765 745f 6e79 2829 0d0a  =self.get_ny()..
-000079d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079e0: 6e7a 3d73 656c 662e 6765 745f 6e7a 2829  nz=self.get_nz()
-000079f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007a00: 2020 6664 3d6e 702e 7a65 726f 7328 5b6e    fd=np.zeros([n
-00007a10: 7265 616c 5f75 2c20 6e72 6561 6c5f 6661  real_u, nreal_fa
-00007a20: 2c20 6e7a 2c20 6e79 2c20 6e78 5d2c 2064  , nz, ny, nx], d
-00007a30: 7479 7065 3d6e 702e 696e 7438 290d 0a20  type=np.int8).. 
-00007a40: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00007a50: 6f72 2069 7520 696e 2072 616e 6765 286e  or iu in range(n
-00007a60: 7265 616c 5f75 293a 0d0a 2020 2020 2020  real_u):..      
-00007a70: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00007a80: 7220 6966 6120 696e 2072 616e 6765 286e  r ifa in range(n
-00007a90: 7265 616c 5f66 6129 3a0d 0a20 2020 2020  real_fa):..     
-00007aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ab0: 2020 2066 6e61 6d65 3d73 656c 662e 6e61     fname=self.na
-00007ac0: 6d65 2b22 5f7b 7d5f 7b7d 2e66 6422 2e66  me+"_{}_{}.fd".f
-00007ad0: 6f72 6d61 7428 6975 2c20 6966 6129 0d0a  ormat(iu, ifa)..
-00007ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007af0: 2020 2020 2020 2020 6670 6174 683d 6f73          fpath=os
-00007b00: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
-00007b10: 7773 2c20 666e 616d 6529 0d0a 2020 2020  ws, fname)..    
-00007b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b30: 2020 2020 7769 7468 206f 7065 6e28 6670      with open(fp
-00007b40: 6174 682c 2022 7262 2229 2061 7320 663a  ath, "rb") as f:
-00007b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00007b60: 2020 2020 2020 2020 2020 2020 2020 6664                fd
-00007b70: 5b69 752c 2069 6661 5d3d 7069 636b 6c65  [iu, ifa]=pickle
-00007b80: 2e6c 6f61 6428 6629 0d0a 2020 2020 2020  .load(f)..      
-00007b90: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00007ba0: 2020 2020 2020 2020 2020 2020 2066 643d               fd=
-00007bb0: 7365 6c66 2e47 656f 6c2e 6661 6369 6573  self.Geol.facies
-00007bc0: 5f64 6f6d 6169 6e73 2e63 6f70 7928 290d  _domains.copy().
-00007bd0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00007be0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00007bf0: 656c 662e 7772 6974 655f 7265 7375 6c74  elf.write_result
-00007c00: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00007c10: 2020 2020 666e 616d 653d 7365 6c66 2e6e      fname=self.n
-00007c20: 616d 652b 225f 7b7d 5f7b 7d2e 6664 222e  ame+"_{}_{}.fd".
-00007c30: 666f 726d 6174 2869 752c 2069 6661 290d  format(iu, ifa).
-00007c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007c50: 2066 7061 7468 3d6f 732e 7061 7468 2e6a   fpath=os.path.j
-00007c60: 6f69 6e28 7365 6c66 2e77 732c 2066 6e61  oin(self.ws, fna
-00007c70: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
-00007c80: 2020 2020 2077 6974 6820 6f70 656e 2866       with open(f
-00007c90: 7061 7468 2c20 2272 6222 2920 6173 2066  path, "rb") as f
-00007ca0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00007cb0: 2020 2020 2020 2066 643d 7069 636b 6c65         fd=pickle
-00007cc0: 2e6c 6f61 6428 6629 0d0a 2020 2020 2020  .load(f)..      
-00007cd0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00007ce0: 2020 2020 2020 2020 2020 2020 2066 643d               fd=
-00007cf0: 7365 6c66 2e47 656f 6c2e 6661 6369 6573  self.Geol.facies
-00007d00: 5f64 6f6d 6169 6e73 5b69 752c 2069 6661  _domains[iu, ifa
-00007d10: 5d2e 636f 7079 2829 0d0a 0d0a 2020 2020  ].copy()....    
-00007d20: 2020 2020 7265 7475 726e 2066 640d 0a0d      return fd...
-00007d30: 0a20 2020 2064 6566 2067 6574 5f73 7572  .    def get_sur
-00007d40: 6661 6365 735f 756e 6974 2873 656c 662c  faces_unit(self,
-00007d50: 2075 6e69 742c 2074 7970 3d22 746f 7022   unit, typ="top"
-00007d60: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-00007d70: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
-00007d80: 6e20 6120 3344 2061 7272 6179 206f 6620  n a 3D array of 
-00007d90: 636f 6d70 7574 6564 2073 7572 6661 6365  computed surface
-00007da0: 7320 666f 7220 6120 7370 6563 6966 6963  s for a specific
-00007db0: 2075 6e69 740d 0a0d 0a20 2020 2020 2020   unit....       
-00007dc0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00007dd0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00007de0: 0a20 2020 2020 2020 2075 6e69 743a 203a  .        unit: :
-00007df0: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
-00007e00: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
-00007e10: 2061 2055 6e69 7420 6f62 6a65 6374 2063   a Unit object c
-00007e20: 6f6e 7461 696e 6564 2069 6e73 6964 6520  ontained inside 
-00007e30: 7468 6520 6d61 7374 6572 2070 696c 650d  the master pile.
-00007e40: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00007e50: 616e 6f74 6865 7220 7375 6275 6e69 740d  another subunit.
-00007e60: 0a20 2020 2020 2020 2074 7970 3a20 7374  .        typ: st
-00007e70: 7269 6e67 2c20 2874 6f70 2c20 626f 7420  ring, (top, bot 
-00007e80: 6f72 206f 7269 6769 6e61 6c29 2c0d 0a20  or original),.. 
-00007e90: 2020 2020 2020 2020 2020 2073 7065 6369             speci
-00007ea0: 6679 2077 6869 6368 2074 7970 6520 6f66  fy which type of
-00007eb0: 2073 7572 6661 6365 2074 6f20 7265 7475   surface to retu
-00007ec0: 726e 2c20 746f 702c 0d0a 2020 2020 2020  rn, top,..      
-00007ed0: 2020 2020 2020 626f 7420 6f72 206f 7269        bot or ori
-00007ee0: 6769 6e61 6c20 2873 7572 6661 6365 7320  ginal (surfaces 
-00007ef0: 6265 666f 7265 2061 7070 6c79 696e 6720  before applying 
-00007f00: 6572 6f73 696f 6e0d 0a20 2020 2020 2020  erosion..       
-00007f10: 2020 2020 2061 6e64 2073 7472 6174 6967       and stratig
-00007f20: 7261 7069 6320 7275 6c65 7329 0d0a 0d0a  rapic rules)....
-00007f30: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00007f40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00007f50: 0d0a 2020 2020 2020 2020 3344 206e 6461  ..        3D nda
-00007f60: 7272 6179 206f 6620 7369 7a65 2028 6e72  rray of size (nr
-00007f70: 6561 6c5f 756e 6974 732c 206e 792c 206e  eal_units, ny, n
-00007f80: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
-00007f90: 416c 6c20 636f 6d70 7574 6564 2073 7572  All computed sur
-00007fa0: 6661 6365 7320 696e 2061 206e 642e 6172  faces in a nd.ar
-00007fb0: 7261 7920 6f66 0d0a 2020 2020 2020 2020  ray of..        
-00007fc0: 2020 2020 7369 7a65 2028 6e72 6561 6c5f      size (nreal_
-00007fd0: 756e 6974 732c 206e 792c 206e 7829 0d0a  units, ny, nx)..
-00007fe0: 2020 2020 2020 2020 2222 220d 0a0d 0a0d          """.....
-00007ff0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00008000: 756e 6974 2069 6e20 7365 6c66 2e67 6574  unit in self.get
-00008010: 5f61 6c6c 5f75 6e69 7473 2829 2c20 2255  _all_units(), "U
-00008020: 6e69 7420 6d75 7374 2062 6520 696e 636c  nit must be incl
-00008030: 7564 6564 2069 6e20 6120 7069 6c65 2072  uded in a pile r
-00008040: 656c 6174 6564 2074 6f20 7468 6520 6d61  elated to the ma
-00008050: 7374 6572 2070 696c 6522 0d0a 2020 2020  ster pile"..    
-00008060: 2020 2020 6173 7365 7274 2073 656c 662e      assert self.
-00008070: 4765 6f6c 2e73 7572 6661 6365 735f 6279  Geol.surfaces_by
-00008080: 5f70 696c 6573 2069 7320 6e6f 7420 4e6f  _piles is not No
-00008090: 6e65 2c20 2253 7572 6661 6365 7320 6e6f  ne, "Surfaces no
-000080a0: 7420 636f 6d70 7574 6564 220d 0a20 2020  t computed"..   
-000080b0: 2020 2020 2061 7373 6572 7420 7479 7020       assert typ 
-000080c0: 696e 2028 2274 6f70 222c 2022 626f 7422  in ("top", "bot"
-000080d0: 2c20 226f 7269 6769 6e61 6c22 292c 2022  , "original"), "
-000080e0: 5375 7266 6163 6520 7479 7065 207b 7d20  Surface type {} 
-000080f0: 646f 6573 6e74 2065 7869 7374 222e 666f  doesnt exist".fo
-00008100: 726d 6174 2874 7970 290d 0a20 2020 2020  rmat(typ)..     
-00008110: 2020 2068 6c3d 756e 6974 2e67 6574 5f68     hl=unit.get_h
-00008120: 5f6c 6576 656c 2829 0d0a 2020 2020 2020  _level()..      
-00008130: 2020 6966 2068 6c20 3d3d 2031 3a0d 0a20    if hl == 1:.. 
-00008140: 2020 2020 2020 2020 2020 2050 3d73 656c             P=sel
-00008150: 662e 6765 745f 7069 6c65 5f6d 6173 7465  f.get_pile_maste
-00008160: 7228 290d 0a20 2020 2020 2020 2065 6c69  r()..        eli
-00008170: 6620 686c 203e 2031 3a0d 0a20 2020 2020  f hl > 1:..     
-00008180: 2020 2020 2020 2050 3d75 6e69 742e 6d75         P=unit.mu
-00008190: 6d6d 795f 756e 6974 2e53 7562 5069 6c65  mmy_unit.SubPile
-000081a0: 0d0a 0d0a 2020 2020 2020 2020 6966 2050  ....        if P
-000081b0: 2e6e 6174 7572 6520 3d3d 2022 7375 7266  .nature == "surf
-000081c0: 6163 6573 223a 0d0a 2020 2020 2020 2020  aces":..        
-000081d0: 2020 2020 6966 2074 7970 203d 3d22 746f      if typ =="to
-000081e0: 7022 3a0d 0a20 2020 2020 2020 2020 2020  p":..           
-000081f0: 2020 2020 2073 3d73 656c 662e 4765 6f6c       s=self.Geol
-00008200: 2e73 7572 6661 6365 735f 6279 5f70 696c  .surfaces_by_pil
-00008210: 6573 5b50 2e6e 616d 655d 5b3a 2c20 756e  es[P.name][:, un
-00008220: 6974 2e6f 7264 6572 2d31 5d2e 636f 7079  it.order-1].copy
-00008230: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00008240: 656c 6966 2074 7970 203d 3d22 626f 7422  elif typ =="bot"
-00008250: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008260: 2020 2073 3d73 656c 662e 4765 6f6c 2e73     s=self.Geol.s
-00008270: 7572 6661 6365 735f 626f 745f 6279 5f70  urfaces_bot_by_p
-00008280: 696c 6573 5b50 2e6e 616d 655d 5b3a 2c20  iles[P.name][:, 
-00008290: 756e 6974 2e6f 7264 6572 2d31 5d2e 636f  unit.order-1].co
-000082a0: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
-000082b0: 2020 656c 6966 2074 7970 203d 3d20 226f    elif typ == "o
-000082c0: 7269 6769 6e61 6c22 3a0d 0a20 2020 2020  riginal":..     
-000082d0: 2020 2020 2020 2020 2020 2073 3d73 656c             s=sel
-000082e0: 662e 4765 6f6c 2e6f 7267 5f73 7572 6661  f.Geol.org_surfa
-000082f0: 6365 735f 6279 5f70 696c 6573 5b50 2e6e  ces_by_piles[P.n
-00008300: 616d 655d 5b3a 2c20 756e 6974 2e6f 7264  ame][:, unit.ord
-00008310: 6572 2d31 5d2e 636f 7079 2829 0d0a 2020  er-1].copy()..  
-00008320: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008330: 2073 0d0a 2020 2020 2020 2020 656c 7365   s..        else
-00008340: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00008350: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
-00008360: 2020 6465 6620 6765 745f 7375 7266 6163    def get_surfac
-00008370: 6528 7365 6c66 2c20 685f 6c65 7665 6c3d  e(self, h_level=
-00008380: 2261 6c6c 2229 3a0d 0a0d 0a20 2020 2020  "all"):....     
-00008390: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000083a0: 5265 7475 726e 2061 2034 4420 6172 7261  Return a 4D arra
-000083b0: 7920 6f66 206d 756c 7469 706c 6520 7375  y of multiple su
-000083c0: 7266 6163 6573 2061 6363 6f72 6469 6e67  rfaces according
-000083d0: 2074 6f0d 0a20 2020 2020 2020 2074 6865   to..        the
-000083e0: 2068 6965 7261 7263 6869 6361 6c20 6c65   hierarchical le
-000083f0: 7665 6c20 6465 7369 7265 642c 2062 7920  vel desired, by 
-00008400: 6465 6661 756c 7420 4172 6368 5079 2074  default ArchPy t
-00008410: 7279 0d0a 2020 2020 2020 2020 746f 2072  ry..        to r
-00008420: 6574 7572 6e20 7468 6520 6869 6768 6573  eturn the highes
-00008430: 7420 6869 6572 6172 6368 6963 616c 2075  t hierarchical u
-00008440: 6e69 7427 7320 7375 7266 6163 650d 0a0d  nit's surface...
-00008450: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00008460: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00008470: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00008480: 2068 5f6c 6576 656c 3a20 696e 7420 6f72   h_level: int or
-00008490: 2073 7472 696e 672c 0d0a 2020 2020 2020   string,..      
-000084a0: 2020 2020 2020 6d61 7869 6d75 6d20 6c65        maximum le
-000084b0: 7665 6c20 6f66 2068 6965 7261 7263 6879  vel of hierarchy
-000084c0: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
-000084d0: 7369 7265 6420 746f 2072 6574 7572 6e2c  sired to return,
-000084e0: 2022 616c 6c22 2069 6e64 6963 6174 6573   "all" indicates
-000084f0: 2074 6f20 7265 7475 726e 0d0a 2020 2020   to return..    
-00008500: 2020 2020 2020 2020 7468 6520 6869 6768          the high
-00008510: 6573 7420 6869 6572 6172 6368 6963 616c  est hierarchical
-00008520: 206c 6576 656c 2070 6f73 7369 626c 6520   level possible 
-00008530: 666f 7220 6561 6368 2075 6e69 740d 0a0d  for each unit...
-00008540: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00008550: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00008560: 2d0d 0a20 2020 2020 2020 2034 4420 6e64  -..        4D nd
-00008570: 6172 7261 7920 6f66 2073 697a 6520 286e  array of size (n
-00008580: 6c61 7965 722c 206e 7369 6d2c 206e 792c  layer, nsim, ny,
-00008590: 206e 7829 0d0a 2020 2020 2020 2020 2020   nx)..          
-000085a0: 2020 416c 6c20 636f 6d70 7574 6564 2073    All computed s
-000085b0: 7572 6661 6365 7320 696e 2061 206e 642e  urfaces in a nd.
-000085c0: 6172 7261 7920 6f66 0d0a 2020 2020 2020  array of..      
-000085d0: 2020 2020 2020 7369 7a65 2028 6e6c 6179        size (nlay
-000085e0: 6572 2c20 6e73 696d 2c20 6e79 2c20 6e78  er, nsim, ny, nx
-000085f0: 290d 0a20 2020 2020 2020 206c 6973 740d  )..        list.
-00008600: 0a20 2020 2020 2020 2020 2020 2061 206c  .            a l
-00008610: 6973 7420 286e 6c61 7965 7229 206f 6620  ist (nlayer) of 
-00008620: 756e 6974 7320 6e61 6d65 2063 6f72 7265  units name corre
-00008630: 7370 6f6e 6469 6e67 2074 6f20 7468 650d  sponding to the.
-00008640: 0a20 2020 2020 2020 2020 2020 2073 7572  .            sur
-00008650: 6661 6365 7320 746f 2064 6973 7469 6e67  faces to disting
-00008660: 7569 7368 2077 6963 6820 7375 7266 6163  uish wich surfac
-00008670: 6520 636f 7272 6573 706f 6e64 2074 6f20  e correspond to 
-00008680: 7768 6963 6820 756e 6974 0d0a 2020 2020  which unit..    
-00008690: 2020 2020 2222 220d 0a0d 0a0d 0a20 2020      """......   
-000086a0: 2020 2020 2069 6620 685f 6c65 7665 6c20       if h_level 
-000086b0: 3d3d 2022 616c 6c22 3a0d 0a20 2020 2020  == "all":..     
-000086c0: 2020 2020 2020 206c 3d5b 5d0d 0a20 2020         l=[]..   
-000086d0: 2020 2020 2020 2020 2064 6566 2066 756e           def fun
-000086e0: 2870 696c 6529 3a0d 0a20 2020 2020 2020  (pile):..       
-000086f0: 2020 2020 2020 2020 2066 6f72 2075 2069           for u i
-00008700: 6e20 7069 6c65 2e6c 6973 745f 756e 6974  n pile.list_unit
-00008710: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00008720: 2020 2020 2020 2020 6966 2075 2e66 5f6d          if u.f_m
-00008730: 6574 686f 6420 213d 2022 5375 6250 696c  ethod != "SubPil
-00008740: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-00008750: 2020 2020 2020 2020 2020 2020 206c 2e61               l.a
-00008760: 7070 656e 6428 7529 0d0a 2020 2020 2020  ppend(u)..      
-00008770: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00008780: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00008790: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-000087a0: 2875 2e53 7562 5069 6c65 290d 0a0d 0a20  (u.SubPile).... 
-000087b0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
-000087c0: 7374 616e 6365 2868 5f6c 6576 656c 2c20  stance(h_level, 
-000087d0: 696e 7429 2061 6e64 2068 5f6c 6576 656c  int) and h_level
-000087e0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
-000087f0: 2020 206c 3d5b 5d0d 0a20 2020 2020 2020     l=[]..       
-00008800: 2020 2020 2064 6566 2066 756e 2870 696c       def fun(pil
-00008810: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
-00008820: 2020 2020 2066 6f72 2075 2069 6e20 7069       for u in pi
-00008830: 6c65 2e6c 6973 745f 756e 6974 733a 0d0a  le.list_units:..
-00008840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008850: 2020 2020 6966 2075 2e66 5f6d 6574 686f      if u.f_metho
-00008860: 6420 3d3d 2022 5375 6250 696c 6522 3a0d  d == "SubPile":.
-00008870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008880: 2020 2020 2020 2020 2069 6620 752e 6765           if u.ge
-00008890: 745f 685f 6c65 7665 6c28 2920 3c20 685f  t_h_level() < h_
-000088a0: 6c65 7665 6c3a 0d0a 2020 2020 2020 2020  level:..        
-000088b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000088c0: 2020 2020 6675 6e28 752e 5375 6250 696c      fun(u.SubPil
-000088d0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-000088e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000088f0: 2075 2e67 6574 5f68 5f6c 6576 656c 2829   u.get_h_level()
-00008900: 203d 3d20 685f 6c65 7665 6c3a 0d0a 2020   == h_level:..  
+00003d10: 2020 2020 2020 2020 2020 2020 783d 785f              x=x_
+00003d20: 6571 2c20 763d 765f 6571 2c0d 0a20 2020  eq, v=v_eq,..   
+00003d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d40: 2020 2020 2020 2020 2020 2020 2078 496e               xIn
+00003d50: 6571 4d69 6e3d 7849 6e65 715f 6d69 6e2c  eqMin=xIneq_min,
+00003d60: 2076 496e 6571 4d69 6e3d 7649 6e65 715f   vIneqMin=vIneq_
+00003d70: 6d69 6e2c 0d0a 2020 2020 2020 2020 2020  min,..          
+00003d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d90: 2020 2020 2020 7849 6e65 714d 6178 3d78        xIneqMax=x
+00003da0: 496e 6571 5f6d 6178 2c20 7649 6e65 714d  Ineq_max, vIneqM
+00003db0: 6178 3d76 496e 6571 5f6d 6178 2c0d 0a20  ax=vIneq_max,.. 
+00003dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003dd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003de0: 6561 7263 6852 6164 6975 7352 656c 6174  earchRadiusRelat
+00003df0: 6976 653d 312c 2076 6572 626f 7365 3d76  ive=1, verbose=v
+00003e00: 6572 626f 7365 2c0d 0a20 2020 2020 2020  erbose,..       
+00003e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003e20: 2020 2020 2020 2020 206e 4769 6262 7353           nGibbsS
+00003e30: 616d 706c 6572 5061 7468 4d69 6e3d 6b77  amplerPathMin=kw
+00003e40: 6172 6773 5b22 6e69 7422 5d2c 6e47 6962  args["nit"],nGib
+00003e50: 6273 5361 6d70 6c65 7250 6174 684d 6178  bsSamplerPathMax
+00003e60: 3d32 2a6b 7761 7267 735b 226e 6974 225d  =2*kwargs["nit"]
+00003e70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00003e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003e90: 2020 2020 7365 6564 3d73 6565 642c 206e      seed=seed, n
+00003ea0: 6e65 6967 6862 6f72 4d61 783d 6b77 6172  neighborMax=kwar
+00003eb0: 6773 5b22 6e6d 6178 225d 2c20 6e74 6872  gs["nmax"], nthr
+00003ec0: 6561 6473 3d6e 6370 752c 206d 6173 6b3d  eads=ncpu, mask=
+00003ed0: 6d61 736b 3244 295b 2269 6d61 6765 225d  mask2D)["image"]
+00003ee0: 2e76 616c 5b30 2c20 305d 0d0a 0d0a 2020  .val[0, 0]....  
+00003ef0: 2020 2020 2020 2020 2020 6966 206c 6974            if lit
+00003f00: 686f 2e4e 5f74 7261 6e73 666f 3a0d 0a20  ho.N_transfo:.. 
+00003f10: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003f20: 3d4e 5363 6f72 655f 4274 7273 6628 7369  =NScore_Btrsf(si
+00003f30: 6d2e 666c 6174 7465 6e28 292c 2064 6929  m.flatten(), di)
+00003f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003f50: 2020 733d 732e 7265 7368 6170 6528 6e79    s=s.reshape(ny
+00003f60: 2c20 6e78 290d 0a20 2020 2020 2020 2020  , nx)..         
+00003f70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00003f80: 2020 2020 2020 2020 2020 733d 7369 6d0d            s=sim.
+00003f90: 0a0d 0a20 2020 2065 6c69 6620 6d65 7468  ...    elif meth
+00003fa0: 6f64 2e6c 6f77 6572 2829 203d 3d20 226d  od.lower() == "m
+00003fb0: 7073 223a 0d0a 0d0a 2020 2020 2020 2020  ps":....        
+00003fc0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00003fd0: 6528 6b77 6172 6773 5b22 5449 225d 2c20  e(kwargs["TI"], 
+00003fe0: 6765 6f6e 652e 696d 672e 496d 6729 2c20  geone.img.Img), 
+00003ff0: 2254 4920 6973 206e 6f74 2061 2067 656f  "TI is not a geo
+00004000: 6e65 2069 6d61 6765 206f 626a 6563 7422  ne image object"
+00004010: 0d0a 0d0a 2020 2020 2020 2020 236c 6f61  ....        #loa
+00004020: 6420 7061 7261 6d65 7465 7273 0d0a 2020  d parameters..  
+00004030: 2020 2020 2020 5449 3d6b 7761 7267 735b        TI=kwargs[
+00004040: 2254 4922 5d20 2367 6574 2054 490d 0a0d  "TI"] #get TI...
+00004050: 0a20 2020 2020 2020 2023 6578 7472 6163  .        #extrac
+00004060: 7420 6861 7264 2064 6174 610d 0a20 2020  t hard data..   
+00004070: 2020 2020 2065 715f 643d 6e70 2e63 6f6e       eq_d=np.con
+00004080: 6361 7465 6e61 7465 285b 785f 6571 2c20  catenate([x_eq, 
+00004090: 302e 352a 6e70 2e6f 6e65 7328 5b76 5f65  0.5*np.ones([v_e
+000040a0: 712e 7368 6170 655b 305d 2c20 315d 292c  q.shape[0], 1]),
+000040b0: 2076 5f65 712e 7265 7368 6170 6528 2d31   v_eq.reshape(-1
+000040c0: 2c20 3129 2c20 6e70 2e6e 616e 2a6e 702e  , 1), np.nan*np.
+000040d0: 6f6e 6573 285b 765f 6571 2e73 6861 7065  ones([v_eq.shape
+000040e0: 5b30 5d2c 2032 5d29 5d2c 2061 7869 733d  [0], 2])], axis=
+000040f0: 3129 0d0a 2020 2020 2020 2020 6966 206c  1)..        if l
+00004100: 656e 286c 6974 686f 2e69 6e65 7129 203d  en(litho.ineq) =
+00004110: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+00004120: 2020 7375 705f 6420 3d20 4e6f 6e65 0d0a    sup_d = None..
+00004130: 2020 2020 2020 2020 2020 2020 696e 665f              inf_
+00004140: 6420 3d20 4e6f 6e65 0d0a 2020 2020 2020  d = None..      
+00004150: 2020 2020 2020 616c 6c5f 6461 7461 203d        all_data =
+00004160: 2065 715f 640d 0a0d 0a20 2020 2020 2020   eq_d....       
+00004170: 2020 2020 2076 6172 6e61 6d65 3d5b 2778       varname=['x
+00004180: 272c 2027 7927 2c20 277a 272c 2027 636f  ', 'y', 'z', 'co
+00004190: 6465 275d 2023 206c 6973 7420 6f66 2076  de'] # list of v
+000041a0: 6172 6961 626c 6520 6e61 6d65 730d 0a20  ariable names.. 
+000041b0: 2020 2020 2020 2020 2020 2068 6420 3d20             hd = 
+000041c0: 616c 6c5f 6461 7461 5b3a 2c20 3a34 5d2e  all_data[:, :4].
+000041d0: 540d 0a20 2020 2020 2020 2020 2020 2070  T..            p
+000041e0: 7420 3d20 696d 672e 506f 696e 7453 6574  t = img.PointSet
+000041f0: 286e 7074 3d68 642e 7368 6170 655b 315d  (npt=hd.shape[1]
+00004200: 2c20 6e76 3d34 2c20 7661 6c3d 6864 2c20  , nv=4, val=hd, 
+00004210: 7661 726e 616d 653d 7661 726e 616d 6529  varname=varname)
+00004220: 0d0a 0d0a 2020 2020 2020 2020 656c 7365  ....        else
+00004230: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00004240: 7570 5f64 3d6e 702e 636f 6e63 6174 656e  up_d=np.concaten
+00004250: 6174 6528 5b78 496e 6571 5f6d 6178 2c20  ate([xIneq_max, 
+00004260: 302e 352a 6e70 2e6f 6e65 7328 5b76 496e  0.5*np.ones([vIn
+00004270: 6571 5f6d 6178 2e73 6861 7065 5b30 5d2c  eq_max.shape[0],
+00004280: 2031 5d29 2c20 6e70 2e6e 616e 2a6e 702e   1]), np.nan*np.
+00004290: 6f6e 6573 285b 7649 6e65 715f 6d61 782e  ones([vIneq_max.
+000042a0: 7368 6170 655b 305d 2c20 325d 292c 2076  shape[0], 2]), v
+000042b0: 496e 6571 5f6d 6178 2e72 6573 6861 7065  Ineq_max.reshape
+000042c0: 282d 312c 2031 295d 2c20 6178 6973 3d31  (-1, 1)], axis=1
+000042d0: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000042e0: 6e66 5f64 3d6e 702e 636f 6e63 6174 656e  nf_d=np.concaten
+000042f0: 6174 6528 5b78 496e 6571 5f6d 696e 2c20  ate([xIneq_min, 
+00004300: 302e 352a 6e70 2e6f 6e65 7328 5b76 496e  0.5*np.ones([vIn
+00004310: 6571 5f6d 696e 2e73 6861 7065 5b30 5d2c  eq_min.shape[0],
+00004320: 2031 5d29 2c20 6e70 2e6e 616e 2a6e 702e   1]), np.nan*np.
+00004330: 6f6e 6573 285b 7649 6e65 715f 6d69 6e2e  ones([vIneq_min.
+00004340: 7368 6170 655b 305d 2c20 315d 292c 2076  shape[0], 1]), v
+00004350: 496e 6571 5f6d 696e 2e72 6573 6861 7065  Ineq_min.reshape
+00004360: 282d 312c 2031 292c 206e 702e 6e61 6e2a  (-1, 1), np.nan*
+00004370: 6e70 2e6f 6e65 7328 5b76 496e 6571 5f6d  np.ones([vIneq_m
+00004380: 696e 2e73 6861 7065 5b30 5d2c 2031 5d29  in.shape[0], 1])
+00004390: 5d2c 2061 7869 733d 3129 0d0a 2020 2020  ], axis=1)..    
+000043a0: 2020 2020 2020 2020 616c 6c5f 6461 7461          all_data
+000043b0: 3d6e 702e 636f 6e63 6174 656e 6174 6528  =np.concatenate(
+000043c0: 5b65 715f 642c 2073 7570 5f64 2c20 696e  [eq_d, sup_d, in
+000043d0: 665f 645d 290d 0a0d 0a20 2020 2020 2020  f_d])....       
+000043e0: 2020 2020 2076 6172 6e61 6d65 3d5b 2778       varname=['x
+000043f0: 272c 2027 7927 2c20 277a 272c 2027 636f  ', 'y', 'z', 'co
+00004400: 6465 272c 2027 636f 6465 5f6d 696e 272c  de', 'code_min',
+00004410: 2027 636f 6465 5f6d 6178 275d 2023 206c   'code_max'] # l
+00004420: 6973 7420 6f66 2076 6172 6961 626c 6520  ist of variable 
+00004430: 6e61 6d65 730d 0a20 2020 2020 2020 2020  names..         
+00004440: 2020 2068 643d 616c 6c5f 6461 7461 2e54     hd=all_data.T
+00004450: 0d0a 2020 2020 2020 2020 2020 2020 7074  ..            pt
+00004460: 3d69 6d67 2e50 6f69 6e74 5365 7428 6e70  =img.PointSet(np
+00004470: 743d 6864 2e73 6861 7065 5b31 5d2c 206e  t=hd.shape[1], n
+00004480: 763d 362c 2076 616c 3d68 642c 2076 6172  v=6, val=hd, var
+00004490: 6e61 6d65 3d76 6172 6e61 6d65 290d 0a0d  name=varname)...
+000044a0: 0a20 2020 2020 2020 2020 2020 2023 6465  .            #de
+000044b0: 6669 6e65 206d 6f64 6520 286f 6e6c 7920  fine mode (only 
+000044c0: 7265 7363 616c 696e 6720 6d69 6e2d 6d61  rescaling min-ma
+000044d0: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
+000044e0: 6966 206b 7761 7267 735b 2254 6172 6765  if kwargs["Targe
+000044f0: 744d 696e 225d 2069 7320 4e6f 6e65 3a0d  tMin"] is None:.
+00004500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004510: 206b 7761 7267 735b 2254 6172 6765 744d   kwargs["TargetM
+00004520: 696e 225d 3d6e 702e 6e61 6e6d 696e 2861  in"]=np.nanmin(a
+00004530: 6c6c 5f64 6174 615b 3a2c 333a 205d 290d  ll_data[:,3: ]).
+00004540: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004550: 6b77 6172 6773 5b22 5461 7267 6574 4d61  kwargs["TargetMa
+00004560: 7822 5d20 6973 204e 6f6e 653a 0d0a 2020  x"] is None:..  
+00004570: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+00004580: 6172 6773 5b22 5461 7267 6574 4d69 6e22  args["TargetMin"
+00004590: 5d3d 6e70 2e6e 616e 6d61 7828 616c 6c5f  ]=np.nanmax(all_
+000045a0: 6461 7461 5b3a 2c33 3a20 5d29 0d0a 0d0a  data[:,3: ])....
+000045b0: 2020 2020 2020 2020 2344 5320 7265 7365          #DS rese
+000045c0: 6172 6368 0d0a 2020 2020 2020 2020 736e  arch..        sn
+000045d0: 703d 6473 692e 5365 6172 6368 4e65 6967  p=dsi.SearchNeig
+000045e0: 6862 6f72 686f 6f64 5061 7261 6d65 7465  hborhoodParamete
+000045f0: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
+00004600: 2072 6164 6975 734d 6f64 653d 6b77 6172   radiusMode=kwar
+00004610: 6773 5b22 7261 6469 7573 4d6f 6465 225d  gs["radiusMode"]
+00004620: 2c20 7278 3d6b 7761 7267 735b 2272 7822  , rx=kwargs["rx"
+00004630: 5d2c 2072 793d 6b77 6172 6773 5b22 7279  ], ry=kwargs["ry
+00004640: 225d 2c20 727a 3d6b 7761 7267 735b 2272  "], rz=kwargs["r
+00004650: 7a22 5d2c 0d0a 2020 2020 2020 2020 2020  z"],..          
+00004660: 2020 616e 6973 6f74 726f 7079 5261 7469    anisotropyRati
+00004670: 6f4d 6f64 653d 6b77 6172 6773 5b22 616e  oMode=kwargs["an
+00004680: 6973 6f74 726f 7079 5261 7469 6f4d 6f64  isotropyRatioMod
+00004690: 6522 5d2c 2061 783d 6b77 6172 6773 5b22  e"], ax=kwargs["
+000046a0: 6178 225d 2c20 6179 3d6b 7761 7267 735b  ax"], ay=kwargs[
+000046b0: 2261 7922 5d2c 2061 7a3d 6b77 6172 6773  "ay"], az=kwargs
+000046c0: 5b22 617a 225d 2c0d 0a20 2020 2020 2020  ["az"],..       
+000046d0: 2020 2020 2061 6e67 6c65 313d 6b77 6172       angle1=kwar
+000046e0: 6773 5b22 616e 676c 6531 225d 2c20 616e  gs["angle1"], an
+000046f0: 676c 6532 3d6b 7761 7267 735b 2261 6e67  gle2=kwargs["ang
+00004700: 6c65 3222 5d2c 2061 6e67 6c65 333d 6b77  le2"], angle3=kw
+00004710: 6172 6773 5b22 616e 676c 6533 225d 290d  args["angle3"]).
+00004720: 0a0d 0a20 2020 2020 2020 2023 4453 2069  ...        #DS i
+00004730: 6e70 7574 0d0a 2020 2020 2020 2020 6465  nput..        de
+00004740: 6573 7365 5f69 6e70 7574 3d64 7369 2e44  esse_input=dsi.D
+00004750: 6565 7373 6549 6e70 7574 280d 0a20 2020  eesseInput(..   
+00004760: 2020 2020 2020 2020 206e 783d 6e78 2c20           nx=nx, 
+00004770: 6e79 3d6e 792c 206e 7a3d 312c 2020 2020  ny=ny, nz=1,    
+00004780: 2020 2023 2064 696d 656e 7369 6f6e 206f     # dimension o
+00004790: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
+000047a0: 2067 7269 6420 286e 756d 6265 7220 6f66   grid (number of
+000047b0: 2063 656c 6c73 290d 0a20 2020 2020 2020   cells)..       
+000047c0: 2020 2020 2073 783d 7378 2c20 7379 3d73       sx=sx, sy=s
+000047d0: 792c 2073 7a3d 312c 2020 2020 2023 2063  y, sz=1,     # c
+000047e0: 656c 6c73 2075 6e69 7473 2069 6e20 7468  ells units in th
+000047f0: 6520 7369 6d75 6c61 7469 6f6e 2067 7269  e simulation gri
+00004800: 6420 2868 6572 6520 6172 6520 7468 6520  d (here are the 
+00004810: 6465 6661 756c 7420 7661 6c75 6573 290d  default values).
+00004820: 0a20 2020 2020 2020 2020 2020 206f 783d  .            ox=
+00004830: 6f78 2c20 6f79 3d6f 792c 206f 7a3d 302e  ox, oy=oy, oz=0.
+00004840: 352c 2020 2020 2023 206f 7269 6769 6e20  5,     # origin 
+00004850: 6f66 2074 6865 2073 696d 756c 6174 696f  of the simulatio
+00004860: 6e20 6772 6964 2028 6865 7265 2061 7265  n grid (here are
+00004870: 2074 6865 2064 6566 6175 6c74 2076 616c   the default val
+00004880: 7565 7329 0d0a 2020 2020 2020 2020 2020  ues)..          
+00004890: 2020 6e76 3d31 2c20 7661 726e 616d 653d    nv=1, varname=
+000048a0: 2763 6f64 6527 2c20 2020 2020 2020 2320  'code',       # 
+000048b0: 6e75 6d62 6572 206f 6620 7661 7269 6162  number of variab
+000048c0: 6c65 2873 292c 206e 616d 6520 6f66 2074  le(s), name of t
+000048d0: 6865 2076 6172 6961 626c 6528 7329 0d0a  he variable(s)..
+000048e0: 2020 2020 2020 2020 2020 2020 6e54 493d              nTI=
+000048f0: 312c 2054 493d 5449 2c20 2020 2020 2020  1, TI=TI,       
+00004900: 2020 2020 2020 2320 6e75 6d62 6572 206f        # number o
+00004910: 6620 5449 2873 292c 2054 4920 2863 6c61  f TI(s), TI (cla
+00004920: 7373 2064 7369 2e49 6d67 290d 0a20 2020  ss dsi.Img)..   
+00004930: 2020 2020 2020 2020 2064 6174 6150 6f69           dataPoi
+00004940: 6e74 5365 743d 7074 2c20 2020 2020 2020  ntSet=pt,       
+00004950: 2020 2020 2023 2068 6172 6420 6461 7461       # hard data
+00004960: 2028 6f70 7469 6f6e 616c 290d 0a20 2020   (optional)..   
+00004970: 2020 2020 2020 2020 2073 6561 7263 684e           searchN
+00004980: 6569 6768 626f 7268 6f6f 6450 6172 616d  eighborhoodParam
+00004990: 6574 6572 733d 736e 702c 0d0a 2020 2020  eters=snp,..    
+000049a0: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
+000049b0: 7955 7361 6765 3d6b 7761 7267 735b 2268  yUsage=kwargs["h
+000049c0: 6f6d 6f5f 7573 6167 6522 5d2c 0d0a 2020  omo_usage"],..  
+000049d0: 2020 2020 2020 2020 2020 686f 6d6f 7468            homoth
+000049e0: 6574 7958 4c6f 6361 6c3d 6b77 6172 6773  etyXLocal=kwargs
+000049f0: 5b22 786c 6f63 225d 2c0d 0a20 2020 2020  ["xloc"],..     
+00004a00: 2020 2020 2020 2068 6f6d 6f74 6865 7479         homothety
+00004a10: 5852 6174 696f 3d6b 7761 7267 735b 2278  XRatio=kwargs["x
+00004a20: 7222 5d2c 0d0a 2020 2020 2020 2020 2020  r"],..          
+00004a30: 2020 686f 6d6f 7468 6574 7959 4c6f 6361    homothetyYLoca
+00004a40: 6c3d 6b77 6172 6773 5b22 796c 6f63 225d  l=kwargs["yloc"]
+00004a50: 2c0d 0a20 2020 2020 2020 2020 2020 2068  ,..            h
+00004a60: 6f6d 6f74 6865 7479 5952 6174 696f 3d6b  omothetyYRatio=k
+00004a70: 7761 7267 735b 2279 7222 5d2c 0d0a 2020  wargs["yr"],..  
+00004a80: 2020 2020 2020 2020 2020 686f 6d6f 7468            homoth
+00004a90: 6574 795a 4c6f 6361 6c3d 6b77 6172 6773  etyZLocal=kwargs
+00004aa0: 5b22 7a6c 6f63 225d 2c0d 0a20 2020 2020  ["zloc"],..     
+00004ab0: 2020 2020 2020 2068 6f6d 6f74 6865 7479         homothety
+00004ac0: 5a52 6174 696f 3d6b 7761 7267 735b 227a  ZRatio=kwargs["z
+00004ad0: 7222 5d2c 0d0a 2020 2020 2020 2020 2020  r"],..          
+00004ae0: 2020 726f 7461 7469 6f6e 5573 6167 653d    rotationUsage=
+00004af0: 6b77 6172 6773 5b22 726f 745f 7573 6167  kwargs["rot_usag
+00004b00: 6522 5d2c 2020 2020 2020 2020 2020 2020  e"],            
+00004b10: 2320 746f 6c65 7261 6e63 6520 6f72 206e  # tolerance or n
+00004b20: 6f74 0d0a 2020 2020 2020 2020 2020 2020  ot..            
+00004b30: 726f 7461 7469 6f6e 417a 696d 7574 684c  rotationAzimuthL
+00004b40: 6f63 616c 3d6b 7761 7267 735b 2272 6f74  ocal=kwargs["rot
+00004b50: 417a 694c 6f63 225d 2c20 2320 2020 2072  AziLoc"], #    r
+00004b60: 6f74 6174 696f 6e20 6163 636f 7264 696e  otation accordin
+00004b70: 6720 746f 2061 7a69 6d75 7468 3a20 676c  g to azimuth: gl
+00004b80: 6f62 616c 0d0a 2020 2020 2020 2020 2020  obal..          
+00004b90: 2020 726f 7461 7469 6f6e 417a 696d 7574    rotationAzimut
+00004ba0: 683d 6b77 6172 6773 5b22 726f 7441 7a69  h=kwargs["rotAzi
+00004bb0: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
+00004bc0: 2072 6f74 6174 696f 6e44 6970 4c6f 6361   rotationDipLoca
+00004bd0: 6c3d 6b77 6172 6773 5b22 726f 7444 6970  l=kwargs["rotDip
+00004be0: 4c6f 6322 5d2c 0d0a 2020 2020 2020 2020  Loc"],..        
+00004bf0: 2020 2020 726f 7461 7469 6f6e 4469 703d      rotationDip=
+00004c00: 6b77 6172 6773 5b22 726f 7444 6970 225d  kwargs["rotDip"]
+00004c10: 2c0d 0a20 2020 2020 2020 2020 2020 2072  ,..            r
+00004c20: 6f74 6174 696f 6e50 6c75 6e67 654c 6f63  otationPlungeLoc
+00004c30: 616c 3d6b 7761 7267 735b 2272 6f74 506c  al=kwargs["rotPl
+00004c40: 756e 6765 4c6f 6322 5d2c 0d0a 2020 2020  ungeLoc"],..    
+00004c50: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
+00004c60: 506c 756e 6765 3d6b 7761 7267 735b 2272  Plunge=kwargs["r
+00004c70: 6f74 506c 756e 6765 225d 2c0d 0a20 2020  otPlunge"],..   
+00004c80: 2020 2020 2020 2020 2064 6973 7461 6e63           distanc
+00004c90: 6554 7970 653d 2763 6f6e 7469 6e75 6f75  eType='continuou
+00004ca0: 7327 2c20 2320 6469 7374 616e 6365 2074  s', # distance t
+00004cb0: 7970 653a 2070 726f 706f 7274 696f 6e20  ype: proportion 
+00004cc0: 6f66 206d 6973 6d61 7463 6869 6e67 206e  of mismatching n
+00004cd0: 6f64 6573 2028 6361 7465 676f 7269 6361  odes (categorica
+00004ce0: 6c20 7661 722e 2c20 6465 6661 756c 7429  l var., default)
+00004cf0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00004d00: 6c61 7469 7665 4469 7374 616e 6365 466c  lativeDistanceFl
+00004d10: 6167 3d6b 7761 7267 735b 2272 656c 6174  ag=kwargs["relat
+00004d20: 6976 6544 6973 7461 6e63 6546 6c61 6722  iveDistanceFlag"
+00004d30: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00004d40: 7265 7363 616c 696e 674d 6f64 653d 6b77  rescalingMode=kw
+00004d50: 6172 6773 5b22 7265 7363 616c 696e 674d  args["rescalingM
+00004d60: 6f64 6522 5d2c 0d0a 2020 2020 2020 2020  ode"],..        
+00004d70: 2020 2020 7265 7363 616c 696e 6754 6172      rescalingTar
+00004d80: 6765 744d 696e 3d6b 7761 7267 735b 2254  getMin=kwargs["T
+00004d90: 6172 6765 744d 696e 225d 2c20 2320 6d69  argetMin"], # mi
+00004da0: 6e20 6f66 2074 6865 2074 6172 6765 7420  n of the target 
+00004db0: 696e 7465 7276 616c 0d0a 2020 2020 2020  interval..      
+00004dc0: 2020 2020 2020 7265 7363 616c 696e 6754        rescalingT
+00004dd0: 6172 6765 744d 6178 3d6b 7761 7267 735b  argetMax=kwargs[
+00004de0: 2254 6172 6765 744d 6178 225d 2c20 236d  "TargetMax"], #m
+00004df0: 6178 206f 6620 7468 6520 7461 7267 6574  ax of the target
+00004e00: 2069 6e74 6572 7661 6c0d 0a20 2020 2020   interval..     
+00004e10: 2020 2020 2020 2072 6573 6361 6c69 6e67         rescaling
+00004e20: 5461 7267 6574 4d65 616e 3d6b 7761 7267  TargetMean=kwarg
+00004e30: 735b 2254 6172 6765 744d 6561 6e22 5d2c  s["TargetMean"],
+00004e40: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00004e50: 7363 616c 696e 6754 6172 6765 744c 656e  scalingTargetLen
+00004e60: 6774 683d 6b77 6172 6773 5b22 5461 7267  gth=kwargs["Targ
+00004e70: 6574 4c65 6e67 7468 225d 2c0d 0a20 2020  etLength"],..   
+00004e80: 2020 2020 2020 2020 206e 6e65 6967 6862           nneighb
+00004e90: 6f72 696e 674e 6f64 653d 6b77 6172 6773  oringNode=kwargs
+00004ea0: 5b22 6e65 6967 225d 2c20 2020 2020 2020  ["neig"],       
+00004eb0: 2023 206d 6178 2e20 6e75 6d62 6572 206f   # max. number o
+00004ec0: 6620 6e65 6967 6862 6f72 7320 2866 6f72  f neighbors (for
+00004ed0: 2074 6865 2070 6174 7465 726e 7329 0d0a   the patterns)..
+00004ee0: 2020 2020 2020 2020 2020 2020 6469 7374              dist
+00004ef0: 616e 6365 5468 7265 7368 6f6c 643d 6b77  anceThreshold=kw
+00004f00: 6172 6773 5b22 7468 7265 7368 225d 2c20  args["thresh"], 
+00004f10: 2020 2020 2320 6163 6365 7074 6174 696f      # acceptatio
+00004f20: 6e20 7468 7265 7368 6f6c 6420 2866 6f72  n threshold (for
+00004f30: 2064 6973 7461 6e63 6520 6265 7477 6565   distance betwee
+00004f40: 6e20 7061 7474 6572 6e73 290d 0a20 2020  n patterns)..   
+00004f50: 2020 2020 2020 2020 206d 6178 5363 616e           maxScan
+00004f60: 4672 6163 7469 6f6e 3d6b 7761 7267 735b  Fraction=kwargs[
+00004f70: 226d 6178 7363 616e 225d 2c20 2020 2020  "maxscan"],     
+00004f80: 2020 2320 6d61 782e 2073 6361 6e6e 6564    # max. scanned
+00004f90: 2066 7261 6374 696f 6e20 6f66 2074 6865   fraction of the
+00004fa0: 2054 4920 2866 6f72 2073 696d 756c 6174   TI (for simulat
+00004fb0: 696f 6e20 6f66 2065 6163 6820 6365 6c6c  ion of each cell
+00004fc0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00004fd0: 6565 643d 6e70 2e72 616e 646f 6d2e 7261  eed=np.random.ra
+00004fe0: 6e64 696e 7428 3165 3629 2c0d 0a20 2020  ndint(1e6),..   
+00004ff0: 2020 2020 2020 2020 206e 706f 7374 5072           npostPr
+00005000: 6f63 6573 7369 6e67 5061 7468 4d61 783d  ocessingPathMax=
+00005010: 312c 2020 2023 206e 756d 6265 7220 6f66  1,   # number of
+00005020: 2070 6f73 742d 7072 6f63 6573 7369 6e67   post-processing
+00005030: 2070 6174 6828 7329 0d0a 2020 2020 2020   path(s)..      
+00005040: 2020 2020 2020 6e72 6561 6c69 7a61 7469        nrealizati
+00005050: 6f6e 3d31 2920 2020 2020 2020 2020 2023  on=1)          #
+00005060: 206e 756d 6265 7220 6f66 2072 6561 6c69   number of reali
+00005070: 7a61 7469 6f6e 2873 2929 0d0a 0d0a 2020  zation(s))....  
+00005080: 2020 2020 2020 2320 5275 6e20 6465 6573        # Run dees
+00005090: 7365 0d0a 2020 2020 2020 2020 6465 6573  se..        dees
+000050a0: 7365 5f6f 7574 7075 743d 6473 692e 6465  se_output=dsi.de
+000050b0: 6573 7365 5275 6e28 6465 6573 7365 5f69  esseRun(deesse_i
+000050c0: 6e70 7574 2c20 6e74 6872 6561 6473 3d6e  nput, nthreads=n
+000050d0: 6370 752c 2076 6572 626f 7365 3d32 290d  cpu, verbose=2).
+000050e0: 0a20 2020 2020 2020 2073 696d 3d64 6565  .        sim=dee
+000050f0: 7373 655f 6f75 7470 7574 5b22 7369 6d22  sse_output["sim"
+00005100: 5d5b 305d 0d0a 2020 2020 2020 2020 733d  ][0]..        s=
+00005110: 7369 6d2e 7661 6c5b 302c 305d 0d0a 0d0a  sim.val[0,0]....
+00005120: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00005130: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00005140: 726f 7220 2822 6368 6f6f 7365 2070 726f  ror ("choose pro
+00005150: 7065 7220 696e 7465 7270 6f6c 6174 696f  per interpolatio
+00005160: 6e20 6d65 7468 6f64 2229 0d0a 0d0a 2020  n method")....  
+00005170: 2020 7265 7475 726e 2073 0d0a 0d0a 6465    return s....de
+00005180: 6620 7370 6c69 745f 6c6f 6773 2862 6829  f split_logs(bh)
+00005190: 3a0d 0a0d 0a20 2020 2022 2222 0d0a 2020  :....    """..  
+000051a0: 2020 5461 6b65 2061 2072 6177 2062 6f72    Take a raw bor
+000051b0: 6568 6f6c 6520 7769 7468 2068 6965 7261  ehole with hiera
+000051c0: 7263 6869 6361 6c20 756e 6974 7320 6d69  rchical units mi
+000051d0: 7865 640d 0a20 2020 2061 6e64 2073 6f72  xed..    and sor
+000051e0: 7420 7468 656d 2062 7920 6772 6f75 7020  t them by group 
+000051f0: 616e 6420 6869 6572 6172 6368 792e 0d0a  and hierarchy...
+00005200: 0d0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+00005210: 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  ..    ----------
+00005220: 0d0a 2020 2020 6268 3a20 3a70 793a 636c  ..    bh: :py:cl
+00005230: 6173 733a 6062 6f72 6568 6f6c 6560 206f  ass:`borehole` o
+00005240: 626a 6563 740d 0a0d 0a20 2020 2052 6574  bject....    Ret
+00005250: 7572 6e73 0d0a 2020 2020 2d2d 2d2d 2d2d  urns..    ------
+00005260: 2d0d 0a20 2020 206c 6973 740d 0a20 2020  -..    list..   
+00005270: 2020 2020 2041 206c 6973 7420 6f66 206e       A list of n
+00005280: 6577 2062 6f72 6568 6f6c 6573 0d0a 2020  ew boreholes..  
+00005290: 2020 2222 220d 0a0d 0a20 2020 206c 5f62    """....    l_b
+000052a0: 6873 3d5b 5d0d 0a20 2020 206c 5f6c 6f67  hs=[]..    l_log
+000052b0: 733d 5b5d 2023 6c69 7374 206f 6620 6c6f  s=[] #list of lo
+000052c0: 6773 0d0a 2020 2020 6268 4944 3d62 682e  gs..    bhID=bh.
+000052d0: 4944 0d0a 2020 2020 6268 782c 2062 6879  ID..    bhx, bhy
+000052e0: 2c20 6268 7a2c 2064 6570 7468 3d62 682e  , bhz, depth=bh.
+000052f0: 782c 2062 682e 792c 2062 682e 7a2c 2062  x, bh.y, bh.z, b
+00005300: 682e 6465 7074 680d 0a20 2020 206c 6f67  h.depth..    log
+00005310: 5f73 3d62 682e 6c6f 675f 7374 7261 7469  _s=bh.log_strati
+00005320: 0d0a 0d0a 0d0a 2020 2020 6c5f 6c6f 6773  ......    l_logs
+00005330: 3d5b 5d0d 0a0d 0a20 2020 2023 6c6f 6773  =[]....    #logs
+00005340: 2073 7472 6174 6973 0d0a 2020 2020 685f   stratis..    h_
+00005350: 6d61 783d 6d61 7828 5b69 5b30 5d2e 6765  max=max([i[0].ge
+00005360: 745f 685f 6c65 7665 6c28 2920 666f 7220  t_h_level() for 
+00005370: 6920 696e 206c 6f67 5f73 2069 6620 695b  i in log_s if i[
+00005380: 305d 2069 7320 6e6f 7420 4e6f 6e65 5d29  0] is not None])
+00005390: 0d0a 2020 2020 666f 7220 6920 696e 2072  ..    for i in r
+000053a0: 616e 6765 2868 5f6d 6178 293a 0d0a 2020  ange(h_max):..  
+000053b0: 2020 2020 2020 6c5f 6c6f 6773 2e61 7070        l_logs.app
+000053c0: 656e 6428 5b5d 290d 0a0d 0a20 2020 2064  end([])....    d
+000053d0: 6566 2062 6964 756c 6528 732c 2068 5f6c  ef bidule(s, h_l
+000053e0: 6576 293a 0d0a 0d0a 2020 2020 2020 2020  ev):....        
+000053f0: 2222 220d 0a20 2020 2020 2020 2052 6563  """..        Rec
+00005400: 7572 7369 7665 206f 7065 7261 7469 6f6e  ursive operation
+00005410: 2074 6f20 6964 656e 7469 6669 7920 6c6f   to identifiy lo
+00005420: 6720 7374 7261 7469 2061 7420 6c6f 7765  g strati at lowe
+00005430: 7220 6f72 6465 7220 6c65 7665 6c20 6672  r order level fr
+00005440: 6f6d 2068 6967 6865 7220 6c65 7665 6c73  om higher levels
+00005450: 2e0d 0a20 2020 2020 2020 2049 6620 696e  ...        If in
+00005460: 2061 2062 6f72 6568 6f6c 6520 7769 7468   a borehole with
+00005470: 2061 2063 6572 7461 696e 2073 7562 7375   a certain subsu
+00005480: 6275 6e69 7420 2865 2e67 2e20 4231 3129  bunit (e.g. B11)
+00005490: 2c20 7468 6973 2069 6e66 6f72 6d61 7469  , this informati
+000054a0: 6f6e 206d 7573 7420 6265 2061 6c73 6f20  on must be also 
+000054b0: 7472 616e 7366 6572 2074 6f20 756e 6974  transfer to unit
+000054c0: 2042 3120 616e 6420 420d 0a20 2020 2020   B1 and B..     
+000054d0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+000054e0: 2064 6f65 7320 7468 6174 2028 4920 6775   does that (I gu
+000054f0: 6573 732e 2e2e 290d 0a20 2020 2020 2020  ess...)..       
+00005500: 2022 2222 0d0a 2020 2020 2020 2020 0d0a   """..        ..
+00005510: 2020 2020 2020 2020 6966 2068 5f6c 6576          if h_lev
+00005520: 203e 2031 3a0d 0a20 2020 2020 2020 2020   > 1:..         
+00005530: 2020 2069 6620 7320 696e 205b 695b 305d     if s in [i[0]
+00005540: 2066 6f72 2069 2069 6e20 6c5f 6c6f 6773   for i in l_logs
+00005550: 5b68 5f6c 6576 2d31 5d5d 3a20 2023 2073  [h_lev-1]]:  # s
+00005560: 7562 5f75 6e69 7420 616c 7265 6164 7920  ub_unit already 
+00005570: 7072 6573 656e 740d 0a20 2020 2020 2020  present..       
+00005580: 2020 2020 2020 2020 2069 6620 7320 3d3d           if s ==
+00005590: 206c 5f6c 6f67 735b 685f 6c65 762d 315d   l_logs[h_lev-1]
+000055a0: 5b2d 315d 5b30 5d3a 2020 2320 6c61 7374  [-1][0]:  # last
+000055b0: 2075 6e69 7420 6164 6465 6420 6973 2074   unit added is t
+000055c0: 6865 2073 616d 6520 2d2d 3e20 6164 6170  he same --> adap
+000055d0: 7420 626f 740d 0a20 2020 2020 2020 2020  t bot..         
+000055e0: 2020 2020 2020 2020 2020 206c 5f6c 6f67             l_log
+000055f0: 735b 685f 6c65 762d 315d 5b2d 315d 5b2d  s[h_lev-1][-1][-
+00005600: 315d 3d62 6f74 2020 2320 6368 616e 6765  1]=bot  # change
+00005610: 2062 6f74 0d0a 2020 2020 2020 2020 2020   bot..          
+00005620: 2020 2020 2020 656c 6966 2073 2e6d 756d        elif s.mum
+00005630: 6d79 5f75 6e69 742e 5375 6250 696c 652e  my_unit.SubPile.
+00005640: 6e61 7475 7265 203d 3d20 2233 645f 6361  nature == "3d_ca
+00005650: 7465 676f 7269 6361 6c22 3a0d 0a20 2020  tegorical":..   
+00005660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005670: 206c 5f6c 6f67 735b 685f 6c65 762d 315d   l_logs[h_lev-1]
+00005680: 2e61 7070 656e 6428 5b73 2c20 746f 702c  .append([s, top,
+00005690: 2062 6f74 5d29 2020 2320 756e 6974 2061   bot])  # unit a
+000056a0: 6c72 6561 6479 2070 7265 7365 6e74 2062  lready present b
+000056b0: 7574 0d0a 2020 2020 2020 2020 2020 2020  ut..            
+000056c0: 656c 6966 2073 206e 6f74 2069 6e20 5b69  elif s not in [i
+000056d0: 5b30 5d20 666f 7220 6920 696e 206c 5f6c  [0] for i in l_l
+000056e0: 6f67 735b 685f 6c65 762d 315d 5d3a 0d0a  ogs[h_lev-1]]:..
+000056f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005700: 6c5f 6c6f 6773 5b68 5f6c 6576 2d31 5d2e  l_logs[h_lev-1].
+00005710: 6170 7065 6e64 285b 732c 2074 6f70 2c20  append([s, top, 
+00005720: 626f 745d 290d 0a20 2020 2020 2020 2020  bot])..         
+00005730: 2020 2068 5f6c 6576 202d 3d20 310d 0a20     h_lev -= 1.. 
+00005740: 2020 2020 2020 2020 2020 2062 6964 756c             bidul
+00005750: 6528 732e 6d75 6d6d 795f 756e 6974 2c20  e(s.mummy_unit, 
+00005760: 685f 6c65 7629 0d0a 2020 2020 2020 2020  h_lev)..        
+00005770: 656c 6966 2068 5f6c 6576 203d 3d20 313a  elif h_lev == 1:
+00005780: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00005790: 2073 206e 6f74 2069 6e20 5b69 5b30 5d20   s not in [i[0] 
+000057a0: 666f 7220 6920 696e 206c 5f6c 6f67 735b  for i in l_logs[
+000057b0: 685f 6c65 762d 315d 5d3a 2020 2320 6164  h_lev-1]]:  # ad
+000057c0: 6420 756e 6974 206f 6e6c 7920 6966 2069  d unit only if i
+000057d0: 7427 7320 6e6f 7420 696e 206c 6f67 0d0a  t's not in log..
+000057e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057f0: 6c5f 6c6f 6773 5b68 5f6c 6576 2d31 5d2e  l_logs[h_lev-1].
+00005800: 6170 7065 6e64 285b 732c 2074 6f70 5d29  append([s, top])
+00005810: 0d0a 0d0a 2020 2020 666f 7220 6920 696e  ....    for i in
+00005820: 2072 616e 6765 286c 656e 286c 6f67 5f73   range(len(log_s
+00005830: 2929 3a0d 0a20 2020 2020 2020 2073 3d6c  )):..        s=l
+00005840: 6f67 5f73 5b69 5d20 2367 6574 2075 6e69  og_s[i] #get uni
+00005850: 7420 616e 6420 636f 6e74 6163 740d 0a20  t and contact.. 
+00005860: 2020 2020 2020 2069 6620 6920 3d3d 206c         if i == l
+00005870: 656e 286c 6f67 5f73 292d 313a 2023 6966  en(log_s)-1: #if
+00005880: 206c 6173 7420 756e 6974 0d0a 2020 2020   last unit..    
+00005890: 2020 2020 2020 2020 626f 7420 3d20 6268          bot = bh
+000058a0: 7a20 2d20 6465 7074 680d 0a20 2020 2020  z - depth..     
+000058b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000058c0: 2020 2020 2020 735f 6166 7420 3d20 6c6f        s_aft = lo
+000058d0: 675f 735b 692b 315d 0d0a 2020 2020 2020  g_s[i+1]..      
+000058e0: 2020 2020 2020 626f 7420 3d20 735f 6166        bot = s_af
+000058f0: 745b 315d 0d0a 2020 2020 2020 2020 756e  t[1]..        un
+00005900: 6974 3d73 5b30 5d20 2367 6574 2075 6e69  it=s[0] #get uni
+00005910: 740d 0a20 2020 2020 2020 2069 6620 756e  t..        if un
+00005920: 6974 2069 7320 6e6f 7420 4e6f 6e65 3a0d  it is not None:.
+00005930: 0a20 2020 2020 2020 2020 2020 2068 5f6c  .            h_l
+00005940: 6576 3d75 6e69 742e 6765 745f 685f 6c65  ev=unit.get_h_le
+00005950: 7665 6c28 290d 0a20 2020 2020 2020 2065  vel()..        e
+00005960: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00005970: 2020 685f 6c65 763d 310d 0a20 2020 2020    h_lev=1..     
+00005980: 2020 2074 6f70 203d 735b 315d 0d0a 0d0a     top =s[1]....
+00005990: 2020 2020 2020 2020 6966 2068 5f6c 6576          if h_lev
+000059a0: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
+000059b0: 2020 2020 6c5f 6c6f 6773 5b68 5f6c 6576      l_logs[h_lev
+000059c0: 2d31 5d2e 6170 7065 6e64 285b 756e 6974  -1].append([unit
+000059d0: 2c20 746f 705d 290d 0a20 2020 2020 2020  , top])..       
+000059e0: 2065 6c69 6620 685f 6c65 7620 3e20 313a   elif h_lev > 1:
+000059f0: 0d0a 2020 2020 2020 2020 2020 2020 6269  ..            bi
+00005a00: 6475 6c65 2875 6e69 742c 2068 5f6c 6576  dule(unit, h_lev
+00005a10: 290d 0a0d 0a20 2020 2023 3173 7420 6f72  )....    #1st or
+00005a20: 6465 7220 6c6f 670d 0a20 2020 2062 683d  der log..    bh=
+00005a30: 626f 7265 686f 6c65 2862 6849 442c 2062  borehole(bhID, b
+00005a40: 6849 442c 2062 6878 2c20 6268 792c 2062  hID, bhx, bhy, b
+00005a50: 687a 2c20 6465 7074 682c 206c 6f67 5f73  hz, depth, log_s
+00005a60: 7472 6174 693d 6c5f 6c6f 6773 5b30 5d2c  trati=l_logs[0],
+00005a70: 206c 6f67 5f66 6163 6965 733d 6268 2e6c   log_facies=bh.l
+00005a80: 6f67 5f66 6163 6965 7329 2023 2066 6972  og_facies) # fir
+00005a90: 7374 2062 6f72 6568 6f6c 650d 0a20 2020  st borehole..   
+00005aa0: 206c 5f62 6873 2e61 7070 656e 6428 6268   l_bhs.append(bh
+00005ab0: 290d 0a0d 0a20 2020 2023 3220 616e 6420  )....    #2 and 
+00005ac0: 6d6f 7265 206f 7264 6572 206c 6f67 730d  more order logs.
+00005ad0: 0a20 2020 2066 6f72 206c 6f67 2069 6e20  .    for log in 
+00005ae0: 6c5f 6c6f 6773 5b31 3a20 5d3a 2023 6c6f  l_logs[1: ]: #lo
+00005af0: 6f70 206f 7665 7220 6469 6666 6572 656e  op over differen
+00005b00: 7420 6c6f 6773 2068 6965 7261 7263 6879  t logs hierarchy
+00005b10: 206c 6576 656c 730d 0a20 2020 2020 2020   levels..       
+00005b20: 2069 5f30 3d30 0d0a 2020 2020 2020 2020   i_0=0..        
+00005b30: 6966 206c 656e 286c 6f67 2920 3e20 313a  if len(log) > 1:
+00005b40: 2023 6d6f 7265 2074 6861 6e20 3120 756e   #more than 1 un
+00005b50: 6974 2069 7320 7072 6573 656e 740d 0a20  it is present.. 
+00005b60: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00005b70: 2069 6e20 7261 6e67 6528 312c 206c 656e   in range(1, len
+00005b80: 286c 6f67 2929 3a0d 0a20 2020 2020 2020  (log)):..       
+00005b90: 2020 2020 2020 2020 2075 6e69 743d 6c6f           unit=lo
+00005ba0: 675b 692d 315d 5b30 5d0d 0a20 2020 2020  g[i-1][0]..     
+00005bb0: 2020 2020 2020 2020 2020 2075 6e69 745f             unit_
+00005bc0: 6166 7465 723d 6c6f 675b 695d 5b30 5d0d  after=log[i][0].
+00005bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005be0: 2069 6620 756e 6974 2e6d 756d 6d79 5f75   if unit.mummy_u
+00005bf0: 6e69 7420 213d 2075 6e69 745f 6166 7465  nit != unit_afte
+00005c00: 722e 6d75 6d6d 795f 756e 6974 3a20 2023  r.mummy_unit:  #
+00005c10: 2063 6865 636b 2074 6861 7420 7477 6f20   check that two 
+00005c20: 7375 6363 6573 7369 7665 2075 6e69 7473  successive units
+00005c30: 2064 6f65 7320 6e6f 7420 6265 6c6f 6e67   does not belong
+00005c40: 2074 6f20 7468 6520 7361 6d65 2068 6965   to the same hie
+00005c50: 7261 7263 6869 6320 6772 6f75 700d 0a20  rarchic group.. 
+00005c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005c70: 2020 206e 6577 5f6c 6f67 3d6c 6f67 5b69     new_log=log[i
+00005c80: 5f30 3a20 695d 0d0a 2020 2020 2020 2020  _0: i]..        
+00005c90: 2020 2020 2020 2020 2020 2020 6465 7074              dept
+00005ca0: 683d 6e65 775f 6c6f 675b 305d 5b31 5d20  h=new_log[0][1] 
+00005cb0: 2d20 6e65 775f 6c6f 675b 2d31 5d5b 325d  - new_log[-1][2]
+00005cc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005cd0: 2020 2020 2020 6c6f 675f 7374 7261 7469        log_strati
+00005ce0: 3d5b 735b 3a20 2d31 5d20 666f 7220 7320  =[s[: -1] for s 
+00005cf0: 696e 206e 6577 5f6c 6f67 5d0d 0a20 2020  in new_log]..   
+00005d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d10: 2062 683d 626f 7265 686f 6c65 2873 7472   bh=borehole(str
+00005d20: 2862 6849 4429 2b22 5f22 2b75 6e69 742e  (bhID)+"_"+unit.
+00005d30: 6e61 6d65 2c20 7374 7228 6268 4944 292b  name, str(bhID)+
+00005d40: 225f 222b 756e 6974 2e6e 616d 652c 2062  "_"+unit.name, b
+00005d50: 6878 2c20 6268 792c 206c 6f67 5f73 7472  hx, bhy, log_str
+00005d60: 6174 695b 305d 5b31 5d2c 2064 6570 7468  ati[0][1], depth
+00005d70: 2c20 6c6f 675f 7374 7261 7469 3d6c 6f67  , log_strati=log
+00005d80: 5f73 7472 6174 6929 0d0a 2020 2020 2020  _strati)..      
+00005d90: 2020 2020 2020 2020 2020 2020 2020 6c5f                l_
+00005da0: 6268 732e 6170 7065 6e64 2862 6829 0d0a  bhs.append(bh)..
+00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dc0: 2020 2020 695f 303d 690d 0a20 2020 2020      i_0=i..     
+00005dd0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+00005de0: 3d3d 206c 656e 286c 6f67 292d 313a 0d0a  == len(log)-1:..
+00005df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005e00: 2020 2020 6e65 775f 6c6f 673d 6c6f 675b      new_log=log[
+00005e10: 695f 303a 205d 0d0a 2020 2020 2020 2020  i_0: ]..        
+00005e20: 2020 2020 2020 2020 2020 2020 6465 7074              dept
+00005e30: 683d 6e65 775f 6c6f 675b 305d 5b31 5d20  h=new_log[0][1] 
+00005e40: 2d20 6e65 775f 6c6f 675b 2d31 5d5b 325d  - new_log[-1][2]
+00005e50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005e60: 2020 2020 2020 6c6f 675f 7374 7261 7469        log_strati
+00005e70: 3d5b 735b 3a20 2d31 5d20 666f 7220 7320  =[s[: -1] for s 
+00005e80: 696e 206e 6577 5f6c 6f67 5d0d 0a20 2020  in new_log]..   
+00005e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ea0: 2062 683d 626f 7265 686f 6c65 2873 7472   bh=borehole(str
+00005eb0: 2862 6849 4429 2b22 5f22 2b75 6e69 745f  (bhID)+"_"+unit_
+00005ec0: 6166 7465 722e 6e61 6d65 2c20 7374 7228  after.name, str(
+00005ed0: 6268 4944 292b 225f 222b 756e 6974 5f61  bhID)+"_"+unit_a
+00005ee0: 6674 6572 2e6e 616d 652c 2062 6878 2c20  fter.name, bhx, 
+00005ef0: 6268 792c 206c 6f67 5f73 7472 6174 695b  bhy, log_strati[
+00005f00: 305d 5b31 5d2c 0d0a 2020 2020 2020 2020  0][1],..        
+00005f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f20: 2020 2020 2020 2020 2020 6465 7074 682c            depth,
+00005f30: 206c 6f67 5f73 7472 6174 693d 6c6f 675f   log_strati=log_
+00005f40: 7374 7261 7469 290d 0a20 2020 2020 2020  strati)..       
+00005f50: 2020 2020 2020 2020 2020 2020 206c 5f62               l_b
+00005f60: 6873 2e61 7070 656e 6428 6268 290d 0a0d  hs.append(bh)...
+00005f70: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00005f80: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+00005f90: 3d6c 6f67 5b30 5d5b 305d 0d0a 2020 2020  =log[0][0]..    
+00005fa0: 2020 2020 2020 2020 6465 7074 683d 6c6f          depth=lo
+00005fb0: 675b 305d 5b31 5d20 2d20 6c6f 675b 2d31  g[0][1] - log[-1
+00005fc0: 5d5b 325d 0d0a 2020 2020 2020 2020 2020  ][2]..          
+00005fd0: 2020 6c6f 675f 7374 7261 7469 3d5b 735b    log_strati=[s[
+00005fe0: 3a20 2d31 5d20 666f 7220 7320 696e 206c  : -1] for s in l
+00005ff0: 6f67 5d0d 0a20 2020 2020 2020 2020 2020  og]..           
+00006000: 2062 683d 626f 7265 686f 6c65 2873 7472   bh=borehole(str
+00006010: 2862 6849 4429 2b22 5f22 2b75 6e69 742e  (bhID)+"_"+unit.
+00006020: 6e61 6d65 2c20 7374 7228 6268 4944 292b  name, str(bhID)+
+00006030: 225f 222b 756e 6974 2e6e 616d 652c 2062  "_"+unit.name, b
+00006040: 6878 2c20 6268 792c 206c 6f67 5f73 7472  hx, bhy, log_str
+00006050: 6174 695b 305d 5b31 5d2c 0d0a 2020 2020  ati[0][1],..    
+00006060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006070: 2020 2020 2020 6465 7074 682c 206c 6f67        depth, log
+00006080: 5f73 7472 6174 693d 6c6f 675f 7374 7261  _strati=log_stra
+00006090: 7469 290d 0a20 2020 2020 2020 2020 2020  ti)..           
+000060a0: 206c 5f62 6873 2e61 7070 656e 6428 6268   l_bhs.append(bh
+000060b0: 290d 0a0d 0a20 2020 2072 6574 7572 6e20  )....    return 
+000060c0: 6c5f 6268 730d 0a0d 0a64 6566 2072 756e  l_bhs....def run
+000060d0: 6e69 6e67 5f6d 6561 6e5f 3244 2878 2c20  ning_mean_2D(x, 
+000060e0: 4e29 3a0d 0a0d 0a20 2020 2022 2222 0d0a  N):....    """..
+000060f0: 2020 2020 536d 6f6f 7468 2061 2032 6420      Smooth a 2d 
+00006100: 7375 7266 6163 650d 0a0d 0a20 2020 2050  surface....    P
+00006110: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+00006120: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078  ---------..    x
+00006130: 3a20 3244 206e 6461 7272 6179 0d0a 2020  : 2D ndarray..  
+00006140: 2020 2020 2020 4172 7261 7920 746f 2073        Array to s
+00006150: 6d6f 6f74 680d 0a20 2020 204e 3a20 696e  mooth..    N: in
+00006160: 740d 0a20 2020 2020 2020 2057 696e 646f  t..        Windo
+00006170: 7720 7365 6d69 2d73 697a 650d 0a0d 0a20  w semi-size.... 
+00006180: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00006190: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2032 4420  -------..    2D 
+000061a0: 6e64 6172 7261 790d 0a20 2020 2022 2222  ndarray..    """
+000061b0: 0d0a 0d0a 2020 2020 733d 782e 636f 7079  ....    s=x.copy
+000061c0: 2829 0d0a 2020 2020 733d 756e 6966 6f72  ()..    s=unifor
+000061d0: 6d5f 6669 6c74 6572 2873 2c20 7369 7a65  m_filter(s, size
+000061e0: 3d4e 2c20 6d6f 6465 3d22 7265 666c 6563  =N, mode="reflec
+000061f0: 7422 290d 0a0d 0a20 2020 2072 6574 7572  t")....    retur
+00006200: 6e20 730d 0a0d 0a0d 0a23 2323 2323 2323  n s......#######
+00006210: 2043 4c41 5353 4553 2023 2323 2323 2323   CLASSES #######
+00006220: 230d 0a63 6c61 7373 2041 7263 685f 7461  #..class Arch_ta
+00006230: 626c 6528 293a 0d0a 0d0a 2020 2020 2222  ble():....    ""
+00006240: 220d 0a0d 0a20 2020 204d 616a 6f72 2063  "....    Major c
+00006250: 6c61 7373 206f 6620 4172 6368 5079 2e20  lass of ArchPy. 
+00006260: 4172 6368 5f74 6162 6c65 2069 7320 7468  Arch_table is th
+00006270: 6520 6365 6e74 7261 6c20 6f62 6a65 6374  e central object
+00006280: 0d0a 2020 2020 7468 6174 2063 616e 2062  ..    that can b
+00006290: 6520 6173 7369 6d69 6c61 7465 6420 6173  e assimilated as
+000062a0: 2061 2022 7072 6f6a 6563 7422 2e0d 0a20   a "project"... 
+000062b0: 2020 2050 7261 6374 6963 616c 6c79 2065     Practically e
+000062c0: 7665 7279 206f 7065 7261 7469 6f6e 7320  very operations 
+000062d0: 6172 6520 646f 6e65 2075 7369 6e67 2061  are done using a
+000062e0: 6e20 4172 6368 5f74 6162 6c65 0d0a 0d0a  n Arch_table....
+000062f0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00006300: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00006310: 2020 2020 6e61 6d65 3a20 7374 720d 0a20      name: str.. 
+00006320: 2020 2020 2020 204e 616d 6520 6f66 2074         Name of t
+00006330: 6865 2070 726f 6a65 6374 0d0a 2020 2020  he project..    
+00006340: 776f 726b 696e 675f 6469 7265 6374 6f72  working_director
+00006350: 793a 2073 7472 0d0a 2020 2020 2020 2020  y: str..        
+00006360: 5061 7468 2074 6f20 7468 6520 776f 726b  Path to the work
+00006370: 696e 6720 6469 7265 6374 6f72 790d 0a20  ing directory.. 
+00006380: 2020 2073 6565 643a 2069 6e74 0d0a 2020     seed: int..  
+00006390: 2020 2020 2020 5365 6564 2066 6f72 2072        Seed for r
+000063a0: 616e 646f 6d20 6e75 6d62 6572 2067 656e  andom number gen
+000063b0: 6572 6174 696f 6e0d 0a20 2020 2077 7269  eration..    wri
+000063c0: 7465 5f72 6573 756c 7473 3a20 626f 6f6c  te_results: bool
+000063d0: 0d0a 2020 2020 2020 2020 4966 2054 7275  ..        If Tru
+000063e0: 652c 2072 6573 756c 7473 2077 696c 6c20  e, results will 
+000063f0: 6265 2077 7269 7474 656e 2074 6f20 6469  be written to di
+00006400: 736b 0d0a 2020 2020 6669 6c6c 5f66 6c61  sk..    fill_fla
+00006410: 673a 2062 6f6f 6c0d 0a20 2020 2020 2020  g: bool..       
+00006420: 2049 6620 5472 7565 2c20 7468 6520 746f   If True, the to
+00006430: 7020 756e 6974 2077 696c 6c20 6265 2066  p unit will be f
+00006440: 696c 6c65 6420 7769 7468 2074 6865 206d  illed with the m
+00006450: 6f73 7420 636f 6d6d 6f6e 2066 6163 6965  ost common facie
+00006460: 730d 0a20 2020 2076 6572 626f 7365 3a20  s..    verbose: 
+00006470: 696e 740d 0a20 2020 2020 2020 2056 6572  int..        Ver
+00006480: 626f 7369 7479 206c 6576 656c 0d0a 2020  bosity level..  
+00006490: 2020 6e63 7075 3a20 696e 740d 0a20 2020    ncpu: int..   
+000064a0: 2020 2020 204e 756d 6265 7220 6f66 2063       Number of c
+000064b0: 7075 7320 746f 2075 7365 2066 6f72 2070  pus to use for p
+000064c0: 6172 616c 6c65 6c20 6f70 6572 6174 696f  arallel operatio
+000064d0: 6e73 2c20 6966 202d 312c 2061 6c6c 2063  ns, if -1, all c
+000064e0: 7075 7320 7769 6c6c 2062 6520 7573 6564  pus will be used
+000064f0: 0d0a 0d0a 2020 2020 2222 220d 0a0d 0a0d  ....    """.....
+00006500: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00006510: 5f28 7365 6c66 2c20 6e61 6d65 2c20 776f  _(self, name, wo
+00006520: 726b 696e 675f 6469 7265 6374 6f72 793d  rking_directory=
+00006530: 2241 7263 6850 795f 776f 726b 7370 6163  "ArchPy_workspac
+00006540: 6522 2c20 7365 6564 3d6e 702e 7261 6e64  e", seed=np.rand
+00006550: 6f6d 2e72 616e 6469 6e74 2831 6536 292c  om.randint(1e6),
+00006560: 2077 7269 7465 5f72 6573 756c 7473 3d46   write_results=F
+00006570: 616c 7365 2c20 6669 6c6c 5f66 6c61 673d  alse, fill_flag=
+00006580: 4661 6c73 652c 2076 6572 626f 7365 3d31  False, verbose=1
+00006590: 2c20 6e63 7075 3d2d 3129 3a0d 0a0d 0a20  , ncpu=-1):.... 
+000065a0: 2020 2020 2020 2061 7373 6572 7420 6e61         assert na
+000065b0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 2c20  me is not None, 
+000065c0: 2241 206e 616d 6520 6d75 7374 2062 6520  "A name must be 
+000065d0: 7072 6f76 6964 6564 220d 0a20 2020 2020  provided"..     
+000065e0: 2020 2023 2070 7574 2061 7373 6572 7420     # put assert 
+000065f0: 7365 6564 0d0a 0d0a 2020 2020 2020 2020  seed....        
+00006600: 7365 6c66 2e6e 616d 653d 6e61 6d65 0d0a  self.name=name..
+00006610: 2020 2020 2020 2020 7365 6c66 2e77 733d          self.ws=
+00006620: 776f 726b 696e 675f 6469 7265 6374 6f72  working_director
+00006630: 7920 2023 776f 726b 696e 6720 6469 7265  y  #working dire
+00006640: 6374 7920 7768 6572 6520 6669 6c65 7320  cty where files 
+00006650: 7769 6c6c 2062 6520 6372 6561 7465 640d  will be created.
+00006660: 0a20 2020 2020 2020 2073 656c 662e 6c69  .        self.li
+00006670: 7374 5f61 6c6c 5f75 6e69 7473 3d5b 5d0d  st_all_units=[].
+00006680: 0a20 2020 2020 2020 2073 656c 662e 6c69  .        self.li
+00006690: 7374 5f61 6c6c 5f66 6163 6965 733d 5b5d  st_all_facies=[]
+000066a0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000066b0: 6973 745f 6268 733d 5b5d 2023 206c 6973  ist_bhs=[] # lis
+000066c0: 7420 6f66 2062 6f72 6568 6f6c 6573 2066  t of boreholes f
+000066d0: 6f72 2068 640d 0a20 2020 2020 2020 2073  or hd..        s
+000066e0: 656c 662e 6c69 7374 5f66 616b 655f 6268  elf.list_fake_bh
+000066f0: 733d 5b5d 2023 206c 6973 7420 6f66 2022  s=[] # list of "
+00006700: 6661 6b65 2220 626f 7265 686f 6c65 730d  fake" boreholes.
+00006710: 0a20 2020 2020 2020 2073 656c 662e 6c69  .        self.li
+00006720: 7374 5f6d 6170 5f62 6873 3d5b 5d0d 0a20  st_map_bhs=[].. 
+00006730: 2020 2020 2020 2073 656c 662e 7374 6f5f         self.sto_
+00006740: 6864 203d 205b 5d20 2023 2073 746f 6368  hd = []  # stoch
+00006750: 6173 7469 6320 6861 7264 2064 6174 610d  astic hard data.
+00006760: 0a20 2020 2020 2020 2073 656c 662e 6c69  .        self.li
+00006770: 7374 5f70 726f 7073 3d5b 5d0d 0a20 2020  st_props=[]..   
+00006780: 2020 2020 2073 656c 662e 7365 6564 3d69       self.seed=i
+00006790: 6e74 2831 6536 2a73 6565 6429 0d0a 2020  nt(1e6*seed)..  
+000067a0: 2020 2020 2020 7365 6c66 2e76 6572 626f        self.verbo
+000067b0: 7365 3d76 6572 626f 7365 2020 2320 303a  se=verbose  # 0:
+000067c0: 2070 7269 6e74 2028 7175 6173 6929 2d6e   print (quasi)-n
+000067d0: 6f74 6869 6e67 2c20 313a 2070 7269 6e74  othing, 1: print
+000067e0: 2065 7665 7279 7468 696e 670d 0a20 2020   everything..   
+000067f0: 2020 2020 2073 656c 662e 6e63 7075 3d6e       self.ncpu=n
+00006800: 6370 750d 0a20 2020 2020 2020 2073 656c  cpu..        sel
+00006810: 662e 7867 3d4e 6f6e 650d 0a20 2020 2020  f.xg=None..     
+00006820: 2020 2073 656c 662e 7967 3d4e 6f6e 650d     self.yg=None.
+00006830: 0a20 2020 2020 2020 2073 656c 662e 7a67  .        self.zg
+00006840: 3d4e 6f6e 650d 0a20 2020 2020 2020 2073  =None..        s
+00006850: 656c 662e 7867 6320 3d4e 6f6e 650d 0a20  elf.xgc =None.. 
+00006860: 2020 2020 2020 2073 656c 662e 7967 633d         self.ygc=
+00006870: 4e6f 6e65 0d0a 2020 2020 2020 2020 7365  None..        se
+00006880: 6c66 2e7a 6763 3d4e 6f6e 650d 0a20 2020  lf.zgc=None..   
+00006890: 2020 2020 2073 656c 662e 7378 3d4e 6f6e       self.sx=Non
+000068a0: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+000068b0: 7379 3d4e 6f6e 650d 0a20 2020 2020 2020  sy=None..       
+000068c0: 2073 656c 662e 737a 3d4e 6f6e 650d 0a20   self.sz=None.. 
+000068d0: 2020 2020 2020 2073 656c 662e 6f78 3d4e         self.ox=N
+000068e0: 6f6e 650d 0a20 2020 2020 2020 2073 656c  one..        sel
+000068f0: 662e 6f79 3d4e 6f6e 650d 0a20 2020 2020  f.oy=None..     
+00006900: 2020 2073 656c 662e 6f7a 3d4e 6f6e 650d     self.oz=None.
+00006910: 0a20 2020 2020 2020 2073 656c 662e 6e78  .        self.nx
+00006920: 3d4e 6f6e 650d 0a20 2020 2020 2020 2073  =None..        s
+00006930: 656c 662e 6e79 3d4e 6f6e 650d 0a20 2020  elf.ny=None..   
+00006940: 2020 2020 2073 656c 662e 6e7a 3d4e 6f6e       self.nz=Non
+00006950: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+00006960: 5069 6c65 5f6d 6173 7465 723d 4e6f 6e65  Pile_master=None
+00006970: 0d0a 2020 2020 2020 2020 7365 6c66 2e67  ..        self.g
+00006980: 656f 6c5f 6d61 703d 4e6f 6e65 0d0a 2020  eol_map=None..  
+00006990: 2020 2020 2020 7365 6c66 2e77 7269 7465        self.write
+000069a0: 5f72 6573 756c 7473 3d77 7269 7465 5f72  _results=write_r
+000069b0: 6573 756c 7473 0d0a 2020 2020 2020 2020  esults..        
+000069c0: 7365 6c66 2e62 6873 5f70 726f 6365 7373  self.bhs_process
+000069d0: 6564 3d30 2020 2320 666c 6167 2074 6f20  ed=0  # flag to 
+000069e0: 6b6e 6f77 2069 6620 626f 7265 686f 6c65  know if borehole
+000069f0: 7320 6861 7665 2062 6565 6e20 7072 6f63  s have been proc
+00006a00: 6573 7365 640d 0a20 2020 2020 2020 2073  essed..        s
+00006a10: 656c 662e 7375 7266 6163 6573 5f63 6f6d  elf.surfaces_com
+00006a20: 7075 7465 643d 300d 0a20 2020 2020 2020  puted=0..       
+00006a30: 2073 656c 662e 6661 6369 6573 5f63 6f6d   self.facies_com
+00006a40: 7075 7465 643d 300d 0a20 2020 2020 2020  puted=0..       
+00006a50: 2073 656c 662e 7072 6f70 5f63 6f6d 7075   self.prop_compu
+00006a60: 7465 643d 300d 0a20 2020 2020 2020 2073  ted=0..        s
+00006a70: 656c 662e 6e72 6561 6c5f 756e 6974 733d  elf.nreal_units=
+00006a80: 300d 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00006a90: 6e72 6561 6c5f 6661 3d30 0d0a 2020 2020  nreal_fa=0..    
+00006aa0: 2020 2020 7365 6c66 2e6e 7265 616c 5f70      self.nreal_p
+00006ab0: 726f 703d 300d 0a20 2020 2020 2020 2073  rop=0..        s
+00006ac0: 656c 662e 6669 6c6c 5f66 6c61 6720 3d20  elf.fill_flag = 
+00006ad0: 6669 6c6c 5f66 6c61 670d 0a20 2020 2020  fill_flag..     
+00006ae0: 2020 2073 656c 662e 4765 6f6c 3d47 656f     self.Geol=Geo
+00006af0: 6c28 290d 0a0d 0a20 2020 2023 6765 7420  l()....    #get 
+00006b00: 6675 6e63 7469 6f6e 730d 0a20 2020 2064  functions..    d
+00006b10: 6566 2067 6574 5f70 696c 655f 6d61 7374  ef get_pile_mast
+00006b20: 6572 2873 656c 6629 3a0d 0a0d 0a20 2020  er(self):....   
+00006b30: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00006b40: 2020 5265 7475 726e 7320 7468 6520 5069    Returns the Pi
+00006b50: 6c65 5f6d 6173 7465 7220 6f62 6a65 6374  le_master object
+00006b60: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00006b70: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00006b80: 2e50 696c 655f 6d61 7374 6572 2069 7320  .Pile_master is 
+00006b90: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00006ba0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00006bb0: 726f 7220 2822 4e6f 2050 696c 6520 6d61  ror ("No Pile ma
+00006bc0: 7374 6572 2064 6566 696e 6564 2066 6f72  ster defined for
+00006bd0: 2041 7263 6820 5461 626c 6520 7b7d 222e   Arch Table {}".
+00006be0: 666f 726d 6174 2873 656c 662e 6e61 6d65  format(self.name
+00006bf0: 2929 0d0a 2020 2020 2020 2020 7265 7475  ))..        retu
+00006c00: 726e 2073 656c 662e 5069 6c65 5f6d 6173  rn self.Pile_mas
+00006c10: 7465 720d 0a0d 0a20 2020 2064 6566 2067  ter....    def g
+00006c20: 6574 5f78 6728 7365 6c66 293a 0d0a 2020  et_xg(self):..  
+00006c30: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
+00006c40: 2074 6865 2065 6467 6573 206f 6620 7468   the edges of th
+00006c50: 6520 6772 6964 2069 6e20 7820 6469 7265  e grid in x dire
+00006c60: 6374 696f 6e22 2222 0d0a 2020 2020 2020  ction"""..      
+00006c70: 2020 6966 2073 656c 662e 7867 2069 7320    if self.xg is 
+00006c80: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00006c90: 2020 2061 7373 6572 7420 302c 2028 2745     assert 0, ('E
+00006ca0: 7272 6f72 3a20 4772 6964 2077 6173 206e  rror: Grid was n
+00006cb0: 6f74 2061 6464 6564 2729 0d0a 2020 2020  ot added')..    
+00006cc0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00006cd0: 7867 0d0a 0d0a 2020 2020 6465 6620 6765  xg....    def ge
+00006ce0: 745f 7967 2873 656c 6629 3a0d 0a20 2020  t_yg(self):..   
+00006cf0: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+00006d00: 7468 6520 6564 6765 7320 6f66 2074 6865  the edges of the
+00006d10: 2067 7269 6420 696e 2079 2064 6972 6563   grid in y direc
+00006d20: 7469 6f6e 2222 220d 0a20 2020 2020 2020  tion"""..       
+00006d30: 2069 6620 7365 6c66 2e79 6720 6973 204e   if self.yg is N
+00006d40: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00006d50: 2020 6173 7365 7274 2030 2c20 2827 4572    assert 0, ('Er
+00006d60: 726f 723a 2047 7269 6420 7761 7320 6e6f  ror: Grid was no
+00006d70: 7420 6164 6465 6427 290d 0a20 2020 2020  t added')..     
+00006d80: 2020 2072 6574 7572 6e20 7365 6c66 2e79     return self.y
+00006d90: 670d 0a0d 0a20 2020 2064 6566 2067 6574  g....    def get
+00006da0: 5f7a 6728 7365 6c66 293a 0d0a 2020 2020  _zg(self):..    
+00006db0: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00006dc0: 6865 2065 6467 6573 206f 6620 7468 6520  he edges of the 
+00006dd0: 6772 6964 2069 6e20 7a20 6469 7265 6374  grid in z direct
+00006de0: 696f 6e22 2222 0d0a 2020 2020 2020 2020  ion"""..        
+00006df0: 6966 2073 656c 662e 7a67 2069 7320 4e6f  if self.zg is No
+00006e00: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00006e10: 2061 7373 6572 7420 302c 2028 2745 7272   assert 0, ('Err
+00006e20: 6f72 3a20 4772 6964 2077 6173 206e 6f74  or: Grid was not
+00006e30: 2061 6464 6564 2729 0d0a 2020 2020 2020   added')..      
+00006e40: 2020 7265 7475 726e 2073 656c 662e 7a67    return self.zg
+00006e50: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
+00006e60: 7867 6328 7365 6c66 293a 0d0a 2020 2020  xgc(self):..    
+00006e70: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
+00006e80: 6865 2063 656e 7465 7273 206f 6620 7468  he centers of th
+00006e90: 6520 6772 6964 2069 6e20 7820 6469 7265  e grid in x dire
+00006ea0: 6374 696f 6e22 2222 0d0a 2020 2020 2020  ction"""..      
+00006eb0: 2020 6966 2073 656c 662e 7867 6320 6973    if self.xgc is
+00006ec0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00006ed0: 2020 2020 6173 7365 7274 2030 2c20 2827      assert 0, ('
+00006ee0: 4572 726f 723a 2047 7269 6420 7761 7320  Error: Grid was 
+00006ef0: 6e6f 7420 6164 6465 6427 290d 0a20 2020  not added')..   
+00006f00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00006f10: 2e78 6763 0d0a 0d0a 2020 2020 6465 6620  .xgc....    def 
+00006f20: 6765 745f 7967 6328 7365 6c66 293a 0d0a  get_ygc(self):..
+00006f30: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+00006f40: 6e73 2074 6865 2063 656e 7465 7273 206f  ns the centers o
+00006f50: 6620 7468 6520 6772 6964 2069 6e20 7920  f the grid in y 
+00006f60: 6469 7265 6374 696f 6e22 2222 0d0a 2020  direction"""..  
+00006f70: 2020 2020 2020 6966 2073 656c 662e 7967        if self.yg
+00006f80: 6320 6973 204e 6f6e 653a 0d0a 2020 2020  c is None:..    
+00006f90: 2020 2020 2020 2020 6173 7365 7274 2030          assert 0
+00006fa0: 2c20 2827 4572 726f 723a 2047 7269 6420  , ('Error: Grid 
+00006fb0: 7761 7320 6e6f 7420 6164 6465 6427 290d  was not added').
+00006fc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006fd0: 7365 6c66 2e79 6763 0d0a 0d0a 2020 2020  self.ygc....    
+00006fe0: 6465 6620 6765 745f 7a67 6328 7365 6c66  def get_zgc(self
+00006ff0: 293a 0d0a 2020 2020 2020 2020 2222 2252  ):..        """R
+00007000: 6574 7572 6e73 2074 6865 2063 656e 7465  eturns the cente
+00007010: 7273 206f 6620 7468 6520 6772 6964 2069  rs of the grid i
+00007020: 6e20 7a20 6469 7265 6374 696f 6e22 2222  n z direction"""
+00007030: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00007040: 662e 7a67 2069 7320 4e6f 6e65 3a0d 0a20  f.zg is None:.. 
+00007050: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00007060: 7420 302c 2028 2745 7272 6f72 3a20 4772  t 0, ('Error: Gr
+00007070: 6964 2077 6173 206e 6f74 2061 6464 6564  id was not added
+00007080: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
+00007090: 726e 2073 656c 662e 7a67 630d 0a20 2020  rn self.zgc..   
+000070a0: 2064 6566 2067 6574 5f6e 7828 7365 6c66   def get_nx(self
+000070b0: 293a 0d0a 2020 2020 2020 2020 2222 2252  ):..        """R
+000070c0: 6574 7572 6e73 2074 6865 206e 756d 6265  eturns the numbe
+000070d0: 7220 6f66 2063 656c 6c73 2069 6e20 7820  r of cells in x 
+000070e0: 6469 7265 6374 696f 6e22 2222 0d0a 2020  direction"""..  
+000070f0: 2020 2020 2020 6966 2073 656c 662e 6e78        if self.nx
+00007100: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+00007110: 2020 2020 2020 2061 7373 6572 7420 302c         assert 0,
+00007120: 2028 2745 7272 6f72 3a20 4772 6964 2077   ('Error: Grid w
+00007130: 6173 206e 6f74 2061 6464 6564 2729 0d0a  as not added')..
+00007140: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00007150: 656c 662e 6e78 0d0a 0d0a 2020 2020 6465  elf.nx....    de
+00007160: 6620 6765 745f 6e79 2873 656c 6629 3a0d  f get_ny(self):.
+00007170: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00007180: 726e 7320 7468 6520 6e75 6d62 6572 206f  rns the number o
+00007190: 6620 6365 6c6c 7320 696e 2079 2064 6972  f cells in y dir
+000071a0: 6563 7469 6f6e 2222 220d 0a20 2020 2020  ection"""..     
+000071b0: 2020 2069 6620 7365 6c66 2e6e 7920 6973     if self.ny is
+000071c0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+000071d0: 2020 2020 6173 7365 7274 2030 2c20 2827      assert 0, ('
+000071e0: 4572 726f 723a 2047 7269 6420 7761 7320  Error: Grid was 
+000071f0: 6e6f 7420 6164 6465 6427 290d 0a20 2020  not added')..   
+00007200: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00007210: 2e6e 790d 0a0d 0a20 2020 2064 6566 2067  .ny....    def g
+00007220: 6574 5f6e 7a28 7365 6c66 293a 0d0a 2020  et_nz(self):..  
+00007230: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
+00007240: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
+00007250: 656c 6c73 2069 6e20 7a20 6469 7265 6374  ells in z direct
+00007260: 696f 6e22 2222 0d0a 2020 2020 2020 2020  ion"""..        
+00007270: 6966 2073 656c 662e 6e7a 2069 7320 4e6f  if self.nz is No
+00007280: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00007290: 2061 7373 6572 7420 302c 2028 2745 7272   assert 0, ('Err
+000072a0: 6f72 3a20 4772 6964 2077 6173 206e 6f74  or: Grid was not
+000072b0: 2061 6464 6564 2729 0d0a 2020 2020 2020   added')..      
+000072c0: 2020 7265 7475 726e 2073 656c 662e 6e7a    return self.nz
+000072d0: 0d0a 2020 2020 6465 6620 6765 745f 7378  ..    def get_sx
+000072e0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
+000072f0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+00007300: 7369 7a65 206f 6620 7468 6520 6365 6c6c  size of the cell
+00007310: 7320 696e 2078 2064 6972 6563 7469 6f6e  s in x direction
+00007320: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00007330: 7365 6c66 2e73 7820 6973 204e 6f6e 653a  self.sx is None:
+00007340: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
+00007350: 7365 7274 2030 2c20 2827 4572 726f 723a  sert 0, ('Error:
+00007360: 2047 7269 6420 7761 7320 6e6f 7420 6164   Grid was not ad
+00007370: 6465 6427 290d 0a20 2020 2020 2020 2072  ded')..        r
+00007380: 6574 7572 6e20 7365 6c66 2e73 780d 0a0d  eturn self.sx...
+00007390: 0a20 2020 2064 6566 2067 6574 5f73 7928  .    def get_sy(
+000073a0: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
+000073b0: 2222 2252 6574 7572 6e73 2074 6865 2073  """Returns the s
+000073c0: 697a 6520 6f66 2074 6865 2063 656c 6c73  ize of the cells
+000073d0: 2069 6e20 7920 6469 7265 6374 696f 6e22   in y direction"
+000073e0: 2222 0d0a 2020 2020 2020 2020 6966 2073  ""..        if s
+000073f0: 656c 662e 7379 2069 7320 4e6f 6e65 3a0d  elf.sy is None:.
+00007400: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00007410: 6572 7420 302c 2028 2745 7272 6f72 3a20  ert 0, ('Error: 
+00007420: 4772 6964 2077 6173 206e 6f74 2061 6464  Grid was not add
+00007430: 6564 2729 0d0a 2020 2020 2020 2020 7265  ed')..        re
+00007440: 7475 726e 2073 656c 662e 7379 0d0a 0d0a  turn self.sy....
+00007450: 2020 2020 6465 6620 6765 745f 737a 2873      def get_sz(s
+00007460: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00007470: 2222 5265 7475 726e 7320 7468 6520 7369  ""Returns the si
+00007480: 7a65 206f 6620 7468 6520 6365 6c6c 7320  ze of the cells 
+00007490: 696e 207a 2064 6972 6563 7469 6f6e 2222  in z direction""
+000074a0: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
+000074b0: 6c66 2e73 7a20 6973 204e 6f6e 653a 0d0a  lf.sz is None:..
+000074c0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+000074d0: 7274 2030 2c20 2827 4572 726f 723a 2047  rt 0, ('Error: G
+000074e0: 7269 6420 7761 7320 6e6f 7420 6164 6465  rid was not adde
+000074f0: 6427 290d 0a20 2020 2020 2020 2072 6574  d')..        ret
+00007500: 7572 6e20 7365 6c66 2e73 7a0d 0a0d 0a20  urn self.sz.... 
+00007510: 2020 2064 6566 2067 6574 5f6f 7828 7365     def get_ox(se
+00007520: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+00007530: 2252 6574 7572 6e73 2074 6865 206f 7269  "Returns the ori
+00007540: 6769 6e20 6f66 2074 6865 2067 7269 6420  gin of the grid 
+00007550: 696e 2078 2064 6972 6563 7469 6f6e 2222  in x direction""
+00007560: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
+00007570: 6c66 2e6f 7820 6973 204e 6f6e 653a 0d0a  lf.ox is None:..
+00007580: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00007590: 7274 2030 2c20 2827 4572 726f 723a 2047  rt 0, ('Error: G
+000075a0: 7269 6420 7761 7320 6e6f 7420 6164 6465  rid was not adde
+000075b0: 6427 290d 0a20 2020 2020 2020 2072 6574  d')..        ret
+000075c0: 7572 6e20 7365 6c66 2e6f 780d 0a0d 0a20  urn self.ox.... 
+000075d0: 2020 2064 6566 2067 6574 5f6f 7928 7365     def get_oy(se
+000075e0: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+000075f0: 2252 6574 7572 6e73 2074 6865 206f 7269  "Returns the ori
+00007600: 6769 6e20 6f66 2074 6865 2067 7269 6420  gin of the grid 
+00007610: 696e 2079 2064 6972 6563 7469 6f6e 2222  in y direction""
+00007620: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
+00007630: 6c66 2e6f 7920 6973 204e 6f6e 653a 0d0a  lf.oy is None:..
+00007640: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00007650: 7274 2030 2c20 2827 4572 726f 723a 2047  rt 0, ('Error: G
+00007660: 7269 6420 7761 7320 6e6f 7420 6164 6465  rid was not adde
+00007670: 6427 290d 0a20 2020 2020 2020 2072 6574  d')..        ret
+00007680: 7572 6e20 7365 6c66 2e6f 790d 0a0d 0a20  urn self.oy.... 
+00007690: 2020 2064 6566 2067 6574 5f6f 7a28 7365     def get_oz(se
+000076a0: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
+000076b0: 2252 6574 7572 6e73 2074 6865 206f 7269  "Returns the ori
+000076c0: 6769 6e20 6f66 2074 6865 2067 7269 6420  gin of the grid 
+000076d0: 696e 207a 2064 6972 6563 7469 6f6e 2222  in z direction""
+000076e0: 220d 0a20 2020 2020 2020 2069 6620 7365  "..        if se
+000076f0: 6c66 2e6f 7a20 6973 204e 6f6e 653a 0d0a  lf.oz is None:..
+00007700: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00007710: 7274 2030 2c20 2827 4572 726f 723a 2047  rt 0, ('Error: G
+00007720: 7269 6420 7761 7320 6e6f 7420 6164 6465  rid was not adde
+00007730: 6427 290d 0a20 2020 2020 2020 2072 6574  d')..        ret
+00007740: 7572 6e20 7365 6c66 2e6f 7a0d 0a0d 0a20  urn self.oz.... 
+00007750: 2020 2064 6566 2067 6574 5f66 6163 6965     def get_facie
+00007760: 7328 7365 6c66 2c20 6975 3d30 2c20 6966  s(self, iu=0, if
+00007770: 613d 302c 2061 6c6c 5f64 6174 613d 5472  a=0, all_data=Tr
+00007780: 7565 293a 0d0a 0d0a 2020 2020 2020 2020  ue):....        
+00007790: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
+000077a0: 7572 6e20 6120 6e75 6d70 7920 6172 7261  urn a numpy arra
+000077b0: 7920 6f66 2031 206f 7220 616c 6c20 6661  y of 1 or all fa
+000077c0: 6369 6573 2072 6561 6c69 7a61 7469 6f6e  cies realization
+000077d0: 2873 292e 0d0a 0d0a 2020 2020 2020 2020  (s).....        
+000077e0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+000077f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00007800: 2020 2020 2020 2020 6975 3a20 696e 740d          iu: int.
+00007810: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
+00007820: 7420 696e 6465 780d 0a20 2020 2020 2020  t index..       
+00007830: 2069 6661 3a20 696e 740d 0a20 2020 2020   ifa: int..     
+00007840: 2020 2020 2020 2066 6163 6965 7320 696e         facies in
+00007850: 6465 780d 0a20 2020 2020 2020 2061 6c6c  dex..        all
+00007860: 5f64 6174 613a 2062 6f6f 6c0d 0a20 2020  _data: bool..   
+00007870: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00007880: 616c 6c20 7468 6520 756e 6974 7320 7369  all the units si
+00007890: 6d75 6c61 7469 6f6e 730d 0a0d 0a20 2020  mulations....   
+000078a0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+000078b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+000078c0: 2020 2020 2020 206e 6461 7272 6179 0d0a         ndarray..
+000078d0: 2020 2020 2020 2020 2020 2020 6661 6369              faci
+000078e0: 6573 2064 6f6d 6169 6e73 0d0a 2020 2020  es domains..    
+000078f0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00007900: 2020 2069 6620 7365 6c66 2e77 7269 7465     if self.write
+00007910: 5f72 6573 756c 7473 3a0d 0a20 2020 2020  _results:..     
+00007920: 2020 2020 2020 2069 6620 2266 6422 206e         if "fd" n
+00007930: 6f74 2069 6e20 5b69 2e73 706c 6974 2822  ot in [i.split("
+00007940: 2e22 295b 2d31 5d20 666f 7220 6920 696e  .")[-1] for i in
+00007950: 206f 732e 6c69 7374 6469 7228 7365 6c66   os.listdir(self
+00007960: 2e77 7329 5d3a 0d0a 2020 2020 2020 2020  .ws)]:..        
+00007970: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00007980: 6c75 6545 7272 6f72 2822 4661 6369 6573  lueError("Facies
+00007990: 2068 6176 6520 6e6f 7420 6265 656e 2063   have not been c
+000079a0: 6f6d 7075 7465 6420 7965 7422 290d 0a0d  omputed yet")...
+000079b0: 0a20 2020 2020 2020 2069 6620 616c 6c5f  .        if all_
+000079c0: 6461 7461 3a0d 0a20 2020 2020 2020 2020  data:..         
+000079d0: 2020 2023 2067 6574 2061 6c6c 2072 6561     # get all rea
+000079e0: 6c0d 0a20 2020 2020 2020 2020 2020 2069  l..            i
+000079f0: 6620 7365 6c66 2e77 7269 7465 5f72 6573  f self.write_res
+00007a00: 756c 7473 3a0d 0a20 2020 2020 2020 2020  ults:..         
+00007a10: 2020 2020 2020 206e 7265 616c 5f66 613d         nreal_fa=
+00007a20: 7365 6c66 2e6e 7265 616c 5f66 610d 0a20  self.nreal_fa.. 
+00007a30: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00007a40: 7265 616c 5f75 3d73 656c 662e 6e72 6561  real_u=self.nrea
+00007a50: 6c5f 756e 6974 730d 0a20 2020 2020 2020  l_units..       
+00007a60: 2020 2020 2020 2020 206e 783d 7365 6c66           nx=self
+00007a70: 2e67 6574 5f6e 7828 290d 0a20 2020 2020  .get_nx()..     
+00007a80: 2020 2020 2020 2020 2020 206e 793d 7365             ny=se
+00007a90: 6c66 2e67 6574 5f6e 7928 290d 0a20 2020  lf.get_ny()..   
+00007aa0: 2020 2020 2020 2020 2020 2020 206e 7a3d               nz=
+00007ab0: 7365 6c66 2e67 6574 5f6e 7a28 290d 0a20  self.get_nz().. 
+00007ac0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00007ad0: 643d 6e70 2e7a 6572 6f73 285b 6e72 6561  d=np.zeros([nrea
+00007ae0: 6c5f 752c 206e 7265 616c 5f66 612c 206e  l_u, nreal_fa, n
+00007af0: 7a2c 206e 792c 206e 785d 2c20 6474 7970  z, ny, nx], dtyp
+00007b00: 653d 6e70 2e69 6e74 3829 0d0a 2020 2020  e=np.int8)..    
+00007b10: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00007b20: 6975 2069 6e20 7261 6e67 6528 6e72 6561  iu in range(nrea
+00007b30: 6c5f 7529 3a0d 0a20 2020 2020 2020 2020  l_u):..         
+00007b40: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00007b50: 6661 2069 6e20 7261 6e67 6528 6e72 6561  fa in range(nrea
+00007b60: 6c5f 6661 293a 0d0a 2020 2020 2020 2020  l_fa):..        
+00007b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b80: 666e 616d 653d 7365 6c66 2e6e 616d 652b  fname=self.name+
+00007b90: 225f 7b7d 5f7b 7d2e 6664 222e 666f 726d  "_{}_{}.fd".form
+00007ba0: 6174 2869 752c 2069 6661 290d 0a20 2020  at(iu, ifa)..   
+00007bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007bc0: 2020 2020 2066 7061 7468 3d6f 732e 7061       fpath=os.pa
+00007bd0: 7468 2e6a 6f69 6e28 7365 6c66 2e77 732c  th.join(self.ws,
+00007be0: 2066 6e61 6d65 290d 0a20 2020 2020 2020   fname)..       
+00007bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c00: 2077 6974 6820 6f70 656e 2866 7061 7468   with open(fpath
+00007c10: 2c20 2272 6222 2920 6173 2066 3a0d 0a20  , "rb") as f:.. 
+00007c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c30: 2020 2020 2020 2020 2020 2066 645b 6975             fd[iu
+00007c40: 2c20 6966 615d 3d70 6963 6b6c 652e 6c6f  , ifa]=pickle.lo
+00007c50: 6164 2866 290d 0a20 2020 2020 2020 2020  ad(f)..         
+00007c60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00007c70: 2020 2020 2020 2020 2020 6664 3d73 656c            fd=sel
+00007c80: 662e 4765 6f6c 2e66 6163 6965 735f 646f  f.Geol.facies_do
+00007c90: 6d61 696e 732e 636f 7079 2829 0d0a 2020  mains.copy()..  
+00007ca0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00007cb0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00007cc0: 2e77 7269 7465 5f72 6573 756c 7473 3a0d  .write_results:.
+00007cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007ce0: 2066 6e61 6d65 3d73 656c 662e 6e61 6d65   fname=self.name
+00007cf0: 2b22 5f7b 7d5f 7b7d 2e66 6422 2e66 6f72  +"_{}_{}.fd".for
+00007d00: 6d61 7428 6975 2c20 6966 6129 0d0a 2020  mat(iu, ifa)..  
+00007d10: 2020 2020 2020 2020 2020 2020 2020 6670                fp
+00007d20: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
+00007d30: 2873 656c 662e 7773 2c20 666e 616d 6529  (self.ws, fname)
+00007d40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00007d50: 2020 7769 7468 206f 7065 6e28 6670 6174    with open(fpat
+00007d60: 682c 2022 7262 2229 2061 7320 663a 0d0a  h, "rb") as f:..
+00007d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d80: 2020 2020 6664 3d70 6963 6b6c 652e 6c6f      fd=pickle.lo
+00007d90: 6164 2866 290d 0a20 2020 2020 2020 2020  ad(f)..         
+00007da0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00007db0: 2020 2020 2020 2020 2020 6664 3d73 656c            fd=sel
+00007dc0: 662e 4765 6f6c 2e66 6163 6965 735f 646f  f.Geol.facies_do
+00007dd0: 6d61 696e 735b 6975 2c20 6966 615d 2e63  mains[iu, ifa].c
+00007de0: 6f70 7928 290d 0a0d 0a20 2020 2020 2020  opy()....       
+00007df0: 2072 6574 7572 6e20 6664 0d0a 0d0a 2020   return fd....  
+00007e00: 2020 6465 6620 6765 745f 7375 7266 6163    def get_surfac
+00007e10: 6573 5f75 6e69 7428 7365 6c66 2c20 756e  es_unit(self, un
+00007e20: 6974 2c20 7479 703d 2274 6f70 2229 3a0d  it, typ="top"):.
+00007e30: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00007e40: 2020 2020 2020 2020 5265 7475 726e 2061          Return a
+00007e50: 2033 4420 6172 7261 7920 6f66 2063 6f6d   3D array of com
+00007e60: 7075 7465 6420 7375 7266 6163 6573 2066  puted surfaces f
+00007e70: 6f72 2061 2073 7065 6369 6669 6320 756e  or a specific un
+00007e80: 6974 0d0a 0d0a 2020 2020 2020 2020 5061  it....        Pa
+00007e90: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00007ea0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00007eb0: 2020 2020 2020 756e 6974 3a20 3a63 6c61        unit: :cla
+00007ec0: 7373 3a60 556e 6974 6020 6f62 6a65 6374  ss:`Unit` object
+00007ed0: 0d0a 2020 2020 2020 2020 2020 2020 6120  ..            a 
+00007ee0: 556e 6974 206f 626a 6563 7420 636f 6e74  Unit object cont
+00007ef0: 6169 6e65 6420 696e 7369 6465 2074 6865  ained inside the
+00007f00: 206d 6173 7465 7220 7069 6c65 0d0a 2020   master pile..  
+00007f10: 2020 2020 2020 2020 2020 6f72 2061 6e6f            or ano
+00007f20: 7468 6572 2073 7562 756e 6974 0d0a 2020  ther subunit..  
+00007f30: 2020 2020 2020 7479 703a 2073 7472 696e        typ: strin
+00007f40: 672c 2028 746f 702c 2062 6f74 206f 7220  g, (top, bot or 
+00007f50: 6f72 6967 696e 616c 292c 0d0a 2020 2020  original),..    
+00007f60: 2020 2020 2020 2020 7370 6563 6966 7920          specify 
+00007f70: 7768 6963 6820 7479 7065 206f 6620 7375  which type of su
+00007f80: 7266 6163 6520 746f 2072 6574 7572 6e2c  rface to return,
+00007f90: 2074 6f70 2c0d 0a20 2020 2020 2020 2020   top,..         
+00007fa0: 2020 2062 6f74 206f 7220 6f72 6967 696e     bot or origin
+00007fb0: 616c 2028 7375 7266 6163 6573 2062 6566  al (surfaces bef
+00007fc0: 6f72 6520 6170 706c 7969 6e67 2065 726f  ore applying ero
+00007fd0: 7369 6f6e 0d0a 2020 2020 2020 2020 2020  sion..          
+00007fe0: 2020 616e 6420 7374 7261 7469 6772 6170    and stratigrap
+00007ff0: 6963 2072 756c 6573 290d 0a0d 0a20 2020  ic rules)....   
+00008000: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00008010: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00008020: 2020 2020 2020 2033 4420 6e64 6172 7261         3D ndarra
+00008030: 7920 6f66 2073 697a 6520 286e 7265 616c  y of size (nreal
+00008040: 5f75 6e69 7473 2c20 6e79 2c20 6e78 290d  _units, ny, nx).
+00008050: 0a20 2020 2020 2020 2020 2020 2041 6c6c  .            All
+00008060: 2063 6f6d 7075 7465 6420 7375 7266 6163   computed surfac
+00008070: 6573 2069 6e20 6120 6e64 2e61 7272 6179  es in a nd.array
+00008080: 206f 660d 0a20 2020 2020 2020 2020 2020   of..           
+00008090: 2073 697a 6520 286e 7265 616c 5f75 6e69   size (nreal_uni
+000080a0: 7473 2c20 6e79 2c20 6e78 290d 0a20 2020  ts, ny, nx)..   
+000080b0: 2020 2020 2022 2222 0d0a 0d0a 0d0a 2020       """......  
+000080c0: 2020 2020 2020 6173 7365 7274 2075 6e69        assert uni
+000080d0: 7420 696e 2073 656c 662e 6765 745f 616c  t in self.get_al
+000080e0: 6c5f 756e 6974 7328 292c 2022 556e 6974  l_units(), "Unit
+000080f0: 206d 7573 7420 6265 2069 6e63 6c75 6465   must be include
+00008100: 6420 696e 2061 2070 696c 6520 7265 6c61  d in a pile rela
+00008110: 7465 6420 746f 2074 6865 206d 6173 7465  ted to the maste
+00008120: 7220 7069 6c65 220d 0a20 2020 2020 2020  r pile"..       
+00008130: 2061 7373 6572 7420 7365 6c66 2e47 656f   assert self.Geo
+00008140: 6c2e 7375 7266 6163 6573 5f62 795f 7069  l.surfaces_by_pi
+00008150: 6c65 7320 6973 206e 6f74 204e 6f6e 652c  les is not None,
+00008160: 2022 5375 7266 6163 6573 206e 6f74 2063   "Surfaces not c
+00008170: 6f6d 7075 7465 6422 0d0a 2020 2020 2020  omputed"..      
+00008180: 2020 6173 7365 7274 2074 7970 2069 6e20    assert typ in 
+00008190: 2822 746f 7022 2c20 2262 6f74 222c 2022  ("top", "bot", "
+000081a0: 6f72 6967 696e 616c 2229 2c20 2253 7572  original"), "Sur
+000081b0: 6661 6365 2074 7970 6520 7b7d 2064 6f65  face type {} doe
+000081c0: 736e 7420 6578 6973 7422 2e66 6f72 6d61  snt exist".forma
+000081d0: 7428 7479 7029 0d0a 2020 2020 2020 2020  t(typ)..        
+000081e0: 686c 3d75 6e69 742e 6765 745f 685f 6c65  hl=unit.get_h_le
+000081f0: 7665 6c28 290d 0a20 2020 2020 2020 2069  vel()..        i
+00008200: 6620 686c 203d 3d20 313a 0d0a 2020 2020  f hl == 1:..    
+00008210: 2020 2020 2020 2020 503d 7365 6c66 2e67          P=self.g
+00008220: 6574 5f70 696c 655f 6d61 7374 6572 2829  et_pile_master()
+00008230: 0d0a 2020 2020 2020 2020 656c 6966 2068  ..        elif h
+00008240: 6c20 3e20 313a 0d0a 2020 2020 2020 2020  l > 1:..        
+00008250: 2020 2020 503d 756e 6974 2e6d 756d 6d79      P=unit.mummy
+00008260: 5f75 6e69 742e 5375 6250 696c 650d 0a0d  _unit.SubPile...
+00008270: 0a20 2020 2020 2020 2069 6620 502e 6e61  .        if P.na
+00008280: 7475 7265 203d 3d20 2273 7572 6661 6365  ture == "surface
+00008290: 7322 3a0d 0a20 2020 2020 2020 2020 2020  s":..           
+000082a0: 2069 6620 7479 7020 3d3d 2274 6f70 223a   if typ =="top":
+000082b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000082c0: 2020 733d 7365 6c66 2e47 656f 6c2e 7375    s=self.Geol.su
+000082d0: 7266 6163 6573 5f62 795f 7069 6c65 735b  rfaces_by_piles[
+000082e0: 502e 6e61 6d65 5d5b 3a2c 2075 6e69 742e  P.name][:, unit.
+000082f0: 6f72 6465 722d 315d 2e63 6f70 7928 290d  order-1].copy().
+00008300: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00008310: 6620 7479 7020 3d3d 2262 6f74 223a 0d0a  f typ =="bot":..
+00008320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008330: 733d 7365 6c66 2e47 656f 6c2e 7375 7266  s=self.Geol.surf
+00008340: 6163 6573 5f62 6f74 5f62 795f 7069 6c65  aces_bot_by_pile
+00008350: 735b 502e 6e61 6d65 5d5b 3a2c 2075 6e69  s[P.name][:, uni
+00008360: 742e 6f72 6465 722d 315d 2e63 6f70 7928  t.order-1].copy(
+00008370: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00008380: 6c69 6620 7479 7020 3d3d 2022 6f72 6967  lif typ == "orig
+00008390: 696e 616c 223a 0d0a 2020 2020 2020 2020  inal":..        
+000083a0: 2020 2020 2020 2020 733d 7365 6c66 2e47          s=self.G
+000083b0: 656f 6c2e 6f72 675f 7375 7266 6163 6573  eol.org_surfaces
+000083c0: 5f62 795f 7069 6c65 735b 502e 6e61 6d65  _by_piles[P.name
+000083d0: 5d5b 3a2c 2075 6e69 742e 6f72 6465 722d  ][:, unit.order-
+000083e0: 315d 2e63 6f70 7928 290d 0a20 2020 2020  1].copy()..     
+000083f0: 2020 2020 2020 2072 6574 7572 6e20 730d         return s.
+00008400: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00008410: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00008420: 726e 204e 6f6e 650d 0a0d 0a20 2020 2064  rn None....    d
+00008430: 6566 2067 6574 5f73 7572 6661 6365 2873  ef get_surface(s
+00008440: 656c 662c 2068 5f6c 6576 656c 3d22 616c  elf, h_level="al
+00008450: 6c22 293a 0d0a 0d0a 2020 2020 2020 2020  l"):....        
+00008460: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
+00008470: 7572 6e20 6120 3444 2061 7272 6179 206f  urn a 4D array o
+00008480: 6620 6d75 6c74 6970 6c65 2073 7572 6661  f multiple surfa
+00008490: 6365 7320 6163 636f 7264 696e 6720 746f  ces according to
+000084a0: 0d0a 2020 2020 2020 2020 7468 6520 6869  ..        the hi
+000084b0: 6572 6172 6368 6963 616c 206c 6576 656c  erarchical level
+000084c0: 2064 6573 6972 6564 2c20 6279 2064 6566   desired, by def
+000084d0: 6175 6c74 2041 7263 6850 7920 7472 790d  ault ArchPy try.
+000084e0: 0a20 2020 2020 2020 2074 6f20 7265 7475  .        to retu
+000084f0: 726e 2074 6865 2068 6967 6865 7374 2068  rn the highest h
+00008500: 6965 7261 7263 6869 6361 6c20 756e 6974  ierarchical unit
+00008510: 2773 2073 7572 6661 6365 0d0a 0d0a 2020  's surface....  
+00008520: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00008530: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00008540: 2d2d 2d2d 0d0a 2020 2020 2020 2020 685f  ----..        h_
+00008550: 6c65 7665 6c3a 2069 6e74 206f 7220 7374  level: int or st
+00008560: 7269 6e67 2c0d 0a20 2020 2020 2020 2020  ring,..         
+00008570: 2020 206d 6178 696d 756d 206c 6576 656c     maximum level
+00008580: 206f 6620 6869 6572 6172 6368 790d 0a20   of hierarchy.. 
+00008590: 2020 2020 2020 2020 2020 2064 6573 6972             desir
+000085a0: 6564 2074 6f20 7265 7475 726e 2c20 2261  ed to return, "a
+000085b0: 6c6c 2220 696e 6469 6361 7465 7320 746f  ll" indicates to
+000085c0: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
+000085d0: 2020 2020 2074 6865 2068 6967 6865 7374       the highest
+000085e0: 2068 6965 7261 7263 6869 6361 6c20 6c65   hierarchical le
+000085f0: 7665 6c20 706f 7373 6962 6c65 2066 6f72  vel possible for
+00008600: 2065 6163 6820 756e 6974 0d0a 0d0a 2020   each unit....  
+00008610: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00008620: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00008630: 2020 2020 2020 2020 3444 206e 6461 7272          4D ndarr
+00008640: 6179 206f 6620 7369 7a65 2028 6e6c 6179  ay of size (nlay
+00008650: 6572 2c20 6e73 696d 2c20 6e79 2c20 6e78  er, nsim, ny, nx
+00008660: 290d 0a20 2020 2020 2020 2020 2020 2041  )..            A
+00008670: 6c6c 2063 6f6d 7075 7465 6420 7375 7266  ll computed surf
+00008680: 6163 6573 2069 6e20 6120 6e64 2e61 7272  aces in a nd.arr
+00008690: 6179 206f 660d 0a20 2020 2020 2020 2020  ay of..         
+000086a0: 2020 2073 697a 6520 286e 6c61 7965 722c     size (nlayer,
+000086b0: 206e 7369 6d2c 206e 792c 206e 7829 0d0a   nsim, ny, nx)..
+000086c0: 2020 2020 2020 2020 6c69 7374 0d0a 2020          list..  
+000086d0: 2020 2020 2020 2020 2020 6120 6c69 7374            a list
+000086e0: 2028 6e6c 6179 6572 2920 6f66 2075 6e69   (nlayer) of uni
+000086f0: 7473 206e 616d 6520 636f 7272 6573 706f  ts name correspo
+00008700: 6e64 696e 6720 746f 2074 6865 0d0a 2020  nding to the..  
+00008710: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
+00008720: 6573 2074 6f20 6469 7374 696e 6775 6973  es to distinguis
+00008730: 6820 7769 6368 2073 7572 6661 6365 2063  h wich surface c
+00008740: 6f72 7265 7370 6f6e 6420 746f 2077 6869  orrespond to whi
+00008750: 6368 2075 6e69 740d 0a20 2020 2020 2020  ch unit..       
+00008760: 2022 2222 0d0a 0d0a 0d0a 2020 2020 2020   """......      
+00008770: 2020 6966 2068 5f6c 6576 656c 203d 3d20    if h_level == 
+00008780: 2261 6c6c 223a 0d0a 2020 2020 2020 2020  "all":..        
+00008790: 2020 2020 6c3d 5b5d 0d0a 2020 2020 2020      l=[]..      
+000087a0: 2020 2020 2020 6465 6620 6675 6e28 7069        def fun(pi
+000087b0: 6c65 293a 0d0a 2020 2020 2020 2020 2020  le):..          
+000087c0: 2020 2020 2020 666f 7220 7520 696e 2070        for u in p
+000087d0: 696c 652e 6c69 7374 5f75 6e69 7473 3a0d  ile.list_units:.
+000087e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000087f0: 2020 2020 2069 6620 752e 665f 6d65 7468       if u.f_meth
+00008800: 6f64 2021 3d20 2253 7562 5069 6c65 223a  od != "SubPile":
+00008810: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008820: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
+00008830: 6e64 2875 290d 0a20 2020 2020 2020 2020  nd(u)..         
+00008840: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00008850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008860: 2020 2020 2020 2020 2020 6675 6e28 752e            fun(u.
+00008870: 5375 6250 696c 6529 0d0a 0d0a 2020 2020  SubPile)....    
+00008880: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00008890: 6e63 6528 685f 6c65 7665 6c2c 2069 6e74  nce(h_level, int
+000088a0: 2920 616e 6420 685f 6c65 7665 6c20 3e20  ) and h_level > 
+000088b0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+000088c0: 6c3d 5b5d 0d0a 2020 2020 2020 2020 2020  l=[]..          
+000088d0: 2020 6465 6620 6675 6e28 7069 6c65 293a    def fun(pile):
+000088e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000088f0: 2020 666f 7220 7520 696e 2070 696c 652e    for u in pile.
+00008900: 6c69 7374 5f75 6e69 7473 3a0d 0a20 2020  list_units:..   
 00008910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008920: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
-00008930: 6e64 2875 290d 0a20 2020 2020 2020 2020  nd(u)..         
-00008940: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00008950: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00008960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008970: 2020 7061 7373 0d0a 2020 2020 2020 2020    pass..        
-00008980: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00008990: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000089a0: 2020 2020 2020 2020 2020 206c 2e61 7070             l.app
-000089b0: 656e 6428 7529 0d0a 0d0a 2020 2020 2020  end(u)....      
-000089c0: 2020 6675 6e28 7365 6c66 2e67 6574 5f70    fun(self.get_p
-000089d0: 696c 655f 6d61 7374 6572 2829 290d 0a20  ile_master()).. 
-000089e0: 2020 2020 2020 206e 6c61 793d 6c65 6e28         nlay=len(
-000089f0: 6c29 0d0a 2020 2020 2020 2020 756e 6974  l)..        unit
-00008a00: 5f6e 616d 6573 3d5b 692e 6e61 6d65 2066  _names=[i.name f
-00008a10: 6f72 2069 2069 6e20 6c5d 0d0a 2020 2020  or i in l]..    
-00008a20: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00008a30: 6765 286e 6c61 7929 3a0d 0a20 2020 2020  ge(nlay):..     
-00008a40: 2020 2020 2020 2075 3d6c 5b69 5d0d 0a20         u=l[i].. 
-00008a50: 2020 2020 2020 2020 2020 2073 3d73 656c             s=sel
-00008a60: 662e 6765 745f 7375 7266 6163 6573 5f75  f.get_surfaces_u
-00008a70: 6e69 7428 7529 0d0a 2020 2020 2020 2020  nit(u)..        
-00008a80: 2020 2020 6966 2069 203d 3d20 303a 0d0a      if i == 0:..
-00008a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008aa0: 6e72 6561 6c2c 206e 792c 206e 783d 732e  nreal, ny, nx=s.
-00008ab0: 7368 6170 650d 0a20 2020 2020 2020 2020  shape..         
-00008ac0: 2020 2020 2020 2073 7572 6673 3d6e 702e         surfs=np.
-00008ad0: 7a65 726f 7328 5b6e 6c61 792c 206e 7265  zeros([nlay, nre
-00008ae0: 616c 2c20 6e79 2c20 6e78 5d2c 2064 7479  al, ny, nx], dty
-00008af0: 7065 3d6e 702e 666c 6f61 7433 3229 0d0a  pe=np.float32)..
-00008b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b10: 7375 7266 735b 305d 3d73 0d0a 2020 2020  surfs[0]=s..    
-00008b20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00008b30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00008b40: 7572 6673 5b69 5d3d 730d 0a20 2020 2020  urfs[i]=s..     
-00008b50: 2020 2072 6574 7572 6e20 7375 7266 732c     return surfs,
-00008b60: 2075 6e69 745f 6e61 6d65 730d 0a0d 0a20   unit_names.... 
-00008b70: 2020 2064 6566 2067 6574 5f75 6e69 7428     def get_unit(
-00008b80: 7365 6c66 2c20 6e61 6d65 3d22 4122 2c20  self, name="A", 
-00008b90: 4944 3d31 2c20 7479 7065 3d22 6e61 6d65  ID=1, type="name
-00008ba0: 222c 2061 6c6c 5f73 7472 6174 733d 5472  ", all_strats=Tr
-00008bb0: 7565 2c20 7662 3d31 293a 0d0a 0d0a 2020  ue, vb=1):....  
-00008bc0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00008bd0: 2020 2052 6574 7572 6e20 7468 6520 756e     Return the un
-00008be0: 6974 2069 6e20 7468 6520 5069 6c65 2077  it in the Pile w
-00008bf0: 6974 6820 7468 6520 6173 736f 6369 6174  ith the associat
-00008c00: 6564 206e 616d 6520 6f72 2049 442e 0d0a  ed name or ID...
-00008c10: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00008c20: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00008c30: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00008c40: 2020 6e61 6d65 3a20 7374 7269 6e67 0d0a    name: string..
-00008c50: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00008c60: 206f 6620 7468 6520 7374 7261 7469 2074   of the strati t
-00008c70: 6f20 7265 7472 6965 7665 0d0a 2020 2020  o retrieve..    
-00008c80: 2020 2020 4944 3a20 696e 740d 0a20 2020      ID: int..   
-00008c90: 2020 2020 2020 2020 2049 4420 6f66 2074           ID of t
-00008ca0: 6865 2073 7472 6174 6920 746f 2072 6574  he strati to ret
-00008cb0: 7269 6576 650d 0a20 2020 2020 2020 2074  rieve..        t
-00008cc0: 7970 653a 2073 7472 2c20 286e 616d 6520  ype: str, (name 
-00008cd0: 6f72 2049 4429 0d0a 2020 2020 2020 2020  or ID)..        
-00008ce0: 2020 2020 7265 7472 6965 7669 6e67 206d      retrieving m
-00008cf0: 6574 686f 640d 0a20 2020 2020 2020 2061  ethod..        a
-00008d00: 6c6c 5f73 7472 6174 733a 2062 6f6f 6c0d  ll_strats: bool.
-00008d10: 0a20 2020 2020 2020 2020 2020 2066 6c61  .            fla
-00008d20: 6720 746f 2069 6e64 6963 6174 6520 746f  g to indicate to
-00008d30: 2061 6c73 6f20 7365 6172 6368 2069 6e20   also search in 
-00008d40: 7375 622d 756e 6974 732c 0d0a 2020 2020  sub-units,..    
-00008d50: 2020 2020 2020 2020 6966 2066 616c 7365          if false
-00008d60: 2072 6573 6561 7263 6820 7769 6c6c 2062   research will b
-00008d70: 6520 7265 7374 7269 6374 6564 2074 6f20  e restricted to 
-00008d80: 756e 6974 730d 0a20 2020 2020 2020 2020  units..         
-00008d90: 2020 2064 6972 6563 746c 7920 696e 2074     directly in t
-00008da0: 6865 2050 696c 6520 6d61 7374 6572 0d0a  he Pile master..
-00008db0: 2020 2020 2020 2020 7662 3a20 696e 740d          vb: int.
-00008dc0: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
-00008dd0: 626f 7369 7479 206c 6576 656c 0d0a 0d0a  bosity level....
-00008de0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00008df0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00008e00: 0d0a 2020 2020 2020 2020 3a63 6c61 7373  ..        :class
-00008e10: 3a60 556e 6974 6020 6f62 6a65 6374 0d0a  :`Unit` object..
-00008e20: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-00008e30: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
-00008e40: 696e 7374 616e 6365 286e 616d 652c 2073  instance(name, s
-00008e50: 7472 292c 2022 4e61 6d65 206d 7573 7420  tr), "Name must 
-00008e60: 6265 2061 2073 7472 696e 6722 0d0a 0d0a  be a string"....
-00008e70: 2020 2020 2020 2020 6966 2061 6c6c 5f73          if all_s
-00008e80: 7472 6174 733a 0d0a 2020 2020 2020 2020  trats:..        
-00008e90: 2020 2020 6c3d 7365 6c66 2e67 6574 5f61      l=self.get_a
-00008ea0: 6c6c 5f75 6e69 7473 2829 0d0a 2020 2020  ll_units()..    
-00008eb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00008ec0: 2020 2020 2020 206c 3d73 656c 662e 6765         l=self.ge
-00008ed0: 745f 7069 6c65 5f6d 6173 7465 7228 292e  t_pile_master().
-00008ee0: 6c69 7374 5f75 6e69 7473 2829 0d0a 2020  list_units()..  
-00008ef0: 2020 2020 2020 666f 7220 7320 696e 206c        for s in l
-00008f00: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00008f10: 6620 7479 7065 203d 3d20 226e 616d 6522  f type == "name"
-00008f20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00008f30: 2020 2069 6620 732e 6e61 6d65 203d 3d20     if s.name == 
-00008f40: 6e61 6d65 3a0d 0a20 2020 2020 2020 2020  name:..         
-00008f50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00008f60: 6e20 730d 0a20 2020 2020 2020 2020 2020  n s..           
-00008f70: 2065 6c69 6620 7479 7065 203d 3d20 2249   elif type == "I
-00008f80: 4422 3a0d 0a20 2020 2020 2020 2020 2020  D":..           
-00008f90: 2020 2020 2069 6620 732e 4944 203d 3d20       if s.ID == 
-00008fa0: 4944 3a0d 0a20 2020 2020 2020 2020 2020  ID:..           
-00008fb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008fc0: 730d 0a0d 0a20 2020 2020 2020 2069 6620  s....        if 
-00008fd0: 7479 7065 3d3d 226e 616d 6522 3a0d 0a20  type=="name":.. 
-00008fe0: 2020 2020 2020 2020 2020 2076 6172 3d6e             var=n
-00008ff0: 616d 650d 0a20 2020 2020 2020 2065 6c69  ame..        eli
-00009000: 6620 7479 7065 3d3d 2249 4422 3a0d 0a20  f type=="ID":.. 
-00009010: 2020 2020 2020 2020 2020 2076 6172 3d49             var=I
-00009020: 440d 0a20 2020 2020 2020 2069 6620 7662  D..        if vb
-00009030: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00009040: 7269 6e74 2028 224e 6f20 756e 6974 2077  rint ("No unit w
-00009050: 6974 6820 7468 6174 206e 616d 652f 4944  ith that name/ID
-00009060: 207b 7d22 2e66 6f72 6d61 7428 7661 7229   {}".format(var)
-00009070: 290d 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00009080: 6e20 4e6f 6e65 0d0a 0d0a 2020 2020 6465  n None....    de
-00009090: 6620 6765 7462 6869 6e64 6578 2873 656c  f getbhindex(sel
-000090a0: 662c 2049 4429 3a0d 0a0d 0a20 2020 2020  f, ID):....     
-000090b0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000090c0: 5265 7475 726e 2074 6865 2069 6e64 6578  Return the index
-000090d0: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-000090e0: 6f20 6120 6365 7274 6169 6e20 626f 7265  o a certain bore
-000090f0: 686f 6c65 2049 440d 0a0d 0a20 2020 2020  hole ID....     
-00009100: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00009110: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00009120: 2d0d 0a20 2020 2020 2020 2049 443a 2073  -..        ID: s
-00009130: 7472 696e 670d 0a20 2020 2020 2020 2020  tring..         
-00009140: 2020 2062 6f72 6568 6f6c 6520 4944 0d0a     borehole ID..
-00009150: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00009160: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00009170: 2d2d 0d0a 2020 2020 2020 2020 696e 740d  --..        int.
-00009180: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00009190: 6578 206f 6620 7468 6520 626f 7265 686f  ex of the boreho
-000091a0: 6c65 2069 6e20 7468 6520 7069 6c65 0d0a  le in the pile..
-000091b0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-000091c0: 2020 2020 2020 2069 6e74 6572 6573 743d         interest=
-000091d0: 4e6f 6e65 0d0a 2020 2020 2020 2020 666f  None..        fo
-000091e0: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
-000091f0: 2873 656c 662e 6c69 7374 5f62 6873 2929  (self.list_bhs))
-00009200: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00009210: 6620 7365 6c66 2e6c 6973 745f 6268 735b  f self.list_bhs[
-00009220: 695d 2e49 4420 3d3d 2049 443a 0d0a 2020  i].ID == ID:..  
-00009230: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00009240: 7465 7265 7374 3d69 0d0a 2020 2020 2020  terest=i..      
-00009250: 2020 6966 2069 6e74 6572 6573 7420 6973    if interest is
-00009260: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00009270: 2020 2020 6173 7365 7274 2031 2c20 2827      assert 1, ('
-00009280: 7468 6520 7072 6f70 7269 6574 7920 272b  the propriety '+
-00009290: 4944 2b27 2077 6173 206e 6f74 2066 6f75  ID+' was not fou
-000092a0: 6e64 2729 0d0a 2020 2020 2020 2020 656c  nd')..        el
-000092b0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000092c0: 2072 6574 7572 6e20 696e 7465 7265 7374   return interest
-000092d0: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
-000092e0: 6268 2873 656c 662c 2049 4429 3a0d 0a0d  bh(self, ID):...
-000092f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00009300: 2020 2020 2020 5265 7475 726e 2074 6865        Return the
-00009310: 2062 6f72 6568 6f6c 6520 6f62 6a65 6374   borehole object
-00009320: 2067 6976 656e 2069 7473 2049 440d 0a0d   given its ID...
-00009330: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00009340: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00009350: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00009360: 2049 443a 2073 7472 696e 670d 0a20 2020   ID: string..   
-00009370: 2020 2020 2020 2020 2062 6f72 6568 6f6c           borehol
-00009380: 6520 4944 0d0a 0d0a 2020 2020 2020 2020  e ID....        
-00009390: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-000093a0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-000093b0: 2020 3a63 6c61 7373 3a60 426f 7265 686f    :class:`Boreho
-000093c0: 6c65 6020 6f62 6a65 6374 0d0a 2020 2020  le` object..    
-000093d0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-000093e0: 2020 2069 6e64 6578 3d73 656c 662e 6765     index=self.ge
-000093f0: 7462 6869 6e64 6578 2849 4429 0d0a 2020  tbhindex(ID)..  
-00009400: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00009410: 662e 6c69 7374 5f62 6873 5b69 6e64 6578  f.list_bhs[index
-00009420: 5d0d 0a0d 0a20 2020 2064 6566 2067 6574  ]....    def get
-00009430: 5f66 6163 6965 735f 6f62 6a28 7365 6c66  _facies_obj(self
-00009440: 2c20 6e61 6d65 3d22 4122 2c20 4944 3d31  , name="A", ID=1
-00009450: 2c20 7479 7065 3d22 6e61 6d65 222c 2076  , type="name", v
-00009460: 623d 3129 3a0d 0a0d 0a20 2020 2020 2020  b=1):....       
-00009470: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
-00009480: 7475 726e 2074 6865 2066 6163 6965 7320  turn the facies 
-00009490: 696e 2074 6865 2050 696c 6520 7769 7468  in the Pile with
-000094a0: 2074 6865 2061 7373 6f63 6961 7465 6420   the associated 
-000094b0: 6e61 6d65 206f 7220 4944 2e0d 0a0d 0a20  name or ID..... 
-000094c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000094d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-000094e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206e  -----..        n
-000094f0: 616d 653a 2073 7472 696e 670d 0a20 2020  ame: string..   
-00009500: 2020 2020 2020 2020 206e 616d 6520 6f66           name of
-00009510: 2074 6865 2073 7472 6174 6920 746f 2072   the strati to r
-00009520: 6574 7269 6576 650d 0a20 2020 2020 2020  etrieve..       
-00009530: 2049 443a 2069 6e74 0d0a 2020 2020 2020   ID: int..      
-00009540: 2020 2020 2020 4944 206f 6620 7468 6520        ID of the 
-00009550: 7374 7261 7469 2074 6f20 7265 7472 6965  strati to retrie
-00009560: 7665 0d0a 2020 2020 2020 2020 7479 7065  ve..        type
-00009570: 3a20 7374 722c 2028 6e61 6d65 206f 7220  : str, (name or 
-00009580: 4944 290d 0a20 2020 2020 2020 2020 2020  ID)..           
-00009590: 2072 6574 7269 6576 696e 6720 6d65 7468   retrieving meth
-000095a0: 6f64 0d0a 2020 2020 2020 2020 7662 3a20  od..        vb: 
-000095b0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-000095c0: 2076 6572 626f 7369 7479 206c 6576 656c   verbosity level
-000095d0: 2028 3020 6f72 2031 290d 0a0d 0a20 2020   (0 or 1)....   
-000095e0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-000095f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00009600: 2020 2020 2020 203a 636c 6173 733a 6046         :class:`F
-00009610: 6163 6965 7360 206f 626a 6563 740d 0a20  acies` object.. 
-00009620: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00009630: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00009640: 6e73 7461 6e63 6528 6e61 6d65 2c20 7374  nstance(name, st
-00009650: 7229 2c20 224e 616d 6520 6d75 7374 2062  r), "Name must b
-00009660: 6520 6120 7374 7269 6e67 220d 0a0d 0a20  e a string".... 
-00009670: 2020 2020 2020 206c 3d73 656c 662e 6765         l=self.ge
-00009680: 745f 616c 6c5f 6661 6369 6573 2829 0d0a  t_all_facies()..
-00009690: 2020 2020 2020 2020 666f 7220 7320 696e          for s in
-000096a0: 206c 3a0d 0a20 2020 2020 2020 2020 2020   l:..           
-000096b0: 2069 6620 7479 7065 203d 3d20 226e 616d   if type == "nam
-000096c0: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-000096d0: 2020 2020 2069 6620 732e 6e61 6d65 203d       if s.name =
-000096e0: 3d20 6e61 6d65 3a0d 0a20 2020 2020 2020  = name:..       
-000096f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00009700: 7572 6e20 730d 0a0d 0a20 2020 2020 2020  urn s....       
-00009710: 2020 2020 2065 6c69 6620 7479 7065 203d       elif type =
-00009720: 3d20 2249 4422 3a0d 0a20 2020 2020 2020  = "ID":..       
-00009730: 2020 2020 2020 2020 2069 6620 732e 4944           if s.ID
-00009740: 203d 3d20 4944 3a0d 0a20 2020 2020 2020   == ID:..       
-00009750: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00009760: 7572 6e20 730d 0a0d 0a20 2020 2020 2020  urn s....       
-00009770: 2069 6620 7479 7065 3d3d 226e 616d 6522   if type=="name"
-00009780: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
-00009790: 6172 3d6e 616d 650d 0a20 2020 2020 2020  ar=name..       
-000097a0: 2065 6c69 6620 7479 7065 3d3d 2249 4422   elif type=="ID"
-000097b0: 3a0d 0a20 2020 2020 2020 2020 2020 2076  :..            v
-000097c0: 6172 3d49 440d 0a20 2020 2020 2020 2069  ar=ID..        i
-000097d0: 6620 7662 3a0d 0a20 2020 2020 2020 2020  f vb:..         
-000097e0: 2020 2070 7269 6e74 2028 224e 6f20 6661     print ("No fa
-000097f0: 6369 6573 2077 6974 6820 7468 6174 206e  cies with that n
-00009800: 616d 652f 4944 207b 7d22 2e66 6f72 6d61  ame/ID {}".forma
-00009810: 7428 7661 7229 290d 0a20 2020 2020 2020  t(var))..       
-00009820: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
-00009830: 2020 2020 6465 6620 706f 696e 7454 6f49      def pointToI
-00009840: 6e64 6578 2873 656c 662c 2078 2c20 792c  ndex(self, x, y,
-00009850: 207a 293a 0d0a 2020 2020 2020 2020 0d0a   z):..        ..
-00009860: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00009870: 2020 2020 2052 6574 7572 6e20 7468 6520       Return the 
-00009880: 696e 6465 7820 6f66 2074 6865 2063 656c  index of the cel
-00009890: 6c20 636f 6e74 6169 6e69 6e67 2074 6865  l containing the
-000098a0: 2070 6f69 6e74 2028 782c 792c 7a29 0d0a   point (x,y,z)..
-000098b0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000098c0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000098d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-000098e0: 2020 783a 2066 6c6f 6174 0d0a 2020 2020    x: float..    
-000098f0: 2020 2020 2020 2020 7820 636f 6f72 6469          x coordi
-00009900: 6e61 7465 206f 6620 7468 6520 706f 696e  nate of the poin
-00009910: 740d 0a20 2020 2020 2020 2079 3a20 666c  t..        y: fl
-00009920: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
-00009930: 2079 2063 6f6f 7264 696e 6174 6520 6f66   y coordinate of
-00009940: 2074 6865 2070 6f69 6e74 0d0a 2020 2020   the point..    
-00009950: 2020 2020 7a3a 2066 6c6f 6174 0d0a 2020      z: float..  
-00009960: 2020 2020 2020 2020 2020 7a20 636f 6f72            z coor
-00009970: 6469 6e61 7465 206f 6620 7468 6520 706f  dinate of the po
-00009980: 696e 740d 0a0d 0a20 2020 2020 2020 2052  int....        R
-00009990: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-000099a0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000099b0: 2033 2069 6e74 0d0a 2020 2020 2020 2020   3 int..        
-000099c0: 2020 2020 696e 6465 7820 6f66 2074 6865      index of the
-000099d0: 2063 656c 6c20 636f 6e74 6169 6e69 6e67   cell containing
-000099e0: 2074 6865 2070 6f69 6e74 2028 782c 792c   the point (x,y,
-000099f0: 7a29 0d0a 2020 2020 2020 2020 2222 220d  z)..        """.
-00009a00: 0a0d 0a20 2020 2020 2020 2063 656c 6c5f  ...        cell_
-00009a10: 783d 6e70 2e61 7272 6179 2828 782d 7365  x=np.array((x-se
-00009a20: 6c66 2e6f 7829 2f73 656c 662e 7378 292e  lf.ox)/self.sx).
-00009a30: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
-00009a40: 2020 2020 2063 656c 6c5f 793d 6e70 2e61       cell_y=np.a
-00009a50: 7272 6179 2828 792d 7365 6c66 2e6f 7929  rray((y-self.oy)
-00009a60: 2f73 656c 662e 7379 292e 6173 7479 7065  /self.sy).astype
-00009a70: 2869 6e74 290d 0a20 2020 2020 2020 2063  (int)..        c
-00009a80: 656c 6c5f 7a3d 6e70 2e61 7272 6179 2828  ell_z=np.array((
-00009a90: 7a2d 7365 6c66 2e6f 7a29 2f73 656c 662e  z-self.oz)/self.
-00009aa0: 737a 292e 6173 7479 7065 2869 6e74 290d  sz).astype(int).
-00009ab0: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00009ac0: 6e20 6365 6c6c 5f78 2c20 6365 6c6c 5f79  n cell_x, cell_y
-00009ad0: 2c20 6365 6c6c 5f7a 0d0a 0d0a 0d0a 2020  , cell_z......  
-00009ae0: 2020 6465 6620 6765 745f 616c 6c5f 756e    def get_all_un
-00009af0: 6974 7328 7365 6c66 2c20 7265 636f 6d70  its(self, recomp
-00009b00: 7574 653d 5472 7565 293a 0d0a 0d0a 2020  ute=True):....  
-00009b10: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00009b20: 2020 2052 6574 7572 6e20 6120 6c69 7374     Return a list
-00009b30: 206f 6620 616c 6c20 756e 6974 732c 2065   of all units, e
-00009b40: 7665 6e20 7375 622d 756e 6974 730d 0a0d  ven sub-units...
-00009b50: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00009b60: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00009b70: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00009b80: 2072 6563 6f6d 7075 7465 3a20 626f 6f6c   recompute: bool
-00009b90: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00009ba0: 2046 616c 7365 2c20 7468 6520 6c69 7374   False, the list
-00009bb0: 2061 6c6c 2075 6e69 7473 2061 7474 7269   all units attri
-00009bc0: 6275 7465 0d0a 2020 2020 2020 2020 2020  bute..          
-00009bd0: 2020 7769 6c6c 2062 6520 7369 6d70 6c79    will be simply
-00009be0: 2072 6574 7269 6576 652e 2045 7665 6e20   retrieve. Even 
-00009bf0: 6966 2063 6861 6e67 6573 2068 6176 650d  if changes have.
-00009c00: 0a20 2020 2020 2020 2020 2020 2062 6565  .            bee
-00009c10: 6e20 6d61 6465 2e0d 0a0d 0a20 2020 2020  n made.....     
-00009c20: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00009c30: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-00009c40: 2020 2020 206c 6973 7420 6f66 203a 636c       list of :cl
-00009c50: 6173 733a 6055 6e69 7460 206f 626a 6563  ass:`Unit` objec
-00009c60: 7473 0d0a 2020 2020 2020 2020 2222 220d  ts..        """.
-00009c70: 0a0d 0a20 2020 2020 2020 2069 6620 6c65  ...        if le
-00009c80: 6e28 7365 6c66 2e6c 6973 745f 616c 6c5f  n(self.list_all_
-00009c90: 756e 6974 7329 203d 3d20 303a 0d0a 2020  units) == 0:..  
-00009ca0: 2020 2020 2020 2020 2020 7265 636f 6d70            recomp
-00009cb0: 7574 653d 5472 7565 0d0a 2020 2020 2020  ute=True..      
-00009cc0: 2020 6966 2073 656c 662e 6c69 7374 5f61    if self.list_a
-00009cd0: 6c6c 5f75 6e69 7473 2069 7320 4e6f 6e65  ll_units is None
-00009ce0: 206f 7220 7265 636f 6d70 7574 653a 2023   or recompute: #
-00009cf0: 2072 6563 6f6d 7075 7465 2069 6620 7761   recompute if wa
-00009d00: 6e74 6564 206f 6620 6966 2074 6865 7265  nted of if there
-00009d10: 2069 7320 6e6f 206c 6973 745f 616c 6c5f   is no list_all_
-00009d20: 7374 7261 7469 730d 0a0d 0a20 2020 2020  stratis....     
-00009d30: 2020 2020 2020 2064 6566 206c 6973 745f         def list_
-00009d40: 616c 6c5f 756e 6974 7328 616c 6c5f 7374  all_units(all_st
-00009d50: 7261 7469 732c 2073 7562 7069 6c65 5f73  ratis, subpile_s
-00009d60: 7472 6174 6973 293a 0d0a 0d0a 2020 2020  tratis):....    
-00009d70: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
-00009d80: 7374 7261 7469 733d 616c 6c5f 7374 7261  stratis=all_stra
-00009d90: 7469 7320 2b20 7375 6270 696c 655f 7374  tis + subpile_st
-00009da0: 7261 7469 730d 0a20 2020 2020 2020 2020  ratis..         
-00009db0: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
-00009dc0: 7375 6270 696c 655f 7374 7261 7469 733a  subpile_stratis:
-00009dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00009de0: 2020 2020 2020 6966 2073 2e66 5f6d 6574        if s.f_met
-00009df0: 686f 6420 3d3d 2022 5375 6250 696c 6522  hod == "SubPile"
-00009e00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00009e10: 2020 2020 2020 2020 2020 2061 6c6c 5f73             all_s
-00009e20: 7472 6174 6973 3d6c 6973 745f 616c 6c5f  tratis=list_all_
-00009e30: 756e 6974 7328 616c 6c5f 7374 7261 7469  units(all_strati
-00009e40: 732c 2073 2e53 7562 5069 6c65 2e6c 6973  s, s.SubPile.lis
-00009e50: 745f 756e 6974 7329 0d0a 2020 2020 2020  t_units)..      
-00009e60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009e70: 2061 6c6c 5f73 7472 6174 6973 0d0a 0d0a   all_stratis....
-00009e80: 2020 2020 2020 2020 2020 2020 6c61 753d              lau=
-00009e90: 6c69 7374 5f61 6c6c 5f75 6e69 7473 285b  list_all_units([
-00009ea0: 5d2c 2073 656c 662e 6765 745f 7069 6c65  ], self.get_pile
-00009eb0: 5f6d 6173 7465 7228 292e 6c69 7374 5f75  _master().list_u
-00009ec0: 6e69 7473 290d 0a20 2020 2020 2020 2020  nits)..         
-00009ed0: 2020 2023 6368 6563 6b20 7468 6174 2073     #check that s
-00009ee0: 7472 6174 6973 2068 6176 6520 6469 6666  tratis have diff
-00009ef0: 6572 656e 7420 6e61 6d65 730d 0a20 2020  erent names..   
-00009f00: 2020 2020 2020 2020 206c 3d5b 5d0d 0a20           l=[].. 
-00009f10: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
-00009f20: 2069 6e20 6c61 753a 0d0a 2020 2020 2020   in lau:..      
-00009f30: 2020 2020 2020 2020 2020 6966 2073 2e6e            if s.n
-00009f40: 616d 6520 6e6f 7420 696e 206c 3a0d 0a20  ame not in l:.. 
-00009f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f60: 2020 206c 2e61 7070 656e 6428 732e 6e61     l.append(s.na
-00009f70: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
-00009f80: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00009f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fa0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00009fb0: 2822 536f 6d65 2075 6e69 7473 2068 6176  ("Some units hav
-00009fc0: 6520 7468 6520 7361 6d65 206e 616d 6520  e the same name 
-00009fd0: 2855 6e69 7420 7b7d 222e 666f 726d 6174  (Unit {}".format
-00009fe0: 2873 2e6e 616d 6529 290d 0a20 2020 2020  (s.name))..     
-00009ff0: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-0000a000: 5f61 6c6c 5f75 6e69 7473 3d6c 6175 0d0a  _all_units=lau..
-0000a010: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000a020: 2073 656c 662e 6c69 7374 5f61 6c6c 5f75   self.list_all_u
-0000a030: 6e69 7473 0d0a 0d0a 2020 2020 6465 6620  nits....    def 
-0000a040: 6765 745f 616c 6c5f 6661 6369 6573 2873  get_all_facies(s
-0000a050: 656c 662c 2072 6563 6f6d 7075 7465 3d54  elf, recompute=T
-0000a060: 7275 6529 3a0d 0a0d 0a20 2020 2020 2020  rue):....       
-0000a070: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
-0000a080: 7475 726e 2061 206c 6973 7420 6f66 2061  turn a list of a
-0000a090: 6c6c 2066 6163 6965 730d 0a0d 0a20 2020  ll facies....   
-0000a0a0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0000a0b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000a0c0: 2d2d 2d0d 0a20 2020 2020 2020 2072 6563  ---..        rec
-0000a0d0: 6f6d 7075 7465 3a20 626f 6f6c 0d0a 2020  ompute: bool..  
-0000a0e0: 2020 2020 2020 2020 2020 6966 2046 616c            if Fal
-0000a0f0: 7365 2c20 7468 6520 6c69 7374 2061 6c6c  se, the list all
-0000a100: 2066 6163 6965 7320 6174 7472 6962 7574   facies attribut
-0000a110: 650d 0a20 2020 2020 2020 2020 2020 2077  e..            w
-0000a120: 696c 6c20 6265 2073 696d 706c 7920 7265  ill be simply re
-0000a130: 7472 6965 7665 2e20 4576 656e 2069 6620  trieve. Even if 
-0000a140: 6368 616e 6765 7320 6861 7665 0d0a 2020  changes have..  
-0000a150: 2020 2020 2020 2020 2020 6265 656e 206d            been m
-0000a160: 6164 6520 6f6e 2074 6865 2070 726f 6a65  ade on the proje
-0000a170: 6374 2e0d 0a20 2020 2020 2020 200d 0a20  ct...        .. 
-0000a180: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-0000a190: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-0000a1a0: 0a20 2020 2020 2020 206c 6973 7420 6f66  .        list of
-0000a1b0: 203a 636c 6173 733a 6046 6163 6965 7360   :class:`Facies`
-0000a1c0: 206f 626a 6563 7473 0d0a 2020 2020 2020   objects..      
-0000a1d0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-0000a1e0: 2069 6620 6c65 6e28 7365 6c66 2e6c 6973   if len(self.lis
-0000a1f0: 745f 616c 6c5f 6661 6369 6573 2920 3d3d  t_all_facies) ==
-0000a200: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-0000a210: 2072 6563 6f6d 7075 7465 3d54 7275 650d   recompute=True.
-0000a220: 0a0d 0a20 2020 2020 2020 2069 6620 7265  ...        if re
-0000a230: 636f 6d70 7574 653a 0d0a 2020 2020 2020  compute:..      
-0000a240: 2020 2020 2020 6c3d 5b5d 0d0a 2020 2020        l=[]..    
-0000a250: 2020 2020 2020 2020 6465 6620 6c5f 6661          def l_fa
-0000a260: 2870 696c 6529 3a0d 0a20 2020 2020 2020  (pile):..       
-0000a270: 2020 2020 2020 2020 2066 6f72 2073 2069           for s i
-0000a280: 6e20 7069 6c65 2e6c 6973 745f 756e 6974  n pile.list_unit
-0000a290: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0000a2a0: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
-0000a2b0: 6e20 732e 6c69 7374 5f66 6163 6965 733a  n s.list_facies:
-0000a2c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a2d0: 2020 2020 2020 2020 2020 6966 2066 6120            if fa 
-0000a2e0: 6e6f 7420 696e 206c 3a0d 0a20 2020 2020  not in l:..     
-0000a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a300: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
-0000a310: 6661 290d 0a20 2020 2020 2020 2020 2020  fa)..           
-0000a320: 2020 2020 2020 2020 2069 6620 732e 665f           if s.f_
-0000a330: 6d65 7468 6f64 203d 3d20 2253 7562 5069  method == "SubPi
-0000a340: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
-0000a350: 2020 2020 2020 2020 2020 2020 2020 6c5f                l_
-0000a360: 6661 2873 2e53 7562 5069 6c65 290d 0a0d  fa(s.SubPile)...
-0000a370: 0a20 2020 2020 2020 2020 2020 206c 5f66  .            l_f
-0000a380: 6128 7365 6c66 2e67 6574 5f70 696c 655f  a(self.get_pile_
-0000a390: 6d61 7374 6572 2829 290d 0a20 2020 2020  master())..     
-0000a3a0: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-0000a3b0: 5f61 6c6c 5f66 6163 6965 733d 6c0d 0a20  _all_facies=l.. 
-0000a3c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000a3d0: 6e20 6c0d 0a20 2020 2020 2020 2065 6c73  n l..        els
-0000a3e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000a3f0: 6966 2073 656c 662e 6c69 7374 5f61 6c6c  if self.list_all
-0000a400: 5f66 6163 6965 7320 6973 206e 6f74 204e  _facies is not N
-0000a410: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0000a420: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a430: 662e 6c69 7374 5f61 6c6c 5f66 6163 6965  f.list_all_facie
-0000a440: 730d 0a20 2020 2020 2020 2020 2020 2065  s..            e
-0000a450: 6c73 653a 0d0a 0d0a 2020 2020 2020 2020  lse:....        
-0000a460: 2020 2020 2020 2020 7365 6c66 2e67 6574          self.get
-0000a470: 5f61 6c6c 5f66 6163 6965 7328 7265 636f  _all_facies(reco
-0000a480: 6d70 7574 653d 5472 7565 290d 0a20 2020  mpute=True)..   
-0000a490: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000a4a0: 7572 6e20 7365 6c66 2e6c 6973 745f 616c  urn self.list_al
-0000a4b0: 6c5f 6661 6369 6573 0d0a 0d0a 2020 2020  l_facies....    
-0000a4c0: 6465 6620 6765 745f 7069 6c65 7328 7365  def get_piles(se
-0000a4d0: 6c66 293a 0d0a 0d0a 2020 2020 2020 2020  lf):....        
-0000a4e0: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
-0000a4f0: 7572 6e20 6120 6c69 7374 206f 6620 616c  urn a list of al
-0000a500: 6c20 7468 6520 7375 6270 696c 6573 0d0a  l the subpiles..
-0000a510: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0000a520: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0000a530: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0000a540: 2020 2020 6c69 7374 206f 6620 3a63 6c61      list of :cla
-0000a550: 7373 3a60 5069 6c65 6020 6f62 6a65 6374  ss:`Pile` object
-0000a560: 730d 0a20 2020 2020 2020 2022 2222 0d0a  s..        """..
-0000a570: 0d0a 2020 2020 2020 2020 6c3d 5b5d 0d0a  ..        l=[]..
-0000a580: 0d0a 2020 2020 2020 2020 6465 6620 6675  ..        def fu
-0000a590: 6e63 2870 696c 6529 3a0d 0a20 2020 2020  nc(pile):..     
-0000a5a0: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
-0000a5b0: 7069 6c65 290d 0a20 2020 2020 2020 2020  pile)..         
-0000a5c0: 2020 2066 6f72 2075 2069 6e20 7069 6c65     for u in pile
-0000a5d0: 2e6c 6973 745f 756e 6974 733a 0d0a 2020  .list_units:..  
-0000a5e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000a5f0: 2075 2e66 5f6d 6574 686f 6420 3d3d 2022   u.f_method == "
-0000a600: 5375 6250 696c 6522 3a0d 0a20 2020 2020  SubPile":..     
-0000a610: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000a620: 756e 6328 752e 5375 6250 696c 6529 0d0a  unc(u.SubPile)..
-0000a630: 2020 2020 2020 2020 6675 6e63 2873 656c          func(sel
-0000a640: 662e 5069 6c65 5f6d 6173 7465 7229 0d0a  f.Pile_master)..
-0000a650: 2020 2020 2020 2020 7265 7475 726e 206c          return l
-0000a660: 0d0a 0d0a 2020 2020 6465 6620 6765 7470  ....    def getp
-0000a670: 726f 7069 6e64 6578 2873 656c 662c 206e  ropindex(self, n
-0000a680: 616d 6529 3a0d 0a0d 0a20 2020 2020 2020  ame):....       
-0000a690: 2022 2222 2052 6574 7572 6e20 7468 6520   """ Return the 
-0000a6a0: 696e 6465 7820 636f 7272 6573 706f 6e64  index correspond
-0000a6b0: 696e 6720 746f 2061 2063 6572 7461 696e  ing to a certain
-0000a6c0: 2070 726f 7020 6e61 6d65 0d0a 2020 2020   prop name..    
-0000a6d0: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
-0000a6e0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0000a6f0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000a700: 2020 2020 2020 6e61 6d65 3a20 7374 720d        name: str.
-0000a710: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-0000a720: 6520 6f66 2074 6865 2070 726f 7065 7274  e of the propert
-0000a730: 7920 746f 2072 6574 7269 6576 650d 0a0d  y to retrieve...
-0000a740: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000a750: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000a760: 2d0d 0a20 2020 2020 2020 2069 6e74 0d0a  -..        int..
-0000a770: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0000a780: 7820 6f66 2074 6865 2070 726f 7065 7274  x of the propert
-0000a790: 790d 0a20 2020 2020 2020 2022 2222 0d0a  y..        """..
-0000a7a0: 0d0a 2020 2020 2020 2020 696e 7465 7265  ..        intere
-0000a7b0: 7374 3d4e 6f6e 650d 0a20 2020 2020 2020  st=None..       
-0000a7c0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0000a7d0: 6c65 6e28 7365 6c66 2e6c 6973 745f 7072  len(self.list_pr
-0000a7e0: 6f70 7329 293a 0d0a 2020 2020 2020 2020  ops)):..        
-0000a7f0: 2020 2020 6966 2073 656c 662e 6c69 7374      if self.list
-0000a800: 5f70 726f 7073 5b69 5d2e 6e61 6d65 203d  _props[i].name =
-0000a810: 3d20 6e61 6d65 3a0d 0a20 2020 2020 2020  = name:..       
-0000a820: 2020 2020 2020 2020 2069 6e74 6572 6573           interes
-0000a830: 743d 690d 0a20 2020 2020 2020 2069 6620  t=i..        if 
-0000a840: 696e 7465 7265 7374 2069 7320 4e6f 6e65  interest is None
-0000a850: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000a860: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000a870: 2774 6865 2070 726f 7072 6965 7479 2027  'the propriety '
-0000a880: 2b6e 616d 652b 2720 7761 7320 6e6f 7420  +name+' was not 
-0000a890: 666f 756e 6427 290d 0a20 2020 2020 2020  found')..       
-0000a8a0: 2072 6574 7572 6e20 696e 7465 7265 7374   return interest
-0000a8b0: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
-0000a8c0: 7072 6f70 2873 656c 662c 206e 616d 652c  prop(self, name,
-0000a8d0: 2069 753d 4e6f 6e65 2c20 6966 613d 4e6f   iu=None, ifa=No
-0000a8e0: 6e65 2c20 6970 3d4e 6f6e 652c 2061 6c6c  ne, ip=None, all
-0000a8f0: 5f64 6174 613d 5472 7565 293a 0d0a 0d0a  _data=True):....
-0000a900: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-0000a910: 2020 2020 2052 6574 7572 6e20 6120 6e75       Return a nu
-0000a920: 6d70 7920 6172 7261 7920 6f66 2031 206f  mpy array of 1 o
-0000a930: 7220 616c 6c20 6661 6369 6573 2072 6561  r all facies rea
-0000a940: 6c69 7a61 7469 6f6e 2873 292e 0d0a 0d0a  lization(s).....
-0000a950: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000a960: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0000a970: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0000a980: 6975 3a69 6e74 0d0a 2020 2020 2020 2020  iu:int..        
-0000a990: 2020 2020 756e 6974 2069 6e64 6578 0d0a      unit index..
-0000a9a0: 2020 2020 2020 2020 6966 613a 696e 740d          ifa:int.
-0000a9b0: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
-0000a9c0: 6965 7320 696e 6465 780d 0a20 2020 2020  ies index..     
-0000a9d0: 2020 2069 703a 696e 740d 0a20 2020 2020     ip:int..     
-0000a9e0: 2020 2020 2020 2070 726f 7065 7274 7920         property 
-0000a9f0: 696e 6465 780d 0a20 2020 2020 2020 2061  index..        a
-0000aa00: 6c6c 5f64 6174 613a 626f 6f6c 0d0a 2020  ll_data:bool..  
-0000aa10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000aa20: 2061 6c6c 2074 6865 2075 6e69 7473 2073   all the units s
-0000aa30: 696d 756c 6174 696f 6e73 0d0a 0d0a 2020  imulations....  
-0000aa40: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-0000aa50: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-0000aa60: 2020 2020 2020 2020 6e75 6d70 7920 6172          numpy ar
-0000aa70: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
-0000aa80: 2031 206f 7220 616c 6c20 6661 6369 6573   1 or all facies
-0000aa90: 2072 6561 6c69 7a61 7469 6f6e 2873 290d   realization(s).
-0000aaa0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-0000aab0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000aac0: 7772 6974 655f 7265 7375 6c74 733a 0d0a  write_results:..
-0000aad0: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-0000aae0: 7072 6f22 206e 6f74 2069 6e20 5b69 2e73  pro" not in [i.s
-0000aaf0: 706c 6974 2822 2e22 295b 2d31 5d20 666f  plit(".")[-1] fo
-0000ab00: 7220 6920 696e 206f 732e 6c69 7374 6469  r i in os.listdi
-0000ab10: 7228 7365 6c66 2e77 7329 5d3a 0d0a 2020  r(self.ws)]:..  
-0000ab20: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000ab30: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0000ab40: 5072 6f70 6572 7469 6573 2068 6176 6520  Properties have 
-0000ab50: 6e6f 7420 6265 656e 2063 6f6d 7075 7465  not been compute
-0000ab60: 6420 7965 7422 290d 0a0d 0a20 2020 2020  d yet")....     
-0000ab70: 2020 206c 3d5b 692e 6e61 6d65 2066 6f72     l=[i.name for
-0000ab80: 2069 2069 6e20 7365 6c66 2e6c 6973 745f   i in self.list_
-0000ab90: 7072 6f70 735d 0d0a 2020 2020 2020 2020  props]..        
-0000aba0: 6966 206e 616d 6520 6e6f 7420 696e 206c  if name not in l
-0000abb0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000abc0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0000abd0: 2754 6865 2070 726f 7072 6965 7479 2022  'The propriety "
-0000abe0: 272b 6e61 6d65 2b27 2222 2077 6173 206e  '+name+'"" was n
-0000abf0: 6f74 2066 6f75 6e64 205c 6e20 6176 6169  ot found \n avai
-0000ac00: 6c61 626c 6520 5072 6f70 6572 7479 206e  lable Property n
-0000ac10: 616d 6573 2061 7265 3a20 7b7d 272e 666f  ames are: {}'.fo
-0000ac20: 726d 6174 286c 2929 0d0a 0d0a 2020 2020  rmat(l))....    
-0000ac30: 2020 2020 6e72 6561 6c5f 7072 6f70 3d73      nreal_prop=s
-0000ac40: 656c 662e 6e72 6561 6c5f 7072 6f70 0d0a  elf.nreal_prop..
-0000ac50: 2020 2020 2020 2020 6e72 6561 6c5f 6661          nreal_fa
-0000ac60: 3d73 656c 662e 6e72 6561 6c5f 6661 0d0a  =self.nreal_fa..
-0000ac70: 2020 2020 2020 2020 6e72 6561 6c5f 753d          nreal_u=
-0000ac80: 7365 6c66 2e6e 7265 616c 5f75 6e69 7473  self.nreal_units
-0000ac90: 0d0a 2020 2020 2020 2020 6e78 3d73 656c  ..        nx=sel
-0000aca0: 662e 6765 745f 6e78 2829 0d0a 2020 2020  f.get_nx()..    
-0000acb0: 2020 2020 6e79 3d73 656c 662e 6765 745f      ny=self.get_
-0000acc0: 6e79 2829 0d0a 2020 2020 2020 2020 6e7a  ny()..        nz
-0000acd0: 3d73 656c 662e 6765 745f 6e7a 2829 0d0a  =self.get_nz()..
-0000ace0: 0d0a 2020 2020 2020 2020 6966 2061 6c6c  ..        if all
-0000acf0: 5f64 6174 613a 0d0a 2020 2020 2020 2020  _data:..        
-0000ad00: 2020 2020 7072 6f70 3d6e 702e 7a65 726f      prop=np.zero
-0000ad10: 7328 5b6e 7265 616c 5f75 2c20 6e72 6561  s([nreal_u, nrea
-0000ad20: 6c5f 6661 2c20 6e72 6561 6c5f 7072 6f70  l_fa, nreal_prop
-0000ad30: 2c20 6e7a 2c20 6e79 2c20 6e78 5d2c 2064  , nz, ny, nx], d
-0000ad40: 7479 7065 3d6e 702e 666c 6f61 7433 3229  type=np.float32)
-0000ad50: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000ad60: 6966 2073 656c 662e 7772 6974 655f 7265  if self.write_re
-0000ad70: 7375 6c74 733a 0d0a 2020 2020 2020 2020  sults:..        
-0000ad80: 2020 2020 2020 2020 2320 6765 7420 616c          # get al
-0000ad90: 6c20 7265 616c 0d0a 2020 2020 2020 2020  l real..        
-0000ada0: 2020 2020 2020 2020 666f 7220 6975 2069          for iu i
-0000adb0: 6e20 7261 6e67 6528 6e72 6561 6c5f 7529  n range(nreal_u)
-0000adc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000add0: 2020 2020 2020 2066 6f72 2069 6661 2069         for ifa i
-0000ade0: 6e20 7261 6e67 6528 6e72 6561 6c5f 6661  n range(nreal_fa
-0000adf0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000ae00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000ae10: 6970 2069 6e20 7261 6e67 6528 6e72 6561  ip in range(nrea
-0000ae20: 6c5f 7072 6f70 293a 0d0a 2020 2020 2020  l_prop):..      
-0000ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae40: 2020 2020 2020 666e 616d 653d 7365 6c66        fname=self
-0000ae50: 2e6e 616d 652b 227b 7d5f 7b7d 5f7b 7d5f  .name+"{}_{}_{}_
-0000ae60: 7b7d 2e70 726f 222e 666f 726d 6174 286e  {}.pro".format(n
-0000ae70: 616d 652c 2069 752c 2069 6661 2c20 6970  ame, iu, ifa, ip
-0000ae80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000ae90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000aea0: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
-0000aeb0: 6e28 7365 6c66 2e77 732c 2066 6e61 6d65  n(self.ws, fname
-0000aec0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000aed0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000aee0: 6974 6820 6f70 656e 2866 7061 7468 2c20  ith open(fpath, 
-0000aef0: 2272 6222 2920 6173 2066 3a0d 0a20 2020  "rb") as f:..   
+00008920: 2069 6620 752e 665f 6d65 7468 6f64 203d   if u.f_method =
+00008930: 3d20 2253 7562 5069 6c65 223a 0d0a 2020  = "SubPile":..  
+00008940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008950: 2020 2020 2020 6966 2075 2e67 6574 5f68        if u.get_h
+00008960: 5f6c 6576 656c 2829 203c 2068 5f6c 6576  _level() < h_lev
+00008970: 656c 3a0d 0a20 2020 2020 2020 2020 2020  el:..           
+00008980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008990: 2066 756e 2875 2e53 7562 5069 6c65 290d   fun(u.SubPile).
+000089a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000089b0: 2020 2020 2020 2020 2065 6c69 6620 752e           elif u.
+000089c0: 6765 745f 685f 6c65 7665 6c28 2920 3d3d  get_h_level() ==
+000089d0: 2068 5f6c 6576 656c 3a0d 0a20 2020 2020   h_level:..     
+000089e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000089f0: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
+00008a00: 7529 0d0a 2020 2020 2020 2020 2020 2020  u)..            
+00008a10: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00008a20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00008a30: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00008a40: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
+00008a50: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00008a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a70: 2020 2020 2020 2020 6c2e 6170 7065 6e64          l.append
+00008a80: 2875 290d 0a0d 0a20 2020 2020 2020 2066  (u)....        f
+00008a90: 756e 2873 656c 662e 6765 745f 7069 6c65  un(self.get_pile
+00008aa0: 5f6d 6173 7465 7228 2929 0d0a 2020 2020  _master())..    
+00008ab0: 2020 2020 6e6c 6179 3d6c 656e 286c 290d      nlay=len(l).
+00008ac0: 0a20 2020 2020 2020 2075 6e69 745f 6e61  .        unit_na
+00008ad0: 6d65 733d 5b69 2e6e 616d 6520 666f 7220  mes=[i.name for 
+00008ae0: 6920 696e 206c 5d0d 0a20 2020 2020 2020  i in l]..       
+00008af0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00008b00: 6e6c 6179 293a 0d0a 2020 2020 2020 2020  nlay):..        
+00008b10: 2020 2020 753d 6c5b 695d 0d0a 2020 2020      u=l[i]..    
+00008b20: 2020 2020 2020 2020 733d 7365 6c66 2e67          s=self.g
+00008b30: 6574 5f73 7572 6661 6365 735f 756e 6974  et_surfaces_unit
+00008b40: 2875 290d 0a20 2020 2020 2020 2020 2020  (u)..           
+00008b50: 2069 6620 6920 3d3d 2030 3a0d 0a20 2020   if i == 0:..   
+00008b60: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+00008b70: 616c 2c20 6e79 2c20 6e78 3d73 2e73 6861  al, ny, nx=s.sha
+00008b80: 7065 0d0a 2020 2020 2020 2020 2020 2020  pe..            
+00008b90: 2020 2020 7375 7266 733d 6e70 2e7a 6572      surfs=np.zer
+00008ba0: 6f73 285b 6e6c 6179 2c20 6e72 6561 6c2c  os([nlay, nreal,
+00008bb0: 206e 792c 206e 785d 2c20 6474 7970 653d   ny, nx], dtype=
+00008bc0: 6e70 2e66 6c6f 6174 3332 290d 0a20 2020  np.float32)..   
+00008bd0: 2020 2020 2020 2020 2020 2020 2073 7572               sur
+00008be0: 6673 5b30 5d3d 730d 0a20 2020 2020 2020  fs[0]=s..       
+00008bf0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00008c00: 2020 2020 2020 2020 2020 2020 7375 7266              surf
+00008c10: 735b 695d 3d73 0d0a 2020 2020 2020 2020  s[i]=s..        
+00008c20: 7265 7475 726e 2073 7572 6673 2c20 756e  return surfs, un
+00008c30: 6974 5f6e 616d 6573 0d0a 0d0a 2020 2020  it_names....    
+00008c40: 6465 6620 6765 745f 756e 6974 2873 656c  def get_unit(sel
+00008c50: 662c 206e 616d 653d 2241 222c 2049 443d  f, name="A", ID=
+00008c60: 312c 2074 7970 653d 226e 616d 6522 2c20  1, type="name", 
+00008c70: 616c 6c5f 7374 7261 7473 3d54 7275 652c  all_strats=True,
+00008c80: 2076 623d 3129 3a0d 0a0d 0a20 2020 2020   vb=1):....     
+00008c90: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00008ca0: 5265 7475 726e 2074 6865 2075 6e69 7420  Return the unit 
+00008cb0: 696e 2074 6865 2050 696c 6520 7769 7468  in the Pile with
+00008cc0: 2074 6865 2061 7373 6f63 6961 7465 6420   the associated 
+00008cd0: 6e61 6d65 206f 7220 4944 2e0d 0a0d 0a20  name or ID..... 
+00008ce0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00008cf0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00008d00: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206e  -----..        n
+00008d10: 616d 653a 2073 7472 696e 670d 0a20 2020  ame: string..   
+00008d20: 2020 2020 2020 2020 206e 616d 6520 6f66           name of
+00008d30: 2074 6865 2073 7472 6174 6920 746f 2072   the strati to r
+00008d40: 6574 7269 6576 650d 0a20 2020 2020 2020  etrieve..       
+00008d50: 2049 443a 2069 6e74 0d0a 2020 2020 2020   ID: int..      
+00008d60: 2020 2020 2020 4944 206f 6620 7468 6520        ID of the 
+00008d70: 7374 7261 7469 2074 6f20 7265 7472 6965  strati to retrie
+00008d80: 7665 0d0a 2020 2020 2020 2020 7479 7065  ve..        type
+00008d90: 3a20 7374 722c 2028 6e61 6d65 206f 7220  : str, (name or 
+00008da0: 4944 290d 0a20 2020 2020 2020 2020 2020  ID)..           
+00008db0: 2072 6574 7269 6576 696e 6720 6d65 7468   retrieving meth
+00008dc0: 6f64 0d0a 2020 2020 2020 2020 616c 6c5f  od..        all_
+00008dd0: 7374 7261 7473 3a20 626f 6f6c 0d0a 2020  strats: bool..  
+00008de0: 2020 2020 2020 2020 2020 666c 6167 2074            flag t
+00008df0: 6f20 696e 6469 6361 7465 2074 6f20 616c  o indicate to al
+00008e00: 736f 2073 6561 7263 6820 696e 2073 7562  so search in sub
+00008e10: 2d75 6e69 7473 2c0d 0a20 2020 2020 2020  -units,..       
+00008e20: 2020 2020 2069 6620 6661 6c73 6520 7265       if false re
+00008e30: 7365 6172 6368 2077 696c 6c20 6265 2072  search will be r
+00008e40: 6573 7472 6963 7465 6420 746f 2075 6e69  estricted to uni
+00008e50: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00008e60: 6469 7265 6374 6c79 2069 6e20 7468 6520  directly in the 
+00008e70: 5069 6c65 206d 6173 7465 720d 0a20 2020  Pile master..   
+00008e80: 2020 2020 2076 623a 2069 6e74 0d0a 2020       vb: int..  
+00008e90: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
+00008ea0: 6974 7920 6c65 7665 6c0d 0a0d 0a20 2020  ity level....   
+00008eb0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00008ec0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+00008ed0: 2020 2020 2020 203a 636c 6173 733a 6055         :class:`U
+00008ee0: 6e69 7460 206f 626a 6563 740d 0a20 2020  nit` object..   
+00008ef0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00008f00: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
+00008f10: 7461 6e63 6528 6e61 6d65 2c20 7374 7229  tance(name, str)
+00008f20: 2c20 224e 616d 6520 6d75 7374 2062 6520  , "Name must be 
+00008f30: 6120 7374 7269 6e67 220d 0a0d 0a20 2020  a string"....   
+00008f40: 2020 2020 2069 6620 616c 6c5f 7374 7261       if all_stra
+00008f50: 7473 3a0d 0a20 2020 2020 2020 2020 2020  ts:..           
+00008f60: 206c 3d73 656c 662e 6765 745f 616c 6c5f   l=self.get_all_
+00008f70: 756e 6974 7328 290d 0a20 2020 2020 2020  units()..       
+00008f80: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00008f90: 2020 2020 6c3d 7365 6c66 2e67 6574 5f70      l=self.get_p
+00008fa0: 696c 655f 6d61 7374 6572 2829 2e6c 6973  ile_master().lis
+00008fb0: 745f 756e 6974 7328 290d 0a20 2020 2020  t_units()..     
+00008fc0: 2020 2066 6f72 2073 2069 6e20 6c3a 0d0a     for s in l:..
+00008fd0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00008fe0: 7970 6520 3d3d 2022 6e61 6d65 223a 0d0a  ype == "name":..
+00008ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009000: 6966 2073 2e6e 616d 6520 3d3d 206e 616d  if s.name == nam
+00009010: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00009020: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00009030: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00009040: 6966 2074 7970 6520 3d3d 2022 4944 223a  if type == "ID":
+00009050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009060: 2020 6966 2073 2e49 4420 3d3d 2049 443a    if s.ID == ID:
+00009070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009080: 2020 2020 2020 7265 7475 726e 2073 0d0a        return s..
+00009090: 0d0a 2020 2020 2020 2020 6966 2074 7970  ..        if typ
+000090a0: 653d 3d22 6e61 6d65 223a 0d0a 2020 2020  e=="name":..    
+000090b0: 2020 2020 2020 2020 7661 723d 6e61 6d65          var=name
+000090c0: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
+000090d0: 7970 653d 3d22 4944 223a 0d0a 2020 2020  ype=="ID":..    
+000090e0: 2020 2020 2020 2020 7661 723d 4944 0d0a          var=ID..
+000090f0: 2020 2020 2020 2020 6966 2076 623a 0d0a          if vb:..
+00009100: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00009110: 7420 2822 4e6f 2075 6e69 7420 7769 7468  t ("No unit with
+00009120: 2074 6861 7420 6e61 6d65 2f49 4420 7b7d   that name/ID {}
+00009130: 222e 666f 726d 6174 2876 6172 2929 0d0a  ".format(var))..
+00009140: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00009150: 6f6e 650d 0a0d 0a20 2020 2064 6566 2067  one....    def g
+00009160: 6574 6268 696e 6465 7828 7365 6c66 2c20  etbhindex(self, 
+00009170: 4944 293a 0d0a 0d0a 2020 2020 2020 2020  ID):....        
+00009180: 2222 220d 0a20 2020 2020 2020 2052 6574  """..        Ret
+00009190: 7572 6e20 7468 6520 696e 6465 7820 636f  urn the index co
+000091a0: 7272 6573 706f 6e64 696e 6720 746f 2061  rresponding to a
+000091b0: 2063 6572 7461 696e 2062 6f72 6568 6f6c   certain borehol
+000091c0: 6520 4944 0d0a 0d0a 2020 2020 2020 2020  e ID....        
+000091d0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+000091e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+000091f0: 2020 2020 2020 2020 4944 3a20 7374 7269          ID: stri
+00009200: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
+00009210: 626f 7265 686f 6c65 2049 440d 0a0d 0a20  borehole ID.... 
+00009220: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00009230: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00009240: 0a20 2020 2020 2020 2069 6e74 0d0a 2020  .        int..  
+00009250: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+00009260: 6f66 2074 6865 2062 6f72 6568 6f6c 6520  of the borehole 
+00009270: 696e 2074 6865 2070 696c 650d 0a20 2020  in the pile..   
+00009280: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00009290: 2020 2020 696e 7465 7265 7374 3d4e 6f6e      interest=Non
+000092a0: 650d 0a20 2020 2020 2020 2066 6f72 2069  e..        for i
+000092b0: 2069 6e20 7261 6e67 6528 6c65 6e28 7365   in range(len(se
+000092c0: 6c66 2e6c 6973 745f 6268 7329 293a 0d0a  lf.list_bhs)):..
+000092d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000092e0: 656c 662e 6c69 7374 5f62 6873 5b69 5d2e  elf.list_bhs[i].
+000092f0: 4944 203d 3d20 4944 3a0d 0a20 2020 2020  ID == ID:..     
+00009300: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+00009310: 6573 743d 690d 0a20 2020 2020 2020 2069  est=i..        i
+00009320: 6620 696e 7465 7265 7374 2069 7320 4e6f  f interest is No
+00009330: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00009340: 2061 7373 6572 7420 312c 2028 2774 6865   assert 1, ('the
+00009350: 2070 726f 7072 6965 7479 2027 2b49 442b   propriety '+ID+
+00009360: 2720 7761 7320 6e6f 7420 666f 756e 6427  ' was not found'
+00009370: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00009380: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00009390: 7475 726e 2069 6e74 6572 6573 740d 0a0d  turn interest...
+000093a0: 0a20 2020 2064 6566 2067 6574 5f62 6828  .    def get_bh(
+000093b0: 7365 6c66 2c20 4944 293a 0d0a 0d0a 2020  self, ID):....  
+000093c0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000093d0: 2020 2052 6574 7572 6e20 7468 6520 626f     Return the bo
+000093e0: 7265 686f 6c65 206f 626a 6563 7420 6769  rehole object gi
+000093f0: 7665 6e20 6974 7320 4944 0d0a 0d0a 2020  ven its ID....  
+00009400: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00009410: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00009420: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4944  ----..        ID
+00009430: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
+00009440: 2020 2020 2020 626f 7265 686f 6c65 2049        borehole I
+00009450: 440d 0a0d 0a20 2020 2020 2020 2052 6574  D....        Ret
+00009460: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00009470: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 203a  -----..        :
+00009480: 636c 6173 733a 6042 6f72 6568 6f6c 6560  class:`Borehole`
+00009490: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+000094a0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+000094b0: 696e 6465 783d 7365 6c66 2e67 6574 6268  index=self.getbh
+000094c0: 696e 6465 7828 4944 290d 0a20 2020 2020  index(ID)..     
+000094d0: 2020 2072 6574 7572 6e20 7365 6c66 2e6c     return self.l
+000094e0: 6973 745f 6268 735b 696e 6465 785d 0d0a  ist_bhs[index]..
+000094f0: 0d0a 2020 2020 6465 6620 6765 745f 6661  ..    def get_fa
+00009500: 6369 6573 5f6f 626a 2873 656c 662c 206e  cies_obj(self, n
+00009510: 616d 653d 2241 222c 2049 443d 312c 2074  ame="A", ID=1, t
+00009520: 7970 653d 226e 616d 6522 2c20 7662 3d31  ype="name", vb=1
+00009530: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+00009540: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
+00009550: 6e20 7468 6520 6661 6369 6573 2069 6e20  n the facies in 
+00009560: 7468 6520 5069 6c65 2077 6974 6820 7468  the Pile with th
+00009570: 6520 6173 736f 6369 6174 6564 206e 616d  e associated nam
+00009580: 6520 6f72 2049 442e 0d0a 0d0a 2020 2020  e or ID.....    
+00009590: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+000095a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000095b0: 2d2d 0d0a 2020 2020 2020 2020 6e61 6d65  --..        name
+000095c0: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
+000095d0: 2020 2020 2020 6e61 6d65 206f 6620 7468        name of th
+000095e0: 6520 7374 7261 7469 2074 6f20 7265 7472  e strati to retr
+000095f0: 6965 7665 0d0a 2020 2020 2020 2020 4944  ieve..        ID
+00009600: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
+00009610: 2020 2049 4420 6f66 2074 6865 2073 7472     ID of the str
+00009620: 6174 6920 746f 2072 6574 7269 6576 650d  ati to retrieve.
+00009630: 0a20 2020 2020 2020 2074 7970 653a 2073  .        type: s
+00009640: 7472 2c20 286e 616d 6520 6f72 2049 4429  tr, (name or ID)
+00009650: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00009660: 7472 6965 7669 6e67 206d 6574 686f 640d  trieving method.
+00009670: 0a20 2020 2020 2020 2076 623a 2069 6e74  .        vb: int
+00009680: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+00009690: 7262 6f73 6974 7920 6c65 7665 6c20 2830  rbosity level (0
+000096a0: 206f 7220 3129 0d0a 0d0a 2020 2020 2020   or 1)....      
+000096b0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+000096c0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+000096d0: 2020 2020 3a63 6c61 7373 3a60 4661 6369      :class:`Faci
+000096e0: 6573 6020 6f62 6a65 6374 0d0a 2020 2020  es` object..    
+000096f0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00009700: 2020 2061 7373 6572 7420 6973 696e 7374     assert isinst
+00009710: 616e 6365 286e 616d 652c 2073 7472 292c  ance(name, str),
+00009720: 2022 4e61 6d65 206d 7573 7420 6265 2061   "Name must be a
+00009730: 2073 7472 696e 6722 0d0a 0d0a 2020 2020   string"....    
+00009740: 2020 2020 6c3d 7365 6c66 2e67 6574 5f61      l=self.get_a
+00009750: 6c6c 5f66 6163 6965 7328 290d 0a20 2020  ll_facies()..   
+00009760: 2020 2020 2066 6f72 2073 2069 6e20 6c3a       for s in l:
+00009770: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00009780: 2074 7970 6520 3d3d 2022 6e61 6d65 223a   type == "name":
+00009790: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000097a0: 2020 6966 2073 2e6e 616d 6520 3d3d 206e    if s.name == n
+000097b0: 616d 653a 0d0a 2020 2020 2020 2020 2020  ame:..          
+000097c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000097d0: 2073 0d0a 0d0a 2020 2020 2020 2020 2020   s....          
+000097e0: 2020 656c 6966 2074 7970 6520 3d3d 2022    elif type == "
+000097f0: 4944 223a 0d0a 2020 2020 2020 2020 2020  ID":..          
+00009800: 2020 2020 2020 6966 2073 2e49 4420 3d3d        if s.ID ==
+00009810: 2049 443a 0d0a 2020 2020 2020 2020 2020   ID:..          
+00009820: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00009830: 2073 0d0a 0d0a 2020 2020 2020 2020 6966   s....        if
+00009840: 2074 7970 653d 3d22 6e61 6d65 223a 0d0a   type=="name":..
+00009850: 2020 2020 2020 2020 2020 2020 7661 723d              var=
+00009860: 6e61 6d65 0d0a 2020 2020 2020 2020 656c  name..        el
+00009870: 6966 2074 7970 653d 3d22 4944 223a 0d0a  if type=="ID":..
+00009880: 2020 2020 2020 2020 2020 2020 7661 723d              var=
+00009890: 4944 0d0a 2020 2020 2020 2020 6966 2076  ID..        if v
+000098a0: 623a 0d0a 2020 2020 2020 2020 2020 2020  b:..            
+000098b0: 7072 696e 7420 2822 4e6f 2066 6163 6965  print ("No facie
+000098c0: 7320 7769 7468 2074 6861 7420 6e61 6d65  s with that name
+000098d0: 2f49 4420 7b7d 222e 666f 726d 6174 2876  /ID {}".format(v
+000098e0: 6172 2929 0d0a 2020 2020 2020 2020 7265  ar))..        re
+000098f0: 7475 726e 204e 6f6e 650d 0a0d 0a20 2020  turn None....   
+00009900: 2064 6566 2070 6f69 6e74 546f 496e 6465   def pointToInde
+00009910: 7828 7365 6c66 2c20 782c 2079 2c20 7a29  x(self, x, y, z)
+00009920: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
+00009930: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00009940: 2020 5265 7475 726e 2074 6865 2069 6e64    Return the ind
+00009950: 6578 206f 6620 7468 6520 6365 6c6c 2063  ex of the cell c
+00009960: 6f6e 7461 696e 696e 6720 7468 6520 706f  ontaining the po
+00009970: 696e 7420 2878 2c79 2c7a 290d 0a0d 0a20  int (x,y,z).... 
+00009980: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00009990: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000099a0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2078  -----..        x
+000099b0: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+000099c0: 2020 2020 2078 2063 6f6f 7264 696e 6174       x coordinat
+000099d0: 6520 6f66 2074 6865 2070 6f69 6e74 0d0a  e of the point..
+000099e0: 2020 2020 2020 2020 793a 2066 6c6f 6174          y: float
+000099f0: 0d0a 2020 2020 2020 2020 2020 2020 7920  ..            y 
+00009a00: 636f 6f72 6469 6e61 7465 206f 6620 7468  coordinate of th
+00009a10: 6520 706f 696e 740d 0a20 2020 2020 2020  e point..       
+00009a20: 207a 3a20 666c 6f61 740d 0a20 2020 2020   z: float..     
+00009a30: 2020 2020 2020 207a 2063 6f6f 7264 696e         z coordin
+00009a40: 6174 6520 6f66 2074 6865 2070 6f69 6e74  ate of the point
+00009a50: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00009a60: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00009a70: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3320  ----..        3 
+00009a80: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+00009a90: 2069 6e64 6578 206f 6620 7468 6520 6365   index of the ce
+00009aa0: 6c6c 2063 6f6e 7461 696e 696e 6720 7468  ll containing th
+00009ab0: 6520 706f 696e 7420 2878 2c79 2c7a 290d  e point (x,y,z).
+00009ac0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+00009ad0: 2020 2020 2020 2020 6365 6c6c 5f78 3d6e          cell_x=n
+00009ae0: 702e 6172 7261 7928 2878 2d73 656c 662e  p.array((x-self.
+00009af0: 6f78 292f 7365 6c66 2e73 7829 2e61 7374  ox)/self.sx).ast
+00009b00: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
+00009b10: 2020 6365 6c6c 5f79 3d6e 702e 6172 7261    cell_y=np.arra
+00009b20: 7928 2879 2d73 656c 662e 6f79 292f 7365  y((y-self.oy)/se
+00009b30: 6c66 2e73 7929 2e61 7374 7970 6528 696e  lf.sy).astype(in
+00009b40: 7429 0d0a 2020 2020 2020 2020 6365 6c6c  t)..        cell
+00009b50: 5f7a 3d6e 702e 6172 7261 7928 287a 2d73  _z=np.array((z-s
+00009b60: 656c 662e 6f7a 292f 7365 6c66 2e73 7a29  elf.oz)/self.sz)
+00009b70: 2e61 7374 7970 6528 696e 7429 0d0a 0d0a  .astype(int)....
+00009b80: 2020 2020 2020 2020 7265 7475 726e 2063          return c
+00009b90: 656c 6c5f 782c 2063 656c 6c5f 792c 2063  ell_x, cell_y, c
+00009ba0: 656c 6c5f 7a0d 0a0d 0a0d 0a20 2020 2064  ell_z......    d
+00009bb0: 6566 2067 6574 5f61 6c6c 5f75 6e69 7473  ef get_all_units
+00009bc0: 2873 656c 662c 2072 6563 6f6d 7075 7465  (self, recompute
+00009bd0: 3d54 7275 6529 3a0d 0a0d 0a20 2020 2020  =True):....     
+00009be0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00009bf0: 5265 7475 726e 2061 206c 6973 7420 6f66  Return a list of
+00009c00: 2061 6c6c 2075 6e69 7473 2c20 6576 656e   all units, even
+00009c10: 2073 7562 2d75 6e69 7473 0d0a 0d0a 2020   sub-units....  
+00009c20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00009c30: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00009c40: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7265  ----..        re
+00009c50: 636f 6d70 7574 653a 2062 6f6f 6c0d 0a20  compute: bool.. 
+00009c60: 2020 2020 2020 2020 2020 2069 6620 4661             if Fa
+00009c70: 6c73 652c 2074 6865 206c 6973 7420 616c  lse, the list al
+00009c80: 6c20 756e 6974 7320 6174 7472 6962 7574  l units attribut
+00009c90: 650d 0a20 2020 2020 2020 2020 2020 2077  e..            w
+00009ca0: 696c 6c20 6265 2073 696d 706c 7920 7265  ill be simply re
+00009cb0: 7472 6965 7665 2e20 4576 656e 2069 6620  trieve. Even if 
+00009cc0: 6368 616e 6765 7320 6861 7665 0d0a 2020  changes have..  
+00009cd0: 2020 2020 2020 2020 2020 6265 656e 206d            been m
+00009ce0: 6164 652e 0d0a 0d0a 2020 2020 2020 2020  ade.....        
+00009cf0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00009d00: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00009d10: 2020 6c69 7374 206f 6620 3a63 6c61 7373    list of :class
+00009d20: 3a60 556e 6974 6020 6f62 6a65 6374 730d  :`Unit` objects.
+00009d30: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+00009d40: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00009d50: 656c 662e 6c69 7374 5f61 6c6c 5f75 6e69  elf.list_all_uni
+00009d60: 7473 2920 3d3d 2030 3a0d 0a20 2020 2020  ts) == 0:..     
+00009d70: 2020 2020 2020 2072 6563 6f6d 7075 7465         recompute
+00009d80: 3d54 7275 650d 0a20 2020 2020 2020 2069  =True..        i
+00009d90: 6620 7365 6c66 2e6c 6973 745f 616c 6c5f  f self.list_all_
+00009da0: 756e 6974 7320 6973 204e 6f6e 6520 6f72  units is None or
+00009db0: 2072 6563 6f6d 7075 7465 3a20 2320 7265   recompute: # re
+00009dc0: 636f 6d70 7574 6520 6966 2077 616e 7465  compute if wante
+00009dd0: 6420 6f66 2069 6620 7468 6572 6520 6973  d of if there is
+00009de0: 206e 6f20 6c69 7374 5f61 6c6c 5f73 7472   no list_all_str
+00009df0: 6174 6973 0d0a 0d0a 2020 2020 2020 2020  atis....        
+00009e00: 2020 2020 6465 6620 6c69 7374 5f61 6c6c      def list_all
+00009e10: 5f75 6e69 7473 2861 6c6c 5f73 7472 6174  _units(all_strat
+00009e20: 6973 2c20 7375 6270 696c 655f 7374 7261  is, subpile_stra
+00009e30: 7469 7329 3a0d 0a0d 0a20 2020 2020 2020  tis):....       
+00009e40: 2020 2020 2020 2020 2061 6c6c 5f73 7472           all_str
+00009e50: 6174 6973 3d61 6c6c 5f73 7472 6174 6973  atis=all_stratis
+00009e60: 202b 2073 7562 7069 6c65 5f73 7472 6174   + subpile_strat
+00009e70: 6973 0d0a 2020 2020 2020 2020 2020 2020  is..            
+00009e80: 2020 2020 666f 7220 7320 696e 2073 7562      for s in sub
+00009e90: 7069 6c65 5f73 7472 6174 6973 3a0d 0a20  pile_stratis:.. 
+00009ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009eb0: 2020 2069 6620 732e 665f 6d65 7468 6f64     if s.f_method
+00009ec0: 203d 3d20 2253 7562 5069 6c65 223a 0d0a   == "SubPile":..
+00009ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ee0: 2020 2020 2020 2020 616c 6c5f 7374 7261          all_stra
+00009ef0: 7469 733d 6c69 7374 5f61 6c6c 5f75 6e69  tis=list_all_uni
+00009f00: 7473 2861 6c6c 5f73 7472 6174 6973 2c20  ts(all_stratis, 
+00009f10: 732e 5375 6250 696c 652e 6c69 7374 5f75  s.SubPile.list_u
+00009f20: 6e69 7473 290d 0a20 2020 2020 2020 2020  nits)..         
+00009f30: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
+00009f40: 6c5f 7374 7261 7469 730d 0a0d 0a20 2020  l_stratis....   
+00009f50: 2020 2020 2020 2020 206c 6175 3d6c 6973           lau=lis
+00009f60: 745f 616c 6c5f 756e 6974 7328 5b5d 2c20  t_all_units([], 
+00009f70: 7365 6c66 2e67 6574 5f70 696c 655f 6d61  self.get_pile_ma
+00009f80: 7374 6572 2829 2e6c 6973 745f 756e 6974  ster().list_unit
+00009f90: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00009fa0: 2363 6865 636b 2074 6861 7420 7374 7261  #check that stra
+00009fb0: 7469 7320 6861 7665 2064 6966 6665 7265  tis have differe
+00009fc0: 6e74 206e 616d 6573 0d0a 2020 2020 2020  nt names..      
+00009fd0: 2020 2020 2020 6c3d 5b5d 0d0a 2020 2020        l=[]..    
+00009fe0: 2020 2020 2020 2020 666f 7220 7320 696e          for s in
+00009ff0: 206c 6175 3a0d 0a20 2020 2020 2020 2020   lau:..         
+0000a000: 2020 2020 2020 2069 6620 732e 6e61 6d65         if s.name
+0000a010: 206e 6f74 2069 6e20 6c3a 0d0a 2020 2020   not in l:..    
+0000a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a030: 6c2e 6170 7065 6e64 2873 2e6e 616d 6529  l.append(s.name)
+0000a040: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a050: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000a060: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000a070: 7365 2056 616c 7565 4572 726f 7228 2253  se ValueError("S
+0000a080: 6f6d 6520 756e 6974 7320 6861 7665 2074  ome units have t
+0000a090: 6865 2073 616d 6520 6e61 6d65 2028 556e  he same name (Un
+0000a0a0: 6974 207b 7d22 2e66 6f72 6d61 7428 732e  it {}".format(s.
+0000a0b0: 6e61 6d65 2929 0d0a 2020 2020 2020 2020  name))..        
+0000a0c0: 2020 2020 7365 6c66 2e6c 6973 745f 616c      self.list_al
+0000a0d0: 6c5f 756e 6974 733d 6c61 750d 0a0d 0a20  l_units=lau.... 
+0000a0e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000a0f0: 6c66 2e6c 6973 745f 616c 6c5f 756e 6974  lf.list_all_unit
+0000a100: 730d 0a0d 0a20 2020 2064 6566 2067 6574  s....    def get
+0000a110: 5f61 6c6c 5f66 6163 6965 7328 7365 6c66  _all_facies(self
+0000a120: 2c20 7265 636f 6d70 7574 653d 5472 7565  , recompute=True
+0000a130: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+0000a140: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
+0000a150: 6e20 6120 6c69 7374 206f 6620 616c 6c20  n a list of all 
+0000a160: 6661 6369 6573 0d0a 0d0a 2020 2020 2020  facies....      
+0000a170: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0000a180: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0000a190: 0d0a 2020 2020 2020 2020 7265 636f 6d70  ..        recomp
+0000a1a0: 7574 653a 2062 6f6f 6c0d 0a20 2020 2020  ute: bool..     
+0000a1b0: 2020 2020 2020 2069 6620 4661 6c73 652c         if False,
+0000a1c0: 2074 6865 206c 6973 7420 616c 6c20 6661   the list all fa
+0000a1d0: 6369 6573 2061 7474 7269 6275 7465 0d0a  cies attribute..
+0000a1e0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+0000a1f0: 2062 6520 7369 6d70 6c79 2072 6574 7269   be simply retri
+0000a200: 6576 652e 2045 7665 6e20 6966 2063 6861  eve. Even if cha
+0000a210: 6e67 6573 2068 6176 650d 0a20 2020 2020  nges have..     
+0000a220: 2020 2020 2020 2062 6565 6e20 6d61 6465         been made
+0000a230: 206f 6e20 7468 6520 7072 6f6a 6563 742e   on the project.
+0000a240: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0000a250: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+0000a260: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+0000a270: 2020 2020 2020 6c69 7374 206f 6620 3a63        list of :c
+0000a280: 6c61 7373 3a60 4661 6369 6573 6020 6f62  lass:`Facies` ob
+0000a290: 6a65 6374 730d 0a20 2020 2020 2020 2022  jects..        "
+0000a2a0: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
+0000a2b0: 206c 656e 2873 656c 662e 6c69 7374 5f61   len(self.list_a
+0000a2c0: 6c6c 5f66 6163 6965 7329 203d 3d20 303a  ll_facies) == 0:
+0000a2d0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0000a2e0: 636f 6d70 7574 653d 5472 7565 0d0a 0d0a  compute=True....
+0000a2f0: 2020 2020 2020 2020 6966 2072 6563 6f6d          if recom
+0000a300: 7075 7465 3a0d 0a20 2020 2020 2020 2020  pute:..         
+0000a310: 2020 206c 3d5b 5d0d 0a20 2020 2020 2020     l=[]..       
+0000a320: 2020 2020 2064 6566 206c 5f66 6128 7069       def l_fa(pi
+0000a330: 6c65 293a 0d0a 2020 2020 2020 2020 2020  le):..          
+0000a340: 2020 2020 2020 666f 7220 7320 696e 2070        for s in p
+0000a350: 696c 652e 6c69 7374 5f75 6e69 7473 3a0d  ile.list_units:.
+0000a360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a370: 2020 2020 2066 6f72 2066 6120 696e 2073       for fa in s
+0000a380: 2e6c 6973 745f 6661 6369 6573 3a0d 0a20  .list_facies:.. 
+0000a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3a0: 2020 2020 2020 2069 6620 6661 206e 6f74         if fa not
+0000a3b0: 2069 6e20 6c3a 0d0a 2020 2020 2020 2020   in l:..        
+0000a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3d0: 2020 2020 6c2e 6170 7065 6e64 2866 6129      l.append(fa)
+0000a3e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000a3f0: 2020 2020 2020 6966 2073 2e66 5f6d 6574        if s.f_met
+0000a400: 686f 6420 3d3d 2022 5375 6250 696c 6522  hod == "SubPile"
+0000a410: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000a420: 2020 2020 2020 2020 2020 206c 5f66 6128             l_fa(
+0000a430: 732e 5375 6250 696c 6529 0d0a 0d0a 2020  s.SubPile)....  
+0000a440: 2020 2020 2020 2020 2020 6c5f 6661 2873            l_fa(s
+0000a450: 656c 662e 6765 745f 7069 6c65 5f6d 6173  elf.get_pile_mas
+0000a460: 7465 7228 2929 0d0a 2020 2020 2020 2020  ter())..        
+0000a470: 2020 2020 7365 6c66 2e6c 6973 745f 616c      self.list_al
+0000a480: 6c5f 6661 6369 6573 3d6c 0d0a 2020 2020  l_facies=l..    
+0000a490: 2020 2020 2020 2020 7265 7475 726e 206c          return l
+0000a4a0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000a4b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000a4c0: 7365 6c66 2e6c 6973 745f 616c 6c5f 6661  self.list_all_fa
+0000a4d0: 6369 6573 2069 7320 6e6f 7420 4e6f 6e65  cies is not None
+0000a4e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000a4f0: 2020 2072 6574 7572 6e20 7365 6c66 2e6c     return self.l
+0000a500: 6973 745f 616c 6c5f 6661 6369 6573 0d0a  ist_all_facies..
+0000a510: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000a520: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+0000a530: 2020 2020 2073 656c 662e 6765 745f 616c       self.get_al
+0000a540: 6c5f 6661 6369 6573 2872 6563 6f6d 7075  l_facies(recompu
+0000a550: 7465 3d54 7275 6529 0d0a 2020 2020 2020  te=True)..      
+0000a560: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000a570: 2073 656c 662e 6c69 7374 5f61 6c6c 5f66   self.list_all_f
+0000a580: 6163 6965 730d 0a0d 0a20 2020 2064 6566  acies....    def
+0000a590: 2067 6574 5f70 696c 6573 2873 656c 6629   get_piles(self)
+0000a5a0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+0000a5b0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000a5c0: 2061 206c 6973 7420 6f66 2061 6c6c 2074   a list of all t
+0000a5d0: 6865 2073 7562 7069 6c65 730d 0a20 2020  he subpiles..   
+0000a5e0: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
+0000a5f0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0000a600: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000a610: 206c 6973 7420 6f66 203a 636c 6173 733a   list of :class:
+0000a620: 6050 696c 6560 206f 626a 6563 7473 0d0a  `Pile` objects..
+0000a630: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0000a640: 2020 2020 2020 206c 3d5b 5d0d 0a0d 0a20         l=[].... 
+0000a650: 2020 2020 2020 2064 6566 2066 756e 6328         def func(
+0000a660: 7069 6c65 293a 0d0a 2020 2020 2020 2020  pile):..        
+0000a670: 2020 2020 6c2e 6170 7065 6e64 2870 696c      l.append(pil
+0000a680: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0000a690: 666f 7220 7520 696e 2070 696c 652e 6c69  for u in pile.li
+0000a6a0: 7374 5f75 6e69 7473 3a0d 0a20 2020 2020  st_units:..     
+0000a6b0: 2020 2020 2020 2020 2020 2069 6620 752e             if u.
+0000a6c0: 665f 6d65 7468 6f64 203d 3d20 2253 7562  f_method == "Sub
+0000a6d0: 5069 6c65 223a 0d0a 2020 2020 2020 2020  Pile":..        
+0000a6e0: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0000a6f0: 2875 2e53 7562 5069 6c65 290d 0a20 2020  (u.SubPile)..   
+0000a700: 2020 2020 2066 756e 6328 7365 6c66 2e50       func(self.P
+0000a710: 696c 655f 6d61 7374 6572 290d 0a20 2020  ile_master)..   
+0000a720: 2020 2020 2072 6574 7572 6e20 6c0d 0a0d       return l...
+0000a730: 0a20 2020 2064 6566 2067 6574 7072 6f70  .    def getprop
+0000a740: 696e 6465 7828 7365 6c66 2c20 6e61 6d65  index(self, name
+0000a750: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+0000a760: 2220 5265 7475 726e 2074 6865 2069 6e64  " Return the ind
+0000a770: 6578 2063 6f72 7265 7370 6f6e 6469 6e67  ex corresponding
+0000a780: 2074 6f20 6120 6365 7274 6169 6e20 7072   to a certain pr
+0000a790: 6f70 206e 616d 650d 0a20 2020 2020 2020  op name..       
+0000a7a0: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+0000a7b0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0000a7c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0000a7d0: 2020 206e 616d 653a 2073 7472 0d0a 2020     name: str..  
+0000a7e0: 2020 2020 2020 2020 2020 6e61 6d65 206f            name o
+0000a7f0: 6620 7468 6520 7072 6f70 6572 7479 2074  f the property t
+0000a800: 6f20 7265 7472 6965 7665 0d0a 0d0a 2020  o retrieve....  
+0000a810: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0000a820: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0000a830: 2020 2020 2020 2020 696e 740d 0a20 2020          int..   
+0000a840: 2020 2020 2020 2020 2069 6e64 6578 206f           index o
+0000a850: 6620 7468 6520 7072 6f70 6572 7479 0d0a  f the property..
+0000a860: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0000a870: 2020 2020 2020 2069 6e74 6572 6573 743d         interest=
+0000a880: 4e6f 6e65 0d0a 2020 2020 2020 2020 666f  None..        fo
+0000a890: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+0000a8a0: 2873 656c 662e 6c69 7374 5f70 726f 7073  (self.list_props
+0000a8b0: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+0000a8c0: 2069 6620 7365 6c66 2e6c 6973 745f 7072   if self.list_pr
+0000a8d0: 6f70 735b 695d 2e6e 616d 6520 3d3d 206e  ops[i].name == n
+0000a8e0: 616d 653a 0d0a 2020 2020 2020 2020 2020  ame:..          
+0000a8f0: 2020 2020 2020 696e 7465 7265 7374 3d69        interest=i
+0000a900: 0d0a 2020 2020 2020 2020 6966 2069 6e74  ..        if int
+0000a910: 6572 6573 7420 6973 204e 6f6e 653a 0d0a  erest is None:..
+0000a920: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000a930: 6520 5661 6c75 6545 7272 6f72 2827 7468  e ValueError('th
+0000a940: 6520 7072 6f70 7269 6574 7920 272b 6e61  e propriety '+na
+0000a950: 6d65 2b27 2077 6173 206e 6f74 2066 6f75  me+' was not fou
+0000a960: 6e64 2729 0d0a 2020 2020 2020 2020 7265  nd')..        re
+0000a970: 7475 726e 2069 6e74 6572 6573 740d 0a0d  turn interest...
+0000a980: 0a20 2020 2064 6566 2067 6574 5f70 726f  .    def get_pro
+0000a990: 7028 7365 6c66 2c20 6e61 6d65 2c20 6975  p(self, name, iu
+0000a9a0: 3d4e 6f6e 652c 2069 6661 3d4e 6f6e 652c  =None, ifa=None,
+0000a9b0: 2069 703d 4e6f 6e65 2c20 616c 6c5f 6461   ip=None, all_da
+0000a9c0: 7461 3d54 7275 6529 3a0d 0a0d 0a20 2020  ta=True):....   
+0000a9d0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0000a9e0: 2020 5265 7475 726e 2061 206e 756d 7079    Return a numpy
+0000a9f0: 2061 7272 6179 206f 6620 3120 6f72 2061   array of 1 or a
+0000aa00: 6c6c 2066 6163 6965 7320 7265 616c 697a  ll facies realiz
+0000aa10: 6174 696f 6e28 7329 2e0d 0a0d 0a20 2020  ation(s).....   
+0000aa20: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0000aa30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000aa40: 2d2d 2d0d 0a20 2020 2020 2020 2069 753a  ---..        iu:
+0000aa50: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+0000aa60: 2075 6e69 7420 696e 6465 780d 0a20 2020   unit index..   
+0000aa70: 2020 2020 2069 6661 3a69 6e74 0d0a 2020       ifa:int..  
+0000aa80: 2020 2020 2020 2020 2020 6661 6369 6573            facies
+0000aa90: 2069 6e64 6578 0d0a 2020 2020 2020 2020   index..        
+0000aaa0: 6970 3a69 6e74 0d0a 2020 2020 2020 2020  ip:int..        
+0000aab0: 2020 2020 7072 6f70 6572 7479 2069 6e64      property ind
+0000aac0: 6578 0d0a 2020 2020 2020 2020 616c 6c5f  ex..        all_
+0000aad0: 6461 7461 3a62 6f6f 6c0d 0a20 2020 2020  data:bool..     
+0000aae0: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
+0000aaf0: 6c20 7468 6520 756e 6974 7320 7369 6d75  l the units simu
+0000ab00: 6c61 7469 6f6e 730d 0a0d 0a20 2020 2020  lations....     
+0000ab10: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0000ab20: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0000ab30: 2020 2020 206e 756d 7079 2061 7272 6179       numpy array
+0000ab40: 0d0a 2020 2020 2020 2020 2020 2020 3120  ..            1 
+0000ab50: 6f72 2061 6c6c 2066 6163 6965 7320 7265  or all facies re
+0000ab60: 616c 697a 6174 696f 6e28 7329 0d0a 2020  alization(s)..  
+0000ab70: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+0000ab80: 2020 2020 2069 6620 7365 6c66 2e77 7269       if self.wri
+0000ab90: 7465 5f72 6573 756c 7473 3a0d 0a20 2020  te_results:..   
+0000aba0: 2020 2020 2020 2020 2069 6620 2270 726f           if "pro
+0000abb0: 2220 6e6f 7420 696e 205b 692e 7370 6c69  " not in [i.spli
+0000abc0: 7428 222e 2229 5b2d 315d 2066 6f72 2069  t(".")[-1] for i
+0000abd0: 2069 6e20 6f73 2e6c 6973 7464 6972 2873   in os.listdir(s
+0000abe0: 656c 662e 7773 295d 3a0d 0a20 2020 2020  elf.ws)]:..     
+0000abf0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000ac00: 2056 616c 7565 4572 726f 7228 2250 726f   ValueError("Pro
+0000ac10: 7065 7274 6965 7320 6861 7665 206e 6f74  perties have not
+0000ac20: 2062 6565 6e20 636f 6d70 7574 6564 2079   been computed y
+0000ac30: 6574 2229 0d0a 0d0a 2020 2020 2020 2020  et")....        
+0000ac40: 6c3d 5b69 2e6e 616d 6520 666f 7220 6920  l=[i.name for i 
+0000ac50: 696e 2073 656c 662e 6c69 7374 5f70 726f  in self.list_pro
+0000ac60: 7073 5d0d 0a20 2020 2020 2020 2069 6620  ps]..        if 
+0000ac70: 6e61 6d65 206e 6f74 2069 6e20 6c3a 0d0a  name not in l:..
+0000ac80: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ac90: 6520 5661 6c75 6545 7272 6f72 2827 5468  e ValueError('Th
+0000aca0: 6520 7072 6f70 7269 6574 7920 2227 2b6e  e propriety "'+n
+0000acb0: 616d 652b 2722 2220 7761 7320 6e6f 7420  ame+'"" was not 
+0000acc0: 666f 756e 6420 5c6e 2061 7661 696c 6162  found \n availab
+0000acd0: 6c65 2050 726f 7065 7274 7920 6e61 6d65  le Property name
+0000ace0: 7320 6172 653a 207b 7d27 2e66 6f72 6d61  s are: {}'.forma
+0000acf0: 7428 6c29 290d 0a0d 0a20 2020 2020 2020  t(l))....       
+0000ad00: 206e 7265 616c 5f70 726f 703d 7365 6c66   nreal_prop=self
+0000ad10: 2e6e 7265 616c 5f70 726f 700d 0a20 2020  .nreal_prop..   
+0000ad20: 2020 2020 206e 7265 616c 5f66 613d 7365       nreal_fa=se
+0000ad30: 6c66 2e6e 7265 616c 5f66 610d 0a20 2020  lf.nreal_fa..   
+0000ad40: 2020 2020 206e 7265 616c 5f75 3d73 656c       nreal_u=sel
+0000ad50: 662e 6e72 6561 6c5f 756e 6974 730d 0a20  f.nreal_units.. 
+0000ad60: 2020 2020 2020 206e 783d 7365 6c66 2e67         nx=self.g
+0000ad70: 6574 5f6e 7828 290d 0a20 2020 2020 2020  et_nx()..       
+0000ad80: 206e 793d 7365 6c66 2e67 6574 5f6e 7928   ny=self.get_ny(
+0000ad90: 290d 0a20 2020 2020 2020 206e 7a3d 7365  )..        nz=se
+0000ada0: 6c66 2e67 6574 5f6e 7a28 290d 0a0d 0a20  lf.get_nz().... 
+0000adb0: 2020 2020 2020 2069 6620 616c 6c5f 6461         if all_da
+0000adc0: 7461 3a0d 0a20 2020 2020 2020 2020 2020  ta:..           
+0000add0: 2070 726f 703d 6e70 2e7a 6572 6f73 285b   prop=np.zeros([
+0000ade0: 6e72 6561 6c5f 752c 206e 7265 616c 5f66  nreal_u, nreal_f
+0000adf0: 612c 206e 7265 616c 5f70 726f 702c 206e  a, nreal_prop, n
+0000ae00: 7a2c 206e 792c 206e 785d 2c20 6474 7970  z, ny, nx], dtyp
+0000ae10: 653d 6e70 2e66 6c6f 6174 3332 290d 0a0d  e=np.float32)...
+0000ae20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000ae30: 7365 6c66 2e77 7269 7465 5f72 6573 756c  self.write_resul
+0000ae40: 7473 3a0d 0a20 2020 2020 2020 2020 2020  ts:..           
+0000ae50: 2020 2020 2023 2067 6574 2061 6c6c 2072       # get all r
+0000ae60: 6561 6c0d 0a20 2020 2020 2020 2020 2020  eal..           
+0000ae70: 2020 2020 2066 6f72 2069 7520 696e 2072       for iu in r
+0000ae80: 616e 6765 286e 7265 616c 5f75 293a 0d0a  ange(nreal_u):..
+0000ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aea0: 2020 2020 666f 7220 6966 6120 696e 2072      for ifa in r
+0000aeb0: 616e 6765 286e 7265 616c 5f66 6129 3a0d  ange(nreal_fa):.
+0000aec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000aed0: 2020 2020 2020 2020 2066 6f72 2069 7020           for ip 
+0000aee0: 696e 2072 616e 6765 286e 7265 616c 5f70  in range(nreal_p
+0000aef0: 726f 7029 3a0d 0a20 2020 2020 2020 2020  rop):..         
 0000af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af10: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0000af20: 705b 6975 2c20 6966 612c 2069 705d 3d70  p[iu, ifa, ip]=p
-0000af30: 6963 6b6c 652e 6c6f 6164 2866 290d 0a20  ickle.load(f).. 
-0000af40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000af50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000af60: 2020 7072 6f70 3d73 656c 662e 4765 6f6c    prop=self.Geol
-0000af70: 2e70 726f 705f 7661 6c75 6573 5b6e 616d  .prop_values[nam
-0000af80: 655d 0d0a 0d0a 2020 2020 2020 2020 656c  e]....        el
-0000af90: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0000afa0: 2069 6620 7365 6c66 2e77 7269 7465 5f72   if self.write_r
-0000afb0: 6573 756c 7473 3a0d 0a20 2020 2020 2020  esults:..       
-0000afc0: 2020 2020 2020 2020 2066 6e61 6d65 3d73           fname=s
-0000afd0: 656c 662e 6e61 6d65 2b22 7b7d 5f7b 7d5f  elf.name+"{}_{}_
-0000afe0: 7b7d 5f7b 7d2e 7072 6f22 2e66 6f72 6d61  {}_{}.pro".forma
-0000aff0: 7428 6e61 6d65 2c20 6975 2c20 6966 612c  t(name, iu, ifa,
-0000b000: 2069 7029 0d0a 2020 2020 2020 2020 2020   ip)..          
-0000b010: 2020 2020 2020 6670 6174 683d 6f73 2e70        fpath=os.p
-0000b020: 6174 682e 6a6f 696e 2873 656c 662e 7773  ath.join(self.ws
-0000b030: 2c20 666e 616d 6529 0d0a 2020 2020 2020  , fname)..      
-0000b040: 2020 2020 2020 2020 2020 7769 7468 206f            with o
-0000b050: 7065 6e28 6670 6174 682c 2022 7262 2229  pen(fpath, "rb")
-0000b060: 2061 7320 663a 0d0a 2020 2020 2020 2020   as f:..        
-0000b070: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
-0000b080: 3d70 6963 6b6c 652e 6c6f 6164 2866 290d  =pickle.load(f).
-0000b090: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0000b0a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0000b0b0: 2020 2020 7072 6f70 3d73 656c 662e 4765      prop=self.Ge
-0000b0c0: 6f6c 2e70 726f 705f 7661 6c75 6573 5b6e  ol.prop_values[n
-0000b0d0: 616d 655d 5b69 752c 2069 6661 2c20 6970  ame][iu, ifa, ip
-0000b0e0: 5d0d 0a0d 0a20 2020 2020 2020 2072 6574  ]....        ret
-0000b0f0: 7572 6e20 7072 6f70 0d0a 0d0a 2020 2020  urn prop....    
-0000b100: 6465 6620 6765 745f 626f 756e 6473 2873  def get_bounds(s
-0000b110: 656c 6629 3a0d 0a0d 0a20 2020 2020 2020  elf):....       
-0000b120: 2022 2222 5265 7475 726e 2062 6f75 6e64   """Return bound
-0000b130: 7320 6f66 2074 6865 2073 696d 756c 6174  s of the simulat
-0000b140: 696f 6e20 646f 6d61 696e 200d 0a20 2020  ion domain ..   
-0000b150: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
-0000b160: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0000b170: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000b180: 2074 7570 6c65 0d0a 2020 2020 2020 2020   tuple..        
-0000b190: 2020 2020 2878 6d69 6e2c 2078 6d61 782c      (xmin, xmax,
-0000b1a0: 2079 6d69 6e2c 2079 6d61 782c 207a 6d69   ymin, ymax, zmi
-0000b1b0: 6e2c 207a 6d61 7829 0d0a 2020 2020 2020  n, zmax)..      
-0000b1c0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-0000b1d0: 2062 6f75 6e64 733d 5b73 656c 662e 6765   bounds=[self.ge
-0000b1e0: 745f 6f78 2829 2c20 7365 6c66 2e67 6574  t_ox(), self.get
-0000b1f0: 5f78 6728 295b 2d31 5d2c 2073 656c 662e  _xg()[-1], self.
-0000b200: 6765 745f 6f79 2829 2c20 7365 6c66 2e67  get_oy(), self.g
-0000b210: 6574 5f79 6728 295b 2d31 5d2c 2073 656c  et_yg()[-1], sel
-0000b220: 662e 6765 745f 6f7a 2829 2c20 7365 6c66  f.get_oz(), self
-0000b230: 2e67 6574 5f7a 6728 295b 2d31 5d5d 0d0a  .get_zg()[-1]]..
-0000b240: 2020 2020 2020 2020 7265 7475 726e 2062          return b
-0000b250: 6f75 6e64 730d 0a0d 0a20 2020 2064 6566  ounds....    def
-0000b260: 2063 6865 636b 5f75 6e69 7473 5f49 4428   check_units_ID(
-0000b270: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
-0000b280: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0000b290: 2020 2020 2020 2063 6865 636b 2074 6865         check the
-0000b2a0: 2049 4473 206f 6620 756e 6974 7320 696e   IDs of units in
-0000b2b0: 206f 7264 6572 2074 6f20 6265 2073 7572   order to be sur
-0000b2c0: 6520 7468 6174 2074 6865 7920 6172 6520  e that they are 
-0000b2d0: 6469 6666 6572 656e 740d 0a0d 0a20 2020  different....   
-0000b2e0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-0000b2f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0000b300: 2020 2020 2020 2069 6e74 0d0a 2020 2020         int..    
-0000b310: 2020 2020 2020 2020 3120 6966 2061 6c6c          1 if all
-0000b320: 2069 7320 6f6b 0d0a 2020 2020 2020 2020   is ok..        
-0000b330: 2222 220d 0a0d 0a20 2020 2020 2020 206c  """....        l
-0000b340: 3d5b 5d0d 0a20 2020 2020 2020 2066 6f72  =[]..        for
-0000b350: 2069 2069 6e20 7365 6c66 2e67 6574 5f61   i in self.get_a
-0000b360: 6c6c 5f75 6e69 7473 2872 6563 6f6d 7075  ll_units(recompu
-0000b370: 7465 3d54 7275 6529 3a0d 0a20 2020 2020  te=True):..     
-0000b380: 2020 2020 2020 2069 6620 692e 4944 206e         if i.ID n
-0000b390: 6f74 2069 6e20 6c3a 0d0a 2020 2020 2020  ot in l:..      
-0000b3a0: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
-0000b3b0: 6e64 2869 2e49 4429 0d0a 2020 2020 2020  nd(i.ID)..      
-0000b3c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000b3d0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0000b3e0: 6e74 2822 536f 7272 792c 2075 6e69 7420  nt("Sorry, unit 
-0000b3f0: 7b7d 2068 6173 2074 6865 2073 616d 6520  {} has the same 
-0000b400: 4944 207b 7d20 7468 616e 2061 6e6f 7468  ID {} than anoth
-0000b410: 6572 2075 6e69 742e 2049 4420 6d75 7374  er unit. ID must
-0000b420: 2062 6520 6469 6666 6572 656e 7473 2066   be differents f
-0000b430: 6f72 2065 6163 6820 756e 6974 7322 2e66  or each units".f
-0000b440: 6f72 6d61 7428 692e 6e61 6d65 2c20 692e  ormat(i.name, i.
-0000b450: 4944 2929 0d0a 2020 2020 2020 2020 2020  ID))..          
-0000b460: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-0000b470: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-0000b480: 6e20 310d 0a0d 0a20 2020 2064 6566 2063  n 1....    def c
-0000b490: 6865 636b 5f70 696c 6573 5f6e 616d 6528  heck_piles_name(
-0000b4a0: 7365 6c66 293a 0d0a 0d0a 2020 2020 2020  self):....      
-0000b4b0: 2020 2222 220d 0a20 2020 2020 2020 2063    """..        c
-0000b4c0: 6865 636b 2074 6865 206e 616d 6573 206f  heck the names o
-0000b4d0: 6620 7069 6c65 7320 696e 206f 7264 6572  f piles in order
-0000b4e0: 2074 6f20 6265 2073 7572 6520 7468 6174   to be sure that
-0000b4f0: 2074 6865 7920 6172 6520 6469 6666 6572   they are differ
-0000b500: 656e 740d 0a0d 0a20 2020 2020 2020 2052  ent....        R
-0000b510: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0000b520: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000b530: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
-0000b540: 2020 3120 6966 2061 6c6c 2069 7320 6f6b    1 if all is ok
-0000b550: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-0000b560: 0a20 2020 2020 2020 206c 5f6e 616d 6573  .        l_names
-0000b570: 3d5b 5d0d 0a0d 0a20 2020 2020 2020 206c  =[]....        l
-0000b580: 3d73 656c 662e 6765 745f 7069 6c65 7328  =self.get_piles(
-0000b590: 290d 0a20 2020 2020 2020 2066 6f72 2070  )..        for p
-0000b5a0: 2069 6e20 6c3a 0d0a 2020 2020 2020 2020   in l:..        
-0000b5b0: 2020 2020 6966 2070 2e6e 616d 6520 6e6f      if p.name no
-0000b5c0: 7420 696e 206c 5f6e 616d 6573 3a0d 0a20  t in l_names:.. 
-0000b5d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0000b5e0: 5f6e 616d 6573 2e61 7070 656e 6428 702e  _names.append(p.
-0000b5f0: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
-0000b600: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0000b610: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0000b620: 2250 696c 6520 6e61 6d65 2027 7b7d 2720  "Pile name '{}' 
-0000b630: 6973 2061 7474 7269 6275 7465 6420 746f  is attributed to
-0000b640: 206d 6f72 6520 7468 616e 206f 6e65 2070   more than one p
-0000b650: 696c 652c 2076 6572 626f 7465 6e20 2122  ile, verboten !"
-0000b660: 2e66 6f72 6d61 7428 702e 6e61 6d65 2929  .format(p.name))
-0000b670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000b680: 2020 7265 7475 726e 2030 0d0a 0d0a 2020    return 0....  
-0000b690: 2020 2020 2020 7265 7475 726e 2031 0d0a        return 1..
-0000b6a0: 0d0a 2020 2020 6465 6620 7365 745f 5069  ..    def set_Pi
-0000b6b0: 6c65 5f6d 6173 7465 7228 7365 6c66 2c20  le_master(self, 
-0000b6c0: 5069 6c65 5f6d 6173 7465 7229 3a0d 0a0d  Pile_master):...
-0000b6d0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0000b6e0: 2020 2020 2020 4465 6669 6e65 2061 2070        Define a p
-0000b6f0: 696c 6520 6f62 6a65 6374 2061 7320 7468  ile object as th
-0000b700: 6520 6d61 696e 2070 696c 6520 6f66 2074  e main pile of t
-0000b710: 6865 2070 726f 6a65 6374 0d0a 0d0a 2020  he project....  
-0000b720: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000b730: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000b740: 2d2d 2d2d 0d0a 2020 2020 2020 2020 5069  ----..        Pi
-0000b750: 6c65 5f6d 6173 7465 723a 203a 636c 6173  le_master: :clas
-0000b760: 733a 6050 696c 6560 206f 626a 6563 740d  s:`Pile` object.
-0000b770: 0a20 2020 2020 2020 2020 2020 2070 696c  .            pil
-0000b780: 6520 6f62 6a65 6374 2074 6f20 7365 7420  e object to set 
-0000b790: 6173 2074 6865 206d 6169 6e20 7069 6c65  as the main pile
-0000b7a0: 206f 6620 7468 6520 7072 6f6a 6563 740d   of the project.
-0000b7b0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0000b7c0: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0000b7d0: 2069 7369 6e73 7461 6e63 6528 5069 6c65   isinstance(Pile
-0000b7e0: 5f6d 6173 7465 722c 2050 696c 6529 2c20  _master, Pile), 
-0000b7f0: 2250 696c 6520 6d61 7374 6572 2069 7320  "Pile master is 
-0000b800: 6e6f 7420 616e 2041 7263 6850 7920 5069  not an ArchPy Pi
-0000b810: 6c65 206f 626a 6563 7422 0d0a 2020 2020  le object"..    
-0000b820: 2020 2020 7365 6c66 2e50 696c 655f 6d61      self.Pile_ma
-0000b830: 7374 6572 3d50 696c 655f 6d61 7374 6572  ster=Pile_master
-0000b840: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000b850: 662e 6368 6563 6b5f 7069 6c65 735f 6e61  f.check_piles_na
-0000b860: 6d65 2829 3a0d 0a20 2020 2020 2020 2020  me():..         
-0000b870: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0000b880: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0000b890: 2020 2020 2070 7269 6e74 2822 5069 6c65       print("Pile
-0000b8a0: 2073 6574 7320 6173 2050 696c 6520 6d61   sets as Pile ma
-0000b8b0: 7374 6572 2229 0d0a 2020 2020 2020 2020  ster")..        
-0000b8c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000b8d0: 2020 2073 656c 662e 5069 6c65 5f6d 6173     self.Pile_mas
-0000b8e0: 7465 723d 4e6f 6e65 0d0a 2020 2020 2020  ter=None..      
-0000b8f0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-0000b900: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-0000b910: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
-0000b920: 696c 6520 6e6f 7420 7365 7473 2229 0d0a  ile not sets")..
-0000b930: 0d0a 2020 2020 6465 6620 6365 6c6c 746f  ..    def cellto
-0000b940: 696e 6465 7828 7365 6c66 2c63 656c 6c5f  index(self,cell_
-0000b950: 782c 6365 6c6c 5f79 2c63 656c 6c5f 7a29  x,cell_y,cell_z)
-0000b960: 3a0d 0a0d 0a20 2020 2020 2020 2027 2727  :....        '''
-0000b970: 6365 6c6c 2069 6e64 6578 2074 6f20 6365  cell index to ce
-0000b980: 6c6c 2070 6f73 6974 696f 6e0d 0a20 2020  ll position..   
-0000b990: 2020 2020 200d 0a20 2020 2020 2020 2050       ..        P
-0000b9a0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0000b9b0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000b9c0: 2020 2020 2020 2063 656c 6c5f 7820 3a20         cell_x : 
-0000b9d0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-0000b9e0: 2063 656c 6c20 696e 6465 7820 696e 2078   cell index in x
-0000b9f0: 2064 6972 6563 7469 6f6e 0d0a 2020 2020   direction..    
-0000ba00: 2020 2020 6365 6c6c 5f79 203a 2069 6e74      cell_y : int
-0000ba10: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
-0000ba20: 6c6c 2069 6e64 6578 2069 6e20 7920 6469  ll index in y di
-0000ba30: 7265 6374 696f 6e0d 0a20 2020 2020 2020  rection..       
-0000ba40: 2063 656c 6c5f 7a20 3a20 696e 740d 0a20   cell_z : int.. 
-0000ba50: 2020 2020 2020 2020 2020 2063 656c 6c20             cell 
-0000ba60: 696e 6465 7820 696e 207a 2064 6972 6563  index in z direc
-0000ba70: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-0000ba80: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
-0000ba90: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-0000baa0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7475  ----..        tu
-0000bab0: 706c 650d 0a20 2020 2020 2020 2020 2020  ple..           
-0000bac0: 2028 782c 792c 7a29 2063 656c 6c20 706f   (x,y,z) cell po
-0000bad0: 7369 7469 6f6e 0d0a 2020 2020 2020 2020  sition..        
-0000bae0: 2727 270d 0a0d 0a20 2020 2020 2020 2078  '''....        x
-0000baf0: 3d73 656c 662e 6765 745f 7378 2829 2a20  =self.get_sx()* 
-0000bb00: 6365 6c6c 5f78 202b 206d 696e 2873 656c  cell_x + min(sel
-0000bb10: 662e 6765 745f 7867 6328 2929 0d0a 2020  f.get_xgc())..  
-0000bb20: 2020 2020 2020 793d 7365 6c66 2e67 6574        y=self.get
-0000bb30: 5f73 7928 292a 2063 656c 6c5f 7920 2b20  _sy()* cell_y + 
-0000bb40: 6d69 6e28 7365 6c66 2e67 6574 5f79 6763  min(self.get_ygc
-0000bb50: 2829 290d 0a20 2020 2020 2020 207a 3d73  ())..        z=s
-0000bb60: 656c 662e 6765 745f 737a 2829 2a20 6365  elf.get_sz()* ce
-0000bb70: 6c6c 5f7a 202b 206d 696e 2873 656c 662e  ll_z + min(self.
-0000bb80: 6765 745f 7a67 6328 2929 0d0a 2020 2020  get_zgc())..    
-0000bb90: 2020 2020 7265 7475 726e 2078 2c79 2c7a      return x,y,z
-0000bba0: 0d0a 0d0a 2020 2020 6465 6620 7265 7072  ....    def repr
-0000bbb0: 6f63 6573 7328 7365 6c66 293a 0d0a 0d0a  ocess(self):....
-0000bbc0: 2020 2020 2020 2020 2222 2252 6570 726f          """Repro
-0000bbd0: 6365 7373 2074 6865 2062 6f72 6568 6f6c  cess the borehol
-0000bbe0: 6573 2061 6e64 2065 7261 7365 2074 6865  es and erase the
-0000bbf0: 2070 7265 7669 6f75 7320 6861 7264 2064   previous hard d
-0000bc00: 6174 6122 2222 0d0a 0d0a 2020 2020 2020  ata"""....      
-0000bc10: 2020 7365 6c66 2e62 6873 5f70 726f 6365    self.bhs_proce
-0000bc20: 7373 6564 3d30 0d0a 2020 2020 2020 2020  ssed=0..        
-0000bc30: 7365 6c66 2e65 7261 7365 5f68 6428 290d  self.erase_hd().
-0000bc40: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-0000bc50: 6f63 6573 735f 6268 7328 290d 0a20 2020  ocess_bhs()..   
-0000bc60: 2020 2020 2073 656c 662e 7365 6564 3d20       self.seed= 
-0000bc70: 696e 7428 7365 6c66 2e73 6565 6420 2b20  int(self.seed + 
-0000bc80: 3165 3629 0d0a 0d0a 2020 2020 6465 6620  1e6)....    def 
-0000bc90: 7265 7361 6d70 6c65 3267 7269 6428 7365  resample2grid(se
-0000bca0: 6c66 2c20 7261 7374 6572 5f70 6174 682c  lf, raster_path,
-0000bcb0: 2062 616e 643d 4e6f 6e65 2c20 7273 706c   band=None, rspl
-0000bcc0: 5f6d 6574 686f 643d 226e 6561 7265 7374  _method="nearest
-0000bcd0: 2229 3a0d 0a0d 0a20 2020 2020 2020 2022  "):....        "
-0000bce0: 2222 0d0a 2020 2020 2020 2020 5265 7361  ""..        Resa
-0000bcf0: 6d70 6c65 2061 2072 6173 7465 7220 746f  mple a raster to
-0000bd00: 2074 6865 2073 697a 6520 6f66 2074 6865   the size of the
-0000bd10: 2073 696d 756c 6174 696f 6e20 6772 6964   simulation grid
-0000bd20: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-0000bd30: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0000bd40: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0000bd50: 2020 2020 2072 6173 7465 725f 7061 7468       raster_path
-0000bd60: 203a 2073 7472 0d0a 2020 2020 2020 2020   : str..        
-0000bd70: 2020 2020 7061 7468 2074 6f20 7468 6520      path to the 
-0000bd80: 7261 7374 6572 2066 696c 650d 0a20 2020  raster file..   
-0000bd90: 2020 2020 2062 616e 6420 3a20 696e 742c       band : int,
-0000bda0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0000bdb0: 2020 2020 2020 2072 6173 7465 7220 6261         raster ba
-0000bdc0: 6e64 2074 6f20 7573 652c 2069 6620 4e6f  nd to use, if No
-0000bdd0: 6e65 2030 2069 7320 7573 6564 2e20 5468  ne 0 is used. Th
-0000bde0: 6520 6465 6661 756c 7420 6973 204e 6f6e  e default is Non
-0000bdf0: 652e 0d0a 2020 2020 2020 2020 7273 706c  e...        rspl
-0000be00: 5f6d 6574 686f 6420 3a20 7374 722c 206f  _method : str, o
-0000be10: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-0000be20: 2020 2020 2072 6573 616d 706c 696e 6720       resampling 
-0000be30: 6d65 7468 6f64 2074 6f20 7573 652e 2061  method to use. a
-0000be40: 7661 696c 6162 6c65 7320 6172 6520 3a20  vailables are : 
-0000be50: 6e65 6172 6573 742c 206c 696e 6561 722c  nearest, linear,
-0000be60: 2063 7562 6963 2e0d 0a20 2020 2020 2020   cubic...       
-0000be70: 2020 2020 2054 6865 2064 6566 6175 6c74       The default
-0000be80: 2069 7320 226e 6561 7265 7374 222e 0d0a   is "nearest"...
-0000be90: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000bea0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0000beb0: 2d2d 0d0a 2020 2020 2020 2020 3244 2061  --..        2D a
-0000bec0: 7272 6179 206f 6620 7369 7a65 2028 7365  rray of size (se
-0000bed0: 6c66 2e6e 792c 2073 656c 662e 6e78 290d  lf.ny, self.nx).
-0000bee0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-0000bef0: 2020 2020 2020 2020 2369 6d70 6f72 7420          #import 
-0000bf00: 7261 7374 6572 696f 0d0a 2020 2020 2020  rasterio..      
-0000bf10: 2020 696d 706f 7274 2072 6173 7465 7269    import rasteri
-0000bf20: 6f0d 0a0d 0a20 2020 2020 2020 2023 6f70  o....        #op
-0000bf30: 656e 2072 6173 7465 7220 616e 6420 6578  en raster and ex
-0000bf40: 7472 6163 7420 6365 6c6c 2063 656e 7465  tract cell cente
-0000bf50: 7273 0d0a 2020 2020 2020 2020 4445 4d3d  rs..        DEM=
-0000bf60: 7261 7374 6572 696f 2e6f 7065 6e28 7261  rasterio.open(ra
-0000bf70: 7374 6572 5f70 6174 6829 0d0a 2020 2020  ster_path)..    
-0000bf80: 2020 2020 7830 2c20 7930 2c20 7831 2c20      x0, y0, x1, 
-0000bf90: 7931 3d44 454d 2e62 6f75 6e64 730d 0a20  y1=DEM.bounds.. 
-0000bfa0: 2020 2020 2020 2072 786c 656e 3d44 454d         rxlen=DEM
-0000bfb0: 2e72 6561 6428 292e 7368 6170 655b 325d  .read().shape[2]
-0000bfc0: 0d0a 2020 2020 2020 2020 7279 6c65 6e3d  ..        rylen=
-0000bfd0: 4445 4d2e 7265 6164 2829 2e73 6861 7065  DEM.read().shape
-0000bfe0: 5b31 5d0d 0a20 2020 2020 2020 2078 3d6e  [1]..        x=n
-0000bff0: 702e 6c69 6e73 7061 6365 2878 302c 2078  p.linspace(x0, x
-0000c000: 312c 2072 786c 656e 290d 0a20 2020 2020  1, rxlen)..     
-0000c010: 2020 2079 3d6e 702e 6c69 6e73 7061 6365     y=np.linspace
-0000c020: 2879 312c 2079 302c 2072 796c 656e 290d  (y1, y0, rylen).
-0000c030: 0a20 2020 2020 2020 2072 7863 2c20 7279  .        rxc, ry
-0000c040: 633d 6e70 2e6d 6573 6867 7269 6428 782c  c=np.meshgrid(x,
-0000c050: 2079 290d 0a0d 0a20 2020 2020 2020 2023   y)....        #
-0000c060: 7461 6b65 2067 7269 6420 6365 6c6c 2063  take grid cell c
-0000c070: 656e 7465 7273 0d0a 2020 2020 2020 2020  enters..        
-0000c080: 7863 3d73 656c 662e 7863 656c 6c63 656e  xc=self.xcellcen
-0000c090: 7465 7273 0d0a 2020 2020 2020 2020 7963  ters..        yc
-0000c0a0: 3d73 656c 662e 7963 656c 6c63 656e 7465  =self.ycellcente
-0000c0b0: 7273 0d0a 0d0a 2020 2020 2020 2020 6966  rs....        if
-0000c0c0: 2062 616e 6420 6973 204e 6f6e 653a 0d0a   band is None:..
-0000c0d0: 2020 2020 2020 2020 2020 2020 6962 203d              ib =
-0000c0e0: 2030 0d0a 2020 2020 2020 2020 656c 7365   0..        else
-0000c0f0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0000c100: 6220 3d20 6261 6e64 0d0a 2020 2020 2020  b = band..      
-0000c110: 2020 7265 7475 726e 2072 6573 616d 706c    return resampl
-0000c120: 655f 746f 5f67 7269 6428 7863 2c20 7963  e_to_grid(xc, yc
-0000c130: 2c20 7278 632c 2072 7963 2c20 4445 4d2e  , rxc, ryc, DEM.
-0000c140: 7265 6164 2829 5b69 625d 2c20 6d65 7468  read()[ib], meth
-0000c150: 6f64 3d72 7370 6c5f 6d65 7468 6f64 2920  od=rspl_method) 
-0000c160: 2023 2072 6573 616d 706c 696e 670d 0a0d   # resampling...
-0000c170: 0a20 2020 2064 6566 2061 6464 5f67 7269  .    def add_gri
-0000c180: 6428 7365 6c66 2c20 6469 6d65 6e73 696f  d(self, dimensio
-0000c190: 6e73 2c20 7370 6163 696e 672c 206f 7269  ns, spacing, ori
-0000c1a0: 6769 6e2c 2074 6f70 3d4e 6f6e 652c 2062  gin, top=None, b
-0000c1b0: 6f74 3d4e 6f6e 652c 2072 7370 6c5f 6d65  ot=None, rspl_me
-0000c1c0: 7468 6f64 3d22 6e65 6172 6573 7422 2c20  thod="nearest", 
-0000c1d0: 706f 6c79 676f 6e3d 4e6f 6e65 2c20 6d61  polygon=None, ma
-0000c1e0: 736b 3d4e 6f6e 6529 3a0d 0a0d 0a20 2020  sk=None):....   
-0000c1f0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0000c200: 2020 4d65 7468 6f64 2074 6f20 6164 642f    Method to add/
-0000c210: 6368 616e 6765 2073 696d 756c 6174 696f  change simulatio
-0000c220: 6e20 6772 6964 2c20 7265 6775 6c61 7220  n grid, regular 
-0000c230: 6772 6964 2e0d 0a0d 0a20 2020 2020 2020  grid.....       
-0000c240: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0000c250: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0000c260: 0a20 2020 2020 2020 2064 696d 656e 7369  .        dimensi
-0000c270: 6f6e 733a 2073 6571 7565 6e63 6520 6f66  ons: sequence of
-0000c280: 2073 697a 6520 332c 0d0a 2020 2020 2020   size 3,..      
-0000c290: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000c2a0: 756d 6265 7220 6f66 2063 656c 6c73 2069  umber of cells i
-0000c2b0: 6e20 782c 2079 2061 6e64 2064 6972 6563  n x, y and direc
-0000c2c0: 7469 6f6e 2028 6e78 2c20 6e79 2c20 6e7a  tion (nx, ny, nz
-0000c2d0: 290d 0a20 2020 2020 2020 2073 7061 6369  )..        spaci
-0000c2e0: 6e67 3a20 7365 7175 656e 6365 206f 6620  ng: sequence of 
-0000c2f0: 7369 7a65 2033 2c0d 0a20 2020 2020 2020  size 3,..       
-0000c300: 2020 2020 2020 2020 2020 7370 6163 696e            spacin
-0000c310: 6720 6f66 2074 6865 2063 656c 6c73 2069  g of the cells i
-0000c320: 6e20 782c 2079 2061 6e64 2064 6972 6563  n x, y and direc
-0000c330: 7469 6f6e 2028 7378 2c20 7379 2c20 737a  tion (sx, sy, sz
-0000c340: 290d 0a20 2020 2020 2020 206f 7269 6769  )..        origi
-0000c350: 6e3a 2073 6571 7565 6e63 6520 6f66 2073  n: sequence of s
-0000c360: 697a 6520 332c 0d0a 2020 2020 2020 2020  ize 3,..        
-0000c370: 2020 2020 2020 2020 6f72 6967 696e 206f          origin o
-0000c380: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
-0000c390: 2067 7269 6420 6f66 2074 6865 2063 656c   grid of the cel
-0000c3a0: 6c73 0d0a 2020 2020 2020 2020 2020 2020  ls..            
-0000c3b0: 2020 2020 696e 2078 2c20 7920 616e 6420      in x, y and 
-0000c3c0: 6469 7265 6374 696f 6e20 286f 782c 206f  direction (ox, o
-0000c3d0: 792c 206f 7a29 0d0a 2020 2020 2020 2020  y, oz)..        
-0000c3e0: 746f 702c 2062 6f74 3a20 3244 206e 6461  top, bot: 2D nda
-0000c3f0: 7272 6179 206f 6620 6469 6d65 6e73 696f  rray of dimensio
-0000c400: 6e73 2028 6e79 2c20 6e78 2920 6f72 2066  ns (ny, nx) or f
-0000c410: 6c6f 6174 206f 7220 7261 7374 6572 2066  loat or raster f
-0000c420: 696c 652c 0d0a 2020 2020 2020 2020 2020  ile,..          
-0000c430: 2020 2020 2020 2020 746f 7020 616e 6420          top and 
-0000c440: 626f 7474 6f6d 206f 6620 7468 6520 7369  bottom of the si
-0000c450: 6d75 6c61 7469 6f6e 2064 6f6d 6169 6e0d  mulation domain.
-0000c460: 0a20 2020 2020 2020 2072 7370 6c5f 6d65  .        rspl_me
-0000c470: 7468 6f64 3a20 7374 7269 6e67 0d0a 2020  thod: string..  
-0000c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c490: 2020 7363 6970 7920 7265 7361 6d70 6c69    scipy resampli
-0000c4a0: 6e67 206d 6574 686f 6420 286e 6561 7265  ng method (neare
-0000c4b0: 7374 2c20 6c69 6e65 6172 0d0a 2020 2020  st, linear..    
-0000c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c4d0: 616e 6420 6375 6269 6320 2d2d 3e20 6e65  and cubic --> ne
-0000c4e0: 6172 6573 7420 6973 2067 656e 6572 616c  arest is general
-0000c4f0: 6c79 2073 7566 6669 6369 656e 7429 0d0a  ly sufficient)..
-0000c500: 2020 2020 2020 2020 706f 6c79 676f 6e3a          polygon:
-0000c510: 2032 4420 6e64 6172 7261 7920 6f66 2064   2D ndarray of d
-0000c520: 696d 656e 7369 6f6e 7320 286e 792c 206e  imensions (ny, n
-0000c530: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
-0000c540: 2020 2020 626f 6f6c 6561 6e20 6172 7261      boolean arra
-0000c550: 7920 746f 2069 6e64 6963 6174 6520 7768  y to indicate wh
-0000c560: 6572 6520 7468 6520 7369 6d75 6c61 7469  ere the simulati
-0000c570: 6f6e 2069 7320 6163 7469 7665 2028 3129  on is active (1)
-0000c580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c590: 2020 6f72 2069 6e61 6374 6976 6520 2830    or inactive (0
-0000c5a0: 292e 2050 6f6c 7967 6f6e 2063 616e 2061  ). Polygon can a
-0000c5b0: 6c73 6f20 6265 2061 2053 6861 7065 6c79  lso be a Shapely
-0000c5c0: 2028 4d75 6c74 6929 202d 2070 6f6c 7967   (Multi) - polyg
-0000c5d0: 6f6e 2e0d 0a20 2020 2020 2020 206d 6173  on...        mas
-0000c5e0: 6b3a 2033 4420 6e64 6172 7261 7920 6f66  k: 3D ndarray of
-0000c5f0: 2064 696d 656e 7369 6f6e 7320 286e 7a2c   dimensions (nz,
-0000c600: 206e 792c 206e 7829 0d0a 2020 2020 2020   ny, nx)..      
-0000c610: 2020 2020 2020 2020 2020 3344 2062 6f6f            3D boo
-0000c620: 6c65 616e 2061 7272 6179 2074 6f20 696e  lean array to in
-0000c630: 6469 6361 7465 2077 6865 7265 2074 6865  dicate where the
-0000c640: 2073 696d 756c 6174 696f 6e0d 0a20 2020   simulation..   
-0000c650: 2020 2020 2020 2020 2020 2020 2069 7320               is 
-0000c660: 6163 7469 7665 2028 3129 206f 7220 696e  active (1) or in
-0000c670: 6163 7469 7665 2028 3029 2e0d 0a20 2020  active (0)...   
-0000c680: 2020 2020 2020 2020 2020 2020 2049 6620               If 
-0000c690: 6769 7665 6e2c 2074 6f70 2c20 626f 7420  given, top, bot 
-0000c6a0: 616e 6420 706f 6c79 676f 6e20 6172 6520  and polygon are 
-0000c6b0: 6967 6e6f 7265 642e 0d0a 2020 2020 2020  ignored...      
-0000c6c0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-0000c6d0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0000c6e0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0000c6f0: 7269 6e74 2822 2323 2041 6464 696e 6720  rint("## Adding 
-0000c700: 4772 6964 2023 2322 290d 0a20 2020 2020  Grid ##")..     
-0000c710: 2020 2023 2320 6365 6c6c 2063 656e 7465     ## cell cente
-0000c720: 7273 2023 230d 0a20 2020 2020 2020 2073  rs ##..        s
-0000c730: 783d 7370 6163 696e 675b 305d 0d0a 2020  x=spacing[0]..  
-0000c740: 2020 2020 2020 7379 3d73 7061 6369 6e67        sy=spacing
-0000c750: 5b31 5d0d 0a20 2020 2020 2020 2073 7a3d  [1]..        sz=
-0000c760: 7370 6163 696e 675b 325d 0d0a 0d0a 2020  spacing[2]....  
-0000c770: 2020 2020 2020 6e78 3d64 696d 656e 7369        nx=dimensi
-0000c780: 6f6e 735b 305d 0d0a 2020 2020 2020 2020  ons[0]..        
-0000c790: 6e79 3d64 696d 656e 7369 6f6e 735b 315d  ny=dimensions[1]
-0000c7a0: 0d0a 2020 2020 2020 2020 6e7a 3d64 696d  ..        nz=dim
-0000c7b0: 656e 7369 6f6e 735b 325d 0d0a 0d0a 2020  ensions[2]....  
-0000c7c0: 2020 2020 2020 6f78 3d6f 7269 6769 6e5b        ox=origin[
-0000c7d0: 305d 0d0a 2020 2020 2020 2020 6f79 3d6f  0]..        oy=o
-0000c7e0: 7269 6769 6e5b 315d 0d0a 2020 2020 2020  rigin[1]..      
-0000c7f0: 2020 6f7a 3d6f 7269 6769 6e5b 325d 0d0a    oz=origin[2]..
-0000c800: 0d0a 2020 2020 2020 2020 7867 3d6e 702e  ..        xg=np.
-0000c810: 6172 616e 6765 286f 782c 206f 782b 6e78  arange(ox, ox+nx
-0000c820: 2a73 782b 7378 2c20 7378 2c20 6474 7970  *sx+sx, sx, dtyp
-0000c830: 653d 6e70 2e66 6c6f 6174 3332 290d 0a20  e=np.float32).. 
-0000c840: 2020 2020 2020 2079 673d 6e70 2e61 7261         yg=np.ara
-0000c850: 6e67 6528 6f79 2c20 6f79 2b6e 792a 7379  nge(oy, oy+ny*sy
-0000c860: 2b73 792c 2073 792c 2064 7479 7065 3d6e  +sy, sy, dtype=n
-0000c870: 702e 666c 6f61 7433 3229 0d0a 2020 2020  p.float32)..    
-0000c880: 2020 2020 7a67 3d6e 702e 6172 616e 6765      zg=np.arange
-0000c890: 286f 7a2c 206f 7a2b 6e7a 2a73 7a2b 737a  (oz, oz+nz*sz+sz
-0000c8a0: 2c20 737a 2c20 6474 7970 653d 6e70 2e66  , sz, dtype=np.f
-0000c8b0: 6c6f 6174 3332 290d 0a0d 0a20 2020 2020  loat32)....     
-0000c8c0: 2020 2078 6763 3d78 675b 3a20 2d31 5d2b     xgc=xg[: -1]+
-0000c8d0: 7378 2f32 0d0a 2020 2020 2020 2020 7967  sx/2..        yg
-0000c8e0: 633d 7967 5b3a 202d 315d 2b73 792f 320d  c=yg[: -1]+sy/2.
-0000c8f0: 0a20 2020 2020 2020 207a 6763 3d7a 675b  .        zgc=zg[
-0000c900: 3a20 2d31 5d2b 737a 2f32 0d0a 0d0a 2020  : -1]+sz/2....  
-0000c910: 2020 2020 2020 7365 6c66 2e73 783d 7378        self.sx=sx
-0000c920: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-0000c930: 793d 7379 0d0a 2020 2020 2020 2020 7365  y=sy..        se
-0000c940: 6c66 2e73 7a3d 737a 0d0a 0d0a 2020 2020  lf.sz=sz....    
-0000c950: 2020 2020 7365 6c66 2e6e 783d 6e78 0d0a      self.nx=nx..
-0000c960: 2020 2020 2020 2020 7365 6c66 2e6e 793d          self.ny=
-0000c970: 6e79 0d0a 2020 2020 2020 2020 7365 6c66  ny..        self
-0000c980: 2e6e 7a3d 6e7a 0d0a 0d0a 2020 2020 2020  .nz=nz....      
-0000c990: 2020 7365 6c66 2e6f 783d 6f78 0d0a 2020    self.ox=ox..  
-0000c9a0: 2020 2020 2020 7365 6c66 2e6f 793d 6f79        self.oy=oy
-0000c9b0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
-0000c9c0: 7a3d 6f7a 0d0a 0d0a 2020 2020 2020 2020  z=oz....        
-0000c9d0: 7365 6c66 2e78 673d 7867 0d0a 2020 2020  self.xg=xg..    
-0000c9e0: 2020 2020 7365 6c66 2e79 673d 7967 0d0a      self.yg=yg..
-0000c9f0: 2020 2020 2020 2020 7365 6c66 2e7a 673d          self.zg=
-0000ca00: 7a67 0d0a 0d0a 2020 2020 2020 2020 7365  zg....        se
-0000ca10: 6c66 2e78 6763 3d78 6763 2020 2320 7867  lf.xgc=xgc  # xg
-0000ca20: 5f63 656c 6c5f 6365 6e74 6572 730d 0a20  _cell_centers.. 
-0000ca30: 2020 2020 2020 2073 656c 662e 7967 633d         self.ygc=
-0000ca40: 7967 6320 2023 2079 675f 6365 6c6c 5f63  ygc  # yg_cell_c
-0000ca50: 656e 7465 7273 0d0a 2020 2020 2020 2020  enters..        
-0000ca60: 7365 6c66 2e7a 6763 3d7a 6763 2020 2320  self.zgc=zgc  # 
-0000ca70: 7a67 5f63 656c 6c5f 6365 6e74 6572 730d  zg_cell_centers.
-0000ca80: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
-0000ca90: 7863 656c 6c63 656e 7465 7273 2c20 7365  xcellcenters, se
-0000caa0: 6c66 2e79 6365 6c6c 6365 6e74 6572 7320  lf.ycellcenters 
-0000cab0: 3d20 6e70 2e6d 6573 6867 7269 6428 7867  = np.meshgrid(xg
-0000cac0: 632c 2079 6763 2920 2320 6365 6c6c 2063  c, ygc) # cell c
-0000cad0: 656e 7465 7273 2063 6f6f 7264 696e 6174  enters coordinat
-0000cae0: 6573 0d0a 0d0a 2020 2020 2020 2020 7a5f  es....        z_
-0000caf0: 7472 6565 3d4b 4454 7265 6528 7a67 2e72  tree=KDTree(zg.r
-0000cb00: 6573 6861 7065 282d 312c 2031 2929 0d0a  eshape(-1, 1))..
-0000cb10: 2020 2020 2020 2020 7365 6c66 2e7a 5f74          self.z_t
-0000cb20: 7265 653d 7a5f 7472 6565 0d0a 2020 2020  ree=z_tree..    
-0000cb30: 2020 2020 7365 6c66 2e7a 635f 7472 6565      self.zc_tree
-0000cb40: 3d4b 4454 7265 6528 7a67 632e 7265 7368  =KDTree(zgc.resh
-0000cb50: 6170 6528 2d31 2c20 3129 290d 0a20 2020  ape(-1, 1))..   
-0000cb60: 2020 2020 2023 2073 656c 662e 7863 5f74       # self.xc_t
-0000cb70: 7265 653d 4b44 5472 6565 2878 6763 2e72  ree=KDTree(xgc.r
-0000cb80: 6573 6861 7065 282d 312c 2031 2929 0d0a  eshape(-1, 1))..
-0000cb90: 2020 2020 2020 2020 2320 7365 6c66 2e79          # self.y
-0000cba0: 635f 7472 6565 3d4b 4454 7265 6528 7967  c_tree=KDTree(yg
-0000cbb0: 632e 7265 7368 6170 6528 2d31 2c20 3129  c.reshape(-1, 1)
-0000cbc0: 290d 0a0d 0a0d 0a20 2020 2020 2020 2023  )......        #
-0000cbd0: 2320 7265 7361 6d70 6c65 2074 6f70 2061  # resample top a
-0000cbe0: 6e64 2062 6f74 2069 6620 6e65 6564 6564  nd bot if needed
-0000cbf0: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-0000cc00: 6e73 7461 6e63 6528 746f 702c 2073 7472  nstance(top, str
-0000cc10: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
-0000cc20: 626f 742c 2073 7472 293a 0d0a 0d0a 2020  bot, str):....  
-0000cc30: 2020 2020 2020 2020 2020 2369 6d70 6f72            #impor
-0000cc40: 7420 7261 7374 6572 696f 0d0a 2020 2020  t rasterio..    
-0000cc50: 2020 2020 2020 2020 696d 706f 7274 2072          import r
-0000cc60: 6173 7465 7269 6f0d 0a0d 0a20 2020 2020  asterio....     
-0000cc70: 2020 2020 2020 2023 6f70 656e 2072 6173         #open ras
-0000cc80: 7465 7220 616e 6420 6578 7472 6163 7420  ter and extract 
-0000cc90: 6365 6c6c 2063 656e 7465 7273 0d0a 2020  cell centers..  
-0000cca0: 2020 2020 2020 2020 2020 4445 4d3d 7261            DEM=ra
-0000ccb0: 7374 6572 696f 2e6f 7065 6e28 746f 7029  sterio.open(top)
-0000ccc0: 0d0a 2020 2020 2020 2020 2020 2020 7830  ..            x0
-0000ccd0: 2c20 7930 2c20 7831 2c20 7931 3d44 454d  , y0, x1, y1=DEM
-0000cce0: 2e62 6f75 6e64 730d 0a20 2020 2020 2020  .bounds..       
-0000ccf0: 2020 2020 2072 786c 656e 3d44 454d 2e72       rxlen=DEM.r
-0000cd00: 6561 6428 292e 7368 6170 655b 325d 0d0a  ead().shape[2]..
-0000cd10: 2020 2020 2020 2020 2020 2020 7279 6c65              ryle
-0000cd20: 6e3d 4445 4d2e 7265 6164 2829 2e73 6861  n=DEM.read().sha
-0000cd30: 7065 5b31 5d0d 0a20 2020 2020 2020 2020  pe[1]..         
-0000cd40: 2020 2078 3d6e 702e 6c69 6e73 7061 6365     x=np.linspace
-0000cd50: 2878 302c 2078 312c 2072 786c 656e 290d  (x0, x1, rxlen).
-0000cd60: 0a20 2020 2020 2020 2020 2020 2079 3d6e  .            y=n
-0000cd70: 702e 6c69 6e73 7061 6365 2879 312c 2079  p.linspace(y1, y
-0000cd80: 302c 2072 796c 656e 290d 0a20 2020 2020  0, rylen)..     
-0000cd90: 2020 2020 2020 2072 7863 2c20 7279 633d         rxc, ryc=
-0000cda0: 6e70 2e6d 6573 6867 7269 6428 782c 2079  np.meshgrid(x, y
-0000cdb0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000cdc0: 2023 7461 6b65 2067 7269 6420 6365 6c6c   #take grid cell
-0000cdd0: 2063 656e 7465 7273 0d0a 2020 2020 2020   centers..      
-0000cde0: 2020 2020 2020 7863 3d73 656c 662e 7863        xc=self.xc
-0000cdf0: 656c 6c63 656e 7465 7273 0d0a 2020 2020  ellcenters..    
-0000ce00: 2020 2020 2020 2020 7963 3d73 656c 662e          yc=self.
-0000ce10: 7963 656c 6c63 656e 7465 7273 0d0a 0d0a  ycellcenters....
-0000ce20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0000ce30: 7369 6e73 7461 6e63 6528 746f 702c 2073  sinstance(top, s
-0000ce40: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
-0000ce50: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-0000ce60: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-0000ce70: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0000ce80: 7428 2254 6f70 2069 7320 6120 7261 7374  t("Top is a rast
-0000ce90: 6572 202d 2072 6573 616d 706c 696e 6720  er - resampling 
-0000cea0: 6163 7469 7661 7465 6422 290d 0a20 2020  activated")..   
-0000ceb0: 2020 2020 2020 2020 2020 2020 2074 6f70               top
-0000cec0: 3d72 6573 616d 706c 655f 746f 5f67 7269  =resample_to_gri
-0000ced0: 6428 7863 2c20 7963 2c20 7278 632c 2072  d(xc, yc, rxc, r
-0000cee0: 7963 2c20 4445 4d2e 7265 6164 2829 5b30  yc, DEM.read()[0
-0000cef0: 5d2c 206d 6574 686f 643d 7273 706c 5f6d  ], method=rspl_m
-0000cf00: 6574 686f 6429 2020 2320 7265 7361 6d70  ethod)  # resamp
-0000cf10: 6c69 6e67 0d0a 0d0a 2020 2020 2020 2020  ling....        
-0000cf20: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000cf30: 6528 626f 742c 2073 7472 293a 0d0a 2020  e(bot, str):..  
-0000cf40: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000cf50: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-0000cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf70: 2020 2020 7072 696e 7428 2242 6f74 2069      print("Bot i
-0000cf80: 7320 6120 7261 7374 6572 202d 2072 6573  s a raster - res
-0000cf90: 616d 706c 696e 6720 6163 7469 7661 7465  ampling activate
-0000cfa0: 6422 290d 0a20 2020 2020 2020 2020 2020  d")..           
-0000cfb0: 2020 2020 2072 6173 743d 7261 7374 6572       rast=raster
-0000cfc0: 696f 2e6f 7065 6e28 626f 7429 0d0a 2020  io.open(bot)..  
-0000cfd0: 2020 2020 2020 2020 2020 2020 2020 7830                x0
-0000cfe0: 2c20 7930 2c20 7831 2c20 7931 3d72 6173  , y0, x1, y1=ras
-0000cff0: 742e 626f 756e 6473 0d0a 2020 2020 2020  t.bounds..      
-0000d000: 2020 2020 2020 2020 2020 7278 6c65 6e3d            rxlen=
-0000d010: 7261 7374 2e72 6561 6428 292e 7368 6170  rast.read().shap
-0000d020: 655b 325d 0d0a 2020 2020 2020 2020 2020  e[2]..          
-0000d030: 2020 2020 2020 7279 6c65 6e3d 7261 7374        rylen=rast
-0000d040: 2e72 6561 6428 292e 7368 6170 655b 315d  .read().shape[1]
-0000d050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000d060: 2020 783d 6e70 2e6c 696e 7370 6163 6528    x=np.linspace(
-0000d070: 7830 2c20 7831 2c20 7278 6c65 6e29 0d0a  x0, x1, rxlen)..
-0000d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d090: 793d 6e70 2e6c 696e 7370 6163 6528 7931  y=np.linspace(y1
-0000d0a0: 2c20 7930 2c20 7279 6c65 6e29 0d0a 2020  , y0, rylen)..  
-0000d0b0: 2020 2020 2020 2020 2020 2020 2020 7278                rx
-0000d0c0: 632c 2072 7963 3d6e 702e 6d65 7368 6772  c, ryc=np.meshgr
-0000d0d0: 6964 2878 2c20 7929 0d0a 2020 2020 2020  id(x, y)..      
-0000d0e0: 2020 2020 2020 2020 2020 626f 743d 7265            bot=re
-0000d0f0: 7361 6d70 6c65 5f74 6f5f 6772 6964 2878  sample_to_grid(x
-0000d100: 632c 2079 632c 2072 7863 2c20 7279 632c  c, yc, rxc, ryc,
-0000d110: 2072 6173 742e 7265 6164 2829 5b30 5d2c   rast.read()[0],
-0000d120: 206d 6574 686f 643d 7273 706c 5f6d 6574   method=rspl_met
-0000d130: 686f 6429 2020 2320 7265 7361 6d70 6c69  hod)  # resampli
-0000d140: 6e67 0d0a 0d0a 2020 2020 2020 2020 6966  ng....        if
-0000d150: 2074 6f70 2069 7320 6e6f 7420 4e6f 6e65   top is not None
-0000d160: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-0000d170: 7373 6572 7420 746f 702e 7368 6170 6520  ssert top.shape 
-0000d180: 3d3d 2028 6e79 2c20 6e78 292c 2022 546f  == (ny, nx), "To
-0000d190: 7020 7368 6170 6520 6973 206e 6f74 2061  p shape is not a
-0000d1a0: 6465 7175 6174 2072 6573 7065 6374 6976  dequat respectiv
-0000d1b0: 656c 7920 746f 2063 6f6f 7264 696e 6174  ely to coordinat
-0000d1c0: 6520 7665 6374 6f72 732e 205c 6e20 4d75  e vectors. \n Mu
-0000d1d0: 7374 2062 6520 6861 7665 2061 2073 697a  st be have a siz
-0000d1e0: 6520 6f66 202d 3120 7265 7370 6563 7469  e of -1 respecti
-0000d1f0: 7665 6c79 2074 6f20 636f 6f72 6469 6e61  vely to coordina
-0000d200: 7465 2076 6563 746f 7273 2078 6720 616e  te vectors xg an
-0000d210: 6420 7967 2028 7768 6963 6820 6172 6520  d yg (which are 
-0000d220: 7468 6520 7665 6374 6f72 7320 6f66 2065  the vectors of e
-0000d230: 6467 6520 6365 6c6c 7329 220d 0a20 2020  dge cells)"..   
-0000d240: 2020 2020 2069 6620 626f 7420 6973 206e       if bot is n
-0000d250: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0000d260: 2020 2020 2020 6173 7365 7274 2062 6f74        assert bot
-0000d270: 2e73 6861 7065 203d 3d20 286e 792c 206e  .shape == (ny, n
-0000d280: 7829 2c20 2242 6f74 2073 6861 7065 2069  x), "Bot shape i
-0000d290: 7320 6e6f 7420 6164 6571 7561 7420 7265  s not adequat re
-0000d2a0: 7370 6563 7469 7665 6c79 2074 6f20 636f  spectively to co
-0000d2b0: 6f72 6469 6e61 7465 2076 6563 746f 7273  ordinate vectors
-0000d2c0: 2e20 5c6e 204d 7573 7420 6265 2068 6176  . \n Must be hav
-0000d2d0: 6520 6120 7369 7a65 206f 6620 2d31 2072  e a size of -1 r
-0000d2e0: 6573 7065 6374 6976 656c 7920 746f 2063  espectively to c
-0000d2f0: 6f6f 7264 696e 6174 6520 7665 6374 6f72  oordinate vector
-0000d300: 7320 7867 2061 6e64 2079 6720 2877 6869  s xg and yg (whi
-0000d310: 6368 2061 7265 2074 6865 2076 6563 746f  ch are the vecto
-0000d320: 7273 206f 6620 6564 6765 2063 656c 6c73  rs of edge cells
-0000d330: 2922 0d0a 0d0a 2020 2020 2020 2020 2364  )"....        #d
-0000d340: 6566 696e 6520 746f 702f 626f 740d 0a20  efine top/bot.. 
-0000d350: 2020 2020 2020 2069 6620 2874 6f70 2069         if (top i
-0000d360: 7320 4e6f 6e65 2920 616e 6420 286d 6173  s None) and (mas
-0000d370: 6b20 6973 204e 6f6e 6529 3a0d 0a20 2020  k is None):..   
-0000d380: 2020 2020 2020 2020 2074 6f70 3d6e 702e           top=np.
-0000d390: 6f6e 6573 285b 6e79 2c20 6e78 5d2c 2064  ones([ny, nx], d
-0000d3a0: 7479 7065 3d6e 702e 666c 6f61 7433 3229  type=np.float32)
-0000d3b0: 2a6e 702e 6d61 7828 7a67 290d 0a0d 0a20  *np.max(zg).... 
-0000d3c0: 2020 2020 2020 2065 6c69 6620 2874 6f70         elif (top
-0000d3d0: 2069 7320 4e6f 6e65 2920 616e 6420 286d   is None) and (m
-0000d3e0: 6173 6b20 6973 206e 6f74 204e 6f6e 6529  ask is not None)
-0000d3f0: 3a20 2023 2069 6620 6d61 736b 2069 7320  :  # if mask is 
-0000d400: 7072 6f76 6964 6564 2062 7574 206e 6f74  provided but not
-0000d410: 2074 6f70 0d0a 2020 2020 2020 2020 2020   top..          
-0000d420: 2020 746f 7020 3d6e 702e 7a65 726f 7328    top =np.zeros(
-0000d430: 5b6e 792c 206e 785d 2c20 6474 7970 653d  [ny, nx], dtype=
-0000d440: 6e70 2e66 6c6f 6174 3332 292a 6e70 2e6e  np.float32)*np.n
-0000d450: 616e 0d0a 2020 2020 2020 2020 2020 2020  an..            
-0000d460: 666f 7220 6978 2069 6e20 7261 6e67 6528  for ix in range(
-0000d470: 6e78 293a 0d0a 2020 2020 2020 2020 2020  nx):..          
-0000d480: 2020 2020 2020 666f 7220 6979 2069 6e20        for iy in 
-0000d490: 7261 6e67 6528 6e79 293a 0d0a 2020 2020  range(ny):..    
-0000d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4b0: 666f 7220 697a 2069 6e20 7261 6e67 6528  for iz in range(
-0000d4c0: 6e7a 2d31 2c20 2d31 2c20 2d31 293a 0d0a  nz-1, -1, -1):..
-0000d4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4e0: 2020 2020 2020 2020 6966 206d 6173 6b5b          if mask[
-0000d4f0: 697a 2c20 6979 2c20 6978 5d3a 0d0a 2020  iz, iy, ix]:..  
-0000d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d510: 2020 2020 2020 2020 2020 746f 705b 6979            top[iy
-0000d520: 2c20 6978 5d3d 7a67 635b 697a 5d0d 0a20  , ix]=zgc[iz].. 
-0000d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d540: 2020 2020 2020 2020 2020 2062 7265 616b             break
-0000d550: 0d0a 0d0a 2020 2020 2020 2020 2320 6375  ....        # cu
-0000d560: 7420 746f 700d 0a20 2020 2020 2020 2074  t top..        t
-0000d570: 6f70 5b74 6f70 3e7a 675b 2d31 5d5d 3d7a  op[top>zg[-1]]=z
-0000d580: 675b 2d31 5d0d 0a20 2020 2020 2020 2074  g[-1]..        t
-0000d590: 6f70 5b74 6f70 3c7a 675b 305d 5d3d 7a67  op[top<zg[0]]=zg
-0000d5a0: 5b30 5d0d 0a20 2020 2020 2020 2073 656c  [0]..        sel
-0000d5b0: 662e 746f 703d 746f 702e 6173 7479 7065  f.top=top.astype
-0000d5c0: 286e 702e 666c 6f61 7433 3229 0d0a 0d0a  (np.float32)....
-0000d5d0: 2020 2020 2020 2020 6966 2028 626f 7420          if (bot 
-0000d5e0: 6973 204e 6f6e 6529 2061 6e64 2028 6d61  is None) and (ma
-0000d5f0: 736b 2069 7320 4e6f 6e65 293a 0d0a 2020  sk is None):..  
-0000d600: 2020 2020 2020 2020 2020 626f 743d 6e70            bot=np
-0000d610: 2e6f 6e65 7328 5b6e 792c 206e 785d 2c20  .ones([ny, nx], 
-0000d620: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
-0000d630: 292a 6e70 2e6d 696e 287a 6729 0d0a 0d0a  )*np.min(zg)....
-0000d640: 2020 2020 2020 2020 656c 6966 2028 626f          elif (bo
-0000d650: 7420 6973 204e 6f6e 6529 2061 6e64 2028  t is None) and (
-0000d660: 6d61 736b 2069 7320 6e6f 7420 4e6f 6e65  mask is not None
-0000d670: 293a 2020 2320 6966 206d 6173 6b20 6973  ):  # if mask is
-0000d680: 2070 726f 7669 6465 6420 6275 7420 6e6f   provided but no
-0000d690: 7420 746f 700d 0a20 2020 2020 2020 2020  t top..         
-0000d6a0: 2020 2062 6f74 203d 6e70 2e7a 6572 6f73     bot =np.zeros
-0000d6b0: 285b 6e79 2c20 6e78 5d2c 2064 7479 7065  ([ny, nx], dtype
-0000d6c0: 3d6e 702e 666c 6f61 7433 3229 2a6e 702e  =np.float32)*np.
-0000d6d0: 6e61 6e0d 0a20 2020 2020 2020 2020 2020  nan..           
-0000d6e0: 2066 6f72 2069 7820 696e 2072 616e 6765   for ix in range
-0000d6f0: 286e 7829 3a0d 0a20 2020 2020 2020 2020  (nx):..         
-0000d700: 2020 2020 2020 2066 6f72 2069 7920 696e         for iy in
-0000d710: 2072 616e 6765 286e 7929 3a0d 0a20 2020   range(ny):..   
-0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d730: 2066 6f72 2069 7a20 696e 2072 616e 6765   for iz in range
-0000d740: 286e 7a29 3a0d 0a20 2020 2020 2020 2020  (nz):..         
-0000d750: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000d760: 6620 6d61 736b 5b69 7a2c 2069 792c 2069  f mask[iz, iy, i
-0000d770: 785d 3a0d 0a20 2020 2020 2020 2020 2020  x]:..           
-0000d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d790: 2062 6f74 5b69 792c 2069 785d 3d7a 6763   bot[iy, ix]=zgc
-0000d7a0: 5b69 7a5d 0d0a 2020 2020 2020 2020 2020  [iz]..          
-0000d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d7c0: 2020 6272 6561 6b0d 0a20 2020 2020 2020    break..       
-0000d7d0: 2023 2063 7574 2062 6f74 0d0a 2020 2020   # cut bot..    
-0000d7e0: 2020 2020 626f 745b 626f 743e 7a67 5b2d      bot[bot>zg[-
-0000d7f0: 315d 5d3d 7a67 5b2d 315d 0d0a 2020 2020  1]]=zg[-1]..    
-0000d800: 2020 2020 626f 745b 626f 743c 7a67 5b30      bot[bot<zg[0
-0000d810: 5d5d 3d7a 675b 305d 0d0a 2020 2020 2020  ]]=zg[0]..      
-0000d820: 2020 7365 6c66 2e62 6f74 3d62 6f74 2e61    self.bot=bot.a
-0000d830: 7374 7970 6528 6e70 2e66 6c6f 6174 3332  stype(np.float32
-0000d840: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
-0000d850: 7265 6174 6520 6d61 736b 2066 726f 6d20  reate mask from 
-0000d860: 746f 7020 616e 6420 626f 7420 6966 206e  top and bot if n
-0000d870: 6f6e 650d 0a20 2020 2020 2020 2069 6620  one..        if 
-0000d880: 6d61 736b 2069 7320 4e6f 6e65 3a0d 0a20  mask is None:.. 
-0000d890: 2020 2020 2020 2020 2020 206d 6173 6b3d             mask=
-0000d8a0: 6e70 2e7a 6572 6f73 285b 6e7a 2c20 6e79  np.zeros([nz, ny
-0000d8b0: 2c20 6e78 5d2c 2064 7479 7065 3d62 6f6f  , nx], dtype=boo
-0000d8c0: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-0000d8d0: 6975 3d7a 5f74 7265 652e 7175 6572 7928  iu=z_tree.query(
-0000d8e0: 746f 702e 7265 7368 6170 6528 2d31 2c20  top.reshape(-1, 
-0000d8f0: 3129 2c20 7265 7475 726e 5f64 6973 7461  1), return_dista
-0000d900: 6e63 653d 4661 6c73 6529 2e72 6573 6861  nce=False).resha
-0000d910: 7065 286e 792c 206e 7829 0d0a 2020 2020  pe(ny, nx)..    
-0000d920: 2020 2020 2020 2020 696c 3d7a 5f74 7265          il=z_tre
-0000d930: 652e 7175 6572 7928 626f 742e 7265 7368  e.query(bot.resh
-0000d940: 6170 6528 2d31 2c20 3129 2c20 7265 7475  ape(-1, 1), retu
-0000d950: 726e 5f64 6973 7461 6e63 653d 4661 6c73  rn_distance=Fals
-0000d960: 6529 2e72 6573 6861 7065 286e 792c 206e  e).reshape(ny, n
-0000d970: 7829 0d0a 0d0a 2020 2020 2020 2020 2020  x)....          
-0000d980: 2020 666f 7220 6978 2069 6e20 7261 6e67    for ix in rang
-0000d990: 6528 6c65 6e28 7867 6329 293a 0d0a 2020  e(len(xgc)):..  
-0000d9a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0000d9b0: 7220 6979 2069 6e20 7261 6e67 6528 6c65  r iy in range(le
-0000d9c0: 6e28 7967 6329 293a 0d0a 2020 2020 2020  n(ygc)):..      
-0000d9d0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0000d9e0: 736b 5b69 6c5b 6979 2c20 6978 5d3a 2069  sk[il[iy, ix]: i
-0000d9f0: 755b 6979 2c20 6978 5d2c 2069 792c 2069  u[iy, ix], iy, i
-0000da00: 785d 3d31 0d0a 0d0a 2020 2020 2020 2020  x]=1....        
-0000da10: 2320 6c69 7374 206f 6620 636f 6f72 6469  # list of coordi
-0000da20: 6e61 7465 7320 3244 2061 6e64 2033 440d  nates 2D and 3D.
-0000da30: 0a20 2020 2020 2020 2058 2c20 593d 6e70  .        X, Y=np
-0000da40: 2e6d 6573 6867 7269 6428 7867 632c 2079  .meshgrid(xgc, y
-0000da50: 6763 290d 0a20 2020 2020 2020 2073 656c  gc)..        sel
-0000da60: 662e 7875 3244 3d6e 702e 6172 7261 7928  f.xu2D=np.array(
-0000da70: 5b58 2e66 6c61 7474 656e 2829 2c20 592e  [X.flatten(), Y.
-0000da80: 666c 6174 7465 6e28 295d 2c20 6474 7970  flatten()], dtyp
-0000da90: 653d 6e70 2e66 6c6f 6174 3332 292e 540d  e=np.float32).T.
-0000daa0: 0a0d 0a20 2020 2020 2020 2023 582c 2059  ...        #X, Y
-0000dab0: 2c20 5a3d 6e70 2e6d 6573 6867 7269 6428  , Z=np.meshgrid(
-0000dac0: 7867 632c 2079 6763 2c20 7a67 6329 0d0a  xgc, ygc, zgc)..
-0000dad0: 2020 2020 2020 2020 2373 656c 662e 7875          #self.xu
-0000dae0: 3344 3d6e 702e 6172 7261 7928 5b58 2e66  3D=np.array([X.f
-0000daf0: 6c61 7474 656e 2829 2c20 592e 666c 6174  latten(), Y.flat
-0000db00: 7465 6e28 292c 205a 2e66 6c61 7474 656e  ten(), Z.flatten
-0000db10: 2829 5d29 2e54 0d0a 0d0a 2020 2020 2020  ()]).T....      
-0000db20: 2020 2361 7070 6c79 2070 6f6c 7967 6f6e    #apply polygon
-0000db30: 0d0a 0d0a 2020 2020 2020 2020 2320 6966  ....        # if
-0000db40: 2070 6f6c 7967 6f6e 2069 7320 6120 7368   polygon is a sh
-0000db50: 6170 6566 696c 650d 0a20 2020 2020 2020  apefile..       
-0000db60: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-0000db70: 6f6c 7967 6f6e 2c20 7374 7229 3a20 2023  olygon, str):  #
-0000db80: 2069 6620 706f 6c79 676f 6e20 6973 2061   if polygon is a
-0000db90: 2073 6861 7065 6669 6c65 0d0a 2020 2020   shapefile..    
-0000dba0: 2020 2020 2020 2020 696d 706f 7274 2073          import s
-0000dbb0: 6861 7065 6c79 0d0a 2020 2020 2020 2020  hapely..        
-0000dbc0: 2020 2020 6672 6f6d 2073 6861 7065 6c79      from shapely
-0000dbd0: 2e67 656f 6d65 7472 7920 696d 706f 7274  .geometry import
-0000dbe0: 2050 6f6c 7967 6f6e 2c20 4d75 6c74 6950   Polygon, MultiP
-0000dbf0: 6f6c 7967 6f6e 0d0a 0d0a 2020 2020 2020  olygon....      
-0000dc00: 2020 2020 2020 6966 2070 6f6c 7967 6f6e        if polygon
-0000dc10: 2e73 706c 6974 2822 2e22 295b 2d31 5d20  .split(".")[-1] 
-0000dc20: 3d3d 2022 7368 7022 3a0d 0a20 2020 2020  == "shp":..     
-0000dc30: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-0000dc40: 7420 6765 6f70 616e 6461 7320 6173 2067  t geopandas as g
-0000dc50: 7020 0d0a 2020 2020 2020 2020 2020 2020  p ..            
-0000dc60: 2020 2020 706f 6c79 203d 2067 702e 7265      poly = gp.re
-0000dc70: 6164 5f66 696c 6528 706f 6c79 676f 6e29  ad_file(polygon)
-0000dc80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000dc90: 2020 6966 2070 6f6c 792e 7368 6170 655b    if poly.shape[
-0000dca0: 305d 203d 3d20 313a 0d0a 2020 2020 2020  0] == 1:..      
-0000dcb0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0000dcc0: 6c79 676f 6e20 3d20 506f 6c79 676f 6e28  lygon = Polygon(
-0000dcd0: 706f 6c79 2e67 656f 6d65 7472 792e 696c  poly.geometry.il
-0000dce0: 6f63 5b30 5d29 0d0a 2020 2020 2020 2020  oc[0])..        
-0000dcf0: 2020 2020 2020 2020 656c 6966 2070 6f6c          elif pol
-0000dd00: 792e 7368 6170 655b 305d 203e 2031 3a0d  y.shape[0] > 1:.
-0000dd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000dd20: 2020 2020 2070 6f6c 7967 6f6e 203d 204d       polygon = M
-0000dd30: 756c 7469 506f 6c79 676f 6e28 706f 6c79  ultiPolygon(poly
-0000dd40: 2e67 656f 6d65 7472 792e 7661 6c75 6573  .geometry.values
-0000dd50: 290d 0a0d 0a20 2020 2020 2020 2069 6d70  )....        imp
-0000dd60: 6f72 7420 7368 6170 656c 790d 0a20 2020  ort shapely..   
-0000dd70: 2020 2020 2023 2069 6620 706f 6c79 676f       # if polygo
-0000dd80: 6e20 6973 2073 6861 7065 6c79 2050 6f6c  n is shapely Pol
-0000dd90: 7967 6f6e 0d0a 2020 2020 2020 2020 6966  ygon..        if
-0000dda0: 2069 7369 6e73 7461 6e63 6528 706f 6c79   isinstance(poly
-0000ddb0: 676f 6e2c 2028 7368 6170 656c 792e 6765  gon, (shapely.ge
-0000ddc0: 6f6d 6574 7279 2e50 6f6c 7967 6f6e 2c20  ometry.Polygon, 
-0000ddd0: 7368 6170 656c 792e 6765 6f6d 6574 7279  shapely.geometry
-0000dde0: 2e4d 756c 7469 506f 6c79 676f 6e29 293a  .MultiPolygon)):
-0000ddf0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000de00: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-0000de10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000de20: 7072 696e 7428 2250 6f6c 7967 6f6e 2069  print("Polygon i
-0000de30: 7320 6120 7368 6170 656c 7920 696e 7374  s a shapely inst
-0000de40: 616e 6365 202d 2064 6973 6372 6574 697a  ance - discretiz
-0000de50: 6174 696f 6e20 6163 7469 7661 7465 6422  ation activated"
-0000de60: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000de70: 2070 6f6c 7967 6f6e 5f61 7272 6179 3d6e   polygon_array=n
-0000de80: 702e 7a65 726f 7328 5b6e 792a 6e78 5d2c  p.zeros([ny*nx],
-0000de90: 2064 7479 7065 3d62 6f6f 6c29 2020 2320   dtype=bool)  # 
-0000dea0: 3244 2061 7272 6179 2073 696d 756c 6174  2D array simulat
-0000deb0: 696f 6e20 646f 6d61 696e 0d0a 2020 2020  ion domain..    
-0000dec0: 2020 2020 2020 2020 6365 6c6c 5f6c 203d          cell_l =
-0000ded0: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
-0000dee0: 2066 6f72 2069 2c63 656c 6c20 696e 2065   for i,cell in e
-0000def0: 6e75 6d65 7261 7465 2873 656c 662e 7875  numerate(self.xu
-0000df00: 3244 293a 0d0a 0d0a 2020 2020 2020 2020  2D):....        
-0000df10: 2020 2020 2020 2020 7879 203d 2028 2863          xy = ((c
-0000df20: 656c 6c5b 305d 2d73 782f 322c 2063 656c  ell[0]-sx/2, cel
-0000df30: 6c5b 315d 2d73 792f 3229 2c28 6365 6c6c  l[1]-sy/2),(cell
-0000df40: 5b30 5d2d 7378 2f32 2c20 6365 6c6c 5b31  [0]-sx/2, cell[1
-0000df50: 5d2b 7379 2f32 292c 0d0a 2020 2020 2020  ]+sy/2),..      
-0000df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df70: 2863 656c 6c5b 305d 2b73 782f 322c 2063  (cell[0]+sx/2, c
-0000df80: 656c 6c5b 315d 2b73 792f 3229 2c28 6365  ell[1]+sy/2),(ce
-0000df90: 6c6c 5b30 5d2b 7378 2f32 2c20 6365 6c6c  ll[0]+sx/2, cell
-0000dfa0: 5b31 5d2d 7379 2f32 2929 0d0a 2020 2020  [1]-sy/2))..    
-0000dfb0: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
-0000dfc0: 7368 6170 656c 792e 6765 6f6d 6574 7279  shapely.geometry
-0000dfd0: 2e50 6f6c 7967 6f6e 2878 7929 0d0a 2020  .Polygon(xy)..  
-0000dfe0: 2020 2020 2020 2020 2020 2020 2020 702e                p.
-0000dff0: 6e61 6d65 203d 2069 0d0a 2020 2020 2020  name = i..      
-0000e000: 2020 2020 2020 2020 2020 6365 6c6c 5f6c            cell_l
-0000e010: 2e61 7070 656e 6428 7029 0d0a 0d0a 2020  .append(p)....  
-0000e020: 2020 2020 2020 2020 2020 6c3d 5b5d 2020            l=[]  
-0000e030: 2320 6c69 7374 206f 6620 696e 7465 7273  # list of inters
-0000e040: 6563 7465 6420 6365 6c6c 730d 0a20 2020  ected cells..   
-0000e050: 2020 2020 2020 2020 2066 6f72 2063 656c           for cel
-0000e060: 6c20 696e 2063 656c 6c5f 6c3a 0d0a 2020  l in cell_l:..  
-0000e070: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000e080: 2063 656c 6c2e 696e 7465 7273 6563 7473   cell.intersects
-0000e090: 2870 6f6c 7967 6f6e 293a 0d0a 2020 2020  (polygon):..    
-0000e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0b0: 6c2e 6170 7065 6e64 2863 656c 6c2e 6e61  l.append(cell.na
-0000e0c0: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
-0000e0d0: 2070 6f6c 7967 6f6e 5f61 7272 6179 5b6e   polygon_array[n
-0000e0e0: 702e 6172 7261 7928 6c29 5d3d 310d 0a20  p.array(l)]=1.. 
-0000e0f0: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
-0000e100: 6f6e 3d70 6f6c 7967 6f6e 5f61 7272 6179  on=polygon_array
-0000e110: 2e72 6573 6861 7065 286e 792c 206e 7829  .reshape(ny, nx)
-0000e120: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-0000e130: 6f6c 7967 6f6e 2069 7320 6e6f 7420 4e6f  olygon is not No
-0000e140: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0000e150: 2070 6f6c 7967 6f6e 3d70 6f6c 7967 6f6e   polygon=polygon
-0000e160: 2e61 7374 7970 6528 626f 6f6c 2920 2365  .astype(bool) #e
-0000e170: 6e73 7572 6520 706f 6c79 676f 6e20 6973  nsure polygon is
-0000e180: 2061 2062 6f6f 6c65 616e 2061 7272 6179   a boolean array
-0000e190: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0000e1a0: 7220 6978 2069 6e20 7261 6e67 6528 6e78  r ix in range(nx
-0000e1b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0000e1c0: 2020 2020 666f 7220 6979 2069 6e20 7261      for iy in ra
-0000e1d0: 6e67 6528 6e79 293a 0d0a 2020 2020 2020  nge(ny):..      
-0000e1e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000e1f0: 207e 706f 6c79 676f 6e5b 6979 2c20 6978   ~polygon[iy, ix
-0000e200: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-0000e210: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-0000e220: 5b3a 2c20 6979 2c20 6978 5d3d 300d 0a0d  [:, iy, ix]=0...
-0000e230: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-0000e240: 736b 3d6d 6173 6b0d 0a20 2020 2020 2020  sk=mask..       
-0000e250: 2073 656c 662e 6d61 736b 3264 203d 206d   self.mask2d = m
-0000e260: 6173 6b2e 616e 7928 3029 0d0a 0d0a 2020  ask.any(0)....  
-0000e270: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-0000e280: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-0000e290: 2020 2020 7072 696e 7428 2223 2320 4772      print("## Gr
-0000e2a0: 6964 2061 6464 6564 2061 6e64 2069 7320  id added and is 
-0000e2b0: 6e6f 7720 7369 6d75 6c61 7469 6f6e 2067  now simulation g
-0000e2c0: 7269 6420 2323 2229 0d0a 0d0a 0d0a 2020  rid ##")......  
-0000e2d0: 2020 6465 6620 6869 6572 6172 6368 795f    def hierarchy_
-0000e2e0: 7265 6c61 7469 6f6e 7328 7365 6c66 2c20  relations(self, 
-0000e2f0: 7662 3d31 293a 0d0a 0d0a 2020 2020 2020  vb=1):....      
-0000e300: 2020 2222 224d 6574 686f 6420 7468 6174    """Method that
-0000e310: 2073 6574 7320 7468 6520 6869 6572 6172   sets the hierar
-0000e320: 6368 6963 616c 2072 656c 6174 696f 6e73  chical relations
-0000e330: 2062 6574 7765 656e 2075 6e69 7473 0d0a   between units..
-0000e340: 2020 2020 2020 2020 616e 6420 7375 622d          and sub-
-0000e350: 756e 6974 730d 0a20 2020 2020 2020 2022  units..        "
-0000e360: 2222 0d0a 0d0a 2020 2020 2020 2020 6465  ""....        de
-0000e370: 6620 685f 7265 6c61 7469 6f6e 7328 7069  f h_relations(pi
-0000e380: 6c65 293a 0d0a 2020 2020 2020 2020 2020  le):..          
-0000e390: 2020 2222 220d 0a20 2020 2020 2020 2020    """..         
-0000e3a0: 2020 2023 2063 616c 6375 6c61 7465 206d     # calculate m
-0000e3b0: 756d 6d79 2075 6e69 7420 666f 7220 6561  ummy unit for ea
-0000e3c0: 6368 2073 7562 2075 6e69 7420 2874 6f20  ch sub unit (to 
-0000e3d0: 7768 6963 6820 756e 6974 2061 2073 7562  which unit a sub
-0000e3e0: 2d75 6e69 7420 6973 2072 656c 6174 6564  -unit is related
-0000e3f0: 290d 0a20 2020 2020 2020 2020 2020 2022  )..            "
-0000e400: 2222 0d0a 2020 2020 2020 2020 2020 2020  ""..            
-0000e410: 666f 7220 7320 696e 2070 696c 652e 6c69  for s in pile.li
-0000e420: 7374 5f75 6e69 7473 3a20 2320 6c6f 6f70  st_units: # loop
-0000e430: 206f 7665 7220 756e 6974 7320 6f66 2074   over units of t
-0000e440: 6865 206d 6173 7465 7220 7069 6c65 0d0a  he master pile..
-0000e450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e460: 6966 2073 2e66 5f6d 6574 686f 6420 3d3d  if s.f_method ==
-0000e470: 2022 5375 6250 696c 6522 3a0d 0a20 2020   "SubPile":..   
-0000e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e490: 2066 6f72 2073 7375 6220 696e 2073 2e53   for ssub in s.S
-0000e4a0: 7562 5069 6c65 2e6c 6973 745f 756e 6974  ubPile.list_unit
-0000e4b0: 733a 2023 206c 6f6f 7020 6f76 6572 2075  s: # loop over u
-0000e4c0: 6e69 7473 206f 6620 7468 6520 7375 6220  nits of the sub 
-0000e4d0: 7069 6c65 2069 6620 6669 6c6c 696e 6720  pile if filling 
-0000e4e0: 6d65 7468 6f64 2069 7320 5375 6250 696c  method is SubPil
-0000e4f0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-0000e500: 2020 2020 2020 2020 2020 2073 7375 622e             ssub.
-0000e510: 6d75 6d6d 795f 756e 6974 3d73 0d0a 2020  mummy_unit=s..  
-0000e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e530: 2020 685f 7265 6c61 7469 6f6e 7328 732e    h_relations(s.
-0000e540: 5375 6250 696c 6529 0d0a 0d0a 2020 2020  SubPile)....    
-0000e550: 2020 2020 685f 7265 6c61 7469 6f6e 7328      h_relations(
-0000e560: 7365 6c66 2e67 6574 5f70 696c 655f 6d61  self.get_pile_ma
-0000e570: 7374 6572 2829 290d 0a0d 0a20 2020 2020  ster())....     
-0000e580: 2020 2023 7365 7420 6262 2075 6e69 7473     #set bb units
-0000e590: 0d0a 2020 2020 2020 2020 666f 7220 756e  ..        for un
-0000e5a0: 6974 2069 6e20 7365 6c66 2e67 6574 5f61  it in self.get_a
-0000e5b0: 6c6c 5f75 6e69 7473 2829 3a0d 0a20 2020  ll_units():..   
-0000e5c0: 2020 2020 2020 2020 2075 6e69 742e 6765           unit.ge
-0000e5d0: 745f 6261 6279 5f75 6e69 7473 2872 6563  t_baby_units(rec
-0000e5e0: 6f6d 7075 7465 3d54 7275 652c 2076 623d  ompute=True, vb=
-0000e5f0: 3029 0d0a 0d0a 2020 2020 2020 2020 6966  0)....        if
-0000e600: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
-0000e610: 2020 7072 696e 7428 2268 6965 7261 7263    print("hierarc
-0000e620: 6869 6361 6c20 7265 6c61 7469 6f6e 7320  hical relations 
-0000e630: 7365 7422 290d 0a0d 0a0d 0a20 2020 2064  set")......    d
-0000e640: 6566 2063 6865 636b 5f62 685f 696e 7369  ef check_bh_insi
-0000e650: 6465 2873 656c 662c 2062 6829 3a0d 0a0d  de(self, bh):...
-0000e660: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0000e670: 2020 2020 2020 4368 6563 6b20 6966 2061        Check if a
-0000e680: 2062 6f72 6568 6f6c 6520 6973 2069 6e73   borehole is ins
-0000e690: 6964 6520 7468 6520 7369 6d75 6c61 7469  ide the simulati
-0000e6a0: 6f6e 2064 6f6d 6169 6e0d 0a20 2020 2020  on domain..     
-0000e6b0: 2020 2061 6e64 2063 7574 2062 6f72 6568     and cut boreh
-0000e6c0: 6f6c 6573 2069 6620 6e65 6564 6564 0d0a  oles if needed..
-0000e6d0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0000e6e0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0000e6f0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0000e700: 2020 6268 3a20 3a63 6c61 7373 3a60 426f    bh: :class:`Bo
-0000e710: 7265 686f 6c65 600d 0a20 2020 2020 2020  rehole`..       
-0000e720: 2020 2020 2062 6f72 6568 6f6c 6520 6f62       borehole ob
-0000e730: 6a65 6374 0d0a 2020 2020 2020 2020 0d0a  ject..        ..
-0000e740: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0000e750: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000e760: 0d0a 2020 2020 2020 2020 3020 6966 2062  ..        0 if b
-0000e770: 6f72 6568 6f6c 6520 6973 206f 7574 7369  orehole is outsi
-0000e780: 6465 2074 6865 2073 696d 756c 6174 696f  de the simulatio
-0000e790: 6e20 646f 6d61 696e 0d0a 2020 2020 2020  n domain..      
-0000e7a0: 2020 3120 6966 2062 6f72 6568 6f6c 6520    1 if borehole 
-0000e7b0: 6973 2069 6e73 6964 6520 7468 6520 7369  is inside the si
-0000e7c0: 6d75 6c61 7469 6f6e 2064 6f6d 6169 6e0d  mulation domain.
-0000e7d0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-0000e7e0: 2020 2020 2020 2020 6966 2062 682e 6465          if bh.de
-0000e7f0: 7074 6820 3c3d 2030 3a0d 0a20 2020 2020  pth <= 0:..     
-0000e800: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-0000e810: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-0000e820: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0000e830: 626f 7265 686f 6c65 2064 6570 7468 2069  borehole depth i
-0000e840: 7320 6e6f 7420 706f 7369 7469 7665 2229  s not positive")
-0000e850: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0000e860: 7475 726e 2030 0d0a 0d0a 0d0a 2020 2020  turn 0......    
-0000e870: 2020 2020 2366 756e 2074 6f20 6368 6563      #fun to chec
-0000e880: 6b20 626f 746f 6d0d 0a20 2020 2020 2020  k botom..       
-0000e890: 2064 6566 2063 7574 5f62 6f74 6f6d 2862   def cut_botom(b
-0000e8a0: 6829 3a0d 0a20 2020 2020 2020 2020 2020  h):..           
-0000e8b0: 207a 305f 6268 3d62 682e 7a0d 0a20 2020   z0_bh=bh.z..   
-0000e8c0: 2020 2020 2020 2020 207a 626f 745f 6268           zbot_bh
-0000e8d0: 3d7a 305f 6268 202d 2062 682e 6465 7074  =z0_bh - bh.dept
-0000e8e0: 680d 0a0d 0a20 2020 2020 2020 2020 2020  h....           
-0000e8f0: 2062 6f74 5f7a 203d 2073 656c 662e 626f   bot_z = self.bo
-0000e900: 745b 7365 6c66 2e63 6f6f 7264 3263 656c  t[self.coord2cel
-0000e910: 6c28 6268 2e78 2c20 6268 2e79 295d 0d0a  l(bh.x, bh.y)]..
-0000e920: 2020 2020 2020 2020 2020 2020 2320 6966              # if
-0000e930: 2028 7a62 6f74 5f62 6820 3c20 7a67 5b30   (zbot_bh < zg[0
-0000e940: 5d29 3a20 2023 206d 6f64 6966 6963 6174  ]):  # modificat
-0000e950: 696f 6e20 746f 2063 7574 2062 656c 6f77  ion to cut below
-0000e960: 2062 6f74 2061 6e64 206e 6f74 2062 656c   bot and not bel
-0000e970: 6f77 2073 696d 756c 6174 696f 6e20 6772  ow simulation gr
-0000e980: 6964 0d0a 2020 2020 2020 2020 2020 2020  id..            
-0000e990: 6966 2028 7a62 6f74 5f62 6820 3c20 626f  if (zbot_bh < bo
-0000e9a0: 745f 7a29 3a0d 0a20 2020 2020 2020 2020  t_z):..         
-0000e9b0: 2020 2020 2020 2062 682e 6465 7074 683d         bh.depth=
-0000e9c0: 287a 305f 6268 202d 2062 6f74 5f7a 2920  (z0_bh - bot_z) 
-0000e9d0: 2d20 737a 2f32 0d0a 2020 2020 2020 2020  - sz/2..        
-0000e9e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000e9f0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0000ea00: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0000ea10: 696e 7428 2242 6f72 6568 6f6c 6520 7b7d  int("Borehole {}
-0000ea20: 2067 6f65 7320 6265 6c6f 7720 6d6f 6465   goes below mode
-0000ea30: 6c20 6c69 6d69 7473 2c20 626f 7265 686f  l limits, boreho
-0000ea40: 6c65 207b 7d20 6465 7074 6820 6375 7422  le {} depth cut"
-0000ea50: 2e66 6f72 6d61 7428 6268 2e49 442c 2062  .format(bh.ID, b
-0000ea60: 682e 4944 2929 0d0a 2020 2020 2020 2020  h.ID))..        
-0000ea70: 2020 2020 2020 2020 6966 2062 682e 6c6f          if bh.lo
-0000ea80: 675f 7374 7261 7469 2069 7320 6e6f 7420  g_strati is not 
-0000ea90: 4e6f 6e65 3a20 2320 7570 6461 7465 206c  None: # update l
-0000eaa0: 6f67 2073 7472 6174 690d 0a20 2020 2020  og strati..     
-0000eab0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000eac0: 6577 5f6c 6f67 3d5b 5d0d 0a20 2020 2020  ew_log=[]..     
-0000ead0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000eae0: 6f72 2073 2069 6e20 6268 2e6c 6f67 5f73  or s in bh.log_s
-0000eaf0: 7472 6174 693a 0d0a 2020 2020 2020 2020  trati:..        
-0000eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb10: 6966 2073 5b31 5d20 3e20 626f 745f 7a3a  if s[1] > bot_z:
-0000eb20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000eb30: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0000eb40: 775f 6c6f 672e 6170 7065 6e64 2873 290d  w_log.append(s).
-0000eb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000eb60: 2020 2020 2062 682e 6c6f 675f 7374 7261       bh.log_stra
-0000eb70: 7469 3d6e 6577 5f6c 6f67 0d0a 2020 2020  ti=new_log..    
-0000eb80: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-0000eb90: 682e 6c6f 675f 6661 6369 6573 2069 7320  h.log_facies is 
-0000eba0: 6e6f 7420 4e6f 6e65 3a20 2320 7570 6461  not None: # upda
-0000ebb0: 7465 206c 6f67 2066 6163 6965 730d 0a20  te log facies.. 
-0000ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebd0: 2020 206e 6577 5f6c 6f67 3d5b 5d0d 0a20     new_log=[].. 
-0000ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebf0: 2020 2066 6f72 2073 2069 6e20 6268 2e6c     for s in bh.l
-0000ec00: 6f67 5f66 6163 6965 733a 0d0a 2020 2020  og_facies:..    
-0000ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec20: 2020 2020 6966 2073 5b31 5d20 3e20 626f      if s[1] > bo
-0000ec30: 745f 7a3a 0d0a 2020 2020 2020 2020 2020  t_z:..          
-0000ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec50: 2020 6e65 775f 6c6f 672e 6170 7065 6e64    new_log.append
-0000ec60: 2873 290d 0a20 2020 2020 2020 2020 2020  (s)..           
-0000ec70: 2020 2020 2020 2020 2062 682e 6c6f 675f           bh.log_
-0000ec80: 6661 6369 6573 3d6e 6577 5f6c 6f67 0d0a  facies=new_log..
-0000ec90: 0d0a 2020 2020 2020 2020 7a67 3d73 656c  ..        zg=sel
-0000eca0: 662e 6765 745f 7a67 2829 2023 207a 2076  f.get_zg() # z v
-0000ecb0: 6563 746f 720d 0a20 2020 2020 2020 2073  ector..        s
-0000ecc0: 7a3d 7365 6c66 2e67 6574 5f73 7a28 290d  z=self.get_sz().
-0000ecd0: 0a0d 0a20 2020 2020 2020 2023 6368 6563  ...        #chec
-0000ece0: 6b20 626f 746f 6d0d 0a20 2020 2020 2020  k botom..       
-0000ecf0: 2069 6620 6268 2e6c 6f67 5f73 7472 6174   if bh.log_strat
-0000ed00: 6920 6973 206e 6f74 204e 6f6e 653a 0d0a  i is not None:..
-0000ed10: 2020 2020 2020 2020 2020 2020 7a30 5f62              z0_b
-0000ed20: 683d 6268 2e6c 6f67 5f73 7472 6174 695b  h=bh.log_strati[
-0000ed30: 305d 5b31 5d20 2320 626f 7265 686f 6c65  0][1] # borehole
-0000ed40: 2061 6c74 6974 7564 6520 746f 700d 0a20   altitude top.. 
-0000ed50: 2020 2020 2020 2065 6c69 6620 6268 2e6c         elif bh.l
-0000ed60: 6f67 5f66 6163 6965 7320 6973 206e 6f74  og_facies is not
-0000ed70: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000ed80: 2020 2020 7a30 5f62 683d 6268 2e6c 6f67      z0_bh=bh.log
-0000ed90: 5f66 6163 6965 735b 305d 5b31 5d0d 0a20  _facies[0][1].. 
-0000eda0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000edb0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0000edc0: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-0000edd0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0000ede0: 7428 226e 6f20 6c6f 6720 666f 756e 6420  t("no log found 
-0000edf0: 696e 2062 6820 7b7d 222e 666f 726d 6174  in bh {}".format
-0000ee00: 2862 682e 4944 2929 0d0a 2020 2020 2020  (bh.ID))..      
-0000ee10: 2020 2020 2020 7265 7475 726e 2030 0d0a        return 0..
-0000ee20: 0d0a 2020 2020 2020 2020 2363 6865 636b  ..        #check
-0000ee30: 2069 6e73 6964 6520 6d61 736b 2061 6e64   inside mask and
-0000ee40: 2061 6461 7074 207a 2062 6f72 6568 6f6c   adapt z borehol
-0000ee50: 6520 746f 2044 454d 0d0a 2020 2020 2020  e to DEM..      
-0000ee60: 2020 666f 7220 697a 2069 6e20 6e70 2e61    for iz in np.a
-0000ee70: 7261 6e67 6528 7a30 5f62 682c 207a 305f  range(z0_bh, z0_
-0000ee80: 6268 2d62 682e 6465 7074 682c 206d 6178  bh-bh.depth, max
-0000ee90: 282d 737a 2c20 282d 6268 2e64 6570 7468  (-sz, (-bh.depth
-0000eea0: 2920 2f20 3229 293a 0d0a 2020 2020 2020  ) / 2)):..      
-0000eeb0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
-0000eec0: 6f72 6432 6365 6c6c 2862 682e 782c 2062  ord2cell(bh.x, b
-0000eed0: 682e 792c 2069 7a29 2069 7320 6e6f 7420  h.y, iz) is not 
-0000eee0: 4e6f 6e65 3a20 2320 6368 6563 6b20 6966  None: # check if
-0000eef0: 2069 6e73 6964 6520 6d61 736b 0d0a 2020   inside mask..  
-0000ef00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000ef10: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-0000ef20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef30: 2020 2020 2370 7269 6e74 2822 426f 7265      #print("Bore
-0000ef40: 686f 6c65 207b 7d20 696e 7369 6465 206f  hole {} inside o
-0000ef50: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
-0000ef60: 207a 6f6e 6522 2e66 6f72 6d61 7428 6268   zone".format(bh
-0000ef70: 2e49 4429 290d 0a20 2020 2020 2020 2020  .ID))..         
-0000ef80: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-0000ef90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000efa0: 2069 6620 697a 203d 3d20 6268 2e7a 3a0d   if iz == bh.z:.
-0000efb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000efc0: 2020 2020 2063 7574 5f62 6f74 6f6d 2862       cut_botom(b
-0000efd0: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
-0000efe0: 2020 2020 2020 2020 6966 2062 682e 6465          if bh.de
-0000eff0: 7074 6820 3c20 303a 0d0a 2020 2020 2020  pth < 0:..      
-0000f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f010: 2020 7265 7475 726e 2030 0d0a 2020 2020    return 0..    
-0000f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f030: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000f040: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000f050: 6574 7572 6e20 310d 0a20 2020 2020 2020  eturn 1..       
-0000f060: 2020 2020 2020 2020 2065 6c69 6620 697a           elif iz
-0000f070: 203c 2062 682e 7a3a 2023 2069 6620 7468   < bh.z: # if th
-0000f080: 6520 626f 7265 686f 6c65 2069 7320 6162  e borehole is ab
-0000f090: 6f76 6520 4445 4d20 616e 6420 6d75 7374  ove DEM and must
-0000f0a0: 2062 6520 6375 740d 0a20 2020 2020 2020   be cut..       
-0000f0b0: 2020 2020 2020 2020 2020 2020 2062 682e               bh.
-0000f0c0: 7a3d 697a 2020 2375 7064 6174 6520 626f  z=iz  #update bo
-0000f0d0: 7265 686f 6c65 2061 6c74 6974 7564 650d  rehole altitude.
-0000f0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f0f0: 2020 2020 2023 2075 7064 6174 6520 6c6f       # update lo
-0000f100: 6720 7374 7261 7469 0d0a 2020 2020 2020  g strati..      
-0000f110: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000f120: 2062 682e 6c6f 675f 7374 7261 7469 3a0d   bh.log_strati:.
-0000f130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f140: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0000f150: 6268 2e6c 6f67 5f73 7472 6174 6929 203e  bh.log_strati) >
-0000f160: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-0000f170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f180: 206e 6577 5f6c 6f67 3d5b 5d0d 0a20 2020   new_log=[]..   
-0000f190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1a0: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-0000f1b0: 6e20 7261 6e67 6528 6c65 6e28 6268 2e6c  n range(len(bh.l
-0000f1c0: 6f67 5f73 7472 6174 6929 2d31 293a 0d0a  og_strati)-1):..
-0000f1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1f0: 733d 6268 2e6c 6f67 5f73 7472 6174 695b  s=bh.log_strati[
-0000f200: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
-0000f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f220: 2020 2020 7332 3d62 682e 6c6f 675f 7374      s2=bh.log_st
-0000f230: 7261 7469 5b69 2b31 5d0d 0a20 2020 2020  rati[i+1]..     
+0000af10: 2020 2066 6e61 6d65 3d73 656c 662e 6e61     fname=self.na
+0000af20: 6d65 2b22 7b7d 5f7b 7d5f 7b7d 5f7b 7d2e  me+"{}_{}_{}_{}.
+0000af30: 7072 6f22 2e66 6f72 6d61 7428 6e61 6d65  pro".format(name
+0000af40: 2c20 6975 2c20 6966 612c 2069 7029 0d0a  , iu, ifa, ip)..
+0000af50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af60: 2020 2020 2020 2020 2020 2020 6670 6174              fpat
+0000af70: 683d 6f73 2e70 6174 682e 6a6f 696e 2873  h=os.path.join(s
+0000af80: 656c 662e 7773 2c20 666e 616d 6529 0d0a  elf.ws, fname)..
+0000af90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afa0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+0000afb0: 206f 7065 6e28 6670 6174 682c 2022 7262   open(fpath, "rb
+0000afc0: 2229 2061 7320 663a 0d0a 2020 2020 2020  ") as f:..      
+0000afd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000afe0: 2020 2020 2020 2020 2020 7072 6f70 5b69            prop[i
+0000aff0: 752c 2069 6661 2c20 6970 5d3d 7069 636b  u, ifa, ip]=pick
+0000b000: 6c65 2e6c 6f61 6428 6629 0d0a 2020 2020  le.load(f)..    
+0000b010: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0000b020: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000b030: 726f 703d 7365 6c66 2e47 656f 6c2e 7072  rop=self.Geol.pr
+0000b040: 6f70 5f76 616c 7565 735b 6e61 6d65 5d0d  op_values[name].
+0000b050: 0a0d 0a20 2020 2020 2020 2065 6c73 653a  ...        else:
+0000b060: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0000b070: 2073 656c 662e 7772 6974 655f 7265 7375   self.write_resu
+0000b080: 6c74 733a 0d0a 2020 2020 2020 2020 2020  lts:..          
+0000b090: 2020 2020 2020 666e 616d 653d 7365 6c66        fname=self
+0000b0a0: 2e6e 616d 652b 227b 7d5f 7b7d 5f7b 7d5f  .name+"{}_{}_{}_
+0000b0b0: 7b7d 2e70 726f 222e 666f 726d 6174 286e  {}.pro".format(n
+0000b0c0: 616d 652c 2069 752c 2069 6661 2c20 6970  ame, iu, ifa, ip
+0000b0d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000b0e0: 2020 2066 7061 7468 3d6f 732e 7061 7468     fpath=os.path
+0000b0f0: 2e6a 6f69 6e28 7365 6c66 2e77 732c 2066  .join(self.ws, f
+0000b100: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+0000b110: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
+0000b120: 2866 7061 7468 2c20 2272 6222 2920 6173  (fpath, "rb") as
+0000b130: 2066 3a0d 0a20 2020 2020 2020 2020 2020   f:..           
+0000b140: 2020 2020 2020 2020 2070 726f 703d 7069           prop=pi
+0000b150: 636b 6c65 2e6c 6f61 6428 6629 0d0a 2020  ckle.load(f)..  
+0000b160: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0000b170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b180: 2070 726f 703d 7365 6c66 2e47 656f 6c2e   prop=self.Geol.
+0000b190: 7072 6f70 5f76 616c 7565 735b 6e61 6d65  prop_values[name
+0000b1a0: 5d5b 6975 2c20 6966 612c 2069 705d 0d0a  ][iu, ifa, ip]..
+0000b1b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000b1c0: 2070 726f 700d 0a0d 0a20 2020 2064 6566   prop....    def
+0000b1d0: 2067 6574 5f62 6f75 6e64 7328 7365 6c66   get_bounds(self
+0000b1e0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+0000b1f0: 2252 6574 7572 6e20 626f 756e 6473 206f  "Return bounds o
+0000b200: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
+0000b210: 2064 6f6d 6169 6e20 0d0a 2020 2020 2020   domain ..      
+0000b220: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
+0000b230: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+0000b240: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7475  ----..        tu
+0000b250: 706c 650d 0a20 2020 2020 2020 2020 2020  ple..           
+0000b260: 2028 786d 696e 2c20 786d 6178 2c20 796d   (xmin, xmax, ym
+0000b270: 696e 2c20 796d 6178 2c20 7a6d 696e 2c20  in, ymax, zmin, 
+0000b280: 7a6d 6178 290d 0a20 2020 2020 2020 2022  zmax)..        "
+0000b290: 2222 0d0a 0d0a 2020 2020 2020 2020 626f  ""....        bo
+0000b2a0: 756e 6473 3d5b 7365 6c66 2e67 6574 5f6f  unds=[self.get_o
+0000b2b0: 7828 292c 2073 656c 662e 6765 745f 7867  x(), self.get_xg
+0000b2c0: 2829 5b2d 315d 2c20 7365 6c66 2e67 6574  ()[-1], self.get
+0000b2d0: 5f6f 7928 292c 2073 656c 662e 6765 745f  _oy(), self.get_
+0000b2e0: 7967 2829 5b2d 315d 2c20 7365 6c66 2e67  yg()[-1], self.g
+0000b2f0: 6574 5f6f 7a28 292c 2073 656c 662e 6765  et_oz(), self.ge
+0000b300: 745f 7a67 2829 5b2d 315d 5d0d 0a20 2020  t_zg()[-1]]..   
+0000b310: 2020 2020 2072 6574 7572 6e20 626f 756e       return boun
+0000b320: 6473 0d0a 0d0a 2020 2020 6465 6620 6368  ds....    def ch
+0000b330: 6563 6b5f 756e 6974 735f 4944 2873 656c  eck_units_ID(sel
+0000b340: 6629 3a0d 0a20 2020 2020 2020 200d 0a20  f):..        .. 
+0000b350: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0000b360: 2020 2020 6368 6563 6b20 7468 6520 4944      check the ID
+0000b370: 7320 6f66 2075 6e69 7473 2069 6e20 6f72  s of units in or
+0000b380: 6465 7220 746f 2062 6520 7375 7265 2074  der to be sure t
+0000b390: 6861 7420 7468 6579 2061 7265 2064 6966  hat they are dif
+0000b3a0: 6665 7265 6e74 0d0a 0d0a 2020 2020 2020  ferent....      
+0000b3b0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+0000b3c0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+0000b3d0: 2020 2020 696e 740d 0a20 2020 2020 2020      int..       
+0000b3e0: 2020 2020 2031 2069 6620 616c 6c20 6973       1 if all is
+0000b3f0: 206f 6b0d 0a20 2020 2020 2020 2022 2222   ok..        """
+0000b400: 0d0a 0d0a 2020 2020 2020 2020 6c3d 5b5d  ....        l=[]
+0000b410: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+0000b420: 696e 2073 656c 662e 6765 745f 616c 6c5f  in self.get_all_
+0000b430: 756e 6974 7328 7265 636f 6d70 7574 653d  units(recompute=
+0000b440: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
+0000b450: 2020 2020 6966 2069 2e49 4420 6e6f 7420      if i.ID not 
+0000b460: 696e 206c 3a0d 0a20 2020 2020 2020 2020  in l:..         
+0000b470: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
+0000b480: 692e 4944 290d 0a20 2020 2020 2020 2020  i.ID)..         
+0000b490: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0000b4a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0000b4b0: 2253 6f72 7279 2c20 756e 6974 207b 7d20  "Sorry, unit {} 
+0000b4c0: 6861 7320 7468 6520 7361 6d65 2049 4420  has the same ID 
+0000b4d0: 7b7d 2074 6861 6e20 616e 6f74 6865 7220  {} than another 
+0000b4e0: 756e 6974 2e20 4944 206d 7573 7420 6265  unit. ID must be
+0000b4f0: 2064 6966 6665 7265 6e74 7320 666f 7220   differents for 
+0000b500: 6561 6368 2075 6e69 7473 222e 666f 726d  each units".form
+0000b510: 6174 2869 2e6e 616d 652c 2069 2e49 4429  at(i.name, i.ID)
+0000b520: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000b530: 2020 2072 6574 7572 6e20 4e6f 6e65 0d0a     return None..
+0000b540: 2020 2020 2020 2020 7265 7475 726e 2031          return 1
+0000b550: 0d0a 0d0a 2020 2020 6465 6620 6368 6563  ....    def chec
+0000b560: 6b5f 7069 6c65 735f 6e61 6d65 2873 656c  k_piles_name(sel
+0000b570: 6629 3a0d 0a0d 0a20 2020 2020 2020 2022  f):....        "
+0000b580: 2222 0d0a 2020 2020 2020 2020 6368 6563  ""..        chec
+0000b590: 6b20 7468 6520 6e61 6d65 7320 6f66 2070  k the names of p
+0000b5a0: 696c 6573 2069 6e20 6f72 6465 7220 746f  iles in order to
+0000b5b0: 2062 6520 7375 7265 2074 6861 7420 7468   be sure that th
+0000b5c0: 6579 2061 7265 2064 6966 6665 7265 6e74  ey are different
+0000b5d0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+0000b5e0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+0000b5f0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 696e  ----..        in
+0000b600: 740d 0a20 2020 2020 2020 2020 2020 2031  t..            1
+0000b610: 2069 6620 616c 6c20 6973 206f 6b0d 0a20   if all is ok.. 
+0000b620: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+0000b630: 2020 2020 2020 6c5f 6e61 6d65 733d 5b5d        l_names=[]
+0000b640: 0d0a 0d0a 2020 2020 2020 2020 6c3d 7365  ....        l=se
+0000b650: 6c66 2e67 6574 5f70 696c 6573 2829 0d0a  lf.get_piles()..
+0000b660: 2020 2020 2020 2020 666f 7220 7020 696e          for p in
+0000b670: 206c 3a0d 0a20 2020 2020 2020 2020 2020   l:..           
+0000b680: 2069 6620 702e 6e61 6d65 206e 6f74 2069   if p.name not i
+0000b690: 6e20 6c5f 6e61 6d65 733a 0d0a 2020 2020  n l_names:..    
+0000b6a0: 2020 2020 2020 2020 2020 2020 6c5f 6e61              l_na
+0000b6b0: 6d65 732e 6170 7065 6e64 2870 2e6e 616d  mes.append(p.nam
+0000b6c0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0000b6d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000b6e0: 2020 2020 2020 2070 7269 6e74 2822 5069         print("Pi
+0000b6f0: 6c65 206e 616d 6520 277b 7d27 2069 7320  le name '{}' is 
+0000b700: 6174 7472 6962 7574 6564 2074 6f20 6d6f  attributed to mo
+0000b710: 7265 2074 6861 6e20 6f6e 6520 7069 6c65  re than one pile
+0000b720: 2c20 7665 7262 6f74 656e 2021 222e 666f  , verboten !".fo
+0000b730: 726d 6174 2870 2e6e 616d 6529 290d 0a20  rmat(p.name)).. 
+0000b740: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000b750: 6574 7572 6e20 300d 0a0d 0a20 2020 2020  eturn 0....     
+0000b760: 2020 2072 6574 7572 6e20 310d 0a0d 0a20     return 1.... 
+0000b770: 2020 2064 6566 2073 6574 5f50 696c 655f     def set_Pile_
+0000b780: 6d61 7374 6572 2873 656c 662c 2050 696c  master(self, Pil
+0000b790: 655f 6d61 7374 6572 293a 0d0a 0d0a 2020  e_master):....  
+0000b7a0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+0000b7b0: 2020 2044 6566 696e 6520 6120 7069 6c65     Define a pile
+0000b7c0: 206f 626a 6563 7420 6173 2074 6865 206d   object as the m
+0000b7d0: 6169 6e20 7069 6c65 206f 6620 7468 6520  ain pile of the 
+0000b7e0: 7072 6f6a 6563 740d 0a0d 0a20 2020 2020  project....     
+0000b7f0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0000b800: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0000b810: 2d0d 0a20 2020 2020 2020 2050 696c 655f  -..        Pile_
+0000b820: 6d61 7374 6572 3a20 3a63 6c61 7373 3a60  master: :class:`
+0000b830: 5069 6c65 6020 6f62 6a65 6374 0d0a 2020  Pile` object..  
+0000b840: 2020 2020 2020 2020 2020 7069 6c65 206f            pile o
+0000b850: 626a 6563 7420 746f 2073 6574 2061 7320  bject to set as 
+0000b860: 7468 6520 6d61 696e 2070 696c 6520 6f66  the main pile of
+0000b870: 2074 6865 2070 726f 6a65 6374 0d0a 0d0a   the project....
+0000b880: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0000b890: 2020 2020 2020 2061 7373 6572 7420 6973         assert is
+0000b8a0: 696e 7374 616e 6365 2850 696c 655f 6d61  instance(Pile_ma
+0000b8b0: 7374 6572 2c20 5069 6c65 292c 2022 5069  ster, Pile), "Pi
+0000b8c0: 6c65 206d 6173 7465 7220 6973 206e 6f74  le master is not
+0000b8d0: 2061 6e20 4172 6368 5079 2050 696c 6520   an ArchPy Pile 
+0000b8e0: 6f62 6a65 6374 220d 0a20 2020 2020 2020  object"..       
+0000b8f0: 2073 656c 662e 5069 6c65 5f6d 6173 7465   self.Pile_maste
+0000b900: 723d 5069 6c65 5f6d 6173 7465 720d 0a20  r=Pile_master.. 
+0000b910: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+0000b920: 6865 636b 5f70 696c 6573 5f6e 616d 6528  heck_piles_name(
+0000b930: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000b940: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0000b950: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000b960: 2020 7072 696e 7428 2250 696c 6520 7365    print("Pile se
+0000b970: 7473 2061 7320 5069 6c65 206d 6173 7465  ts as Pile maste
+0000b980: 7222 290d 0a20 2020 2020 2020 2065 6c73  r")..        els
+0000b990: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000b9a0: 7365 6c66 2e50 696c 655f 6d61 7374 6572  self.Pile_master
+0000b9b0: 3d4e 6f6e 650d 0a20 2020 2020 2020 2020  =None..         
+0000b9c0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0000b9d0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000b9e0: 2020 2020 2070 7269 6e74 2822 5069 6c65       print("Pile
+0000b9f0: 206e 6f74 2073 6574 7322 290d 0a0d 0a20   not sets").... 
+0000ba00: 2020 2064 6566 2063 656c 6c74 6f69 6e64     def celltoind
+0000ba10: 6578 2873 656c 662c 6365 6c6c 5f78 2c63  ex(self,cell_x,c
+0000ba20: 656c 6c5f 792c 6365 6c6c 5f7a 293a 0d0a  ell_y,cell_z):..
+0000ba30: 0d0a 2020 2020 2020 2020 2727 2763 656c  ..        '''cel
+0000ba40: 6c20 696e 6465 7820 746f 2063 656c 6c20  l index to cell 
+0000ba50: 706f 7369 7469 6f6e 0d0a 2020 2020 2020  position..      
+0000ba60: 2020 0d0a 2020 2020 2020 2020 5061 7261    ..        Para
+0000ba70: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+0000ba80: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+0000ba90: 2020 2020 6365 6c6c 5f78 203a 2069 6e74      cell_x : int
+0000baa0: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+0000bab0: 6c6c 2069 6e64 6578 2069 6e20 7820 6469  ll index in x di
+0000bac0: 7265 6374 696f 6e0d 0a20 2020 2020 2020  rection..       
+0000bad0: 2063 656c 6c5f 7920 3a20 696e 740d 0a20   cell_y : int.. 
+0000bae0: 2020 2020 2020 2020 2020 2063 656c 6c20             cell 
+0000baf0: 696e 6465 7820 696e 2079 2064 6972 6563  index in y direc
+0000bb00: 7469 6f6e 0d0a 2020 2020 2020 2020 6365  tion..        ce
+0000bb10: 6c6c 5f7a 203a 2069 6e74 0d0a 2020 2020  ll_z : int..    
+0000bb20: 2020 2020 2020 2020 6365 6c6c 2069 6e64          cell ind
+0000bb30: 6578 2069 6e20 7a20 6469 7265 6374 696f  ex in z directio
+0000bb40: 6e0d 0a20 2020 2020 2020 2020 2020 200d  n..            .
+0000bb50: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000bb60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0000bb70: 2d0d 0a20 2020 2020 2020 2074 7570 6c65  -..        tuple
+0000bb80: 0d0a 2020 2020 2020 2020 2020 2020 2878  ..            (x
+0000bb90: 2c79 2c7a 2920 6365 6c6c 2070 6f73 6974  ,y,z) cell posit
+0000bba0: 696f 6e0d 0a20 2020 2020 2020 2027 2727  ion..        '''
+0000bbb0: 0d0a 0d0a 2020 2020 2020 2020 783d 7365  ....        x=se
+0000bbc0: 6c66 2e67 6574 5f73 7828 292a 2063 656c  lf.get_sx()* cel
+0000bbd0: 6c5f 7820 2b20 6d69 6e28 7365 6c66 2e67  l_x + min(self.g
+0000bbe0: 6574 5f78 6763 2829 290d 0a20 2020 2020  et_xgc())..     
+0000bbf0: 2020 2079 3d73 656c 662e 6765 745f 7379     y=self.get_sy
+0000bc00: 2829 2a20 6365 6c6c 5f79 202b 206d 696e  ()* cell_y + min
+0000bc10: 2873 656c 662e 6765 745f 7967 6328 2929  (self.get_ygc())
+0000bc20: 0d0a 2020 2020 2020 2020 7a3d 7365 6c66  ..        z=self
+0000bc30: 2e67 6574 5f73 7a28 292a 2063 656c 6c5f  .get_sz()* cell_
+0000bc40: 7a20 2b20 6d69 6e28 7365 6c66 2e67 6574  z + min(self.get
+0000bc50: 5f7a 6763 2829 290d 0a20 2020 2020 2020  _zgc())..       
+0000bc60: 2072 6574 7572 6e20 782c 792c 7a0d 0a0d   return x,y,z...
+0000bc70: 0a20 2020 2064 6566 2072 6570 726f 6365  .    def reproce
+0000bc80: 7373 2873 656c 6629 3a0d 0a0d 0a20 2020  ss(self):....   
+0000bc90: 2020 2020 2022 2222 5265 7072 6f63 6573       """Reproces
+0000bca0: 7320 7468 6520 626f 7265 686f 6c65 7320  s the boreholes 
+0000bcb0: 616e 6420 6572 6173 6520 7468 6520 7072  and erase the pr
+0000bcc0: 6576 696f 7573 2068 6172 6420 6461 7461  evious hard data
+0000bcd0: 2222 220d 0a0d 0a20 2020 2020 2020 2073  """....        s
+0000bce0: 656c 662e 6268 735f 7072 6f63 6573 7365  elf.bhs_processe
+0000bcf0: 643d 300d 0a20 2020 2020 2020 2073 656c  d=0..        sel
+0000bd00: 662e 6572 6173 655f 6864 2829 0d0a 2020  f.erase_hd()..  
+0000bd10: 2020 2020 2020 7365 6c66 2e70 726f 6365        self.proce
+0000bd20: 7373 5f62 6873 2829 0d0a 2020 2020 2020  ss_bhs()..      
+0000bd30: 2020 7365 6c66 2e73 6565 643d 2069 6e74    self.seed= int
+0000bd40: 2873 656c 662e 7365 6564 202b 2031 6536  (self.seed + 1e6
+0000bd50: 290d 0a0d 0a20 2020 2064 6566 2072 6573  )....    def res
+0000bd60: 616d 706c 6532 6772 6964 2873 656c 662c  ample2grid(self,
+0000bd70: 2072 6173 7465 725f 7061 7468 2c20 6261   raster_path, ba
+0000bd80: 6e64 3d4e 6f6e 652c 2072 7370 6c5f 6d65  nd=None, rspl_me
+0000bd90: 7468 6f64 3d22 6e65 6172 6573 7422 293a  thod="nearest"):
+0000bda0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
+0000bdb0: 0a20 2020 2020 2020 2052 6573 616d 706c  .        Resampl
+0000bdc0: 6520 6120 7261 7374 6572 2074 6f20 7468  e a raster to th
+0000bdd0: 6520 7369 7a65 206f 6620 7468 6520 7369  e size of the si
+0000bde0: 6d75 6c61 7469 6f6e 2067 7269 642e 0d0a  mulation grid...
+0000bdf0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0000be00: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0000be10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0000be20: 2020 7261 7374 6572 5f70 6174 6820 3a20    raster_path : 
+0000be30: 7374 720d 0a20 2020 2020 2020 2020 2020  str..           
+0000be40: 2070 6174 6820 746f 2074 6865 2072 6173   path to the ras
+0000be50: 7465 7220 6669 6c65 0d0a 2020 2020 2020  ter file..      
+0000be60: 2020 6261 6e64 203a 2069 6e74 2c20 6f70    band : int, op
+0000be70: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0000be80: 2020 2020 7261 7374 6572 2062 616e 6420      raster band 
+0000be90: 746f 2075 7365 2c20 6966 204e 6f6e 6520  to use, if None 
+0000bea0: 3020 6973 2075 7365 642e 2054 6865 2064  0 is used. The d
+0000beb0: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
+0000bec0: 0a20 2020 2020 2020 2072 7370 6c5f 6d65  .        rspl_me
+0000bed0: 7468 6f64 203a 2073 7472 2c20 6f70 7469  thod : str, opti
+0000bee0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+0000bef0: 2020 7265 7361 6d70 6c69 6e67 206d 6574    resampling met
+0000bf00: 686f 6420 746f 2075 7365 2e20 6176 6169  hod to use. avai
+0000bf10: 6c61 626c 6573 2061 7265 203a 206e 6561  lables are : nea
+0000bf20: 7265 7374 2c20 6c69 6e65 6172 2c20 6375  rest, linear, cu
+0000bf30: 6269 632e 0d0a 2020 2020 2020 2020 2020  bic...          
+0000bf40: 2020 5468 6520 6465 6661 756c 7420 6973    The default is
+0000bf50: 2022 6e65 6172 6573 7422 2e0d 0a0d 0a20   "nearest"..... 
+0000bf60: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+0000bf70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0000bf80: 0a20 2020 2020 2020 2032 4420 6172 7261  .        2D arra
+0000bf90: 7920 6f66 2073 697a 6520 2873 656c 662e  y of size (self.
+0000bfa0: 6e79 2c20 7365 6c66 2e6e 7829 0d0a 2020  ny, self.nx)..  
+0000bfb0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+0000bfc0: 2020 2020 2023 696d 706f 7274 2072 6173       #import ras
+0000bfd0: 7465 7269 6f0d 0a20 2020 2020 2020 2069  terio..        i
+0000bfe0: 6d70 6f72 7420 7261 7374 6572 696f 0d0a  mport rasterio..
+0000bff0: 0d0a 2020 2020 2020 2020 236f 7065 6e20  ..        #open 
+0000c000: 7261 7374 6572 2061 6e64 2065 7874 7261  raster and extra
+0000c010: 6374 2063 656c 6c20 6365 6e74 6572 730d  ct cell centers.
+0000c020: 0a20 2020 2020 2020 2044 454d 3d72 6173  .        DEM=ras
+0000c030: 7465 7269 6f2e 6f70 656e 2872 6173 7465  terio.open(raste
+0000c040: 725f 7061 7468 290d 0a20 2020 2020 2020  r_path)..       
+0000c050: 2078 302c 2079 302c 2078 312c 2079 313d   x0, y0, x1, y1=
+0000c060: 4445 4d2e 626f 756e 6473 0d0a 2020 2020  DEM.bounds..    
+0000c070: 2020 2020 7278 6c65 6e3d 4445 4d2e 7265      rxlen=DEM.re
+0000c080: 6164 2829 2e73 6861 7065 5b32 5d0d 0a20  ad().shape[2].. 
+0000c090: 2020 2020 2020 2072 796c 656e 3d44 454d         rylen=DEM
+0000c0a0: 2e72 6561 6428 292e 7368 6170 655b 315d  .read().shape[1]
+0000c0b0: 0d0a 2020 2020 2020 2020 783d 6e70 2e6c  ..        x=np.l
+0000c0c0: 696e 7370 6163 6528 7830 2c20 7831 2c20  inspace(x0, x1, 
+0000c0d0: 7278 6c65 6e29 0d0a 2020 2020 2020 2020  rxlen)..        
+0000c0e0: 793d 6e70 2e6c 696e 7370 6163 6528 7931  y=np.linspace(y1
+0000c0f0: 2c20 7930 2c20 7279 6c65 6e29 0d0a 2020  , y0, rylen)..  
+0000c100: 2020 2020 2020 7278 632c 2072 7963 3d6e        rxc, ryc=n
+0000c110: 702e 6d65 7368 6772 6964 2878 2c20 7929  p.meshgrid(x, y)
+0000c120: 0d0a 0d0a 2020 2020 2020 2020 2374 616b  ....        #tak
+0000c130: 6520 6772 6964 2063 656c 6c20 6365 6e74  e grid cell cent
+0000c140: 6572 730d 0a20 2020 2020 2020 2078 633d  ers..        xc=
+0000c150: 7365 6c66 2e78 6365 6c6c 6365 6e74 6572  self.xcellcenter
+0000c160: 730d 0a20 2020 2020 2020 2079 633d 7365  s..        yc=se
+0000c170: 6c66 2e79 6365 6c6c 6365 6e74 6572 730d  lf.ycellcenters.
+0000c180: 0a0d 0a20 2020 2020 2020 2069 6620 6261  ...        if ba
+0000c190: 6e64 2069 7320 4e6f 6e65 3a0d 0a20 2020  nd is None:..   
+0000c1a0: 2020 2020 2020 2020 2069 6220 3d20 300d           ib = 0.
+0000c1b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0000c1c0: 2020 2020 2020 2020 2020 2020 6962 203d              ib =
+0000c1d0: 2062 616e 640d 0a20 2020 2020 2020 2072   band..        r
+0000c1e0: 6574 7572 6e20 7265 7361 6d70 6c65 5f74  eturn resample_t
+0000c1f0: 6f5f 6772 6964 2878 632c 2079 632c 2072  o_grid(xc, yc, r
+0000c200: 7863 2c20 7279 632c 2044 454d 2e72 6561  xc, ryc, DEM.rea
+0000c210: 6428 295b 6962 5d2c 206d 6574 686f 643d  d()[ib], method=
+0000c220: 7273 706c 5f6d 6574 686f 6429 2020 2320  rspl_method)  # 
+0000c230: 7265 7361 6d70 6c69 6e67 0d0a 0d0a 2020  resampling....  
+0000c240: 2020 6465 6620 6164 645f 6772 6964 2873    def add_grid(s
+0000c250: 656c 662c 2064 696d 656e 7369 6f6e 732c  elf, dimensions,
+0000c260: 2073 7061 6369 6e67 2c20 6f72 6967 696e   spacing, origin
+0000c270: 2c20 746f 703d 4e6f 6e65 2c20 626f 743d  , top=None, bot=
+0000c280: 4e6f 6e65 2c20 7273 706c 5f6d 6574 686f  None, rspl_metho
+0000c290: 643d 226e 6561 7265 7374 222c 2070 6f6c  d="nearest", pol
+0000c2a0: 7967 6f6e 3d4e 6f6e 652c 206d 6173 6b3d  ygon=None, mask=
+0000c2b0: 4e6f 6e65 293a 0d0a 0d0a 2020 2020 2020  None):....      
+0000c2c0: 2020 2222 220d 0a20 2020 2020 2020 204d    """..        M
+0000c2d0: 6574 686f 6420 746f 2061 6464 2f63 6861  ethod to add/cha
+0000c2e0: 6e67 6520 7369 6d75 6c61 7469 6f6e 2067  nge simulation g
+0000c2f0: 7269 642c 2072 6567 756c 6172 2067 7269  rid, regular gri
+0000c300: 642e 0d0a 0d0a 2020 2020 2020 2020 5061  d.....        Pa
+0000c310: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0000c320: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0000c330: 2020 2020 2020 6469 6d65 6e73 696f 6e73        dimensions
+0000c340: 3a20 7365 7175 656e 6365 206f 6620 7369  : sequence of si
+0000c350: 7a65 2033 2c0d 0a20 2020 2020 2020 2020  ze 3,..         
+0000c360: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+0000c370: 6572 206f 6620 6365 6c6c 7320 696e 2078  er of cells in x
+0000c380: 2c20 7920 616e 6420 6469 7265 6374 696f  , y and directio
+0000c390: 6e20 286e 782c 206e 792c 206e 7a29 0d0a  n (nx, ny, nz)..
+0000c3a0: 2020 2020 2020 2020 7370 6163 696e 673a          spacing:
+0000c3b0: 2073 6571 7565 6e63 6520 6f66 2073 697a   sequence of siz
+0000c3c0: 6520 332c 0d0a 2020 2020 2020 2020 2020  e 3,..          
+0000c3d0: 2020 2020 2020 2073 7061 6369 6e67 206f         spacing o
+0000c3e0: 6620 7468 6520 6365 6c6c 7320 696e 2078  f the cells in x
+0000c3f0: 2c20 7920 616e 6420 6469 7265 6374 696f  , y and directio
+0000c400: 6e20 2873 782c 2073 792c 2073 7a29 0d0a  n (sx, sy, sz)..
+0000c410: 2020 2020 2020 2020 6f72 6967 696e 3a20          origin: 
+0000c420: 7365 7175 656e 6365 206f 6620 7369 7a65  sequence of size
+0000c430: 2033 2c0d 0a20 2020 2020 2020 2020 2020   3,..           
+0000c440: 2020 2020 206f 7269 6769 6e20 6f66 2074       origin of t
+0000c450: 6865 2073 696d 756c 6174 696f 6e20 6772  he simulation gr
+0000c460: 6964 206f 6620 7468 6520 6365 6c6c 730d  id of the cells.
+0000c470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c480: 2069 6e20 782c 2079 2061 6e64 2064 6972   in x, y and dir
+0000c490: 6563 7469 6f6e 2028 6f78 2c20 6f79 2c20  ection (ox, oy, 
+0000c4a0: 6f7a 290d 0a20 2020 2020 2020 2074 6f70  oz)..        top
+0000c4b0: 2c20 626f 743a 2032 4420 6e64 6172 7261  , bot: 2D ndarra
+0000c4c0: 7920 6f66 2064 696d 656e 7369 6f6e 7320  y of dimensions 
+0000c4d0: 286e 792c 206e 7829 206f 7220 666c 6f61  (ny, nx) or floa
+0000c4e0: 7420 6f72 2072 6173 7465 7220 6669 6c65  t or raster file
+0000c4f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000c500: 2020 2020 2074 6f70 2061 6e64 2062 6f74       top and bot
+0000c510: 746f 6d20 6f66 2074 6865 2073 696d 756c  tom of the simul
+0000c520: 6174 696f 6e20 646f 6d61 696e 0d0a 2020  ation domain..  
+0000c530: 2020 2020 2020 7273 706c 5f6d 6574 686f        rspl_metho
+0000c540: 643a 2073 7472 696e 670d 0a20 2020 2020  d: string..     
+0000c550: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000c560: 6369 7079 2072 6573 616d 706c 696e 6720  cipy resampling 
+0000c570: 6d65 7468 6f64 2028 6e65 6172 6573 742c  method (nearest,
+0000c580: 206c 696e 6561 720d 0a20 2020 2020 2020   linear..       
+0000c590: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+0000c5a0: 2063 7562 6963 202d 2d3e 206e 6561 7265   cubic --> neare
+0000c5b0: 7374 2069 7320 6765 6e65 7261 6c6c 7920  st is generally 
+0000c5c0: 7375 6666 6963 6965 6e74 290d 0a20 2020  sufficient)..   
+0000c5d0: 2020 2020 2070 6f6c 7967 6f6e 3a20 3244       polygon: 2D
+0000c5e0: 206e 6461 7272 6179 206f 6620 6469 6d65   ndarray of dime
+0000c5f0: 6e73 696f 6e73 2028 6e79 2c20 6e78 290d  nsions (ny, nx).
+0000c600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c610: 2062 6f6f 6c65 616e 2061 7272 6179 2074   boolean array t
+0000c620: 6f20 696e 6469 6361 7465 2077 6865 7265  o indicate where
+0000c630: 2074 6865 2073 696d 756c 6174 696f 6e20   the simulation 
+0000c640: 6973 2061 6374 6976 6520 2831 290d 0a20  is active (1).. 
+0000c650: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000c660: 7220 696e 6163 7469 7665 2028 3029 2e20  r inactive (0). 
+0000c670: 506f 6c79 676f 6e20 6361 6e20 616c 736f  Polygon can also
+0000c680: 2062 6520 6120 5368 6170 656c 7920 284d   be a Shapely (M
+0000c690: 756c 7469 2920 2d20 706f 6c79 676f 6e2e  ulti) - polygon.
+0000c6a0: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
+0000c6b0: 3344 206e 6461 7272 6179 206f 6620 6469  3D ndarray of di
+0000c6c0: 6d65 6e73 696f 6e73 2028 6e7a 2c20 6e79  mensions (nz, ny
+0000c6d0: 2c20 6e78 290d 0a20 2020 2020 2020 2020  , nx)..         
+0000c6e0: 2020 2020 2020 2033 4420 626f 6f6c 6561         3D boolea
+0000c6f0: 6e20 6172 7261 7920 746f 2069 6e64 6963  n array to indic
+0000c700: 6174 6520 7768 6572 6520 7468 6520 7369  ate where the si
+0000c710: 6d75 6c61 7469 6f6e 0d0a 2020 2020 2020  mulation..      
+0000c720: 2020 2020 2020 2020 2020 6973 2061 6374            is act
+0000c730: 6976 6520 2831 2920 6f72 2069 6e61 6374  ive (1) or inact
+0000c740: 6976 6520 2830 292e 0d0a 2020 2020 2020  ive (0)...      
+0000c750: 2020 2020 2020 2020 2020 4966 2067 6976            If giv
+0000c760: 656e 2c20 746f 702c 2062 6f74 2061 6e64  en, top, bot and
+0000c770: 2070 6f6c 7967 6f6e 2061 7265 2069 676e   polygon are ign
+0000c780: 6f72 6564 2e0d 0a20 2020 2020 2020 2022  ored...        "
+0000c790: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
+0000c7a0: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+0000c7b0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0000c7c0: 7428 2223 2320 4164 6469 6e67 2047 7269  t("## Adding Gri
+0000c7d0: 6420 2323 2229 0d0a 2020 2020 2020 2020  d ##")..        
+0000c7e0: 2323 2063 656c 6c20 6365 6e74 6572 7320  ## cell centers 
+0000c7f0: 2323 0d0a 2020 2020 2020 2020 7378 3d73  ##..        sx=s
+0000c800: 7061 6369 6e67 5b30 5d0d 0a20 2020 2020  pacing[0]..     
+0000c810: 2020 2073 793d 7370 6163 696e 675b 315d     sy=spacing[1]
+0000c820: 0d0a 2020 2020 2020 2020 737a 3d73 7061  ..        sz=spa
+0000c830: 6369 6e67 5b32 5d0d 0a0d 0a20 2020 2020  cing[2]....     
+0000c840: 2020 206e 783d 6469 6d65 6e73 696f 6e73     nx=dimensions
+0000c850: 5b30 5d0d 0a20 2020 2020 2020 206e 793d  [0]..        ny=
+0000c860: 6469 6d65 6e73 696f 6e73 5b31 5d0d 0a20  dimensions[1].. 
+0000c870: 2020 2020 2020 206e 7a3d 6469 6d65 6e73         nz=dimens
+0000c880: 696f 6e73 5b32 5d0d 0a0d 0a20 2020 2020  ions[2]....     
+0000c890: 2020 206f 783d 6f72 6967 696e 5b30 5d0d     ox=origin[0].
+0000c8a0: 0a20 2020 2020 2020 206f 793d 6f72 6967  .        oy=orig
+0000c8b0: 696e 5b31 5d0d 0a20 2020 2020 2020 206f  in[1]..        o
+0000c8c0: 7a3d 6f72 6967 696e 5b32 5d0d 0a0d 0a20  z=origin[2].... 
+0000c8d0: 2020 2020 2020 2078 673d 6e70 2e61 7261         xg=np.ara
+0000c8e0: 6e67 6528 6f78 2c20 6f78 2b6e 782a 7378  nge(ox, ox+nx*sx
+0000c8f0: 2b73 782c 2073 782c 2064 7479 7065 3d6e  +sx, sx, dtype=n
+0000c900: 702e 666c 6f61 7433 3229 0d0a 2020 2020  p.float32)..    
+0000c910: 2020 2020 7967 3d6e 702e 6172 616e 6765      yg=np.arange
+0000c920: 286f 792c 206f 792b 6e79 2a73 792b 7379  (oy, oy+ny*sy+sy
+0000c930: 2c20 7379 2c20 6474 7970 653d 6e70 2e66  , sy, dtype=np.f
+0000c940: 6c6f 6174 3332 290d 0a20 2020 2020 2020  loat32)..       
+0000c950: 207a 673d 6e70 2e61 7261 6e67 6528 6f7a   zg=np.arange(oz
+0000c960: 2c20 6f7a 2b6e 7a2a 737a 2b73 7a2c 2073  , oz+nz*sz+sz, s
+0000c970: 7a2c 2064 7479 7065 3d6e 702e 666c 6f61  z, dtype=np.floa
+0000c980: 7433 3229 0d0a 0d0a 2020 2020 2020 2020  t32)....        
+0000c990: 7867 633d 7867 5b3a 202d 315d 2b73 782f  xgc=xg[: -1]+sx/
+0000c9a0: 320d 0a20 2020 2020 2020 2079 6763 3d79  2..        ygc=y
+0000c9b0: 675b 3a20 2d31 5d2b 7379 2f32 0d0a 2020  g[: -1]+sy/2..  
+0000c9c0: 2020 2020 2020 7a67 633d 7a67 5b3a 202d        zgc=zg[: -
+0000c9d0: 315d 2b73 7a2f 320d 0a0d 0a20 2020 2020  1]+sz/2....     
+0000c9e0: 2020 2073 656c 662e 7378 3d73 780d 0a20     self.sx=sx.. 
+0000c9f0: 2020 2020 2020 2073 656c 662e 7379 3d73         self.sy=s
+0000ca00: 790d 0a20 2020 2020 2020 2073 656c 662e  y..        self.
+0000ca10: 737a 3d73 7a0d 0a0d 0a20 2020 2020 2020  sz=sz....       
+0000ca20: 2073 656c 662e 6e78 3d6e 780d 0a20 2020   self.nx=nx..   
+0000ca30: 2020 2020 2073 656c 662e 6e79 3d6e 790d       self.ny=ny.
+0000ca40: 0a20 2020 2020 2020 2073 656c 662e 6e7a  .        self.nz
+0000ca50: 3d6e 7a0d 0a0d 0a20 2020 2020 2020 2073  =nz....        s
+0000ca60: 656c 662e 6f78 3d6f 780d 0a20 2020 2020  elf.ox=ox..     
+0000ca70: 2020 2073 656c 662e 6f79 3d6f 790d 0a20     self.oy=oy.. 
+0000ca80: 2020 2020 2020 2073 656c 662e 6f7a 3d6f         self.oz=o
+0000ca90: 7a0d 0a0d 0a20 2020 2020 2020 2073 656c  z....        sel
+0000caa0: 662e 7867 3d78 670d 0a20 2020 2020 2020  f.xg=xg..       
+0000cab0: 2073 656c 662e 7967 3d79 670d 0a20 2020   self.yg=yg..   
+0000cac0: 2020 2020 2073 656c 662e 7a67 3d7a 670d       self.zg=zg.
+0000cad0: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+0000cae0: 7867 633d 7867 6320 2023 2078 675f 6365  xgc=xgc  # xg_ce
+0000caf0: 6c6c 5f63 656e 7465 7273 0d0a 2020 2020  ll_centers..    
+0000cb00: 2020 2020 7365 6c66 2e79 6763 3d79 6763      self.ygc=ygc
+0000cb10: 2020 2320 7967 5f63 656c 6c5f 6365 6e74    # yg_cell_cent
+0000cb20: 6572 730d 0a20 2020 2020 2020 2073 656c  ers..        sel
+0000cb30: 662e 7a67 633d 7a67 6320 2023 207a 675f  f.zgc=zgc  # zg_
+0000cb40: 6365 6c6c 5f63 656e 7465 7273 0d0a 0d0a  cell_centers....
+0000cb50: 2020 2020 2020 2020 7365 6c66 2e78 6365          self.xce
+0000cb60: 6c6c 6365 6e74 6572 732c 2073 656c 662e  llcenters, self.
+0000cb70: 7963 656c 6c63 656e 7465 7273 203d 206e  ycellcenters = n
+0000cb80: 702e 6d65 7368 6772 6964 2878 6763 2c20  p.meshgrid(xgc, 
+0000cb90: 7967 6329 2023 2063 656c 6c20 6365 6e74  ygc) # cell cent
+0000cba0: 6572 7320 636f 6f72 6469 6e61 7465 730d  ers coordinates.
+0000cbb0: 0a0d 0a20 2020 2020 2020 207a 5f74 7265  ...        z_tre
+0000cbc0: 653d 4b44 5472 6565 287a 672e 7265 7368  e=KDTree(zg.resh
+0000cbd0: 6170 6528 2d31 2c20 3129 290d 0a20 2020  ape(-1, 1))..   
+0000cbe0: 2020 2020 2073 656c 662e 7a5f 7472 6565       self.z_tree
+0000cbf0: 3d7a 5f74 7265 650d 0a20 2020 2020 2020  =z_tree..       
+0000cc00: 2073 656c 662e 7a63 5f74 7265 653d 4b44   self.zc_tree=KD
+0000cc10: 5472 6565 287a 6763 2e72 6573 6861 7065  Tree(zgc.reshape
+0000cc20: 282d 312c 2031 2929 0d0a 2020 2020 2020  (-1, 1))..      
+0000cc30: 2020 2320 7365 6c66 2e78 635f 7472 6565    # self.xc_tree
+0000cc40: 3d4b 4454 7265 6528 7867 632e 7265 7368  =KDTree(xgc.resh
+0000cc50: 6170 6528 2d31 2c20 3129 290d 0a20 2020  ape(-1, 1))..   
+0000cc60: 2020 2020 2023 2073 656c 662e 7963 5f74       # self.yc_t
+0000cc70: 7265 653d 4b44 5472 6565 2879 6763 2e72  ree=KDTree(ygc.r
+0000cc80: 6573 6861 7065 282d 312c 2031 2929 0d0a  eshape(-1, 1))..
+0000cc90: 0d0a 0d0a 2020 2020 2020 2020 2323 2072  ....        ## r
+0000cca0: 6573 616d 706c 6520 746f 7020 616e 6420  esample top and 
+0000ccb0: 626f 7420 6966 206e 6565 6465 640d 0a20  bot if needed.. 
+0000ccc0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000ccd0: 616e 6365 2874 6f70 2c20 7374 7229 206f  ance(top, str) o
+0000cce0: 7220 6973 696e 7374 616e 6365 2862 6f74  r isinstance(bot
+0000ccf0: 2c20 7374 7229 3a0d 0a0d 0a20 2020 2020  , str):....     
+0000cd00: 2020 2020 2020 2023 696d 706f 7274 2072         #import r
+0000cd10: 6173 7465 7269 6f0d 0a20 2020 2020 2020  asterio..       
+0000cd20: 2020 2020 2069 6d70 6f72 7420 7261 7374       import rast
+0000cd30: 6572 696f 0d0a 0d0a 2020 2020 2020 2020  erio....        
+0000cd40: 2020 2020 236f 7065 6e20 7261 7374 6572      #open raster
+0000cd50: 2061 6e64 2065 7874 7261 6374 2063 656c   and extract cel
+0000cd60: 6c20 6365 6e74 6572 730d 0a20 2020 2020  l centers..     
+0000cd70: 2020 2020 2020 2044 454d 3d72 6173 7465         DEM=raste
+0000cd80: 7269 6f2e 6f70 656e 2874 6f70 290d 0a20  rio.open(top).. 
+0000cd90: 2020 2020 2020 2020 2020 2078 302c 2079             x0, y
+0000cda0: 302c 2078 312c 2079 313d 4445 4d2e 626f  0, x1, y1=DEM.bo
+0000cdb0: 756e 6473 0d0a 2020 2020 2020 2020 2020  unds..          
+0000cdc0: 2020 7278 6c65 6e3d 4445 4d2e 7265 6164    rxlen=DEM.read
+0000cdd0: 2829 2e73 6861 7065 5b32 5d0d 0a20 2020  ().shape[2]..   
+0000cde0: 2020 2020 2020 2020 2072 796c 656e 3d44           rylen=D
+0000cdf0: 454d 2e72 6561 6428 292e 7368 6170 655b  EM.read().shape[
+0000ce00: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+0000ce10: 783d 6e70 2e6c 696e 7370 6163 6528 7830  x=np.linspace(x0
+0000ce20: 2c20 7831 2c20 7278 6c65 6e29 0d0a 2020  , x1, rxlen)..  
+0000ce30: 2020 2020 2020 2020 2020 793d 6e70 2e6c            y=np.l
+0000ce40: 696e 7370 6163 6528 7931 2c20 7930 2c20  inspace(y1, y0, 
+0000ce50: 7279 6c65 6e29 0d0a 2020 2020 2020 2020  rylen)..        
+0000ce60: 2020 2020 7278 632c 2072 7963 3d6e 702e      rxc, ryc=np.
+0000ce70: 6d65 7368 6772 6964 2878 2c20 7929 0d0a  meshgrid(x, y)..
+0000ce80: 0d0a 2020 2020 2020 2020 2020 2020 2374  ..            #t
+0000ce90: 616b 6520 6772 6964 2063 656c 6c20 6365  ake grid cell ce
+0000cea0: 6e74 6572 730d 0a20 2020 2020 2020 2020  nters..         
+0000ceb0: 2020 2078 633d 7365 6c66 2e78 6365 6c6c     xc=self.xcell
+0000cec0: 6365 6e74 6572 730d 0a20 2020 2020 2020  centers..       
+0000ced0: 2020 2020 2079 633d 7365 6c66 2e79 6365       yc=self.yce
+0000cee0: 6c6c 6365 6e74 6572 730d 0a0d 0a20 2020  llcenters....   
+0000cef0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0000cf00: 7374 616e 6365 2874 6f70 2c20 7374 7229  stance(top, str)
+0000cf10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000cf20: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0000cf30: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000cf40: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000cf50: 546f 7020 6973 2061 2072 6173 7465 7220  Top is a raster 
+0000cf60: 2d20 7265 7361 6d70 6c69 6e67 2061 6374  - resampling act
+0000cf70: 6976 6174 6564 2229 0d0a 2020 2020 2020  ivated")..      
+0000cf80: 2020 2020 2020 2020 2020 746f 703d 7265            top=re
+0000cf90: 7361 6d70 6c65 5f74 6f5f 6772 6964 2878  sample_to_grid(x
+0000cfa0: 632c 2079 632c 2072 7863 2c20 7279 632c  c, yc, rxc, ryc,
+0000cfb0: 2044 454d 2e72 6561 6428 295b 305d 2c20   DEM.read()[0], 
+0000cfc0: 6d65 7468 6f64 3d72 7370 6c5f 6d65 7468  method=rspl_meth
+0000cfd0: 6f64 2920 2023 2072 6573 616d 706c 696e  od)  # resamplin
+0000cfe0: 670d 0a0d 0a20 2020 2020 2020 2020 2020  g....           
+0000cff0: 2069 6620 6973 696e 7374 616e 6365 2862   if isinstance(b
+0000d000: 6f74 2c20 7374 7229 3a0d 0a20 2020 2020  ot, str):..     
+0000d010: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000d020: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+0000d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d040: 2070 7269 6e74 2822 426f 7420 6973 2061   print("Bot is a
+0000d050: 2072 6173 7465 7220 2d20 7265 7361 6d70   raster - resamp
+0000d060: 6c69 6e67 2061 6374 6976 6174 6564 2229  ling activated")
+0000d070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d080: 2020 7261 7374 3d72 6173 7465 7269 6f2e    rast=rasterio.
+0000d090: 6f70 656e 2862 6f74 290d 0a20 2020 2020  open(bot)..     
+0000d0a0: 2020 2020 2020 2020 2020 2078 302c 2079             x0, y
+0000d0b0: 302c 2078 312c 2079 313d 7261 7374 2e62  0, x1, y1=rast.b
+0000d0c0: 6f75 6e64 730d 0a20 2020 2020 2020 2020  ounds..         
+0000d0d0: 2020 2020 2020 2072 786c 656e 3d72 6173         rxlen=ras
+0000d0e0: 742e 7265 6164 2829 2e73 6861 7065 5b32  t.read().shape[2
+0000d0f0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0000d100: 2020 2072 796c 656e 3d72 6173 742e 7265     rylen=rast.re
+0000d110: 6164 2829 2e73 6861 7065 5b31 5d0d 0a20  ad().shape[1].. 
+0000d120: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+0000d130: 3d6e 702e 6c69 6e73 7061 6365 2878 302c  =np.linspace(x0,
+0000d140: 2078 312c 2072 786c 656e 290d 0a20 2020   x1, rxlen)..   
+0000d150: 2020 2020 2020 2020 2020 2020 2079 3d6e               y=n
+0000d160: 702e 6c69 6e73 7061 6365 2879 312c 2079  p.linspace(y1, y
+0000d170: 302c 2072 796c 656e 290d 0a20 2020 2020  0, rylen)..     
+0000d180: 2020 2020 2020 2020 2020 2072 7863 2c20             rxc, 
+0000d190: 7279 633d 6e70 2e6d 6573 6867 7269 6428  ryc=np.meshgrid(
+0000d1a0: 782c 2079 290d 0a20 2020 2020 2020 2020  x, y)..         
+0000d1b0: 2020 2020 2020 2062 6f74 3d72 6573 616d         bot=resam
+0000d1c0: 706c 655f 746f 5f67 7269 6428 7863 2c20  ple_to_grid(xc, 
+0000d1d0: 7963 2c20 7278 632c 2072 7963 2c20 7261  yc, rxc, ryc, ra
+0000d1e0: 7374 2e72 6561 6428 295b 305d 2c20 6d65  st.read()[0], me
+0000d1f0: 7468 6f64 3d72 7370 6c5f 6d65 7468 6f64  thod=rspl_method
+0000d200: 2920 2023 2072 6573 616d 706c 696e 670d  )  # resampling.
+0000d210: 0a0d 0a20 2020 2020 2020 2069 6620 746f  ...        if to
+0000d220: 7020 6973 206e 6f74 204e 6f6e 653a 0d0a  p is not None:..
+0000d230: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0000d240: 7274 2074 6f70 2e73 6861 7065 203d 3d20  rt top.shape == 
+0000d250: 286e 792c 206e 7829 2c20 2254 6f70 2073  (ny, nx), "Top s
+0000d260: 6861 7065 2069 7320 6e6f 7420 6164 6571  hape is not adeq
+0000d270: 7561 7420 7265 7370 6563 7469 7665 6c79  uat respectively
+0000d280: 2074 6f20 636f 6f72 6469 6e61 7465 2076   to coordinate v
+0000d290: 6563 746f 7273 2e20 5c6e 204d 7573 7420  ectors. \n Must 
+0000d2a0: 6265 2068 6176 6520 6120 7369 7a65 206f  be have a size o
+0000d2b0: 6620 2d31 2072 6573 7065 6374 6976 656c  f -1 respectivel
+0000d2c0: 7920 746f 2063 6f6f 7264 696e 6174 6520  y to coordinate 
+0000d2d0: 7665 6374 6f72 7320 7867 2061 6e64 2079  vectors xg and y
+0000d2e0: 6720 2877 6869 6368 2061 7265 2074 6865  g (which are the
+0000d2f0: 2076 6563 746f 7273 206f 6620 6564 6765   vectors of edge
+0000d300: 2063 656c 6c73 2922 0d0a 2020 2020 2020   cells)"..      
+0000d310: 2020 6966 2062 6f74 2069 7320 6e6f 7420    if bot is not 
+0000d320: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0000d330: 2020 2061 7373 6572 7420 626f 742e 7368     assert bot.sh
+0000d340: 6170 6520 3d3d 2028 6e79 2c20 6e78 292c  ape == (ny, nx),
+0000d350: 2022 426f 7420 7368 6170 6520 6973 206e   "Bot shape is n
+0000d360: 6f74 2061 6465 7175 6174 2072 6573 7065  ot adequat respe
+0000d370: 6374 6976 656c 7920 746f 2063 6f6f 7264  ctively to coord
+0000d380: 696e 6174 6520 7665 6374 6f72 732e 205c  inate vectors. \
+0000d390: 6e20 4d75 7374 2062 6520 6861 7665 2061  n Must be have a
+0000d3a0: 2073 697a 6520 6f66 202d 3120 7265 7370   size of -1 resp
+0000d3b0: 6563 7469 7665 6c79 2074 6f20 636f 6f72  ectively to coor
+0000d3c0: 6469 6e61 7465 2076 6563 746f 7273 2078  dinate vectors x
+0000d3d0: 6720 616e 6420 7967 2028 7768 6963 6820  g and yg (which 
+0000d3e0: 6172 6520 7468 6520 7665 6374 6f72 7320  are the vectors 
+0000d3f0: 6f66 2065 6467 6520 6365 6c6c 7329 220d  of edge cells)".
+0000d400: 0a0d 0a20 2020 2020 2020 2023 6465 6669  ...        #defi
+0000d410: 6e65 2074 6f70 2f62 6f74 0d0a 2020 2020  ne top/bot..    
+0000d420: 2020 2020 6966 2028 746f 7020 6973 204e      if (top is N
+0000d430: 6f6e 6529 2061 6e64 2028 6d61 736b 2069  one) and (mask i
+0000d440: 7320 4e6f 6e65 293a 0d0a 2020 2020 2020  s None):..      
+0000d450: 2020 2020 2020 746f 703d 6e70 2e6f 6e65        top=np.one
+0000d460: 7328 5b6e 792c 206e 785d 2c20 6474 7970  s([ny, nx], dtyp
+0000d470: 653d 6e70 2e66 6c6f 6174 3332 292a 6e70  e=np.float32)*np
+0000d480: 2e6d 6178 287a 6729 0d0a 0d0a 2020 2020  .max(zg)....    
+0000d490: 2020 2020 656c 6966 2028 746f 7020 6973      elif (top is
+0000d4a0: 204e 6f6e 6529 2061 6e64 2028 6d61 736b   None) and (mask
+0000d4b0: 2069 7320 6e6f 7420 4e6f 6e65 293a 2020   is not None):  
+0000d4c0: 2320 6966 206d 6173 6b20 6973 2070 726f  # if mask is pro
+0000d4d0: 7669 6465 6420 6275 7420 6e6f 7420 746f  vided but not to
+0000d4e0: 700d 0a20 2020 2020 2020 2020 2020 2074  p..            t
+0000d4f0: 6f70 203d 6e70 2e7a 6572 6f73 285b 6e79  op =np.zeros([ny
+0000d500: 2c20 6e78 5d2c 2064 7479 7065 3d6e 702e  , nx], dtype=np.
+0000d510: 666c 6f61 7433 3229 2a6e 702e 6e61 6e0d  float32)*np.nan.
+0000d520: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000d530: 2069 7820 696e 2072 616e 6765 286e 7829   ix in range(nx)
+0000d540: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000d550: 2020 2066 6f72 2069 7920 696e 2072 616e     for iy in ran
+0000d560: 6765 286e 7929 3a0d 0a20 2020 2020 2020  ge(ny):..       
+0000d570: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000d580: 2069 7a20 696e 2072 616e 6765 286e 7a2d   iz in range(nz-
+0000d590: 312c 202d 312c 202d 3129 3a0d 0a20 2020  1, -1, -1):..   
+0000d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5b0: 2020 2020 2069 6620 6d61 736b 5b69 7a2c       if mask[iz,
+0000d5c0: 2069 792c 2069 785d 3a0d 0a20 2020 2020   iy, ix]:..     
+0000d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5e0: 2020 2020 2020 2074 6f70 5b69 792c 2069         top[iy, i
+0000d5f0: 785d 3d7a 6763 5b69 7a5d 0d0a 2020 2020  x]=zgc[iz]..    
+0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d610: 2020 2020 2020 2020 6272 6561 6b0d 0a0d          break...
+0000d620: 0a20 2020 2020 2020 2023 2063 7574 2074  .        # cut t
+0000d630: 6f70 0d0a 2020 2020 2020 2020 746f 705b  op..        top[
+0000d640: 746f 703e 7a67 5b2d 315d 5d3d 7a67 5b2d  top>zg[-1]]=zg[-
+0000d650: 315d 0d0a 2020 2020 2020 2020 746f 705b  1]..        top[
+0000d660: 746f 703c 7a67 5b30 5d5d 3d7a 675b 305d  top<zg[0]]=zg[0]
+0000d670: 0d0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+0000d680: 6f70 3d74 6f70 2e61 7374 7970 6528 6e70  op=top.astype(np
+0000d690: 2e66 6c6f 6174 3332 290d 0a0d 0a20 2020  .float32)....   
+0000d6a0: 2020 2020 2069 6620 2862 6f74 2069 7320       if (bot is 
+0000d6b0: 4e6f 6e65 2920 616e 6420 286d 6173 6b20  None) and (mask 
+0000d6c0: 6973 204e 6f6e 6529 3a0d 0a20 2020 2020  is None):..     
+0000d6d0: 2020 2020 2020 2062 6f74 3d6e 702e 6f6e         bot=np.on
+0000d6e0: 6573 285b 6e79 2c20 6e78 5d2c 2064 7479  es([ny, nx], dty
+0000d6f0: 7065 3d6e 702e 666c 6f61 7433 3229 2a6e  pe=np.float32)*n
+0000d700: 702e 6d69 6e28 7a67 290d 0a0d 0a20 2020  p.min(zg)....   
+0000d710: 2020 2020 2065 6c69 6620 2862 6f74 2069       elif (bot i
+0000d720: 7320 4e6f 6e65 2920 616e 6420 286d 6173  s None) and (mas
+0000d730: 6b20 6973 206e 6f74 204e 6f6e 6529 3a20  k is not None): 
+0000d740: 2023 2069 6620 6d61 736b 2069 7320 7072   # if mask is pr
+0000d750: 6f76 6964 6564 2062 7574 206e 6f74 2074  ovided but not t
+0000d760: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
+0000d770: 626f 7420 3d6e 702e 7a65 726f 7328 5b6e  bot =np.zeros([n
+0000d780: 792c 206e 785d 2c20 6474 7970 653d 6e70  y, nx], dtype=np
+0000d790: 2e66 6c6f 6174 3332 292a 6e70 2e6e 616e  .float32)*np.nan
+0000d7a0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+0000d7b0: 7220 6978 2069 6e20 7261 6e67 6528 6e78  r ix in range(nx
+0000d7c0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000d7d0: 2020 2020 666f 7220 6979 2069 6e20 7261      for iy in ra
+0000d7e0: 6e67 6528 6e79 293a 0d0a 2020 2020 2020  nge(ny):..      
+0000d7f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000d800: 7220 697a 2069 6e20 7261 6e67 6528 6e7a  r iz in range(nz
+0000d810: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000d820: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0000d830: 6173 6b5b 697a 2c20 6979 2c20 6978 5d3a  ask[iz, iy, ix]:
+0000d840: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000d850: 2020 2020 2020 2020 2020 2020 2020 626f                bo
+0000d860: 745b 6979 2c20 6978 5d3d 7a67 635b 697a  t[iy, ix]=zgc[iz
+0000d870: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0000d880: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000d890: 7265 616b 0d0a 2020 2020 2020 2020 2320  reak..        # 
+0000d8a0: 6375 7420 626f 740d 0a20 2020 2020 2020  cut bot..       
+0000d8b0: 2062 6f74 5b62 6f74 3e7a 675b 2d31 5d5d   bot[bot>zg[-1]]
+0000d8c0: 3d7a 675b 2d31 5d0d 0a20 2020 2020 2020  =zg[-1]..       
+0000d8d0: 2062 6f74 5b62 6f74 3c7a 675b 305d 5d3d   bot[bot<zg[0]]=
+0000d8e0: 7a67 5b30 5d0d 0a20 2020 2020 2020 2073  zg[0]..        s
+0000d8f0: 656c 662e 626f 743d 626f 742e 6173 7479  elf.bot=bot.asty
+0000d900: 7065 286e 702e 666c 6f61 7433 3229 0d0a  pe(np.float32)..
+0000d910: 0d0a 2020 2020 2020 2020 2320 6372 6561  ..        # crea
+0000d920: 7465 206d 6173 6b20 6672 6f6d 2074 6f70  te mask from top
+0000d930: 2061 6e64 2062 6f74 2069 6620 6e6f 6e65   and bot if none
+0000d940: 0d0a 2020 2020 2020 2020 6966 206d 6173  ..        if mas
+0000d950: 6b20 6973 204e 6f6e 653a 0d0a 2020 2020  k is None:..    
+0000d960: 2020 2020 2020 2020 6d61 736b 3d6e 702e          mask=np.
+0000d970: 7a65 726f 7328 5b6e 7a2c 206e 792c 206e  zeros([nz, ny, n
+0000d980: 785d 2c20 6474 7970 653d 626f 6f6c 290d  x], dtype=bool).
+0000d990: 0a20 2020 2020 2020 2020 2020 2069 753d  .            iu=
+0000d9a0: 7a5f 7472 6565 2e71 7565 7279 2874 6f70  z_tree.query(top
+0000d9b0: 2e72 6573 6861 7065 282d 312c 2031 292c  .reshape(-1, 1),
+0000d9c0: 2072 6574 7572 6e5f 6469 7374 616e 6365   return_distance
+0000d9d0: 3d46 616c 7365 292e 7265 7368 6170 6528  =False).reshape(
+0000d9e0: 6e79 2c20 6e78 290d 0a20 2020 2020 2020  ny, nx)..       
+0000d9f0: 2020 2020 2069 6c3d 7a5f 7472 6565 2e71       il=z_tree.q
+0000da00: 7565 7279 2862 6f74 2e72 6573 6861 7065  uery(bot.reshape
+0000da10: 282d 312c 2031 292c 2072 6574 7572 6e5f  (-1, 1), return_
+0000da20: 6469 7374 616e 6365 3d46 616c 7365 292e  distance=False).
+0000da30: 7265 7368 6170 6528 6e79 2c20 6e78 290d  reshape(ny, nx).
+0000da40: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
+0000da50: 6f72 2069 7820 696e 2072 616e 6765 286c  or ix in range(l
+0000da60: 656e 2878 6763 2929 3a0d 0a20 2020 2020  en(xgc)):..     
+0000da70: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0000da80: 7920 696e 2072 616e 6765 286c 656e 2879  y in range(len(y
+0000da90: 6763 2929 3a0d 0a20 2020 2020 2020 2020  gc)):..         
+0000daa0: 2020 2020 2020 2020 2020 206d 6173 6b5b             mask[
+0000dab0: 696c 5b69 792c 2069 785d 3a20 6975 5b69  il[iy, ix]: iu[i
+0000dac0: 792c 2069 785d 2c20 6979 2c20 6978 5d3d  y, ix], iy, ix]=
+0000dad0: 310d 0a0d 0a20 2020 2020 2020 2023 206c  1....        # l
+0000dae0: 6973 7420 6f66 2063 6f6f 7264 696e 6174  ist of coordinat
+0000daf0: 6573 2032 4420 616e 6420 3344 0d0a 2020  es 2D and 3D..  
+0000db00: 2020 2020 2020 582c 2059 3d6e 702e 6d65        X, Y=np.me
+0000db10: 7368 6772 6964 2878 6763 2c20 7967 6329  shgrid(xgc, ygc)
+0000db20: 0d0a 2020 2020 2020 2020 7365 6c66 2e78  ..        self.x
+0000db30: 7532 443d 6e70 2e61 7272 6179 285b 582e  u2D=np.array([X.
+0000db40: 666c 6174 7465 6e28 292c 2059 2e66 6c61  flatten(), Y.fla
+0000db50: 7474 656e 2829 5d2c 2064 7479 7065 3d6e  tten()], dtype=n
+0000db60: 702e 666c 6f61 7433 3229 2e54 0d0a 0d0a  p.float32).T....
+0000db70: 2020 2020 2020 2020 2358 2c20 592c 205a          #X, Y, Z
+0000db80: 3d6e 702e 6d65 7368 6772 6964 2878 6763  =np.meshgrid(xgc
+0000db90: 2c20 7967 632c 207a 6763 290d 0a20 2020  , ygc, zgc)..   
+0000dba0: 2020 2020 2023 7365 6c66 2e78 7533 443d       #self.xu3D=
+0000dbb0: 6e70 2e61 7272 6179 285b 582e 666c 6174  np.array([X.flat
+0000dbc0: 7465 6e28 292c 2059 2e66 6c61 7474 656e  ten(), Y.flatten
+0000dbd0: 2829 2c20 5a2e 666c 6174 7465 6e28 295d  (), Z.flatten()]
+0000dbe0: 292e 540d 0a0d 0a20 2020 2020 2020 2023  ).T....        #
+0000dbf0: 6170 706c 7920 706f 6c79 676f 6e0d 0a0d  apply polygon...
+0000dc00: 0a20 2020 2020 2020 2023 2069 6620 706f  .        # if po
+0000dc10: 6c79 676f 6e20 6973 2061 2073 6861 7065  lygon is a shape
+0000dc20: 6669 6c65 0d0a 2020 2020 2020 2020 6966  file..        if
+0000dc30: 2069 7369 6e73 7461 6e63 6528 706f 6c79   isinstance(poly
+0000dc40: 676f 6e2c 2073 7472 293a 2020 2320 6966  gon, str):  # if
+0000dc50: 2070 6f6c 7967 6f6e 2069 7320 6120 7368   polygon is a sh
+0000dc60: 6170 6566 696c 650d 0a20 2020 2020 2020  apefile..       
+0000dc70: 2020 2020 2069 6d70 6f72 7420 7368 6170       import shap
+0000dc80: 656c 790d 0a20 2020 2020 2020 2020 2020  ely..           
+0000dc90: 2066 726f 6d20 7368 6170 656c 792e 6765   from shapely.ge
+0000dca0: 6f6d 6574 7279 2069 6d70 6f72 7420 506f  ometry import Po
+0000dcb0: 6c79 676f 6e2c 204d 756c 7469 506f 6c79  lygon, MultiPoly
+0000dcc0: 676f 6e0d 0a0d 0a20 2020 2020 2020 2020  gon....         
+0000dcd0: 2020 2069 6620 706f 6c79 676f 6e2e 7370     if polygon.sp
+0000dce0: 6c69 7428 222e 2229 5b2d 315d 203d 3d20  lit(".")[-1] == 
+0000dcf0: 2273 6870 223a 0d0a 2020 2020 2020 2020  "shp":..        
+0000dd00: 2020 2020 2020 2020 696d 706f 7274 2067          import g
+0000dd10: 656f 7061 6e64 6173 2061 7320 6770 200d  eopandas as gp .
+0000dd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dd30: 2070 6f6c 7920 3d20 6770 2e72 6561 645f   poly = gp.read_
+0000dd40: 6669 6c65 2870 6f6c 7967 6f6e 290d 0a20  file(polygon).. 
+0000dd50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000dd60: 6620 706f 6c79 2e73 6861 7065 5b30 5d20  f poly.shape[0] 
+0000dd70: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+0000dd80: 2020 2020 2020 2020 2020 2070 6f6c 7967             polyg
+0000dd90: 6f6e 203d 2050 6f6c 7967 6f6e 2870 6f6c  on = Polygon(pol
+0000dda0: 792e 6765 6f6d 6574 7279 2e69 6c6f 635b  y.geometry.iloc[
+0000ddb0: 305d 290d 0a20 2020 2020 2020 2020 2020  0])..           
+0000ddc0: 2020 2020 2065 6c69 6620 706f 6c79 2e73       elif poly.s
+0000ddd0: 6861 7065 5b30 5d20 3e20 313a 0d0a 2020  hape[0] > 1:..  
+0000dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ddf0: 2020 706f 6c79 676f 6e20 3d20 4d75 6c74    polygon = Mult
+0000de00: 6950 6f6c 7967 6f6e 2870 6f6c 792e 6765  iPolygon(poly.ge
+0000de10: 6f6d 6574 7279 2e76 616c 7565 7329 0d0a  ometry.values)..
+0000de20: 0d0a 2020 2020 2020 2020 696d 706f 7274  ..        import
+0000de30: 2073 6861 7065 6c79 0d0a 2020 2020 2020   shapely..      
+0000de40: 2020 2320 6966 2070 6f6c 7967 6f6e 2069    # if polygon i
+0000de50: 7320 7368 6170 656c 7920 506f 6c79 676f  s shapely Polygo
+0000de60: 6e0d 0a20 2020 2020 2020 2069 6620 6973  n..        if is
+0000de70: 696e 7374 616e 6365 2870 6f6c 7967 6f6e  instance(polygon
+0000de80: 2c20 2873 6861 7065 6c79 2e67 656f 6d65  , (shapely.geome
+0000de90: 7472 792e 506f 6c79 676f 6e2c 2073 6861  try.Polygon, sha
+0000dea0: 7065 6c79 2e67 656f 6d65 7472 792e 4d75  pely.geometry.Mu
+0000deb0: 6c74 6950 6f6c 7967 6f6e 2929 3a0d 0a20  ltiPolygon)):.. 
+0000dec0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000ded0: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+0000dee0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0000def0: 6e74 2822 506f 6c79 676f 6e20 6973 2061  nt("Polygon is a
+0000df00: 2073 6861 7065 6c79 2069 6e73 7461 6e63   shapely instanc
+0000df10: 6520 2d20 6469 7363 7265 7469 7a61 7469  e - discretizati
+0000df20: 6f6e 2061 6374 6976 6174 6564 2229 0d0a  on activated")..
+0000df30: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+0000df40: 6c79 676f 6e5f 6172 7261 793d 6e70 2e7a  lygon_array=np.z
+0000df50: 6572 6f73 285b 6e79 2a6e 785d 2c20 6474  eros([ny*nx], dt
+0000df60: 7970 653d 626f 6f6c 2920 2023 2032 4420  ype=bool)  # 2D 
+0000df70: 6172 7261 7920 7369 6d75 6c61 7469 6f6e  array simulation
+0000df80: 2064 6f6d 6169 6e0d 0a20 2020 2020 2020   domain..       
+0000df90: 2020 2020 2063 656c 6c5f 6c20 3d20 5b5d       cell_l = []
+0000dfa0: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+0000dfb0: 6c6c 5f6e 616d 6520 3d20 5b5d 0d0a 2020  ll_name = []..  
+0000dfc0: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+0000dfd0: 6365 6c6c 2069 6e20 656e 756d 6572 6174  cell in enumerat
+0000dfe0: 6528 7365 6c66 2e78 7532 4429 3a0d 0a0d  e(self.xu2D):...
+0000dff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e000: 2078 7920 3d20 2828 6365 6c6c 5b30 5d2d   xy = ((cell[0]-
+0000e010: 7378 2f32 2c20 6365 6c6c 5b31 5d2d 7379  sx/2, cell[1]-sy
+0000e020: 2f32 292c 2863 656c 6c5b 305d 2d73 782f  /2),(cell[0]-sx/
+0000e030: 322c 2063 656c 6c5b 315d 2b73 792f 3229  2, cell[1]+sy/2)
+0000e040: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000e050: 2020 2020 2020 2020 2028 6365 6c6c 5b30           (cell[0
+0000e060: 5d2b 7378 2f32 2c20 6365 6c6c 5b31 5d2b  ]+sx/2, cell[1]+
+0000e070: 7379 2f32 292c 2863 656c 6c5b 305d 2b73  sy/2),(cell[0]+s
+0000e080: 782f 322c 2063 656c 6c5b 315d 2d73 792f  x/2, cell[1]-sy/
+0000e090: 3229 290d 0a20 2020 2020 2020 2020 2020  2))..           
+0000e0a0: 2020 2020 2070 203d 2073 6861 7065 6c79       p = shapely
+0000e0b0: 2e67 656f 6d65 7472 792e 506f 6c79 676f  .geometry.Polygo
+0000e0c0: 6e28 7879 290d 0a20 2020 2020 2020 2020  n(xy)..         
+0000e0d0: 2020 2020 2020 2063 656c 6c5f 6e61 6d65         cell_name
+0000e0e0: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
+0000e0f0: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+0000e100: 5f6c 2e61 7070 656e 6428 7029 0d0a 0d0a  _l.append(p)....
+0000e110: 2020 2020 2020 2020 2020 2020 6c3d 5b5d              l=[]
+0000e120: 2020 2320 6c69 7374 206f 6620 696e 7465    # list of inte
+0000e130: 7273 6563 7465 6420 6365 6c6c 730d 0a20  rsected cells.. 
+0000e140: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+0000e150: 6365 6c6c 2c20 6365 6c6c 2069 6e20 656e  cell, cell in en
+0000e160: 756d 6572 6174 6528 6365 6c6c 5f6c 293a  umerate(cell_l):
+0000e170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e180: 2020 6966 2063 656c 6c2e 696e 7465 7273    if cell.inters
+0000e190: 6563 7473 2870 6f6c 7967 6f6e 293a 0d0a  ects(polygon):..
+0000e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1b0: 2020 2020 6c2e 6170 7065 6e64 2863 656c      l.append(cel
+0000e1c0: 6c5f 6e61 6d65 5b69 6365 6c6c 5d29 0d0a  l_name[icell])..
+0000e1d0: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
+0000e1e0: 676f 6e5f 6172 7261 795b 6e70 2e61 7272  gon_array[np.arr
+0000e1f0: 6179 286c 295d 3d31 0d0a 2020 2020 2020  ay(l)]=1..      
+0000e200: 2020 2020 2020 706f 6c79 676f 6e3d 706f        polygon=po
+0000e210: 6c79 676f 6e5f 6172 7261 792e 7265 7368  lygon_array.resh
+0000e220: 6170 6528 6e79 2c20 6e78 290d 0a0d 0a20  ape(ny, nx).... 
+0000e230: 2020 2020 2020 2069 6620 706f 6c79 676f         if polygo
+0000e240: 6e20 6973 206e 6f74 204e 6f6e 653a 0d0a  n is not None:..
+0000e250: 2020 2020 2020 2020 2020 2020 706f 6c79              poly
+0000e260: 676f 6e3d 706f 6c79 676f 6e2e 6173 7479  gon=polygon.asty
+0000e270: 7065 2862 6f6f 6c29 2023 656e 7375 7265  pe(bool) #ensure
+0000e280: 2070 6f6c 7967 6f6e 2069 7320 6120 626f   polygon is a bo
+0000e290: 6f6c 6561 6e20 6172 7261 790d 0a20 2020  olean array..   
+0000e2a0: 2020 2020 2020 2020 2066 6f72 2069 7820           for ix 
+0000e2b0: 696e 2072 616e 6765 286e 7829 3a0d 0a20  in range(nx):.. 
+0000e2c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000e2d0: 6f72 2069 7920 696e 2072 616e 6765 286e  or iy in range(n
+0000e2e0: 7929 3a0d 0a20 2020 2020 2020 2020 2020  y):..           
+0000e2f0: 2020 2020 2020 2020 2069 6620 7e70 6f6c           if ~pol
+0000e300: 7967 6f6e 5b69 792c 2069 785d 3a0d 0a20  ygon[iy, ix]:.. 
+0000e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e320: 2020 2020 2020 206d 6173 6b5b 3a2c 2069         mask[:, i
+0000e330: 792c 2069 785d 3d30 0d0a 0d0a 2020 2020  y, ix]=0....    
+0000e340: 2020 2020 7365 6c66 2e6d 6173 6b3d 6d61      self.mask=ma
+0000e350: 736b 0d0a 2020 2020 2020 2020 7365 6c66  sk..        self
+0000e360: 2e6d 6173 6b32 6420 3d20 6d61 736b 2e61  .mask2d = mask.a
+0000e370: 6e79 2830 290d 0a0d 0a20 2020 2020 2020  ny(0)....       
+0000e380: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0000e390: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0000e3a0: 7269 6e74 2822 2323 2047 7269 6420 6164  rint("## Grid ad
+0000e3b0: 6465 6420 616e 6420 6973 206e 6f77 2073  ded and is now s
+0000e3c0: 696d 756c 6174 696f 6e20 6772 6964 2023  imulation grid #
+0000e3d0: 2322 290d 0a0d 0a0d 0a20 2020 2064 6566  #")......    def
+0000e3e0: 2068 6965 7261 7263 6879 5f72 656c 6174   hierarchy_relat
+0000e3f0: 696f 6e73 2873 656c 662c 2076 623d 3129  ions(self, vb=1)
+0000e400: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+0000e410: 4d65 7468 6f64 2074 6861 7420 7365 7473  Method that sets
+0000e420: 2074 6865 2068 6965 7261 7263 6869 6361   the hierarchica
+0000e430: 6c20 7265 6c61 7469 6f6e 7320 6265 7477  l relations betw
+0000e440: 6565 6e20 756e 6974 730d 0a20 2020 2020  een units..     
+0000e450: 2020 2061 6e64 2073 7562 2d75 6e69 7473     and sub-units
+0000e460: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+0000e470: 0a20 2020 2020 2020 2064 6566 2068 5f72  .        def h_r
+0000e480: 656c 6174 696f 6e73 2870 696c 6529 3a0d  elations(pile):.
+0000e490: 0a20 2020 2020 2020 2020 2020 2022 2222  .            """
+0000e4a0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000e4b0: 6361 6c63 756c 6174 6520 6d75 6d6d 7920  calculate mummy 
+0000e4c0: 756e 6974 2066 6f72 2065 6163 6820 7375  unit for each su
+0000e4d0: 6220 756e 6974 2028 746f 2077 6869 6368  b unit (to which
+0000e4e0: 2075 6e69 7420 6120 7375 622d 756e 6974   unit a sub-unit
+0000e4f0: 2069 7320 7265 6c61 7465 6429 0d0a 2020   is related)..  
+0000e500: 2020 2020 2020 2020 2020 2222 220d 0a20            """.. 
+0000e510: 2020 2020 2020 2020 2020 2066 6f72 2073             for s
+0000e520: 2069 6e20 7069 6c65 2e6c 6973 745f 756e   in pile.list_un
+0000e530: 6974 733a 2023 206c 6f6f 7020 6f76 6572  its: # loop over
+0000e540: 2075 6e69 7473 206f 6620 7468 6520 6d61   units of the ma
+0000e550: 7374 6572 2070 696c 650d 0a20 2020 2020  ster pile..     
+0000e560: 2020 2020 2020 2020 2020 2069 6620 732e             if s.
+0000e570: 665f 6d65 7468 6f64 203d 3d20 2253 7562  f_method == "Sub
+0000e580: 5069 6c65 223a 0d0a 2020 2020 2020 2020  Pile":..        
+0000e590: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+0000e5a0: 7373 7562 2069 6e20 732e 5375 6250 696c  ssub in s.SubPil
+0000e5b0: 652e 6c69 7374 5f75 6e69 7473 3a20 2320  e.list_units: # 
+0000e5c0: 6c6f 6f70 206f 7665 7220 756e 6974 7320  loop over units 
+0000e5d0: 6f66 2074 6865 2073 7562 2070 696c 6520  of the sub pile 
+0000e5e0: 6966 2066 696c 6c69 6e67 206d 6574 686f  if filling metho
+0000e5f0: 6420 6973 2053 7562 5069 6c65 0d0a 2020  d is SubPile..  
+0000e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e610: 2020 2020 2020 7373 7562 2e6d 756d 6d79        ssub.mummy
+0000e620: 5f75 6e69 743d 730d 0a20 2020 2020 2020  _unit=s..       
+0000e630: 2020 2020 2020 2020 2020 2020 2068 5f72               h_r
+0000e640: 656c 6174 696f 6e73 2873 2e53 7562 5069  elations(s.SubPi
+0000e650: 6c65 290d 0a0d 0a20 2020 2020 2020 2068  le)....        h
+0000e660: 5f72 656c 6174 696f 6e73 2873 656c 662e  _relations(self.
+0000e670: 6765 745f 7069 6c65 5f6d 6173 7465 7228  get_pile_master(
+0000e680: 2929 0d0a 0d0a 2020 2020 2020 2020 2373  ))....        #s
+0000e690: 6574 2062 6220 756e 6974 730d 0a20 2020  et bb units..   
+0000e6a0: 2020 2020 2066 6f72 2075 6e69 7420 696e       for unit in
+0000e6b0: 2073 656c 662e 6765 745f 616c 6c5f 756e   self.get_all_un
+0000e6c0: 6974 7328 293a 0d0a 2020 2020 2020 2020  its():..        
+0000e6d0: 2020 2020 756e 6974 2e67 6574 5f62 6162      unit.get_bab
+0000e6e0: 795f 756e 6974 7328 7265 636f 6d70 7574  y_units(recomput
+0000e6f0: 653d 5472 7565 2c20 7662 3d30 290d 0a0d  e=True, vb=0)...
+0000e700: 0a20 2020 2020 2020 2069 6620 7662 3a0d  .        if vb:.
+0000e710: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0000e720: 6e74 2822 6869 6572 6172 6368 6963 616c  nt("hierarchical
+0000e730: 2072 656c 6174 696f 6e73 2073 6574 2229   relations set")
+0000e740: 0d0a 0d0a 0d0a 2020 2020 6465 6620 6368  ......    def ch
+0000e750: 6563 6b5f 6268 5f69 6e73 6964 6528 7365  eck_bh_inside(se
+0000e760: 6c66 2c20 6268 293a 0d0a 0d0a 2020 2020  lf, bh):....    
+0000e770: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0000e780: 2043 6865 636b 2069 6620 6120 626f 7265   Check if a bore
+0000e790: 686f 6c65 2069 7320 696e 7369 6465 2074  hole is inside t
+0000e7a0: 6865 2073 696d 756c 6174 696f 6e20 646f  he simulation do
+0000e7b0: 6d61 696e 0d0a 2020 2020 2020 2020 616e  main..        an
+0000e7c0: 6420 6375 7420 626f 7265 686f 6c65 7320  d cut boreholes 
+0000e7d0: 6966 206e 6565 6465 640d 0a0d 0a20 2020  if needed....   
+0000e7e0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0000e7f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000e800: 2d2d 2d0d 0a20 2020 2020 2020 2062 683a  ---..        bh:
+0000e810: 203a 636c 6173 733a 6042 6f72 6568 6f6c   :class:`Borehol
+0000e820: 6560 0d0a 2020 2020 2020 2020 2020 2020  e`..            
+0000e830: 626f 7265 686f 6c65 206f 626a 6563 740d  borehole object.
+0000e840: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+0000e850: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+0000e860: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+0000e870: 2020 2020 2030 2069 6620 626f 7265 686f       0 if boreho
+0000e880: 6c65 2069 7320 6f75 7473 6964 6520 7468  le is outside th
+0000e890: 6520 7369 6d75 6c61 7469 6f6e 2064 6f6d  e simulation dom
+0000e8a0: 6169 6e0d 0a20 2020 2020 2020 2031 2069  ain..        1 i
+0000e8b0: 6620 626f 7265 686f 6c65 2069 7320 696e  f borehole is in
+0000e8c0: 7369 6465 2074 6865 2073 696d 756c 6174  side the simulat
+0000e8d0: 696f 6e20 646f 6d61 696e 0d0a 2020 2020  ion domain..    
+0000e8e0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+0000e8f0: 2020 2069 6620 6268 2e64 6570 7468 203c     if bh.depth <
+0000e900: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+0000e910: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+0000e920: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0000e930: 2020 2020 7072 696e 7428 2262 6f72 6568      print("boreh
+0000e940: 6f6c 6520 6465 7074 6820 6973 206e 6f74  ole depth is not
+0000e950: 2070 6f73 6974 6976 6522 290d 0a20 2020   positive")..   
+0000e960: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000e970: 300d 0a0d 0a0d 0a20 2020 2020 2020 2023  0......        #
+0000e980: 6675 6e20 746f 2063 6865 636b 2062 6f74  fun to check bot
+0000e990: 6f6d 0d0a 2020 2020 2020 2020 6465 6620  om..        def 
+0000e9a0: 6375 745f 626f 746f 6d28 6268 293a 0d0a  cut_botom(bh):..
+0000e9b0: 2020 2020 2020 2020 2020 2020 7a30 5f62              z0_b
+0000e9c0: 683d 6268 2e7a 0d0a 2020 2020 2020 2020  h=bh.z..        
+0000e9d0: 2020 2020 7a62 6f74 5f62 683d 7a30 5f62      zbot_bh=z0_b
+0000e9e0: 6820 2d20 6268 2e64 6570 7468 0d0a 0d0a  h - bh.depth....
+0000e9f0: 2020 2020 2020 2020 2020 2020 626f 745f              bot_
+0000ea00: 7a20 3d20 7365 6c66 2e62 6f74 5b73 656c  z = self.bot[sel
+0000ea10: 662e 636f 6f72 6432 6365 6c6c 2862 682e  f.coord2cell(bh.
+0000ea20: 782c 2062 682e 7929 5d0d 0a20 2020 2020  x, bh.y)]..     
+0000ea30: 2020 2020 2020 2023 2069 6620 287a 626f         # if (zbo
+0000ea40: 745f 6268 203c 207a 675b 305d 293a 2020  t_bh < zg[0]):  
+0000ea50: 2320 6d6f 6469 6669 6361 7469 6f6e 2074  # modification t
+0000ea60: 6f20 6375 7420 6265 6c6f 7720 626f 7420  o cut below bot 
+0000ea70: 616e 6420 6e6f 7420 6265 6c6f 7720 7369  and not below si
+0000ea80: 6d75 6c61 7469 6f6e 2067 7269 640d 0a20  mulation grid.. 
+0000ea90: 2020 2020 2020 2020 2020 2069 6620 287a             if (z
+0000eaa0: 626f 745f 6268 203c 2062 6f74 5f7a 293a  bot_bh < bot_z):
+0000eab0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000eac0: 2020 6268 2e64 6570 7468 3d28 7a30 5f62    bh.depth=(z0_b
+0000ead0: 6820 2d20 626f 745f 7a29 202d 2073 7a2f  h - bot_z) - sz/
+0000eae0: 320d 0a20 2020 2020 2020 2020 2020 2020  2..             
+0000eaf0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0000eb00: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000eb10: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0000eb20: 426f 7265 686f 6c65 207b 7d20 676f 6573  Borehole {} goes
+0000eb30: 2062 656c 6f77 206d 6f64 656c 206c 696d   below model lim
+0000eb40: 6974 732c 2062 6f72 6568 6f6c 6520 7b7d  its, borehole {}
+0000eb50: 2064 6570 7468 2063 7574 222e 666f 726d   depth cut".form
+0000eb60: 6174 2862 682e 4944 2c20 6268 2e49 4429  at(bh.ID, bh.ID)
+0000eb70: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000eb80: 2020 2069 6620 6268 2e6c 6f67 5f73 7472     if bh.log_str
+0000eb90: 6174 6920 6973 206e 6f74 204e 6f6e 653a  ati is not None:
+0000eba0: 2023 2075 7064 6174 6520 6c6f 6720 7374   # update log st
+0000ebb0: 7261 7469 0d0a 2020 2020 2020 2020 2020  rati..          
+0000ebc0: 2020 2020 2020 2020 2020 6e65 775f 6c6f            new_lo
+0000ebd0: 673d 5b5d 0d0a 2020 2020 2020 2020 2020  g=[]..          
+0000ebe0: 2020 2020 2020 2020 2020 666f 7220 7320            for s 
+0000ebf0: 696e 2062 682e 6c6f 675f 7374 7261 7469  in bh.log_strati
+0000ec00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000ec10: 2020 2020 2020 2020 2020 2069 6620 735b             if s[
+0000ec20: 315d 203e 2062 6f74 5f7a 3a0d 0a20 2020  1] > bot_z:..   
+0000ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec40: 2020 2020 2020 2020 206e 6577 5f6c 6f67           new_log
+0000ec50: 2e61 7070 656e 6428 7329 0d0a 2020 2020  .append(s)..    
+0000ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec70: 6268 2e6c 6f67 5f73 7472 6174 693d 6e65  bh.log_strati=ne
+0000ec80: 775f 6c6f 670d 0a20 2020 2020 2020 2020  w_log..         
+0000ec90: 2020 2020 2020 2069 6620 6268 2e6c 6f67         if bh.log
+0000eca0: 5f66 6163 6965 7320 6973 206e 6f74 204e  _facies is not N
+0000ecb0: 6f6e 653a 2023 2075 7064 6174 6520 6c6f  one: # update lo
+0000ecc0: 6720 6661 6369 6573 0d0a 2020 2020 2020  g facies..      
+0000ecd0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0000ece0: 775f 6c6f 673d 5b5d 0d0a 2020 2020 2020  w_log=[]..      
+0000ecf0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000ed00: 7220 7320 696e 2062 682e 6c6f 675f 6661  r s in bh.log_fa
+0000ed10: 6369 6573 3a0d 0a20 2020 2020 2020 2020  cies:..         
+0000ed20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ed30: 6620 735b 315d 203e 2062 6f74 5f7a 3a0d  f s[1] > bot_z:.
+0000ed40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ed50: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0000ed60: 5f6c 6f67 2e61 7070 656e 6428 7329 0d0a  _log.append(s)..
+0000ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed80: 2020 2020 6268 2e6c 6f67 5f66 6163 6965      bh.log_facie
+0000ed90: 733d 6e65 775f 6c6f 670d 0a0d 0a20 2020  s=new_log....   
+0000eda0: 2020 2020 207a 673d 7365 6c66 2e67 6574       zg=self.get
+0000edb0: 5f7a 6728 2920 2320 7a20 7665 6374 6f72  _zg() # z vector
+0000edc0: 0d0a 2020 2020 2020 2020 737a 3d73 656c  ..        sz=sel
+0000edd0: 662e 6765 745f 737a 2829 0d0a 0d0a 2020  f.get_sz()....  
+0000ede0: 2020 2020 2020 2363 6865 636b 2062 6f74        #check bot
+0000edf0: 6f6d 0d0a 2020 2020 2020 2020 6966 2062  om..        if b
+0000ee00: 682e 6c6f 675f 7374 7261 7469 2069 7320  h.log_strati is 
+0000ee10: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0000ee20: 2020 2020 2020 207a 305f 6268 3d62 682e         z0_bh=bh.
+0000ee30: 6c6f 675f 7374 7261 7469 5b30 5d5b 315d  log_strati[0][1]
+0000ee40: 2023 2062 6f72 6568 6f6c 6520 616c 7469   # borehole alti
+0000ee50: 7475 6465 2074 6f70 0d0a 2020 2020 2020  tude top..      
+0000ee60: 2020 656c 6966 2062 682e 6c6f 675f 6661    elif bh.log_fa
+0000ee70: 6369 6573 2069 7320 6e6f 7420 4e6f 6e65  cies is not None
+0000ee80: 3a0d 0a20 2020 2020 2020 2020 2020 207a  :..            z
+0000ee90: 305f 6268 3d62 682e 6c6f 675f 6661 6369  0_bh=bh.log_faci
+0000eea0: 6573 5b30 5d5b 315d 0d0a 2020 2020 2020  es[0][1]..      
+0000eeb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000eec0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0000eed0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+0000eee0: 2020 2020 2020 2070 7269 6e74 2822 6e6f         print("no
+0000eef0: 206c 6f67 2066 6f75 6e64 2069 6e20 6268   log found in bh
+0000ef00: 207b 7d22 2e66 6f72 6d61 7428 6268 2e49   {}".format(bh.I
+0000ef10: 4429 290d 0a20 2020 2020 2020 2020 2020  D))..           
+0000ef20: 2072 6574 7572 6e20 300d 0a0d 0a20 2020   return 0....   
+0000ef30: 2020 2020 2023 6368 6563 6b20 696e 7369       #check insi
+0000ef40: 6465 206d 6173 6b20 616e 6420 6164 6170  de mask and adap
+0000ef50: 7420 7a20 626f 7265 686f 6c65 2074 6f20  t z borehole to 
+0000ef60: 4445 4d0d 0a20 2020 2020 2020 2066 6f72  DEM..        for
+0000ef70: 2069 7a20 696e 206e 702e 6172 616e 6765   iz in np.arange
+0000ef80: 287a 305f 6268 2c20 7a30 5f62 682d 6268  (z0_bh, z0_bh-bh
+0000ef90: 2e64 6570 7468 2c20 6d61 7828 2d73 7a2c  .depth, max(-sz,
+0000efa0: 2028 2d62 682e 6465 7074 6829 202f 2032   (-bh.depth) / 2
+0000efb0: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+0000efc0: 2069 6620 7365 6c66 2e63 6f6f 7264 3263   if self.coord2c
+0000efd0: 656c 6c28 6268 2e78 2c20 6268 2e79 2c20  ell(bh.x, bh.y, 
+0000efe0: 697a 2920 6973 206e 6f74 204e 6f6e 653a  iz) is not None:
+0000eff0: 2023 2063 6865 636b 2069 6620 696e 7369   # check if insi
+0000f000: 6465 206d 6173 6b0d 0a20 2020 2020 2020  de mask..       
+0000f010: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0000f020: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+0000f030: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000f040: 7072 696e 7428 2242 6f72 6568 6f6c 6520  print("Borehole 
+0000f050: 7b7d 2069 6e73 6964 6520 6f66 2074 6865  {} inside of the
+0000f060: 2073 696d 756c 6174 696f 6e20 7a6f 6e65   simulation zone
+0000f070: 222e 666f 726d 6174 2862 682e 4944 2929  ".format(bh.ID))
+0000f080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f090: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+0000f0a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0000f0b0: 7a20 3d3d 2062 682e 7a3a 0d0a 2020 2020  z == bh.z:..    
+0000f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0d0: 6375 745f 626f 746f 6d28 6268 290d 0a20  cut_botom(bh).. 
+0000f0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0f0: 2020 2069 6620 6268 2e64 6570 7468 203c     if bh.depth <
+0000f100: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+0000f110: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000f120: 7572 6e20 300d 0a20 2020 2020 2020 2020  urn 0..         
+0000f130: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000f140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f150: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000f160: 2031 0d0a 2020 2020 2020 2020 2020 2020   1..            
+0000f170: 2020 2020 656c 6966 2069 7a20 3c20 6268      elif iz < bh
+0000f180: 2e7a 3a20 2320 6966 2074 6865 2062 6f72  .z: # if the bor
+0000f190: 6568 6f6c 6520 6973 2061 626f 7665 2044  ehole is above D
+0000f1a0: 454d 2061 6e64 206d 7573 7420 6265 2063  EM and must be c
+0000f1b0: 7574 0d0a 2020 2020 2020 2020 2020 2020  ut..            
+0000f1c0: 2020 2020 2020 2020 6268 2e7a 3d69 7a20          bh.z=iz 
+0000f1d0: 2023 7570 6461 7465 2062 6f72 6568 6f6c   #update borehol
+0000f1e0: 6520 616c 7469 7475 6465 0d0a 2020 2020  e altitude..    
+0000f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f200: 2320 7570 6461 7465 206c 6f67 2073 7472  # update log str
+0000f210: 6174 690d 0a20 2020 2020 2020 2020 2020  ati..           
+0000f220: 2020 2020 2020 2020 2069 6620 6268 2e6c           if bh.l
+0000f230: 6f67 5f73 7472 6174 693a 0d0a 2020 2020  og_strati:..    
 0000f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f250: 2020 2020 2020 2020 2020 2069 6620 735b             if s[
-0000f260: 315d 203e 2069 7a20 616e 6420 7332 5b31  1] > iz and s2[1
-0000f270: 5d20 3c20 697a 3a20 2320 756e 6974 2063  ] < iz: # unit c
-0000f280: 7574 2062 7920 7468 6520 6465 6d0d 0a20  ut by the dem.. 
-0000f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f250: 2020 2020 6966 206c 656e 2862 682e 6c6f      if len(bh.lo
+0000f260: 675f 7374 7261 7469 2920 3e20 313a 0d0a  g_strati) > 1:..
+0000f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f280: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0000f290: 6c6f 673d 5b5d 0d0a 2020 2020 2020 2020  log=[]..        
 0000f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2b0: 2020 206e 6577 5f6c 6f67 2e61 7070 656e     new_log.appen
-0000f2c0: 6428 2873 5b30 5d2c 2069 7a29 290d 0a20  d((s[0], iz)).. 
-0000f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f2e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000f2f0: 6c69 6620 735b 315d 203c 3d20 697a 3a0d  lif s[1] <= iz:.
-0000f300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f2b0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0000f2c0: 6765 286c 656e 2862 682e 6c6f 675f 7374  ge(len(bh.log_st
+0000f2d0: 7261 7469 292d 3129 3a0d 0a20 2020 2020  rati)-1):..     
+0000f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2f0: 2020 2020 2020 2020 2020 2073 3d62 682e             s=bh.
+0000f300: 6c6f 675f 7374 7261 7469 5b69 5d0d 0a20  log_strati[i].. 
 0000f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f320: 2020 2020 206e 6577 5f6c 6f67 2e61 7070       new_log.app
-0000f330: 656e 6428 7329 0d0a 2020 2020 2020 2020  end(s)..        
-0000f340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f350: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0000f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f380: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
-0000f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3a0: 2020 2020 2023 6c61 7374 2075 6e69 7420       #last unit 
-0000f3b0: 696e 206c 6f67 0d0a 2020 2020 2020 2020  in log..        
-0000f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3d0: 2020 2020 6966 2073 325b 315d 203c 3d20      if s2[1] <= 
-0000f3e0: 697a 3a0d 0a20 2020 2020 2020 2020 2020  iz:..           
-0000f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f400: 2020 2020 206e 6577 5f6c 6f67 2e61 7070       new_log.app
-0000f410: 656e 6428 7332 290d 0a20 2020 2020 2020  end(s2)..       
+0000f320: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f330: 323d 6268 2e6c 6f67 5f73 7472 6174 695b  2=bh.log_strati[
+0000f340: 692b 315d 0d0a 2020 2020 2020 2020 2020  i+1]..          
+0000f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f360: 2020 2020 2020 6966 2073 5b31 5d20 3e20        if s[1] > 
+0000f370: 697a 2061 6e64 2073 325b 315d 203c 2069  iz and s2[1] < i
+0000f380: 7a3a 2023 2075 6e69 7420 6375 7420 6279  z: # unit cut by
+0000f390: 2074 6865 2064 656d 0d0a 2020 2020 2020   the dem..      
+0000f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3b0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0000f3c0: 775f 6c6f 672e 6170 7065 6e64 2828 735b  w_log.append((s[
+0000f3d0: 305d 2c20 697a 2929 0d0a 2020 2020 2020  0], iz))..      
+0000f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f3f0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+0000f400: 5b31 5d20 3c3d 2069 7a3a 0d0a 2020 2020  [1] <= iz:..    
+0000f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000f420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f430: 2020 2020 2065 6c69 6620 7332 5b31 5d20       elif s2[1] 
-0000f440: 3e20 697a 3a0d 0a20 2020 2020 2020 2020  > iz:..         
+0000f430: 6e65 775f 6c6f 672e 6170 7065 6e64 2873  new_log.append(s
+0000f440: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
 0000f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f460: 2020 2020 2020 206e 6577 5f6c 6f67 2e61         new_log.a
-0000f470: 7070 656e 6428 2873 325b 305d 2c20 697a  ppend((s2[0], iz
-0000f480: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0000f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f4a0: 6268 2e6c 6f67 5f73 7472 6174 693d 6e65  bh.log_strati=ne
-0000f4b0: 775f 6c6f 670d 0a20 2020 2020 2020 2020  w_log..         
-0000f4c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000f4d0: 6c69 6620 6c65 6e28 6268 2e6c 6f67 5f73  lif len(bh.log_s
-0000f4e0: 7472 6174 6929 203d 3d20 313a 2020 2320  trati) == 1:  # 
-0000f4f0: 4164 6a75 7374 2069 6620 6f6e 6c79 206f  Adjust if only o
-0000f500: 6e65 2075 6e69 740d 0a20 2020 2020 2020  ne unit..       
-0000f510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f520: 2020 2020 206e 6577 5f6c 6f67 3d5b 5d20       new_log=[] 
+0000f460: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0000f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f480: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000f490: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
+0000f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f4b0: 236c 6173 7420 756e 6974 2069 6e20 6c6f  #last unit in lo
+0000f4c0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+0000f4d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000f4e0: 6620 7332 5b31 5d20 3c3d 2069 7a3a 0d0a  f s2[1] <= iz:..
+0000f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f510: 6e65 775f 6c6f 672e 6170 7065 6e64 2873  new_log.append(s
+0000f520: 3229 0d0a 2020 2020 2020 2020 2020 2020  2)..            
 0000f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f540: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0000f550: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f560: 3d62 682e 6c6f 675f 7374 7261 7469 5b30  =bh.log_strati[0
-0000f570: 5d20 2020 2020 2020 2020 200d 0a20 2020  ]          ..   
-0000f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f590: 2020 2020 2020 2020 206e 6577 5f6c 6f67           new_log
-0000f5a0: 2e61 7070 656e 6428 2873 5b30 5d2c 2069  .append((s[0], i
-0000f5b0: 7a29 2920 200d 0a20 2020 2020 2020 2020  z))  ..         
-0000f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f5d0: 2020 2062 682e 6c6f 675f 7374 7261 7469     bh.log_strati
-0000f5e0: 3d6e 6577 5f6c 6f67 2020 2020 200d 0a20  =new_log     .. 
-0000f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f600: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f620: 2020 2020 2020 2020 2020 7061 7373 2020            pass  
-0000f630: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0000f640: 2020 2020 2020 2020 2320 7570 6461 7465          # update
-0000f650: 206c 6f67 2066 6163 6965 730d 0a20 2020   log facies..   
-0000f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f670: 2069 6620 6268 2e6c 6f67 5f66 6163 6965   if bh.log_facie
-0000f680: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0000f690: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000f6a0: 656e 2862 682e 6c6f 675f 6661 6369 6573  en(bh.log_facies
-0000f6b0: 293e 313a 0d0a 2020 2020 2020 2020 2020  )>1:..          
-0000f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6d0: 2020 6e65 775f 6c6f 673d 5b5d 0d0a 2020    new_log=[]..  
-0000f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f6f0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-0000f700: 696e 2072 616e 6765 286c 656e 2862 682e  in range(len(bh.
-0000f710: 6c6f 675f 6661 6369 6573 292d 3129 3a0d  log_facies)-1):.
-0000f720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f740: 2073 3d62 682e 6c6f 675f 6661 6369 6573   s=bh.log_facies
-0000f750: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-0000f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f770: 2020 2020 2073 323d 6268 2e6c 6f67 5f66       s2=bh.log_f
-0000f780: 6163 6965 735b 692b 315d 0d0a 2020 2020  acies[i+1]..    
+0000f540: 656c 6966 2073 325b 315d 203e 2069 7a3a  elif s2[1] > iz:
+0000f550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f570: 2020 6e65 775f 6c6f 672e 6170 7065 6e64    new_log.append
+0000f580: 2828 7332 5b30 5d2c 2069 7a29 290d 0a20  ((s2[0], iz)).. 
+0000f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5a0: 2020 2020 2020 2020 2020 2062 682e 6c6f             bh.lo
+0000f5b0: 675f 7374 7261 7469 3d6e 6577 5f6c 6f67  g_strati=new_log
+0000f5c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f5d0: 2020 2020 2020 2020 2020 656c 6966 206c            elif l
+0000f5e0: 656e 2862 682e 6c6f 675f 7374 7261 7469  en(bh.log_strati
+0000f5f0: 2920 3d3d 2031 3a20 2023 2041 646a 7573  ) == 1:  # Adjus
+0000f600: 7420 6966 206f 6e6c 7920 6f6e 6520 756e  t if only one un
+0000f610: 6974 0d0a 2020 2020 2020 2020 2020 2020  it..            
+0000f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f630: 6e65 775f 6c6f 673d 5b5d 2020 2020 2020  new_log=[]      
+0000f640: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0000f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f660: 2020 2020 2020 2020 2020 733d 6268 2e6c            s=bh.l
+0000f670: 6f67 5f73 7472 6174 695b 305d 2020 2020  og_strati[0]    
+0000f680: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0000f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6a0: 2020 2020 6e65 775f 6c6f 672e 6170 7065      new_log.appe
+0000f6b0: 6e64 2828 735b 305d 2c20 697a 2929 2020  nd((s[0], iz))  
+0000f6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f6d0: 2020 2020 2020 2020 2020 2020 2020 6268                bh
+0000f6e0: 2e6c 6f67 5f73 7472 6174 693d 6e65 775f  .log_strati=new_
+0000f6f0: 6c6f 6720 2020 2020 0d0a 2020 2020 2020  log     ..      
+0000f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f710: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f730: 2020 2020 2070 6173 7320 200d 0a0d 0a20       pass  .... 
+0000f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f750: 2020 2023 2075 7064 6174 6520 6c6f 6720     # update log 
+0000f760: 6661 6369 6573 0d0a 2020 2020 2020 2020  facies..        
+0000f770: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+0000f780: 682e 6c6f 675f 6661 6369 6573 3a0d 0a20  h.log_facies:.. 
 0000f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7a0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0000f7b0: 5b31 5d20 3e20 697a 2061 6e64 2073 325b  [1] > iz and s2[
-0000f7c0: 315d 203c 2069 7a3a 2023 2075 6e69 7420  1] < iz: # unit 
-0000f7d0: 6375 7420 6279 2074 6865 2064 656d 0d0a  cut by the dem..
-0000f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7a0: 2020 2020 2020 2069 6620 6c65 6e28 6268         if len(bh
+0000f7b0: 2e6c 6f67 5f66 6163 6965 7329 3e31 3a0d  .log_facies)>1:.
+0000f7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f7d0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0000f7e0: 5f6c 6f67 3d5b 5d0d 0a20 2020 2020 2020  _log=[]..       
 0000f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f800: 2020 2020 6e65 775f 6c6f 672e 6170 7065      new_log.appe
-0000f810: 6e64 2828 735b 305d 2c20 697a 2929 0d0a  nd((s[0], iz))..
-0000f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f800: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+0000f810: 6e67 6528 6c65 6e28 6268 2e6c 6f67 5f66  nge(len(bh.log_f
+0000f820: 6163 6965 7329 2d31 293a 0d0a 2020 2020  acies)-1):..    
 0000f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f840: 656c 6966 2073 5b31 5d20 3c3d 2069 7a3a  elif s[1] <= iz:
-0000f850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f840: 2020 2020 2020 2020 2020 2020 733d 6268              s=bh
+0000f850: 2e6c 6f67 5f66 6163 6965 735b 695d 0d0a  .log_facies[i]..
 0000f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f870: 2020 2020 2020 6e65 775f 6c6f 672e 6170        new_log.ap
-0000f880: 7065 6e64 2873 290d 0a20 2020 2020 2020  pend(s)..       
-0000f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8a0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0000f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8d0: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
-0000f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f8f0: 2020 2020 2020 6966 2073 325b 315d 203c        if s2[1] <
-0000f900: 3d20 697a 3a0d 0a20 2020 2020 2020 2020  = iz:..         
-0000f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f920: 2020 2020 2020 206e 6577 5f6c 6f67 2e61         new_log.a
-0000f930: 7070 656e 6428 7332 290d 0a20 2020 2020  ppend(s2)..     
-0000f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f950: 2020 2020 2020 2065 6c69 6620 7332 5b31         elif s2[1
-0000f960: 5d20 3e20 697a 3a0d 0a20 2020 2020 2020  ] > iz:..       
+0000f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f880: 7332 3d62 682e 6c6f 675f 6661 6369 6573  s2=bh.log_facies
+0000f890: 5b69 2b31 5d0d 0a20 2020 2020 2020 2020  [i+1]..         
+0000f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f8b0: 2020 2020 2020 2069 6620 735b 315d 203e         if s[1] >
+0000f8c0: 2069 7a20 616e 6420 7332 5b31 5d20 3c20   iz and s2[1] < 
+0000f8d0: 697a 3a20 2320 756e 6974 2063 7574 2062  iz: # unit cut b
+0000f8e0: 7920 7468 6520 6465 6d0d 0a20 2020 2020  y the dem..     
+0000f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f900: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000f910: 6577 5f6c 6f67 2e61 7070 656e 6428 2873  ew_log.append((s
+0000f920: 5b30 5d2c 2069 7a29 290d 0a20 2020 2020  [0], iz))..     
+0000f930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f940: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0000f950: 735b 315d 203c 3d20 697a 3a0d 0a20 2020  s[1] <= iz:..   
+0000f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0000f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f980: 2020 2020 2020 2020 206e 6577 5f6c 6f67           new_log
-0000f990: 2e61 7070 656e 6428 2873 325b 305d 2c20  .append((s2[0], 
-0000f9a0: 697a 2929 0d0a 2020 2020 2020 2020 2020  iz))..          
-0000f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9c0: 2020 6268 2e6c 6f67 5f66 6163 6965 733d    bh.log_facies=
-0000f9d0: 6e65 775f 6c6f 670d 0a20 2020 2020 2020  new_log..       
-0000f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9f0: 2065 6c69 6620 6c65 6e28 6268 2e6c 6f67   elif len(bh.log
-0000fa00: 5f66 6163 6965 7329 203d 3d20 313a 2020  _facies) == 1:  
-0000fa10: 2320 4164 6a75 7374 2069 6620 6f6e 6c79  # Adjust if only
-0000fa20: 206f 6e65 2066 6163 6965 730d 0a20 2020   one facies..   
-0000fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa40: 2020 2020 2020 2020 206e 6577 5f6c 6f67           new_log
-0000fa50: 3d5b 5d20 2020 2020 2020 2020 2020 2020  =[]             
-0000fa60: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0000fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fa80: 2020 2073 3d62 682e 6c6f 675f 6661 6369     s=bh.log_faci
-0000fa90: 6573 5b30 5d20 2020 2020 2020 2020 200d  es[0]          .
-0000faa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fab0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-0000fac0: 5f6c 6f67 2e61 7070 656e 6428 2873 5b30  _log.append((s[0
-0000fad0: 5d2c 2069 7a29 2920 200d 0a20 2020 2020  ], iz))  ..     
-0000fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000faf0: 2020 2020 2020 2062 682e 6c6f 675f 6661         bh.log_fa
-0000fb00: 6369 6573 3d6e 6577 5f6c 6f67 0d0a 2020  cies=new_log..  
-0000fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb20: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb40: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-0000fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fb60: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0000fb70: 2020 2020 2020 2020 2023 2075 7064 6174           # updat
-0000fb80: 6520 6465 7074 680d 0a20 2020 2020 2020  e depth..       
-0000fb90: 2020 2020 2020 2020 2020 2020 2062 682e               bh.
-0000fba0: 6465 7074 6820 3d20 6268 2e64 6570 7468  depth = bh.depth
-0000fbb0: 202d 2028 6268 2e7a 202d 2069 7a29 0d0a   - (bh.z - iz)..
-0000fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fbd0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0000fbe0: 2020 2020 2020 2020 2020 6375 745f 626f            cut_bo
-0000fbf0: 746f 6d28 6268 290d 0a20 2020 2020 2020  tom(bh)..       
-0000fc00: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000fc10: 6268 2e64 6570 7468 203c 2030 3a0d 0a20  bh.depth < 0:.. 
+0000f980: 206e 6577 5f6c 6f67 2e61 7070 656e 6428   new_log.append(
+0000f990: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+0000f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f9b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0000f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000f9e0: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
+0000f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa00: 2069 6620 7332 5b31 5d20 3c3d 2069 7a3a   if s2[1] <= iz:
+0000fa10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa30: 2020 6e65 775f 6c6f 672e 6170 7065 6e64    new_log.append
+0000fa40: 2873 3229 0d0a 2020 2020 2020 2020 2020  (s2)..          
+0000fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa60: 2020 656c 6966 2073 325b 315d 203e 2069    elif s2[1] > i
+0000fa70: 7a3a 0d0a 2020 2020 2020 2020 2020 2020  z:..            
+0000fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa90: 2020 2020 6e65 775f 6c6f 672e 6170 7065      new_log.appe
+0000faa0: 6e64 2828 7332 5b30 5d2c 2069 7a29 290d  nd((s2[0], iz)).
+0000fab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fac0: 2020 2020 2020 2020 2020 2020 2062 682e               bh.
+0000fad0: 6c6f 675f 6661 6369 6573 3d6e 6577 5f6c  log_facies=new_l
+0000fae0: 6f67 0d0a 2020 2020 2020 2020 2020 2020  og..            
+0000faf0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0000fb00: 206c 656e 2862 682e 6c6f 675f 6661 6369   len(bh.log_faci
+0000fb10: 6573 2920 3d3d 2031 3a20 2023 2041 646a  es) == 1:  # Adj
+0000fb20: 7573 7420 6966 206f 6e6c 7920 6f6e 6520  ust if only one 
+0000fb30: 6661 6369 6573 0d0a 2020 2020 2020 2020  facies..        
+0000fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb50: 2020 2020 6e65 775f 6c6f 673d 5b5d 2020      new_log=[]  
+0000fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fb70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000fb80: 2020 2020 2020 2020 2020 2020 2020 733d                s=
+0000fb90: 6268 2e6c 6f67 5f66 6163 6965 735b 305d  bh.log_facies[0]
+0000fba0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+0000fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fbc0: 2020 2020 2020 2020 6e65 775f 6c6f 672e          new_log.
+0000fbd0: 6170 7065 6e64 2828 735b 305d 2c20 697a  append((s[0], iz
+0000fbe0: 2929 2020 0d0a 2020 2020 2020 2020 2020  ))  ..          
+0000fbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc00: 2020 6268 2e6c 6f67 5f66 6163 6965 733d    bh.log_facies=
+0000fc10: 6e65 775f 6c6f 670d 0a20 2020 2020 2020  new_log..       
 0000fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc30: 2020 2020 2020 2072 6574 7572 6e20 300d         return 0.
-0000fc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fc50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0000fc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc70: 2020 2020 7265 7475 726e 2031 0d0a 0d0a      return 1....
-0000fc80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000fc90: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0000fca0: 2020 2020 2020 7072 696e 7428 2242 6f72        print("Bor
-0000fcb0: 6568 6f6c 6520 7b7d 206f 7574 7369 6465  ehole {} outside
-0000fcc0: 206f 6620 7468 6520 7369 6d75 6c61 7469   of the simulati
-0000fcd0: 6f6e 207a 6f6e 6520 2d20 6e6f 7420 6164  on zone - not ad
-0000fce0: 6465 6420 2d22 2e66 6f72 6d61 7428 6268  ded -".format(bh
-0000fcf0: 2e49 4429 290d 0a20 2020 2020 2020 2072  .ID))..        r
-0000fd00: 6574 7572 6e20 300d 0a0d 0a20 2020 2064  eturn 0....    d
-0000fd10: 6566 2063 6f6f 7264 3263 656c 6c28 7365  ef coord2cell(se
-0000fd20: 6c66 2c20 782c 2079 2c20 7a3d 4e6f 6e65  lf, x, y, z=None
-0000fd30: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-0000fd40: 220d 0a20 2020 2020 2020 204d 6574 686f  "..        Metho
-0000fd50: 6420 7468 6174 2072 6574 7572 6e73 2074  d that returns t
-0000fd60: 6865 2063 656c 6c20 696e 2077 6869 6368  he cell in which
-0000fd70: 2061 7265 2074 6865 2067 6976 656e 2063   are the given c
-0000fd80: 6f6f 7264 696e 6174 6573 0d0a 0d0a 2020  oordinates....  
-0000fd90: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0000fda0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000fdb0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 783a  ----..        x:
-0000fdc0: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-0000fdd0: 2020 2020 7820 636f 6f72 6469 6e61 7465      x coordinate
-0000fde0: 0d0a 2020 2020 2020 2020 793a 2066 6c6f  ..        y: flo
-0000fdf0: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-0000fe00: 7920 636f 6f72 6469 6e61 7465 0d0a 2020  y coordinate..  
-0000fe10: 2020 2020 2020 7a3a 2066 6c6f 6174 2c20        z: float, 
-0000fe20: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-0000fe30: 2020 2020 2020 7a20 636f 6f72 6469 6e61        z coordina
-0000fe40: 7465 2c20 6966 207a 2069 7320 4e6f 6e65  te, if z is None
-0000fe50: 2c20 6f6e 6c79 2078 2061 6e64 2079 2069  , only x and y i
-0000fe60: 6e64 6578 6573 2061 7265 2072 6574 7572  ndexes are retur
-0000fe70: 6e65 640d 0a0d 0a20 2020 2020 2020 2052  ned....        R
-0000fe80: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-0000fe90: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000fea0: 2063 656c 6c3a 2074 7570 6c65 0d0a 2020   cell: tuple..  
-0000feb0: 2020 2020 2020 2020 2020 6365 6c6c 2069            cell i
-0000fec0: 6e64 6578 6573 2028 6978 2c20 6979 2c20  ndexes (ix, iy, 
-0000fed0: 697a 2920 6f72 2028 6978 2c20 6979 2920  iz) or (ix, iy) 
-0000fee0: 6966 207a 2069 7320 4e6f 6e65 0d0a 2020  if z is None..  
-0000fef0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-0000ff00: 2020 2020 2061 7373 6572 7420 7920 3d3d       assert y ==
-0000ff10: 2079 2c20 2263 6f6f 7264 696e 6174 6573   y, "coordinates
-0000ff20: 2063 6f6e 7461 696e 204e 614e 220d 0a20   contain NaN".. 
-0000ff30: 2020 2020 2020 2061 7373 6572 7420 7820         assert x 
-0000ff40: 3d3d 2078 2c20 2263 6f6f 7264 696e 6174  == x, "coordinat
-0000ff50: 6573 2063 6f6e 7461 696e 204e 614e 220d  es contain NaN".
-0000ff60: 0a0d 0a20 2020 2020 2020 2069 6620 7a20  ...        if z 
-0000ff70: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0000ff80: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-0000ff90: 207a 203d 3d20 7a2c 2022 636f 6f72 6469   z == z, "coordi
-0000ffa0: 6e61 7465 7320 636f 6e74 6169 6e20 4e61  nates contain Na
-0000ffb0: 4e22 0d0a 0d0a 2020 2020 2020 2020 7867  N"....        xg
-0000ffc0: 3d73 656c 662e 6765 745f 7867 2829 0d0a  =self.get_xg()..
-0000ffd0: 2020 2020 2020 2020 7967 3d73 656c 662e          yg=self.
-0000ffe0: 6765 745f 7967 2829 0d0a 2020 2020 2020  get_yg()..      
-0000fff0: 2020 7a67 3d73 656c 662e 6765 745f 7a67    zg=self.get_zg
-00010000: 2829 0d0a 2020 2020 2020 2020 7378 3d73  ()..        sx=s
-00010010: 656c 662e 6765 745f 7378 2829 0d0a 2020  elf.get_sx()..  
-00010020: 2020 2020 2020 7379 3d73 656c 662e 6765        sy=self.ge
-00010030: 745f 7379 2829 0d0a 2020 2020 2020 2020  t_sy()..        
-00010040: 737a 3d73 656c 662e 6765 745f 737a 2829  sz=self.get_sz()
-00010050: 0d0a 2020 2020 2020 2020 6e7a 3d73 656c  ..        nz=sel
-00010060: 662e 6765 745f 6e7a 2829 0d0a 0d0a 2020  f.get_nz()....  
-00010070: 2020 2020 2020 2320 6368 6563 6b20 706f        # check po
-00010080: 696e 7420 696e 7369 6465 2073 696d 756c  int inside simul
-00010090: 6174 696f 6e20 626c 6f63 6b0d 0a20 2020  ation block..   
-000100a0: 2020 2020 2069 6620 2878 203c 3d20 7867       if (x <= xg
-000100b0: 5b30 5d29 206f 7220 2878 203e 3d20 7867  [0]) or (x >= xg
-000100c0: 5b2d 315d 293a 0d0a 2020 2020 2020 2020  [-1]):..        
-000100d0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-000100e0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-000100f0: 2020 2020 2020 7072 696e 7428 2270 6f69        print("poi
-00010100: 6e74 206f 7574 7369 6465 206f 6620 7468  nt outside of th
-00010110: 6520 6772 6964 2069 6e20 7822 290d 0a20  e grid in x").. 
-00010120: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00010130: 6e20 4e6f 6e65 0d0a 2020 2020 2020 2020  n None..        
-00010140: 6966 2028 7920 3c3d 2079 675b 305d 2920  if (y <= yg[0]) 
-00010150: 6f72 2028 7920 3e3d 2079 675b 2d31 5d29  or (y >= yg[-1])
-00010160: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00010170: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00010180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010190: 2070 7269 6e74 2822 706f 696e 7420 6f75   print("point ou
-000101a0: 7473 6964 6520 6f66 2074 6865 2067 7269  tside of the gri
-000101b0: 6420 696e 2079 2229 0d0a 2020 2020 2020  d in y")..      
-000101c0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-000101d0: 650d 0a0d 0a20 2020 2020 2020 2069 6620  e....        if 
-000101e0: 7a20 6973 206e 6f74 204e 6f6e 653a 0d0a  z is not None:..
-000101f0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
-00010200: 7a20 3c3d 207a 675b 305d 2920 6f72 2028  z <= zg[0]) or (
-00010210: 7a20 3e20 7a67 5b2d 315d 293a 0d0a 2020  z > zg[-1]):..  
-00010220: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010230: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-00010240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010250: 2020 2020 7072 696e 7428 2270 6f69 6e74      print("point
-00010260: 206f 7574 7369 6465 206f 6620 7468 6520   outside of the 
-00010270: 6772 6964 2069 6e20 7a22 290d 0a20 2020  grid in z")..   
-00010280: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00010290: 7572 6e20 4e6f 6e65 0d0a 0d0a 2020 2020  urn None....    
-000102a0: 2020 2020 6978 3d28 2878 2d78 675b 305d      ix=((x-xg[0]
-000102b0: 292f 2f73 7829 2e61 7374 7970 6528 696e  )//sx).astype(in
-000102c0: 7429 0d0a 2020 2020 2020 2020 6979 3d28  t)..        iy=(
-000102d0: 2879 2d79 675b 305d 292f 2f73 7929 2e61  (y-yg[0])//sy).a
-000102e0: 7374 7970 6528 696e 7429 0d0a 0d0a 2020  stype(int)....  
-000102f0: 2020 2020 2020 6966 207a 2069 7320 6e6f        if z is no
-00010300: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00010310: 2020 2020 2069 7a3d 2828 7a2d 7a67 5b30       iz=((z-zg[0
-00010320: 5d29 2f2f 737a 292e 6173 7479 7065 2869  ])//sz).astype(i
-00010330: 6e74 290d 0a20 2020 2020 2020 2020 2020  nt)..           
-00010340: 2069 6620 697a 203e 206e 7a2d 313a 0d0a   if iz > nz-1:..
-00010350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010360: 697a 3d6e 7a2d 310d 0a0d 0a20 2020 2020  iz=nz-1....     
-00010370: 2020 2020 2020 2063 656c 6c3d 2869 7a2c         cell=(iz,
-00010380: 2069 792c 2069 7829 0d0a 2020 2020 2020   iy, ix)..      
-00010390: 2020 2020 2020 6966 2073 656c 662e 6d61        if self.ma
-000103a0: 736b 5b69 7a2c 2069 792c 2069 785d 3a0d  sk[iz, iy, ix]:.
-000103b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000103c0: 2072 6574 7572 6e20 6365 6c6c 0d0a 2020   return cell..  
-000103d0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-000103e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000103f0: 2023 7072 696e 7428 2250 6f69 6e74 206f   #print("Point o
-00010400: 7574 7369 6465 206f 6620 7468 6520 7369  utside of the si
-00010410: 6d75 6c61 7469 6f6e 2064 6f6d 6169 6e22  mulation domain"
-00010420: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00010430: 2020 2072 6574 7572 6e20 4e6f 6e65 0d0a     return None..
-00010440: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00010450: 2020 2020 2020 2020 2020 2063 656c 6c20             cell 
-00010460: 3d20 2869 792c 2069 7829 0d0a 2020 2020  = (iy, ix)..    
-00010470: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-00010480: 656c 6c0d 0a0d 0a20 2020 2064 6566 2061  ell....    def a
-00010490: 6464 5f70 726f 7028 7365 6c66 2c20 7072  dd_prop(self, pr
-000104a0: 6f70 293a 0d0a 0d0a 2020 2020 2020 2020  op):....        
-000104b0: 2222 220d 0a20 2020 2020 2020 2041 6464  """..        Add
-000104c0: 2061 2070 726f 7065 7274 7920 746f 2074   a property to t
-000104d0: 6865 2041 7263 685f 5461 626c 650d 0a0d  he Arch_Table...
-000104e0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000104f0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00010500: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00010510: 2070 726f 703a 203a 636c 6173 733a 6050   prop: :class:`P
-00010520: 726f 7060 206f 626a 6563 740d 0a20 2020  rop` object..   
-00010530: 2020 2020 2020 2020 2070 726f 7065 7274           propert
-00010540: 7920 746f 2061 6464 2074 6f20 7468 6520  y to add to the 
-00010550: 4172 6368 5f54 6162 6c65 0d0a 2020 2020  Arch_Table..    
-00010560: 2020 2020 0d0a 2020 2020 2020 2020 5265      ..        Re
-00010570: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
-00010580: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00010590: 4e6f 6e65 0d0a 2020 2020 2020 2020 2222  None..        ""
-000105a0: 220d 0a0d 0a20 2020 2020 2020 2074 7279  "....        try
-000105b0: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-000105c0: 6f72 2069 2069 6e20 7072 6f70 3a0d 0a20  or i in prop:.. 
-000105d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000105e0: 6620 2869 7369 6e73 7461 6e63 6528 692c  f (isinstance(i,
-000105f0: 2050 726f 7029 2920 616e 6420 2869 206e   Prop)) and (i n
-00010600: 6f74 2069 6e20 7365 6c66 2e6c 6973 745f  ot in self.list_
-00010610: 7072 6f70 7329 3a0d 0a20 2020 2020 2020  props):..       
-00010620: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00010630: 662e 6c69 7374 5f70 726f 7073 2e61 7070  f.list_props.app
-00010640: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
-00010650: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00010660: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-00010670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010680: 2020 2020 2020 7072 696e 7428 2250 726f        print("Pro
-00010690: 7065 7274 7920 7b7d 2061 6464 6564 222e  perty {} added".
-000106a0: 666f 726d 6174 2869 2e6e 616d 6529 290d  format(i.name)).
-000106b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000106c0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000106d0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000106e0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-000106f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010700: 2020 2020 2020 7072 696e 7428 226f 626a        print("obj
-00010710: 6563 7420 6973 6e27 7420 6120 5072 6f70  ect isn't a Prop
-00010720: 6572 7479 206f 626a 6563 7420 6f72 2069  erty object or i
-00010730: 7420 6973 2061 6c72 6561 6479 2069 6e20  t is already in 
-00010740: 7468 6520 6c69 7374 2229 0d0a 2020 2020  the list")..    
-00010750: 2020 2020 6578 6365 7074 3a20 2320 7374      except: # st
-00010760: 7261 7469 206e 6f74 2069 6e20 6120 6c69  rati not in a li
-00010770: 7374 0d0a 2020 2020 2020 2020 2020 2020  st..            
-00010780: 6966 2028 6973 696e 7374 616e 6365 2870  if (isinstance(p
-00010790: 726f 702c 2050 726f 7029 2920 616e 6420  rop, Prop)) and 
-000107a0: 2870 726f 7020 6e6f 7420 696e 2073 656c  (prop not in sel
-000107b0: 662e 6c69 7374 5f70 726f 7073 293a 0d0a  f.list_props):..
-000107c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107d0: 7365 6c66 2e6c 6973 745f 7072 6f70 732e  self.list_props.
-000107e0: 6170 7065 6e64 2870 726f 7029 0d0a 2020  append(prop)..  
-000107f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010800: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-00010810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010820: 2020 2020 7072 696e 7428 2250 726f 7065      print("Prope
-00010830: 7274 7920 7b7d 2061 6464 6564 222e 666f  rty {} added".fo
-00010840: 726d 6174 2870 726f 702e 6e61 6d65 2929  rmat(prop.name))
-00010850: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00010860: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00010870: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00010880: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00010890: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-000108a0: 2822 6f62 6a65 6374 2069 736e 2774 2061  ("object isn't a
-000108b0: 2050 726f 7065 7274 7920 6f62 6a65 6374   Property object
-000108c0: 2229 0d0a 0d0a 2020 2020 6465 6620 6164  ")....    def ad
-000108d0: 645f 6268 2873 656c 662c 2062 6873 293a  d_bh(self, bhs):
-000108e0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-000108f0: 0a20 2020 2020 2020 204d 6574 686f 6420  .        Method 
-00010900: 746f 2061 6464 2062 6f72 6568 6f6c 652c  to add borehole,
-00010910: 206c 6973 7420 6f66 2062 6f72 6568 6f6c   list of borehol
-00010920: 6573 2069 6620 6d75 6c74 6970 6c65 730d  es if multiples.
-00010930: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00010940: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00010950: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00010960: 2020 2062 6873 3a20 3a63 6c61 7373 3a60     bhs: :class:`
-00010970: 626f 7265 686f 6c65 6020 6f62 6a65 6374  borehole` object
-00010980: 206f 7220 6c69 7374 206f 6620 3a63 6c61   or list of :cla
-00010990: 7373 3a60 626f 7265 686f 6c65 6020 6f62  ss:`borehole` ob
-000109a0: 6a65 6374 730d 0a20 2020 2020 2020 2020  jects..         
-000109b0: 2020 2062 6f72 6568 6f6c 6528 7329 2074     borehole(s) t
-000109c0: 6f20 6164 6420 746f 2074 6865 2041 7263  o add to the Arc
-000109d0: 685f 5461 626c 650d 0a20 2020 2020 2020  h_Table..       
-000109e0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-000109f0: 6966 2068 6173 6174 7472 2862 6873 2c20  if hasattr(bhs, 
-00010a00: 225f 5f69 7465 725f 5f22 293a 0d0a 2020  "__iter__"):..  
-00010a10: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
-00010a20: 696e 2062 6873 3a0d 0a20 2020 2020 2020  in bhs:..       
-00010a30: 2020 2020 2020 2020 2069 6620 2869 7369           if (isi
-00010a40: 6e73 7461 6e63 6528 692c 2062 6f72 6568  nstance(i, boreh
-00010a50: 6f6c 6529 2920 616e 6420 2869 206e 6f74  ole)) and (i not
-00010a60: 2069 6e20 7365 6c66 2e6c 6973 745f 6268   in self.list_bh
-00010a70: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
-00010a80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00010a90: 2e63 6865 636b 5f62 685f 696e 7369 6465  .check_bh_inside
-00010aa0: 2869 293a 0d0a 2020 2020 2020 2020 2020  (i):..          
-00010ab0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010ac0: 6c66 2e6c 6973 745f 6268 732e 6170 7065  lf.list_bhs.appe
-00010ad0: 6e64 2869 290d 0a20 2020 2020 2020 2020  nd(i)..         
-00010ae0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00010af0: 656c 662e 6268 735f 7072 6f63 6573 7365  elf.bhs_processe
-00010b00: 6420 3d20 3020 2023 2072 6573 6574 2066  d = 0  # reset f
-00010b10: 6c61 6720 6f66 2062 6f72 6568 6f6c 6573  lag of boreholes
-00010b20: 2061 6c72 6561 6479 2070 726f 6365 7373   already process
-00010b30: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00010b40: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00010b50: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-00010b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b70: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00010b80: 2242 6f72 6568 6f6c 6520 7b7d 2061 6464  "Borehole {} add
-00010b90: 6564 222e 666f 726d 6174 2869 2e49 4429  ed".format(i.ID)
-00010ba0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00010bb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00010bc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010bd0: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bf0: 2020 2020 2020 2020 7072 696e 7428 226f          print("o
-00010c00: 626a 6563 7420 6973 6e27 7420 6120 626f  bject isn't a bo
-00010c10: 7265 686f 6c65 206f 626a 6563 7420 6f72  rehole object or
-00010c20: 206f 626a 6563 7420 6973 2061 6c72 6561   object is alrea
-00010c30: 6479 2069 6e20 7468 6520 6c69 7374 2229  dy in the list")
-00010c40: 0d0a 0d0a 2020 2020 2020 2020 656c 7365  ....        else
-00010c50: 3a20 2320 626f 7265 686f 6c65 7320 6e6f  : # boreholes no
-00010c60: 7420 696e 2061 206c 6973 740d 0a20 2020  t in a list..   
-00010c70: 2020 2020 2020 2020 2069 6620 2869 7369           if (isi
-00010c80: 6e73 7461 6e63 6528 6268 732c 2062 6f72  nstance(bhs, bor
-00010c90: 6568 6f6c 6529 2920 616e 6420 2862 6873  ehole)) and (bhs
-00010ca0: 206e 6f74 2069 6e20 7365 6c66 2e6c 6973   not in self.lis
-00010cb0: 745f 6268 7329 3a0d 0a20 2020 2020 2020  t_bhs):..       
-00010cc0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00010cd0: 2e63 6865 636b 5f62 685f 696e 7369 6465  .check_bh_inside
-00010ce0: 2862 6873 293a 0d0a 2020 2020 2020 2020  (bhs):..        
-00010cf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010d00: 2e6c 6973 745f 6268 732e 6170 7065 6e64  .list_bhs.append
-00010d10: 2862 6873 290d 0a20 2020 2020 2020 2020  (bhs)..         
-00010d20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00010d30: 6268 735f 7072 6f63 6573 7365 6420 3d20  bhs_processed = 
-00010d40: 3020 2023 2072 6573 6574 2066 6c61 6720  0  # reset flag 
-00010d50: 6f66 2062 6f72 6568 6f6c 6573 2061 6c72  of boreholes alr
-00010d60: 6561 6479 2070 726f 6365 7373 6564 200d  eady processed .
-00010d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010d80: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00010d90: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00010da0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00010db0: 7269 6e74 2822 426f 7265 686f 6c65 207b  rint("Borehole {
-00010dc0: 7d20 6164 6465 6422 2e66 6f72 6d61 7428  } added".format(
-00010dd0: 6268 732e 4944 2929 0d0a 2020 2020 2020  bhs.ID))..      
-00010de0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00010df0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00010e00: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
-00010e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e20: 2020 2070 7269 6e74 2822 6f62 6a65 6374     print("object
-00010e30: 2069 736e 2774 2061 2062 6f72 6568 6f6c   isn't a borehol
-00010e40: 6520 6f62 6a65 6374 206f 7220 6f62 6a65  e object or obje
-00010e50: 6374 2069 7320 616c 7265 6164 7920 696e  ct is already in
-00010e60: 2074 6865 206c 6973 7422 290d 0a0d 0a20   the list").... 
-00010e70: 2020 2064 6566 206d 616b 655f 6661 6b65     def make_fake
-00010e80: 5f62 6828 7365 6c66 2c20 706f 7369 7469  _bh(self, positi
-00010e90: 6f6e 735f 782c 2070 6f73 6974 696f 6e73  ons_x, positions
-00010ea0: 5f79 2c20 756e 6974 733d 4e6f 6e65 2c20  _y, units=None, 
-00010eb0: 6661 6369 6573 3d4e 6f6e 652c 2073 7472  facies=None, str
-00010ec0: 6174 496e 6465 783d 302c 2066 6163 6965  atIndex=0, facie
-00010ed0: 7349 6e64 6578 3d30 2c20 6578 7472 6163  sIndex=0, extrac
-00010ee0: 7455 6e69 7473 3d54 7275 652c 2065 7874  tUnits=True, ext
-00010ef0: 7261 6374 4661 6369 6573 3d54 7275 652c  ractFacies=True,
-00010f00: 2076 623d 3129 3a0d 0a0d 0a20 2020 2020   vb=1):....     
-00010f10: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00010f20: 4372 6561 7465 2066 616b 6520 626f 7265  Create fake bore
-00010f30: 686f 6c65 7320 6672 6f6d 2072 6561 6c69  holes from reali
-00010f40: 7a61 7469 6f6e 206f 6620 7468 6520 4172  zation of the Ar
-00010f50: 6368 5f74 6162 6c65 2e0d 0a0d 0a0d 0a20  ch_table....... 
-00010f60: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00010f70: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00010f80: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2070  -----..        p
-00010f90: 6f73 6974 696f 6e73 5f78 3a20 7365 7175  ositions_x: sequ
-00010fa0: 656e 6365 206f 6620 6e75 6d62 6572 730d  ence of numbers.
-00010fb0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00010fc0: 6963 6174 6520 7468 6520 7820 706f 7369  icate the x posi
-00010fd0: 7469 6f6e 7320 6f66 2074 6865 2062 6f72  tions of the bor
-00010fe0: 6568 6f6c 6520 746f 2063 7265 6174 6520  ehole to create 
-00010ff0: 6268 730d 0a20 2020 2020 2020 2070 6f73  bhs..        pos
-00011000: 6974 696f 6e73 5f79 3a20 7365 7175 656e  itions_y: sequen
-00011010: 6365 206f 6620 6e75 6d62 6572 730d 0a20  ce of numbers.. 
-00011020: 2020 2020 2020 2020 2020 2069 6e64 6963             indic
-00011030: 6174 6520 7468 6520 7920 706f 7369 7469  ate the y positi
-00011040: 6f6e 7320 6f66 2074 6865 2062 6f72 6568  ons of the boreh
-00011050: 6f6c 6520 746f 2063 7265 6174 6520 6268  ole to create bh
-00011060: 730d 0a20 2020 2020 2020 2075 6e69 7473  s..        units
-00011070: 3a20 3344 2061 7272 6179 2c20 6f70 7469  : 3D array, opti
-00011080: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00011090: 2020 756e 6974 2061 7272 6179 2074 6f20    unit array to 
-000110a0: 7573 6520 746f 2063 7265 6174 6520 6268  use to create bh
-000110b0: 730d 0a20 2020 2020 2020 2066 6163 6965  s..        facie
-000110c0: 733a 2033 4420 6172 7261 792c 206f 7074  s: 3D array, opt
-000110d0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
-000110e0: 2020 2066 6163 6965 7320 6172 7261 7920     facies array 
-000110f0: 746f 2075 7365 2074 6f20 6372 6561 7465  to use to create
-00011100: 2062 6873 0d0a 2020 2020 2020 2020 7374   bhs..        st
-00011110: 7261 7449 6e64 6578 3a20 696e 7420 6f72  ratIndex: int or
-00011120: 2073 6571 7565 6e63 6520 6f66 2069 6e74   sequence of int
-00011130: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00011140: 2020 2020 2020 2020 756e 6974 2069 6e64          unit ind
-00011150: 6578 2074 6f20 7361 6d70 6c65 0d0a 2020  ex to sample..  
-00011160: 2020 2020 2020 6661 6369 6573 496e 6465        faciesInde
-00011170: 783a 2069 6e74 206f 7220 7365 7175 656e  x: int or sequen
-00011180: 6365 206f 6620 696e 742c 206f 7074 696f  ce of int, optio
-00011190: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-000111a0: 2066 6163 6965 7320 696e 6465 7820 746f   facies index to
-000111b0: 2073 616d 706c 650d 0a20 2020 2020 2020   sample..       
-000111c0: 2065 7874 7261 6374 556e 6974 733a 2062   extractUnits: b
-000111d0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a20  ool, optional.. 
-000111e0: 2020 2020 2020 2020 2020 2066 6c61 6720             flag 
-000111f0: 746f 2069 6e64 6963 6174 6520 746f 2073  to indicate to s
-00011200: 616d 706c 6520 756e 6974 7320 6f72 206e  ample units or n
-00011210: 6f74 0d0a 2020 2020 2020 2020 6578 7472  ot..        extr
-00011220: 6163 7446 6163 6965 733a 2062 6f6f 6c2c  actFacies: bool,
-00011230: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00011240: 2020 2020 2020 2066 6c61 6720 746f 2069         flag to i
-00011250: 6e64 6963 6174 6520 746f 2073 616d 706c  ndicate to sampl
-00011260: 6520 6661 6369 6573 206f 7220 6e6f 740d  e facies or not.
-00011270: 0a20 2020 2020 2020 2076 623a 2069 6e74  .        vb: int
-00011280: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00011290: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
-000112a0: 6c65 7665 6c0d 0a0d 0a20 2020 2020 2020  level....       
-000112b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-000112c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000112d0: 2020 206c 6973 7420 6f66 203a 636c 6173     list of :clas
-000112e0: 733a 6062 6f72 6568 6f6c 6560 206f 626a  s:`borehole` obj
-000112f0: 6563 7473 0d0a 2020 2020 2020 2020 2222  ects..        ""
-00011300: 220d 0a0d 0a20 2020 2020 2020 2023 2067  "....        # g
-00011310: 6574 2033 4420 6172 7261 7973 2074 6f20  et 3D arrays to 
-00011320: 7361 6d70 6c65 0d0a 2020 2020 2020 2020  sample..        
-00011330: 6966 2075 6e69 7473 2069 7320 4e6f 6e65  if units is None
-00011340: 2061 6e64 2065 7874 7261 6374 556e 6974   and extractUnit
-00011350: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00011360: 756e 6974 7320 3d20 7365 6c66 2e67 6574  units = self.get
-00011370: 5f75 6e69 7473 5f64 6f6d 6169 6e73 5f72  _units_domains_r
-00011380: 6561 6c69 7a61 7469 6f6e 7328 290d 0a20  ealizations().. 
-00011390: 2020 2020 2020 2020 2020 2023 2075 6e69             # uni
-000113a0: 7473 5f64 6174 615b 6e70 2e69 736e 616e  ts_data[np.isnan
-000113b0: 2875 6e69 7473 5f64 6174 6129 5d3d 2d39  (units_data)]=-9
-000113c0: 3920 2023 2064 6566 6175 6c74 2049 4420  9  # default ID 
-000113d0: 746f 2069 6e64 6963 6174 6520 6e6f 2064  to indicate no d
-000113e0: 6174 6120 0d0a 2020 2020 2020 2020 2020  ata ..          
-000113f0: 2020 756e 6974 735f 6461 7461 3d75 6e69    units_data=uni
-00011400: 7473 2e63 6f70 7928 290d 0a20 2020 2020  ts.copy()..     
-00011410: 2020 2069 6620 6661 6369 6573 2069 7320     if facies is 
-00011420: 4e6f 6e65 2061 6e64 2065 7874 7261 6374  None and extract
-00011430: 4661 6369 6573 3a0d 0a20 2020 2020 2020  Facies:..       
-00011440: 2020 2020 2066 6163 6965 7320 3d20 7365       facies = se
-00011450: 6c66 2e67 6574 5f66 6163 6965 7328 290d  lf.get_facies().
-00011460: 0a20 2020 2020 2020 2020 2020 2066 6163  .            fac
-00011470: 6965 735f 6461 7461 3d66 6163 6965 732e  ies_data=facies.
-00011480: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
-00011490: 2020 2020 2320 6661 6369 6573 5f64 6174      # facies_dat
-000114a0: 615b 6e70 2e69 736e 616e 2866 6163 6965  a[np.isnan(facie
-000114b0: 735f 6461 7461 295d 3d2d 3939 2020 2320  s_data)]=-99  # 
-000114c0: 7361 6d65 2066 6f72 2066 6163 6965 730d  same for facies.
-000114d0: 0a0d 0a20 2020 2020 2020 2023 6368 616e  ...        #chan
-000114e0: 6765 2069 6e74 6f20 6172 7261 790d 0a0d  ge into array...
-000114f0: 0a20 2020 2020 2020 2069 6620 7479 7065  .        if type
-00011500: 2870 6f73 6974 696f 6e73 5f78 2920 6973  (positions_x) is
-00011510: 206e 6f74 206e 702e 6e64 6172 7261 793a   not np.ndarray:
-00011520: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
-00011530: 7369 7469 6f6e 735f 7820 3d20 6e70 2e61  sitions_x = np.a
-00011540: 7272 6179 285b 706f 7369 7469 6f6e 735f  rray([positions_
-00011550: 785d 290d 0a20 2020 2020 2020 2069 6620  x])..        if 
-00011560: 7479 7065 2870 6f73 6974 696f 6e73 5f79  type(positions_y
-00011570: 2920 6973 206e 6f74 206e 702e 6e64 6172  ) is not np.ndar
-00011580: 7261 793a 0d0a 2020 2020 2020 2020 2020  ray:..          
-00011590: 2020 706f 7369 7469 6f6e 735f 7920 3d20    positions_y = 
-000115a0: 6e70 2e61 7272 6179 285b 706f 7369 7469  np.array([positi
-000115b0: 6f6e 735f 795d 290d 0a20 2020 2020 2020  ons_y])..       
-000115c0: 2069 6620 7479 7065 2873 7472 6174 496e   if type(stratIn
-000115d0: 6465 7829 2069 7320 696e 743a 0d0a 2020  dex) is int:..  
-000115e0: 2020 2020 2020 2020 2020 7374 7261 7449            stratI
-000115f0: 6e64 6578 203d 206e 702e 6172 7261 7928  ndex = np.array(
-00011600: 5b73 7472 6174 496e 6465 785d 290d 0a20  [stratIndex]).. 
-00011610: 2020 2020 2020 2069 6620 7479 7065 2866         if type(f
-00011620: 6163 6965 7349 6e64 6578 2920 6973 2069  aciesIndex) is i
-00011630: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
-00011640: 2066 6163 6965 7349 6e64 6578 203d 206e   faciesIndex = n
-00011650: 702e 6172 7261 7928 5b66 6163 6965 7349  p.array([faciesI
-00011660: 6e64 6578 5d29 0d0a 0d0a 0d0a 2020 2020  ndex])......    
-00011670: 2020 2020 6c5f 706f 7320 3d20 5b5d 0d0a      l_pos = []..
-00011680: 2020 2020 2020 2020 666f 7220 782c 7920          for x,y 
-00011690: 696e 207a 6970 2870 6f73 6974 696f 6e73  in zip(positions
-000116a0: 5f78 2c70 6f73 6974 696f 6e73 5f79 293a  _x,positions_y):
-000116b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000116c0: 6365 6c6c 5f78 2c20 6365 6c6c 5f79 2c20  cell_x, cell_y, 
-000116d0: 7a20 3d20 7365 6c66 2e70 6f69 6e74 546f  z = self.pointTo
-000116e0: 496e 6465 7828 782c 792c 3129 0d0a 2020  Index(x,y,1)..  
-000116f0: 2020 2020 2020 2020 2020 6c5f 706f 732e            l_pos.
-00011700: 6170 7065 6e64 2828 6365 6c6c 5f78 2c20  append((cell_x, 
-00011710: 6365 6c6c 5f79 2c20 7a29 290d 0a20 2020  cell_y, z))..   
-00011720: 2020 2020 200d 0a20 2020 2020 2020 2075       ..        u
-00011730: 5f6c 6973 7420 3d20 5b5d 0d0a 2020 2020  _list = []..    
-00011740: 2020 2020 666f 7220 6975 2069 6e20 7374      for iu in st
-00011750: 7261 7449 6e64 6578 3a0d 0a20 2020 2020  ratIndex:..     
-00011760: 2020 2020 2020 2066 615f 6c69 7374 203d         fa_list =
-00011770: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
-00011780: 2066 6f72 2069 6661 2069 6e20 6661 6369   for ifa in faci
-00011790: 6573 496e 6465 783a 0d0a 2020 2020 2020  esIndex:..      
-000117a0: 2020 2020 2020 2020 2020 6661 6b65 5f62            fake_b
-000117b0: 6820 3d20 5b5d 0d0a 2020 2020 2020 2020  h = []..        
-000117c0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
-000117d0: 2072 616e 6765 286c 656e 2870 6f73 6974   range(len(posit
-000117e0: 696f 6e73 5f78 2929 3a0d 0a0d 0a20 2020  ions_x)):....   
-000117f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011800: 2063 656c 6c5f 782c 2063 656c 6c5f 792c   cell_x, cell_y,
-00011810: 207a 203d 206c 5f70 6f73 5b69 5d20 0d0a   z = l_pos[i] ..
-00011820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011830: 2020 2020 7820 3d20 706f 7369 7469 6f6e      x = position
-00011840: 735f 785b 695d 0d0a 2020 2020 2020 2020  s_x[i]..        
-00011850: 2020 2020 2020 2020 2020 2020 7920 3d20              y = 
-00011860: 706f 7369 7469 6f6e 735f 795b 695d 0d0a  positions_y[i]..
-00011870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011880: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-00011890: 2020 2020 2020 2020 2020 6966 2065 7874            if ext
-000118a0: 7261 6374 556e 6974 733a 0d0a 2020 2020  ractUnits:..    
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 2020 2020 2375 6e69 7420 6c6f 670d 0a20      #unit log.. 
-000118d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118e0: 2020 2020 2020 2075 6e69 745f 6c6f 6720         unit_log 
-000118f0: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
-00011900: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00011910: 6974 5f69 6478 203d 2075 6e69 7473 5f64  it_idx = units_d
-00011920: 6174 615b 6975 2c20 3a2c 2063 656c 6c5f  ata[iu, :, cell_
-00011930: 792c 2063 656c 6c5f 785d 0d0a 2020 2020  y, cell_x]..    
-00011940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011950: 2020 2020 6966 2075 6e69 745f 6964 785b      if unit_idx[
-00011960: 2d31 5d20 213d 2030 3a0d 0a20 2020 2020  -1] != 0:..     
-00011970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011980: 2020 2020 2020 2075 6e69 745f 6c6f 672e         unit_log.
-00011990: 6170 7065 6e64 2828 7365 6c66 2e67 6574  append((self.get
-000119a0: 5f75 6e69 7428 4944 203d 2075 6e69 745f  _unit(ID = unit_
-000119b0: 6964 785b 2d31 5d2c 2074 7970 653d 2749  idx[-1], type='I
-000119c0: 4427 2c20 7662 3d30 292c 206e 702e 726f  D', vb=0), np.ro
-000119d0: 756e 6428 7365 6c66 2e7a 675b 2d31 5d2c  und(self.zg[-1],
-000119e0: 2032 2929 290d 0a0d 0a20 2020 2020 2020   2)))....       
-000119f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a00: 2066 6f72 2069 6e64 6578 5f74 7261 6e73   for index_trans
-00011a10: 2069 6e20 7265 7665 7273 6564 286e 702e   in reversed(np.
-00011a20: 7768 6572 6528 6e70 2e64 6966 6628 756e  where(np.diff(un
-00011a30: 6974 5f69 6478 2920 213d 2030 295b 305d  it_idx) != 0)[0]
-00011a40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00011a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011a60: 756e 6974 5f6c 6f67 2e61 7070 656e 6428  unit_log.append(
-00011a70: 2873 656c 662e 6765 745f 756e 6974 2849  (self.get_unit(I
-00011a80: 4420 3d75 6e69 745f 6964 785b 696e 6465  D =unit_idx[inde
-00011a90: 785f 7472 616e 735d 2c20 7479 7065 3d27  x_trans], type='
-00011aa0: 4944 272c 2076 623d 3029 2c20 6e70 2e72  ID', vb=0), np.r
-00011ab0: 6f75 6e64 2873 656c 662e 7a67 5b69 6e64  ound(self.zg[ind
-00011ac0: 6578 5f74 7261 6e73 2b31 5d2c 2032 2929  ex_trans+1], 2))
-00011ad0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00011ae0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00011af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b00: 2020 2020 2020 756e 6974 5f6c 6f67 3d4e        unit_log=N
-00011b10: 6f6e 650d 0a0d 0a20 2020 2020 2020 2020  one....         
-00011b20: 2020 2020 2020 2020 2020 2023 6661 6369             #faci
-00011b30: 6573 206c 6f67 0d0a 2020 2020 2020 2020  es log..        
-00011b40: 2020 2020 2020 2020 2020 2020 6966 2065              if e
-00011b50: 7874 7261 6374 4661 6369 6573 3a0d 0a20  xtractFacies:.. 
-00011b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b70: 2020 2020 2020 2066 6163 6965 735f 6c6f         facies_lo
-00011b80: 6720 3d20 5b5d 0d0a 2020 2020 2020 2020  g = []..        
-00011b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ba0: 6661 6369 6573 5f69 6478 203d 2066 6163  facies_idx = fac
-00011bb0: 6965 735f 6461 7461 5b69 752c 2069 6661  ies_data[iu, ifa
-00011bc0: 2c20 3a2c 2063 656c 6c5f 792c 2063 656c  , :, cell_y, cel
-00011bd0: 6c5f 785d 0d0a 2020 2020 2020 2020 2020  l_x]..          
-00011be0: 2020 2020 2020 2020 2020 2020 2020 2349                #I
-00011bf0: 6620 6d6f 6465 6c20 6861 7320 6e6f 2066  f model has no f
-00011c00: 7265 6520 7370 6163 6520 6162 6f76 652c  ree space above,
-00011c10: 2077 6520 6e65 6564 2074 6f20 6164 6420   we need to add 
-00011c20: 7468 6520 7472 616e 7369 7469 6f6e 2053  the transition S
-00011c30: 7572 6661 6365 202d 2066 6972 7374 206c  urface - first l
-00011c40: 6179 6572 0d0a 2020 2020 2020 2020 2020  ayer..          
-00011c50: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011c60: 2066 6163 6965 735f 6964 785b 2d31 5d20   facies_idx[-1] 
-00011c70: 213d 2030 3a0d 0a20 2020 2020 2020 2020  != 0:..         
-00011c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c90: 2020 2066 6163 6965 735f 6c6f 672e 6170     facies_log.ap
-00011ca0: 7065 6e64 2828 7365 6c66 2e67 6574 5f66  pend((self.get_f
-00011cb0: 6163 6965 735f 6f62 6a28 4944 203d 2066  acies_obj(ID = f
-00011cc0: 6163 6965 735f 6964 785b 2d31 5d2c 2074  acies_idx[-1], t
-00011cd0: 7970 653d 2749 4427 2c20 7662 3d30 292c  ype='ID', vb=0),
-00011ce0: 206e 702e 726f 756e 6428 7365 6c66 2e7a   np.round(self.z
-00011cf0: 675b 2d31 5d2c 2032 2929 290d 0a0d 0a20  g[-1], 2))).... 
-00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d10: 2020 2020 2020 2066 6f72 2069 6e64 6578         for index
-00011d20: 5f74 7261 6e73 2069 6e20 7265 7665 7273  _trans in revers
-00011d30: 6564 286e 702e 7768 6572 6528 6e70 2e64  ed(np.where(np.d
-00011d40: 6966 6628 6661 6369 6573 5f69 6478 2920  iff(facies_idx) 
-00011d50: 213d 2030 295b 305d 293a 0d0a 2020 2020  != 0)[0]):..    
-00011d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011d70: 2020 2020 2020 2020 6661 5f6f 626a 3d73          fa_obj=s
-00011d80: 656c 662e 6765 745f 6661 6369 6573 5f6f  elf.get_facies_o
-00011d90: 626a 2849 4420 3d66 6163 6965 735f 6964  bj(ID =facies_id
-00011da0: 785b 696e 6465 785f 7472 616e 735d 2c20  x[index_trans], 
-00011db0: 7479 7065 3d27 4944 272c 2076 623d 3029  type='ID', vb=0)
-00011dc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011dd0: 2020 2020 2020 2020 2020 2020 2020 697a                iz
-00011de0: 3d6e 702e 726f 756e 6428 7365 6c66 2e7a  =np.round(self.z
-00011df0: 675b 696e 6465 785f 7472 616e 732b 315d  g[index_trans+1]
-00011e00: 2c20 3229 0d0a 2020 2020 2020 2020 2020  , 2)..          
+0000fc30: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0000fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc50: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
+0000fc60: 2020 2020 2020 2020 2020 2020 2020 0d0a                ..
+0000fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc80: 2020 2020 2320 7570 6461 7465 2064 6570      # update dep
+0000fc90: 7468 0d0a 2020 2020 2020 2020 2020 2020  th..            
+0000fca0: 2020 2020 2020 2020 6268 2e64 6570 7468          bh.depth
+0000fcb0: 203d 2062 682e 6465 7074 6820 2d20 2862   = bh.depth - (b
+0000fcc0: 682e 7a20 2d20 697a 290d 0a20 2020 2020  h.z - iz)..     
+0000fcd0: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+0000fce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fcf0: 2020 2020 2063 7574 5f62 6f74 6f6d 2862       cut_botom(b
+0000fd00: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+0000fd10: 2020 2020 2020 2020 6966 2062 682e 6465          if bh.de
+0000fd20: 7074 6820 3c20 303a 0d0a 2020 2020 2020  pth < 0:..      
+0000fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd40: 2020 7265 7475 726e 2030 0d0a 2020 2020    return 0..    
+0000fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fd60: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0000fd70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000fd80: 6574 7572 6e20 310d 0a0d 0a20 2020 2020  eturn 1....     
+0000fd90: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0000fda0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0000fdb0: 2070 7269 6e74 2822 426f 7265 686f 6c65   print("Borehole
+0000fdc0: 207b 7d20 6f75 7473 6964 6520 6f66 2074   {} outside of t
+0000fdd0: 6865 2073 696d 756c 6174 696f 6e20 7a6f  he simulation zo
+0000fde0: 6e65 202d 206e 6f74 2061 6464 6564 202d  ne - not added -
+0000fdf0: 222e 666f 726d 6174 2862 682e 4944 2929  ".format(bh.ID))
+0000fe00: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000fe10: 2030 0d0a 0d0a 2020 2020 6465 6620 636f   0....    def co
+0000fe20: 6f72 6432 6365 6c6c 2873 656c 662c 2078  ord2cell(self, x
+0000fe30: 2c20 792c 207a 3d4e 6f6e 6529 3a0d 0a0d  , y, z=None):...
+0000fe40: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0000fe50: 2020 2020 2020 4d65 7468 6f64 2074 6861        Method tha
+0000fe60: 7420 7265 7475 726e 7320 7468 6520 6365  t returns the ce
+0000fe70: 6c6c 2069 6e20 7768 6963 6820 6172 6520  ll in which are 
+0000fe80: 7468 6520 6769 7665 6e20 636f 6f72 6469  the given coordi
+0000fe90: 6e61 7465 730d 0a0d 0a20 2020 2020 2020  nates....       
+0000fea0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0000feb0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0000fec0: 0a20 2020 2020 2020 2078 3a20 666c 6f61  .        x: floa
+0000fed0: 740d 0a20 2020 2020 2020 2020 2020 2078  t..            x
+0000fee0: 2063 6f6f 7264 696e 6174 650d 0a20 2020   coordinate..   
+0000fef0: 2020 2020 2079 3a20 666c 6f61 740d 0a20       y: float.. 
+0000ff00: 2020 2020 2020 2020 2020 2079 2063 6f6f             y coo
+0000ff10: 7264 696e 6174 650d 0a20 2020 2020 2020  rdinate..       
+0000ff20: 207a 3a20 666c 6f61 742c 206f 7074 696f   z: float, optio
+0000ff30: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0000ff40: 207a 2063 6f6f 7264 696e 6174 652c 2069   z coordinate, i
+0000ff50: 6620 7a20 6973 204e 6f6e 652c 206f 6e6c  f z is None, onl
+0000ff60: 7920 7820 616e 6420 7920 696e 6465 7865  y x and y indexe
+0000ff70: 7320 6172 6520 7265 7475 726e 6564 0d0a  s are returned..
+0000ff80: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000ff90: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000ffa0: 2d2d 0d0a 2020 2020 2020 2020 6365 6c6c  --..        cell
+0000ffb0: 3a20 7475 706c 650d 0a20 2020 2020 2020  : tuple..       
+0000ffc0: 2020 2020 2063 656c 6c20 696e 6465 7865       cell indexe
+0000ffd0: 7320 2869 782c 2069 792c 2069 7a29 206f  s (ix, iy, iz) o
+0000ffe0: 7220 2869 782c 2069 7929 2069 6620 7a20  r (ix, iy) if z 
+0000fff0: 6973 204e 6f6e 650d 0a20 2020 2020 2020  is None..       
+00010000: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+00010010: 6173 7365 7274 2079 203d 3d20 792c 2022  assert y == y, "
+00010020: 636f 6f72 6469 6e61 7465 7320 636f 6e74  coordinates cont
+00010030: 6169 6e20 4e61 4e22 0d0a 2020 2020 2020  ain NaN"..      
+00010040: 2020 6173 7365 7274 2078 203d 3d20 782c    assert x == x,
+00010050: 2022 636f 6f72 6469 6e61 7465 7320 636f   "coordinates co
+00010060: 6e74 6169 6e20 4e61 4e22 0d0a 0d0a 2020  ntain NaN"....  
+00010070: 2020 2020 2020 6966 207a 2069 7320 6e6f        if z is no
+00010080: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00010090: 2020 2020 2061 7373 6572 7420 7a20 3d3d       assert z ==
+000100a0: 207a 2c20 2263 6f6f 7264 696e 6174 6573   z, "coordinates
+000100b0: 2063 6f6e 7461 696e 204e 614e 220d 0a0d   contain NaN"...
+000100c0: 0a20 2020 2020 2020 2078 673d 7365 6c66  .        xg=self
+000100d0: 2e67 6574 5f78 6728 290d 0a20 2020 2020  .get_xg()..     
+000100e0: 2020 2079 673d 7365 6c66 2e67 6574 5f79     yg=self.get_y
+000100f0: 6728 290d 0a20 2020 2020 2020 207a 673d  g()..        zg=
+00010100: 7365 6c66 2e67 6574 5f7a 6728 290d 0a20  self.get_zg().. 
+00010110: 2020 2020 2020 2073 783d 7365 6c66 2e67         sx=self.g
+00010120: 6574 5f73 7828 290d 0a20 2020 2020 2020  et_sx()..       
+00010130: 2073 793d 7365 6c66 2e67 6574 5f73 7928   sy=self.get_sy(
+00010140: 290d 0a20 2020 2020 2020 2073 7a3d 7365  )..        sz=se
+00010150: 6c66 2e67 6574 5f73 7a28 290d 0a20 2020  lf.get_sz()..   
+00010160: 2020 2020 206e 7a3d 7365 6c66 2e67 6574       nz=self.get
+00010170: 5f6e 7a28 290d 0a0d 0a20 2020 2020 2020  _nz()....       
+00010180: 2023 2063 6865 636b 2070 6f69 6e74 2069   # check point i
+00010190: 6e73 6964 6520 7369 6d75 6c61 7469 6f6e  nside simulation
+000101a0: 2062 6c6f 636b 0d0a 2020 2020 2020 2020   block..        
+000101b0: 6966 2028 7820 3c3d 2078 675b 305d 2920  if (x <= xg[0]) 
+000101c0: 6f72 2028 7820 3e3d 2078 675b 2d31 5d29  or (x >= xg[-1])
+000101d0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+000101e0: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
+000101f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010200: 2070 7269 6e74 2822 706f 696e 7420 6f75   print("point ou
+00010210: 7473 6964 6520 6f66 2074 6865 2067 7269  tside of the gri
+00010220: 6420 696e 2078 2229 0d0a 2020 2020 2020  d in x")..      
+00010230: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00010240: 650d 0a20 2020 2020 2020 2069 6620 2879  e..        if (y
+00010250: 203c 3d20 7967 5b30 5d29 206f 7220 2879   <= yg[0]) or (y
+00010260: 203e 3d20 7967 5b2d 315d 293a 0d0a 2020   >= yg[-1]):..  
+00010270: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00010280: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00010290: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000102a0: 7428 2270 6f69 6e74 206f 7574 7369 6465  t("point outside
+000102b0: 206f 6620 7468 6520 6772 6964 2069 6e20   of the grid in 
+000102c0: 7922 290d 0a20 2020 2020 2020 2020 2020  y")..           
+000102d0: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
+000102e0: 2020 2020 2020 2020 6966 207a 2069 7320          if z is 
+000102f0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00010300: 2020 2020 2020 2069 6620 287a 203c 3d20         if (z <= 
+00010310: 7a67 5b30 5d29 206f 7220 287a 203e 207a  zg[0]) or (z > z
+00010320: 675b 2d31 5d29 3a0d 0a20 2020 2020 2020  g[-1]):..       
+00010330: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00010340: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00010350: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00010360: 7269 6e74 2822 706f 696e 7420 6f75 7473  rint("point outs
+00010370: 6964 6520 6f66 2074 6865 2067 7269 6420  ide of the grid 
+00010380: 696e 207a 2229 0d0a 2020 2020 2020 2020  in z")..        
+00010390: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+000103a0: 6f6e 650d 0a0d 0a20 2020 2020 2020 2069  one....        i
+000103b0: 783d 2828 782d 7867 5b30 5d29 2f2f 7378  x=((x-xg[0])//sx
+000103c0: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
+000103d0: 2020 2020 2020 2069 793d 2828 792d 7967         iy=((y-yg
+000103e0: 5b30 5d29 2f2f 7379 292e 6173 7479 7065  [0])//sy).astype
+000103f0: 2869 6e74 290d 0a0d 0a20 2020 2020 2020  (int)....       
+00010400: 2069 6620 7a20 6973 206e 6f74 204e 6f6e   if z is not Non
+00010410: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00010420: 697a 3d28 287a 2d7a 675b 305d 292f 2f73  iz=((z-zg[0])//s
+00010430: 7a29 2e61 7374 7970 6528 696e 7429 0d0a  z).astype(int)..
+00010440: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00010450: 7a20 3e20 6e7a 2d31 3a0d 0a20 2020 2020  z > nz-1:..     
+00010460: 2020 2020 2020 2020 2020 2069 7a3d 6e7a             iz=nz
+00010470: 2d31 0d0a 0d0a 2020 2020 2020 2020 2020  -1....          
+00010480: 2020 6365 6c6c 3d28 697a 2c20 6979 2c20    cell=(iz, iy, 
+00010490: 6978 290d 0a20 2020 2020 2020 2020 2020  ix)..           
+000104a0: 2069 6620 7365 6c66 2e6d 6173 6b5b 697a   if self.mask[iz
+000104b0: 2c20 6979 2c20 6978 5d3a 0d0a 2020 2020  , iy, ix]:..    
+000104c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000104d0: 726e 2063 656c 6c0d 0a20 2020 2020 2020  rn cell..       
+000104e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000104f0: 2020 2020 2020 2020 2020 2020 2370 7269              #pri
+00010500: 6e74 2822 506f 696e 7420 6f75 7473 6964  nt("Point outsid
+00010510: 6520 6f66 2074 6865 2073 696d 756c 6174  e of the simulat
+00010520: 696f 6e20 646f 6d61 696e 2229 0d0a 2020  ion domain")..  
+00010530: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00010540: 7475 726e 204e 6f6e 650d 0a20 2020 2020  turn None..     
+00010550: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00010560: 2020 2020 2020 6365 6c6c 203d 2028 6979        cell = (iy
+00010570: 2c20 6978 290d 0a20 2020 2020 2020 2020  , ix)..         
+00010580: 2020 2072 6574 7572 6e20 6365 6c6c 0d0a     return cell..
+00010590: 0d0a 2020 2020 6465 6620 6164 645f 7072  ..    def add_pr
+000105a0: 6f70 2873 656c 662c 2070 726f 7029 3a0d  op(self, prop):.
+000105b0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+000105c0: 2020 2020 2020 2020 4164 6420 6120 7072          Add a pr
+000105d0: 6f70 6572 7479 2074 6f20 7468 6520 4172  operty to the Ar
+000105e0: 6368 5f54 6162 6c65 0d0a 0d0a 2020 2020  ch_Table....    
+000105f0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00010600: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00010610: 2d2d 0d0a 2020 2020 2020 2020 7072 6f70  --..        prop
+00010620: 3a20 3a63 6c61 7373 3a60 5072 6f70 6020  : :class:`Prop` 
+00010630: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
+00010640: 2020 2020 7072 6f70 6572 7479 2074 6f20      property to 
+00010650: 6164 6420 746f 2074 6865 2041 7263 685f  add to the Arch_
+00010660: 5461 626c 650d 0a20 2020 2020 2020 200d  Table..        .
+00010670: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00010680: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00010690: 2d0d 0a20 2020 2020 2020 204e 6f6e 650d  -..        None.
+000106a0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+000106b0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+000106c0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+000106d0: 696e 2070 726f 703a 0d0a 2020 2020 2020  in prop:..      
+000106e0: 2020 2020 2020 2020 2020 6966 2028 6973            if (is
+000106f0: 696e 7374 616e 6365 2869 2c20 5072 6f70  instance(i, Prop
+00010700: 2929 2061 6e64 2028 6920 6e6f 7420 696e  )) and (i not in
+00010710: 2073 656c 662e 6c69 7374 5f70 726f 7073   self.list_props
+00010720: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00010730: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+00010740: 745f 7072 6f70 732e 6170 7065 6e64 2869  t_props.append(i
+00010750: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00010760: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+00010770: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00010780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010790: 2070 7269 6e74 2822 5072 6f70 6572 7479   print("Property
+000107a0: 207b 7d20 6164 6465 6422 2e66 6f72 6d61   {} added".forma
+000107b0: 7428 692e 6e61 6d65 2929 0d0a 2020 2020  t(i.name))..    
+000107c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000107d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000107e0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000107f0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00010800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010810: 2070 7269 6e74 2822 6f62 6a65 6374 2069   print("object i
+00010820: 736e 2774 2061 2050 726f 7065 7274 7920  sn't a Property 
+00010830: 6f62 6a65 6374 206f 7220 6974 2069 7320  object or it is 
+00010840: 616c 7265 6164 7920 696e 2074 6865 206c  already in the l
+00010850: 6973 7422 290d 0a20 2020 2020 2020 2065  ist")..        e
+00010860: 7863 6570 743a 2023 2073 7472 6174 6920  xcept: # strati 
+00010870: 6e6f 7420 696e 2061 206c 6973 740d 0a20  not in a list.. 
+00010880: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
+00010890: 7369 6e73 7461 6e63 6528 7072 6f70 2c20  sinstance(prop, 
+000108a0: 5072 6f70 2929 2061 6e64 2028 7072 6f70  Prop)) and (prop
+000108b0: 206e 6f74 2069 6e20 7365 6c66 2e6c 6973   not in self.lis
+000108c0: 745f 7072 6f70 7329 3a0d 0a20 2020 2020  t_props):..     
+000108d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000108e0: 6c69 7374 5f70 726f 7073 2e61 7070 656e  list_props.appen
+000108f0: 6428 7072 6f70 290d 0a20 2020 2020 2020  d(prop)..       
+00010900: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00010910: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00010920: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00010930: 7269 6e74 2822 5072 6f70 6572 7479 207b  rint("Property {
+00010940: 7d20 6164 6465 6422 2e66 6f72 6d61 7428  } added".format(
+00010950: 7072 6f70 2e6e 616d 6529 290d 0a20 2020  prop.name))..   
+00010960: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00010970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010980: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+00010990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000109a0: 2020 2020 2020 7072 696e 7428 226f 626a        print("obj
+000109b0: 6563 7420 6973 6e27 7420 6120 5072 6f70  ect isn't a Prop
+000109c0: 6572 7479 206f 626a 6563 7422 290d 0a0d  erty object")...
+000109d0: 0a20 2020 2064 6566 2061 6464 5f62 6828  .    def add_bh(
+000109e0: 7365 6c66 2c20 6268 7329 3a0d 0a0d 0a20  self, bhs):.... 
+000109f0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00010a00: 2020 2020 4d65 7468 6f64 2074 6f20 6164      Method to ad
+00010a10: 6420 626f 7265 686f 6c65 2c20 6c69 7374  d borehole, list
+00010a20: 206f 6620 626f 7265 686f 6c65 7320 6966   of boreholes if
+00010a30: 206d 756c 7469 706c 6573 0d0a 0d0a 2020   multiples....  
+00010a40: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00010a50: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00010a60: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6268  ----..        bh
+00010a70: 733a 203a 636c 6173 733a 6062 6f72 6568  s: :class:`boreh
+00010a80: 6f6c 6560 206f 626a 6563 7420 6f72 206c  ole` object or l
+00010a90: 6973 7420 6f66 203a 636c 6173 733a 6062  ist of :class:`b
+00010aa0: 6f72 6568 6f6c 6560 206f 626a 6563 7473  orehole` objects
+00010ab0: 0d0a 2020 2020 2020 2020 2020 2020 626f  ..            bo
+00010ac0: 7265 686f 6c65 2873 2920 746f 2061 6464  rehole(s) to add
+00010ad0: 2074 6f20 7468 6520 4172 6368 5f54 6162   to the Arch_Tab
+00010ae0: 6c65 0d0a 2020 2020 2020 2020 2222 220d  le..        """.
+00010af0: 0a0d 0a20 2020 2020 2020 2069 6620 6861  ...        if ha
+00010b00: 7361 7474 7228 6268 732c 2022 5f5f 6974  sattr(bhs, "__it
+00010b10: 6572 5f5f 2229 3a0d 0a20 2020 2020 2020  er__"):..       
+00010b20: 2020 2020 2066 6f72 2069 2069 6e20 6268       for i in bh
+00010b30: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00010b40: 2020 2020 6966 2028 6973 696e 7374 616e      if (isinstan
+00010b50: 6365 2869 2c20 626f 7265 686f 6c65 2929  ce(i, borehole))
+00010b60: 2061 6e64 2028 6920 6e6f 7420 696e 2073   and (i not in s
+00010b70: 656c 662e 6c69 7374 5f62 6873 293a 0d0a  elf.list_bhs):..
+00010b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b90: 2020 2020 6966 2073 656c 662e 6368 6563      if self.chec
+00010ba0: 6b5f 6268 5f69 6e73 6964 6528 6929 3a0d  k_bh_inside(i):.
+00010bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010bc0: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
+00010bd0: 7374 5f62 6873 2e61 7070 656e 6428 6929  st_bhs.append(i)
+00010be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010bf0: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
+00010c00: 6873 5f70 726f 6365 7373 6564 203d 2030  hs_processed = 0
+00010c10: 2020 2320 7265 7365 7420 666c 6167 206f    # reset flag o
+00010c20: 6620 626f 7265 686f 6c65 7320 616c 7265  f boreholes alre
+00010c30: 6164 7920 7072 6f63 6573 7365 640d 0a20  ady processed.. 
+00010c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c50: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+00010c60: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00010c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c80: 2020 2020 2070 7269 6e74 2822 426f 7265       print("Bore
+00010c90: 686f 6c65 207b 7d20 6164 6465 6422 2e66  hole {} added".f
+00010ca0: 6f72 6d61 7428 692e 4944 2929 0d0a 2020  ormat(i.ID))..  
+00010cb0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00010cc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00010cd0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00010ce0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00010cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d00: 2020 2070 7269 6e74 2822 6f62 6a65 6374     print("object
+00010d10: 2069 736e 2774 2061 2062 6f72 6568 6f6c   isn't a borehol
+00010d20: 6520 6f62 6a65 6374 206f 7220 6f62 6a65  e object or obje
+00010d30: 6374 2069 7320 616c 7265 6164 7920 696e  ct is already in
+00010d40: 2074 6865 206c 6973 7422 290d 0a0d 0a20   the list").... 
+00010d50: 2020 2020 2020 2065 6c73 653a 2023 2062         else: # b
+00010d60: 6f72 6568 6f6c 6573 206e 6f74 2069 6e20  oreholes not in 
+00010d70: 6120 6c69 7374 0d0a 2020 2020 2020 2020  a list..        
+00010d80: 2020 2020 6966 2028 6973 696e 7374 616e      if (isinstan
+00010d90: 6365 2862 6873 2c20 626f 7265 686f 6c65  ce(bhs, borehole
+00010da0: 2929 2061 6e64 2028 6268 7320 6e6f 7420  )) and (bhs not 
+00010db0: 696e 2073 656c 662e 6c69 7374 5f62 6873  in self.list_bhs
+00010dc0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00010dd0: 2020 2020 6966 2073 656c 662e 6368 6563      if self.chec
+00010de0: 6b5f 6268 5f69 6e73 6964 6528 6268 7329  k_bh_inside(bhs)
+00010df0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00010e00: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
+00010e10: 5f62 6873 2e61 7070 656e 6428 6268 7329  _bhs.append(bhs)
+00010e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010e30: 2020 2020 2020 7365 6c66 2e62 6873 5f70        self.bhs_p
+00010e40: 726f 6365 7373 6564 203d 2030 2020 2320  rocessed = 0  # 
+00010e50: 7265 7365 7420 666c 6167 206f 6620 626f  reset flag of bo
+00010e60: 7265 686f 6c65 7320 616c 7265 6164 7920  reholes already 
+00010e70: 7072 6f63 6573 7365 6420 0d0a 2020 2020  processed ..    
+00010e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e90: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+00010ea0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010eb0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00010ec0: 2242 6f72 6568 6f6c 6520 7b7d 2061 6464  "Borehole {} add
+00010ed0: 6564 222e 666f 726d 6174 2862 6873 2e49  ed".format(bhs.I
+00010ee0: 4429 290d 0a20 2020 2020 2020 2020 2020  D))..           
+00010ef0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00010f00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00010f10: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+00010f20: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00010f30: 696e 7428 226f 626a 6563 7420 6973 6e27  int("object isn'
+00010f40: 7420 6120 626f 7265 686f 6c65 206f 626a  t a borehole obj
+00010f50: 6563 7420 6f72 206f 626a 6563 7420 6973  ect or object is
+00010f60: 2061 6c72 6561 6479 2069 6e20 7468 6520   already in the 
+00010f70: 6c69 7374 2229 0d0a 0d0a 2020 2020 6465  list")....    de
+00010f80: 6620 6d61 6b65 5f66 616b 655f 6268 2873  f make_fake_bh(s
+00010f90: 656c 662c 2070 6f73 6974 696f 6e73 5f78  elf, positions_x
+00010fa0: 2c20 706f 7369 7469 6f6e 735f 792c 2075  , positions_y, u
+00010fb0: 6e69 7473 3d4e 6f6e 652c 2066 6163 6965  nits=None, facie
+00010fc0: 733d 4e6f 6e65 2c20 7374 7261 7449 6e64  s=None, stratInd
+00010fd0: 6578 3d30 2c20 6661 6369 6573 496e 6465  ex=0, faciesInde
+00010fe0: 783d 302c 2065 7874 7261 6374 556e 6974  x=0, extractUnit
+00010ff0: 733d 5472 7565 2c20 6578 7472 6163 7446  s=True, extractF
+00011000: 6163 6965 733d 5472 7565 2c20 7662 3d31  acies=True, vb=1
+00011010: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+00011020: 220d 0a20 2020 2020 2020 2043 7265 6174  "..        Creat
+00011030: 6520 6661 6b65 2062 6f72 6568 6f6c 6573  e fake boreholes
+00011040: 2066 726f 6d20 7265 616c 697a 6174 696f   from realizatio
+00011050: 6e20 6f66 2074 6865 2041 7263 685f 7461  n of the Arch_ta
+00011060: 626c 652e 0d0a 0d0a 0d0a 2020 2020 2020  ble.......      
+00011070: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00011080: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00011090: 0d0a 2020 2020 2020 2020 706f 7369 7469  ..        positi
+000110a0: 6f6e 735f 783a 2073 6571 7565 6e63 6520  ons_x: sequence 
+000110b0: 6f66 206e 756d 6265 7273 0d0a 2020 2020  of numbers..    
+000110c0: 2020 2020 2020 2020 696e 6469 6361 7465          indicate
+000110d0: 2074 6865 2078 2070 6f73 6974 696f 6e73   the x positions
+000110e0: 206f 6620 7468 6520 626f 7265 686f 6c65   of the borehole
+000110f0: 2074 6f20 6372 6561 7465 2062 6873 0d0a   to create bhs..
+00011100: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00011110: 735f 793a 2073 6571 7565 6e63 6520 6f66  s_y: sequence of
+00011120: 206e 756d 6265 7273 0d0a 2020 2020 2020   numbers..      
+00011130: 2020 2020 2020 696e 6469 6361 7465 2074        indicate t
+00011140: 6865 2079 2070 6f73 6974 696f 6e73 206f  he y positions o
+00011150: 6620 7468 6520 626f 7265 686f 6c65 2074  f the borehole t
+00011160: 6f20 6372 6561 7465 2062 6873 0d0a 2020  o create bhs..  
+00011170: 2020 2020 2020 756e 6974 733a 2033 4420        units: 3D 
+00011180: 6172 7261 792c 206f 7074 696f 6e61 6c0d  array, optional.
+00011190: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
+000111a0: 7420 6172 7261 7920 746f 2075 7365 2074  t array to use t
+000111b0: 6f20 6372 6561 7465 2062 6873 0d0a 2020  o create bhs..  
+000111c0: 2020 2020 2020 6661 6369 6573 3a20 3344        facies: 3D
+000111d0: 2061 7272 6179 2c20 6f70 7469 6f6e 616c   array, optional
+000111e0: 0d0a 2020 2020 2020 2020 2020 2020 6661  ..            fa
+000111f0: 6369 6573 2061 7272 6179 2074 6f20 7573  cies array to us
+00011200: 6520 746f 2063 7265 6174 6520 6268 730d  e to create bhs.
+00011210: 0a20 2020 2020 2020 2073 7472 6174 496e  .        stratIn
+00011220: 6465 783a 2069 6e74 206f 7220 7365 7175  dex: int or sequ
+00011230: 656e 6365 206f 6620 696e 742c 206f 7074  ence of int, opt
+00011240: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+00011250: 2020 2075 6e69 7420 696e 6465 7820 746f     unit index to
+00011260: 2073 616d 706c 650d 0a20 2020 2020 2020   sample..       
+00011270: 2066 6163 6965 7349 6e64 6578 3a20 696e   faciesIndex: in
+00011280: 7420 6f72 2073 6571 7565 6e63 6520 6f66  t or sequence of
+00011290: 2069 6e74 2c20 6f70 7469 6f6e 616c 0d0a   int, optional..
+000112a0: 2020 2020 2020 2020 2020 2020 6661 6369              faci
+000112b0: 6573 2069 6e64 6578 2074 6f20 7361 6d70  es index to samp
+000112c0: 6c65 0d0a 2020 2020 2020 2020 6578 7472  le..        extr
+000112d0: 6163 7455 6e69 7473 3a20 626f 6f6c 2c20  actUnits: bool, 
+000112e0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+000112f0: 2020 2020 2020 666c 6167 2074 6f20 696e        flag to in
+00011300: 6469 6361 7465 2074 6f20 7361 6d70 6c65  dicate to sample
+00011310: 2075 6e69 7473 206f 7220 6e6f 740d 0a20   units or not.. 
+00011320: 2020 2020 2020 2065 7874 7261 6374 4661         extractFa
+00011330: 6369 6573 3a20 626f 6f6c 2c20 6f70 7469  cies: bool, opti
+00011340: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00011350: 2020 666c 6167 2074 6f20 696e 6469 6361    flag to indica
+00011360: 7465 2074 6f20 7361 6d70 6c65 2066 6163  te to sample fac
+00011370: 6965 7320 6f72 206e 6f74 0d0a 2020 2020  ies or not..    
+00011380: 2020 2020 7662 3a20 696e 742c 206f 7074      vb: int, opt
+00011390: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+000113a0: 2020 2076 6572 626f 7365 206c 6576 656c     verbose level
+000113b0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+000113c0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000113d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
+000113e0: 7374 206f 6620 3a63 6c61 7373 3a60 626f  st of :class:`bo
+000113f0: 7265 686f 6c65 6020 6f62 6a65 6374 730d  rehole` objects.
+00011400: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+00011410: 2020 2020 2020 2020 2320 6765 7420 3344          # get 3D
+00011420: 2061 7272 6179 7320 746f 2073 616d 706c   arrays to sampl
+00011430: 650d 0a20 2020 2020 2020 2069 6620 756e  e..        if un
+00011440: 6974 7320 6973 204e 6f6e 6520 616e 6420  its is None and 
+00011450: 6578 7472 6163 7455 6e69 7473 3a0d 0a20  extractUnits:.. 
+00011460: 2020 2020 2020 2020 2020 2075 6e69 7473             units
+00011470: 203d 2073 656c 662e 6765 745f 756e 6974   = self.get_unit
+00011480: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
+00011490: 6174 696f 6e73 2829 0d0a 2020 2020 2020  ations()..      
+000114a0: 2020 2020 2020 2320 756e 6974 735f 6461        # units_da
+000114b0: 7461 5b6e 702e 6973 6e61 6e28 756e 6974  ta[np.isnan(unit
+000114c0: 735f 6461 7461 295d 3d2d 3939 2020 2320  s_data)]=-99  # 
+000114d0: 6465 6661 756c 7420 4944 2074 6f20 696e  default ID to in
+000114e0: 6469 6361 7465 206e 6f20 6461 7461 200d  dicate no data .
+000114f0: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
+00011500: 7473 5f64 6174 613d 756e 6974 732e 636f  ts_data=units.co
+00011510: 7079 2829 0d0a 2020 2020 2020 2020 6966  py()..        if
+00011520: 2066 6163 6965 7320 6973 204e 6f6e 6520   facies is None 
+00011530: 616e 6420 6578 7472 6163 7446 6163 6965  and extractFacie
+00011540: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+00011550: 6661 6369 6573 203d 2073 656c 662e 6765  facies = self.ge
+00011560: 745f 6661 6369 6573 2829 0d0a 2020 2020  t_facies()..    
+00011570: 2020 2020 2020 2020 6661 6369 6573 5f64          facies_d
+00011580: 6174 613d 6661 6369 6573 2e63 6f70 7928  ata=facies.copy(
+00011590: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+000115a0: 2066 6163 6965 735f 6461 7461 5b6e 702e   facies_data[np.
+000115b0: 6973 6e61 6e28 6661 6369 6573 5f64 6174  isnan(facies_dat
+000115c0: 6129 5d3d 2d39 3920 2023 2073 616d 6520  a)]=-99  # same 
+000115d0: 666f 7220 6661 6369 6573 0d0a 0d0a 2020  for facies....  
+000115e0: 2020 2020 2020 2363 6861 6e67 6520 696e        #change in
+000115f0: 746f 2061 7272 6179 0d0a 0d0a 2020 2020  to array....    
+00011600: 2020 2020 6966 2074 7970 6528 706f 7369      if type(posi
+00011610: 7469 6f6e 735f 7829 2069 7320 6e6f 7420  tions_x) is not 
+00011620: 6e70 2e6e 6461 7272 6179 3a0d 0a20 2020  np.ndarray:..   
+00011630: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
+00011640: 6e73 5f78 203d 206e 702e 6172 7261 7928  ns_x = np.array(
+00011650: 5b70 6f73 6974 696f 6e73 5f78 5d29 0d0a  [positions_x])..
+00011660: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+00011670: 706f 7369 7469 6f6e 735f 7929 2069 7320  positions_y) is 
+00011680: 6e6f 7420 6e70 2e6e 6461 7272 6179 3a0d  not np.ndarray:.
+00011690: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
+000116a0: 6974 696f 6e73 5f79 203d 206e 702e 6172  itions_y = np.ar
+000116b0: 7261 7928 5b70 6f73 6974 696f 6e73 5f79  ray([positions_y
+000116c0: 5d29 0d0a 2020 2020 2020 2020 6966 2074  ])..        if t
+000116d0: 7970 6528 7374 7261 7449 6e64 6578 2920  ype(stratIndex) 
+000116e0: 6973 2069 6e74 3a0d 0a20 2020 2020 2020  is int:..       
+000116f0: 2020 2020 2073 7472 6174 496e 6465 7820       stratIndex 
+00011700: 3d20 6e70 2e61 7272 6179 285b 7374 7261  = np.array([stra
+00011710: 7449 6e64 6578 5d29 0d0a 2020 2020 2020  tIndex])..      
+00011720: 2020 6966 2074 7970 6528 6661 6369 6573    if type(facies
+00011730: 496e 6465 7829 2069 7320 696e 743a 0d0a  Index) is int:..
+00011740: 2020 2020 2020 2020 2020 2020 6661 6369              faci
+00011750: 6573 496e 6465 7820 3d20 6e70 2e61 7272  esIndex = np.arr
+00011760: 6179 285b 6661 6369 6573 496e 6465 785d  ay([faciesIndex]
+00011770: 290d 0a0d 0a0d 0a20 2020 2020 2020 206c  )......        l
+00011780: 5f70 6f73 203d 205b 5d0d 0a20 2020 2020  _pos = []..     
+00011790: 2020 2066 6f72 2078 2c79 2069 6e20 7a69     for x,y in zi
+000117a0: 7028 706f 7369 7469 6f6e 735f 782c 706f  p(positions_x,po
+000117b0: 7369 7469 6f6e 735f 7929 3a0d 0a0d 0a20  sitions_y):.... 
+000117c0: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
+000117d0: 782c 2063 656c 6c5f 792c 207a 203d 2073  x, cell_y, z = s
+000117e0: 656c 662e 706f 696e 7454 6f49 6e64 6578  elf.pointToIndex
+000117f0: 2878 2c79 2c31 290d 0a20 2020 2020 2020  (x,y,1)..       
+00011800: 2020 2020 206c 5f70 6f73 2e61 7070 656e       l_pos.appen
+00011810: 6428 2863 656c 6c5f 782c 2063 656c 6c5f  d((cell_x, cell_
+00011820: 792c 207a 2929 0d0a 2020 2020 2020 2020  y, z))..        
+00011830: 0d0a 2020 2020 2020 2020 755f 6c69 7374  ..        u_list
+00011840: 203d 205b 5d0d 0a20 2020 2020 2020 2066   = []..        f
+00011850: 6f72 2069 7520 696e 2073 7472 6174 496e  or iu in stratIn
+00011860: 6465 783a 0d0a 2020 2020 2020 2020 2020  dex:..          
+00011870: 2020 6661 5f6c 6973 7420 3d20 5b5d 0d0a    fa_list = []..
+00011880: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00011890: 6966 6120 696e 2066 6163 6965 7349 6e64  ifa in faciesInd
+000118a0: 6578 3a0d 0a20 2020 2020 2020 2020 2020  ex:..           
+000118b0: 2020 2020 2066 616b 655f 6268 203d 205b       fake_bh = [
+000118c0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000118d0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000118e0: 6528 6c65 6e28 706f 7369 7469 6f6e 735f  e(len(positions_
+000118f0: 7829 293a 0d0a 0d0a 2020 2020 2020 2020  x)):....        
+00011900: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+00011910: 5f78 2c20 6365 6c6c 5f79 2c20 7a20 3d20  _x, cell_y, z = 
+00011920: 6c5f 706f 735b 695d 200d 0a20 2020 2020  l_pos[i] ..     
+00011930: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00011940: 203d 2070 6f73 6974 696f 6e73 5f78 5b69   = positions_x[i
+00011950: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00011960: 2020 2020 2020 2079 203d 2070 6f73 6974         y = posit
+00011970: 696f 6e73 5f79 5b69 5d0d 0a20 2020 2020  ions_y[i]..     
+00011980: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00011990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000119a0: 2020 2020 2069 6620 6578 7472 6163 7455       if extractU
+000119b0: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000119d0: 756e 6974 206c 6f67 0d0a 2020 2020 2020  unit log..      
+000119e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119f0: 2020 756e 6974 5f6c 6f67 203d 205b 5d0d    unit_log = [].
+00011a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011a10: 2020 2020 2020 2020 2075 6e69 745f 6964           unit_id
+00011a20: 7820 3d20 756e 6974 735f 6461 7461 5b69  x = units_data[i
+00011a30: 752c 203a 2c20 6365 6c6c 5f79 2c20 6365  u, :, cell_y, ce
+00011a40: 6c6c 5f78 5d0d 0a20 2020 2020 2020 2020  ll_x]..         
+00011a50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00011a60: 6620 756e 6974 5f69 6478 5b2d 315d 2021  f unit_idx[-1] !
+00011a70: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+00011a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a90: 2020 756e 6974 5f6c 6f67 2e61 7070 656e    unit_log.appen
+00011aa0: 6428 2873 656c 662e 6765 745f 756e 6974  d((self.get_unit
+00011ab0: 2849 4420 3d20 756e 6974 5f69 6478 5b2d  (ID = unit_idx[-
+00011ac0: 315d 2c20 7479 7065 3d27 4944 272c 2076  1], type='ID', v
+00011ad0: 623d 3029 2c20 6e70 2e72 6f75 6e64 2873  b=0), np.round(s
+00011ae0: 656c 662e 7a67 5b2d 315d 2c20 3229 2929  elf.zg[-1], 2)))
+00011af0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00011b00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00011b10: 696e 6465 785f 7472 616e 7320 696e 2072  index_trans in r
+00011b20: 6576 6572 7365 6428 6e70 2e77 6865 7265  eversed(np.where
+00011b30: 286e 702e 6469 6666 2875 6e69 745f 6964  (np.diff(unit_id
+00011b40: 7829 2021 3d20 3029 5b30 5d29 3a0d 0a20  x) != 0)[0]):.. 
+00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b60: 2020 2020 2020 2020 2020 2075 6e69 745f             unit_
+00011b70: 6c6f 672e 6170 7065 6e64 2828 7365 6c66  log.append((self
+00011b80: 2e67 6574 5f75 6e69 7428 4944 203d 756e  .get_unit(ID =un
+00011b90: 6974 5f69 6478 5b69 6e64 6578 5f74 7261  it_idx[index_tra
+00011ba0: 6e73 5d2c 2074 7970 653d 2749 4427 2c20  ns], type='ID', 
+00011bb0: 7662 3d30 292c 206e 702e 726f 756e 6428  vb=0), np.round(
+00011bc0: 7365 6c66 2e7a 675b 696e 6465 785f 7472  self.zg[index_tr
+00011bd0: 616e 732b 315d 2c20 3229 2929 0d0a 2020  ans+1], 2)))..  
+00011be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011bf0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00011c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c10: 2075 6e69 745f 6c6f 673d 4e6f 6e65 0d0a   unit_log=None..
+00011c20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011c30: 2020 2020 2020 2366 6163 6965 7320 6c6f        #facies lo
+00011c40: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
+00011c50: 2020 2020 2020 2069 6620 6578 7472 6163         if extrac
+00011c60: 7446 6163 6965 733a 0d0a 2020 2020 2020  tFacies:..      
+00011c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c80: 2020 6661 6369 6573 5f6c 6f67 203d 205b    facies_log = [
+00011c90: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00011ca0: 2020 2020 2020 2020 2020 2066 6163 6965             facie
+00011cb0: 735f 6964 7820 3d20 6661 6369 6573 5f64  s_idx = facies_d
+00011cc0: 6174 615b 6975 2c20 6966 612c 203a 2c20  ata[iu, ifa, :, 
+00011cd0: 6365 6c6c 5f79 2c20 6365 6c6c 5f78 5d0d  cell_y, cell_x].
+00011ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011cf0: 2020 2020 2020 2020 2023 4966 206d 6f64           #If mod
+00011d00: 656c 2068 6173 206e 6f20 6672 6565 2073  el has no free s
+00011d10: 7061 6365 2061 626f 7665 2c20 7765 206e  pace above, we n
+00011d20: 6565 6420 746f 2061 6464 2074 6865 2074  eed to add the t
+00011d30: 7261 6e73 6974 696f 6e20 5375 7266 6163  ransition Surfac
+00011d40: 6520 2d20 6669 7273 7420 6c61 7965 720d  e - first layer.
+00011d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011d60: 2020 2020 2020 2020 2069 6620 6661 6369           if faci
+00011d70: 6573 5f69 6478 5b2d 315d 2021 3d20 303a  es_idx[-1] != 0:
+00011d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00011d90: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+00011da0: 6369 6573 5f6c 6f67 2e61 7070 656e 6428  cies_log.append(
+00011db0: 2873 656c 662e 6765 745f 6661 6369 6573  (self.get_facies
+00011dc0: 5f6f 626a 2849 4420 3d20 6661 6369 6573  _obj(ID = facies
+00011dd0: 5f69 6478 5b2d 315d 2c20 7479 7065 3d27  _idx[-1], type='
+00011de0: 4944 272c 2076 623d 3029 2c20 6e70 2e72  ID', vb=0), np.r
+00011df0: 6f75 6e64 2873 656c 662e 7a67 5b2d 315d  ound(self.zg[-1]
+00011e00: 2c20 3229 2929 0d0a 0d0a 2020 2020 2020  , 2)))....      
 00011e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e20: 2020 6661 6369 6573 5f6c 6f67 2e61 7070    facies_log.app
-00011e30: 656e 6428 2866 615f 6f62 6a2c 2069 7a29  end((fa_obj, iz)
-00011e40: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00011e50: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00011e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e70: 2020 2020 2020 2020 6661 6369 6573 5f6c          facies_l
-00011e80: 6f67 3d4e 6f6e 650d 0a0d 0a20 2020 2020  og=None....     
-00011e90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00011ea0: 206d 6572 6765 204e 6f6e 6520 6966 2073   merge None if s
-00011eb0: 616d 6520 756e 6974 2061 626f 7665 2061  ame unit above a
-00011ec0: 6e64 2062 656c 6f77 0d0a 2020 2020 2020  nd below..      
-00011ed0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011ee0: 2075 6e69 745f 6c6f 6720 6973 206e 6f74   unit_log is not
-00011ef0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00011f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f10: 633d 300d 0a20 2020 2020 2020 2020 2020  c=0..           
-00011f20: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00011f30: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-00011f40: 756e 6974 5f6c 6f67 2929 3a0d 0a20 2020  unit_log)):..   
+00011e20: 2020 666f 7220 696e 6465 785f 7472 616e    for index_tran
+00011e30: 7320 696e 2072 6576 6572 7365 6428 6e70  s in reversed(np
+00011e40: 2e77 6865 7265 286e 702e 6469 6666 2866  .where(np.diff(f
+00011e50: 6163 6965 735f 6964 7829 2021 3d20 3029  acies_idx) != 0)
+00011e60: 5b30 5d29 3a0d 0a20 2020 2020 2020 2020  [0]):..         
+00011e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e80: 2020 2066 615f 6f62 6a3d 7365 6c66 2e67     fa_obj=self.g
+00011e90: 6574 5f66 6163 6965 735f 6f62 6a28 4944  et_facies_obj(ID
+00011ea0: 203d 6661 6369 6573 5f69 6478 5b69 6e64   =facies_idx[ind
+00011eb0: 6578 5f74 7261 6e73 5d2c 2074 7970 653d  ex_trans], type=
+00011ec0: 2749 4427 2c20 7662 3d30 290d 0a20 2020  'ID', vb=0)..   
+00011ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ee0: 2020 2020 2020 2020 2069 7a3d 6e70 2e72           iz=np.r
+00011ef0: 6f75 6e64 2873 656c 662e 7a67 5b69 6e64  ound(self.zg[ind
+00011f00: 6578 5f74 7261 6e73 2b31 5d2c 2032 290d  ex_trans+1], 2).
+00011f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011f20: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+00011f30: 6965 735f 6c6f 672e 6170 7065 6e64 2828  ies_log.append((
+00011f40: 6661 5f6f 626a 2c20 697a 2929 0d0a 0d0a  fa_obj, iz))....
 00011f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f60: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-00011f70: 206c 656e 2875 6e69 745f 6c6f 6729 2d31   len(unit_log)-1
-00011f80: 2061 6e64 2075 6e69 745f 6c6f 675b 695d   and unit_log[i]
-00011f90: 5b30 5d20 6973 204e 6f6e 653a 0d0a 2020  [0] is None:..  
-00011fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011fb0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00011fc0: 6974 5f6c 6f67 203d 2075 6e69 745f 6c6f  it_log = unit_lo
-00011fd0: 675b 3a2d 315d 0d0a 2020 2020 2020 2020  g[:-1]..        
-00011fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ff0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
-00012000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012010: 2020 2020 2020 2020 2020 2069 2d3d 630d             i-=c.
-00012020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012030: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012040: 756e 6974 5f6c 6f67 5b69 5d5b 305d 2069  unit_log[i][0] i
-00012050: 7320 4e6f 6e65 2061 6e64 2069 203e 2030  s None and i > 0
-00012060: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00012070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012080: 2020 2069 6620 756e 6974 5f6c 6f67 5b69     if unit_log[i
-00012090: 2d31 5d5b 305d 203d 3d20 756e 6974 5f6c  -1][0] == unit_l
-000120a0: 6f67 5b69 2b31 5d5b 305d 3a0d 0a20 2020  og[i+1][0]:..   
+00011f60: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00011f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011f80: 2020 2066 6163 6965 735f 6c6f 673d 4e6f     facies_log=No
+00011f90: 6e65 0d0a 0d0a 2020 2020 2020 2020 2020  ne....          
+00011fa0: 2020 2020 2020 2020 2020 2320 6d65 7267            # merg
+00011fb0: 6520 4e6f 6e65 2069 6620 7361 6d65 2075  e None if same u
+00011fc0: 6e69 7420 6162 6f76 6520 616e 6420 6265  nit above and be
+00011fd0: 6c6f 770d 0a20 2020 2020 2020 2020 2020  low..           
+00011fe0: 2020 2020 2020 2020 2069 6620 756e 6974           if unit
+00011ff0: 5f6c 6f67 2069 7320 6e6f 7420 4e6f 6e65  _log is not None
+00012000: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012010: 2020 2020 2020 2020 2020 2063 3d30 0d0a             c=0..
+00012020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012030: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00012040: 2072 616e 6765 286c 656e 2875 6e69 745f   range(len(unit_
+00012050: 6c6f 6729 293a 0d0a 2020 2020 2020 2020  log)):..        
+00012060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012070: 2020 2020 6966 2069 203d 3d20 6c65 6e28      if i == len(
+00012080: 756e 6974 5f6c 6f67 292d 3120 616e 6420  unit_log)-1 and 
+00012090: 756e 6974 5f6c 6f67 5b69 5d5b 305d 2069  unit_log[i][0] i
+000120a0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
 000120b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000120d0: 2075 6e69 745f 6c6f 673d 756e 6974 5f6c   unit_log=unit_l
-000120e0: 6f67 5b3a 695d 202b 2075 6e69 745f 6c6f  og[:i] + unit_lo
-000120f0: 675b 2869 2b32 293a 5d0d 0a20 2020 2020  g[(i+2):]..     
-00012100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012110: 2020 2020 2020 2020 2020 2063 2b3d 320d             c+=2.
-00012120: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00012130: 2020 2020 2020 2023 2069 6620 6e6f 2069         # if no i
-00012140: 6e66 6f20 7365 7420 6c6f 6773 2074 6f20  nfo set logs to 
-00012150: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-00012160: 2020 2020 2020 2020 2020 6966 2066 6163            if fac
-00012170: 6965 735f 6c6f 6720 6973 206e 6f74 204e  ies_log is not N
-00012180: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00012190: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000121a0: 206c 656e 2866 6163 6965 735f 6c6f 6729   len(facies_log)
-000121b0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+000120c0: 2020 2020 2020 2020 2075 6e69 745f 6c6f           unit_lo
+000120d0: 6720 3d20 756e 6974 5f6c 6f67 5b3a 2d31  g = unit_log[:-1
+000120e0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000120f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012100: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+00012110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012120: 2020 2020 2020 692d 3d63 0d0a 2020 2020        i-=c..    
+00012130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012140: 2020 2020 2020 2020 6966 2075 6e69 745f          if unit_
+00012150: 6c6f 675b 695d 5b30 5d20 6973 204e 6f6e  log[i][0] is Non
+00012160: 6520 616e 6420 6920 3e20 303a 0d0a 2020  e and i > 0:..  
+00012170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012180: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00012190: 2075 6e69 745f 6c6f 675b 692d 315d 5b30   unit_log[i-1][0
+000121a0: 5d20 3d3d 2075 6e69 745f 6c6f 675b 692b  ] == unit_log[i+
+000121b0: 315d 5b30 5d3a 0d0a 2020 2020 2020 2020  1][0]:..        
 000121c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000121d0: 2020 2020 6661 6369 6573 5f6c 6f67 3d4e      facies_log=N
-000121e0: 6f6e 650d 0a0d 0a20 2020 2020 2020 2020  one....         
-000121f0: 2020 2020 2020 2020 2020 2069 6620 756e             if un
-00012200: 6974 5f6c 6f67 2069 7320 6e6f 7420 4e6f  it_log is not No
-00012210: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00012220: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012230: 756e 6974 5f6c 6f67 3a20 2020 2020 2020  unit_log:       
-00012240: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-00012250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012260: 2020 2075 6e69 745f 6c6f 675b 305d 203d     unit_log[0] =
-00012270: 2028 756e 6974 5f6c 6f67 5b30 5d5b 305d   (unit_log[0][0]
-00012280: 2c20 7365 6c66 2e74 6f70 5b63 656c 6c5f  , self.top[cell_
-00012290: 792c 6365 6c6c 5f78 5d2d 7365 6c66 2e67  y,cell_x]-self.g
-000122a0: 6574 5f73 7a28 292f 3130 290d 0a20 2020  et_sz()/10)..   
-000122b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122c0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000122d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000122e0: 2020 2020 2020 2020 756e 6974 5f6c 6f67          unit_log
-000122f0: 203d 204e 6f6e 650d 0a0d 0a20 2020 2020   = None....     
-00012300: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012310: 6620 6661 6369 6573 5f6c 6f67 2069 7320  f facies_log is 
-00012320: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-00012330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012340: 2020 2069 6620 6661 6369 6573 5f6c 6f67     if facies_log
-00012350: 3a20 2020 2020 2020 2020 2020 200d 0a20  :            .. 
-00012360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012370: 2020 2020 2020 2020 2020 2066 6163 6965             facie
-00012380: 735f 6c6f 675b 305d 203d 2028 6661 6369  s_log[0] = (faci
-00012390: 6573 5f6c 6f67 5b30 5d5b 305d 2c20 7365  es_log[0][0], se
-000123a0: 6c66 2e74 6f70 5b63 656c 6c5f 792c 6365  lf.top[cell_y,ce
-000123b0: 6c6c 5f78 5d2d 7365 6c66 2e67 6574 5f73  ll_x]-self.get_s
-000123c0: 7a28 292f 3130 290d 0a20 2020 2020 2020  z()/10)..       
-000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000123f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012400: 2020 2020 6661 6369 6573 5f6c 6f67 203d      facies_log =
-00012410: 204e 6f6e 650d 0a0d 0a20 2020 2020 2020   None....       
-00012420: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00012430: 756e 6974 5f6c 6f67 2069 7320 6e6f 7420  unit_log is not 
-00012440: 4e6f 6e65 206f 7220 6661 6369 6573 5f6c  None or facies_l
-00012450: 6f67 2069 7320 6e6f 7420 4e6f 6e65 3a0d  og is not None:.
-00012460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012470: 2020 2020 2020 2020 2066 616b 655f 6268           fake_bh
-00012480: 2e61 7070 656e 6428 626f 7265 686f 6c65  .append(borehole
-00012490: 2822 6661 6b65 222c 2266 616b 6522 2c78  ("fake","fake",x
-000124a0: 3d78 2c79 3d79 2c7a 3d73 656c 662e 746f  =x,y=y,z=self.to
+000121d0: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+000121e0: 5f6c 6f67 3d75 6e69 745f 6c6f 675b 3a69  _log=unit_log[:i
+000121f0: 5d20 2b20 756e 6974 5f6c 6f67 5b28 692b  ] + unit_log[(i+
+00012200: 3229 3a5d 0d0a 2020 2020 2020 2020 2020  2):]..          
+00012210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012220: 2020 2020 2020 632b 3d32 0d0a 0d0a 2020        c+=2....  
+00012230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012240: 2020 2320 6966 206e 6f20 696e 666f 2073    # if no info s
+00012250: 6574 206c 6f67 7320 746f 204e 6f6e 650d  et logs to None.
+00012260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012270: 2020 2020 2069 6620 6661 6369 6573 5f6c       if facies_l
+00012280: 6f67 2069 7320 6e6f 7420 4e6f 6e65 3a0d  og is not None:.
+00012290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000122a0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+000122b0: 6661 6369 6573 5f6c 6f67 2920 3d3d 2030  facies_log) == 0
+000122c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000122d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000122e0: 6163 6965 735f 6c6f 673d 4e6f 6e65 0d0a  acies_log=None..
+000122f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012300: 2020 2020 2020 6966 2075 6e69 745f 6c6f        if unit_lo
+00012310: 6720 6973 206e 6f74 204e 6f6e 653a 0d0a  g is not None:..
+00012320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012330: 2020 2020 2020 2020 6966 2075 6e69 745f          if unit_
+00012340: 6c6f 673a 2020 2020 2020 2020 2020 2020  log:            
+00012350: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012360: 2020 2020 2020 2020 2020 2020 2020 756e                un
+00012370: 6974 5f6c 6f67 5b30 5d20 3d20 2875 6e69  it_log[0] = (uni
+00012380: 745f 6c6f 675b 305d 5b30 5d2c 2073 656c  t_log[0][0], sel
+00012390: 662e 746f 705b 6365 6c6c 5f79 2c63 656c  f.top[cell_y,cel
+000123a0: 6c5f 785d 2d73 656c 662e 6765 745f 737a  l_x]-self.get_sz
+000123b0: 2829 2f31 3029 0d0a 2020 2020 2020 2020  ()/10)..        
+000123c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000123e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123f0: 2020 2075 6e69 745f 6c6f 6720 3d20 4e6f     unit_log = No
+00012400: 6e65 0d0a 0d0a 2020 2020 2020 2020 2020  ne....          
+00012410: 2020 2020 2020 2020 2020 6966 2066 6163            if fac
+00012420: 6965 735f 6c6f 6720 6973 206e 6f74 204e  ies_log is not N
+00012430: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00012440: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00012450: 2066 6163 6965 735f 6c6f 673a 2020 2020   facies_log:    
+00012460: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00012470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012480: 2020 2020 2020 6661 6369 6573 5f6c 6f67        facies_log
+00012490: 5b30 5d20 3d20 2866 6163 6965 735f 6c6f  [0] = (facies_lo
+000124a0: 675b 305d 5b30 5d2c 2073 656c 662e 746f  g[0][0], self.to
 000124b0: 705b 6365 6c6c 5f79 2c63 656c 6c5f 785d  p[cell_y,cell_x]
 000124c0: 2d73 656c 662e 6765 745f 737a 2829 2f31  -self.get_sz()/1
-000124d0: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
-000124e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000124f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012500: 2020 2020 6465 7074 683d 7365 6c66 2e74      depth=self.t
-00012510: 6f70 5b63 656c 6c5f 792c 6365 6c6c 5f78  op[cell_y,cell_x
-00012520: 5d2d 7365 6c66 2e62 6f74 5b63 656c 6c5f  ]-self.bot[cell_
-00012530: 792c 6365 6c6c 5f78 5d2c 6c6f 675f 7374  y,cell_x],log_st
-00012540: 7261 7469 3d75 6e69 745f 6c6f 672c 6c6f  rati=unit_log,lo
-00012550: 675f 6661 6369 6573 3d66 6163 6965 735f  g_facies=facies_
-00012560: 6c6f 6729 290d 0a20 2020 2020 2020 2020  log))..         
-00012570: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00012580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012590: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
-000125a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000125b0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000125c0: 696e 7428 2242 6f72 6568 6f6c 6520 6174  int("Borehole at
-000125d0: 2070 6f73 6974 6f6e 2028 7b7d 2c20 7b7d   positon ({}, {}
-000125e0: 2920 6973 206f 7574 7369 6465 206f 6620  ) is outside of 
-000125f0: 6120 7369 6d75 6c61 7469 6f6e 207a 6f6e  a simulation zon
-00012600: 6522 2e66 6f72 6d61 7428 782c 2079 2929  e".format(x, y))
-00012610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012620: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00012630: 2020 2020 6661 5f6c 6973 742e 6170 7065      fa_list.appe
-00012640: 6e64 2866 616b 655f 6268 290d 0a20 2020  nd(fake_bh)..   
-00012650: 2020 2020 2020 2020 2075 5f6c 6973 742e           u_list.
-00012660: 6170 7065 6e64 2866 615f 6c69 7374 290d  append(fa_list).
-00012670: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012680: 755f 6c69 7374 0d0a 0d0a 2020 2020 6465  u_list....    de
-00012690: 6620 6164 645f 6661 6b65 5f62 6828 7365  f add_fake_bh(se
-000126a0: 6c66 2c20 6268 7329 3a0d 0a0d 0a20 2020  lf, bhs):....   
-000126b0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000126c0: 2020 4d65 7468 6f64 2074 6f20 6164 6420    Method to add 
-000126d0: 6120 6661 6b65 2062 6f72 6568 6f6c 652c  a fake borehole,
-000126e0: 206c 6973 7420 6966 206d 756c 7469 706c   list if multipl
-000126f0: 6573 0d0a 2020 2020 2020 2020 5573 6520  es..        Use 
-00012700: 666f 7220 696e 7665 7273 696f 6e20 7075  for inversion pu
-00012710: 7270 6f73 6573 0d0a 0d0a 2020 2020 2020  rposes....      
-00012720: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00012730: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00012740: 0d0a 2020 2020 2020 2020 6268 7320 3a20  ..        bhs : 
-00012750: 6c69 7374 206f 6620 3a63 6c61 7373 3a60  list of :class:`
-00012760: 626f 7265 686f 6c65 6020 6f72 203a 636c  borehole` or :cl
-00012770: 6173 733a 6062 6f72 6568 6f6c 6560 0d0a  ass:`borehole`..
-00012780: 2020 2020 2020 2020 2020 2020 626f 7265              bore
-00012790: 686f 6c65 7320 746f 2061 6464 0d0a 2020  holes to add..  
-000127a0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000127b0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000127c0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000127d0: 6268 733a 0d0a 2020 2020 2020 2020 2020  bhs:..          
-000127e0: 2020 2020 2020 6966 2028 6973 696e 7374        if (isinst
-000127f0: 616e 6365 2869 2c20 626f 7265 686f 6c65  ance(i, borehole
-00012800: 2929 2061 6e64 2028 6920 6e6f 7420 696e  )) and (i not in
-00012810: 2073 656c 662e 6c69 7374 5f66 616b 655f   self.list_fake_
-00012820: 6268 7329 3a0d 0a20 2020 2020 2020 2020  bhs):..         
-00012830: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00012840: 6c66 2e63 6865 636b 5f62 685f 696e 7369  lf.check_bh_insi
-00012850: 6465 2869 293a 0d0a 2020 2020 2020 2020  de(i):..        
-00012860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012870: 7365 6c66 2e6c 6973 745f 6661 6b65 5f62  self.list_fake_b
-00012880: 6873 2e61 7070 656e 6428 6929 0d0a 2020  hs.append(i)..  
-00012890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128a0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-000128b0: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-000128c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000128d0: 2020 2020 7072 696e 7428 2242 6f72 6568      print("Boreh
-000128e0: 6f6c 6520 7b7d 2061 6464 6564 222e 666f  ole {} added".fo
-000128f0: 726d 6174 2869 2e49 4429 290d 0a20 2020  rmat(i.ID))..   
-00012900: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00012910: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00012920: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00012930: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-00012940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012950: 2020 7072 696e 7428 226f 626a 6563 7420    print("object 
-00012960: 6973 6e27 7420 6120 626f 7265 686f 6c65  isn't a borehole
-00012970: 206f 626a 6563 7420 6f72 206f 626a 6563   object or objec
-00012980: 7420 6973 2061 6c72 6561 6479 2069 6e20  t is already in 
-00012990: 7468 6520 6c69 7374 2229 0d0a 2020 2020  the list")..    
-000129a0: 2020 2020 6578 6365 7074 3a20 2320 626f      except: # bo
-000129b0: 7265 686f 6c65 7320 6e6f 7420 696e 2061  reholes not in a
-000129c0: 206c 6973 740d 0a20 2020 2020 2020 2020   list..         
-000129d0: 2020 2069 6620 2869 7369 6e73 7461 6e63     if (isinstanc
-000129e0: 6528 6268 732c 2062 6f72 6568 6f6c 6529  e(bhs, borehole)
-000129f0: 2920 616e 6420 2862 6873 206e 6f74 2069  ) and (bhs not i
-00012a00: 6e20 7365 6c66 2e6c 6973 745f 6661 6b65  n self.list_fake
-00012a10: 5f62 6873 293a 0d0a 2020 2020 2020 2020  _bhs):..        
-00012a20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00012a30: 6368 6563 6b5f 6268 5f69 6e73 6964 6528  check_bh_inside(
-00012a40: 6268 7329 3a0d 0a20 2020 2020 2020 2020  bhs):..         
-00012a50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00012a60: 6c69 7374 5f66 616b 655f 6268 732e 6170  list_fake_bhs.ap
-00012a70: 7065 6e64 2862 6873 290d 0a20 2020 2020  pend(bhs)..     
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012a90: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00012aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012ab0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00012ac0: 426f 7265 686f 6c65 207b 7d20 6164 6465  Borehole {} adde
-00012ad0: 6422 2e66 6f72 6d61 7428 6268 732e 4944  d".format(bhs.ID
-00012ae0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00012af0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00012b00: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00012b10: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-00012b20: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00012b30: 6e74 2822 6f62 6a65 6374 2069 736e 2774  nt("object isn't
-00012b40: 2061 2062 6f72 6568 6f6c 6520 6f62 6a65   a borehole obje
-00012b50: 6374 206f 7220 6f62 6a65 6374 2069 7320  ct or object is 
-00012b60: 616c 7265 6164 7920 696e 2074 6865 206c  already in the l
-00012b70: 6973 7422 290d 0a0d 0a20 2020 2023 2320  ist")....    ## 
-00012b80: 6765 6f6c 6f67 6963 616c 206d 6170 2066  geological map f
-00012b90: 756e 6374 696f 6e73 0d0a 2020 2020 6465  unctions..    de
-00012ba0: 6620 636f 6d70 7574 655f 6765 6f6c 5f6d  f compute_geol_m
-00012bb0: 6170 2873 656c 662c 2069 753d 302c 2063  ap(self, iu=0, c
-00012bc0: 6f6c 6f72 3d46 616c 7365 293a 0d0a 2020  olor=False):..  
-00012bd0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00012be0: 2222 220d 0a20 2020 2020 2020 2043 6f6d  """..        Com
-00012bf0: 7075 7465 2061 6e64 2072 6574 7572 6e20  pute and return 
-00012c00: 7468 6520 6765 6f6c 6f67 6963 616c 206d  the geological m
-00012c10: 6170 2066 6f72 2067 6976 656e 2075 6e69  ap for given uni
-00012c20: 7420 7265 616c 697a 6174 696f 6e0d 0a0d  t realization...
-00012c30: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00012c40: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00012c50: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00012c60: 2069 753a 2069 6e74 0d0a 2020 2020 2020   iu: int..      
-00012c70: 2020 2020 2020 756e 6974 2072 6561 6c69        unit reali
-00012c80: 7a61 7469 6f6e 2069 6e64 6578 0d0a 2020  zation index..  
-00012c90: 2020 2020 2020 636f 6c6f 723a 2062 6f6f        color: boo
-00012ca0: 6c0d 0a20 2020 2020 2020 2020 2020 2069  l..            i
-00012cb0: 6620 5472 7565 2072 6574 7572 6e20 6120  f True return a 
-00012cc0: 3344 2061 7272 6179 2077 6974 6820 5247  3D array with RG
-00012cd0: 4241 2076 616c 7565 730d 0a0d 0a20 2020  BA values....   
-00012ce0: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00012cf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00012d00: 2020 2020 2020 2032 4420 6e64 6172 7261         2D ndarra
-00012d10: 790d 0a20 2020 2020 2020 2020 2020 2067  y..            g
-00012d20: 656f 6c6f 6769 6361 6c20 6d61 700d 0a20  eological map.. 
-00012d30: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00012d40: 2020 2020 2020 6e79 203d 2073 656c 662e        ny = self.
-00012d50: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
-00012d60: 2020 6e78 203d 2073 656c 662e 6765 745f    nx = self.get_
-00012d70: 6e78 2829 0d0a 2020 2020 2020 2020 6e7a  nx()..        nz
-00012d80: 203d 2073 656c 662e 6765 745f 6e7a 2829   = self.get_nz()
-00012d90: 0d0a 2020 2020 2020 2020 6172 7220 3d20  ..        arr = 
-00012da0: 7365 6c66 2e67 6574 5f75 6e69 7473 5f64  self.get_units_d
-00012db0: 6f6d 6169 6e73 5f72 6561 6c69 7a61 7469  omains_realizati
-00012dc0: 6f6e 7328 6975 290d 0a20 2020 2020 2020  ons(iu)..       
-00012dd0: 2067 656f 6c5f 6d61 7020 3d20 6e70 2e7a   geol_map = np.z
-00012de0: 6572 6f73 285b 6e79 2c20 6e78 5d2c 2064  eros([ny, nx], d
-00012df0: 7479 7065 3d6e 702e 696e 7438 290d 0a20  type=np.int8).. 
-00012e00: 2020 2020 2020 2066 6f72 2069 7a20 696e         for iz in
-00012e10: 206e 702e 6172 616e 6765 286e 7a2d 312c   np.arange(nz-1,
-00012e20: 2030 2c20 2d31 293a 0d0a 2020 2020 2020   0, -1):..      
-00012e30: 2020 2020 2020 6979 2c69 783d 6e70 2e77        iy,ix=np.w
-00012e40: 6865 7265 2861 7272 5b69 7a5d 2021 3d20  here(arr[iz] != 
-00012e50: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-00012e60: 736c 6963 203d 2067 656f 6c5f 6d61 705b  slic = geol_map[
-00012e70: 6979 2c20 6978 5d0d 0a20 2020 2020 2020  iy, ix]..       
-00012e80: 2020 2020 2073 6c69 635b 736c 6963 203d       slic[slic =
-00012e90: 3d20 305d 203d 2061 7272 5b69 7a2c 2069  = 0] = arr[iz, i
-00012ea0: 792c 2069 785d 5b73 6c69 6320 3d3d 2030  y, ix][slic == 0
-00012eb0: 5d0d 0a20 2020 2020 2020 2020 2020 2067  ]..            g
-00012ec0: 656f 6c5f 6d61 705b 6979 2c20 6978 5d20  eol_map[iy, ix] 
-00012ed0: 3d20 736c 6963 0d0a 0d0a 2020 2020 2020  = slic....      
-00012ee0: 2020 6966 2063 6f6c 6f72 3a0d 0a20 2020    if color:..   
-00012ef0: 2020 2020 2020 2020 2061 7272 5f70 6c6f           arr_plo
-00012f00: 7420 3d20 6e70 2e6f 6e65 7328 5b6e 792c  t = np.ones([ny,
-00012f10: 206e 782c 2034 5d29 0d0a 0d0a 2020 2020   nx, 4])....    
-00012f20: 2020 2020 2020 2020 666f 7220 6976 2069          for iv i
-00012f30: 6e20 6e70 2e75 6e69 7175 6528 6765 6f6c  n np.unique(geol
-00012f40: 5f6d 6170 293a 0d0a 2020 2020 2020 2020  _map):..        
-00012f50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00012f60: 2020 2020 2020 2020 2020 6966 2069 7620            if iv 
-00012f70: 213d 2030 3a0d 0a20 2020 2020 2020 2020  != 0:..         
-00012f80: 2020 2020 2020 2020 2020 2061 7272 5f70             arr_p
-00012f90: 6c6f 745b 6765 6f6c 5f6d 6170 203d 3d20  lot[geol_map == 
-00012fa0: 6976 2c20 3a5d 203d 206d 6174 706c 6f74  iv, :] = matplot
-00012fb0: 6c69 622e 636f 6c6f 7273 2e74 6f5f 7267  lib.colors.to_rg
-00012fc0: 6261 2873 656c 662e 6765 745f 756e 6974  ba(self.get_unit
-00012fd0: 2849 4420 3d20 6976 2c20 7479 7065 3d22  (ID = iv, type="
-00012fe0: 4944 2229 2e63 290d 0a20 2020 2020 2020  ID").c)..       
-00012ff0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00013000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013010: 2020 2020 6172 725f 706c 6f74 5b67 656f      arr_plot[geo
-00013020: 6c5f 6d61 7020 3d3d 2069 762c 203a 5d20  l_map == iv, :] 
-00013030: 3d20 2831 2c20 312c 2031 2c20 3129 0d0a  = (1, 1, 1, 1)..
-00013040: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00013050: 7475 726e 2061 7272 5f70 6c6f 740d 0a0d  turn arr_plot...
-00013060: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013070: 6765 6f6c 5f6d 6170 0d0a 0d0a 2020 2020  geol_map....    
-00013080: 6465 6620 6164 645f 6765 6f6c 6f67 6963  def add_geologic
-00013090: 616c 5f6d 6170 2873 656c 662c 2072 6173  al_map(self, ras
-000130a0: 7465 7229 3a0d 0a0d 0a20 2020 2020 2020  ter):....       
-000130b0: 2022 2222 0d0a 2020 2020 2020 2020 4164   """..        Ad
-000130c0: 6420 6120 6765 6f6c 6f67 6963 616c 206d  d a geological m
-000130d0: 6170 2074 6f20 4172 6368 5f74 6162 6c65  ap to Arch_table
-000130e0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-000130f0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00013100: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00013110: 2020 2020 7261 7374 6572 203a 2032 4420      raster : 2D 
-00013120: 6e64 6172 7261 7920 6f66 2073 697a 6520  ndarray of size 
-00013130: 286e 792c 206e 7829 0d0a 2020 2020 2020  (ny, nx)..      
-00013140: 2020 2020 2020 6765 6f6c 6f67 6963 616c        geological
-00013150: 206d 6170 2074 6f20 6164 642e 2056 616c   map to add. Val
-00013160: 7565 7320 6172 6520 756e 6974 7320 4944  ues are units ID
-00013170: 730d 0a20 2020 2020 2020 2022 2222 0d0a  s..        """..
-00013180: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-00013190: 6e73 7461 6e63 6528 7261 7374 6572 2c20  nstance(raster, 
-000131a0: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-000131b0: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-000131c0: 2067 656f 6c5f 6d61 7020 3d20 7365 6c66   geol_map = self
-000131d0: 2e72 6573 616d 706c 6532 6772 6964 2872  .resample2grid(r
-000131e0: 6173 7465 7229 0d0a 2020 2020 2020 2020  aster)..        
-000131f0: 2020 2020 7365 6c66 2e67 656f 6c5f 6d61      self.geol_ma
-00013200: 7020 3d20 6765 6f6c 5f6d 6170 0d0a 2020  p = geol_map..  
-00013210: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00013220: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-00013230: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00013240: 7428 2247 656f 6c6f 6769 6361 6c20 6d61  t("Geological ma
-00013250: 7020 6164 6465 6422 290d 0a20 2020 2020  p added")..     
-00013260: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
-00013270: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00013280: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00013290: 2872 6173 7465 722c 206e 702e 6e64 6172  (raster, np.ndar
-000132a0: 7261 7929 3a0d 0a20 2020 2020 2020 2020  ray):..         
-000132b0: 2020 2073 656c 662e 6765 6f6c 5f6d 6170     self.geol_map
-000132c0: 203d 2072 6173 7465 720d 0a20 2020 2020   = raster..     
-000132d0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-000132e0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-000132f0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00013300: 4765 6f6c 6f67 6963 616c 206d 6170 2061  Geological map a
-00013310: 6464 6564 2229 0d0a 0d0a 2020 2020 6465  dded")....    de
-00013320: 6620 6765 6f6c 5f63 6f6e 746f 7572 7328  f geol_contours(
-00013330: 7365 6c66 2c20 7374 6570 203d 2035 293a  self, step = 5):
-00013340: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00013350: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00013360: 2054 6869 7320 6675 6e63 7469 6f6e 2065   This function e
-00013370: 7874 7261 6374 2069 6e66 6f72 6d61 7469  xtract informati
-00013380: 6f6e 2061 7420 7468 6520 626f 756e 6461  on at the bounda
-00013390: 7269 6573 0d0a 2020 2020 2020 2020 6265  ries..        be
-000133a0: 7477 6565 6e20 756e 6974 7320 6672 6f6d  tween units from
-000133b0: 2074 6865 2067 6976 656e 2067 656f 6c6f   the given geolo
-000133c0: 6769 6361 6c20 6d61 702e 2873 6565 203a  gical map.(see :
-000133d0: 6d65 7468 3a60 6164 645f 6765 6f6c 6f67  meth:`add_geolog
-000133e0: 6963 616c 5f6d 6170 6029 0d0a 2020 2020  ical_map`)..    
-000133f0: 2020 2020 5265 7375 6c74 7320 6172 6520      Results are 
-00013400: 7265 7475 726e 6564 2061 7320 6120 6c69  returned as a li
-00013410: 7374 206f 6620 3a63 6c61 7373 3a60 626f  st of :class:`bo
-00013420: 7265 686f 6c65 6020 6f62 6a65 6374 730d  rehole` objects.
-00013430: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
-00013440: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00013450: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00013460: 2d0d 0a20 2020 2020 2020 2073 7465 7020  -..        step 
-00013470: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
-00013480: 2020 2073 7465 7020 6265 7477 6565 6e20     step between 
-00013490: 6561 6368 2063 656c 6c73 2077 6865 7265  each cells where
-000134a0: 2074 6f20 6164 6420 6120 636f 6e74 6f75   to add a contou
-000134b0: 7220 696e 666f 726d 6174 696f 6e0d 0a0d  r information...
-000134c0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000134d0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000134e0: 2d0d 0a20 2020 2020 2020 206c 6973 7420  -..        list 
-000134f0: 6f66 203a 636c 6173 733a 6062 6f72 6568  of :class:`boreh
-00013500: 6f6c 6560 0d0a 2020 2020 2020 2020 2222  ole`..        ""
-00013510: 220d 0a0d 0a20 2020 2020 2020 2023 2073  "....        # s
-00013520: 6f6d 6520 6675 6e63 7469 6f6e 730d 0a20  ome functions.. 
-00013530: 2020 2020 2020 2064 6566 2075 6e69 745f         def unit_
-00013540: 636f 6e74 6163 7428 7531 5f69 642c 2075  contact(u1_id, u
-00013550: 325f 6964 2c20 6765 6f6c 5f6d 6170 293a  2_id, geol_map):
-00013560: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-00013570: 2020 2020 2020 2020 6672 6f6d 2073 6b69          from ski
-00013580: 6d61 6765 2069 6d70 6f72 7420 6d65 6173  mage import meas
-00013590: 7572 650d 0a20 2020 2020 2020 2020 2020  ure..           
-000135a0: 200d 0a20 2020 2020 2020 2020 2020 2061   ..            a
-000135b0: 7272 203d 2067 656f 6c5f 6d61 702e 6173  rr = geol_map.as
-000135c0: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
-000135d0: 2e63 6f70 7928 290d 0a20 2020 2020 2020  .copy()..       
-000135e0: 2020 2020 2061 7272 5b67 656f 6c5f 6d61       arr[geol_ma
-000135f0: 7020 3d3d 2075 315f 6964 5d20 3d20 310d  p == u1_id] = 1.
-00013600: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-00013610: 5b67 656f 6c5f 6d61 7020 3d3d 2075 325f  [geol_map == u2_
-00013620: 6964 5d20 3d20 320d 0a20 2020 2020 2020  id] = 2..       
-00013630: 2020 2020 2061 7272 5b28 6765 6f6c 5f6d       arr[(geol_m
-00013640: 6170 2021 3d20 7531 5f69 6429 2026 2028  ap != u1_id) & (
-00013650: 6765 6f6c 5f6d 6170 2021 3d20 7532 5f69  geol_map != u2_i
-00013660: 6429 5d20 3d20 6e70 2e6e 616e 0d0a 2020  d)] = np.nan..  
-00013670: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-00013680: 2020 2020 2020 2020 636f 6e74 6f75 7273          contours
-00013690: 203d 206d 6561 7375 7265 2e66 696e 645f   = measure.find_
-000136a0: 636f 6e74 6f75 7273 2861 7272 2c20 3129  contours(arr, 1)
-000136b0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
-000136c0: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-000136d0: 6f6e 746f 7572 730d 0a0d 0a0d 0a20 2020  ontours......   
-000136e0: 2020 2020 2064 6566 2063 6f6d 6269 5f70       def combi_p
-000136f0: 3228 6c73 7429 3a0d 0a0d 0a20 2020 2020  2(lst):....     
-00013700: 2020 2020 2020 2072 6573 203d 205b 5d0d         res = [].
-00013710: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00013720: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-00013730: 6c73 7429 202d 2031 293a 0d0a 0d0a 2020  lst) - 1):....  
-00013740: 2020 2020 2020 2020 2020 2020 2020 6f32                o2
-00013750: 203d 2069 2b31 0d0a 2020 2020 2020 2020   = i+1..        
-00013760: 2020 2020 2020 2020 666f 7220 6f20 696e          for o in
-00013770: 2072 616e 6765 2869 2c20 6c65 6e28 6c73   range(i, len(ls
-00013780: 7429 2d31 293a 0d0a 2020 2020 2020 2020  t)-1):..        
-00013790: 2020 2020 2020 2020 2020 2020 7265 732e              res.
-000137a0: 6170 7065 6e64 2828 6c73 745b 695d 2c20  append((lst[i], 
-000137b0: 6c73 745b 6f32 5d29 290d 0a20 2020 2020  lst[o2]))..     
-000137c0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000137d0: 3220 2b3d 2031 2020 200d 0a20 2020 2020  2 += 1   ..     
-000137e0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
-000137f0: 2e61 7272 6179 2872 6573 2920 200d 0a0d  .array(res)  ...
-00013800: 0a0d 0a20 2020 2020 2020 2023 2072 6574  ...        # ret
-00013810: 7269 6576 6520 736f 6d65 2074 6869 6e67  rieve some thing
-00013820: 730d 0a20 2020 2020 2020 2067 656f 6c5f  s..        geol_
-00013830: 6d61 7020 3d20 7365 6c66 2e67 656f 6c5f  map = self.geol_
-00013840: 6d61 7020 200d 0a20 2020 2020 2020 2074  map  ..        t
-00013850: 6f70 203d 2073 656c 662e 746f 700d 0a20  op = self.top.. 
-00013860: 2020 2020 2020 2073 7a20 3d20 7365 6c66         sz = self
-00013870: 2e67 6574 5f73 7a28 290d 0a20 2020 2020  .get_sz()..     
-00013880: 2020 2078 6763 203d 2073 656c 662e 6765     xgc = self.ge
-00013890: 745f 7867 6328 290d 0a20 2020 2020 2020  t_xgc()..       
-000138a0: 2079 6763 203d 2073 656c 662e 6765 745f   ygc = self.get_
-000138b0: 7967 6328 290d 0a20 2020 2020 2020 200d  ygc()..        .
-000138c0: 0a20 2020 2020 2020 2069 6473 5f69 6e5f  .        ids_in_
-000138d0: 6765 6f6c 5f6d 6170 203d 206e 702e 756e  geol_map = np.un
-000138e0: 6971 7565 2867 656f 6c5f 6d61 7029 0d0a  ique(geol_map)..
-000138f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00013900: 2020 636f 6d62 6973 203d 2063 6f6d 6269    combis = combi
-00013910: 5f70 3228 6964 735f 696e 5f67 656f 6c5f  _p2(ids_in_geol_
-00013920: 6d61 7029 2020 2320 706f 7373 6962 6c65  map)  # possible
-00013930: 2063 6f6d 6269 6e61 7469 6f6e 7320 6f66   combinations of
-00013940: 2075 6e69 7420 6964 730d 0a20 2020 2020   unit ids..     
-00013950: 2020 206c 7374 203d 205b 5d0d 0a20 2020     lst = []..   
-00013960: 2020 2020 2066 6f72 2075 315f 6964 2c20       for u1_id, 
-00013970: 7532 5f69 6420 696e 2063 6f6d 6269 733a  u2_id in combis:
-00013980: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00013990: 2020 2020 2020 2020 2020 2020 7531 203d              u1 =
-000139a0: 2073 656c 662e 6765 745f 756e 6974 2849   self.get_unit(I
-000139b0: 443d 7531 5f69 642c 2074 7970 653d 2249  D=u1_id, type="I
-000139c0: 4422 2c20 7662 3d30 290d 0a20 2020 2020  D", vb=0)..     
-000139d0: 2020 2020 2020 2075 3220 3d20 7365 6c66         u2 = self
-000139e0: 2e67 6574 5f75 6e69 7428 4944 3d75 325f  .get_unit(ID=u2_
-000139f0: 6964 2c20 7479 7065 3d22 4944 222c 2076  id, type="ID", v
-00013a00: 623d 3029 0d0a 2020 2020 2020 2020 2020  b=0)..          
-00013a10: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00013a20: 6966 2075 3120 6973 206e 6f74 204e 6f6e  if u1 is not Non
-00013a30: 6520 616e 6420 7532 2069 7320 6e6f 7420  e and u2 is not 
-00013a40: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00013a50: 2020 2020 2020 2063 6f6e 7473 5f75 315f         conts_u1_
-00013a60: 7532 203d 2075 6e69 745f 636f 6e74 6163  u2 = unit_contac
-00013a70: 7428 7531 5f69 642c 2075 325f 6964 2c20  t(u1_id, u2_id, 
-00013a80: 6765 6f6c 5f6d 6170 2920 2023 2065 7874  geol_map)  # ext
-00013a90: 7261 6374 2063 6f6e 7461 6374 7320 6265  ract contacts be
-00013aa0: 7477 6565 6e20 7531 2061 6e64 2075 320d  tween u1 and u2.
-00013ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ac0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-00013ad0: 2020 2069 6620 7531 2e6d 756d 6d79 5f75     if u1.mummy_u
-00013ae0: 6e69 7420 213d 2075 322e 6d75 6d6d 795f  nit != u2.mummy_
-00013af0: 756e 6974 3a20 2023 2075 6e69 7473 2061  unit:  # units a
-00013b00: 7265 206e 6f74 2066 726f 6d20 7468 6520  re not from the 
-00013b10: 7361 6d65 2028 7375 6229 2d70 696c 650d  same (sub)-pile.
-00013b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013b30: 2020 2020 2069 6620 7531 2e67 6574 5f62       if u1.get_b
-00013b40: 6967 5f6d 756d 6d79 5f75 6e69 7428 2920  ig_mummy_unit() 
-00013b50: 3c20 7532 2e67 6574 5f62 6967 5f6d 756d  < u2.get_big_mum
-00013b60: 6d79 5f75 6e69 7428 293a 0d0a 2020 2020  my_unit():..    
-00013b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b80: 2020 2020 7531 5f61 626f 7665 203d 2054      u1_above = T
-00013b90: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
-00013ba0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00013bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013bc0: 2020 2020 2020 2020 7531 5f61 626f 7665          u1_above
-00013bd0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
-00013be0: 2020 2020 2020 2020 2020 656c 7365 3a20            else: 
-00013bf0: 2023 2075 6e69 7473 2061 7265 2066 726f   # units are fro
-00013c00: 6d20 7468 6520 7361 6d65 2070 696c 650d  m the same pile.
-00013c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013c20: 2020 2020 2069 6620 7531 203c 2075 323a       if u1 < u2:
-00013c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013c40: 2020 2020 2020 2020 2020 7531 5f61 626f            u1_abo
-00013c50: 7665 3d54 7275 650d 0a20 2020 2020 2020  ve=True..       
-00013c60: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00013c70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00013c80: 2020 2020 2020 2020 2020 2020 7531 5f61              u1_a
-00013c90: 626f 7665 3d46 616c 7365 0d0a 2020 2020  bove=False..    
-00013ca0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-00013cb0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00013cc0: 7220 636f 6e74 2069 6e20 636f 6e74 735f  r cont in conts_
-00013cd0: 7531 5f75 323a 0d0a 2020 2020 2020 2020  u1_u2:..        
-00013ce0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00013cf0: 6979 2c20 6978 2069 6e20 636f 6e74 5b3a  iy, ix in cont[:
-00013d00: 3a73 7465 705d 3a0d 0a20 2020 2020 2020  :step]:..       
-00013d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d20: 2069 7920 3d20 696e 7428 6979 290d 0a20   iy = int(iy).. 
-00013d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013d40: 2020 2020 2020 2069 7820 3d20 696e 7428         ix = int(
-00013d50: 6978 290d 0a20 2020 2020 2020 2020 2020  ix)..           
-00013d60: 2020 2020 2020 2020 2020 2020 207a 203d               z =
-00013d70: 2074 6f70 5b69 7920 2c69 785d 2d31 652d   top[iy ,ix]-1e-
-00013d80: 330d 0a20 2020 2020 2020 2020 2020 2020  3..             
-00013d90: 2020 2020 2020 2020 2020 2069 6620 7531             if u1
-00013da0: 5f61 626f 7665 3a0d 0a20 2020 2020 2020  _above:..       
-00013db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013dc0: 2020 2020 2062 6820 3d20 626f 7265 686f       bh = boreho
-00013dd0: 6c65 2822 636f 6e74 6163 745f 6268 222c  le("contact_bh",
-00013de0: 2022 636f 6e74 6163 745f 6268 222c 2078   "contact_bh", x
-00013df0: 6763 5b69 785d 2c20 7967 635b 6979 5d2c  gc[ix], ygc[iy],
-00013e00: 207a 2c20 737a 2f32 2c20 5b28 7531 2c20   z, sz/2, [(u1, 
-00013e10: 7a29 2c28 7532 2c20 7a2d 737a 2f32 295d  z),(u2, z-sz/2)]
-00013e20: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00013e30: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00013e40: 3a20 0d0a 2020 2020 2020 2020 2020 2020  : ..            
-00013e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e60: 6268 203d 2062 6f72 6568 6f6c 6528 2263  bh = borehole("c
-00013e70: 6f6e 7461 6374 5f62 6822 2c20 2263 6f6e  ontact_bh", "con
-00013e80: 7461 6374 5f62 6822 2c20 7867 635b 6978  tact_bh", xgc[ix
-00013e90: 5d2c 2079 6763 5b69 795d 2c20 7a2c 2073  ], ygc[iy], z, s
-00013ea0: 7a2f 322c 205b 2875 322c 207a 292c 2875  z/2, [(u2, z),(u
-00013eb0: 312c 207a 2d73 7a2f 3229 5d29 0d0a 2020  1, z-sz/2)])..  
+000124d0: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+000124e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000124f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012500: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00012510: 6163 6965 735f 6c6f 6720 3d20 4e6f 6e65  acies_log = None
+00012520: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00012530: 2020 2020 2020 2020 6966 2075 6e69 745f          if unit_
+00012540: 6c6f 6720 6973 206e 6f74 204e 6f6e 6520  log is not None 
+00012550: 6f72 2066 6163 6965 735f 6c6f 6720 6973  or facies_log is
+00012560: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00012570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012580: 2020 2020 6661 6b65 5f62 682e 6170 7065      fake_bh.appe
+00012590: 6e64 2862 6f72 6568 6f6c 6528 2266 616b  nd(borehole("fak
+000125a0: 6522 2c22 6661 6b65 222c 783d 782c 793d  e","fake",x=x,y=
+000125b0: 792c 7a3d 7365 6c66 2e74 6f70 5b63 656c  y,z=self.top[cel
+000125c0: 6c5f 792c 6365 6c6c 5f78 5d2d 7365 6c66  l_y,cell_x]-self
+000125d0: 2e67 6574 5f73 7a28 292f 3130 2c0d 0a20  .get_sz()/10,.. 
+000125e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000125f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012600: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00012610: 6570 7468 3d73 656c 662e 746f 705b 6365  epth=self.top[ce
+00012620: 6c6c 5f79 2c63 656c 6c5f 785d 2d73 656c  ll_y,cell_x]-sel
+00012630: 662e 626f 745b 6365 6c6c 5f79 2c63 656c  f.bot[cell_y,cel
+00012640: 6c5f 785d 2c6c 6f67 5f73 7472 6174 693d  l_x],log_strati=
+00012650: 756e 6974 5f6c 6f67 2c6c 6f67 5f66 6163  unit_log,log_fac
+00012660: 6965 733d 6661 6369 6573 5f6c 6f67 2929  ies=facies_log))
+00012670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012680: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00012690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126a0: 2020 2020 2069 6620 7662 3a0d 0a20 2020       if vb:..   
+000126b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000126c0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+000126d0: 426f 7265 686f 6c65 2061 7420 706f 7369  Borehole at posi
+000126e0: 746f 6e20 287b 7d2c 207b 7d29 2069 7320  ton ({}, {}) is 
+000126f0: 6f75 7473 6964 6520 6f66 2061 2073 696d  outside of a sim
+00012700: 756c 6174 696f 6e20 7a6f 6e65 222e 666f  ulation zone".fo
+00012710: 726d 6174 2878 2c20 7929 290d 0a20 2020  rmat(x, y))..   
+00012720: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
+00012730: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00012740: 615f 6c69 7374 2e61 7070 656e 6428 6661  a_list.append(fa
+00012750: 6b65 5f62 6829 0d0a 2020 2020 2020 2020  ke_bh)..        
+00012760: 2020 2020 755f 6c69 7374 2e61 7070 656e      u_list.appen
+00012770: 6428 6661 5f6c 6973 7429 0d0a 2020 2020  d(fa_list)..    
+00012780: 2020 2020 7265 7475 726e 2075 5f6c 6973      return u_lis
+00012790: 740d 0a0d 0a20 2020 2064 6566 2061 6464  t....    def add
+000127a0: 5f66 616b 655f 6268 2873 656c 662c 2062  _fake_bh(self, b
+000127b0: 6873 293a 0d0a 0d0a 2020 2020 2020 2020  hs):....        
+000127c0: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
+000127d0: 686f 6420 746f 2061 6464 2061 2066 616b  hod to add a fak
+000127e0: 6520 626f 7265 686f 6c65 2c20 6c69 7374  e borehole, list
+000127f0: 2069 6620 6d75 6c74 6970 6c65 730d 0a20   if multiples.. 
+00012800: 2020 2020 2020 2055 7365 2066 6f72 2069         Use for i
+00012810: 6e76 6572 7369 6f6e 2070 7572 706f 7365  nversion purpose
+00012820: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
+00012830: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00012840: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00012850: 2020 2020 2062 6873 203a 206c 6973 7420       bhs : list 
+00012860: 6f66 203a 636c 6173 733a 6062 6f72 6568  of :class:`boreh
+00012870: 6f6c 6560 206f 7220 3a63 6c61 7373 3a60  ole` or :class:`
+00012880: 626f 7265 686f 6c65 600d 0a20 2020 2020  borehole`..     
+00012890: 2020 2020 2020 2062 6f72 6568 6f6c 6573         boreholes
+000128a0: 2074 6f20 6164 640d 0a20 2020 2020 2020   to add..       
+000128b0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+000128c0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000128d0: 2020 666f 7220 6920 696e 2062 6873 3a0d    for i in bhs:.
+000128e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000128f0: 2069 6620 2869 7369 6e73 7461 6e63 6528   if (isinstance(
+00012900: 692c 2062 6f72 6568 6f6c 6529 2920 616e  i, borehole)) an
+00012910: 6420 2869 206e 6f74 2069 6e20 7365 6c66  d (i not in self
+00012920: 2e6c 6973 745f 6661 6b65 5f62 6873 293a  .list_fake_bhs):
+00012930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012940: 2020 2020 2020 6966 2073 656c 662e 6368        if self.ch
+00012950: 6563 6b5f 6268 5f69 6e73 6964 6528 6929  eck_bh_inside(i)
+00012960: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012970: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012980: 6c69 7374 5f66 616b 655f 6268 732e 6170  list_fake_bhs.ap
+00012990: 7065 6e64 2869 290d 0a20 2020 2020 2020  pend(i)..       
+000129a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000129b0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+000129c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000129d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000129e0: 7269 6e74 2822 426f 7265 686f 6c65 207b  rint("Borehole {
+000129f0: 7d20 6164 6465 6422 2e66 6f72 6d61 7428  } added".format(
+00012a00: 692e 4944 2929 0d0a 2020 2020 2020 2020  i.ID))..        
+00012a10: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00012a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a30: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00012a40: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00012a50: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00012a60: 6e74 2822 6f62 6a65 6374 2069 736e 2774  nt("object isn't
+00012a70: 2061 2062 6f72 6568 6f6c 6520 6f62 6a65   a borehole obje
+00012a80: 6374 206f 7220 6f62 6a65 6374 2069 7320  ct or object is 
+00012a90: 616c 7265 6164 7920 696e 2074 6865 206c  already in the l
+00012aa0: 6973 7422 290d 0a20 2020 2020 2020 2065  ist")..        e
+00012ab0: 7863 6570 743a 2023 2062 6f72 6568 6f6c  xcept: # borehol
+00012ac0: 6573 206e 6f74 2069 6e20 6120 6c69 7374  es not in a list
+00012ad0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00012ae0: 2028 6973 696e 7374 616e 6365 2862 6873   (isinstance(bhs
+00012af0: 2c20 626f 7265 686f 6c65 2929 2061 6e64  , borehole)) and
+00012b00: 2028 6268 7320 6e6f 7420 696e 2073 656c   (bhs not in sel
+00012b10: 662e 6c69 7374 5f66 616b 655f 6268 7329  f.list_fake_bhs)
+00012b20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00012b30: 2020 2069 6620 7365 6c66 2e63 6865 636b     if self.check
+00012b40: 5f62 685f 696e 7369 6465 2862 6873 293a  _bh_inside(bhs):
+00012b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012b60: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
+00012b70: 6661 6b65 5f62 6873 2e61 7070 656e 6428  fake_bhs.append(
+00012b80: 6268 7329 0d0a 2020 2020 2020 2020 2020  bhs)..          
+00012b90: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00012ba0: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00012bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012bc0: 2020 2020 7072 696e 7428 2242 6f72 6568      print("Boreh
+00012bd0: 6f6c 6520 7b7d 2061 6464 6564 222e 666f  ole {} added".fo
+00012be0: 726d 6174 2862 6873 2e49 4429 290d 0a20  rmat(bhs.ID)).. 
+00012bf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00012c00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00012c10: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+00012c20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00012c30: 2020 2020 2020 2020 7072 696e 7428 226f          print("o
+00012c40: 626a 6563 7420 6973 6e27 7420 6120 626f  bject isn't a bo
+00012c50: 7265 686f 6c65 206f 626a 6563 7420 6f72  rehole object or
+00012c60: 206f 626a 6563 7420 6973 2061 6c72 6561   object is alrea
+00012c70: 6479 2069 6e20 7468 6520 6c69 7374 2229  dy in the list")
+00012c80: 0d0a 0d0a 2020 2020 2323 2067 656f 6c6f  ....    ## geolo
+00012c90: 6769 6361 6c20 6d61 7020 6675 6e63 7469  gical map functi
+00012ca0: 6f6e 730d 0a20 2020 2064 6566 2063 6f6d  ons..    def com
+00012cb0: 7075 7465 5f67 656f 6c5f 6d61 7028 7365  pute_geol_map(se
+00012cc0: 6c66 2c20 6975 3d30 2c20 636f 6c6f 723d  lf, iu=0, color=
+00012cd0: 4661 6c73 6529 3a0d 0a20 2020 2020 2020  False):..       
+00012ce0: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+00012cf0: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00012d00: 616e 6420 7265 7475 726e 2074 6865 2067  and return the g
+00012d10: 656f 6c6f 6769 6361 6c20 6d61 7020 666f  eological map fo
+00012d20: 7220 6769 7665 6e20 756e 6974 2072 6561  r given unit rea
+00012d30: 6c69 7a61 7469 6f6e 0d0a 0d0a 2020 2020  lization....    
+00012d40: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00012d50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00012d60: 2d2d 0d0a 2020 2020 2020 2020 6975 3a20  --..        iu: 
+00012d70: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+00012d80: 2075 6e69 7420 7265 616c 697a 6174 696f   unit realizatio
+00012d90: 6e20 696e 6465 780d 0a20 2020 2020 2020  n index..       
+00012da0: 2063 6f6c 6f72 3a20 626f 6f6c 0d0a 2020   color: bool..  
+00012db0: 2020 2020 2020 2020 2020 6966 2054 7275            if Tru
+00012dc0: 6520 7265 7475 726e 2061 2033 4420 6172  e return a 3D ar
+00012dd0: 7261 7920 7769 7468 2052 4742 4120 7661  ray with RGBA va
+00012de0: 6c75 6573 0d0a 0d0a 2020 2020 2020 2020  lues....        
+00012df0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00012e00: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00012e10: 2020 3244 206e 6461 7272 6179 0d0a 2020    2D ndarray..  
+00012e20: 2020 2020 2020 2020 2020 6765 6f6c 6f67            geolog
+00012e30: 6963 616c 206d 6170 0d0a 2020 2020 2020  ical map..      
+00012e40: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
+00012e50: 206e 7920 3d20 7365 6c66 2e67 6574 5f6e   ny = self.get_n
+00012e60: 7928 290d 0a20 2020 2020 2020 206e 7820  y()..        nx 
+00012e70: 3d20 7365 6c66 2e67 6574 5f6e 7828 290d  = self.get_nx().
+00012e80: 0a20 2020 2020 2020 206e 7a20 3d20 7365  .        nz = se
+00012e90: 6c66 2e67 6574 5f6e 7a28 290d 0a20 2020  lf.get_nz()..   
+00012ea0: 2020 2020 2061 7272 203d 2073 656c 662e       arr = self.
+00012eb0: 6765 745f 756e 6974 735f 646f 6d61 696e  get_units_domain
+00012ec0: 735f 7265 616c 697a 6174 696f 6e73 2869  s_realizations(i
+00012ed0: 7529 0d0a 2020 2020 2020 2020 6765 6f6c  u)..        geol
+00012ee0: 5f6d 6170 203d 206e 702e 7a65 726f 7328  _map = np.zeros(
+00012ef0: 5b6e 792c 206e 785d 2c20 6474 7970 653d  [ny, nx], dtype=
+00012f00: 6e70 2e69 6e74 3829 0d0a 2020 2020 2020  np.int8)..      
+00012f10: 2020 666f 7220 697a 2069 6e20 6e70 2e61    for iz in np.a
+00012f20: 7261 6e67 6528 6e7a 2d31 2c20 302c 202d  range(nz-1, 0, -
+00012f30: 3129 3a0d 0a20 2020 2020 2020 2020 2020  1):..           
+00012f40: 2069 792c 6978 3d6e 702e 7768 6572 6528   iy,ix=np.where(
+00012f50: 6172 725b 697a 5d20 213d 2030 290d 0a20  arr[iz] != 0).. 
+00012f60: 2020 2020 2020 2020 2020 2073 6c69 6320             slic 
+00012f70: 3d20 6765 6f6c 5f6d 6170 5b69 792c 2069  = geol_map[iy, i
+00012f80: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+00012f90: 736c 6963 5b73 6c69 6320 3d3d 2030 5d20  slic[slic == 0] 
+00012fa0: 3d20 6172 725b 697a 2c20 6979 2c20 6978  = arr[iz, iy, ix
+00012fb0: 5d5b 736c 6963 203d 3d20 305d 0d0a 2020  ][slic == 0]..  
+00012fc0: 2020 2020 2020 2020 2020 6765 6f6c 5f6d            geol_m
+00012fd0: 6170 5b69 792c 2069 785d 203d 2073 6c69  ap[iy, ix] = sli
+00012fe0: 630d 0a0d 0a20 2020 2020 2020 2069 6620  c....        if 
+00012ff0: 636f 6c6f 723a 0d0a 2020 2020 2020 2020  color:..        
+00013000: 2020 2020 6172 725f 706c 6f74 203d 206e      arr_plot = n
+00013010: 702e 6f6e 6573 285b 6e79 2c20 6e78 2c20  p.ones([ny, nx, 
+00013020: 345d 290d 0a0d 0a20 2020 2020 2020 2020  4])....         
+00013030: 2020 2066 6f72 2069 7620 696e 206e 702e     for iv in np.
+00013040: 756e 6971 7565 2867 656f 6c5f 6d61 7029  unique(geol_map)
+00013050: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00013060: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00013070: 2020 2020 2069 6620 6976 2021 3d20 303a       if iv != 0:
+00013080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013090: 2020 2020 2020 6172 725f 706c 6f74 5b67        arr_plot[g
+000130a0: 656f 6c5f 6d61 7020 3d3d 2069 762c 203a  eol_map == iv, :
+000130b0: 5d20 3d20 6d61 7470 6c6f 746c 6962 2e63  ] = matplotlib.c
+000130c0: 6f6c 6f72 732e 746f 5f72 6762 6128 7365  olors.to_rgba(se
+000130d0: 6c66 2e67 6574 5f75 6e69 7428 4944 203d  lf.get_unit(ID =
+000130e0: 2069 762c 2074 7970 653d 2249 4422 292e   iv, type="ID").
+000130f0: 6329 0d0a 2020 2020 2020 2020 2020 2020  c)..            
+00013100: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00013110: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00013120: 7272 5f70 6c6f 745b 6765 6f6c 5f6d 6170  rr_plot[geol_map
+00013130: 203d 3d20 6976 2c20 3a5d 203d 2028 312c   == iv, :] = (1,
+00013140: 2031 2c20 312c 2031 290d 0a0d 0a20 2020   1, 1, 1)....   
+00013150: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00013160: 6172 725f 706c 6f74 0d0a 0d0a 2020 2020  arr_plot....    
+00013170: 2020 2020 7265 7475 726e 2067 656f 6c5f      return geol_
+00013180: 6d61 700d 0a0d 0a20 2020 2064 6566 2061  map....    def a
+00013190: 6464 5f67 656f 6c6f 6769 6361 6c5f 6d61  dd_geological_ma
+000131a0: 7028 7365 6c66 2c20 7261 7374 6572 293a  p(self, raster):
+000131b0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
+000131c0: 0a20 2020 2020 2020 2041 6464 2061 2067  .        Add a g
+000131d0: 656f 6c6f 6769 6361 6c20 6d61 7020 746f  eological map to
+000131e0: 2041 7263 685f 7461 626c 650d 0a0d 0a20   Arch_table.... 
+000131f0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00013200: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00013210: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
+00013220: 6173 7465 7220 3a20 3244 206e 6461 7272  aster : 2D ndarr
+00013230: 6179 206f 6620 7369 7a65 2028 6e79 2c20  ay of size (ny, 
+00013240: 6e78 290d 0a20 2020 2020 2020 2020 2020  nx)..           
+00013250: 2067 656f 6c6f 6769 6361 6c20 6d61 7020   geological map 
+00013260: 746f 2061 6464 2e20 5661 6c75 6573 2061  to add. Values a
+00013270: 7265 2075 6e69 7473 2049 4473 0d0a 2020  re units IDs..  
+00013280: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+00013290: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+000132a0: 6365 2872 6173 7465 722c 2073 7472 293a  ce(raster, str):
+000132b0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+000132c0: 2020 2020 2020 2020 2020 2020 6765 6f6c              geol
+000132d0: 5f6d 6170 203d 2073 656c 662e 7265 7361  _map = self.resa
+000132e0: 6d70 6c65 3267 7269 6428 7261 7374 6572  mple2grid(raster
+000132f0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00013300: 656c 662e 6765 6f6c 5f6d 6170 203d 2067  elf.geol_map = g
+00013310: 656f 6c5f 6d61 700d 0a20 2020 2020 2020  eol_map..       
+00013320: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00013330: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+00013340: 2020 2020 2020 2070 7269 6e74 2822 4765         print("Ge
+00013350: 6f6c 6f67 6963 616c 206d 6170 2061 6464  ological map add
+00013360: 6564 2229 0d0a 2020 2020 2020 2020 2020  ed")..          
+00013370: 2020 7265 7475 726e 0d0a 2020 2020 2020    return..      
+00013380: 2020 0d0a 2020 2020 2020 2020 656c 6966    ..        elif
+00013390: 2069 7369 6e73 7461 6e63 6528 7261 7374   isinstance(rast
+000133a0: 6572 2c20 6e70 2e6e 6461 7272 6179 293a  er, np.ndarray):
+000133b0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000133c0: 6c66 2e67 656f 6c5f 6d61 7020 3d20 7261  lf.geol_map = ra
+000133d0: 7374 6572 0d0a 2020 2020 2020 2020 2020  ster..          
+000133e0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+000133f0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00013400: 2020 2020 7072 696e 7428 2247 656f 6c6f      print("Geolo
+00013410: 6769 6361 6c20 6d61 7020 6164 6465 6422  gical map added"
+00013420: 290d 0a0d 0a20 2020 2064 6566 2067 656f  )....    def geo
+00013430: 6c5f 636f 6e74 6f75 7273 2873 656c 662c  l_contours(self,
+00013440: 2073 7465 7020 3d20 3529 3a0d 0a20 2020   step = 5):..   
+00013450: 2020 2020 200d 0a20 2020 2020 2020 2022       ..        "
+00013460: 2222 0d0a 2020 2020 2020 2020 5468 6973  ""..        This
+00013470: 2066 756e 6374 696f 6e20 6578 7472 6163   function extrac
+00013480: 7420 696e 666f 726d 6174 696f 6e20 6174  t information at
+00013490: 2074 6865 2062 6f75 6e64 6172 6965 730d   the boundaries.
+000134a0: 0a20 2020 2020 2020 2062 6574 7765 656e  .        between
+000134b0: 2075 6e69 7473 2066 726f 6d20 7468 6520   units from the 
+000134c0: 6769 7665 6e20 6765 6f6c 6f67 6963 616c  given geological
+000134d0: 206d 6170 2e28 7365 6520 3a6d 6574 683a   map.(see :meth:
+000134e0: 6061 6464 5f67 656f 6c6f 6769 6361 6c5f  `add_geological_
+000134f0: 6d61 7060 290d 0a20 2020 2020 2020 2052  map`)..        R
+00013500: 6573 756c 7473 2061 7265 2072 6574 7572  esults are retur
+00013510: 6e65 6420 6173 2061 206c 6973 7420 6f66  ned as a list of
+00013520: 203a 636c 6173 733a 6062 6f72 6568 6f6c   :class:`borehol
+00013530: 6560 206f 626a 6563 7473 0d0a 2020 2020  e` objects..    
+00013540: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+00013550: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00013560: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00013570: 2020 2020 2020 7374 6570 203a 2069 6e74        step : int
+00013580: 0d0a 2020 2020 2020 2020 2020 2020 7374  ..            st
+00013590: 6570 2062 6574 7765 656e 2065 6163 6820  ep between each 
+000135a0: 6365 6c6c 7320 7768 6572 6520 746f 2061  cells where to a
+000135b0: 6464 2061 2063 6f6e 746f 7572 2069 6e66  dd a contour inf
+000135c0: 6f72 6d61 7469 6f6e 0d0a 0d0a 2020 2020  ormation....    
+000135d0: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+000135e0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+000135f0: 2020 2020 2020 6c69 7374 206f 6620 3a63        list of :c
+00013600: 6c61 7373 3a60 626f 7265 686f 6c65 600d  lass:`borehole`.
+00013610: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+00013620: 2020 2020 2020 2020 2320 736f 6d65 2066          # some f
+00013630: 756e 6374 696f 6e73 0d0a 2020 2020 2020  unctions..      
+00013640: 2020 6465 6620 756e 6974 5f63 6f6e 7461    def unit_conta
+00013650: 6374 2875 315f 6964 2c20 7532 5f69 642c  ct(u1_id, u2_id,
+00013660: 2067 656f 6c5f 6d61 7029 3a0d 0a20 2020   geol_map):..   
+00013670: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00013680: 2020 2066 726f 6d20 736b 696d 6167 6520     from skimage 
+00013690: 696d 706f 7274 206d 6561 7375 7265 0d0a  import measure..
+000136a0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+000136b0: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
+000136c0: 6765 6f6c 5f6d 6170 2e61 7374 7970 6528  geol_map.astype(
+000136d0: 6e70 2e66 6c6f 6174 3332 292e 636f 7079  np.float32).copy
+000136e0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+000136f0: 6172 725b 6765 6f6c 5f6d 6170 203d 3d20  arr[geol_map == 
+00013700: 7531 5f69 645d 203d 2031 0d0a 2020 2020  u1_id] = 1..    
+00013710: 2020 2020 2020 2020 6172 725b 6765 6f6c          arr[geol
+00013720: 5f6d 6170 203d 3d20 7532 5f69 645d 203d  _map == u2_id] =
+00013730: 2032 0d0a 2020 2020 2020 2020 2020 2020   2..            
+00013740: 6172 725b 2867 656f 6c5f 6d61 7020 213d  arr[(geol_map !=
+00013750: 2075 315f 6964 2920 2620 2867 656f 6c5f   u1_id) & (geol_
+00013760: 6d61 7020 213d 2075 325f 6964 295d 203d  map != u2_id)] =
+00013770: 206e 702e 6e61 6e0d 0a20 2020 2020 2020   np.nan..       
+00013780: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00013790: 2020 2063 6f6e 746f 7572 7320 3d20 6d65     contours = me
+000137a0: 6173 7572 652e 6669 6e64 5f63 6f6e 746f  asure.find_conto
+000137b0: 7572 7328 6172 722c 2031 290d 0a20 2020  urs(arr, 1)..   
+000137c0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+000137d0: 2020 2072 6574 7572 6e20 636f 6e74 6f75     return contou
+000137e0: 7273 0d0a 0d0a 0d0a 2020 2020 2020 2020  rs......        
+000137f0: 6465 6620 636f 6d62 695f 7032 286c 7374  def combi_p2(lst
+00013800: 293a 0d0a 0d0a 2020 2020 2020 2020 2020  ):....          
+00013810: 2020 7265 7320 3d20 5b5d 0d0a 2020 2020    res = []..    
+00013820: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00013830: 2072 616e 6765 286c 656e 286c 7374 2920   range(len(lst) 
+00013840: 2d20 3129 3a0d 0a0d 0a20 2020 2020 2020  - 1):....       
+00013850: 2020 2020 2020 2020 206f 3220 3d20 692b           o2 = i+
+00013860: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
+00013870: 2020 2066 6f72 206f 2069 6e20 7261 6e67     for o in rang
+00013880: 6528 692c 206c 656e 286c 7374 292d 3129  e(i, len(lst)-1)
+00013890: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000138a0: 2020 2020 2020 2072 6573 2e61 7070 656e         res.appen
+000138b0: 6428 286c 7374 5b69 5d2c 206c 7374 5b6f  d((lst[i], lst[o
+000138c0: 325d 2929 0d0a 2020 2020 2020 2020 2020  2]))..          
+000138d0: 2020 2020 2020 2020 2020 6f32 202b 3d20            o2 += 
+000138e0: 3120 2020 0d0a 2020 2020 2020 2020 2020  1   ..          
+000138f0: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
+00013900: 7928 7265 7329 2020 0d0a 0d0a 0d0a 2020  y(res)  ......  
+00013910: 2020 2020 2020 2320 7265 7472 6965 7665        # retrieve
+00013920: 2073 6f6d 6520 7468 696e 6773 0d0a 2020   some things..  
+00013930: 2020 2020 2020 6765 6f6c 5f6d 6170 203d        geol_map =
+00013940: 2073 656c 662e 6765 6f6c 5f6d 6170 2020   self.geol_map  
+00013950: 0d0a 2020 2020 2020 2020 746f 7020 3d20  ..        top = 
+00013960: 7365 6c66 2e74 6f70 0d0a 2020 2020 2020  self.top..      
+00013970: 2020 737a 203d 2073 656c 662e 6765 745f    sz = self.get_
+00013980: 737a 2829 0d0a 2020 2020 2020 2020 7867  sz()..        xg
+00013990: 6320 3d20 7365 6c66 2e67 6574 5f78 6763  c = self.get_xgc
+000139a0: 2829 0d0a 2020 2020 2020 2020 7967 6320  ()..        ygc 
+000139b0: 3d20 7365 6c66 2e67 6574 5f79 6763 2829  = self.get_ygc()
+000139c0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+000139d0: 2020 2020 6964 735f 696e 5f67 656f 6c5f      ids_in_geol_
+000139e0: 6d61 7020 3d20 6e70 2e75 6e69 7175 6528  map = np.unique(
+000139f0: 6765 6f6c 5f6d 6170 290d 0a20 2020 2020  geol_map)..     
+00013a00: 2020 200d 0a20 2020 2020 2020 2063 6f6d     ..        com
+00013a10: 6269 7320 3d20 636f 6d62 695f 7032 2869  bis = combi_p2(i
+00013a20: 6473 5f69 6e5f 6765 6f6c 5f6d 6170 2920  ds_in_geol_map) 
+00013a30: 2023 2070 6f73 7369 626c 6520 636f 6d62   # possible comb
+00013a40: 696e 6174 696f 6e73 206f 6620 756e 6974  inations of unit
+00013a50: 2069 6473 0d0a 2020 2020 2020 2020 6c73   ids..        ls
+00013a60: 7420 3d20 5b5d 0d0a 2020 2020 2020 2020  t = []..        
+00013a70: 666f 7220 7531 5f69 642c 2075 325f 6964  for u1_id, u2_id
+00013a80: 2069 6e20 636f 6d62 6973 3a0d 0a20 2020   in combis:..   
+00013a90: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00013aa0: 2020 2020 2020 2075 3120 3d20 7365 6c66         u1 = self
+00013ab0: 2e67 6574 5f75 6e69 7428 4944 3d75 315f  .get_unit(ID=u1_
+00013ac0: 6964 2c20 7479 7065 3d22 4944 222c 2076  id, type="ID", v
+00013ad0: 623d 3029 0d0a 2020 2020 2020 2020 2020  b=0)..          
+00013ae0: 2020 7532 203d 2073 656c 662e 6765 745f    u2 = self.get_
+00013af0: 756e 6974 2849 443d 7532 5f69 642c 2074  unit(ID=u2_id, t
+00013b00: 7970 653d 2249 4422 2c20 7662 3d30 290d  ype="ID", vb=0).
+00013b10: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00013b20: 2020 2020 2020 2020 2020 2069 6620 7531             if u1
+00013b30: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00013b40: 2075 3220 6973 206e 6f74 204e 6f6e 653a   u2 is not None:
+00013b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013b60: 2020 636f 6e74 735f 7531 5f75 3220 3d20    conts_u1_u2 = 
+00013b70: 756e 6974 5f63 6f6e 7461 6374 2875 315f  unit_contact(u1_
+00013b80: 6964 2c20 7532 5f69 642c 2067 656f 6c5f  id, u2_id, geol_
+00013b90: 6d61 7029 2020 2320 6578 7472 6163 7420  map)  # extract 
+00013ba0: 636f 6e74 6163 7473 2062 6574 7765 656e  contacts between
+00013bb0: 2075 3120 616e 6420 7532 0d0a 2020 2020   u1 and u2..    
+00013bc0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00013bd0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00013be0: 2075 312e 6d75 6d6d 795f 756e 6974 2021   u1.mummy_unit !
+00013bf0: 3d20 7532 2e6d 756d 6d79 5f75 6e69 743a  = u2.mummy_unit:
+00013c00: 2020 2320 756e 6974 7320 6172 6520 6e6f    # units are no
+00013c10: 7420 6672 6f6d 2074 6865 2073 616d 6520  t from the same 
+00013c20: 2873 7562 292d 7069 6c65 0d0a 2020 2020  (sub)-pile..    
+00013c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c40: 6966 2075 312e 6765 745f 6269 675f 6d75  if u1.get_big_mu
+00013c50: 6d6d 795f 756e 6974 2829 203c 2075 322e  mmy_unit() < u2.
+00013c60: 6765 745f 6269 675f 6d75 6d6d 795f 756e  get_big_mummy_un
+00013c70: 6974 2829 3a0d 0a20 2020 2020 2020 2020  it():..         
+00013c80: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00013c90: 315f 6162 6f76 6520 3d20 5472 7565 0d0a  1_above = True..
+00013ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cb0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00013cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cd0: 2020 2075 315f 6162 6f76 6520 3d20 4661     u1_above = Fa
+00013ce0: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
+00013cf0: 2020 2020 2065 6c73 653a 2020 2320 756e       else:  # un
+00013d00: 6974 7320 6172 6520 6672 6f6d 2074 6865  its are from the
+00013d10: 2073 616d 6520 7069 6c65 0d0a 2020 2020   same pile..    
+00013d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d30: 6966 2075 3120 3c20 7532 3a0d 0a20 2020  if u1 < u2:..   
+00013d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d50: 2020 2020 2075 315f 6162 6f76 653d 5472       u1_above=Tr
+00013d60: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00013d70: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00013d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d90: 2020 2020 2020 2075 315f 6162 6f76 653d         u1_above=
+00013da0: 4661 6c73 650d 0a20 2020 2020 2020 2020  False..         
+00013db0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00013dc0: 2020 2020 2020 2020 2066 6f72 2063 6f6e           for con
+00013dd0: 7420 696e 2063 6f6e 7473 5f75 315f 7532  t in conts_u1_u2
+00013de0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00013df0: 2020 2020 2020 2066 6f72 2069 792c 2069         for iy, i
+00013e00: 7820 696e 2063 6f6e 745b 3a3a 7374 6570  x in cont[::step
+00013e10: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00013e20: 2020 2020 2020 2020 2020 2020 6979 203d              iy =
+00013e30: 2069 6e74 2869 7929 0d0a 2020 2020 2020   int(iy)..      
+00013e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e50: 2020 6978 203d 2069 6e74 2869 7829 0d0a    ix = int(ix)..
+00013e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e70: 2020 2020 2020 2020 7a20 3d20 746f 705b          z = top[
+00013e80: 6979 202c 6978 5d2d 3165 2d33 0d0a 2020  iy ,ix]-1e-3..  
+00013e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ea0: 2020 2020 2020 6966 2075 315f 6162 6f76        if u1_abov
+00013eb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
 00013ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ed0: 2020 2020 2020 6c73 742e 6170 7065 6e64        lst.append
-00013ee0: 2862 6829 0d0a 2020 2020 2020 2020 2020  (bh)..          
-00013ef0: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
-00013f00: 726e 206c 7374 0d0a 0d0a 2020 2020 6465  rn lst....    de
-00013f10: 6620 7072 6f63 6573 735f 6765 6f6c 6f67  f process_geolog
-00013f20: 6963 616c 5f6d 6170 2873 656c 662c 2074  ical_map(self, t
-00013f30: 7970 3d22 616c 6c22 2c20 7374 6570 203d  yp="all", step =
-00013f40: 2035 293a 0d0a 2020 2020 2020 2020 0d0a   5):..        ..
-00013f50: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00013f60: 2020 2020 2050 726f 6365 7373 2074 6865       Process the
-00013f70: 2067 656f 6c6f 6769 6361 6c20 6d61 7020   geological map 
-00013f80: 6174 7472 6962 7574 6564 2074 6f20 4172  attributed to Ar
-00013f90: 6368 5461 626c 6520 6d6f 6465 6c2e 200d  chTable model. .
-00013fa0: 0a20 2020 2020 2020 2054 6869 7320 6675  .        This fu
-00013fb0: 6e63 7469 6f6e 2063 7265 6174 6573 2066  nction creates f
-00013fc0: 616b 6520 626f 7265 686f 6c65 7320 6672  ake boreholes fr
-00013fd0: 6f6d 2061 0d0a 2020 2020 2020 2020 6769  om a..        gi
-00013fe0: 7665 6e20 6765 6f6c 6f67 6963 616c 206d  ven geological m
-00013ff0: 6170 2028 7261 7374 6572 2920 616e 6420  ap (raster) and 
-00014000: 7468 656d 2074 6f20 6c69 7374 5f6d 6170  them to list_map
-00014010: 5f62 6873 0d0a 0d0a 2020 2020 2020 2020  _bhs....        
-00014020: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00014030: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00014040: 2020 2020 2020 2020 7479 7020 3a20 7374          typ : st
-00014050: 720d 0a20 2020 2020 2020 2020 2020 2066  r..            f
-00014060: 6c61 6720 746f 2069 6e64 6963 6174 6520  lag to indicate 
-00014070: 7768 6174 2069 6e66 6f72 6d61 7469 6f6e  what information
-00014080: 2074 6f20 7461 6b65 3a0d 0a20 2020 2020   to take:..     
-00014090: 2020 2020 2020 202d 2022 756e 6966 6f72         - "unifor
-000140a0: 6d22 2066 6f72 206f 6e6c 7920 7375 7065  m" for only supe
-000140b0: 7266 6963 6961 6c20 696e 666f 726d 6174  rficial informat
-000140c0: 696f 6e20 286e 6f20 636f 6e74 6163 7420  ion (no contact 
-000140d0: 6f72 2062 6f75 6e64 6172 6965 7329 0d0a  or boundaries)..
-000140e0: 2020 2020 2020 2020 2020 2020 2d20 2262              - "b
-000140f0: 6f75 6e64 6172 6965 7322 2066 6f72 206f  oundaries" for o
-00014100: 6e6c 7920 7468 6520 636f 6e74 6163 7420  nly the contact 
-00014110: 6265 7477 6565 6e20 7468 6520 756e 6974  between the unit
-00014120: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
-00014130: 2022 616c 6c22 2066 6f72 2062 6f74 680d   "all" for both.
-00014140: 0a20 2020 2020 2020 2073 7465 7020 3a20  .        step : 
-00014150: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-00014160: 2073 7465 7020 666f 7220 7361 6d70 6c69   step for sampli
-00014170: 6e67 2074 6865 2067 656f 6c6f 6769 6361  ng the geologica
-00014180: 6c20 6d61 702c 2073 6d61 6c6c 2076 616c  l map, small val
-00014190: 7565 7320 696d 706c 6965 730d 0a20 2020  ues implies..   
-000141a0: 2020 2020 2020 2020 2074 6861 7420 6d75           that mu
-000141b0: 6368 206d 6f72 6520 6461 7461 2061 7265  ch more data are
-000141c0: 2073 616d 706c 6564 2066 726f 6d20 7468   sampled from th
-000141d0: 6520 7261 7374 6572 2062 7574 2074 6869  e raster but thi
-000141e0: 7320 696e 6372 6561 7365 730d 0a20 2020  s increases..   
-000141f0: 2020 2020 2020 2020 2074 6865 2063 6f6d           the com
-00014200: 7075 7461 7469 6f6e 616c 2062 7572 6465  putational burde
-00014210: 6e2e 2044 6566 6175 6c74 2069 7320 3520  n. Default is 5 
-00014220: 2865 7665 7279 2035 7468 2063 656c 6c20  (every 5th cell 
-00014230: 6973 2073 616d 706c 6564 290d 0a20 2020  is sampled)..   
-00014240: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00014250: 2020 0d0a 2020 2020 2020 2020 7867 203d    ..        xg =
-00014260: 2073 656c 662e 6765 745f 7867 2829 0d0a   self.get_xg()..
-00014270: 2020 2020 2020 2020 7967 203d 2073 656c          yg = sel
-00014280: 662e 6765 745f 7967 2829 0d0a 2020 2020  f.get_yg()..    
-00014290: 2020 2020 7867 6320 3d20 7365 6c66 2e67      xgc = self.g
-000142a0: 6574 5f78 6763 2829 0d0a 2020 2020 2020  et_xgc()..      
-000142b0: 2020 7967 6320 3d20 7365 6c66 2e67 6574    ygc = self.get
-000142c0: 5f79 6763 2829 0d0a 2020 2020 2020 2020  _ygc()..        
-000142d0: 737a 2020 3d20 7365 6c66 2e67 6574 5f73  sz  = self.get_s
-000142e0: 7a28 290d 0a20 2020 2020 2020 200d 0a20  z()..        .. 
-000142f0: 2020 2020 2020 2072 6173 7465 7220 3d20         raster = 
-00014300: 7365 6c66 2e67 656f 6c5f 6d61 700d 0a20  self.geol_map.. 
-00014310: 2020 2020 2020 2061 7373 6572 7420 7261         assert ra
-00014320: 7374 6572 2e73 6861 7065 203d 3d20 2873  ster.shape == (s
-00014330: 656c 662e 6765 745f 6e79 2829 2c20 7365  elf.get_ny(), se
-00014340: 6c66 2e67 6574 5f6e 7828 2929 2c20 2269  lf.get_nx()), "i
-00014350: 6e76 616c 6964 2073 6861 7065 2066 6f72  nvalid shape for
-00014360: 2067 656f 6c6f 6769 6361 6c20 6d61 702c   geological map,
-00014370: 2073 686f 756c 6420 6265 2028 7b7d 2c20   should be ({}, 
-00014380: 7b7d 2922 2e66 6f72 6d61 7428 7365 6c66  {})".format(self
-00014390: 2e67 6574 5f6e 7928 292c 2073 656c 662e  .get_ny(), self.
-000143a0: 6765 745f 6e78 2829 290d 0a20 2020 2020  get_nx())..     
-000143b0: 2020 200d 0a20 2020 2020 2020 2073 656c     ..        sel
-000143c0: 662e 6c69 7374 5f6d 6170 5f62 6873 3d5b  f.list_map_bhs=[
-000143d0: 5d0d 0a0d 0a20 2020 2020 2020 2073 616d  ]....        sam
-000143e0: 706c 655f 7261 7374 6572 203d 2046 616c  ple_raster = Fal
-000143f0: 7365 0d0a 2020 2020 2020 2020 7361 6d70  se..        samp
-00014400: 6c65 5f62 6f75 6e64 6172 6965 7320 3d20  le_boundaries = 
-00014410: 4661 6c73 650d 0a0d 0a20 2020 2020 2020  False....       
-00014420: 2069 6620 7479 703d 3d22 616c 6c22 3a0d   if typ=="all":.
-00014430: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
-00014440: 706c 655f 7261 7374 6572 203d 2054 7275  ple_raster = Tru
-00014450: 650d 0a20 2020 2020 2020 2020 2020 2073  e..            s
-00014460: 616d 706c 655f 626f 756e 6461 7269 6573  ample_boundaries
-00014470: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
-00014480: 2065 6c69 6620 7479 7020 3d3d 2022 756e   elif typ == "un
-00014490: 6966 6f72 6d22 3a0d 0a20 2020 2020 2020  iform":..       
-000144a0: 2020 2020 2073 616d 706c 655f 7261 7374       sample_rast
-000144b0: 6572 203d 2054 7275 650d 0a20 2020 2020  er = True..     
-000144c0: 2020 2065 6c69 6620 7479 7020 3d3d 2022     elif typ == "
-000144d0: 626f 756e 6461 7269 6573 223a 0d0a 2020  boundaries":..  
-000144e0: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
-000144f0: 5f62 6f75 6e64 6172 6965 7320 3d20 5472  _boundaries = Tr
-00014500: 7565 0d0a 0d0a 2020 2020 2020 2020 6966  ue....        if
-00014510: 2073 616d 706c 655f 7261 7374 6572 3a0d   sample_raster:.
-00014520: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00014530: 6b32 6420 3d20 7365 6c66 2e6d 6173 6b2e  k2d = self.mask.
-00014540: 616e 7928 3029 0d0a 2020 2020 2020 2020  any(0)..        
-00014550: 2020 2020 6268 735f 6d61 7020 3d20 5b5d      bhs_map = []
-00014560: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00014570: 7220 6978 2069 6e20 6e70 2e61 7261 6e67  r ix in np.arang
-00014580: 6528 302c 206c 656e 2878 6729 2d31 2c20  e(0, len(xg)-1, 
-00014590: 7374 6570 293a 0d0a 2020 2020 2020 2020  step):..        
-000145a0: 2020 2020 2020 2020 666f 7220 6979 2069          for iy i
-000145b0: 6e20 6e70 2e61 7261 6e67 6528 302c 206c  n np.arange(0, l
-000145c0: 656e 2879 6729 2d31 2c20 7374 6570 293a  en(yg)-1, step):
-000145d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000145e0: 2020 2020 2020 6966 206d 6173 6b32 645b        if mask2d[
-000145f0: 6979 2c20 6978 5d3a 0d0a 2020 2020 2020  iy, ix]:..      
-00014600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014610: 2020 756e 6974 5f69 6420 3d20 7261 7374    unit_id = rast
-00014620: 6572 5b69 792c 2069 785d 0d0a 2020 2020  er[iy, ix]..    
-00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014640: 2020 2020 756e 6974 203d 2073 656c 662e      unit = self.
-00014650: 6765 745f 756e 6974 2849 443d 756e 6974  get_unit(ID=unit
-00014660: 5f69 642c 2074 7970 653d 2249 4422 2c20  _id, type="ID", 
-00014670: 7662 3d30 290d 0a20 2020 2020 2020 2020  vb=0)..         
-00014680: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00014690: 6620 756e 6974 2069 7320 6e6f 7420 4e6f  f unit is not No
-000146a0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-000146b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146c0: 207a 203d 2073 656c 662e 746f 705b 6979   z = self.top[iy
-000146d0: 2c20 6978 5d2d 3165 2d33 0d0a 2020 2020  , ix]-1e-3..    
+00013ed0: 6268 203d 2062 6f72 6568 6f6c 6528 2263  bh = borehole("c
+00013ee0: 6f6e 7461 6374 5f62 6822 2c20 2263 6f6e  ontact_bh", "con
+00013ef0: 7461 6374 5f62 6822 2c20 7867 635b 6978  tact_bh", xgc[ix
+00013f00: 5d2c 2079 6763 5b69 795d 2c20 7a2c 2073  ], ygc[iy], z, s
+00013f10: 7a2f 322c 205b 2875 312c 207a 292c 2875  z/2, [(u1, z),(u
+00013f20: 322c 207a 2d73 7a2f 3229 5d29 0d0a 2020  2, z-sz/2)])..  
+00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f40: 2020 2020 2020 656c 7365 203a 200d 0a20        else : .. 
+00013f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f60: 2020 2020 2020 2020 2020 2062 6820 3d20             bh = 
+00013f70: 626f 7265 686f 6c65 2822 636f 6e74 6163  borehole("contac
+00013f80: 745f 6268 222c 2022 636f 6e74 6163 745f  t_bh", "contact_
+00013f90: 6268 222c 2078 6763 5b69 785d 2c20 7967  bh", xgc[ix], yg
+00013fa0: 635b 6979 5d2c 207a 2c20 737a 2f32 2c20  c[iy], z, sz/2, 
+00013fb0: 5b28 7532 2c20 7a29 2c28 7531 2c20 7a2d  [(u2, z),(u1, z-
+00013fc0: 737a 2f32 295d 290d 0a20 2020 2020 2020  sz/2)])..       
+00013fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fe0: 206c 7374 2e61 7070 656e 6428 6268 290d   lst.append(bh).
+00013ff0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00014000: 2020 2020 2020 2072 6574 7572 6e20 6c73         return ls
+00014010: 740d 0a0d 0a20 2020 2064 6566 2070 726f  t....    def pro
+00014020: 6365 7373 5f67 656f 6c6f 6769 6361 6c5f  cess_geological_
+00014030: 6d61 7028 7365 6c66 2c20 7479 703d 2261  map(self, typ="a
+00014040: 6c6c 222c 2073 7465 7020 3d20 3529 3a0d  ll", step = 5):.
+00014050: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00014060: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00014070: 5072 6f63 6573 7320 7468 6520 6765 6f6c  Process the geol
+00014080: 6f67 6963 616c 206d 6170 2061 7474 7269  ogical map attri
+00014090: 6275 7465 6420 746f 2041 7263 6854 6162  buted to ArchTab
+000140a0: 6c65 206d 6f64 656c 2e20 0d0a 2020 2020  le model. ..    
+000140b0: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
+000140c0: 6e20 6372 6561 7465 7320 6661 6b65 2062  n creates fake b
+000140d0: 6f72 6568 6f6c 6573 2066 726f 6d20 610d  oreholes from a.
+000140e0: 0a20 2020 2020 2020 2067 6976 656e 2067  .        given g
+000140f0: 656f 6c6f 6769 6361 6c20 6d61 7020 2872  eological map (r
+00014100: 6173 7465 7229 2061 6e64 2074 6865 6d20  aster) and them 
+00014110: 746f 206c 6973 745f 6d61 705f 6268 730d  to list_map_bhs.
+00014120: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00014130: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00014140: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00014150: 2020 2074 7970 203a 2073 7472 0d0a 2020     typ : str..  
+00014160: 2020 2020 2020 2020 2020 666c 6167 2074            flag t
+00014170: 6f20 696e 6469 6361 7465 2077 6861 7420  o indicate what 
+00014180: 696e 666f 726d 6174 696f 6e20 746f 2074  information to t
+00014190: 616b 653a 0d0a 2020 2020 2020 2020 2020  ake:..          
+000141a0: 2020 2d20 2275 6e69 666f 726d 2220 666f    - "uniform" fo
+000141b0: 7220 6f6e 6c79 2073 7570 6572 6669 6369  r only superfici
+000141c0: 616c 2069 6e66 6f72 6d61 7469 6f6e 2028  al information (
+000141d0: 6e6f 2063 6f6e 7461 6374 206f 7220 626f  no contact or bo
+000141e0: 756e 6461 7269 6573 290d 0a20 2020 2020  undaries)..     
+000141f0: 2020 2020 2020 202d 2022 626f 756e 6461         - "bounda
+00014200: 7269 6573 2220 666f 7220 6f6e 6c79 2074  ries" for only t
+00014210: 6865 2063 6f6e 7461 6374 2062 6574 7765  he contact betwe
+00014220: 656e 2074 6865 2075 6e69 7473 0d0a 2020  en the units..  
+00014230: 2020 2020 2020 2020 2020 2d20 2261 6c6c            - "all
+00014240: 2220 666f 7220 626f 7468 0d0a 2020 2020  " for both..    
+00014250: 2020 2020 7374 6570 203a 2069 6e74 0d0a      step : int..
+00014260: 2020 2020 2020 2020 2020 2020 7374 6570              step
+00014270: 2066 6f72 2073 616d 706c 696e 6720 7468   for sampling th
+00014280: 6520 6765 6f6c 6f67 6963 616c 206d 6170  e geological map
+00014290: 2c20 736d 616c 6c20 7661 6c75 6573 2069  , small values i
+000142a0: 6d70 6c69 6573 0d0a 2020 2020 2020 2020  mplies..        
+000142b0: 2020 2020 7468 6174 206d 7563 6820 6d6f      that much mo
+000142c0: 7265 2064 6174 6120 6172 6520 7361 6d70  re data are samp
+000142d0: 6c65 6420 6672 6f6d 2074 6865 2072 6173  led from the ras
+000142e0: 7465 7220 6275 7420 7468 6973 2069 6e63  ter but this inc
+000142f0: 7265 6173 6573 0d0a 2020 2020 2020 2020  reases..        
+00014300: 2020 2020 7468 6520 636f 6d70 7574 6174      the computat
+00014310: 696f 6e61 6c20 6275 7264 656e 2e20 4465  ional burden. De
+00014320: 6661 756c 7420 6973 2035 2028 6576 6572  fault is 5 (ever
+00014330: 7920 3574 6820 6365 6c6c 2069 7320 7361  y 5th cell is sa
+00014340: 6d70 6c65 6429 0d0a 2020 2020 2020 2020  mpled)..        
+00014350: 2222 220d 0a20 2020 2020 2020 200d 0a20  """..        .. 
+00014360: 2020 2020 2020 2078 6720 3d20 7365 6c66         xg = self
+00014370: 2e67 6574 5f78 6728 290d 0a20 2020 2020  .get_xg()..     
+00014380: 2020 2079 6720 3d20 7365 6c66 2e67 6574     yg = self.get
+00014390: 5f79 6728 290d 0a20 2020 2020 2020 2078  _yg()..        x
+000143a0: 6763 203d 2073 656c 662e 6765 745f 7867  gc = self.get_xg
+000143b0: 6328 290d 0a20 2020 2020 2020 2079 6763  c()..        ygc
+000143c0: 203d 2073 656c 662e 6765 745f 7967 6328   = self.get_ygc(
+000143d0: 290d 0a20 2020 2020 2020 2073 7a20 203d  )..        sz  =
+000143e0: 2073 656c 662e 6765 745f 737a 2829 0d0a   self.get_sz()..
+000143f0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00014400: 2020 7261 7374 6572 203d 2073 656c 662e    raster = self.
+00014410: 6765 6f6c 5f6d 6170 0d0a 2020 2020 2020  geol_map..      
+00014420: 2020 6173 7365 7274 2072 6173 7465 722e    assert raster.
+00014430: 7368 6170 6520 3d3d 2028 7365 6c66 2e67  shape == (self.g
+00014440: 6574 5f6e 7928 292c 2073 656c 662e 6765  et_ny(), self.ge
+00014450: 745f 6e78 2829 292c 2022 696e 7661 6c69  t_nx()), "invali
+00014460: 6420 7368 6170 6520 666f 7220 6765 6f6c  d shape for geol
+00014470: 6f67 6963 616c 206d 6170 2c20 7368 6f75  ogical map, shou
+00014480: 6c64 2062 6520 287b 7d2c 207b 7d29 222e  ld be ({}, {})".
+00014490: 666f 726d 6174 2873 656c 662e 6765 745f  format(self.get_
+000144a0: 6e79 2829 2c20 7365 6c66 2e67 6574 5f6e  ny(), self.get_n
+000144b0: 7828 2929 0d0a 2020 2020 2020 2020 0d0a  x())..        ..
+000144c0: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+000144d0: 745f 6d61 705f 6268 733d 5b5d 0d0a 0d0a  t_map_bhs=[]....
+000144e0: 2020 2020 2020 2020 7361 6d70 6c65 5f72          sample_r
+000144f0: 6173 7465 7220 3d20 4661 6c73 650d 0a20  aster = False.. 
+00014500: 2020 2020 2020 2073 616d 706c 655f 626f         sample_bo
+00014510: 756e 6461 7269 6573 203d 2046 616c 7365  undaries = False
+00014520: 0d0a 0d0a 2020 2020 2020 2020 6966 2074  ....        if t
+00014530: 7970 3d3d 2261 6c6c 223a 0d0a 2020 2020  yp=="all":..    
+00014540: 2020 2020 2020 2020 7361 6d70 6c65 5f72          sample_r
+00014550: 6173 7465 7220 3d20 5472 7565 0d0a 2020  aster = True..  
+00014560: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00014570: 5f62 6f75 6e64 6172 6965 7320 3d20 5472  _boundaries = Tr
+00014580: 7565 0d0a 2020 2020 2020 2020 656c 6966  ue..        elif
+00014590: 2074 7970 203d 3d20 2275 6e69 666f 726d   typ == "uniform
+000145a0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+000145b0: 7361 6d70 6c65 5f72 6173 7465 7220 3d20  sample_raster = 
+000145c0: 5472 7565 0d0a 2020 2020 2020 2020 656c  True..        el
+000145d0: 6966 2074 7970 203d 3d20 2262 6f75 6e64  if typ == "bound
+000145e0: 6172 6965 7322 3a0d 0a20 2020 2020 2020  aries":..       
+000145f0: 2020 2020 2073 616d 706c 655f 626f 756e       sample_boun
+00014600: 6461 7269 6573 203d 2054 7275 650d 0a0d  daries = True...
+00014610: 0a20 2020 2020 2020 2069 6620 7361 6d70  .        if samp
+00014620: 6c65 5f72 6173 7465 723a 0d0a 2020 2020  le_raster:..    
+00014630: 2020 2020 2020 2020 6d61 736b 3264 203d          mask2d =
+00014640: 2073 656c 662e 6d61 736b 2e61 6e79 2830   self.mask.any(0
+00014650: 290d 0a20 2020 2020 2020 2020 2020 2062  )..            b
+00014660: 6873 5f6d 6170 203d 205b 5d0d 0a20 2020  hs_map = []..   
+00014670: 2020 2020 2020 2020 2066 6f72 2069 7820           for ix 
+00014680: 696e 206e 702e 6172 616e 6765 2830 2c20  in np.arange(0, 
+00014690: 6c65 6e28 7867 292d 312c 2073 7465 7029  len(xg)-1, step)
+000146a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000146b0: 2020 2066 6f72 2069 7920 696e 206e 702e     for iy in np.
+000146c0: 6172 616e 6765 2830 2c20 6c65 6e28 7967  arange(0, len(yg
+000146d0: 292d 312c 2073 7465 7029 3a0d 0a20 2020  )-1, step):..   
 000146e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146f0: 2020 2020 2020 2020 6268 203d 2062 6f72          bh = bor
-00014700: 6568 6f6c 6528 2272 6173 7465 725f 6268  ehole("raster_bh
-00014710: 222c 2022 7261 7374 6572 5f62 6822 2c20  ", "raster_bh", 
-00014720: 7867 635b 6978 5d2c 2079 6763 5b69 795d  xgc[ix], ygc[iy]
-00014730: 2c20 7a2c 2073 7a2f 342c 205b 2875 6e69  , z, sz/4, [(uni
-00014740: 742c 207a 295d 290d 0a0d 0a20 2020 2020  t, z)])....     
-00014750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014760: 2020 2020 2020 2062 6873 5f6d 6170 2e61         bhs_map.a
-00014770: 7070 656e 6428 6268 290d 0a20 2020 2020  ppend(bh)..     
-00014780: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-00014790: 2020 2020 2073 656c 662e 6c69 7374 5f6d       self.list_m
-000147a0: 6170 5f62 6873 202b 3d20 6268 735f 6d61  ap_bhs += bhs_ma
-000147b0: 700d 0a0d 0a20 2020 2020 2020 2069 6620  p....        if 
-000147c0: 7361 6d70 6c65 5f62 6f75 6e64 6172 6965  sample_boundarie
-000147d0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000147e0: 6268 7320 3d20 7365 6c66 2e67 656f 6c5f  bhs = self.geol_
-000147f0: 636f 6e74 6f75 7273 2873 7465 703d 7374  contours(step=st
-00014800: 6570 290d 0a20 2020 2020 2020 2020 2020  ep)..           
-00014810: 2073 656c 662e 6c69 7374 5f6d 6170 5f62   self.list_map_b
-00014820: 6873 202b 3d20 6268 730d 0a0d 0a20 2020  hs += bhs....   
-00014830: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00014840: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00014850: 2020 2070 7269 6e74 2822 4765 6f6c 6f67     print("Geolog
-00014860: 6963 616c 206d 6170 2065 7874 7261 6374  ical map extract
-00014870: 6564 202d 2070 726f 6365 7373 7573 2065  ed - processus e
-00014880: 6e64 6564 2073 7563 6365 7373 6675 6c6c  nded successfull
-00014890: 7922 290d 0a0d 0a20 2020 2023 2072 656d  y")....    # rem
-000148a0: 6f76 6520 626f 7265 686f 6c65 730d 0a20  ove boreholes.. 
-000148b0: 2020 2064 6566 2072 656d 5f61 6c6c 5f62     def rem_all_b
-000148c0: 6873 2873 656c 662c 2073 7461 6e64 6172  hs(self, standar
-000148d0: 645f 6268 3d54 7275 652c 2066 616b 655f  d_bh=True, fake_
-000148e0: 6268 3d54 7275 652c 2067 656f 6c5f 6d61  bh=True, geol_ma
-000148f0: 705f 6268 3d54 7275 6529 3a0d 0a0d 0a20  p_bh=True):.... 
-00014900: 2020 2020 2020 2022 2222 5265 6d6f 7665         """Remove
-00014910: 2061 6c6c 2062 6f72 6568 6f6c 6573 2066   all boreholes f
-00014920: 726f 6d20 7468 6520 6c69 7374 0d0a 2020  rom the list..  
-00014930: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00014940: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-00014950: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-00014960: 2020 2020 2020 2020 6661 6b65 5f6f 6e6c          fake_onl
-00014970: 7920 3a20 626f 6f6c 0d0a 2020 2020 2020  y : bool..      
-00014980: 2020 2020 2020 6966 2054 7275 652c 206f        if True, o
-00014990: 6e6c 7920 6661 6b65 2062 6f72 6568 6f6c  nly fake borehol
-000149a0: 6573 2061 7265 2072 656d 6f76 6564 0d0a  es are removed..
-000149b0: 2020 2020 2020 2020 6765 6f6c 5f6d 6170          geol_map
-000149c0: 5f6f 6e6c 7920 3a20 626f 6f6c 0d0a 2020  _only : bool..  
-000149d0: 2020 2020 2020 2020 2020 6966 2054 7275            if Tru
-000149e0: 652c 206f 6e6c 7920 626f 7265 686f 6c65  e, only borehole
-000149f0: 7320 6672 6f6d 2067 656f 6c6f 6769 6361  s from geologica
-00014a00: 6c20 6d61 7020 6172 6520 7265 6d6f 7665  l map are remove
-00014a10: 640d 0a20 2020 2020 2020 2022 2222 0d0a  d..        """..
-00014a20: 0d0a 2020 2020 2020 2020 6966 2073 7461  ..        if sta
-00014a30: 6e64 6172 645f 6268 3a0d 0a20 2020 2020  ndard_bh:..     
-00014a40: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-00014a50: 5f62 6873 3d5b 5d0d 0a20 2020 2020 2020  _bhs=[]..       
-00014a60: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00014a70: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00014a80: 2020 2020 2020 2070 7269 6e74 2822 5374         print("St
-00014a90: 616e 6461 7264 2062 6f72 6568 6f6c 6573  andard boreholes
-00014aa0: 2072 656d 6f76 6564 2229 0d0a 2020 2020   removed")..    
-00014ab0: 2020 2020 0d0a 2020 2020 2020 2020 6966      ..        if
-00014ac0: 2066 616b 655f 6268 3a0d 0a20 2020 2020   fake_bh:..     
-00014ad0: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-00014ae0: 5f66 616b 655f 6268 733d 5b5d 0d0a 2020  _fake_bhs=[]..  
-00014af0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00014b00: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-00014b10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00014b20: 7428 2246 616b 6520 626f 7265 686f 6c65  t("Fake borehole
-00014b30: 7320 7265 6d6f 7665 6422 290d 0a0d 0a20  s removed").... 
-00014b40: 2020 2020 2020 2069 6620 6765 6f6c 5f6d         if geol_m
-00014b50: 6170 5f62 683a 0d0a 2020 2020 2020 2020  ap_bh:..        
-00014b60: 2020 2020 7365 6c66 2e6c 6973 745f 6d61      self.list_ma
-00014b70: 705f 6268 733d 5b5d 0d0a 2020 2020 2020  p_bhs=[]..      
-00014b80: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00014b90: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00014ba0: 2020 2020 2020 2020 7072 696e 7428 2247          print("G
-00014bb0: 656f 6c6f 6769 6361 6c20 6d61 7020 626f  eological map bo
-00014bc0: 7265 686f 6c65 7320 7265 6d6f 7665 6422  reholes removed"
-00014bd0: 290d 0a0d 0a20 2020 2020 2020 200d 0a0d  )....        ...
-00014be0: 0a20 2020 2064 6566 2072 656d 5f62 6828  .    def rem_bh(
-00014bf0: 7365 6c66 2c20 6268 293a 0d0a 0d0a 2020  self, bh):....  
-00014c00: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00014c10: 2020 2052 656d 6f76 6520 6120 6769 7665     Remove a give
-00014c20: 6e20 6268 2066 726f 6d20 7468 6520 6c69  n bh from the li
-00014c30: 7374 206f 6620 626f 7265 686f 6c65 730d  st of boreholes.
-00014c40: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00014c50: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00014c60: 2d2d 2d2d 2d2d 2d2d 2d20 200d 0a20 2020  ---------  ..   
-00014c70: 2020 2020 2062 683a 203a 636c 6173 733a       bh: :class:
-00014c80: 6062 6f72 6568 6f6c 6560 206f 626a 6563  `borehole` objec
-00014c90: 740d 0a20 2020 2020 2020 2020 2020 2062  t..            b
-00014ca0: 6f72 6568 6f6c 6520 746f 2072 656d 6f76  orehole to remov
-00014cb0: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
-00014cc0: 0d0a 2020 2020 2020 2020 6966 2062 6820  ..        if bh 
-00014cd0: 696e 2073 656c 662e 6c69 7374 5f62 6873  in self.list_bhs
-00014ce0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-00014cf0: 656c 662e 6c69 7374 5f62 6873 2e72 656d  elf.list_bhs.rem
-00014d00: 6f76 6528 6268 290d 0a20 2020 2020 2020  ove(bh)..       
-00014d10: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00014d20: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
-00014d30: 2020 2020 2020 2070 7269 6e74 2822 426f         print("Bo
-00014d40: 7265 686f 6c65 207b 7d20 7265 6d6f 7665  rehole {} remove
-00014d50: 6422 2e66 6f72 6d61 7428 6268 2e49 4429  d".format(bh.ID)
-00014d60: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00014d70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00014d80: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014da0: 7072 696e 7428 2242 6f72 6568 6f6c 6520  print("Borehole 
-00014db0: 7b7d 206e 6f74 2069 6e20 7468 6520 6c69  {} not in the li
-00014dc0: 7374 222e 666f 726d 6174 2862 682e 4944  st".format(bh.ID
-00014dd0: 2929 0d0a 0d0a 2020 2020 6465 6620 7265  ))....    def re
-00014de0: 6d5f 6661 6b65 5f62 6828 7365 6c66 2c20  m_fake_bh(self, 
-00014df0: 6268 293a 0d0a 2020 2020 2020 2020 0d0a  bh):..        ..
-00014e00: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00014e10: 2020 2020 2052 656d 6f76 6520 6120 6769       Remove a gi
-00014e20: 7665 6e20 6268 2066 726f 6d20 7468 6520  ven bh from the 
-00014e30: 6c69 7374 206f 6620 6661 6b65 2062 6f72  list of fake bor
-00014e40: 6568 6f6c 6573 0d0a 0d0a 2020 2020 2020  eholes....      
-00014e50: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00014e60: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00014e70: 0d0a 2020 2020 2020 2020 6268 3a20 3a63  ..        bh: :c
-00014e80: 6c61 7373 3a60 626f 7265 686f 6c65 6020  lass:`borehole` 
-00014e90: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-00014ea0: 2020 2020 626f 7265 686f 6c65 2074 6f20      borehole to 
-00014eb0: 7265 6d6f 7665 0d0a 2020 2020 2020 2020  remove..        
-00014ec0: 2222 220d 0a0d 0a20 2020 2020 2020 2069  """....        i
-00014ed0: 6620 6268 2069 6e20 7365 6c66 2e6c 6973  f bh in self.lis
-00014ee0: 745f 6661 6b65 5f62 6873 3a0d 0a20 2020  t_fake_bhs:..   
-00014ef0: 2020 2020 2020 2020 2073 656c 662e 6c69           self.li
-00014f00: 7374 5f66 616b 655f 6268 732e 7265 6d6f  st_fake_bhs.remo
-00014f10: 7665 2862 6829 0d0a 2020 2020 2020 2020  ve(bh)..        
-00014f20: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-00014f30: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-00014f40: 2020 2020 2020 7072 696e 7428 2242 6f72        print("Bor
-00014f50: 6568 6f6c 6520 7b7d 2072 656d 6f76 6564  ehole {} removed
-00014f60: 222e 666f 726d 6174 2862 682e 4944 2929  ".format(bh.ID))
-00014f70: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00014f80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00014f90: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
-00014fa0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00014fb0: 7269 6e74 2822 426f 7265 686f 6c65 207b  rint("Borehole {
-00014fc0: 7d20 6e6f 7420 696e 2074 6865 206c 6973  } not in the lis
-00014fd0: 7422 2e66 6f72 6d61 7428 6268 2e49 4429  t".format(bh.ID)
-00014fe0: 290d 0a0d 0a20 2020 2064 6566 2065 7261  )....    def era
-00014ff0: 7365 5f68 6428 7365 6c66 293a 0d0a 0d0a  se_hd(self):....
-00015000: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00015010: 2020 2020 2045 7261 7365 2074 6865 2068       Erase the h
-00015020: 6172 6420 6461 7461 2066 726f 6d20 616c  ard data from al
-00015030: 6c20 7375 7266 6163 6573 2061 6e64 2066  l surfaces and f
-00015040: 6163 6965 730d 0a20 2020 2020 2020 2022  acies..        "
-00015050: 2222 0d0a 0d0a 2020 2020 2020 2020 666f  ""....        fo
-00015060: 7220 756e 6974 2069 6e20 7365 6c66 2e67  r unit in self.g
-00015070: 6574 5f61 6c6c 5f75 6e69 7473 2829 3a0d  et_all_units():.
-00015080: 0a20 2020 2020 2020 2020 2020 2073 3d75  .            s=u
-00015090: 6e69 742e 7375 7266 6163 650d 0a20 2020  nit.surface..   
-000150a0: 2020 2020 2020 2020 2073 2e78 3d5b 5d0d           s.x=[].
-000150b0: 0a20 2020 2020 2020 2020 2020 2073 2e79  .            s.y
-000150c0: 3d5b 5d0d 0a20 2020 2020 2020 2020 2020  =[]..           
-000150d0: 2073 2e7a 3d5b 5d0d 0a20 2020 2020 2020   s.z=[]..       
-000150e0: 2020 2020 2073 2e69 6e65 713d 5b5d 0d0a       s.ineq=[]..
-000150f0: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
-00015100: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f66  n self.get_all_f
-00015110: 6163 6965 7328 293a 0d0a 2020 2020 2020  acies():..      
-00015120: 2020 2020 2020 6661 2e78 3d5b 5d0d 0a20        fa.x=[].. 
-00015130: 2020 2020 2020 2020 2020 2066 612e 793d             fa.y=
-00015140: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-00015150: 6661 2e7a 3d5b 5d0d 0a20 2020 2020 2020  fa.z=[]..       
-00015160: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-00015170: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00015180: 7269 6e74 2822 4861 7264 2064 6174 6120  rint("Hard data 
-00015190: 7265 7365 7422 290d 0a0d 0a20 2020 2064  reset")....    d
-000151a0: 6566 2072 656d 5f61 6c6c 5f66 6163 6965  ef rem_all_facie
-000151b0: 735f 6672 6f6d 5f75 6e69 7473 2873 656c  s_from_units(sel
-000151c0: 6629 3a0d 0a0d 0a20 2020 2020 2020 2022  f):....        "
-000151d0: 2222 0d0a 2020 2020 2020 2020 546f 2072  ""..        To r
-000151e0: 656d 6f76 6520 6661 6369 6573 2066 726f  emove facies fro
-000151f0: 6d20 616c 6c20 756e 6974 730d 0a20 2020  m all units..   
-00015200: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-00015210: 2020 2020 666f 7220 756e 6974 2069 6e20      for unit in 
-00015220: 7365 6c66 2e67 6574 5f61 6c6c 5f75 6e69  self.get_all_uni
-00015230: 7473 2829 3a0d 0a20 2020 2020 2020 2020  ts():..         
-00015240: 2020 2075 6e69 742e 7265 6d5f 6661 6369     unit.rem_faci
-00015250: 6573 2861 6c6c 5f66 6163 6965 733d 5472  es(all_facies=Tr
-00015260: 7565 290d 0a0d 0a20 2020 2020 2020 2069  ue)....        i
-00015270: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00015280: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00015290: 6e74 2822 416c 6c20 6661 6369 6573 2068  nt("All facies h
-000152a0: 6176 6520 6265 656e 2072 656d 6f76 6564  ave been removed
-000152b0: 2066 726f 6d20 756e 6974 7322 290d 0a0d   from units")...
-000152c0: 0a20 2020 2064 6566 206f 7264 6572 5f50  .    def order_P
-000152d0: 696c 6573 2873 656c 6629 3a0d 0a0d 0a20  iles(self):.... 
-000152e0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000152f0: 2020 2020 4f72 6465 7220 616c 6c20 7468      Order all th
-00015300: 6520 756e 6974 7320 696e 2061 6c6c 2074  e units in all t
-00015310: 6865 2070 696c 6573 2061 6363 6f72 6469  he piles accordi
-00015320: 6e67 2074 6f20 6f72 6465 7220 6174 7472  ng to order attr
-00015330: 6962 7574 650d 0a20 2020 2020 2020 2022  ibute..        "
-00015340: 2222 0d0a 2020 2020 2020 2020 0d0a 2020  ""..        ..  
-00015350: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00015360: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00015370: 2020 2020 7072 696e 7428 2223 2323 2323      print("#####
-00015380: 204f 5244 4552 494e 4720 554e 4954 5320   ORDERING UNITS 
-00015390: 2323 2323 2320 2229 0d0a 0d0a 2020 2020  ##### ")....    
-000153a0: 2020 2020 6465 6620 6f72 645f 6675 6e28      def ord_fun(
-000153b0: 7069 6c65 293a 0d0a 2020 2020 2020 2020  pile):..        
-000153c0: 2020 2020 7069 6c65 2e6f 7264 6572 5f75      pile.order_u
-000153d0: 6e69 7473 2876 623d 7365 6c66 2e76 6572  nits(vb=self.ver
-000153e0: 626f 7365 2920 2320 6f72 6761 6e69 7a65  bose) # organize
-000153f0: 2074 6865 2070 696c 650d 0a20 2020 2020   the pile..     
-00015400: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
-00015410: 7069 6c65 2e6c 6973 745f 756e 6974 733a  pile.list_units:
-00015420: 2023 6368 6563 6b20 7375 6275 6e69 7473   #check subunits
-00015430: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015440: 2020 6966 2073 2e66 5f6d 6574 686f 6420    if s.f_method 
-00015450: 3d3d 2022 5375 6250 696c 6522 3a0d 0a20  == "SubPile":.. 
-00015460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015470: 2020 206f 7264 5f66 756e 2873 2e53 7562     ord_fun(s.Sub
-00015480: 5069 6c65 290d 0a20 2020 2020 2020 206f  Pile)..        o
-00015490: 7264 5f66 756e 2873 656c 662e 6765 745f  rd_fun(self.get_
-000154a0: 7069 6c65 5f6d 6173 7465 7228 2929 0d0a  pile_master())..
-000154b0: 0d0a 0d0a 2020 2020 6465 6620 6164 645f  ....    def add_
-000154c0: 7072 6f70 5f68 6428 7365 6c66 2c70 726f  prop_hd(self,pro
-000154d0: 702c 782c 7629 3a0d 0a0d 0a20 2020 2020  p,x,v):....     
-000154e0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000154f0: 4164 6420 4861 7264 2064 6174 6120 746f  Add Hard data to
-00015500: 2074 6865 2070 726f 7065 7274 7920 2270   the property "p
-00015510: 726f 7022 0d0a 2020 2020 2020 2020 0d0a  rop"..        ..
-00015520: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00015530: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00015540: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00015550: 7072 6f70 203a 2073 7472 696e 670d 0a20  prop : string.. 
-00015560: 2020 2020 2020 2020 2020 2070 726f 7065             prope
-00015570: 7274 7920 6e61 6d65 206f 6620 7468 6520  rty name of the 
-00015580: 607e 4172 6368 5079 2e62 6173 652e 5072  `~ArchPy.base.Pr
-00015590: 6f70 6020 6f62 6a65 6374 0d0a 2020 2020  op` object..    
-000155a0: 2020 2020 7820 3a20 6e64 6172 7261 7920      x : ndarray 
-000155b0: 6f66 2073 697a 6520 286e 6461 7461 2c20  of size (ndata, 
-000155c0: 3329 0d0a 2020 2020 2020 2020 2020 2020  3)..            
-000155d0: 782c 2079 2061 6e64 207a 2063 6f6f 7264  x, y and z coord
-000155e0: 696e 6174 6573 206f 6620 6864 2070 6f69  inates of hd poi
-000155f0: 6e74 730d 0a20 2020 2020 2020 2076 203a  nts..        v :
-00015600: 2061 7272 6179 206f 6620 7369 7a65 2028   array of size (
-00015610: 6e64 6174 6129 0d0a 2020 2020 2020 2020  ndata)..        
-00015620: 2020 2020 4844 2070 726f 7065 7274 7920      HD property 
-00015630: 7661 6c75 6573 2061 7420 7820 706f 7369  values at x posi
-00015640: 7469 6f6e 0d0a 0d0a 2020 2020 2020 2020  tion....        
-00015650: 2222 220d 0a0d 0a20 2020 2020 2020 2070  """....        p
-00015660: 726f 703d 7365 6c66 2e6c 6973 745f 7072  rop=self.list_pr
-00015670: 6f70 7328 7365 6c66 2e67 6574 7072 6f70  ops(self.getprop
-00015680: 696e 6465 7828 7072 6f70 2929 0d0a 2020  index(prop))..  
-00015690: 2020 2020 2020 7072 6f70 2e61 6464 5f68        prop.add_h
-000156a0: 6428 782c 7629 0d0a 0d0a 0d0a 2020 2020  d(x,v)......    
-000156b0: 6465 6620 6864 5f75 6e5f 696e 5f75 6e69  def hd_un_in_uni
-000156c0: 7428 7365 6c66 2c20 756e 6974 2c20 6975  t(self, unit, iu
-000156d0: 3d30 293a 0d0a 0d0a 2020 2020 2020 2020  =0):....        
-000156e0: 2222 220d 0a20 2020 2020 2020 2045 7874  """..        Ext
-000156f0: 7261 6374 2073 7562 2d75 6e69 7473 2068  ract sub-units h
-00015700: 6172 6420 6461 7461 2066 6f72 2061 2075  ard data for a u
-00015710: 6e69 740d 0a0d 0a20 2020 2020 2020 2050  nit....        P
-00015720: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00015730: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00015740: 2020 2020 2020 2075 6e69 7420 3a20 3a63         unit : :c
-00015750: 6c61 7373 3a60 756e 6974 6020 6f62 6a65  lass:`unit` obje
-00015760: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
-00015770: 756e 6974 2074 6f20 6578 7472 6163 7420  unit to extract 
-00015780: 6861 7264 2064 6174 610d 0a20 2020 2020  hard data..     
-00015790: 2020 2069 7520 3a20 696e 740d 0a20 2020     iu : int..   
-000157a0: 2020 2020 2020 2020 2069 6e64 6578 206f           index o
-000157b0: 6620 7468 6520 756e 6974 2072 6561 6c69  f the unit reali
-000157c0: 7a61 7469 6f6e 2074 6f20 6578 7472 6163  zation to extrac
-000157d0: 7420 6861 7264 2064 6174 610d 0a0d 0a20  t hard data.... 
-000157e0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-000157f0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-00015800: 0a20 2020 2020 2020 2068 6420 3a20 6c69  .        hd : li
-00015810: 7374 206f 6620 7475 706c 6573 0d0a 2020  st of tuples..  
-00015820: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
-00015830: 6620 6861 7264 2064 6174 6120 636f 6f72  f hard data coor
-00015840: 6469 6e61 7465 7320 2878 2c79 2c7a 290d  dinates (x,y,z).
-00015850: 0a20 2020 2020 2020 2073 7562 5f75 6e69  .        sub_uni
-00015860: 7473 203a 206c 6973 7420 6f66 2069 6e74  ts : list of int
-00015870: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-00015880: 7374 206f 6620 7375 622d 756e 6974 7320  st of sub-units 
-00015890: 4944 0d0a 2020 2020 2020 2020 2222 220d  ID..        """.
-000158a0: 0a0d 0a20 2020 2020 2020 206d 6173 6b20  ...        mask 
-000158b0: 3d20 7365 6c66 2e47 656f 6c2e 756e 6974  = self.Geol.unit
-000158c0: 735f 646f 6d61 696e 735b 6975 5d20 3d3d  s_domains[iu] ==
-000158d0: 2075 6e69 742e 4944 200d 0a20 2020 2020   unit.ID ..     
-000158e0: 2020 2068 643d 5b5d 0d0a 2020 2020 2020     hd=[]..      
-000158f0: 2020 7375 625f 756e 6974 733d 5b5d 0d0a    sub_units=[]..
-00015900: 2020 2020 2020 2020 666f 7220 756e 2069          for un i
-00015910: 6e20 756e 6974 2e53 7562 5069 6c65 2e6c  n unit.SubPile.l
-00015920: 6973 745f 756e 6974 733a 0d0a 2020 2020  ist_units:..    
-00015930: 2020 2020 2020 2020 666f 7220 6978 2c69          for ix,i
-00015940: 792c 697a 2069 6e20 7a69 7028 756e 2e78  y,iz in zip(un.x
-00015950: 2c20 756e 2e79 2c75 6e2e 7a29 3a0d 0a20  , un.y,un.z):.. 
-00015960: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00015970: 656c 6c3d 7365 6c66 2e63 6f6f 7264 3263  ell=self.coord2c
-00015980: 656c 6c28 6978 2c69 792c 697a 290d 0a20  ell(ix,iy,iz).. 
-00015990: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000159a0: 6620 6365 6c6c 2069 7320 6e6f 7420 4e6f  f cell is not No
-000159b0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-000159c0: 2020 2020 2020 2020 2069 6620 6d61 736b           if mask
-000159d0: 5b63 656c 6c5d 3a0d 0a20 2020 2020 2020  [cell]:..       
-000159e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159f0: 2068 642e 6170 7065 6e64 2828 6978 2c20   hd.append((ix, 
-00015a00: 6979 2c20 697a 2929 0d0a 2020 2020 2020  iy, iz))..      
-00015a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a20: 2020 7375 625f 756e 6974 732e 6170 7065    sub_units.appe
-00015a30: 6e64 2875 6e2e 4944 290d 0a20 2020 2020  nd(un.ID)..     
-00015a40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00015a50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00015a60: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00015a70: 7373 0d0a 0d0a 2020 2020 2020 2020 7265  ss....        re
-00015a80: 7475 726e 2068 642c 2073 7562 5f75 6e69  turn hd, sub_uni
-00015a90: 7473 0d0a 0d0a 2020 2020 6465 6620 6864  ts....    def hd
-00015aa0: 5f66 615f 696e 5f75 6e69 7428 7365 6c66  _fa_in_unit(self
-00015ab0: 2c20 756e 6974 2c20 6975 3d30 293a 0d0a  , unit, iu=0):..
-00015ac0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00015ad0: 2020 2020 2020 2045 7874 7261 6374 2066         Extract f
-00015ae0: 6163 6965 7320 6861 7264 2064 6174 6120  acies hard data 
-00015af0: 666f 7220 6120 756e 6974 2061 6e64 2073  for a unit and s
-00015b00: 656e 6420 7761 726e 696e 670d 0a20 2020  end warning..   
-00015b10: 2020 2020 2069 6620 6120 6861 7264 2064       if a hard d
-00015b20: 6174 6120 7368 6f75 6c64 206e 6f74 2062  ata should not b
-00015b30: 6520 696e 2074 6865 2075 6e69 740d 0a0d  e in the unit...
-00015b40: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00015b50: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00015b60: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00015b70: 2075 6e69 7420 3a20 3a63 6c61 7373 3a60   unit : :class:`
-00015b80: 756e 6974 6020 6f62 6a65 6374 0d0a 2020  unit` object..  
-00015b90: 2020 2020 2020 2020 2020 756e 6974 2074            unit t
-00015ba0: 6f20 6578 7472 6163 7420 6861 7264 2064  o extract hard d
-00015bb0: 6174 610d 0a20 2020 2020 2020 2069 7520  ata..        iu 
-00015bc0: 3a20 696e 7420 2020 200d 0a20 2020 2020  : int    ..     
-00015bd0: 2020 2020 2020 2075 6e69 7420 7265 616c         unit real
-00015be0: 697a 6174 696f 6e20 696e 6465 7820 746f  ization index to
-00015bf0: 2065 7874 7261 6374 2068 6172 6420 6461   extract hard da
-00015c00: 7461 0d0a 2020 2020 2020 2020 2222 220d  ta..        """.
-00015c10: 0a0d 0a20 2020 2020 2020 206d 6173 6b3d  ...        mask=
-00015c20: 7365 6c66 2e75 6e69 745f 6d61 736b 2875  self.unit_mask(u
-00015c30: 6e69 742e 6e61 6d65 2c20 6975 3d69 7529  nit.name, iu=iu)
-00015c40: 0d0a 2020 2020 2020 2020 6864 3d5b 5d0d  ..        hd=[].
-00015c50: 0a20 2020 2020 2020 2066 6163 6965 733d  .        facies=
-00015c60: 5b5d 0d0a 2020 2020 2020 2020 6572 726f  []..        erro
-00015c70: 7273 3d7b 7d0d 0a20 2020 2020 2020 2066  rs={}..        f
-00015c80: 6f72 2066 6120 696e 2073 656c 662e 6765  or fa in self.ge
-00015c90: 745f 616c 6c5f 6661 6369 6573 2829 3a0d  t_all_facies():.
-00015ca0: 0a20 2020 2020 2020 2020 2020 2066 615f  .            fa_
-00015cb0: 6572 723d 300d 0a20 2020 2020 2020 2020  err=0..         
-00015cc0: 2020 2066 6f72 2069 782c 6979 2c69 7a20     for ix,iy,iz 
-00015cd0: 696e 207a 6970 2866 612e 782c 2066 612e  in zip(fa.x, fa.
-00015ce0: 792c 6661 2e7a 293a 0d0a 2020 2020 2020  y,fa.z):..      
-00015cf0: 2020 2020 2020 2020 2020 6365 6c6c 3d73            cell=s
-00015d00: 656c 662e 636f 6f72 6432 6365 6c6c 2869  elf.coord2cell(i
-00015d10: 782c 6979 2c69 7a29 0d0a 2020 2020 2020  x,iy,iz)..      
-00015d20: 2020 2020 2020 2020 2020 6966 206d 6173            if mas
-00015d30: 6b5b 6365 6c6c 5d3a 0d0a 2020 2020 2020  k[cell]:..      
-00015d40: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00015d50: 2066 6120 6e6f 7420 696e 2075 6e69 742e   fa not in unit.
-00015d60: 6c69 7374 5f66 6163 6965 733a 0d0a 2020  list_facies:..  
-00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d80: 2020 2020 2020 6661 5f65 7272 202b 3d20        fa_err += 
-00015d90: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-00015da0: 2020 2020 2020 2020 2020 2023 6966 2073             #if s
-00015db0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-00015dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dd0: 2020 2020 2020 2020 2020 2370 7269 6e74            #print
-00015de0: 2822 5761 726e 696e 6720 6661 6369 6573  ("Warning facies
-00015df0: 207b 7d20 6861 7665 2062 6565 6e20 666f   {} have been fo
-00015e00: 756e 6420 696e 7369 6465 2075 6e69 7420  und inside unit 
-00015e10: 7b7d 222e 666f 726d 6174 2866 612e 6e61  {}".format(fa.na
-00015e20: 6d65 2c20 756e 6974 2e6e 616d 6529 290d  me, unit.name)).
-00015e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015e40: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00015e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e60: 2020 2020 6864 2e61 7070 656e 6428 2869      hd.append((i
-00015e70: 782c 2069 792c 2069 7a29 290d 0a20 2020  x, iy, iz))..   
+000146f0: 2069 6620 6d61 736b 3264 5b69 792c 2069   if mask2d[iy, i
+00014700: 785d 3a0d 0a20 2020 2020 2020 2020 2020  x]:..           
+00014710: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
+00014720: 745f 6964 203d 2072 6173 7465 725b 6979  t_id = raster[iy
+00014730: 2c20 6978 5d0d 0a20 2020 2020 2020 2020  , ix]..         
+00014740: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00014750: 6e69 7420 3d20 7365 6c66 2e67 6574 5f75  nit = self.get_u
+00014760: 6e69 7428 4944 3d75 6e69 745f 6964 2c20  nit(ID=unit_id, 
+00014770: 7479 7065 3d22 4944 222c 2076 623d 3029  type="ID", vb=0)
+00014780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014790: 2020 2020 2020 2020 2020 6966 2075 6e69            if uni
+000147a0: 7420 6973 206e 6f74 204e 6f6e 653a 0d0a  t is not None:..
+000147b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147c0: 2020 2020 2020 2020 2020 2020 7a20 3d20              z = 
+000147d0: 7365 6c66 2e74 6f70 5b69 792c 2069 785d  self.top[iy, ix]
+000147e0: 2d31 652d 330d 0a20 2020 2020 2020 2020  -1e-3..         
+000147f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014800: 2020 2062 6820 3d20 626f 7265 686f 6c65     bh = borehole
+00014810: 2822 7261 7374 6572 5f62 6822 2c20 2272  ("raster_bh", "r
+00014820: 6173 7465 725f 6268 222c 2078 6763 5b69  aster_bh", xgc[i
+00014830: 785d 2c20 7967 635b 6979 5d2c 207a 2c20  x], ygc[iy], z, 
+00014840: 737a 2f34 2c20 5b28 756e 6974 2c20 7a29  sz/4, [(unit, z)
+00014850: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
+00014860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014870: 2020 6268 735f 6d61 702e 6170 7065 6e64    bhs_map.append
+00014880: 2862 6829 0d0a 2020 2020 2020 2020 2020  (bh)..          
+00014890: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000148a0: 7365 6c66 2e6c 6973 745f 6d61 705f 6268  self.list_map_bh
+000148b0: 7320 2b3d 2062 6873 5f6d 6170 0d0a 0d0a  s += bhs_map....
+000148c0: 2020 2020 2020 2020 6966 2073 616d 706c          if sampl
+000148d0: 655f 626f 756e 6461 7269 6573 3a0d 0a20  e_boundaries:.. 
+000148e0: 2020 2020 2020 2020 2020 2062 6873 203d             bhs =
+000148f0: 2073 656c 662e 6765 6f6c 5f63 6f6e 746f   self.geol_conto
+00014900: 7572 7328 7374 6570 3d73 7465 7029 0d0a  urs(step=step)..
+00014910: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014920: 2e6c 6973 745f 6d61 705f 6268 7320 2b3d  .list_map_bhs +=
+00014930: 2062 6873 0d0a 0d0a 2020 2020 2020 2020   bhs....        
+00014940: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+00014950: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00014960: 696e 7428 2247 656f 6c6f 6769 6361 6c20  int("Geological 
+00014970: 6d61 7020 6578 7472 6163 7465 6420 2d20  map extracted - 
+00014980: 7072 6f63 6573 7375 7320 656e 6465 6420  processus ended 
+00014990: 7375 6363 6573 7366 756c 6c79 2229 0d0a  successfully")..
+000149a0: 0d0a 2020 2020 2320 7265 6d6f 7665 2062  ..    # remove b
+000149b0: 6f72 6568 6f6c 6573 0d0a 2020 2020 6465  oreholes..    de
+000149c0: 6620 7265 6d5f 616c 6c5f 6268 7328 7365  f rem_all_bhs(se
+000149d0: 6c66 2c20 7374 616e 6461 7264 5f62 683d  lf, standard_bh=
+000149e0: 5472 7565 2c20 6661 6b65 5f62 683d 5472  True, fake_bh=Tr
+000149f0: 7565 2c20 6765 6f6c 5f6d 6170 5f62 683d  ue, geol_map_bh=
+00014a00: 5472 7565 293a 0d0a 0d0a 2020 2020 2020  True):....      
+00014a10: 2020 2222 2252 656d 6f76 6520 616c 6c20    """Remove all 
+00014a20: 626f 7265 686f 6c65 7320 6672 6f6d 2074  boreholes from t
+00014a30: 6865 206c 6973 740d 0a20 2020 2020 2020  he list..       
+00014a40: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
+00014a50: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+00014a60: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+00014a70: 2020 2066 616b 655f 6f6e 6c79 203a 2062     fake_only : b
+00014a80: 6f6f 6c0d 0a20 2020 2020 2020 2020 2020  ool..           
+00014a90: 2069 6620 5472 7565 2c20 6f6e 6c79 2066   if True, only f
+00014aa0: 616b 6520 626f 7265 686f 6c65 7320 6172  ake boreholes ar
+00014ab0: 6520 7265 6d6f 7665 640d 0a20 2020 2020  e removed..     
+00014ac0: 2020 2067 656f 6c5f 6d61 705f 6f6e 6c79     geol_map_only
+00014ad0: 203a 2062 6f6f 6c0d 0a20 2020 2020 2020   : bool..       
+00014ae0: 2020 2020 2069 6620 5472 7565 2c20 6f6e       if True, on
+00014af0: 6c79 2062 6f72 6568 6f6c 6573 2066 726f  ly boreholes fro
+00014b00: 6d20 6765 6f6c 6f67 6963 616c 206d 6170  m geological map
+00014b10: 2061 7265 2072 656d 6f76 6564 0d0a 2020   are removed..  
+00014b20: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+00014b30: 2020 2020 2069 6620 7374 616e 6461 7264       if standard
+00014b40: 5f62 683a 0d0a 2020 2020 2020 2020 2020  _bh:..          
+00014b50: 2020 7365 6c66 2e6c 6973 745f 6268 733d    self.list_bhs=
+00014b60: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+00014b70: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+00014b80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014b90: 2020 7072 696e 7428 2253 7461 6e64 6172    print("Standar
+00014ba0: 6420 626f 7265 686f 6c65 7320 7265 6d6f  d boreholes remo
+00014bb0: 7665 6422 290d 0a20 2020 2020 2020 200d  ved")..        .
+00014bc0: 0a20 2020 2020 2020 2069 6620 6661 6b65  .        if fake
+00014bd0: 5f62 683a 0d0a 2020 2020 2020 2020 2020  _bh:..          
+00014be0: 2020 7365 6c66 2e6c 6973 745f 6661 6b65    self.list_fake
+00014bf0: 5f62 6873 3d5b 5d0d 0a20 2020 2020 2020  _bhs=[]..       
+00014c00: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00014c10: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+00014c20: 2020 2020 2020 2070 7269 6e74 2822 4661         print("Fa
+00014c30: 6b65 2062 6f72 6568 6f6c 6573 2072 656d  ke boreholes rem
+00014c40: 6f76 6564 2229 0d0a 0d0a 2020 2020 2020  oved")....      
+00014c50: 2020 6966 2067 656f 6c5f 6d61 705f 6268    if geol_map_bh
+00014c60: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+00014c70: 656c 662e 6c69 7374 5f6d 6170 5f62 6873  elf.list_map_bhs
+00014c80: 3d5b 5d0d 0a20 2020 2020 2020 2020 2020  =[]..           
+00014c90: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00014ca0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00014cb0: 2020 2070 7269 6e74 2822 4765 6f6c 6f67     print("Geolog
+00014cc0: 6963 616c 206d 6170 2062 6f72 6568 6f6c  ical map borehol
+00014cd0: 6573 2072 656d 6f76 6564 2229 0d0a 0d0a  es removed")....
+00014ce0: 2020 2020 2020 2020 0d0a 0d0a 2020 2020          ....    
+00014cf0: 6465 6620 7265 6d5f 6268 2873 656c 662c  def rem_bh(self,
+00014d00: 2062 6829 3a0d 0a0d 0a20 2020 2020 2020   bh):....       
+00014d10: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+00014d20: 6d6f 7665 2061 2067 6976 656e 2062 6820  move a given bh 
+00014d30: 6672 6f6d 2074 6865 206c 6973 7420 6f66  from the list of
+00014d40: 2062 6f72 6568 6f6c 6573 0d0a 0d0a 2020   boreholes....  
+00014d50: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00014d60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00014d70: 2d2d 2d2d 2020 0d0a 2020 2020 2020 2020  ----  ..        
+00014d80: 6268 3a20 3a63 6c61 7373 3a60 626f 7265  bh: :class:`bore
+00014d90: 686f 6c65 6020 6f62 6a65 6374 0d0a 2020  hole` object..  
+00014da0: 2020 2020 2020 2020 2020 626f 7265 686f            boreho
+00014db0: 6c65 2074 6f20 7265 6d6f 7665 0d0a 2020  le to remove..  
+00014dc0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+00014dd0: 2020 2020 2069 6620 6268 2069 6e20 7365       if bh in se
+00014de0: 6c66 2e6c 6973 745f 6268 733a 0d0a 2020  lf.list_bhs:..  
+00014df0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+00014e00: 6973 745f 6268 732e 7265 6d6f 7665 2862  ist_bhs.remove(b
+00014e10: 6829 0d0a 2020 2020 2020 2020 2020 2020  h)..            
+00014e20: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+00014e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014e40: 2020 7072 696e 7428 2242 6f72 6568 6f6c    print("Borehol
+00014e50: 6520 7b7d 2072 656d 6f76 6564 222e 666f  e {} removed".fo
+00014e60: 726d 6174 2862 682e 4944 2929 0d0a 2020  rmat(bh.ID))..  
+00014e70: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00014e80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00014e90: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00014ea0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00014eb0: 2822 426f 7265 686f 6c65 207b 7d20 6e6f  ("Borehole {} no
+00014ec0: 7420 696e 2074 6865 206c 6973 7422 2e66  t in the list".f
+00014ed0: 6f72 6d61 7428 6268 2e49 4429 290d 0a0d  ormat(bh.ID))...
+00014ee0: 0a20 2020 2064 6566 2072 656d 5f66 616b  .    def rem_fak
+00014ef0: 655f 6268 2873 656c 662c 2062 6829 3a0d  e_bh(self, bh):.
+00014f00: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00014f10: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00014f20: 5265 6d6f 7665 2061 2067 6976 656e 2062  Remove a given b
+00014f30: 6820 6672 6f6d 2074 6865 206c 6973 7420  h from the list 
+00014f40: 6f66 2066 616b 6520 626f 7265 686f 6c65  of fake borehole
+00014f50: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
+00014f60: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00014f70: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00014f80: 2020 2020 2062 683a 203a 636c 6173 733a       bh: :class:
+00014f90: 6062 6f72 6568 6f6c 6560 206f 626a 6563  `borehole` objec
+00014fa0: 740d 0a20 2020 2020 2020 2020 2020 2062  t..            b
+00014fb0: 6f72 6568 6f6c 6520 746f 2072 656d 6f76  orehole to remov
+00014fc0: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
+00014fd0: 0d0a 2020 2020 2020 2020 6966 2062 6820  ..        if bh 
+00014fe0: 696e 2073 656c 662e 6c69 7374 5f66 616b  in self.list_fak
+00014ff0: 655f 6268 733a 0d0a 2020 2020 2020 2020  e_bhs:..        
+00015000: 2020 2020 7365 6c66 2e6c 6973 745f 6661      self.list_fa
+00015010: 6b65 5f62 6873 2e72 656d 6f76 6528 6268  ke_bhs.remove(bh
+00015020: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00015030: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
+00015040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015050: 2070 7269 6e74 2822 426f 7265 686f 6c65   print("Borehole
+00015060: 207b 7d20 7265 6d6f 7665 6422 2e66 6f72   {} removed".for
+00015070: 6d61 7428 6268 2e49 4429 290d 0a20 2020  mat(bh.ID))..   
+00015080: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00015090: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000150a0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+000150b0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000150c0: 2242 6f72 6568 6f6c 6520 7b7d 206e 6f74  "Borehole {} not
+000150d0: 2069 6e20 7468 6520 6c69 7374 222e 666f   in the list".fo
+000150e0: 726d 6174 2862 682e 4944 2929 0d0a 0d0a  rmat(bh.ID))....
+000150f0: 2020 2020 6465 6620 6572 6173 655f 6864      def erase_hd
+00015100: 2873 656c 6629 3a0d 0a0d 0a20 2020 2020  (self):....     
+00015110: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00015120: 4572 6173 6520 7468 6520 6861 7264 2064  Erase the hard d
+00015130: 6174 6120 6672 6f6d 2061 6c6c 2073 7572  ata from all sur
+00015140: 6661 6365 7320 616e 6420 6661 6369 6573  faces and facies
+00015150: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00015160: 0a20 2020 2020 2020 2066 6f72 2075 6e69  .        for uni
+00015170: 7420 696e 2073 656c 662e 6765 745f 616c  t in self.get_al
+00015180: 6c5f 756e 6974 7328 293a 0d0a 2020 2020  l_units():..    
+00015190: 2020 2020 2020 2020 733d 756e 6974 2e73          s=unit.s
+000151a0: 7572 6661 6365 0d0a 2020 2020 2020 2020  urface..        
+000151b0: 2020 2020 732e 783d 5b5d 0d0a 2020 2020      s.x=[]..    
+000151c0: 2020 2020 2020 2020 732e 793d 5b5d 0d0a          s.y=[]..
+000151d0: 2020 2020 2020 2020 2020 2020 732e 7a3d              s.z=
+000151e0: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+000151f0: 732e 696e 6571 3d5b 5d0d 0a20 2020 2020  s.ineq=[]..     
+00015200: 2020 2066 6f72 2066 6120 696e 2073 656c     for fa in sel
+00015210: 662e 6765 745f 616c 6c5f 6661 6369 6573  f.get_all_facies
+00015220: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+00015230: 2066 612e 783d 5b5d 0d0a 2020 2020 2020   fa.x=[]..      
+00015240: 2020 2020 2020 6661 2e79 3d5b 5d0d 0a20        fa.y=[].. 
+00015250: 2020 2020 2020 2020 2020 2066 612e 7a3d             fa.z=
+00015260: 5b5d 0d0a 2020 2020 2020 2020 6966 2073  []..        if s
+00015270: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
+00015280: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00015290: 2248 6172 6420 6461 7461 2072 6573 6574  "Hard data reset
+000152a0: 2229 0d0a 0d0a 2020 2020 6465 6620 7265  ")....    def re
+000152b0: 6d5f 616c 6c5f 6661 6369 6573 5f66 726f  m_all_facies_fro
+000152c0: 6d5f 756e 6974 7328 7365 6c66 293a 0d0a  m_units(self):..
+000152d0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+000152e0: 2020 2020 2020 2054 6f20 7265 6d6f 7665         To remove
+000152f0: 2066 6163 6965 7320 6672 6f6d 2061 6c6c   facies from all
+00015300: 2075 6e69 7473 0d0a 2020 2020 2020 2020   units..        
+00015310: 2222 220d 0a0d 0a20 2020 2020 2020 2066  """....        f
+00015320: 6f72 2075 6e69 7420 696e 2073 656c 662e  or unit in self.
+00015330: 6765 745f 616c 6c5f 756e 6974 7328 293a  get_all_units():
+00015340: 0d0a 2020 2020 2020 2020 2020 2020 756e  ..            un
+00015350: 6974 2e72 656d 5f66 6163 6965 7328 616c  it.rem_facies(al
+00015360: 6c5f 6661 6369 6573 3d54 7275 6529 0d0a  l_facies=True)..
+00015370: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00015380: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00015390: 2020 2020 2020 2020 7072 696e 7428 2241          print("A
+000153a0: 6c6c 2066 6163 6965 7320 6861 7665 2062  ll facies have b
+000153b0: 6565 6e20 7265 6d6f 7665 6420 6672 6f6d  een removed from
+000153c0: 2075 6e69 7473 2229 0d0a 0d0a 2020 2020   units")....    
+000153d0: 6465 6620 6f72 6465 725f 5069 6c65 7328  def order_Piles(
+000153e0: 7365 6c66 293a 0d0a 0d0a 2020 2020 2020  self):....      
+000153f0: 2020 2222 220d 0a20 2020 2020 2020 204f    """..        O
+00015400: 7264 6572 2061 6c6c 2074 6865 2075 6e69  rder all the uni
+00015410: 7473 2069 6e20 616c 6c20 7468 6520 7069  ts in all the pi
+00015420: 6c65 7320 6163 636f 7264 696e 6720 746f  les according to
+00015430: 206f 7264 6572 2061 7474 7269 6275 7465   order attribute
+00015440: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00015450: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00015460: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00015470: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00015480: 7269 6e74 2822 2323 2323 2320 4f52 4445  rint("##### ORDE
+00015490: 5249 4e47 2055 4e49 5453 2023 2323 2323  RING UNITS #####
+000154a0: 2022 290d 0a0d 0a20 2020 2020 2020 2064   ")....        d
+000154b0: 6566 206f 7264 5f66 756e 2870 696c 6529  ef ord_fun(pile)
+000154c0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+000154d0: 696c 652e 6f72 6465 725f 756e 6974 7328  ile.order_units(
+000154e0: 7662 3d73 656c 662e 7665 7262 6f73 6529  vb=self.verbose)
+000154f0: 2023 206f 7267 616e 697a 6520 7468 6520   # organize the 
+00015500: 7069 6c65 0d0a 2020 2020 2020 2020 2020  pile..          
+00015510: 2020 666f 7220 7320 696e 2070 696c 652e    for s in pile.
+00015520: 6c69 7374 5f75 6e69 7473 3a20 2363 6865  list_units: #che
+00015530: 636b 2073 7562 756e 6974 730d 0a20 2020  ck subunits..   
+00015540: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00015550: 732e 665f 6d65 7468 6f64 203d 3d20 2253  s.f_method == "S
+00015560: 7562 5069 6c65 223a 0d0a 2020 2020 2020  ubPile":..      
+00015570: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00015580: 645f 6675 6e28 732e 5375 6250 696c 6529  d_fun(s.SubPile)
+00015590: 0d0a 2020 2020 2020 2020 6f72 645f 6675  ..        ord_fu
+000155a0: 6e28 7365 6c66 2e67 6574 5f70 696c 655f  n(self.get_pile_
+000155b0: 6d61 7374 6572 2829 290d 0a0d 0a0d 0a20  master())...... 
+000155c0: 2020 2064 6566 2061 6464 5f70 726f 705f     def add_prop_
+000155d0: 6864 2873 656c 662c 7072 6f70 2c78 2c76  hd(self,prop,x,v
+000155e0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+000155f0: 220d 0a20 2020 2020 2020 2041 6464 2048  "..        Add H
+00015600: 6172 6420 6461 7461 2074 6f20 7468 6520  ard data to the 
+00015610: 7072 6f70 6572 7479 2022 7072 6f70 220d  property "prop".
+00015620: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00015630: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00015640: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00015650: 2d0d 0a20 2020 2020 2020 2070 726f 7020  -..        prop 
+00015660: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
+00015670: 2020 2020 2020 7072 6f70 6572 7479 206e        property n
+00015680: 616d 6520 6f66 2074 6865 2060 7e41 7263  ame of the `~Arc
+00015690: 6850 792e 6261 7365 2e50 726f 7060 206f  hPy.base.Prop` o
+000156a0: 626a 6563 740d 0a20 2020 2020 2020 2078  bject..        x
+000156b0: 203a 206e 6461 7272 6179 206f 6620 7369   : ndarray of si
+000156c0: 7a65 2028 6e64 6174 612c 2033 290d 0a20  ze (ndata, 3).. 
+000156d0: 2020 2020 2020 2020 2020 2078 2c20 7920             x, y 
+000156e0: 616e 6420 7a20 636f 6f72 6469 6e61 7465  and z coordinate
+000156f0: 7320 6f66 2068 6420 706f 696e 7473 0d0a  s of hd points..
+00015700: 2020 2020 2020 2020 7620 3a20 6172 7261          v : arra
+00015710: 7920 6f66 2073 697a 6520 286e 6461 7461  y of size (ndata
+00015720: 290d 0a20 2020 2020 2020 2020 2020 2048  )..            H
+00015730: 4420 7072 6f70 6572 7479 2076 616c 7565  D property value
+00015740: 7320 6174 2078 2070 6f73 6974 696f 6e0d  s at x position.
+00015750: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00015760: 0d0a 2020 2020 2020 2020 7072 6f70 3d73  ..        prop=s
+00015770: 656c 662e 6c69 7374 5f70 726f 7073 2873  elf.list_props(s
+00015780: 656c 662e 6765 7470 726f 7069 6e64 6578  elf.getpropindex
+00015790: 2870 726f 7029 290d 0a20 2020 2020 2020  (prop))..       
+000157a0: 2070 726f 702e 6164 645f 6864 2878 2c76   prop.add_hd(x,v
+000157b0: 290d 0a0d 0a0d 0a20 2020 2064 6566 2068  )......    def h
+000157c0: 645f 756e 5f69 6e5f 756e 6974 2873 656c  d_un_in_unit(sel
+000157d0: 662c 2075 6e69 742c 2069 753d 3029 3a0d  f, unit, iu=0):.
+000157e0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+000157f0: 2020 2020 2020 2020 4578 7472 6163 7420          Extract 
+00015800: 7375 622d 756e 6974 7320 6861 7264 2064  sub-units hard d
+00015810: 6174 6120 666f 7220 6120 756e 6974 0d0a  ata for a unit..
+00015820: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00015830: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00015840: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00015850: 2020 756e 6974 203a 203a 636c 6173 733a    unit : :class:
+00015860: 6075 6e69 7460 206f 626a 6563 740d 0a20  `unit` object.. 
+00015870: 2020 2020 2020 2020 2020 2075 6e69 7420             unit 
+00015880: 746f 2065 7874 7261 6374 2068 6172 6420  to extract hard 
+00015890: 6461 7461 0d0a 2020 2020 2020 2020 6975  data..        iu
+000158a0: 203a 2069 6e74 0d0a 2020 2020 2020 2020   : int..        
+000158b0: 2020 2020 696e 6465 7820 6f66 2074 6865      index of the
+000158c0: 2075 6e69 7420 7265 616c 697a 6174 696f   unit realizatio
+000158d0: 6e20 746f 2065 7874 7261 6374 2068 6172  n to extract har
+000158e0: 6420 6461 7461 0d0a 0d0a 2020 2020 2020  d data....      
+000158f0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00015900: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00015910: 2020 2020 6864 203a 206c 6973 7420 6f66      hd : list of
+00015920: 2074 7570 6c65 730d 0a20 2020 2020 2020   tuples..       
+00015930: 2020 2020 206c 6973 7420 6f66 2068 6172       list of har
+00015940: 6420 6461 7461 2063 6f6f 7264 696e 6174  d data coordinat
+00015950: 6573 2028 782c 792c 7a29 0d0a 2020 2020  es (x,y,z)..    
+00015960: 2020 2020 7375 625f 756e 6974 7320 3a20      sub_units : 
+00015970: 6c69 7374 206f 6620 696e 740d 0a20 2020  list of int..   
+00015980: 2020 2020 2020 2020 206c 6973 7420 6f66           list of
+00015990: 2073 7562 2d75 6e69 7473 2049 440d 0a20   sub-units ID.. 
+000159a0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+000159b0: 2020 2020 2020 6d61 736b 203d 2073 656c        mask = sel
+000159c0: 662e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  f.Geol.units_dom
+000159d0: 6169 6e73 5b69 755d 203d 3d20 756e 6974  ains[iu] == unit
+000159e0: 2e49 4420 0d0a 2020 2020 2020 2020 6864  .ID ..        hd
+000159f0: 3d5b 5d0d 0a20 2020 2020 2020 2073 7562  =[]..        sub
+00015a00: 5f75 6e69 7473 3d5b 5d0d 0a20 2020 2020  _units=[]..     
+00015a10: 2020 2066 6f72 2075 6e20 696e 2075 6e69     for un in uni
+00015a20: 742e 5375 6250 696c 652e 6c69 7374 5f75  t.SubPile.list_u
+00015a30: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
+00015a40: 2020 2066 6f72 2069 782c 6979 2c69 7a20     for ix,iy,iz 
+00015a50: 696e 207a 6970 2875 6e2e 782c 2075 6e2e  in zip(un.x, un.
+00015a60: 792c 756e 2e7a 293a 0d0a 2020 2020 2020  y,un.z):..      
+00015a70: 2020 2020 2020 2020 2020 6365 6c6c 3d73            cell=s
+00015a80: 656c 662e 636f 6f72 6432 6365 6c6c 2869  elf.coord2cell(i
+00015a90: 782c 6979 2c69 7a29 0d0a 2020 2020 2020  x,iy,iz)..      
+00015aa0: 2020 2020 2020 2020 2020 6966 2063 656c            if cel
+00015ab0: 6c20 6973 206e 6f74 204e 6f6e 653a 0d0a  l is not None:..
+00015ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ad0: 2020 2020 6966 206d 6173 6b5b 6365 6c6c      if mask[cell
+00015ae0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00015af0: 2020 2020 2020 2020 2020 2020 6864 2e61              hd.a
+00015b00: 7070 656e 6428 2869 782c 2069 792c 2069  ppend((ix, iy, i
+00015b10: 7a29 290d 0a20 2020 2020 2020 2020 2020  z))..           
+00015b20: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+00015b30: 5f75 6e69 7473 2e61 7070 656e 6428 756e  _units.append(un
+00015b40: 2e49 4429 0d0a 2020 2020 2020 2020 2020  .ID)..          
+00015b50: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00015b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015b70: 2020 2020 2020 2020 2070 6173 730d 0a0d           pass...
+00015b80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015b90: 6864 2c20 7375 625f 756e 6974 730d 0a0d  hd, sub_units...
+00015ba0: 0a20 2020 2064 6566 2068 645f 6661 5f69  .    def hd_fa_i
+00015bb0: 6e5f 756e 6974 2873 656c 662c 2075 6e69  n_unit(self, uni
+00015bc0: 742c 2069 753d 3029 3a0d 0a0d 0a20 2020  t, iu=0):....   
+00015bd0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00015be0: 2020 4578 7472 6163 7420 6661 6369 6573    Extract facies
+00015bf0: 2068 6172 6420 6461 7461 2066 6f72 2061   hard data for a
+00015c00: 2075 6e69 7420 616e 6420 7365 6e64 2077   unit and send w
+00015c10: 6172 6e69 6e67 0d0a 2020 2020 2020 2020  arning..        
+00015c20: 6966 2061 2068 6172 6420 6461 7461 2073  if a hard data s
+00015c30: 686f 756c 6420 6e6f 7420 6265 2069 6e20  hould not be in 
+00015c40: 7468 6520 756e 6974 0d0a 0d0a 2020 2020  the unit....    
+00015c50: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00015c60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00015c70: 2d2d 0d0a 2020 2020 2020 2020 756e 6974  --..        unit
+00015c80: 203a 203a 636c 6173 733a 6075 6e69 7460   : :class:`unit`
+00015c90: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00015ca0: 2020 2020 2075 6e69 7420 746f 2065 7874       unit to ext
+00015cb0: 7261 6374 2068 6172 6420 6461 7461 0d0a  ract hard data..
+00015cc0: 2020 2020 2020 2020 6975 203a 2069 6e74          iu : int
+00015cd0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00015ce0: 2020 756e 6974 2072 6561 6c69 7a61 7469    unit realizati
+00015cf0: 6f6e 2069 6e64 6578 2074 6f20 6578 7472  on index to extr
+00015d00: 6163 7420 6861 7264 2064 6174 610d 0a20  act hard data.. 
+00015d10: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00015d20: 2020 2020 2020 6d61 736b 3d73 656c 662e        mask=self.
+00015d30: 756e 6974 5f6d 6173 6b28 756e 6974 2e6e  unit_mask(unit.n
+00015d40: 616d 652c 2069 753d 6975 290d 0a20 2020  ame, iu=iu)..   
+00015d50: 2020 2020 2068 643d 5b5d 0d0a 2020 2020       hd=[]..    
+00015d60: 2020 2020 6661 6369 6573 3d5b 5d0d 0a20      facies=[].. 
+00015d70: 2020 2020 2020 2065 7272 6f72 733d 7b7d         errors={}
+00015d80: 0d0a 2020 2020 2020 2020 666f 7220 6661  ..        for fa
+00015d90: 2069 6e20 7365 6c66 2e67 6574 5f61 6c6c   in self.get_all
+00015da0: 5f66 6163 6965 7328 293a 0d0a 2020 2020  _facies():..    
+00015db0: 2020 2020 2020 2020 6661 5f65 7272 3d30          fa_err=0
+00015dc0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+00015dd0: 7220 6978 2c69 792c 697a 2069 6e20 7a69  r ix,iy,iz in zi
+00015de0: 7028 6661 2e78 2c20 6661 2e79 2c66 612e  p(fa.x, fa.y,fa.
+00015df0: 7a29 3a0d 0a20 2020 2020 2020 2020 2020  z):..           
+00015e00: 2020 2020 2063 656c 6c3d 7365 6c66 2e63       cell=self.c
+00015e10: 6f6f 7264 3263 656c 6c28 6978 2c69 792c  oord2cell(ix,iy,
+00015e20: 697a 290d 0a20 2020 2020 2020 2020 2020  iz)..           
+00015e30: 2020 2020 2069 6620 6d61 736b 5b63 656c       if mask[cel
+00015e40: 6c5d 3a0d 0a20 2020 2020 2020 2020 2020  l]:..           
+00015e50: 2020 2020 2020 2020 2069 6620 6661 206e           if fa n
+00015e60: 6f74 2069 6e20 756e 6974 2e6c 6973 745f  ot in unit.list_
+00015e70: 6661 6369 6573 3a0d 0a20 2020 2020 2020  facies:..       
 00015e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e90: 2020 2020 2066 6163 6965 732e 6170 7065       facies.appe
-00015ea0: 6e64 2866 612e 4944 290d 0a20 2020 2020  nd(fa.ID)..     
-00015eb0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00015ec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015ed0: 2020 2020 2020 7061 7373 0d0a 0d0a 2020        pass....  
-00015ee0: 2020 2020 2020 2020 2020 6572 726f 7273            errors
-00015ef0: 5b66 612e 6e61 6d65 5d3d 6661 5f65 7272  [fa.name]=fa_err
-00015f00: 0d0a 0d0a 2020 2020 2020 2020 2370 7269  ....        #pri
-00015f10: 6e74 2065 7272 6f72 730d 0a20 2020 2020  nt errors..     
-00015f20: 2020 2069 6620 6e70 2e73 756d 286c 6973     if np.sum(lis
-00015f30: 7428 6572 726f 7273 2e76 616c 7565 7328  t(errors.values(
-00015f40: 2929 2920 3e20 303a 0d0a 2020 2020 2020  ))) > 0:..      
-00015f50: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00015f60: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00015f70: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
-00015f80: 6f6d 6520 6572 726f 7273 2068 6176 6520  ome errors have 
-00015f90: 6265 656e 2066 6f75 6e64 205c 6e53 6f6d  been found \nSom
-00015fa0: 6520 6661 6369 6573 2077 6572 6520 666f  e facies were fo
-00015fb0: 756e 6420 696e 7369 6465 2075 6e69 7473  und inside units
-00015fc0: 2077 6865 7265 2074 6865 7920 7368 6f75   where they shou
-00015fd0: 6c64 6e27 7420 6265 205c 6e5c 6e23 2323  ldn't be \n\n###
-00015fe0: 204c 6973 7420 6f66 2065 7272 6f72 7320   List of errors 
-00015ff0: 2323 2323 2229 0d0a 2020 2020 2020 2020  ####")..        
-00016000: 2020 2020 2020 2020 666f 7220 6b2c 7620          for k,v 
-00016010: 696e 2065 7272 6f72 732e 6974 656d 7328  in errors.items(
-00016020: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00016030: 2020 2020 2020 2020 6966 2076 203e 2030          if v > 0
-00016040: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00016050: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00016060: 2822 4661 6369 6573 207b 7d3a 207b 7d20  ("Facies {}: {} 
-00016070: 706f 696e 7473 222e 666f 726d 6174 286b  points".format(k
-00016080: 2c76 2929 0d0a 0d0a 2020 2020 2020 2020  ,v))....        
-00016090: 2020 2020 2020 2020 7072 696e 7428 225c          print("\
-000160a0: 6e22 290d 0a0d 0a20 2020 2020 2020 2072  n")....        r
-000160b0: 6574 7572 6e20 6864 2c20 6661 6369 6573  eturn hd, facies
-000160c0: 0d0a 0d0a 2020 2020 6465 6620 636f 6d70  ....    def comp
-000160d0: 7574 655f 6469 7374 7269 6275 7469 6f6e  ute_distribution
-000160e0: 2873 656c 6629 3a0d 0a0d 0a20 2020 2020  (self):....     
-000160f0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00016100: 436f 6d70 7574 6520 7468 6520 7072 6f62  Compute the prob
-00016110: 6162 696c 6974 7920 6469 7374 7269 6275  ability distribu
-00016120: 7469 6f6e 206f 6620 7468 6520 6861 7264  tion of the hard
-00016130: 2064 6174 6120 666f 7220 6561 6368 2075   data for each u
-00016140: 6e69 740d 0a20 2020 2020 2020 2046 6f72  nit..        For
-00016150: 2065 6163 6820 756e 6974 2c20 7468 6520   each unit, the 
-00016160: 6469 7374 7269 6275 7469 6f6e 2069 7320  distribution is 
-00016170: 636f 6d70 7574 6564 2075 7369 6e67 2074  computed using t
-00016180: 6865 204e 6f72 6d61 6c20 5363 6f72 6520  he Normal Score 
-00016190: 5472 616e 7366 6f72 6d0d 0a20 2020 2020  Transform..     
-000161a0: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-000161b0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
-000161c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000161d0: 7072 696e 7428 225c 6e20 2323 2043 6f6d  print("\n ## Com
-000161e0: 7075 7469 6e67 2064 6973 7472 6962 7574  puting distribut
-000161f0: 696f 6e73 2066 6f72 204e 6f72 6d61 6c20  ions for Normal 
-00016200: 5363 6f72 6520 5472 616e 7366 6f72 6d20  Score Transform 
-00016210: 2323 5c6e 2229 0d0a 0d0a 2020 2020 2020  ##\n")....      
-00016220: 2020 666f 7220 756e 6974 2069 6e20 7365    for unit in se
-00016230: 6c66 2e67 6574 5f61 6c6c 5f75 6e69 7473  lf.get_all_units
-00016240: 2872 6563 6f6d 7075 7465 3d54 7275 6529  (recompute=True)
-00016250: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
-00016260: 2069 6620 756e 6974 2e73 7572 6661 6365   if unit.surface
-00016270: 2e4e 5f74 7261 6e73 666f 3a0d 0a0d 0a20  .N_transfo:.... 
-00016280: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00016290: 6174 6120 3d20 6e70 2e61 7272 6179 2875  ata = np.array(u
-000162a0: 6e69 742e 7375 7266 6163 652e 7a29 0d0a  nit.surface.z)..
-000162b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162c0: 7461 7520 3d20 756e 6974 2e73 7572 6661  tau = unit.surfa
-000162d0: 6365 2e64 6963 5f73 7572 665b 2274 6175  ce.dic_surf["tau
-000162e0: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-000162f0: 2020 2020 6261 6e64 7769 6474 685f 6d75      bandwidth_mu
-00016300: 6c74 203d 2075 6e69 742e 7375 7266 6163  lt = unit.surfac
-00016310: 652e 6469 635f 7375 7266 5b22 6261 6e64  e.dic_surf["band
-00016320: 7769 6474 685f 6d75 6c74 225d 0d0a 2020  width_mult"]..  
-00016330: 2020 2020 2020 2020 2020 2020 2020 6e20                n 
-00016340: 3d20 6c65 6e28 6461 7461 290d 0a0d 0a20  = len(data).... 
-00016350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016360: 6620 6e20 3e20 3130 3a0d 0a0d 0a20 2020  f n > 10:....   
-00016370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016380: 2069 6620 6261 6e64 7769 6474 685f 6d75   if bandwidth_mu
-00016390: 6c74 203e 2030 3a0d 0a0d 0a20 2020 2020  lt > 0:....     
-000163a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000163b0: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-000163c0: 6e65 6967 6862 6f72 7320 696d 706f 7274  neighbors import
-000163d0: 204b 6572 6e65 6c44 656e 7369 7479 0d0a   KernelDensity..
-000163e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000163f0: 2020 2020 2020 2020 6672 6f6d 2073 6369          from sci
-00016400: 7079 2e73 7461 7473 2069 6d70 6f72 7420  py.stats import 
-00016410: 6971 720d 0a0d 0a20 2020 2020 2020 2020  iqr....         
-00016420: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00016430: 616e 6477 6964 7468 203d 2062 616e 6477  andwidth = bandw
-00016440: 6964 7468 5f6d 756c 742a 2030 2e39 202a  idth_mult* 0.9 *
-00016450: 206d 696e 2028 6e70 2e73 7464 2864 6174   min (np.std(dat
-00016460: 6129 2c20 6971 7228 6461 7461 2929 202a  a), iqr(data)) *
-00016470: 206e 2a2a 282d 312f 3529 0d0a 2020 2020   n**(-1/5)..    
-00016480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016490: 2020 2020 6966 2062 616e 6477 6964 7468      if bandwidth
-000164a0: 203e 2030 3a0d 0a0d 0a20 2020 2020 2020   > 0:....       
-000164b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164c0: 2020 2020 206b 6465 203d 204b 6572 6e65       kde = Kerne
-000164d0: 6c44 656e 7369 7479 286b 6572 6e65 6c3d  lDensity(kernel=
-000164e0: 2767 6175 7373 6961 6e27 2c20 6261 6e64  'gaussian', band
-000164f0: 7769 6474 683d 6261 6e64 7769 6474 6829  width=bandwidth)
-00016500: 2e66 6974 2864 6174 612e 7265 7368 6170  .fit(data.reshap
-00016510: 6528 2d31 2c20 3129 290d 0a20 2020 2020  e(-1, 1))..     
-00016520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016530: 2020 2020 2020 2064 6174 615f 6b65 726e         data_kern
-00016540: 203d 206b 6465 2e73 616d 706c 6528 3130   = kde.sample(10
-00016550: 3030 290d 0a20 2020 2020 2020 2020 2020  00)..           
-00016560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016570: 2064 6920 3d20 7374 6f72 655f 6469 7374   di = store_dist
-00016580: 7269 2864 6174 615f 6b65 726e 2c20 743d  ri(data_kern, t=
-00016590: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
-000165a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165b0: 756e 6974 2e73 7572 6661 6365 2e64 6973  unit.surface.dis
-000165c0: 7472 6962 7574 696f 6e20 3d20 6469 0d0a  tribution = di..
-000165d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000165f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016600: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-00016610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016620: 2020 2020 2065 6c73 653a 0d0a 0d0a 2020       else:....  
+00015e90: 2066 615f 6572 7220 2b3d 2031 0d0a 2020   fa_err += 1..  
+00015ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015eb0: 2020 2020 2020 2369 6620 7365 6c66 2e76        #if self.v
+00015ec0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+00015ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ee0: 2020 2020 2023 7072 696e 7428 2257 6172       #print("War
+00015ef0: 6e69 6e67 2066 6163 6965 7320 7b7d 2068  ning facies {} h
+00015f00: 6176 6520 6265 656e 2066 6f75 6e64 2069  ave been found i
+00015f10: 6e73 6964 6520 756e 6974 207b 7d22 2e66  nside unit {}".f
+00015f20: 6f72 6d61 7428 6661 2e6e 616d 652c 2075  ormat(fa.name, u
+00015f30: 6e69 742e 6e61 6d65 2929 0d0a 2020 2020  nit.name))..    
+00015f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f50: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00015f60: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00015f70: 642e 6170 7065 6e64 2828 6978 2c20 6979  d.append((ix, iy
+00015f80: 2c20 697a 2929 0d0a 2020 2020 2020 2020  , iz))..        
+00015f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fa0: 6661 6369 6573 2e61 7070 656e 6428 6661  facies.append(fa
+00015fb0: 2e49 4429 0d0a 2020 2020 2020 2020 2020  .ID)..          
+00015fc0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00015fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015fe0: 2070 6173 730d 0a0d 0a20 2020 2020 2020   pass....       
+00015ff0: 2020 2020 2065 7272 6f72 735b 6661 2e6e       errors[fa.n
+00016000: 616d 655d 3d66 615f 6572 720d 0a0d 0a20  ame]=fa_err.... 
+00016010: 2020 2020 2020 2023 7072 696e 7420 6572         #print er
+00016020: 726f 7273 0d0a 2020 2020 2020 2020 6966  rors..        if
+00016030: 206e 702e 7375 6d28 6c69 7374 2865 7272   np.sum(list(err
+00016040: 6f72 732e 7661 6c75 6573 2829 2929 203e  ors.values())) >
+00016050: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+00016060: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00016070: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00016080: 2020 2070 7269 6e74 2822 536f 6d65 2065     print("Some e
+00016090: 7272 6f72 7320 6861 7665 2062 6565 6e20  rrors have been 
+000160a0: 666f 756e 6420 5c6e 536f 6d65 2066 6163  found \nSome fac
+000160b0: 6965 7320 7765 7265 2066 6f75 6e64 2069  ies were found i
+000160c0: 6e73 6964 6520 756e 6974 7320 7768 6572  nside units wher
+000160d0: 6520 7468 6579 2073 686f 756c 646e 2774  e they shouldn't
+000160e0: 2062 6520 5c6e 5c6e 2323 2320 4c69 7374   be \n\n### List
+000160f0: 206f 6620 6572 726f 7273 2023 2323 2322   of errors ####"
+00016100: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00016110: 2020 2066 6f72 206b 2c76 2069 6e20 6572     for k,v in er
+00016120: 726f 7273 2e69 7465 6d73 2829 3a0d 0a20  rors.items():.. 
+00016130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016140: 2020 2069 6620 7620 3e20 303a 0d0a 2020     if v > 0:..  
+00016150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016160: 2020 2020 2020 7072 696e 7428 2246 6163        print("Fac
+00016170: 6965 7320 7b7d 3a20 7b7d 2070 6f69 6e74  ies {}: {} point
+00016180: 7322 2e66 6f72 6d61 7428 6b2c 7629 290d  s".format(k,v)).
+00016190: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000161a0: 2020 2070 7269 6e74 2822 5c6e 2229 0d0a     print("\n")..
+000161b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000161c0: 2068 642c 2066 6163 6965 730d 0a0d 0a20   hd, facies.... 
+000161d0: 2020 2064 6566 2063 6f6d 7075 7465 5f64     def compute_d
+000161e0: 6973 7472 6962 7574 696f 6e28 7365 6c66  istribution(self
+000161f0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+00016200: 220d 0a20 2020 2020 2020 2043 6f6d 7075  "..        Compu
+00016210: 7465 2074 6865 2070 726f 6261 6269 6c69  te the probabili
+00016220: 7479 2064 6973 7472 6962 7574 696f 6e20  ty distribution 
+00016230: 6f66 2074 6865 2068 6172 6420 6461 7461  of the hard data
+00016240: 2066 6f72 2065 6163 6820 756e 6974 0d0a   for each unit..
+00016250: 2020 2020 2020 2020 466f 7220 6561 6368          For each
+00016260: 2075 6e69 742c 2074 6865 2064 6973 7472   unit, the distr
+00016270: 6962 7574 696f 6e20 6973 2063 6f6d 7075  ibution is compu
+00016280: 7465 6420 7573 696e 6720 7468 6520 4e6f  ted using the No
+00016290: 726d 616c 2053 636f 7265 2054 7261 6e73  rmal Score Trans
+000162a0: 666f 726d 0d0a 2020 2020 2020 2020 2222  form..        ""
+000162b0: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
+000162c0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+000162d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000162e0: 2822 5c6e 2023 2320 436f 6d70 7574 696e  ("\n ## Computin
+000162f0: 6720 6469 7374 7269 6275 7469 6f6e 7320  g distributions 
+00016300: 666f 7220 4e6f 726d 616c 2053 636f 7265  for Normal Score
+00016310: 2054 7261 6e73 666f 726d 2023 235c 6e22   Transform ##\n"
+00016320: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
+00016330: 2075 6e69 7420 696e 2073 656c 662e 6765   unit in self.ge
+00016340: 745f 616c 6c5f 756e 6974 7328 7265 636f  t_all_units(reco
+00016350: 6d70 7574 653d 5472 7565 293a 0d0a 0d0a  mpute=True):....
+00016360: 2020 2020 2020 2020 2020 2020 6966 2075              if u
+00016370: 6e69 742e 7375 7266 6163 652e 4e5f 7472  nit.surface.N_tr
+00016380: 616e 7366 6f3a 0d0a 0d0a 2020 2020 2020  ansfo:....      
+00016390: 2020 2020 2020 2020 2020 6461 7461 203d            data =
+000163a0: 206e 702e 6172 7261 7928 756e 6974 2e73   np.array(unit.s
+000163b0: 7572 6661 6365 2e7a 290d 0a20 2020 2020  urface.z)..     
+000163c0: 2020 2020 2020 2020 2020 2074 6175 203d             tau =
+000163d0: 2075 6e69 742e 7375 7266 6163 652e 6469   unit.surface.di
+000163e0: 635f 7375 7266 5b22 7461 7522 5d0d 0a20  c_surf["tau"].. 
+000163f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00016400: 616e 6477 6964 7468 5f6d 756c 7420 3d20  andwidth_mult = 
+00016410: 756e 6974 2e73 7572 6661 6365 2e64 6963  unit.surface.dic
+00016420: 5f73 7572 665b 2262 616e 6477 6964 7468  _surf["bandwidth
+00016430: 5f6d 756c 7422 5d0d 0a20 2020 2020 2020  _mult"]..       
+00016440: 2020 2020 2020 2020 206e 203d 206c 656e           n = len
+00016450: 2864 6174 6129 0d0a 0d0a 2020 2020 2020  (data)....      
+00016460: 2020 2020 2020 2020 2020 6966 206e 203e            if n >
+00016470: 2031 303a 0d0a 0d0a 2020 2020 2020 2020   10:....        
+00016480: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+00016490: 616e 6477 6964 7468 5f6d 756c 7420 3e20  andwidth_mult > 
+000164a0: 303a 0d0a 0d0a 2020 2020 2020 2020 2020  0:....          
+000164b0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+000164c0: 6f6d 2073 6b6c 6561 726e 2e6e 6569 6768  om sklearn.neigh
+000164d0: 626f 7273 2069 6d70 6f72 7420 4b65 726e  bors import Kern
+000164e0: 656c 4465 6e73 6974 790d 0a20 2020 2020  elDensity..     
+000164f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016500: 2020 2066 726f 6d20 7363 6970 792e 7374     from scipy.st
+00016510: 6174 7320 696d 706f 7274 2069 7172 0d0a  ats import iqr..
+00016520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00016530: 2020 2020 2020 2020 2020 6261 6e64 7769            bandwi
+00016540: 6474 6820 3d20 6261 6e64 7769 6474 685f  dth = bandwidth_
+00016550: 6d75 6c74 2a20 302e 3920 2a20 6d69 6e20  mult* 0.9 * min 
+00016560: 286e 702e 7374 6428 6461 7461 292c 2069  (np.std(data), i
+00016570: 7172 2864 6174 6129 2920 2a20 6e2a 2a28  qr(data)) * n**(
+00016580: 2d31 2f35 290d 0a20 2020 2020 2020 2020  -1/5)..         
+00016590: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000165a0: 6620 6261 6e64 7769 6474 6820 3e20 303a  f bandwidth > 0:
+000165b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000165c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000165d0: 6b64 6520 3d20 4b65 726e 656c 4465 6e73  kde = KernelDens
+000165e0: 6974 7928 6b65 726e 656c 3d27 6761 7573  ity(kernel='gaus
+000165f0: 7369 616e 272c 2062 616e 6477 6964 7468  sian', bandwidth
+00016600: 3d62 616e 6477 6964 7468 292e 6669 7428  =bandwidth).fit(
+00016610: 6461 7461 2e72 6573 6861 7065 282d 312c  data.reshape(-1,
+00016620: 2031 2929 0d0a 2020 2020 2020 2020 2020   1))..          
 00016630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016640: 2020 2020 2020 6469 203d 2073 746f 7265        di = store
-00016650: 5f64 6973 7472 6928 6461 7461 5f6b 6572  _distri(data_ker
-00016660: 6e2c 2074 3d30 290d 0a20 2020 2020 2020  n, t=0)..       
-00016670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016680: 2075 6e69 742e 7375 7266 6163 652e 6469   unit.surface.di
-00016690: 7374 7269 6275 7469 6f6e 203d 2064 690d  stribution = di.
-000166a0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000166b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000166c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000166d0: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+00016640: 2020 6461 7461 5f6b 6572 6e20 3d20 6b64    data_kern = kd
+00016650: 652e 7361 6d70 6c65 2831 3030 3029 0d0a  e.sample(1000)..
+00016660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016670: 2020 2020 2020 2020 2020 2020 6469 203d              di =
+00016680: 2073 746f 7265 5f64 6973 7472 6928 6461   store_distri(da
+00016690: 7461 5f6b 6572 6e2c 2074 3d30 290d 0a20  ta_kern, t=0).. 
+000166a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166b0: 2020 2020 2020 2020 2020 2075 6e69 742e             unit.
+000166c0: 7375 7266 6163 652e 6469 7374 7269 6275  surface.distribu
+000166d0: 7469 6f6e 203d 2064 690d 0a20 2020 2020  tion = di..     
 000166e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166f0: 2020 2020 2020 2020 7072 696e 7428 224e          print("N
-00016700: 6f74 2065 6e6f 7567 6820 6461 7461 2070  ot enough data p
-00016710: 6f69 6e74 7320 746f 2065 7374 696d 6174  oints to estimat
-00016720: 6520 6120 6364 6620 616e 6420 7573 6520  e a cdf and use 
-00016730: 4e6f 726d 616c 2053 636f 7265 2054 7261  Normal Score Tra
-00016740: 6e73 666f 726d 2066 6f72 2075 6e69 7420  nsform for unit 
-00016750: 7b7d 205c 6e22 2e66 6f72 6d61 7428 756e  {} \n".format(un
-00016760: 6974 2e6e 616d 6529 290d 0a20 2020 2020  it.name))..     
-00016770: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00016780: 6e69 742e 7375 7266 6163 652e 4e5f 7472  nit.surface.N_tr
-00016790: 616e 7366 6f20 3d20 4661 6c73 650d 0a20  ansfo = False.. 
-000167a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167b0: 2020 2075 6e69 742e 7375 7266 6163 652e     unit.surface.
-000167c0: 6469 635f 7375 7266 5b22 4e5f 7472 616e  dic_surf["N_tran
-000167d0: 7366 6f22 5d20 3d20 4661 6c73 650d 0a20  sfo"] = False.. 
-000167e0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000167f0: 6465 6620 6573 7469 6d61 7465 5f73 7572  def estimate_sur
-00016800: 665f 7061 7261 6d73 2873 656c 662c 2064  f_params(self, d
-00016810: 6566 6175 6c74 5f63 6f76 6d6f 6465 6c3d  efault_covmodel=
-00016820: 4e6f 6e65 2c20 6175 746f 3d46 616c 7365  None, auto=False
-00016830: 2c20 2a2a 6b77 6172 6773 293a 0d0a 0d0a  , **kwargs):....
-00016840: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00016850: 2020 2020 2041 6c69 6173 2066 6f72 2069       Alias for i
-00016860: 6e66 6572 2073 7572 6661 6365 2069 6e20  nfer surface in 
-00016870: 4172 6368 5079 2e69 6e66 6572 0d0a 0d0a  ArchPy.infer....
-00016880: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00016890: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-000168a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-000168b0: 6465 6661 756c 745f 636f 766d 6f64 656c  default_covmodel
-000168c0: 203a 2073 7472 2c20 6465 6661 756c 7420   : str, default 
-000168d0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-000168e0: 2020 6465 6661 756c 7420 636f 7661 7269    default covari
-000168f0: 616e 6365 206d 6f64 656c 2074 6f20 7573  ance model to us
-00016900: 6520 666f 7220 7375 7266 6163 6520 6573  e for surface es
-00016910: 7469 6d61 7469 6f6e 0d0a 2020 2020 2020  timation..      
-00016920: 2020 6175 746f 2020 203a 2062 6f6f 6c0d    auto   : bool.
-00016930: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-00016940: 6175 746f 6d61 7469 6361 6c6c 7920 696e  automatically in
-00016950: 6665 7220 7061 7261 6d65 7465 7220 2854  fer parameter (T
-00016960: 7275 6529 206f 7220 6e6f 7420 2846 616c  rue) or not (Fal
-00016970: 7365 290d 0a20 2020 2020 2020 206b 7761  se)..        kwa
-00016980: 7267 7320 3a20 0d0a 2020 2020 2020 2020  rgs : ..        
-00016990: 2020 2020 7661 7269 6f75 7320 6b77 6172      various kwar
-000169a0: 6773 2061 6e64 2070 6172 616d 6574 6572  gs and parameter
-000169b0: 7320 7468 6174 2063 616e 2062 6520 7061  s that can be pa
-000169c0: 7373 6564 2074 6f20 4172 6368 5079 2e69  ssed to ArchPy.i
-000169d0: 6e66 6572 2e69 6e66 6572 5f73 7572 6661  nfer.infer_surfa
-000169e0: 6365 206f 7220 4172 6368 5079 2e69 6e66  ce or ArchPy.inf
-000169f0: 6572 2e66 6974 5f73 7572 6661 6365 730d  er.fit_surfaces.
-00016a00: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-00016a10: 2020 2020 2020 2020 696d 706f 7274 2041          import A
-00016a20: 7263 6850 792e 696e 6665 7220 6173 2061  rchPy.infer as a
-00016a30: 7069 0d0a 2020 2020 2020 2020 2320 6465  pi..        # de
-00016a40: 6661 756c 7420 7375 7266 6163 6520 636f  fault surface co
-00016a50: 766d 6f64 656c 0d0a 2020 2020 2020 2020  vmodel..        
-00016a60: 6966 2061 7574 6f3a 0d0a 2020 2020 2020  if auto:..      
-00016a70: 2020 2020 2020 7072 696e 7428 2223 2323        print("###
-00016a80: 2053 5552 4641 4345 2050 4152 414d 4554   SURFACE PARAMET
-00016a90: 4552 5320 4553 5449 4d41 5449 4f4e 2023  ERS ESTIMATION #
-00016aa0: 2323 205c 6e22 290d 0a20 2020 2020 2020  ## \n")..       
-00016ab0: 2020 2020 2066 6f72 2075 2069 6e20 7365       for u in se
-00016ac0: 6c66 2e6c 6973 745f 616c 6c5f 756e 6974  lf.list_all_unit
-00016ad0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00016ae0: 2020 2020 7072 696e 7428 2223 2323 2055      print("### U
-00016af0: 4e49 5420 3a20 7b7d 2023 2323 205c 6e22  NIT : {} ### \n"
-00016b00: 2e66 6f72 6d61 7428 752e 6e61 6d65 2929  .format(u.name))
-00016b10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00016b20: 2020 6170 692e 696e 6665 725f 7375 7266    api.infer_surf
-00016b30: 6163 6528 7365 6c66 2c20 752c 2064 6566  ace(self, u, def
-00016b40: 6175 6c74 5f63 6f76 6d6f 6465 6c3d 6465  ault_covmodel=de
-00016b50: 6661 756c 745f 636f 766d 6f64 656c 2c20  fault_covmodel, 
-00016b60: 2a2a 6b77 6172 6773 290d 0a20 2020 2020  **kwargs)..     
-00016b70: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00016b80: 2020 2020 2020 6170 692e 6669 745f 7375        api.fit_su
-00016b90: 7266 6163 6573 2873 656c 662c 2064 6566  rfaces(self, def
-00016ba0: 6175 6c74 5f63 6f76 6d6f 6465 6c3d 6465  ault_covmodel=de
-00016bb0: 6661 756c 745f 636f 766d 6f64 656c 2c20  fault_covmodel, 
-00016bc0: 2a2a 6b77 6172 6773 290d 0a0d 0a0d 0a20  **kwargs)...... 
-00016bd0: 2020 2064 6566 2067 6574 5f70 726f 706f     def get_propo
-00016be0: 7274 696f 6e73 2873 656c 662c 2074 7970  rtions(self, typ
-00016bf0: 653d 2275 6e69 7473 222c 2064 6570 7468  e="units", depth
-00016c00: 5f6d 696e 3d30 2c20 6465 7074 685f 6d61  _min=0, depth_ma
-00016c10: 783d 6e70 2e69 6e66 2c20 6967 6e6f 7265  x=np.inf, ignore
-00016c20: 5f75 6e69 7473 3d5b 5d2c 206d 6173 6b3d  _units=[], mask=
-00016c30: 4e6f 6e65 293a 0d0a 0d0a 2020 2020 2020  None):....      
-00016c40: 2020 2222 220d 0a20 2020 2020 2020 2046    """..        F
-00016c50: 756e 6374 696f 6e20 7468 6174 2072 6574  unction that ret
-00016c60: 7572 6e73 2074 6865 2070 726f 706f 7274  urns the proport
-00016c70: 696f 6e73 206f 6620 7468 6520 756e 6974  ions of the unit
-00016c80: 7320 696e 2074 6865 2062 6f72 6568 6f6c  s in the borehol
-00016c90: 6573 0d0a 0d0a 2020 2020 2020 2020 5061  es....        Pa
-00016ca0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00016cb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00016cc0: 2020 2020 2020 7479 7065 2020 2020 2020        type      
-00016cd0: 2020 203a 2073 7472 0d0a 2020 2020 2020     : str..      
-00016ce0: 2020 2020 2020 7479 7065 206f 6620 7072        type of pr
-00016cf0: 6f70 6f72 7469 6f6e 7320 746f 2072 6574  oportions to ret
-00016d00: 7572 6e0d 0a20 2020 2020 2020 2020 2020  urn..           
-00016d10: 2022 756e 6974 7322 2020 3a20 7072 6f70   "units"  : prop
-00016d20: 6f72 7469 6f6e 7320 6f66 2075 6e69 7473  ortions of units
-00016d30: 0d0a 2020 2020 2020 2020 2020 2020 2266  ..            "f
-00016d40: 6163 6965 7322 203a 2070 726f 706f 7274  acies" : proport
-00016d50: 696f 6e73 206f 6620 6661 6369 6573 0d0a  ions of facies..
-00016d60: 2020 2020 2020 2020 6465 7074 685f 6d61          depth_ma
-00016d70: 7820 2020 203a 2066 6c6f 6174 2c20 6465  x    : float, de
-00016d80: 6661 756c 7420 6e70 2e69 6e66 0d0a 2020  fault np.inf..  
-00016d90: 2020 2020 2020 2020 2020 6d61 7869 6d75            maximu
-00016da0: 6d20 6465 7074 6820 6f66 2069 6e76 6573  m depth of inves
-00016db0: 7469 6761 7469 6f6e 2069 6e20 7468 6520  tigation in the 
-00016dc0: 626f 7265 686f 6c65 730d 0a20 2020 2020  boreholes..     
-00016dd0: 2020 2064 6570 7468 5f6d 696e 2020 2020     depth_min    
-00016de0: 3a20 666c 6f61 742c 2064 6566 6175 6c74  : float, default
-00016df0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00016e00: 6d69 6e69 6d75 6d20 6465 7074 6820 6f66  minimum depth of
-00016e10: 2069 6e76 6573 7469 6761 7469 6f6e 2069   investigation i
-00016e20: 6e20 7468 6520 626f 7265 686f 6c65 730d  n the boreholes.
-00016e30: 0a20 2020 2020 2020 2069 676e 6f72 655f  .        ignore_
-00016e40: 756e 6974 7320 3a20 6c69 7374 206f 6620  units : list of 
-00016e50: 7374 722c 2064 6566 6175 6c74 205b 5d0d  str, default [].
-00016e60: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
-00016e70: 7473 206e 616d 6520 746f 2069 676e 6f72  ts name to ignor
-00016e80: 6520 6475 7269 6e67 2074 6865 2061 6e61  e during the ana
-00016e90: 6c79 7369 730d 0a20 2020 2020 2020 206d  lysis..        m
-00016ea0: 6173 6b20 2020 2020 2020 2020 3a20 3244  ask         : 2D
-00016eb0: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
-00016ec0: 2028 6e79 2c20 6e78 292c 2064 6566 6175   (ny, nx), defau
-00016ed0: 6c74 204e 6f6e 650d 0a20 2020 2020 2020  lt None..       
-00016ee0: 2020 2020 206d 6173 6b20 7768 6572 6520       mask where 
-00016ef0: 746f 2061 6e61 6c79 7365 2074 6865 2062  to analyse the b
-00016f00: 6f72 6568 6f6c 6573 0d0a 0d0a 2020 2020  oreholes....    
-00016f10: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-00016f20: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-00016f30: 2020 2020 2020 6469 6374 696f 6e6e 6172        dictionnar
-00016f40: 790d 0a20 2020 2020 2020 2022 2222 0d0a  y..        """..
-00016f50: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00016f60: 2020 6c69 7374 5f62 6873 203d 2073 656c    list_bhs = sel
-00016f70: 662e 6c69 7374 5f62 6873 0d0a 0d0a 2020  f.list_bhs....  
-00016f80: 2020 2020 2020 6966 206d 6173 6b20 6973        if mask is
-00016f90: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00016fa0: 2020 2020 2020 2020 6e65 775f 6c5f 6268          new_l_bh
-00016fb0: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
-00016fc0: 2020 2020 666f 7220 6268 2069 6e20 6c69      for bh in li
-00016fd0: 7374 5f62 6873 3a0d 0a20 2020 2020 2020  st_bhs:..       
-00016fe0: 2020 2020 2020 2020 2069 792c 2069 7820           iy, ix 
-00016ff0: 3d20 7365 6c66 2e63 6f6f 7264 3263 656c  = self.coord2cel
-00017000: 6c28 6268 2e78 2c20 6268 2e79 290d 0a20  l(bh.x, bh.y).. 
-00017010: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00017020: 6620 6d61 736b 5b69 792c 2069 785d 3a0d  f mask[iy, ix]:.
-00017030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017040: 2020 2020 206e 6577 5f6c 5f62 6873 2e61       new_l_bhs.a
-00017050: 7070 656e 6428 6268 290d 0a20 2020 2020  ppend(bh)..     
-00017060: 2020 2020 2020 206c 6973 745f 6268 7320         list_bhs 
-00017070: 3d20 6e65 775f 6c5f 6268 730d 0a0d 0a0d  = new_l_bhs.....
-00017080: 0a20 2020 2020 2020 206d 6574 6572 735f  .        meters_
-00017090: 756e 6974 7320 3d20 7b7d 0d0a 0d0a 2020  units = {}....  
-000170a0: 2020 2020 2020 666f 7220 6268 2069 6e20        for bh in 
-000170b0: 6c69 7374 5f62 6873 5b3a 5d3a 0d0a 0d0a  list_bhs[:]:....
-000170c0: 2020 2020 2020 2020 2020 2020 7a5f 6d69              z_mi
-000170d0: 6e20 3d20 6268 2e7a 202d 2064 6570 7468  n = bh.z - depth
-000170e0: 5f6d 6178 2020 2320 6d69 6e69 6d75 6d20  _max  # minimum 
-000170f0: 616c 7469 7475 6465 206f 6620 696e 7665  altitude of inve
-00017100: 7374 6967 6174 696f 6e0d 0a20 2020 2020  stigation..     
-00017110: 2020 2020 2020 207a 5f6d 6178 203d 2062         z_max = b
-00017120: 682e 7a20 2d20 6465 7074 685f 6d69 6e20  h.z - depth_min 
-00017130: 2023 206d 6178 696d 756d 2061 6c74 6974   # maximum altit
-00017140: 7564 6520 6f66 2069 6e76 6573 7469 6761  ude of investiga
-00017150: 7469 6f6e 0d0a 0d0a 2020 2020 2020 2020  tion....        
-00017160: 2020 2020 6966 2074 7970 6520 3d3d 2022      if type == "
-00017170: 756e 6974 7322 3a0d 0a20 2020 2020 2020  units":..       
-00017180: 2020 2020 2020 2020 206c 6f67 203d 2062           log = b
-00017190: 682e 6c6f 675f 7374 7261 7469 0d0a 2020  h.log_strati..  
-000171a0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-000171b0: 7970 6520 3d3d 2022 6661 6369 6573 223a  ype == "facies":
-000171c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000171d0: 2020 6c6f 6720 3d20 6268 2e6c 6f67 5f66    log = bh.log_f
-000171e0: 6163 6965 730d 0a0d 0a20 2020 2020 2020  acies....       
-000171f0: 2020 2020 2069 6620 6c6f 6720 6973 206e       if log is n
-00017200: 6f74 204e 6f6e 653a 0d0a 0d0a 2020 2020  ot None:....    
-00017210: 2020 2020 2020 2020 2020 2020 7468 6b20              thk 
-00017220: 3d20 300d 0a0d 0a20 2020 2020 2020 2020  = 0....         
-00017230: 2020 2020 2020 206e 5f75 6e69 7473 203d         n_units =
-00017240: 206c 656e 286c 6f67 290d 0a0d 0a20 2020   len(log)....   
-00017250: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00017260: 2069 2069 6e20 7261 6e67 6528 6e5f 756e   i in range(n_un
-00017270: 6974 7329 3a0d 0a0d 0a20 2020 2020 2020  its):....       
-00017280: 2020 2020 2020 2020 2020 2020 2061 6e61               ana
-00017290: 6c79 7369 7320 3d20 5472 7565 0d0a 0d0a  lysis = True....
-000172a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172b0: 2020 2020 6966 2069 203d 3d20 6e5f 756e      if i == n_un
-000172c0: 6974 732d 313a 0d0a 2020 2020 2020 2020  its-1:..        
-000172d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000172e0: 7320 3d20 6c6f 675b 2d31 5d0d 0a20 2020  s = log[-1]..   
-000172f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017300: 2020 2020 2074 6f70 203d 2073 5b31 5d0d       top = s[1].
-00017310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017320: 2020 2020 2020 2020 2062 6f74 203d 2062           bot = b
-00017330: 682e 7a20 2d20 6268 2e64 6570 7468 0d0a  h.z - bh.depth..
-00017340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017350: 2020 2020 2020 656c 7365 3a0d 0a0d 0a20        else:.... 
-00017360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017370: 2020 2020 2020 2073 3220 3d20 6c6f 675b         s2 = log[
-00017380: 692b 315d 0d0a 2020 2020 2020 2020 2020  i+1]..          
-00017390: 2020 2020 2020 2020 2020 2020 2020 7320                s 
-000173a0: 3d20 6c6f 675b 695d 0d0a 0d0a 2020 2020  = log[i]....    
-000173b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173c0: 2020 2020 746f 7020 3d20 735b 315d 0d0a      top = s[1]..
-000173d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173e0: 2020 2020 2020 2020 626f 7420 3d20 7332          bot = s2
-000173f0: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
-00017400: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00017410: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00017420: 6620 626f 7420 3e3d 207a 5f6d 6178 3a20  f bot >= z_max: 
-00017430: 2023 2064 6f20 6e6f 7468 696e 6720 6265   # do nothing be
-00017440: 6361 7573 6520 696e 7465 7276 616c 2061  cause interval a
-00017450: 626f 7665 2069 6e76 6573 7469 6761 7469  bove investigati
-00017460: 6f6e 2061 6c74 6974 7564 6573 0d0a 2020  on altitudes..  
+000166f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00016700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016710: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+00016720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016730: 656c 7365 3a0d 0a0d 0a20 2020 2020 2020  else:....       
+00016740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016750: 2064 6920 3d20 7374 6f72 655f 6469 7374   di = store_dist
+00016760: 7269 2864 6174 615f 6b65 726e 2c20 743d  ri(data_kern, t=
+00016770: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+00016780: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+00016790: 2e73 7572 6661 6365 2e64 6973 7472 6962  .surface.distrib
+000167a0: 7574 696f 6e20 3d20 6469 0d0a 0d0a 2020  ution = di....  
+000167b0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000167c0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000167d0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000167e0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016800: 2020 2070 7269 6e74 2822 4e6f 7420 656e     print("Not en
+00016810: 6f75 6768 2064 6174 6120 706f 696e 7473  ough data points
+00016820: 2074 6f20 6573 7469 6d61 7465 2061 2063   to estimate a c
+00016830: 6466 2061 6e64 2075 7365 204e 6f72 6d61  df and use Norma
+00016840: 6c20 5363 6f72 6520 5472 616e 7366 6f72  l Score Transfor
+00016850: 6d20 666f 7220 756e 6974 207b 7d20 5c6e  m for unit {} \n
+00016860: 222e 666f 726d 6174 2875 6e69 742e 6e61  ".format(unit.na
+00016870: 6d65 2929 0d0a 2020 2020 2020 2020 2020  me))..          
+00016880: 2020 2020 2020 2020 2020 756e 6974 2e73            unit.s
+00016890: 7572 6661 6365 2e4e 5f74 7261 6e73 666f  urface.N_transfo
+000168a0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+000168b0: 2020 2020 2020 2020 2020 2020 2020 756e                un
+000168c0: 6974 2e73 7572 6661 6365 2e64 6963 5f73  it.surface.dic_s
+000168d0: 7572 665b 224e 5f74 7261 6e73 666f 225d  urf["N_transfo"]
+000168e0: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+000168f0: 2020 2020 200d 0a20 2020 2064 6566 2065       ..    def e
+00016900: 7374 696d 6174 655f 7375 7266 5f70 6172  stimate_surf_par
+00016910: 616d 7328 7365 6c66 2c20 6465 6661 756c  ams(self, defaul
+00016920: 745f 636f 766d 6f64 656c 3d4e 6f6e 652c  t_covmodel=None,
+00016930: 2061 7574 6f3d 4661 6c73 652c 202a 2a6b   auto=False, **k
+00016940: 7761 7267 7329 3a0d 0a0d 0a20 2020 2020  wargs):....     
+00016950: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00016960: 416c 6961 7320 666f 7220 696e 6665 7220  Alias for infer 
+00016970: 7375 7266 6163 6520 696e 2041 7263 6850  surface in ArchP
+00016980: 792e 696e 6665 720d 0a0d 0a20 2020 2020  y.infer....     
+00016990: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+000169a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+000169b0: 2d0d 0a20 2020 2020 2020 2064 6566 6175  -..        defau
+000169c0: 6c74 5f63 6f76 6d6f 6465 6c20 3a20 7374  lt_covmodel : st
+000169d0: 722c 2064 6566 6175 6c74 204e 6f6e 650d  r, default None.
+000169e0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+000169f0: 6175 6c74 2063 6f76 6172 6961 6e63 6520  ault covariance 
+00016a00: 6d6f 6465 6c20 746f 2075 7365 2066 6f72  model to use for
+00016a10: 2073 7572 6661 6365 2065 7374 696d 6174   surface estimat
+00016a20: 696f 6e0d 0a20 2020 2020 2020 2061 7574  ion..        aut
+00016a30: 6f20 2020 3a20 626f 6f6c 0d0a 2020 2020  o   : bool..    
+00016a40: 2020 2020 2020 2020 746f 2061 7574 6f6d          to autom
+00016a50: 6174 6963 616c 6c79 2069 6e66 6572 2070  atically infer p
+00016a60: 6172 616d 6574 6572 2028 5472 7565 2920  arameter (True) 
+00016a70: 6f72 206e 6f74 2028 4661 6c73 6529 0d0a  or not (False)..
+00016a80: 2020 2020 2020 2020 6b77 6172 6773 203a          kwargs :
+00016a90: 200d 0a20 2020 2020 2020 2020 2020 2076   ..            v
+00016aa0: 6172 696f 7573 206b 7761 7267 7320 616e  arious kwargs an
+00016ab0: 6420 7061 7261 6d65 7465 7273 2074 6861  d parameters tha
+00016ac0: 7420 6361 6e20 6265 2070 6173 7365 6420  t can be passed 
+00016ad0: 746f 2041 7263 6850 792e 696e 6665 722e  to ArchPy.infer.
+00016ae0: 696e 6665 725f 7375 7266 6163 6520 6f72  infer_surface or
+00016af0: 2041 7263 6850 792e 696e 6665 722e 6669   ArchPy.infer.fi
+00016b00: 745f 7375 7266 6163 6573 0d0a 2020 2020  t_surfaces..    
+00016b10: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00016b20: 2020 2069 6d70 6f72 7420 4172 6368 5079     import ArchPy
+00016b30: 2e69 6e66 6572 2061 7320 6170 690d 0a20  .infer as api.. 
+00016b40: 2020 2020 2020 2023 2064 6566 6175 6c74         # default
+00016b50: 2073 7572 6661 6365 2063 6f76 6d6f 6465   surface covmode
+00016b60: 6c0d 0a20 2020 2020 2020 2069 6620 6175  l..        if au
+00016b70: 746f 3a0d 0a20 2020 2020 2020 2020 2020  to:..           
+00016b80: 2070 7269 6e74 2822 2323 2320 5355 5246   print("### SURF
+00016b90: 4143 4520 5041 5241 4d45 5445 5253 2045  ACE PARAMETERS E
+00016ba0: 5354 494d 4154 494f 4e20 2323 2320 5c6e  STIMATION ### \n
+00016bb0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00016bc0: 666f 7220 7520 696e 2073 656c 662e 6c69  for u in self.li
+00016bd0: 7374 5f61 6c6c 5f75 6e69 7473 3a0d 0a20  st_all_units:.. 
+00016be0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00016bf0: 7269 6e74 2822 2323 2320 554e 4954 203a  rint("### UNIT :
+00016c00: 207b 7d20 2323 2320 5c6e 222e 666f 726d   {} ### \n".form
+00016c10: 6174 2875 2e6e 616d 6529 290d 0a20 2020  at(u.name))..   
+00016c20: 2020 2020 2020 2020 2020 2020 2061 7069               api
+00016c30: 2e69 6e66 6572 5f73 7572 6661 6365 2873  .infer_surface(s
+00016c40: 656c 662c 2075 2c20 6465 6661 756c 745f  elf, u, default_
+00016c50: 636f 766d 6f64 656c 3d64 6566 6175 6c74  covmodel=default
+00016c60: 5f63 6f76 6d6f 6465 6c2c 202a 2a6b 7761  _covmodel, **kwa
+00016c70: 7267 7329 0d0a 2020 2020 2020 2020 656c  rgs)..        el
+00016c80: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00016c90: 2061 7069 2e66 6974 5f73 7572 6661 6365   api.fit_surface
+00016ca0: 7328 7365 6c66 2c20 6465 6661 756c 745f  s(self, default_
+00016cb0: 636f 766d 6f64 656c 3d64 6566 6175 6c74  covmodel=default
+00016cc0: 5f63 6f76 6d6f 6465 6c2c 202a 2a6b 7761  _covmodel, **kwa
+00016cd0: 7267 7329 0d0a 0d0a 0d0a 2020 2020 6465  rgs)......    de
+00016ce0: 6620 6765 745f 7072 6f70 6f72 7469 6f6e  f get_proportion
+00016cf0: 7328 7365 6c66 2c20 7479 7065 3d22 756e  s(self, type="un
+00016d00: 6974 7322 2c20 6465 7074 685f 6d69 6e3d  its", depth_min=
+00016d10: 302c 2064 6570 7468 5f6d 6178 3d6e 702e  0, depth_max=np.
+00016d20: 696e 662c 2069 676e 6f72 655f 756e 6974  inf, ignore_unit
+00016d30: 733d 5b5d 2c20 6d61 736b 3d4e 6f6e 6529  s=[], mask=None)
+00016d40: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+00016d50: 0d0a 2020 2020 2020 2020 4675 6e63 7469  ..        Functi
+00016d60: 6f6e 2074 6861 7420 7265 7475 726e 7320  on that returns 
+00016d70: 7468 6520 7072 6f70 6f72 7469 6f6e 7320  the proportions 
+00016d80: 6f66 2074 6865 2075 6e69 7473 2069 6e20  of the units in 
+00016d90: 7468 6520 626f 7265 686f 6c65 730d 0a0d  the boreholes...
+00016da0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00016db0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00016dc0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00016dd0: 2074 7970 6520 2020 2020 2020 2020 3a20   type         : 
+00016de0: 7374 720d 0a20 2020 2020 2020 2020 2020  str..           
+00016df0: 2074 7970 6520 6f66 2070 726f 706f 7274   type of proport
+00016e00: 696f 6e73 2074 6f20 7265 7475 726e 0d0a  ions to return..
+00016e10: 2020 2020 2020 2020 2020 2020 2275 6e69              "uni
+00016e20: 7473 2220 203a 2070 726f 706f 7274 696f  ts"  : proportio
+00016e30: 6e73 206f 6620 756e 6974 730d 0a20 2020  ns of units..   
+00016e40: 2020 2020 2020 2020 2022 6661 6369 6573           "facies
+00016e50: 2220 3a20 7072 6f70 6f72 7469 6f6e 7320  " : proportions 
+00016e60: 6f66 2066 6163 6965 730d 0a20 2020 2020  of facies..     
+00016e70: 2020 2064 6570 7468 5f6d 6178 2020 2020     depth_max    
+00016e80: 3a20 666c 6f61 742c 2064 6566 6175 6c74  : float, default
+00016e90: 206e 702e 696e 660d 0a20 2020 2020 2020   np.inf..       
+00016ea0: 2020 2020 206d 6178 696d 756d 2064 6570       maximum dep
+00016eb0: 7468 206f 6620 696e 7665 7374 6967 6174  th of investigat
+00016ec0: 696f 6e20 696e 2074 6865 2062 6f72 6568  ion in the boreh
+00016ed0: 6f6c 6573 0d0a 2020 2020 2020 2020 6465  oles..        de
+00016ee0: 7074 685f 6d69 6e20 2020 203a 2066 6c6f  pth_min    : flo
+00016ef0: 6174 2c20 6465 6661 756c 7420 300d 0a20  at, default 0.. 
+00016f00: 2020 2020 2020 2020 2020 206d 696e 696d             minim
+00016f10: 756d 2064 6570 7468 206f 6620 696e 7665  um depth of inve
+00016f20: 7374 6967 6174 696f 6e20 696e 2074 6865  stigation in the
+00016f30: 2062 6f72 6568 6f6c 6573 0d0a 2020 2020   boreholes..    
+00016f40: 2020 2020 6967 6e6f 7265 5f75 6e69 7473      ignore_units
+00016f50: 203a 206c 6973 7420 6f66 2073 7472 2c20   : list of str, 
+00016f60: 6465 6661 756c 7420 5b5d 0d0a 2020 2020  default []..    
+00016f70: 2020 2020 2020 2020 756e 6974 7320 6e61          units na
+00016f80: 6d65 2074 6f20 6967 6e6f 7265 2064 7572  me to ignore dur
+00016f90: 696e 6720 7468 6520 616e 616c 7973 6973  ing the analysis
+00016fa0: 0d0a 2020 2020 2020 2020 6d61 736b 2020  ..        mask  
+00016fb0: 2020 2020 2020 203a 2032 4420 6e64 6172         : 2D ndar
+00016fc0: 7261 7920 6f66 2073 697a 6520 286e 792c  ray of size (ny,
+00016fd0: 206e 7829 2c20 6465 6661 756c 7420 4e6f   nx), default No
+00016fe0: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+00016ff0: 6d61 736b 2077 6865 7265 2074 6f20 616e  mask where to an
+00017000: 616c 7973 6520 7468 6520 626f 7265 686f  alyse the boreho
+00017010: 6c65 730d 0a0d 0a20 2020 2020 2020 2052  les....        R
+00017020: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+00017030: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00017040: 2064 6963 7469 6f6e 6e61 7279 0d0a 2020   dictionnary..  
+00017050: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00017060: 2020 200d 0a20 2020 2020 2020 206c 6973     ..        lis
+00017070: 745f 6268 7320 3d20 7365 6c66 2e6c 6973  t_bhs = self.lis
+00017080: 745f 6268 730d 0a0d 0a20 2020 2020 2020  t_bhs....       
+00017090: 2069 6620 6d61 736b 2069 7320 6e6f 7420   if mask is not 
+000170a0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+000170b0: 2020 206e 6577 5f6c 5f62 6873 203d 205b     new_l_bhs = [
+000170c0: 5d0d 0a20 2020 2020 2020 2020 2020 2066  ]..            f
+000170d0: 6f72 2062 6820 696e 206c 6973 745f 6268  or bh in list_bh
+000170e0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+000170f0: 2020 2020 6979 2c20 6978 203d 2073 656c      iy, ix = sel
+00017100: 662e 636f 6f72 6432 6365 6c6c 2862 682e  f.coord2cell(bh.
+00017110: 782c 2062 682e 7929 0d0a 2020 2020 2020  x, bh.y)..      
+00017120: 2020 2020 2020 2020 2020 6966 206d 6173            if mas
+00017130: 6b5b 6979 2c20 6978 5d3a 0d0a 2020 2020  k[iy, ix]:..    
+00017140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017150: 6e65 775f 6c5f 6268 732e 6170 7065 6e64  new_l_bhs.append
+00017160: 2862 6829 0d0a 2020 2020 2020 2020 2020  (bh)..          
+00017170: 2020 6c69 7374 5f62 6873 203d 206e 6577    list_bhs = new
+00017180: 5f6c 5f62 6873 0d0a 0d0a 0d0a 2020 2020  _l_bhs......    
+00017190: 2020 2020 6d65 7465 7273 5f75 6e69 7473      meters_units
+000171a0: 203d 207b 7d0d 0a0d 0a20 2020 2020 2020   = {}....       
+000171b0: 2066 6f72 2062 6820 696e 206c 6973 745f   for bh in list_
+000171c0: 6268 735b 3a5d 3a0d 0a0d 0a20 2020 2020  bhs[:]:....     
+000171d0: 2020 2020 2020 207a 5f6d 696e 203d 2062         z_min = b
+000171e0: 682e 7a20 2d20 6465 7074 685f 6d61 7820  h.z - depth_max 
+000171f0: 2023 206d 696e 696d 756d 2061 6c74 6974   # minimum altit
+00017200: 7564 6520 6f66 2069 6e76 6573 7469 6761  ude of investiga
+00017210: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
+00017220: 2020 7a5f 6d61 7820 3d20 6268 2e7a 202d    z_max = bh.z -
+00017230: 2064 6570 7468 5f6d 696e 2020 2320 6d61   depth_min  # ma
+00017240: 7869 6d75 6d20 616c 7469 7475 6465 206f  ximum altitude o
+00017250: 6620 696e 7665 7374 6967 6174 696f 6e0d  f investigation.
+00017260: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+00017270: 6620 7479 7065 203d 3d20 2275 6e69 7473  f type == "units
+00017280: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00017290: 2020 2020 6c6f 6720 3d20 6268 2e6c 6f67      log = bh.log
+000172a0: 5f73 7472 6174 690d 0a20 2020 2020 2020  _strati..       
+000172b0: 2020 2020 2065 6c69 6620 7479 7065 203d       elif type =
+000172c0: 3d20 2266 6163 6965 7322 3a0d 0a20 2020  = "facies":..   
+000172d0: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+000172e0: 203d 2062 682e 6c6f 675f 6661 6369 6573   = bh.log_facies
+000172f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00017300: 6966 206c 6f67 2069 7320 6e6f 7420 4e6f  if log is not No
+00017310: 6e65 3a0d 0a0d 0a20 2020 2020 2020 2020  ne:....         
+00017320: 2020 2020 2020 2074 686b 203d 2030 0d0a         thk = 0..
+00017330: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017340: 2020 6e5f 756e 6974 7320 3d20 6c65 6e28    n_units = len(
+00017350: 6c6f 6729 0d0a 0d0a 2020 2020 2020 2020  log)....        
+00017360: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00017370: 2072 616e 6765 286e 5f75 6e69 7473 293a   range(n_units):
+00017380: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00017390: 2020 2020 2020 2020 616e 616c 7973 6973          analysis
+000173a0: 203d 2054 7275 650d 0a0d 0a20 2020 2020   = True....     
+000173b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000173c0: 6620 6920 3d3d 206e 5f75 6e69 7473 2d31  f i == n_units-1
+000173d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000173e0: 2020 2020 2020 2020 2020 2073 203d 206c             s = l
+000173f0: 6f67 5b2d 315d 0d0a 2020 2020 2020 2020  og[-1]..        
+00017400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017410: 746f 7020 3d20 735b 315d 0d0a 2020 2020  top = s[1]..    
+00017420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017430: 2020 2020 626f 7420 3d20 6268 2e7a 202d      bot = bh.z -
+00017440: 2062 682e 6465 7074 680d 0a0d 0a20 2020   bh.depth....   
+00017450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017460: 2065 6c73 653a 0d0a 0d0a 2020 2020 2020   else:....      
 00017470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017480: 2020 2020 2020 616e 616c 7973 6973 203d        analysis =
-00017490: 2046 616c 7365 0d0a 0d0a 2020 2020 2020   False....      
-000174a0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000174b0: 6966 2062 6f74 203c 207a 5f6d 6178 2061  if bot < z_max a
-000174c0: 6e64 2074 6f70 203e 207a 5f6d 6178 2061  nd top > z_max a
-000174d0: 6e64 2062 6f74 203e 3d20 7a5f 6d69 6e3a  nd bot >= z_min:
-000174e0: 2020 2320 6361 7365 2077 6865 7265 2074    # case where t
-000174f0: 6f70 2069 7320 6162 6f76 6520 6465 7074  op is above dept
-00017500: 6820 6d69 6e0d 0a20 2020 2020 2020 2020  h min..         
-00017510: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00017520: 6f70 203d 207a 5f6d 6178 0d0a 2020 2020  op = z_max..    
-00017530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017540: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-00017550: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-00017560: 6f70 203e 207a 5f6d 6178 2061 6e64 2062  op > z_max and b
-00017570: 6f74 203c 207a 5f6d 696e 3a20 2023 2063  ot < z_min:  # c
-00017580: 6173 6520 7768 6572 6520 746f 7020 6162  ase where top ab
-00017590: 6f76 6520 6465 7074 6820 6d69 6e20 616e  ove depth min an
-000175a0: 6420 626f 7420 6265 6c6f 7720 6465 7074  d bot below dept
-000175b0: 6820 6d61 780d 0a20 2020 2020 2020 2020  h max..         
-000175c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000175d0: 6f70 203d 207a 5f6d 6178 0d0a 2020 2020  op = z_max..    
-000175e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000175f0: 2020 2020 626f 7420 3d20 7a5f 6d69 6e0d      bot = z_min.
-00017600: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00017610: 2020 2020 2020 2065 6c69 6620 626f 7420         elif bot 
-00017620: 3c20 7a5f 6d61 7820 616e 6420 746f 7020  < z_max and top 
-00017630: 3c20 7a5f 6d61 7820 616e 6420 626f 7420  < z_max and bot 
-00017640: 3e20 7a5f 6d69 6e20 616e 6420 746f 7020  > z_min and top 
-00017650: 3e20 7a5f 6d69 6e3a 2020 2320 696e 7369  > z_min:  # insi
-00017660: 6465 0d0a 2020 2020 2020 2020 2020 2020  de..            
-00017670: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-00017680: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00017690: 2020 2020 2020 2020 656c 6966 2074 6f70          elif top
-000176a0: 203c 3d20 7a5f 6d61 7820 616e 6420 626f   <= z_max and bo
-000176b0: 7420 3c20 7a5f 6d69 6e20 616e 6420 746f  t < z_min and to
-000176c0: 7020 3e20 7a5f 6d69 6e3a 2020 2320 0d0a  p > z_min:  # ..
-000176d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176e0: 2020 2020 2020 2020 626f 7420 3d20 7a5f          bot = z_
-000176f0: 6d69 6e0d 0a0d 0a20 2020 2020 2020 2020  min....         
-00017700: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00017710: 746f 7020 3c3d 207a 5f6d 696e 3a0d 0a20  top <= z_min:.. 
-00017720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017730: 2020 2020 2020 2061 6e61 6c79 7369 7320         analysis 
-00017740: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
-00017750: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-00017760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017770: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00017780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017790: 2020 7061 7373 0d0a 0d0a 2020 2020 2020    pass....      
-000177a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000177b0: 2061 6e61 6c79 7369 733a 0d0a 2020 2020   analysis:..    
-000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177d0: 2020 2020 6966 2073 5b30 5d20 6973 206e      if s[0] is n
-000177e0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-000177f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017800: 2020 2020 2020 6966 2073 5b30 5d2e 6e61        if s[0].na
-00017810: 6d65 206e 6f74 2069 6e20 6d65 7465 7273  me not in meters
-00017820: 5f75 6e69 7473 2e6b 6579 7328 293a 0d0a  _units.keys():..
+00017480: 2020 7332 203d 206c 6f67 5b69 2b31 5d0d    s2 = log[i+1].
+00017490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000174a0: 2020 2020 2020 2020 2073 203d 206c 6f67           s = log
+000174b0: 5b69 5d0d 0a0d 0a20 2020 2020 2020 2020  [i]....         
+000174c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000174d0: 6f70 203d 2073 5b31 5d0d 0a20 2020 2020  op = s[1]..     
+000174e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174f0: 2020 2062 6f74 203d 2073 325b 315d 0d0a     bot = s2[1]..
+00017500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017510: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+00017520: 2020 2020 2020 2020 2020 6966 2062 6f74            if bot
+00017530: 203e 3d20 7a5f 6d61 783a 2020 2320 646f   >= z_max:  # do
+00017540: 206e 6f74 6869 6e67 2062 6563 6175 7365   nothing because
+00017550: 2069 6e74 6572 7661 6c20 6162 6f76 6520   interval above 
+00017560: 696e 7665 7374 6967 6174 696f 6e20 616c  investigation al
+00017570: 7469 7475 6465 730d 0a20 2020 2020 2020  titudes..       
+00017580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017590: 2061 6e61 6c79 7369 7320 3d20 4661 6c73   analysis = Fals
+000175a0: 650d 0a0d 0a20 2020 2020 2020 2020 2020  e....           
+000175b0: 2020 2020 2020 2020 2065 6c69 6620 626f           elif bo
+000175c0: 7420 3c20 7a5f 6d61 7820 616e 6420 746f  t < z_max and to
+000175d0: 7020 3e20 7a5f 6d61 7820 616e 6420 626f  p > z_max and bo
+000175e0: 7420 3e3d 207a 5f6d 696e 3a20 2023 2063  t >= z_min:  # c
+000175f0: 6173 6520 7768 6572 6520 746f 7020 6973  ase where top is
+00017600: 2061 626f 7665 2064 6570 7468 206d 696e   above depth min
+00017610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017620: 2020 2020 2020 2020 2020 746f 7020 3d20            top = 
+00017630: 7a5f 6d61 780d 0a20 2020 2020 2020 2020  z_max..         
+00017640: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00017650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017660: 2020 2020 2065 6c69 6620 746f 7020 3e20       elif top > 
+00017670: 7a5f 6d61 7820 616e 6420 626f 7420 3c20  z_max and bot < 
+00017680: 7a5f 6d69 6e3a 2020 2320 6361 7365 2077  z_min:  # case w
+00017690: 6865 7265 2074 6f70 2061 626f 7665 2064  here top above d
+000176a0: 6570 7468 206d 696e 2061 6e64 2062 6f74  epth min and bot
+000176b0: 2062 656c 6f77 2064 6570 7468 206d 6178   below depth max
+000176c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000176d0: 2020 2020 2020 2020 2020 746f 7020 3d20            top = 
+000176e0: 7a5f 6d61 780d 0a20 2020 2020 2020 2020  z_max..         
+000176f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00017700: 6f74 203d 207a 5f6d 696e 0d0a 0d0a 2020  ot = z_min....  
+00017710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017720: 2020 656c 6966 2062 6f74 203c 207a 5f6d    elif bot < z_m
+00017730: 6178 2061 6e64 2074 6f70 203c 207a 5f6d  ax and top < z_m
+00017740: 6178 2061 6e64 2062 6f74 203e 207a 5f6d  ax and bot > z_m
+00017750: 696e 2061 6e64 2074 6f70 203e 207a 5f6d  in and top > z_m
+00017760: 696e 3a20 2023 2069 6e73 6964 650d 0a20  in:  # inside.. 
+00017770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017780: 2020 2020 2020 2070 6173 730d 0a0d 0a20         pass.... 
+00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177a0: 2020 2065 6c69 6620 746f 7020 3c3d 207a     elif top <= z
+000177b0: 5f6d 6178 2061 6e64 2062 6f74 203c 207a  _max and bot < z
+000177c0: 5f6d 696e 2061 6e64 2074 6f70 203e 207a  _min and top > z
+000177d0: 5f6d 696e 3a20 2023 200d 0a20 2020 2020  _min:  # ..     
+000177e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177f0: 2020 2062 6f74 203d 207a 5f6d 696e 0d0a     bot = z_min..
+00017800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017810: 2020 2020 2020 656c 6966 2074 6f70 203c        elif top <
+00017820: 3d20 7a5f 6d69 6e3a 0d0a 2020 2020 2020  = z_min:..      
 00017830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017850: 6d65 7465 7273 5f75 6e69 7473 5b73 5b30  meters_units[s[0
-00017860: 5d2e 6e61 6d65 5d20 3d20 300d 0a0d 0a20  ].name] = 0.... 
-00017870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017880: 2020 2020 2020 2020 2020 2074 686b 202b             thk +
-00017890: 3d20 746f 7020 2d20 626f 740d 0a20 2020  = top - bot..   
-000178a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178b0: 2020 2020 2020 2020 206d 6574 6572 735f           meters_
-000178c0: 756e 6974 735b 735b 305d 2e6e 616d 655d  units[s[0].name]
-000178d0: 202b 3d20 746f 7020 2d20 626f 740d 0a0d   += top - bot...
-000178e0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-000178f0: 705f 756e 6974 7320 3d20 7b7d 0d0a 0d0a  p_units = {}....
-00017900: 2020 2020 2020 2020 2020 2020 746f 7420              tot 
-00017910: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
-00017920: 2066 6f72 206b 2c76 2069 6e20 6d65 7465   for k,v in mete
-00017930: 7273 5f75 6e69 7473 2e69 7465 6d73 2829  rs_units.items()
-00017940: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00017950: 2020 2069 6620 6b20 6e6f 7420 696e 2069     if k not in i
-00017960: 676e 6f72 655f 756e 6974 733a 0d0a 2020  gnore_units:..  
-00017970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017980: 2020 746f 7420 2b3d 2076 0d0a 0d0a 2020    tot += v....  
-00017990: 2020 2020 2020 2020 2020 666f 7220 6b2c            for k,
-000179a0: 7620 696e 206d 6574 6572 735f 756e 6974  v in meters_unit
-000179b0: 732e 6974 656d 7328 293a 0d0a 2020 2020  s.items():..    
-000179c0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-000179d0: 206e 6f74 2069 6e20 6967 6e6f 7265 5f75   not in ignore_u
-000179e0: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
-000179f0: 2020 2020 2020 2020 2020 2070 726f 705f             prop_
-00017a00: 756e 6974 735b 6b5d 203d 2076 2f74 6f74  units[k] = v/tot
-00017a10: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-00017a20: 726e 2070 726f 705f 756e 6974 730d 0a0d  rn prop_units...
-00017a30: 0a20 2020 2064 6566 2070 726f 6365 7373  .    def process
-00017a40: 5f62 6873 2873 656c 662c 2073 7465 703d  _bhs(self, step=
-00017a50: 4e6f 6e65 2c20 6661 6369 6573 3d54 7275  None, facies=Tru
-00017a60: 652c 2073 746f 705f 636f 6e64 6974 696f  e, stop_conditio
-00017a70: 6e3d 4661 6c73 652c 2072 6570 726f 6365  n=False, reproce
-00017a80: 7373 3d46 616c 7365 293a 0d0a 0d0a 2020  ss=False):....  
-00017a90: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-00017aa0: 2020 2041 7263 6850 7920 5072 652d 7072     ArchPy Pre-pr
-00017ab0: 6f63 6573 7369 6e67 2061 6c67 6f72 6974  ocessing algorit
-00017ac0: 686d 0d0a 2020 2020 2020 2020 4578 7472  hm..        Extr
-00017ad0: 6163 7420 6861 7264 2064 6174 6120 6672  act hard data fr
-00017ae0: 6f6d 2062 6f72 6568 6f6c 6573 2066 6f72  om boreholes for
-00017af0: 2061 6c6c 2075 6e69 7473 2067 6976 656e   all units given
-00017b00: 0d0a 2020 2020 2020 2020 7468 6520 5069  ..        the Pi
-00017b10: 6c65 7320 6465 6669 6e65 6420 696e 2074  les defined in t
-00017b20: 6865 2041 7263 685f 7461 626c 6520 6f62  he Arch_table ob
-00017b30: 6a65 6374 2e0d 0a0d 0a20 2020 2020 2020  ject.....       
-00017b40: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00017b50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-00017b60: 0a20 2020 2020 2020 2073 7465 7020 3a20  .        step : 
-00017b70: 666c 6f61 740d 0a20 2020 2020 2020 2020  float..         
-00017b80: 2020 2076 6572 7469 6361 6c20 696e 7465     vertical inte
-00017b90: 7276 616c 2066 6f72 2065 7874 7261 6374  rval for extract
-00017ba0: 696e 6720 626f 7265 686f 6c65 0d0a 2020  ing borehole..  
-00017bb0: 2020 2020 2020 6661 6369 6573 3a20 626f        facies: bo
-00017bc0: 6f6c 0d0a 2020 2020 2020 2020 2020 2020  ol..            
-00017bd0: 666c 6167 2074 6f20 696e 6469 6361 7465  flag to indicate
-00017be0: 2074 6f20 7072 6f63 6573 7320 6661 6369   to process faci
-00017bf0: 6573 2064 6174 6120 6f72 206e 6f74 0d0a  es data or not..
-00017c00: 2020 2020 2020 2020 7374 6f70 5f63 6f6e          stop_con
-00017c10: 6469 7469 6f6e 3a20 626f 6f6c 0d0a 2020  dition: bool..  
-00017c20: 2020 2020 2020 2020 2020 666c 6167 2074            flag t
-00017c30: 6f20 696e 6469 6361 7465 2069 6620 7468  o indicate if th
-00017c40: 6520 7072 6f63 6573 7320 6d75 7374 2062  e process must b
-00017c50: 650d 0a20 2020 2020 2020 2020 2020 2061  e..            a
-00017c60: 626f 7274 6564 2069 6620 6120 696e 636f  borted if a inco
-00017c70: 6e73 6973 7465 6e63 7920 696e 2062 6873  nsistency in bhs
-00017c80: 2069 7320 666f 756e 6420 2846 616c 7365   is found (False
-00017c90: 290d 0a20 2020 2020 2020 2020 2020 206f  )..            o
-00017ca0: 7220 6268 7320 7769 6c6c 2062 6520 7369  r bhs will be si
-00017cb0: 6d70 6c79 2069 676e 6f72 6564 2028 5472  mply ignored (Tr
-00017cc0: 7565 290d 0a20 2020 2020 2020 2022 2222  ue)..        """
-00017cd0: 0d0a 0d0a 2020 2020 2020 2020 2320 6675  ....        # fu
-00017ce0: 6e63 7469 6f6e 730d 0a20 2020 2020 2020  nctions..       
-00017cf0: 2064 6566 2063 6865 636b 5f62 6873 5f63   def check_bhs_c
-00017d00: 6f6e 7369 7374 656e 6379 2862 6873 5f6c  onsistency(bhs_l
-00017d10: 7374 2c20 7374 6f70 5f63 6f6e 6469 7469  st, stop_conditi
-00017d20: 6f6e 3d46 616c 7365 293a 0d0a 0d0a 2020  on=False):....  
-00017d30: 2020 2020 2020 2020 2020 2222 220d 0a20            """.. 
-00017d40: 2020 2020 2020 2020 2020 2043 6865 636b             Check
-00017d50: 2074 6861 7420 626f 7265 686f 6c65 7320   that boreholes 
-00017d60: 6172 6520 6e6f 7420 696e 2074 6865 2073  are not in the s
-00017d70: 616d 6520 6365 6c6c 2c0d 0a20 2020 2020  ame cell,..     
-00017d80: 2020 2020 2020 2068 6176 6520 636f 7272         have corr
-00017d90: 6563 7420 756e 6974 732f 6661 6369 6573  ect units/facies
-00017da0: 2069 6e66 6f2c 2065 7463 2e0d 0a20 2020   info, etc...   
-00017db0: 2020 2020 2020 2020 2022 2222 0d0a 0d0a           """....
-00017dc0: 2020 2020 2020 2020 2020 2020 6268 735f              bhs_
-00017dd0: 6c73 745f 636f 703d 6268 735f 6c73 742e  lst_cop=bhs_lst.
-00017de0: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
-00017df0: 2020 2020 7374 6f70 3d30 0d0a 2020 2020      stop=0..    
-00017e00: 2020 2020 2020 2020 6e6f 5f67 6170 203d          no_gap =
-00017e10: 2054 7275 650d 0a20 2020 2020 2020 2020   True..         
-00017e20: 2020 2023 2320 6368 6563 6b20 636f 6e73     ## check cons
-00017e30: 6973 7465 6e63 7920 2323 0d0a 2020 2020  istency ##..    
-00017e40: 2020 2020 2020 2020 666f 7220 6268 2069          for bh i
-00017e50: 6e20 6268 735f 6c73 745f 636f 703a 0d0a  n bhs_lst_cop:..
-00017e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017e70: 735f 6265 663d 300d 0a20 2020 2020 2020  s_bef=0..       
-00017e80: 2020 2020 2020 2020 2069 3d30 0d0a 2020           i=0..  
-00017e90: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00017ea0: 2062 682e 6c6f 675f 7374 7261 7469 2069   bh.log_strati i
-00017eb0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a0d 0a20  s not None:.... 
-00017ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ed0: 2020 2023 2320 6465 7465 726d 696e 6520     ## determine 
-00017ee0: 7069 6c65 206e 6174 7572 650d 0a20 2020  pile nature..   
-00017ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f00: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-00017f10: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00017f20: 6174 7572 6520 3d20 6268 2e6c 6f67 5f73  ature = bh.log_s
-00017f30: 7472 6174 695b 305d 5b30 5d2e 6d75 6d6d  trati[0][0].mumm
-00017f40: 795f 756e 6974 2e53 7562 5069 6c65 2e6e  y_unit.SubPile.n
-00017f50: 6174 7572 650d 0a20 2020 2020 2020 2020  ature..         
-00017f60: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00017f70: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00017f80: 2020 2020 2020 2020 2020 2020 6e61 7475              natu
-00017f90: 7265 203d 2022 7375 7266 6163 6573 220d  re = "surfaces".
-00017fa0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00017fb0: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
-00017fc0: 6268 2e6c 6f67 5f73 7472 6174 693a 0d0a  bh.log_strati:..
-00017fd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017fe0: 2020 2020 2020 2020 2020 6966 2073 5b30            if s[0
-00017ff0: 5d20 6973 206e 6f74 204e 6f6e 6520 6f72  ] is not None or
-00018000: 2073 5b30 5d20 3d3d 2022 636f 6d66 223a   s[0] == "comf":
-00018010: 2020 2320 6966 2074 6865 7265 2069 7320    # if there is 
-00018020: 756e 6974 2069 6e66 6f20 286e 6f74 2061  unit info (not a
-00018030: 2067 6170 290d 0a20 2020 2020 2020 2020   gap)..         
-00018040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018050: 2020 2069 6620 735f 6265 6620 3d3d 2030     if s_bef == 0
-00018060: 2061 6e64 206e 6f5f 6761 703a 0d0a 2020   and no_gap:..  
-00018070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018080: 2020 2020 2020 2020 2020 2020 2020 735f                s_
-00018090: 6265 663d 730d 0a20 2020 2020 2020 2020  bef=s..         
-000180a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180b0: 2020 2020 2020 2069 6620 735b 315d 2021         if s[1] !
-000180c0: 3d20 6268 2e7a 3a0d 0a20 2020 2020 2020  = bh.z:..       
-000180d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000180e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000180f0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
-00018100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018120: 2020 2020 2020 2070 7269 6e74 2822 4669         print("Fi
-00018130: 7273 7420 616c 7469 7475 6465 2069 6e20  rst altitude in 
-00018140: 6c6f 6720 7374 7261 7469 206f 6620 6268  log strati of bh
-00018150: 207b 7d20 6973 206e 6f74 2073 6574 2061   {} is not set a
-00018160: 7420 7468 6520 746f 7020 6f66 2074 6865  t the top of the
-00018170: 2062 6f72 6568 6f6c 652c 2061 6c74 6974   borehole, altit
-00018180: 7564 6520 6368 616e 6765 6422 2e66 6f72  ude changed".for
-00018190: 6d61 7428 6268 2e49 4429 290d 0a20 2020  mat(bh.ID))..   
-000181a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017840: 2020 616e 616c 7973 6973 203d 2046 616c    analysis = Fal
+00017850: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+00017860: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00017870: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00017880: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00017890: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+000178a0: 730d 0a0d 0a20 2020 2020 2020 2020 2020  s....           
+000178b0: 2020 2020 2020 2020 2069 6620 616e 616c           if anal
+000178c0: 7973 6973 3a0d 0a20 2020 2020 2020 2020  ysis:..         
+000178d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000178e0: 6620 735b 305d 2069 7320 6e6f 7420 4e6f  f s[0] is not No
+000178f0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00017900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017910: 2069 6620 735b 305d 2e6e 616d 6520 6e6f   if s[0].name no
+00017920: 7420 696e 206d 6574 6572 735f 756e 6974  t in meters_unit
+00017930: 732e 6b65 7973 2829 3a0d 0a20 2020 2020  s.keys():..     
+00017940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017950: 2020 2020 2020 2020 2020 206d 6574 6572             meter
+00017960: 735f 756e 6974 735b 735b 305d 2e6e 616d  s_units[s[0].nam
+00017970: 655d 203d 2030 0d0a 0d0a 2020 2020 2020  e] = 0....      
+00017980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017990: 2020 2020 2020 7468 6b20 2b3d 2074 6f70        thk += top
+000179a0: 202d 2062 6f74 0d0a 2020 2020 2020 2020   - bot..        
+000179b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179c0: 2020 2020 6d65 7465 7273 5f75 6e69 7473      meters_units
+000179d0: 5b73 5b30 5d2e 6e61 6d65 5d20 2b3d 2074  [s[0].name] += t
+000179e0: 6f70 202d 2062 6f74 0d0a 0d0a 2020 2020  op - bot....    
+000179f0: 2020 2020 2020 2020 7072 6f70 5f75 6e69          prop_uni
+00017a00: 7473 203d 207b 7d0d 0a0d 0a20 2020 2020  ts = {}....     
+00017a10: 2020 2020 2020 2074 6f74 203d 2030 0d0a         tot = 0..
+00017a20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00017a30: 6b2c 7620 696e 206d 6574 6572 735f 756e  k,v in meters_un
+00017a40: 6974 732e 6974 656d 7328 293a 0d0a 2020  its.items():..  
+00017a50: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00017a60: 206b 206e 6f74 2069 6e20 6967 6e6f 7265   k not in ignore
+00017a70: 5f75 6e69 7473 3a0d 0a20 2020 2020 2020  _units:..       
+00017a80: 2020 2020 2020 2020 2020 2020 2074 6f74               tot
+00017a90: 202b 3d20 760d 0a0d 0a20 2020 2020 2020   += v....       
+00017aa0: 2020 2020 2066 6f72 206b 2c76 2069 6e20       for k,v in 
+00017ab0: 6d65 7465 7273 5f75 6e69 7473 2e69 7465  meters_units.ite
+00017ac0: 6d73 2829 3a0d 0a20 2020 2020 2020 2020  ms():..         
+00017ad0: 2020 2020 2020 2069 6620 6b20 6e6f 7420         if k not 
+00017ae0: 696e 2069 676e 6f72 655f 756e 6974 733a  in ignore_units:
+00017af0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017b00: 2020 2020 2020 7072 6f70 5f75 6e69 7473        prop_units
+00017b10: 5b6b 5d20 3d20 762f 746f 740d 0a0d 0a20  [k] = v/tot.... 
+00017b20: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
+00017b30: 6f70 5f75 6e69 7473 0d0a 0d0a 2020 2020  op_units....    
+00017b40: 6465 6620 7072 6f63 6573 735f 6268 7328  def process_bhs(
+00017b50: 7365 6c66 2c20 7374 6570 3d4e 6f6e 652c  self, step=None,
+00017b60: 2066 6163 6965 733d 5472 7565 2c20 7374   facies=True, st
+00017b70: 6f70 5f63 6f6e 6469 7469 6f6e 3d46 616c  op_condition=Fal
+00017b80: 7365 2c20 7265 7072 6f63 6573 733d 4661  se, reprocess=Fa
+00017b90: 6c73 6529 3a0d 0a0d 0a20 2020 2020 2020  lse):....       
+00017ba0: 2022 2222 0d0a 2020 2020 2020 2020 4172   """..        Ar
+00017bb0: 6368 5079 2050 7265 2d70 726f 6365 7373  chPy Pre-process
+00017bc0: 696e 6720 616c 676f 7269 7468 6d0d 0a20  ing algorithm.. 
+00017bd0: 2020 2020 2020 2045 7874 7261 6374 2068         Extract h
+00017be0: 6172 6420 6461 7461 2066 726f 6d20 626f  ard data from bo
+00017bf0: 7265 686f 6c65 7320 666f 7220 616c 6c20  reholes for all 
+00017c00: 756e 6974 7320 6769 7665 6e0d 0a20 2020  units given..   
+00017c10: 2020 2020 2074 6865 2050 696c 6573 2064       the Piles d
+00017c20: 6566 696e 6564 2069 6e20 7468 6520 4172  efined in the Ar
+00017c30: 6368 5f74 6162 6c65 206f 626a 6563 742e  ch_table object.
+00017c40: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00017c50: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00017c60: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00017c70: 2020 2020 7374 6570 203a 2066 6c6f 6174      step : float
+00017c80: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+00017c90: 7274 6963 616c 2069 6e74 6572 7661 6c20  rtical interval 
+00017ca0: 666f 7220 6578 7472 6163 7469 6e67 2062  for extracting b
+00017cb0: 6f72 6568 6f6c 650d 0a20 2020 2020 2020  orehole..       
+00017cc0: 2066 6163 6965 733a 2062 6f6f 6c0d 0a20   facies: bool.. 
+00017cd0: 2020 2020 2020 2020 2020 2066 6c61 6720             flag 
+00017ce0: 746f 2069 6e64 6963 6174 6520 746f 2070  to indicate to p
+00017cf0: 726f 6365 7373 2066 6163 6965 7320 6461  rocess facies da
+00017d00: 7461 206f 7220 6e6f 740d 0a20 2020 2020  ta or not..     
+00017d10: 2020 2073 746f 705f 636f 6e64 6974 696f     stop_conditio
+00017d20: 6e3a 2062 6f6f 6c0d 0a20 2020 2020 2020  n: bool..       
+00017d30: 2020 2020 2066 6c61 6720 746f 2069 6e64       flag to ind
+00017d40: 6963 6174 6520 6966 2074 6865 2070 726f  icate if the pro
+00017d50: 6365 7373 206d 7573 7420 6265 0d0a 2020  cess must be..  
+00017d60: 2020 2020 2020 2020 2020 6162 6f72 7465            aborte
+00017d70: 6420 6966 2061 2069 6e63 6f6e 7369 7374  d if a inconsist
+00017d80: 656e 6379 2069 6e20 6268 7320 6973 2066  ency in bhs is f
+00017d90: 6f75 6e64 2028 4661 6c73 6529 0d0a 2020  ound (False)..  
+00017da0: 2020 2020 2020 2020 2020 6f72 2062 6873            or bhs
+00017db0: 2077 696c 6c20 6265 2073 696d 706c 7920   will be simply 
+00017dc0: 6967 6e6f 7265 6420 2854 7275 6529 0d0a  ignored (True)..
+00017dd0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+00017de0: 2020 2020 2020 2023 2066 756e 6374 696f         # functio
+00017df0: 6e73 0d0a 2020 2020 2020 2020 6465 6620  ns..        def 
+00017e00: 6368 6563 6b5f 6268 735f 636f 6e73 6973  check_bhs_consis
+00017e10: 7465 6e63 7928 6268 735f 6c73 742c 2073  tency(bhs_lst, s
+00017e20: 746f 705f 636f 6e64 6974 696f 6e3d 4661  top_condition=Fa
+00017e30: 6c73 6529 3a0d 0a0d 0a20 2020 2020 2020  lse):....       
+00017e40: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00017e50: 2020 2020 2020 4368 6563 6b20 7468 6174        Check that
+00017e60: 2062 6f72 6568 6f6c 6573 2061 7265 206e   boreholes are n
+00017e70: 6f74 2069 6e20 7468 6520 7361 6d65 2063  ot in the same c
+00017e80: 656c 6c2c 0d0a 2020 2020 2020 2020 2020  ell,..          
+00017e90: 2020 6861 7665 2063 6f72 7265 6374 2075    have correct u
+00017ea0: 6e69 7473 2f66 6163 6965 7320 696e 666f  nits/facies info
+00017eb0: 2c20 6574 632e 0d0a 2020 2020 2020 2020  , etc...        
+00017ec0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00017ed0: 2020 2020 2020 2062 6873 5f6c 7374 5f63         bhs_lst_c
+00017ee0: 6f70 3d62 6873 5f6c 7374 2e63 6f70 7928  op=bhs_lst.copy(
+00017ef0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+00017f00: 746f 703d 300d 0a20 2020 2020 2020 2020  top=0..         
+00017f10: 2020 206e 6f5f 6761 7020 3d20 5472 7565     no_gap = True
+00017f20: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00017f30: 2063 6865 636b 2063 6f6e 7369 7374 656e   check consisten
+00017f40: 6379 2023 230d 0a20 2020 2020 2020 2020  cy ##..         
+00017f50: 2020 2066 6f72 2062 6820 696e 2062 6873     for bh in bhs
+00017f60: 5f6c 7374 5f63 6f70 3a0d 0a20 2020 2020  _lst_cop:..     
+00017f70: 2020 2020 2020 2020 2020 2073 5f62 6566             s_bef
+00017f80: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
+00017f90: 2020 2020 693d 300d 0a20 2020 2020 2020      i=0..       
+00017fa0: 2020 2020 2020 2020 2069 6620 6268 2e6c           if bh.l
+00017fb0: 6f67 5f73 7472 6174 6920 6973 206e 6f74  og_strati is not
+00017fc0: 204e 6f6e 653a 0d0a 0d0a 2020 2020 2020   None:....      
+00017fd0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00017fe0: 2064 6574 6572 6d69 6e65 2070 696c 6520   determine pile 
+00017ff0: 6e61 7475 7265 0d0a 2020 2020 2020 2020  nature..        
+00018000: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00018010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018020: 2020 2020 2020 2020 2020 6e61 7475 7265            nature
+00018030: 203d 2062 682e 6c6f 675f 7374 7261 7469   = bh.log_strati
+00018040: 5b30 5d5b 305d 2e6d 756d 6d79 5f75 6e69  [0][0].mummy_uni
+00018050: 742e 5375 6250 696c 652e 6e61 7475 7265  t.SubPile.nature
+00018060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018070: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+00018080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018090: 2020 2020 2020 206e 6174 7572 6520 3d20         nature = 
+000180a0: 2273 7572 6661 6365 7322 0d0a 0d0a 2020  "surfaces"....  
+000180b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180c0: 2020 666f 7220 7320 696e 2062 682e 6c6f    for s in bh.lo
+000180d0: 675f 7374 7261 7469 3a0d 0a0d 0a20 2020  g_strati:....   
+000180e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180f0: 2020 2020 2069 6620 735b 305d 2069 7320       if s[0] is 
+00018100: 6e6f 7420 4e6f 6e65 206f 7220 735b 305d  not None or s[0]
+00018110: 203d 3d20 2263 6f6d 6622 3a20 2023 2069   == "comf":  # i
+00018120: 6620 7468 6572 6520 6973 2075 6e69 7420  f there is unit 
+00018130: 696e 666f 2028 6e6f 7420 6120 6761 7029  info (not a gap)
+00018140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018150: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018160: 2073 5f62 6566 203d 3d20 3020 616e 6420   s_bef == 0 and 
+00018170: 6e6f 5f67 6170 3a0d 0a20 2020 2020 2020  no_gap:..       
+00018180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018190: 2020 2020 2020 2020 2073 5f62 6566 3d73           s_bef=s
+000181a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000181b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181c0: 2062 682e 6c6f 675f 7374 7261 7469 5b30   bh.log_strati[0
-000181d0: 5d3d 2873 5b30 5d2c 2062 682e 7a29 0d0a  ]=(s[0], bh.z)..
+000181c0: 2020 6966 2073 5b31 5d20 213d 2062 682e    if s[1] != bh.
+000181d0: 7a3a 0d0a 2020 2020 2020 2020 2020 2020  z:..            
 000181e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018200: 2020 2020 735f 6265 663d 730d 0a20 2020      s_bef=s..   
+000181f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00018200: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
 00018210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018220: 2020 2020 2020 2020 2065 6c69 6620 735f           elif s_
-00018230: 6265 6620 213d 2030 3a0d 0a20 2020 2020  bef != 0:..     
-00018240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018250: 2020 2020 2020 2020 2020 2023 2063 6865             # che
-00018260: 636b 2069 6620 756e 6974 2061 7070 6561  ck if unit appea
-00018270: 7220 6f6e 6c79 206f 6e65 2074 696d 650d  r only one time.
-00018280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182a0: 2063 3d30 0d0a 2020 2020 2020 2020 2020   c=0..          
+00018220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018230: 2020 7072 696e 7428 2246 6972 7374 2061    print("First a
+00018240: 6c74 6974 7564 6520 696e 206c 6f67 2073  ltitude in log s
+00018250: 7472 6174 6920 6f66 2062 6820 7b7d 2069  trati of bh {} i
+00018260: 7320 6e6f 7420 7365 7420 6174 2074 6865  s not set at the
+00018270: 2074 6f70 206f 6620 7468 6520 626f 7265   top of the bore
+00018280: 686f 6c65 2c20 616c 7469 7475 6465 2063  hole, altitude c
+00018290: 6861 6e67 6564 222e 666f 726d 6174 2862  hanged".format(b
+000182a0: 682e 4944 2929 0d0a 2020 2020 2020 2020  h.ID))..        
 000182b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000182c0: 2020 2020 2020 666f 7220 7332 2069 6e20        for s2 in 
-000182d0: 6268 2e6c 6f67 5f73 7472 6174 693a 0d0a  bh.log_strati:..
-000182e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000182c0: 2020 2020 2020 2020 2020 2020 6268 2e6c              bh.l
+000182d0: 6f67 5f73 7472 6174 695b 305d 3d28 735b  og_strati[0]=(s[
+000182e0: 305d 2c20 6268 2e7a 290d 0a20 2020 2020  0], bh.z)..     
 000182f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018300: 2020 2020 6966 2073 325b 305d 2069 7320      if s2[0] is 
-00018310: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+00018300: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00018310: 5f62 6566 3d73 0d0a 2020 2020 2020 2020  _bef=s..        
 00018320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018340: 2020 2063 2b3d 2028 7332 5b30 5d20 3d3d     c+= (s2[0] ==
-00018350: 2073 5b30 5d29 0d0a 0d0a 2020 2020 2020   s[0])....      
-00018360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018370: 2020 2020 2020 2020 2020 2363 6865 636b            #check
-00018380: 2063 6f6e 7369 7374 656e 6379 2077 6974   consistency wit
-00018390: 6820 7069 6c65 0d0a 2020 2020 2020 2020  h pile..        
-000183a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000183b0: 2020 2020 2020 2020 6966 2073 5b30 5d2e          if s[0].
-000183c0: 6f72 6465 7220 3c20 735f 6265 665b 305d  order < s_bef[0]
-000183d0: 2e6f 7264 6572 3a0d 0a20 2020 2020 2020  .order:..       
-000183e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000183f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00018400: 6e61 7475 7265 203d 3d20 2273 7572 6661  nature == "surfa
-00018410: 6365 7322 3a0d 0a20 2020 2020 2020 2020  ces":..         
-00018420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018440: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00018450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018470: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00018480: 6e74 2822 626f 7265 686f 6c65 207b 7d20  nt("borehole {} 
-00018490: 6e6f 7420 636f 6e73 6973 7465 6e74 2077  not consistent w
-000184a0: 6974 6820 7468 6520 7069 6c65 222e 666f  ith the pile".fo
-000184b0: 726d 6174 2862 682e 4944 2929 2023 2072  rmat(bh.ID)) # r
-000184c0: 656d 6f76 6520 616e 6420 6e6f 7420 7374  emove and not st
-000184d0: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
-000184e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000184f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00018500: 746f 705f 636f 6e64 6974 696f 6e3a 0d0a  top_condition:..
-00018510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018530: 2020 2020 2020 2020 2020 2020 7374 6f70              stop
-00018540: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
-00018550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018560: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00018570: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00018580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018590: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000185a0: 7265 6d6f 7665 2062 6f72 6568 6f6c 6520  remove borehole 
-000185b0: 6672 6f6d 206c 6973 7473 0d0a 2020 2020  from lists..    
-000185c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000185e0: 2020 2020 2020 2020 7265 6d6f 7665 5f62          remove_b
-000185f0: 6828 6268 2c20 6268 735f 6c73 7429 0d0a  h(bh, bhs_lst)..
-00018600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018620: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00018630: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
-00018640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018650: 2020 2023 6368 6563 6b20 6865 6967 6874     #check height
-00018660: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018680: 2020 656c 6966 2073 5b31 5d20 3e20 735f    elif s[1] > s_
-00018690: 6265 665b 315d 3a0d 0a20 2020 2020 2020  bef[1]:..       
-000186a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000186c0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+00018330: 2020 2020 656c 6966 2073 5f62 6566 2021      elif s_bef !
+00018340: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+00018350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018360: 2020 2020 2020 2320 6368 6563 6b20 6966        # check if
+00018370: 2075 6e69 7420 6170 7065 6172 206f 6e6c   unit appear onl
+00018380: 7920 6f6e 6520 7469 6d65 0d0a 2020 2020  y one time..    
+00018390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183a0: 2020 2020 2020 2020 2020 2020 633d 300d              c=0.
+000183b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000183c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000183d0: 2066 6f72 2073 3220 696e 2062 682e 6c6f   for s2 in bh.lo
+000183e0: 675f 7374 7261 7469 3a0d 0a20 2020 2020  g_strati:..     
+000183f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018400: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018410: 6620 7332 5b30 5d20 6973 206e 6f74 204e  f s2[0] is not N
+00018420: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00018430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018440: 2020 2020 2020 2020 2020 2020 2020 632b                c+
+00018450: 3d20 2873 325b 305d 203d 3d20 735b 305d  = (s2[0] == s[0]
+00018460: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00018470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018480: 2020 2020 2023 6368 6563 6b20 636f 6e73       #check cons
+00018490: 6973 7465 6e63 7920 7769 7468 2070 696c  istency with pil
+000184a0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+000184b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184c0: 2020 2069 6620 735b 305d 2e6f 7264 6572     if s[0].order
+000184d0: 203c 2073 5f62 6566 5b30 5d2e 6f72 6465   < s_bef[0].orde
+000184e0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+000184f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018500: 2020 2020 2020 2020 6966 206e 6174 7572          if natur
+00018510: 6520 3d3d 2022 7375 7266 6163 6573 223a  e == "surfaces":
+00018520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018540: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00018550: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00018560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018580: 2020 2020 2020 2020 7072 696e 7428 2262          print("b
+00018590: 6f72 6568 6f6c 6520 7b7d 206e 6f74 2063  orehole {} not c
+000185a0: 6f6e 7369 7374 656e 7420 7769 7468 2074  onsistent with t
+000185b0: 6865 2070 696c 6522 2e66 6f72 6d61 7428  he pile".format(
+000185c0: 6268 2e49 4429 2920 2320 7265 6d6f 7665  bh.ID)) # remove
+000185d0: 2061 6e64 206e 6f74 2073 746f 700d 0a20   and not stop.. 
+000185e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000185f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018600: 2020 2020 2020 2069 6620 7374 6f70 5f63         if stop_c
+00018610: 6f6e 6469 7469 6f6e 3a0d 0a20 2020 2020  ondition:..     
+00018620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018640: 2020 2020 2020 2073 746f 703d 310d 0a20         stop=1.. 
+00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018670: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00018680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000186a0: 2020 2020 2020 2020 2020 2372 656d 6f76            #remov
+000186b0: 6520 626f 7265 686f 6c65 2066 726f 6d20  e borehole from 
+000186c0: 6c69 7374 730d 0a20 2020 2020 2020 2020  lists..         
 000186d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000186e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000186f0: 2020 2020 2020 2070 7269 6e74 2822 4865         print("He
-00018700: 6967 6874 2069 6e20 6c6f 675f 7374 7261  ight in log_stra
-00018710: 7469 2069 6e20 626f 7265 686f 6c65 207b  ti in borehole {
-00018720: 7d20 6d75 7374 2064 6563 7265 6173 6520  } must decrease 
-00018730: 7769 7468 2064 6570 7468 222e 666f 726d  with depth".form
-00018740: 6174 2862 682e 4944 2929 0d0a 2020 2020  at(bh.ID))..    
-00018750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018770: 6966 2073 746f 705f 636f 6e64 6974 696f  if stop_conditio
-00018780: 6e3a 0d0a 2020 2020 2020 2020 2020 2020  n:..            
-00018790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000187a0: 2020 2020 2020 2020 2020 2020 7374 6f70              stop
-000187b0: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
-000187c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000187d0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000186f0: 2020 2072 656d 6f76 655f 6268 2862 682c     remove_bh(bh,
+00018700: 2062 6873 5f6c 7374 290d 0a20 2020 2020   bhs_lst)..     
+00018710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018730: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
+00018740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018750: 2020 2020 2020 2020 2020 2020 2020 2363                #c
+00018760: 6865 636b 2068 6569 6768 740d 0a20 2020  heck height..   
+00018770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018780: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00018790: 6620 735b 315d 203e 2073 5f62 6566 5b31  f s[1] > s_bef[1
+000187a0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+000187b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000187c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000187d0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
 000187e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000187f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018800: 2020 2020 2020 2023 7265 6d6f 7665 2062         #remove b
-00018810: 6f72 6568 6f6c 6520 6672 6f6d 206c 6973  orehole from lis
-00018820: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-00018830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018840: 2020 2020 2020 2020 2020 2020 7265 6d6f              remo
-00018850: 7665 5f62 6828 6268 2c20 6268 735f 6c73  ve_bh(bh, bhs_ls
-00018860: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-00018870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018880: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00018890: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
+00018800: 2020 7072 696e 7428 2248 6569 6768 7420    print("Height 
+00018810: 696e 206c 6f67 5f73 7472 6174 6920 696e  in log_strati in
+00018820: 2062 6f72 6568 6f6c 6520 7b7d 206d 7573   borehole {} mus
+00018830: 7420 6465 6372 6561 7365 2077 6974 6820  t decrease with 
+00018840: 6465 7074 6822 2e66 6f72 6d61 7428 6268  depth".format(bh
+00018850: 2e49 4429 290d 0a20 2020 2020 2020 2020  .ID))..         
+00018860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018870: 2020 2020 2020 2020 2020 2069 6620 7374             if st
+00018880: 6f70 5f63 6f6e 6469 7469 6f6e 3a0d 0a20  op_condition:.. 
+00018890: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000188a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188b0: 2020 2023 6368 6563 6b20 6966 2075 6e69     #check if uni
-000188c0: 7420 6170 7065 6172 206f 6e6c 7920 6f6e  t appear only on
-000188d0: 6520 7469 6d65 0d0a 2020 2020 2020 2020  e time..        
-000188e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000188f0: 2020 2020 2020 2020 656c 6966 2063 203e          elif c >
-00018900: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00018910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018920: 2020 2020 2020 2020 2069 6620 6e61 7475           if natu
-00018930: 7265 203d 3d20 2273 7572 6661 6365 7322  re == "surfaces"
-00018940: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00018950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018960: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00018970: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+000188b0: 2020 2020 2020 2073 746f 703d 310d 0a20         stop=1.. 
+000188c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000188d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000188e0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000188f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018910: 2020 2372 656d 6f76 6520 626f 7265 686f    #remove boreho
+00018920: 6c65 2066 726f 6d20 6c69 7374 730d 0a20  le from lists.. 
+00018930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018950: 2020 2020 2020 2072 656d 6f76 655f 6268         remove_bh
+00018960: 2862 682c 2062 6873 5f6c 7374 290d 0a20  (bh, bhs_lst).. 
+00018970: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000189a0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-000189b0: 556e 6974 207b 7d20 6170 7065 6172 206d  Unit {} appear m
-000189c0: 6f72 6520 7468 616e 206f 6e65 2074 696d  ore than one tim
-000189d0: 6520 696e 206c 6f67 5f73 7472 6174 6920  e in log_strati 
-000189e0: 6f66 2062 6f72 6568 6f6c 6520 7b7d 222e  of borehole {}".
-000189f0: 666f 726d 6174 2873 5b30 5d2e 6e61 6d65  format(s[0].name
-00018a00: 2c20 6268 2e49 4429 290d 0a20 2020 2020  , bh.ID))..     
+00018990: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
+000189a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000189b0: 2020 2020 2020 2020 2020 2020 2020 2363                #c
+000189c0: 6865 636b 2069 6620 756e 6974 2061 7070  heck if unit app
+000189d0: 6561 7220 6f6e 6c79 206f 6e65 2074 696d  ear only one tim
+000189e0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+000189f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a00: 2020 2065 6c69 6620 6320 3e20 313a 0d0a     elif c > 1:..
 00018a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a30: 2020 2069 6620 7374 6f70 5f63 6f6e 6469     if stop_condi
-00018a40: 7469 6f6e 3a0d 0a20 2020 2020 2020 2020  tion:..         
+00018a30: 2020 2020 6966 206e 6174 7572 6520 3d3d      if nature ==
+00018a40: 2022 7375 7266 6163 6573 223a 0d0a 2020   "surfaces":..  
 00018a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00018a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018a70: 2020 2073 746f 703d 310d 0a20 2020 2020     stop=1..     
-00018a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a70: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00018a80: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
 00018a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018aa0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00018ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ad0: 2020 2020 2020 2372 656d 6f76 6520 626f        #remove bo
-00018ae0: 7265 686f 6c65 2066 726f 6d20 6c69 7374  rehole from list
-00018af0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00018b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b10: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00018b20: 656d 6f76 655f 6268 2862 682c 2062 6873  emove_bh(bh, bhs
-00018b30: 5f6c 7374 290d 0a20 2020 2020 2020 2020  _lst)..         
-00018b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b60: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
-00018b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b80: 2020 2020 2020 735f 6265 663d 730d 0a20        s_bef=s.. 
+00018aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ab0: 2020 2020 7072 696e 7428 2255 6e69 7420      print("Unit 
+00018ac0: 7b7d 2061 7070 6561 7220 6d6f 7265 2074  {} appear more t
+00018ad0: 6861 6e20 6f6e 6520 7469 6d65 2069 6e20  han one time in 
+00018ae0: 6c6f 675f 7374 7261 7469 206f 6620 626f  log_strati of bo
+00018af0: 7265 686f 6c65 207b 7d22 2e66 6f72 6d61  rehole {}".forma
+00018b00: 7428 735b 305d 2e6e 616d 652c 2062 682e  t(s[0].name, bh.
+00018b10: 4944 2929 0d0a 2020 2020 2020 2020 2020  ID))..          
+00018b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018b40: 2073 746f 705f 636f 6e64 6974 696f 6e3a   stop_condition:
+00018b50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018b70: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00018b80: 6f70 3d31 0d0a 2020 2020 2020 2020 2020  op=1..          
 00018b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ba0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00018bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bc0: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
-00018bd0: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-00018be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bf0: 2020 2020 2020 6e6f 5f67 6170 3d46 616c        no_gap=Fal
-00018c00: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
-00018c10: 2020 2020 2020 2020 2020 2020 6920 2b3d              i +=
-00018c20: 2031 0d0a 0d0a 2020 2020 2020 2020 2020   1....          
-00018c30: 2020 2020 2020 6966 2062 682e 6c6f 675f        if bh.log_
-00018c40: 6661 6369 6573 2069 7320 6e6f 7420 4e6f  facies is not No
-00018c50: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00018c60: 2020 2020 2020 2020 2069 3d30 0d0a 2020           i=0..  
-00018c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c80: 2020 666f 7220 6661 2069 6e20 6268 2e6c    for fa in bh.l
-00018c90: 6f67 5f66 6163 6965 733a 0d0a 2020 2020  og_facies:..    
+00018ba0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00018bb0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00018bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018be0: 2023 7265 6d6f 7665 2062 6f72 6568 6f6c   #remove borehol
+00018bf0: 6520 6672 6f6d 206c 6973 7473 0d0a 2020  e from lists..  
+00018c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c20: 2020 2020 2020 2020 2020 7265 6d6f 7665            remove
+00018c30: 5f62 6828 6268 2c20 6268 735f 6c73 7429  _bh(bh, bhs_lst)
+00018c40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c60: 2020 2020 2020 2020 2020 2020 2020 6272                br
+00018c70: 6561 6b0d 0a20 2020 2020 2020 2020 2020  eak..           
+00018c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018c90: 2073 5f62 6566 3d73 0d0a 2020 2020 2020   s_bef=s..      
 00018ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018cb0: 2020 2020 6966 2069 203d 3d20 303a 0d0a      if i == 0:..
+00018cb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
 00018cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018cd0: 2020 2020 2020 2020 2020 2020 6661 5f62              fa_b
-00018ce0: 6566 3d66 610d 0a20 2020 2020 2020 2020  ef=fa..         
+00018cd0: 2020 2020 2069 6620 6920 3d3d 2030 3a0d       if i == 0:.
+00018ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00018cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d00: 2020 2069 6620 6661 5b31 5d20 213d 2062     if fa[1] != b
-00018d10: 682e 7a3a 0d0a 2020 2020 2020 2020 2020  h.z:..          
-00018d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d30: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00018d40: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00018d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00018d70: 7428 2246 6972 7374 2061 6c74 6974 7564  t("First altitud
-00018d80: 6520 696e 206c 6f67 2066 6163 6965 7320  e in log facies 
-00018d90: 6f66 2062 6820 7b7d 2069 7320 6e6f 7420  of bh {} is not 
-00018da0: 7365 7420 6174 2074 6865 2074 6f70 206f  set at the top o
-00018db0: 6620 7468 6520 626f 7265 686f 6c65 2c20  f the borehole, 
-00018dc0: 616c 7469 7475 6465 2063 6861 6e67 6564  altitude changed
-00018dd0: 222e 666f 726d 6174 2862 682e 4944 2929  ".format(bh.ID))
-00018de0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e00: 2020 6268 2e6c 6f67 5f66 6163 6965 735b    bh.log_facies[
-00018e10: 305d 3d28 6661 5b30 5d2c 2062 682e 7a29  0]=(fa[0], bh.z)
-00018e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018d00: 206e 6f5f 6761 703d 4661 6c73 650d 0a20   no_gap=False.. 
+00018d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d20: 2020 2020 2020 2069 202b 3d20 310d 0a0d         i += 1...
+00018d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018d40: 2069 6620 6268 2e6c 6f67 5f66 6163 6965   if bh.log_facie
+00018d50: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
+00018d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d70: 2020 2020 693d 300d 0a20 2020 2020 2020      i=0..       
+00018d80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00018d90: 2066 6120 696e 2062 682e 6c6f 675f 6661   fa in bh.log_fa
+00018da0: 6369 6573 3a0d 0a20 2020 2020 2020 2020  cies:..         
+00018db0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00018dc0: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
+00018dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018de0: 2020 2020 2020 2066 615f 6265 663d 6661         fa_bef=fa
+00018df0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018e00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00018e10: 2066 615b 315d 2021 3d20 6268 2e7a 3a0d   fa[1] != bh.z:.
+00018e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00018e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e40: 2020 6661 5f62 6566 3d66 610d 0a20 2020    fa_bef=fa..   
-00018e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e60: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00018e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e80: 2020 2020 2020 2020 6966 2066 615b 315d          if fa[1]
-00018e90: 203e 2066 615f 6265 665b 315d 3a0d 0a20   > fa_bef[1]:.. 
-00018ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018eb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018ec0: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00018ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ef0: 2020 2020 2070 7269 6e74 2822 4865 6967       print("Heig
-00018f00: 6874 2069 6e20 6c6f 675f 6661 6369 6573  ht in log_facies
-00018f10: 2069 6e20 626f 7265 686f 6c65 207b 7d20   in borehole {} 
-00018f20: 6d75 7374 2064 6563 7265 6173 6520 7769  must decrease wi
-00018f30: 7468 2064 6570 7468 222e 666f 726d 6174  th depth".format
-00018f40: 2862 682e 4944 2929 0d0a 2020 2020 2020  (bh.ID))..      
-00018f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f60: 2020 2020 2020 2020 2020 6966 2073 746f            if sto
-00018f70: 705f 636f 6e64 6974 696f 6e3a 0d0a 2020  p_condition:..  
+00018e40: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00018e50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00018e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e70: 2020 2020 2020 2070 7269 6e74 2822 4669         print("Fi
+00018e80: 7273 7420 616c 7469 7475 6465 2069 6e20  rst altitude in 
+00018e90: 6c6f 6720 6661 6369 6573 206f 6620 6268  log facies of bh
+00018ea0: 207b 7d20 6973 206e 6f74 2073 6574 2061   {} is not set a
+00018eb0: 7420 7468 6520 746f 7020 6f66 2074 6865  t the top of the
+00018ec0: 2062 6f72 6568 6f6c 652c 2061 6c74 6974   borehole, altit
+00018ed0: 7564 6520 6368 616e 6765 6422 2e66 6f72  ude changed".for
+00018ee0: 6d61 7428 6268 2e49 4429 290d 0a20 2020  mat(bh.ID))..   
+00018ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f00: 2020 2020 2020 2020 2020 2020 2062 682e               bh.
+00018f10: 6c6f 675f 6661 6369 6573 5b30 5d3d 2866  log_facies[0]=(f
+00018f20: 615b 305d 2c20 6268 2e7a 290d 0a20 2020  a[0], bh.z)..   
+00018f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f40: 2020 2020 2020 2020 2020 2020 2066 615f               fa_
+00018f50: 6265 663d 6661 0d0a 2020 2020 2020 2020  bef=fa..        
+00018f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
 00018f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fa0: 2020 7374 6f70 3d31 0d0a 2020 2020 2020    stop=1..      
+00018f90: 2020 2069 6620 6661 5b31 5d20 3e20 6661     if fa[1] > fa
+00018fa0: 5f62 6566 5b31 5d3a 0d0a 2020 2020 2020  _bef[1]:..      
 00018fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fc0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00018fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fc0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00018fd0: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
 00018fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ff0: 2020 2020 2023 7265 6d6f 7665 2062 6f72       #remove bor
-00019000: 6568 6f6c 6520 6672 6f6d 206c 6973 7473  ehole from lists
-00019010: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019030: 2020 2020 2020 7265 6d6f 7665 5f62 6828        remove_bh(
-00019040: 6268 2c20 6268 735f 6c73 7429 0d0a 2020  bh, bhs_lst)..  
-00019050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019060: 2020 2020 2020 6661 5f62 6566 3d66 610d        fa_bef=fa.
-00019070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019080: 2020 2020 2020 2020 2069 202b 3d20 310d           i += 1.
-00019090: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-000190a0: 6620 7374 6f70 3a0d 0a20 2020 2020 2020  f stop:..       
-000190b0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000190c0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-000190d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000190e0: 7269 6e74 2822 5072 6f63 6573 7320 6268  rint("Process bh
-000190f0: 7320 6162 6f72 7465 6422 290d 0a20 2020  s aborted")..   
-00019100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019110: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
-00019120: 2020 2020 2020 2020 6465 6620 7265 6d6f          def remo
-00019130: 7665 5f62 6828 6268 2c20 6268 735f 6c73  ve_bh(bh, bhs_ls
-00019140: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-00019150: 2023 6966 2062 6820 696e 2073 656c 662e   #if bh in self.
-00019160: 6c69 7374 5f62 6873 3a0d 0a20 2020 2020  list_bhs:..     
-00019170: 2020 2020 2020 2023 2020 2020 7365 6c66         #    self
-00019180: 2e72 656d 5f62 6828 6268 290d 0a20 2020  .rem_bh(bh)..   
-00019190: 2020 2020 2020 2020 2023 656c 6966 2062           #elif b
-000191a0: 6820 696e 2073 656c 662e 6c69 7374 5f66  h in self.list_f
-000191b0: 616b 655f 6268 733a 0d0a 2020 2020 2020  ake_bhs:..      
-000191c0: 2020 2020 2020 2320 2020 2073 656c 662e        #    self.
-000191d0: 7265 6d5f 6661 6b65 5f62 6828 6268 290d  rem_fake_bh(bh).
-000191e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000191f0: 6268 2069 6e20 6268 735f 6c73 743a 0d0a  bh in bhs_lst:..
-00019200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019210: 6268 735f 6c73 742e 7265 6d6f 7665 2862  bhs_lst.remove(b
-00019220: 6829 2023 2072 656d 6f76 6520 626f 7265  h) # remove bore
-00019230: 686f 6c65 2066 726f 6d20 6375 7272 656e  hole from curren
-00019240: 7420 6c69 7374 0d0a 0d0a 2020 2020 2020  t list....      
-00019250: 2020 6966 2072 6570 726f 6365 7373 3a0d    if reprocess:.
-00019260: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00019270: 662e 6268 735f 7072 6f63 6573 7365 643d  f.bhs_processed=
-00019280: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-00019290: 656c 662e 6572 6173 655f 6864 2829 0d0a  elf.erase_hd()..
-000192a0: 0d0a 2020 2020 2020 2020 236d 6572 6765  ..        #merge
-000192b0: 206c 6973 7473 0d0a 2020 2020 2020 2020   lists..        
-000192c0: 6268 735f 6c73 743d 7365 6c66 2e6c 6973  bhs_lst=self.lis
-000192d0: 745f 6268 7320 2b20 7365 6c66 2e6c 6973  t_bhs + self.lis
-000192e0: 745f 6661 6b65 5f62 6873 202b 2073 656c  t_fake_bhs + sel
-000192f0: 662e 6c69 7374 5f6d 6170 5f62 6873 0d0a  f.list_map_bhs..
-00019300: 0d0a 2020 2020 2020 2020 2367 6574 2067  ..        #get g
-00019310: 7269 640d 0a20 2020 2020 2020 2078 673d  rid..        xg=
-00019320: 7365 6c66 2e67 6574 5f78 6728 290d 0a20  self.get_xg().. 
-00019330: 2020 2020 2020 2079 673d 7365 6c66 2e67         yg=self.g
-00019340: 6574 5f79 6728 290d 0a20 2020 2020 2020  et_yg()..       
-00019350: 207a 673d 7365 6c66 2e67 6574 5f7a 6728   zg=self.get_zg(
-00019360: 290d 0a0d 0a20 2020 2020 2020 2023 6f72  )....        #or
-00019370: 6465 7220 756e 6974 730d 0a20 2020 2020  der units..     
-00019380: 2020 2073 656c 662e 6f72 6465 725f 5069     self.order_Pi
-00019390: 6c65 7328 290d 0a0d 0a20 2020 2020 2020  les()....       
-000193a0: 2023 7365 7420 6869 6572 6172 6368 795f   #set hierarchy_
-000193b0: 7265 6c61 7469 6f6e 730d 0a20 2020 2020  relations..     
-000193c0: 2020 2073 656c 662e 6869 6572 6172 6368     self.hierarch
-000193d0: 795f 7265 6c61 7469 6f6e 7328 7662 3d73  y_relations(vb=s
-000193e0: 656c 662e 7665 7262 6f73 6529 0d0a 0d0a  elf.verbose)....
-000193f0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
-00019400: 656c 662e 6c69 7374 5f62 6873 202b 2073  elf.list_bhs + s
-00019410: 656c 662e 6c69 7374 5f66 616b 655f 6268  elf.list_fake_bh
-00019420: 7320 2b20 7365 6c66 2e6c 6973 745f 6d61  s + self.list_ma
-00019430: 705f 6268 7329 203d 3d20 303a 0d0a 2020  p_bhs) == 0:..  
-00019440: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00019450: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-00019460: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00019470: 7428 224e 6f20 626f 7265 686f 6c65 2066  t("No borehole f
-00019480: 6f75 6e64 202d 206e 6f20 6864 2065 7874  ound - no hd ext
-00019490: 7261 6374 6564 2229 0d0a 2020 2020 2020  racted")..      
-000194a0: 2020 2020 2020 2373 656c 662e 6268 735f        #self.bhs_
-000194b0: 7072 6f63 6573 7365 643d 310d 0a20 2020  processed=1..   
-000194c0: 2020 2020 2020 2020 2072 6574 7572 6e0d           return.
-000194d0: 0a0d 0a20 2020 2020 2020 2023 2323 2065  ...        ### e
-000194e0: 7874 7261 6374 2073 7472 6174 6920 756e  xtract strati un
-000194f0: 6974 7320 616e 6420 6661 6369 6573 2069  its and facies i
-00019500: 6e66 6f20 6672 6f6d 2062 6f72 6568 6f6c  nfo from borehol
-00019510: 6520 6461 7461 0d0a 2020 2020 2020 2020  e data..        
-00019520: 6966 2073 656c 662e 6268 735f 7072 6f63  if self.bhs_proc
-00019530: 6573 7365 6420 3d3d 2030 3a0d 0a0d 0a20  essed == 0:.... 
-00019540: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00019550: 7374 6f5f 6864 203d 205b 5d0d 0a20 2020  sto_hd = []..   
-00019560: 2020 2020 2020 2020 2023 2323 2063 6865           ### che
-00019570: 636b 206d 756c 7469 706c 6520 626f 7265  ck multiple bore
-00019580: 686f 6c65 7320 696e 2074 6865 2073 616d  holes in the sam
-00019590: 6520 6365 6c6c 2023 2323 0d0a 2020 2020  e cell ###..    
-000195a0: 2020 2020 2020 2020 743d 4b44 5472 6565          t=KDTree
-000195b0: 2873 656c 662e 7875 3244 290d 0a0d 0a20  (self.xu2D).... 
-000195c0: 2020 2020 2020 2020 2020 2078 6268 3d5b             xbh=[
-000195d0: 692e 7820 666f 7220 6920 696e 2062 6873  i.x for i in bhs
-000195e0: 5f6c 7374 5d0d 0a20 2020 2020 2020 2020  _lst]..         
-000195f0: 2020 2079 6268 3d5b 692e 7920 666f 7220     ybh=[i.y for 
-00019600: 6920 696e 2062 6873 5f6c 7374 5d0d 0a20  i in bhs_lst].. 
-00019610: 2020 2020 2020 2020 2020 2063 5f62 683d             c_bh=
-00019620: 6e70 2e61 7272 6179 285b 7862 682c 2079  np.array([xbh, y
-00019630: 6268 5d29 2e54 2020 2320 626f 7265 686f  bh]).T  # boreho
-00019640: 6c65 7320 636f 6f72 6469 6e61 7465 730d  les coordinates.
-00019650: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-00019660: 6478 3d74 2e71 7565 7279 2863 5f62 682c  dx=t.query(c_bh,
-00019670: 2072 6574 7572 6e5f 6469 7374 616e 6365   return_distance
-00019680: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-00019690: 2020 2020 2062 685f 6172 723d 6e70 2e61       bh_arr=np.a
-000196a0: 7272 6179 2862 6873 5f6c 7374 2920 2320  rray(bhs_lst) # 
-000196b0: 6172 7261 7920 6f66 2062 6f72 6568 6f6c  array of borehol
-000196c0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-000196d0: 6964 785f 7265 6d6f 7665 643d 5b5d 0d0a  idx_removed=[]..
-000196e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000196f0: 6964 7831 2069 6e20 6964 783a 0d0a 2020  idx1 in idx:..  
-00019700: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00019710: 2069 6478 3120 6e6f 7420 696e 2069 6478   idx1 not in idx
-00019720: 5f72 656d 6f76 6564 3a0d 0a20 2020 2020  _removed:..     
-00019730: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00019740: 6173 6b3d 2869 6478 3120 3d3d 2069 6478  ask=(idx1 == idx
-00019750: 292e 7265 7368 6170 6528 2d31 290d 0a20  ).reshape(-1).. 
-00019760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019770: 2020 2062 6873 5f63 656c 6c3d 6268 5f61     bhs_cell=bh_a
-00019780: 7272 5b6d 6173 6b5d 2023 626f 7265 686f  rr[mask] #boreho
-00019790: 6c65 7320 696e 2074 6865 2073 616d 6520  les in the same 
-000197a0: 6365 6c6c 0d0a 0d0a 2020 2020 2020 2020  cell....        
-000197b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-000197c0: 656e 2862 6873 5f63 656c 6c29 203e 2031  en(bhs_cell) > 1
-000197d0: 3a20 2320 6d6f 7265 2074 6861 6e20 6f6e  : # more than on
-000197e0: 6520 626f 7265 686f 6c65 2069 6e20 6f6e  e borehole in on
-000197f0: 6520 6365 6c6c 0d0a 2020 2020 2020 2020  e cell..        
-00019800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019810: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-00019820: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019830: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00019840: 696e 7428 224d 756c 7469 706c 6573 2062  int("Multiples b
-00019850: 6f72 6568 6f6c 6573 207b 7d20 7765 7265  oreholes {} were
-00019860: 2066 6f75 6e64 2069 6e73 6964 6520 7468   found inside th
-00019870: 6520 7361 6d65 2063 656c 6c2c 2074 6865  e same cell, the
-00019880: 2064 6565 7065 7374 2077 696c 6c20 6265   deepest will be
-00019890: 206b 6570 7422 2e66 6f72 6d61 7428 5b69   kept".format([i
-000198a0: 2e49 4420 666f 7220 6920 696e 2062 6873  .ID for i in bhs
-000198b0: 5f63 656c 6c5d 2929 0d0a 2020 2020 2020  _cell]))..      
-000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198d0: 2020 6465 7074 6873 3d28 6e70 2e61 7272    depths=(np.arr
-000198e0: 6179 285b 692e 6465 7074 6820 666f 7220  ay([i.depth for 
-000198f0: 6920 696e 2062 6873 5f63 656c 6c5d 2929  i in bhs_cell]))
-00019900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019910: 2020 2020 2020 2020 2020 6d61 736b 323d            mask2=
-00019920: 2864 6570 7468 7320 3d3d 206d 6178 2864  (depths == max(d
-00019930: 6570 7468 7329 290d 0a20 2020 2020 2020  epths))..       
-00019940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019950: 2069 6620 7375 6d28 6d61 736b 3229 203d   if sum(mask2) =
-00019960: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
-00019970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019980: 2020 666f 7220 2862 682c 2063 686b 2920    for (bh, chk) 
-00019990: 696e 207a 6970 2862 6873 5f63 656c 6c2c  in zip(bhs_cell,
-000199a0: 206d 6173 6b32 293a 0d0a 2020 2020 2020   mask2):..      
-000199b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000199c0: 2020 2020 2020 2020 2020 6966 207e 6368            if ~ch
-000199d0: 6b3a 0d0a 2020 2020 2020 2020 2020 2020  k:..            
-000199e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000199f0: 2020 2020 2020 2020 2372 656d 6f76 6520          #remove 
-00019a00: 626f 7265 686f 6c65 2066 726f 6d20 6c69  borehole from li
-00019a10: 7374 730d 0a20 2020 2020 2020 2020 2020  sts..           
-00019a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a30: 2020 2020 2020 2020 2072 656d 6f76 655f           remove_
-00019a40: 6268 2862 682c 2062 6873 5f6c 7374 290d  bh(bh, bhs_lst).
-00019a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019a70: 2020 2020 2069 6478 5f72 656d 6f76 6564       idx_removed
-00019a80: 2e61 7070 656e 6428 6964 7831 290d 0a20  .append(idx1).. 
-00019a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019aa0: 2020 2020 2020 2065 6c69 6620 7375 6d28         elif sum(
-00019ab0: 6d61 736b 3229 203e 2031 3a20 2362 6873  mask2) > 1: #bhs
-00019ac0: 2068 6176 6520 7468 6520 7361 6d65 2064   have the same d
-00019ad0: 6570 7468 7320 2d2d 3e20 7265 6d6f 7665  epths --> remove
-00019ae0: 206f 7468 6572 730d 0a20 2020 2020 2020   others..       
+00018ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019000: 7072 696e 7428 2248 6569 6768 7420 696e  print("Height in
+00019010: 206c 6f67 5f66 6163 6965 7320 696e 2062   log_facies in b
+00019020: 6f72 6568 6f6c 6520 7b7d 206d 7573 7420  orehole {} must 
+00019030: 6465 6372 6561 7365 2077 6974 6820 6465  decrease with de
+00019040: 7074 6822 2e66 6f72 6d61 7428 6268 2e49  pth".format(bh.I
+00019050: 4429 290d 0a20 2020 2020 2020 2020 2020  D))..           
+00019060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019070: 2020 2020 2069 6620 7374 6f70 5f63 6f6e       if stop_con
+00019080: 6469 7469 6f6e 3a0d 0a20 2020 2020 2020  dition:..       
+00019090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000190a0: 2020 2020 2020 2020 2020 2020 2073 746f               sto
+000190b0: 703d 310d 0a20 2020 2020 2020 2020 2020  p=1..           
+000190c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000190d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000190e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000190f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019100: 2372 656d 6f76 6520 626f 7265 686f 6c65  #remove borehole
+00019110: 2066 726f 6d20 6c69 7374 730d 0a20 2020   from lists..   
+00019120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019140: 2072 656d 6f76 655f 6268 2862 682c 2062   remove_bh(bh, b
+00019150: 6873 5f6c 7374 290d 0a20 2020 2020 2020  hs_lst)..       
+00019160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019170: 2066 615f 6265 663d 6661 0d0a 2020 2020   fa_bef=fa..    
+00019180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019190: 2020 2020 6920 2b3d 2031 0d0a 0d0a 2020      i += 1....  
+000191a0: 2020 2020 2020 2020 2020 6966 2073 746f            if sto
+000191b0: 703a 0d0a 2020 2020 2020 2020 2020 2020  p:..            
+000191c0: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+000191d0: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+000191e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000191f0: 2250 726f 6365 7373 2062 6873 2061 626f  "Process bhs abo
+00019200: 7274 6564 2229 0d0a 2020 2020 2020 2020  rted")..        
+00019210: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00019220: 726e 204e 6f6e 650d 0a0d 0a20 2020 2020  rn None....     
+00019230: 2020 2064 6566 2072 656d 6f76 655f 6268     def remove_bh
+00019240: 2862 682c 2062 6873 5f6c 7374 293a 0d0a  (bh, bhs_lst):..
+00019250: 2020 2020 2020 2020 2020 2020 2369 6620              #if 
+00019260: 6268 2069 6e20 7365 6c66 2e6c 6973 745f  bh in self.list_
+00019270: 6268 733a 0d0a 2020 2020 2020 2020 2020  bhs:..          
+00019280: 2020 2320 2020 2073 656c 662e 7265 6d5f    #    self.rem_
+00019290: 6268 2862 6829 0d0a 2020 2020 2020 2020  bh(bh)..        
+000192a0: 2020 2020 2365 6c69 6620 6268 2069 6e20      #elif bh in 
+000192b0: 7365 6c66 2e6c 6973 745f 6661 6b65 5f62  self.list_fake_b
+000192c0: 6873 3a0d 0a20 2020 2020 2020 2020 2020  hs:..           
+000192d0: 2023 2020 2020 7365 6c66 2e72 656d 5f66   #    self.rem_f
+000192e0: 616b 655f 6268 2862 6829 0d0a 2020 2020  ake_bh(bh)..    
+000192f0: 2020 2020 2020 2020 6966 2062 6820 696e          if bh in
+00019300: 2062 6873 5f6c 7374 3a0d 0a20 2020 2020   bhs_lst:..     
+00019310: 2020 2020 2020 2020 2020 2062 6873 5f6c             bhs_l
+00019320: 7374 2e72 656d 6f76 6528 6268 2920 2320  st.remove(bh) # 
+00019330: 7265 6d6f 7665 2062 6f72 6568 6f6c 6520  remove borehole 
+00019340: 6672 6f6d 2063 7572 7265 6e74 206c 6973  from current lis
+00019350: 740d 0a0d 0a20 2020 2020 2020 2069 6620  t....        if 
+00019360: 7265 7072 6f63 6573 733a 0d0a 2020 2020  reprocess:..    
+00019370: 2020 2020 2020 2020 7365 6c66 2e62 6873          self.bhs
+00019380: 5f70 726f 6365 7373 6564 3d30 0d0a 2020  _processed=0..  
+00019390: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+000193a0: 7261 7365 5f68 6428 290d 0a0d 0a20 2020  rase_hd()....   
+000193b0: 2020 2020 2023 6d65 7267 6520 6c69 7374       #merge list
+000193c0: 730d 0a20 2020 2020 2020 2062 6873 5f6c  s..        bhs_l
+000193d0: 7374 3d73 656c 662e 6c69 7374 5f62 6873  st=self.list_bhs
+000193e0: 202b 2073 656c 662e 6c69 7374 5f66 616b   + self.list_fak
+000193f0: 655f 6268 7320 2b20 7365 6c66 2e6c 6973  e_bhs + self.lis
+00019400: 745f 6d61 705f 6268 730d 0a0d 0a20 2020  t_map_bhs....   
+00019410: 2020 2020 2023 6765 7420 6772 6964 0d0a       #get grid..
+00019420: 2020 2020 2020 2020 7867 3d73 656c 662e          xg=self.
+00019430: 6765 745f 7867 2829 0d0a 2020 2020 2020  get_xg()..      
+00019440: 2020 7967 3d73 656c 662e 6765 745f 7967    yg=self.get_yg
+00019450: 2829 0d0a 2020 2020 2020 2020 7a67 3d73  ()..        zg=s
+00019460: 656c 662e 6765 745f 7a67 2829 0d0a 0d0a  elf.get_zg()....
+00019470: 2020 2020 2020 2020 236f 7264 6572 2075          #order u
+00019480: 6e69 7473 0d0a 2020 2020 2020 2020 7365  nits..        se
+00019490: 6c66 2e6f 7264 6572 5f50 696c 6573 2829  lf.order_Piles()
+000194a0: 0d0a 0d0a 2020 2020 2020 2020 2373 6574  ....        #set
+000194b0: 2068 6965 7261 7263 6879 5f72 656c 6174   hierarchy_relat
+000194c0: 696f 6e73 0d0a 2020 2020 2020 2020 7365  ions..        se
+000194d0: 6c66 2e68 6965 7261 7263 6879 5f72 656c  lf.hierarchy_rel
+000194e0: 6174 696f 6e73 2876 623d 7365 6c66 2e76  ations(vb=self.v
+000194f0: 6572 626f 7365 290d 0a0d 0a20 2020 2020  erbose)....     
+00019500: 2020 2069 6620 6c65 6e28 7365 6c66 2e6c     if len(self.l
+00019510: 6973 745f 6268 7320 2b20 7365 6c66 2e6c  ist_bhs + self.l
+00019520: 6973 745f 6661 6b65 5f62 6873 202b 2073  ist_fake_bhs + s
+00019530: 656c 662e 6c69 7374 5f6d 6170 5f62 6873  elf.list_map_bhs
+00019540: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
+00019550: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00019560: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+00019570: 2020 2020 2020 2070 7269 6e74 2822 4e6f         print("No
+00019580: 2062 6f72 6568 6f6c 6520 666f 756e 6420   borehole found 
+00019590: 2d20 6e6f 2068 6420 6578 7472 6163 7465  - no hd extracte
+000195a0: 6422 290d 0a20 2020 2020 2020 2020 2020  d")..           
+000195b0: 2023 7365 6c66 2e62 6873 5f70 726f 6365   #self.bhs_proce
+000195c0: 7373 6564 3d31 0d0a 2020 2020 2020 2020  ssed=1..        
+000195d0: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
+000195e0: 2020 2020 2020 2323 2320 6578 7472 6163        ### extrac
+000195f0: 7420 7374 7261 7469 2075 6e69 7473 2061  t strati units a
+00019600: 6e64 2066 6163 6965 7320 696e 666f 2066  nd facies info f
+00019610: 726f 6d20 626f 7265 686f 6c65 2064 6174  rom borehole dat
+00019620: 610d 0a20 2020 2020 2020 2069 6620 7365  a..        if se
+00019630: 6c66 2e62 6873 5f70 726f 6365 7373 6564  lf.bhs_processed
+00019640: 203d 3d20 303a 0d0a 0d0a 2020 2020 2020   == 0:....      
+00019650: 2020 2020 2020 7365 6c66 2e73 746f 5f68        self.sto_h
+00019660: 6420 3d20 5b5d 0d0a 2020 2020 2020 2020  d = []..        
+00019670: 2020 2020 2323 2320 6368 6563 6b20 6d75      ### check mu
+00019680: 6c74 6970 6c65 2062 6f72 6568 6f6c 6573  ltiple boreholes
+00019690: 2069 6e20 7468 6520 7361 6d65 2063 656c   in the same cel
+000196a0: 6c20 2323 230d 0a20 2020 2020 2020 2020  l ###..         
+000196b0: 2020 2074 3d4b 4454 7265 6528 7365 6c66     t=KDTree(self
+000196c0: 2e78 7532 4429 0d0a 0d0a 2020 2020 2020  .xu2D)....      
+000196d0: 2020 2020 2020 7862 683d 5b69 2e78 2066        xbh=[i.x f
+000196e0: 6f72 2069 2069 6e20 6268 735f 6c73 745d  or i in bhs_lst]
+000196f0: 0d0a 2020 2020 2020 2020 2020 2020 7962  ..            yb
+00019700: 683d 5b69 2e79 2066 6f72 2069 2069 6e20  h=[i.y for i in 
+00019710: 6268 735f 6c73 745d 0d0a 2020 2020 2020  bhs_lst]..      
+00019720: 2020 2020 2020 635f 6268 3d6e 702e 6172        c_bh=np.ar
+00019730: 7261 7928 5b78 6268 2c20 7962 685d 292e  ray([xbh, ybh]).
+00019740: 5420 2023 2062 6f72 6568 6f6c 6573 2063  T  # boreholes c
+00019750: 6f6f 7264 696e 6174 6573 0d0a 0d0a 2020  oordinates....  
+00019760: 2020 2020 2020 2020 2020 6964 783d 742e            idx=t.
+00019770: 7175 6572 7928 635f 6268 2c20 7265 7475  query(c_bh, retu
+00019780: 726e 5f64 6973 7461 6e63 653d 4661 6c73  rn_distance=Fals
+00019790: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+000197a0: 6268 5f61 7272 3d6e 702e 6172 7261 7928  bh_arr=np.array(
+000197b0: 6268 735f 6c73 7429 2023 2061 7272 6179  bhs_lst) # array
+000197c0: 206f 6620 626f 7265 686f 6c65 730d 0a20   of boreholes.. 
+000197d0: 2020 2020 2020 2020 2020 2069 6478 5f72             idx_r
+000197e0: 656d 6f76 6564 3d5b 5d0d 0a20 2020 2020  emoved=[]..     
+000197f0: 2020 2020 2020 2066 6f72 2069 6478 3120         for idx1 
+00019800: 696e 2069 6478 3a0d 0a20 2020 2020 2020  in idx:..       
+00019810: 2020 2020 2020 2020 2069 6620 6964 7831           if idx1
+00019820: 206e 6f74 2069 6e20 6964 785f 7265 6d6f   not in idx_remo
+00019830: 7665 643a 0d0a 2020 2020 2020 2020 2020  ved:..          
+00019840: 2020 2020 2020 2020 2020 6d61 736b 3d28            mask=(
+00019850: 6964 7831 203d 3d20 6964 7829 2e72 6573  idx1 == idx).res
+00019860: 6861 7065 282d 3129 0d0a 2020 2020 2020  hape(-1)..      
+00019870: 2020 2020 2020 2020 2020 2020 2020 6268                bh
+00019880: 735f 6365 6c6c 3d62 685f 6172 725b 6d61  s_cell=bh_arr[ma
+00019890: 736b 5d20 2362 6f72 6568 6f6c 6573 2069  sk] #boreholes i
+000198a0: 6e20 7468 6520 7361 6d65 2063 656c 6c0d  n the same cell.
+000198b0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000198c0: 2020 2020 2020 2069 6620 6c65 6e28 6268         if len(bh
+000198d0: 735f 6365 6c6c 2920 3e20 313a 2023 206d  s_cell) > 1: # m
+000198e0: 6f72 6520 7468 616e 206f 6e65 2062 6f72  ore than one bor
+000198f0: 6568 6f6c 6520 696e 206f 6e65 2063 656c  ehole in one cel
+00019900: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00019910: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00019920: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+00019930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019940: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00019950: 4d75 6c74 6970 6c65 7320 626f 7265 686f  Multiples boreho
+00019960: 6c65 7320 7b7d 2077 6572 6520 666f 756e  les {} were foun
+00019970: 6420 696e 7369 6465 2074 6865 2073 616d  d inside the sam
+00019980: 6520 6365 6c6c 2c20 7468 6520 6465 6570  e cell, the deep
+00019990: 6573 7420 7769 6c6c 2062 6520 6b65 7074  est will be kept
+000199a0: 222e 666f 726d 6174 285b 692e 4944 2066  ".format([i.ID f
+000199b0: 6f72 2069 2069 6e20 6268 735f 6365 6c6c  or i in bhs_cell
+000199c0: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+000199d0: 2020 2020 2020 2020 2020 2020 2064 6570               dep
+000199e0: 7468 733d 286e 702e 6172 7261 7928 5b69  ths=(np.array([i
+000199f0: 2e64 6570 7468 2066 6f72 2069 2069 6e20  .depth for i in 
+00019a00: 6268 735f 6365 6c6c 5d29 290d 0a20 2020  bhs_cell]))..   
+00019a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019a20: 2020 2020 206d 6173 6b32 3d28 6465 7074       mask2=(dept
+00019a30: 6873 203d 3d20 6d61 7828 6465 7074 6873  hs == max(depths
+00019a40: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00019a50: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00019a60: 756d 286d 6173 6b32 2920 3d3d 2031 3a0d  um(mask2) == 1:.
+00019a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019a80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00019a90: 2028 6268 2c20 6368 6b29 2069 6e20 7a69   (bh, chk) in zi
+00019aa0: 7028 6268 735f 6365 6c6c 2c20 6d61 736b  p(bhs_cell, mask
+00019ab0: 3229 3a0d 0a20 2020 2020 2020 2020 2020  2):..           
+00019ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ad0: 2020 2020 2069 6620 7e63 686b 3a0d 0a20       if ~chk:.. 
+00019ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00019af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b00: 2020 2020 2023 7265 6d6f 7665 2062 6f72       #remove bor
-00019b10: 6568 6f6c 6520 6672 6f6d 206c 6973 7473  ehole from lists
-00019b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019b30: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019b40: 7220 6920 696e 2072 616e 6765 2831 2c20  r i in range(1, 
-00019b50: 6c65 6e28 6268 735f 6365 6c6c 2929 3a0d  len(bhs_cell)):.
-00019b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019b00: 2020 2023 7265 6d6f 7665 2062 6f72 6568     #remove boreh
+00019b10: 6f6c 6520 6672 6f6d 206c 6973 7473 0d0a  ole from lists..
+00019b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b40: 2020 2020 7265 6d6f 7665 5f62 6828 6268      remove_bh(bh
+00019b50: 2c20 6268 735f 6c73 7429 0d0a 2020 2020  , bhs_lst)..    
+00019b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00019b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b80: 2072 656d 6f76 655f 6268 2862 6873 5f63   remove_bh(bhs_c
-00019b90: 656c 6c5b 695d 2c20 6268 735f 6c73 7429  ell[i], bhs_lst)
-00019ba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00019bb0: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00019bc0: 785f 7265 6d6f 7665 642e 6170 7065 6e64  x_removed.append
-00019bd0: 2869 6478 3129 0d0a 2020 2020 2020 2020  (idx1)..        
-00019be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019bf0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00019b80: 6964 785f 7265 6d6f 7665 642e 6170 7065  idx_removed.appe
+00019b90: 6e64 2869 6478 3129 0d0a 2020 2020 2020  nd(idx1)..      
+00019ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019bb0: 2020 656c 6966 2073 756d 286d 6173 6b32    elif sum(mask2
+00019bc0: 2920 3e20 313a 2023 6268 7320 6861 7665  ) > 1: #bhs have
+00019bd0: 2074 6865 2073 616d 6520 6465 7074 6873   the same depths
+00019be0: 202d 2d3e 2072 656d 6f76 6520 6f74 6865   --> remove othe
+00019bf0: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
 00019c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c10: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-00019c20: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00019c10: 2372 656d 6f76 6520 626f 7265 686f 6c65  #remove borehole
+00019c20: 2066 726f 6d20 6c69 7374 730d 0a20 2020   from lists..   
 00019c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019c40: 2020 2020 2070 7269 6e74 2822 4572 726f       print("Erro
-00019c50: 7220 7468 6973 2073 686f 756c 646e 2774  r this shouldn't
-00019c60: 2068 6170 7065 6e20 3a29 2229 0d0a 0d0a   happen :)")....
-00019c70: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00019c80: 656e 2862 6873 5f6c 7374 2920 3d3d 2030  en(bhs_lst) == 0
-00019c90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00019ca0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-00019cb0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00019cc0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00019cd0: 4e6f 2076 616c 6964 2062 6f72 6568 6f6c  No valid borehol
-00019ce0: 652c 2070 726f 6365 7373 7573 2061 626f  e, processus abo
-00019cf0: 7274 6564 2229 0d0a 0d0a 2020 2020 2020  rted")....      
-00019d00: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00019d10: 204e 6f6e 650d 0a0d 0a20 2020 2020 2020   None....       
-00019d20: 2020 2020 2023 2320 5350 4c49 5420 424f       ## SPLIT BO
-00019d30: 5245 484f 4c45 5320 2323 0d0a 2020 2020  REHOLES ##..    
-00019d40: 2020 2020 2020 2020 2320 6c6f 6773 206d          # logs m
-00019d50: 7573 7420 6265 2073 706c 6974 7465 6420  ust be splitted 
-00019d60: 6279 2068 6965 7261 7263 6879 2067 726f  by hierarchy gro
-00019d70: 7570 2061 6e64 206c 696e 6b65 6420 7769  up and linked wi
-00019d80: 7468 2061 7373 6967 6e65 6420 5069 6c65  th assigned Pile
-00019d90: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-00019da0: 775f 6268 5f6c 7374 3d5b 5d0d 0a20 2020  w_bh_lst=[]..   
-00019db0: 2020 2020 2020 2020 2066 6f72 2062 6820           for bh 
-00019dc0: 696e 2062 6873 5f6c 7374 3a0d 0a20 2020  in bhs_lst:..   
-00019dd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00019de0: 6268 2e6c 6f67 5f73 7472 6174 6920 6973  bh.log_strati is
-00019df0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00019e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e10: 6966 206c 656e 285b 695b 305d 2066 6f72  if len([i[0] for
-00019e20: 2069 2069 6e20 6268 2e6c 6f67 5f73 7472   i in bh.log_str
-00019e30: 6174 6920 6966 2069 5b30 5d20 6973 206e  ati if i[0] is n
-00019e40: 6f74 204e 6f6e 655d 2920 3e20 303a 0d0a  ot None]) > 0:..
-00019e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019e60: 2020 2020 2020 2020 666f 7220 6e65 775f          for new_
-00019e70: 6268 2069 6e20 7370 6c69 745f 6c6f 6773  bh in split_logs
-00019e80: 2862 6829 3a0d 0a20 2020 2020 2020 2020  (bh):..         
-00019e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019ea0: 2020 206e 6577 5f62 685f 6c73 742e 6170     new_bh_lst.ap
-00019eb0: 7065 6e64 286e 6577 5f62 6829 0d0a 2020  pend(new_bh)..  
-00019ec0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00019ed0: 6966 2062 682e 6c6f 675f 6661 6369 6573  if bh.log_facies
-00019ee0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-00019ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f00: 2020 206e 6577 5f62 685f 6c73 742e 6170     new_bh_lst.ap
-00019f10: 7065 6e64 2862 6829 0d0a 0d0a 2020 2020  pend(bh)....    
-00019f20: 2020 2020 2020 2020 2363 6865 636b 2063          #check c
-00019f30: 6f6e 7369 7374 656e 6379 0d0a 2020 2020  onsistency..    
-00019f40: 2020 2020 2020 2020 6368 6563 6b5f 6268          check_bh
-00019f50: 735f 636f 6e73 6973 7465 6e63 7928 6e65  s_consistency(ne
-00019f60: 775f 6268 5f6c 7374 290d 0a0d 0a20 2020  w_bh_lst)....   
-00019f70: 2020 2020 2020 2020 2064 6566 2061 6464           def add
-00019f80: 5f63 6f6e 7461 6374 2873 2c20 782c 2079  _contact(s, x, y
-00019f90: 2c20 7a2c 2074 7970 653d 2265 7175 616c  , z, type="equal
-00019fa0: 6974 7922 2c20 7a32 3d4e 6f6e 6529 3a20  ity", z2=None): 
-00019fb0: 2366 756e 6374 696f 6e20 746f 2061 6464  #function to add
-00019fc0: 2061 6e20 6864 2070 6f69 6e74 2074 6f20   an hd point to 
-00019fd0: 6120 7375 7266 6163 650d 0a20 2020 2020  a surface..     
-00019fe0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00019ff0: 6c66 2e63 6f6f 7264 3263 656c 6c28 782c  lf.coord2cell(x,
-0001a000: 2079 2c20 7a29 2069 7320 6e6f 7420 4e6f   y, z) is not No
-0001a010: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0001a020: 2020 2020 2020 2020 2069 6620 7479 7065           if type
-0001a030: 203d 3d20 2265 7175 616c 6974 7922 3a0d   == "equality":.
-0001a040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a050: 2020 2020 2020 2020 2073 2e73 7572 6661           s.surfa
-0001a060: 6365 2e78 2e61 7070 656e 6428 7829 0d0a  ce.x.append(x)..
-0001a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a080: 2020 2020 2020 2020 732e 7375 7266 6163          s.surfac
-0001a090: 652e 792e 6170 7065 6e64 2879 290d 0a20  e.y.append(y).. 
-0001a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0b0: 2020 2020 2020 2073 2e73 7572 6661 6365         s.surface
-0001a0c0: 2e7a 2e61 7070 656e 6428 7a29 0d0a 2020  .z.append(z)..  
-0001a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a0e0: 2020 656c 6966 2074 7970 6520 3d3d 2022    elif type == "
-0001a0f0: 696e 6571 5f69 6e66 223a 0d0a 2020 2020  ineq_inf":..    
-0001a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a110: 2020 2020 732e 7375 7266 6163 652e 696e      s.surface.in
-0001a120: 6571 2e61 7070 656e 6428 5b78 2c20 792c  eq.append([x, y,
-0001a130: 2030 2c20 7a2c 206e 702e 6e61 6e5d 290d   0, z, np.nan]).
-0001a140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a150: 2020 2020 2065 6c69 6620 7479 7065 203d       elif type =
-0001a160: 3d20 2269 6e65 715f 7375 7022 3a0d 0a20  = "ineq_sup":.. 
-0001a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a180: 2020 2020 2020 2073 2e73 7572 6661 6365         s.surface
-0001a190: 2e69 6e65 712e 6170 7065 6e64 285b 782c  .ineq.append([x,
-0001a1a0: 2079 2c20 302c 206e 702e 6e61 6e2c 207a   y, 0, np.nan, z
-0001a1b0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0001a1c0: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
-0001a1d0: 6520 3d3d 2022 646f 7562 6c65 5f69 6e65  e == "double_ine
-0001a1e0: 7122 3a0d 0a20 2020 2020 2020 2020 2020  q":..           
-0001a1f0: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
-0001a200: 7572 6661 6365 2e69 6e65 712e 6170 7065  urface.ineq.appe
-0001a210: 6e64 285b 782c 2079 2c20 302c 207a 2c20  nd([x, y, 0, z, 
-0001a220: 7a32 5d29 2020 2320 696e 6665 7269 6f72  z2])  # inferior
-0001a230: 2061 6e64 2075 7070 6572 2069 6e65 710d   and upper ineq.
-0001a240: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-0001a250: 6620 6c65 6e28 6e65 775f 6268 5f6c 7374  f len(new_bh_lst
-0001a260: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
-0001a270: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0001a280: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-0001a290: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001a2a0: 7269 6e74 2822 4e6f 2076 616c 6964 2062  rint("No valid b
-0001a2b0: 6f72 6568 6f6c 652c 2070 726f 6365 7373  orehole, process
-0001a2c0: 7573 2061 626f 7274 6564 2229 0d0a 2020  us aborted")..  
-0001a2d0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001a2e0: 7475 726e 204e 6f6e 650d 0a0d 0a0d 0a20  turn None...... 
-0001a2f0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-0001a300: 5052 4f43 4553 5349 4e47 2028 4172 6368  PROCESSING (Arch
-0001a310: 5079 2041 6c67 6f72 6974 686d 2920 2323  Py Algorithm) ##
-0001a320: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-0001a330: 2020 2323 2323 2046 6163 6965 7320 2323    #### Facies ##
-0001a340: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0001a350: 6966 2066 6163 6965 733a 0d0a 2020 2020  if facies:..    
-0001a360: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001a370: 7465 7020 6973 204e 6f6e 653a 0d0a 2020  tep is None:..  
-0001a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a390: 2020 7374 6570 3d6e 702e 6162 7328 7a67    step=np.abs(zg
-0001a3a0: 5b31 5d20 2d20 7a67 5b30 5d29 2023 2069  [1] - zg[0]) # i
-0001a3b0: 6e74 6572 7661 6c20 7370 6163 696e 6720  nterval spacing 
-0001a3c0: 746f 2073 616d 706c 6520 6461 7461 0d0a  to sample data..
-0001a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3e0: 666f 7220 6268 2069 6e20 6e65 775f 6268  for bh in new_bh
-0001a3f0: 5f6c 7374 3a0d 0a20 2020 2020 2020 2020  _lst:..         
-0001a400: 2020 2020 2020 2020 2020 2069 6620 6268             if bh
-0001a410: 2e6c 6f67 5f66 6163 6965 7320 6973 206e  .log_facies is n
-0001a420: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0001a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a440: 2020 666f 7220 7a69 2069 6e20 6e70 2e61    for zi in np.a
-0001a450: 7261 6e67 6528 6268 2e7a 2b73 7465 702f  range(bh.z+step/
-0001a460: 322c 2062 682e 7a2d 6268 2e64 6570 7468  2, bh.z-bh.depth
-0001a470: 2c20 2d73 7465 7029 3a20 2320 6c6f 6f70  , -step): # loop
-0001a480: 206f 7665 7220 616c 6c20 7468 6520 626f   over all the bo
-0001a490: 7265 686f 6c65 2066 726f 6d20 746f 7020  rehole from top 
-0001a4a0: 746f 2062 6f74 6f6d 0d0a 2020 2020 2020  to botom..      
-0001a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a4c0: 2020 2020 2020 6966 207a 6920 3c20 6268        if zi < bh
-0001a4d0: 2e7a 3a0d 0a20 2020 2020 2020 2020 2020  .z:..           
-0001a4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a4f0: 2020 2020 2069 6478 3d6e 702e 7768 6572       idx=np.wher
-0001a500: 6528 7a69 203c 206e 702e 6172 7261 7928  e(zi < np.array(
-0001a510: 6268 2e6c 6f67 5f66 6163 6965 7329 5b3a  bh.log_facies)[:
-0001a520: 2c20 315d 295b 305d 5b2d 315d 0d0a 2020  , 1])[0][-1]..  
-0001a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a540: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0001a550: 3d62 682e 6c6f 675f 6661 6369 6573 5b69  =bh.log_facies[i
-0001a560: 6478 5d5b 305d 0d0a 2020 2020 2020 2020  dx][0]..        
-0001a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a580: 2020 2020 2020 2020 6966 2066 6120 6973          if fa is
-0001a590: 206e 6f74 204e 6f6e 653a 2023 2069 6620   not None: # if 
-0001a5a0: 7468 6572 6520 6973 2064 6174 610d 0a20  there is data.. 
-0001a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c40: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
+00019c50: 6e20 7261 6e67 6528 312c 206c 656e 2862  n range(1, len(b
+00019c60: 6873 5f63 656c 6c29 293a 0d0a 2020 2020  hs_cell)):..    
+00019c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c80: 2020 2020 2020 2020 2020 2020 7265 6d6f              remo
+00019c90: 7665 5f62 6828 6268 735f 6365 6c6c 5b69  ve_bh(bhs_cell[i
+00019ca0: 5d2c 2062 6873 5f6c 7374 290d 0a20 2020  ], bhs_lst)..   
+00019cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cc0: 2020 2020 2020 2020 2069 6478 5f72 656d           idx_rem
+00019cd0: 6f76 6564 2e61 7070 656e 6428 6964 7831  oved.append(idx1
+00019ce0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00019cf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00019d00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019d10: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00019d20: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+00019d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019d50: 7072 696e 7428 2245 7272 6f72 2074 6869  print("Error thi
+00019d60: 7320 7368 6f75 6c64 6e27 7420 6861 7070  s shouldn't happ
+00019d70: 656e 203a 2922 290d 0a0d 0a20 2020 2020  en :)")....     
+00019d80: 2020 2020 2020 2069 6620 6c65 6e28 6268         if len(bh
+00019d90: 735f 6c73 7429 203d 3d20 303a 0d0a 2020  s_lst) == 0:..  
+00019da0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00019db0: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+00019dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019dd0: 2020 2020 7072 696e 7428 224e 6f20 7661      print("No va
+00019de0: 6c69 6420 626f 7265 686f 6c65 2c20 7072  lid borehole, pr
+00019df0: 6f63 6573 7375 7320 6162 6f72 7465 6422  ocessus aborted"
+00019e00: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00019e10: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+00019e20: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00019e30: 2323 2053 504c 4954 2042 4f52 4548 4f4c  ## SPLIT BOREHOL
+00019e40: 4553 2023 230d 0a20 2020 2020 2020 2020  ES ##..         
+00019e50: 2020 2023 206c 6f67 7320 6d75 7374 2062     # logs must b
+00019e60: 6520 7370 6c69 7474 6564 2062 7920 6869  e splitted by hi
+00019e70: 6572 6172 6368 7920 6772 6f75 7020 616e  erarchy group an
+00019e80: 6420 6c69 6e6b 6564 2077 6974 6820 6173  d linked with as
+00019e90: 7369 676e 6564 2050 696c 650d 0a20 2020  signed Pile..   
+00019ea0: 2020 2020 2020 2020 206e 6577 5f62 685f           new_bh_
+00019eb0: 6c73 743d 5b5d 0d0a 2020 2020 2020 2020  lst=[]..        
+00019ec0: 2020 2020 666f 7220 6268 2069 6e20 6268      for bh in bh
+00019ed0: 735f 6c73 743a 0d0a 2020 2020 2020 2020  s_lst:..        
+00019ee0: 2020 2020 2020 2020 6966 2062 682e 6c6f          if bh.lo
+00019ef0: 675f 7374 7261 7469 2069 7320 6e6f 7420  g_strati is not 
+00019f00: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00019f10: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00019f20: 6e28 5b69 5b30 5d20 666f 7220 6920 696e  n([i[0] for i in
+00019f30: 2062 682e 6c6f 675f 7374 7261 7469 2069   bh.log_strati i
+00019f40: 6620 695b 305d 2069 7320 6e6f 7420 4e6f  f i[0] is not No
+00019f50: 6e65 5d29 203e 2030 3a0d 0a20 2020 2020  ne]) > 0:..     
+00019f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019f70: 2020 2066 6f72 206e 6577 5f62 6820 696e     for new_bh in
+00019f80: 2073 706c 6974 5f6c 6f67 7328 6268 293a   split_logs(bh):
+00019f90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019fa0: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+00019fb0: 775f 6268 5f6c 7374 2e61 7070 656e 6428  w_bh_lst.append(
+00019fc0: 6e65 775f 6268 290d 0a20 2020 2020 2020  new_bh)..       
+00019fd0: 2020 2020 2020 2020 2065 6c69 6620 6268           elif bh
+00019fe0: 2e6c 6f67 5f66 6163 6965 7320 6973 206e  .log_facies is n
+00019ff0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0001a000: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0001a010: 775f 6268 5f6c 7374 2e61 7070 656e 6428  w_bh_lst.append(
+0001a020: 6268 290d 0a0d 0a20 2020 2020 2020 2020  bh)....         
+0001a030: 2020 2023 6368 6563 6b20 636f 6e73 6973     #check consis
+0001a040: 7465 6e63 790d 0a20 2020 2020 2020 2020  tency..         
+0001a050: 2020 2063 6865 636b 5f62 6873 5f63 6f6e     check_bhs_con
+0001a060: 7369 7374 656e 6379 286e 6577 5f62 685f  sistency(new_bh_
+0001a070: 6c73 7429 0d0a 0d0a 2020 2020 2020 2020  lst)....        
+0001a080: 2020 2020 6465 6620 6164 645f 636f 6e74      def add_cont
+0001a090: 6163 7428 732c 2078 2c20 792c 207a 2c20  act(s, x, y, z, 
+0001a0a0: 7479 7065 3d22 6571 7561 6c69 7479 222c  type="equality",
+0001a0b0: 207a 323d 4e6f 6e65 293a 2023 6675 6e63   z2=None): #func
+0001a0c0: 7469 6f6e 2074 6f20 6164 6420 616e 2068  tion to add an h
+0001a0d0: 6420 706f 696e 7420 746f 2061 2073 7572  d point to a sur
+0001a0e0: 6661 6365 0d0a 2020 2020 2020 2020 2020  face..          
+0001a0f0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
+0001a100: 6f72 6432 6365 6c6c 2878 2c20 792c 207a  ord2cell(x, y, z
+0001a110: 2920 6973 206e 6f74 204e 6f6e 653a 0d0a  ) is not None:..
+0001a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a130: 2020 2020 6966 2074 7970 6520 3d3d 2022      if type == "
+0001a140: 6571 7561 6c69 7479 223a 0d0a 2020 2020  equality":..    
+0001a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a160: 2020 2020 732e 7375 7266 6163 652e 782e      s.surface.x.
+0001a170: 6170 7065 6e64 2878 290d 0a20 2020 2020  append(x)..     
+0001a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a190: 2020 2073 2e73 7572 6661 6365 2e79 2e61     s.surface.y.a
+0001a1a0: 7070 656e 6428 7929 0d0a 2020 2020 2020  ppend(y)..      
+0001a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1c0: 2020 732e 7375 7266 6163 652e 7a2e 6170    s.surface.z.ap
+0001a1d0: 7065 6e64 287a 290d 0a20 2020 2020 2020  pend(z)..       
+0001a1e0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0001a1f0: 6620 7479 7065 203d 3d20 2269 6e65 715f  f type == "ineq_
+0001a200: 696e 6622 3a0d 0a20 2020 2020 2020 2020  inf":..         
+0001a210: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001a220: 2e73 7572 6661 6365 2e69 6e65 712e 6170  .surface.ineq.ap
+0001a230: 7065 6e64 285b 782c 2079 2c20 302c 207a  pend([x, y, 0, z
+0001a240: 2c20 6e70 2e6e 616e 5d29 0d0a 2020 2020  , np.nan])..    
+0001a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a260: 656c 6966 2074 7970 6520 3d3d 2022 696e  elif type == "in
+0001a270: 6571 5f73 7570 223a 0d0a 2020 2020 2020  eq_sup":..      
+0001a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a290: 2020 732e 7375 7266 6163 652e 696e 6571    s.surface.ineq
+0001a2a0: 2e61 7070 656e 6428 5b78 2c20 792c 2030  .append([x, y, 0
+0001a2b0: 2c20 6e70 2e6e 616e 2c20 7a5d 290d 0a20  , np.nan, z]).. 
+0001a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a2d0: 2020 2065 6c69 6620 7479 7065 203d 3d20     elif type == 
+0001a2e0: 2264 6f75 626c 655f 696e 6571 223a 0d0a  "double_ineq":..
+0001a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a300: 2020 2020 2020 2020 732e 7375 7266 6163          s.surfac
+0001a310: 652e 696e 6571 2e61 7070 656e 6428 5b78  e.ineq.append([x
+0001a320: 2c20 792c 2030 2c20 7a2c 207a 325d 2920  , y, 0, z, z2]) 
+0001a330: 2023 2069 6e66 6572 696f 7220 616e 6420   # inferior and 
+0001a340: 7570 7065 7220 696e 6571 0d0a 0d0a 2020  upper ineq....  
+0001a350: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0001a360: 286e 6577 5f62 685f 6c73 7429 203d 3d20  (new_bh_lst) == 
+0001a370: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0001a380: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+0001a390: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+0001a3a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0001a3b0: 224e 6f20 7661 6c69 6420 626f 7265 686f  "No valid boreho
+0001a3c0: 6c65 2c20 7072 6f63 6573 7375 7320 6162  le, processus ab
+0001a3d0: 6f72 7465 6422 290d 0a20 2020 2020 2020  orted")..       
+0001a3e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001a3f0: 4e6f 6e65 0d0a 0d0a 0d0a 2020 2020 2020  None......      
+0001a400: 2020 2020 2020 2323 2323 2050 524f 4345        #### PROCE
+0001a410: 5353 494e 4720 2841 7263 6850 7920 416c  SSING (ArchPy Al
+0001a420: 676f 7269 7468 6d29 2023 2323 2323 230d  gorithm) ######.
+0001a430: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+0001a440: 2320 4661 6369 6573 2023 2323 230d 0a20  # Facies ####.. 
+0001a450: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
+0001a460: 6369 6573 3a0d 0a20 2020 2020 2020 2020  cies:..         
+0001a470: 2020 2020 2020 2069 6620 7374 6570 2069         if step i
+0001a480: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+0001a490: 2020 2020 2020 2020 2020 2020 2073 7465               ste
+0001a4a0: 703d 6e70 2e61 6273 287a 675b 315d 202d  p=np.abs(zg[1] -
+0001a4b0: 207a 675b 305d 2920 2320 696e 7465 7276   zg[0]) # interv
+0001a4c0: 616c 2073 7061 6369 6e67 2074 6f20 7361  al spacing to sa
+0001a4d0: 6d70 6c65 2064 6174 610d 0a20 2020 2020  mple data..     
+0001a4e0: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
+0001a4f0: 6820 696e 206e 6577 5f62 685f 6c73 743a  h in new_bh_lst:
+0001a500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001a510: 2020 2020 2020 6966 2062 682e 6c6f 675f        if bh.log_
+0001a520: 6661 6369 6573 2069 7320 6e6f 7420 4e6f  facies is not No
+0001a530: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0001a540: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0001a550: 207a 6920 696e 206e 702e 6172 616e 6765   zi in np.arange
+0001a560: 2862 682e 7a2b 7374 6570 2f32 2c20 6268  (bh.z+step/2, bh
+0001a570: 2e7a 2d62 682e 6465 7074 682c 202d 7374  .z-bh.depth, -st
+0001a580: 6570 293a 2023 206c 6f6f 7020 6f76 6572  ep): # loop over
+0001a590: 2061 6c6c 2074 6865 2062 6f72 6568 6f6c   all the borehol
+0001a5a0: 6520 6672 6f6d 2074 6f70 2074 6f20 626f  e from top to bo
+0001a5b0: 746f 6d0d 0a20 2020 2020 2020 2020 2020  tom..           
 0001a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a5d0: 2020 2069 6620 7365 6c66 2e63 6f6f 7264     if self.coord
-0001a5e0: 3263 656c 6c28 6268 2e78 2c20 6268 2e79  2cell(bh.x, bh.y
-0001a5f0: 2c20 7a69 2920 6973 206e 6f74 204e 6f6e  , zi) is not Non
-0001a600: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0001a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a620: 2020 2020 2020 2020 2020 2020 6661 2e78              fa.x
-0001a630: 2e61 7070 656e 6428 6268 2e78 290d 0a20  .append(bh.x).. 
+0001a5d0: 2069 6620 7a69 203c 2062 682e 7a3a 0d0a   if zi < bh.z:..
+0001a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a600: 6964 783d 6e70 2e77 6865 7265 287a 6920  idx=np.where(zi 
+0001a610: 3c20 6e70 2e61 7272 6179 2862 682e 6c6f  < np.array(bh.lo
+0001a620: 675f 6661 6369 6573 295b 3a2c 2031 5d29  g_facies)[:, 1])
+0001a630: 5b30 5d5b 2d31 5d0d 0a20 2020 2020 2020  [0][-1]..       
 0001a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a660: 2020 2020 2020 2066 612e 792e 6170 7065         fa.y.appe
-0001a670: 6e64 2862 682e 7929 0d0a 2020 2020 2020  nd(bh.y)..      
+0001a650: 2020 2020 2020 2020 2066 613d 6268 2e6c           fa=bh.l
+0001a660: 6f67 5f66 6163 6965 735b 6964 785d 5b30  og_facies[idx][0
+0001a670: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
 0001a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a6a0: 2020 6661 2e7a 2e61 7070 656e 6428 7a69    fa.z.append(zi
-0001a6b0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001a6c0: 2023 2023 2072 656d 6f76 6520 4e6f 6e65   # # remove None
-0001a6d0: 2061 7420 656e 6420 6f66 2062 680d 0a20   at end of bh.. 
-0001a6e0: 2020 2020 2020 2020 2020 2023 2077 6869             # whi
-0001a6f0: 6c65 205b 6268 2066 6f72 2062 6820 696e  le [bh for bh in
-0001a700: 206e 6577 5f62 685f 6c73 7420 6966 2062   new_bh_lst if b
-0001a710: 682e 6c6f 675f 7374 7261 7469 5b2d 315d  h.log_strati[-1]
-0001a720: 5b30 5d20 6973 204e 6f6e 655d 3a0d 0a20  [0] is None]:.. 
-0001a730: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-0001a740: 2066 6f72 2062 6820 696e 206e 6577 5f62   for bh in new_b
-0001a750: 685f 6c73 743a 0d0a 2020 2020 2020 2020  h_lst:..        
-0001a760: 2020 2020 2320 2020 2020 2020 2020 6966      #         if
-0001a770: 2062 682e 6c6f 675f 7374 7261 7469 5b2d   bh.log_strati[-
-0001a780: 315d 5b30 5d20 6973 204e 6f6e 653a 0d0a  1][0] is None:..
-0001a790: 2020 2020 2020 2020 2020 2020 2320 2020              #   
-0001a7a0: 2020 2020 2020 2020 2020 6e65 775f 6268            new_bh
-0001a7b0: 5f6c 7374 2e72 656d 6f76 6528 6268 290d  _lst.remove(bh).
-0001a7c0: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
-0001a7d0: 2020 2020 2020 2020 2020 206e 6577 5f62             new_b
-0001a7e0: 6820 3d20 6268 0d0a 2020 2020 2020 2020  h = bh..        
-0001a7f0: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0001a800: 2020 6e65 775f 6268 2e6c 6f67 5f73 7472    new_bh.log_str
-0001a810: 6174 6920 3d20 6e65 775f 6268 2e6c 6f67  ati = new_bh.log
-0001a820: 5f73 7472 6174 695b 3a2d 315d 0d0a 2020  _strati[:-1]..  
-0001a830: 2020 2020 2020 2020 2020 2320 2020 2020            #     
-0001a840: 2020 2020 2020 2020 6e65 775f 6268 5f6c          new_bh_l
-0001a850: 7374 2e61 7070 656e 6428 6e65 775f 6268  st.append(new_bh
-0001a860: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001a870: 2023 2070 7269 6e74 285b 692e 6c6f 675f   # print([i.log_
-0001a880: 7374 7261 7469 2066 6f72 2069 2069 6e20  strati for i in 
-0001a890: 6e65 775f 6268 5f6c 7374 5d29 0d0a 0d0a  new_bh_lst])....
-0001a8a0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-0001a8b0: 2055 6e69 7473 2023 2323 230d 0a20 2020   Units ####..   
-0001a8c0: 2020 2020 2020 2020 2066 6f72 2062 6820           for bh 
-0001a8d0: 696e 206e 6577 5f62 685f 6c73 743a 0d0a  in new_bh_lst:..
-0001a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a8f0: 6966 2062 682e 6c6f 675f 7374 7261 7469  if bh.log_strati
-0001a900: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-0001a910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a920: 2020 2066 6f72 2069 2c20 7320 696e 2065     for i, s in e
-0001a930: 6e75 6d65 7261 7465 2862 682e 6c6f 675f  numerate(bh.log_
-0001a940: 7374 7261 7469 293a 2020 2320 6c6f 6f70  strati):  # loop
-0001a950: 206f 7665 7220 626f 7265 686f 6c65 2028   over borehole (
-0001a960: 693a 2069 6e64 6578 2c20 733a 2074 7570  i: index, s: tup
-0001a970: 6c65 2028 7374 7261 7469 2c20 616c 7469  le (strati, alti
-0001a980: 7475 6465 206f 6620 636f 6e74 6163 7429  tude of contact)
-0001a990: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0001a9a0: 2020 2020 2020 2020 2020 2069 6620 735b             if s[
-0001a9b0: 305d 2069 7320 6e6f 7420 4e6f 6e65 3a20  0] is not None: 
-0001a9c0: 2023 2069 6620 7468 6572 6520 6973 2075   # if there is u
-0001a9d0: 6e69 7420 696e 666f 0d0a 2020 2020 2020  nit info..      
-0001a9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a9f0: 2020 2020 2020 7331 3d73 5b30 5d20 2023        s1=s[0]  #
-0001aa00: 2075 6e69 7420 6f66 2069 6e74 6572 6573   unit of interes
-0001aa10: 7420 2866 6972 7374 2065 6c65 6d65 6e74  t (first element
-0001aa20: 2069 7320 7374 7261 7469 206f 626a 6563   is strati objec
-0001aa30: 7429 0d0a 0d0a 2020 2020 2020 2020 2020  t)....          
-0001aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aa50: 2020 2320 6765 7420 7069 6c65 0d0a 2020    # get pile..  
-0001aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aa70: 2020 2020 2020 2020 2020 6966 2073 312e            if s1.
-0001aa80: 6d75 6d6d 795f 756e 6974 2069 7320 6e6f  mummy_unit is no
-0001aa90: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+0001a690: 2020 2069 6620 6661 2069 7320 6e6f 7420     if fa is not 
+0001a6a0: 4e6f 6e65 3a20 2320 6966 2074 6865 7265  None: # if there
+0001a6b0: 2069 7320 6461 7461 0d0a 2020 2020 2020   is data..      
+0001a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a6d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001a6e0: 2073 656c 662e 636f 6f72 6432 6365 6c6c   self.coord2cell
+0001a6f0: 2862 682e 782c 2062 682e 792c 207a 6929  (bh.x, bh.y, zi)
+0001a700: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+0001a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a730: 2020 2020 2020 2066 612e 782e 6170 7065         fa.x.appe
+0001a740: 6e64 2862 682e 7829 0d0a 2020 2020 2020  nd(bh.x)..      
+0001a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a770: 2020 6661 2e79 2e61 7070 656e 6428 6268    fa.y.append(bh
+0001a780: 2e79 290d 0a20 2020 2020 2020 2020 2020  .y)..           
+0001a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a7a0: 2020 2020 2020 2020 2020 2020 2066 612e               fa.
+0001a7b0: 7a2e 6170 7065 6e64 287a 6929 0d0a 0d0a  z.append(zi)....
+0001a7c0: 2020 2020 2020 2020 2020 2020 2320 2320              # # 
+0001a7d0: 7265 6d6f 7665 204e 6f6e 6520 6174 2065  remove None at e
+0001a7e0: 6e64 206f 6620 6268 0d0a 2020 2020 2020  nd of bh..      
+0001a7f0: 2020 2020 2020 2320 7768 696c 6520 5b62        # while [b
+0001a800: 6820 666f 7220 6268 2069 6e20 6e65 775f  h for bh in new_
+0001a810: 6268 5f6c 7374 2069 6620 6268 2e6c 6f67  bh_lst if bh.log
+0001a820: 5f73 7472 6174 695b 2d31 5d5b 305d 2069  _strati[-1][0] i
+0001a830: 7320 4e6f 6e65 5d3a 0d0a 2020 2020 2020  s None]:..      
+0001a840: 2020 2020 2020 2320 2020 2020 666f 7220        #     for 
+0001a850: 6268 2069 6e20 6e65 775f 6268 5f6c 7374  bh in new_bh_lst
+0001a860: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+0001a870: 2020 2020 2020 2020 2069 6620 6268 2e6c           if bh.l
+0001a880: 6f67 5f73 7472 6174 695b 2d31 5d5b 305d  og_strati[-1][0]
+0001a890: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0001a8a0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+0001a8b0: 2020 2020 206e 6577 5f62 685f 6c73 742e       new_bh_lst.
+0001a8c0: 7265 6d6f 7665 2862 6829 0d0a 2020 2020  remove(bh)..    
+0001a8d0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+0001a8e0: 2020 2020 2020 6e65 775f 6268 203d 2062        new_bh = b
+0001a8f0: 680d 0a20 2020 2020 2020 2020 2020 2023  h..            #
+0001a900: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0001a910: 5f62 682e 6c6f 675f 7374 7261 7469 203d  _bh.log_strati =
+0001a920: 206e 6577 5f62 682e 6c6f 675f 7374 7261   new_bh.log_stra
+0001a930: 7469 5b3a 2d31 5d0d 0a20 2020 2020 2020  ti[:-1]..       
+0001a940: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+0001a950: 2020 206e 6577 5f62 685f 6c73 742e 6170     new_bh_lst.ap
+0001a960: 7065 6e64 286e 6577 5f62 6829 0d0a 0d0a  pend(new_bh)....
+0001a970: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+0001a980: 696e 7428 5b69 2e6c 6f67 5f73 7472 6174  int([i.log_strat
+0001a990: 6920 666f 7220 6920 696e 206e 6577 5f62  i for i in new_b
+0001a9a0: 685f 6c73 745d 290d 0a0d 0a20 2020 2020  h_lst])....     
+0001a9b0: 2020 2020 2020 2023 2323 2320 556e 6974         #### Unit
+0001a9c0: 7320 2323 2323 0d0a 2020 2020 2020 2020  s ####..        
+0001a9d0: 2020 2020 666f 7220 6268 2069 6e20 6e65      for bh in ne
+0001a9e0: 775f 6268 5f6c 7374 3a0d 0a20 2020 2020  w_bh_lst:..     
+0001a9f0: 2020 2020 2020 2020 2020 2069 6620 6268             if bh
+0001aa00: 2e6c 6f67 5f73 7472 6174 6920 6973 206e  .log_strati is n
+0001aa10: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0001aa20: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001aa30: 7220 692c 2073 2069 6e20 656e 756d 6572  r i, s in enumer
+0001aa40: 6174 6528 6268 2e6c 6f67 5f73 7472 6174  ate(bh.log_strat
+0001aa50: 6929 3a20 2023 206c 6f6f 7020 6f76 6572  i):  # loop over
+0001aa60: 2062 6f72 6568 6f6c 6520 2869 3a20 696e   borehole (i: in
+0001aa70: 6465 782c 2073 3a20 7475 706c 6520 2873  dex, s: tuple (s
+0001aa80: 7472 6174 692c 2061 6c74 6974 7564 6520  trati, altitude 
+0001aa90: 6f66 2063 6f6e 7461 6374 2929 0d0a 2020  of contact))..  
 0001aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aab0: 2020 2020 2020 2020 2050 696c 653d 7331           Pile=s1
-0001aac0: 2e6d 756d 6d79 5f75 6e69 742e 5375 6250  .mummy_unit.SubP
-0001aad0: 696c 6520 2023 204c 696e 6b20 7769 7468  ile  # Link with
-0001aae0: 2070 696c 650d 0a20 2020 2020 2020 2020   pile..         
+0001aab0: 2020 2020 2020 6966 2073 5b30 5d20 6973        if s[0] is
+0001aac0: 206e 6f74 204e 6f6e 653a 2020 2320 6966   not None:  # if
+0001aad0: 2074 6865 7265 2069 7320 756e 6974 2069   there is unit i
+0001aae0: 6e66 6f0d 0a20 2020 2020 2020 2020 2020  nfo..           
 0001aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab00: 2020 2065 6c69 6620 7331 2069 6e20 7365     elif s1 in se
-0001ab10: 6c66 2e50 696c 655f 6d61 7374 6572 2e6c  lf.Pile_master.l
-0001ab20: 6973 745f 756e 6974 733a 0d0a 2020 2020  ist_units:..    
-0001ab30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab40: 2020 2020 2020 2020 2020 2020 5069 6c65              Pile
-0001ab50: 3d73 656c 662e 5069 6c65 5f6d 6173 7465  =self.Pile_maste
-0001ab60: 720d 0a0d 0a20 2020 2020 2020 2020 2020  r....           
+0001ab00: 2073 313d 735b 305d 2020 2320 756e 6974   s1=s[0]  # unit
+0001ab10: 206f 6620 696e 7465 7265 7374 2028 6669   of interest (fi
+0001ab20: 7273 7420 656c 656d 656e 7420 6973 2073  rst element is s
+0001ab30: 7472 6174 6920 6f62 6a65 6374 290d 0a0d  trati object)...
+0001ab40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ab50: 2020 2020 2020 2020 2020 2020 2023 2067               # g
+0001ab60: 6574 2070 696c 650d 0a20 2020 2020 2020  et pile..       
 0001ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ab80: 2069 6620 5069 6c65 2e6e 6174 7572 6520   if Pile.nature 
-0001ab90: 3d3d 2022 7375 7266 6163 6573 223a 0d0a  == "surfaces":..
-0001aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ab80: 2020 2020 2069 6620 7331 2e6d 756d 6d79       if s1.mummy
+0001ab90: 5f75 6e69 7420 6973 206e 6f74 204e 6f6e  _unit is not Non
+0001aba0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
 0001abb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001abc0: 6966 2028 6920 3d3d 2030 2920 616e 6420  if (i == 0) and 
-0001abd0: 2873 312e 6f72 6465 7220 3d3d 2031 293a  (s1.order == 1):
-0001abe0: 2020 2320 6669 7273 7420 756e 6974 2065    # first unit e
-0001abf0: 6e63 6f75 6e74 6572 6564 2069 7320 616c  ncountered is al
-0001ac00: 736f 2066 6972 7374 2075 6e69 7420 696e  so first unit in
-0001ac10: 2070 696c 650d 0a20 2020 2020 2020 2020   pile..         
-0001ac20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac30: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-0001ac40: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0001ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0001abc0: 2020 2020 5069 6c65 3d73 312e 6d75 6d6d      Pile=s1.mumm
+0001abd0: 795f 756e 6974 2e53 7562 5069 6c65 2020  y_unit.SubPile  
+0001abe0: 2320 4c69 6e6b 2077 6974 6820 7069 6c65  # Link with pile
+0001abf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ac00: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0001ac10: 6966 2073 3120 696e 2073 656c 662e 5069  if s1 in self.Pi
+0001ac20: 6c65 5f6d 6173 7465 722e 6c69 7374 5f75  le_master.list_u
+0001ac30: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
+0001ac40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac50: 2020 2020 2020 2050 696c 653d 7365 6c66         Pile=self
+0001ac60: 2e50 696c 655f 6d61 7374 6572 0d0a 0d0a  .Pile_master....
 0001ac70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac80: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-0001ac90: 6e5f 756e 6974 3d54 7275 6520 2023 2066  n_unit=True  # f
-0001aca0: 6c61 6720 746f 206b 6e6f 7720 6966 2061  lag to know if a
-0001acb0: 626f 7665 2075 6e69 7420 6973 204e 6f6e  bove unit is Non
-0001acc0: 6520 6f72 206e 6f74 0d0a 2020 2020 2020  e or not..      
-0001acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ace0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001acf0: 2069 203d 3d20 303a 2023 2066 6972 7374   i == 0: # first
-0001ad00: 2075 6e69 7420 696e 2074 6865 206c 6f67   unit in the log
-0001ad10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ad20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad30: 2020 2020 2020 2020 2020 735f 6162 6f76            s_abov
-0001ad40: 655f 6f72 6465 723d 3120 2023 2073 6563  e_order=1  # sec
-0001ad50: 6f6e 6420 756e 6974 2069 6e20 7069 6c65  ond unit in pile
-0001ad60: 2028 6669 7273 7420 6973 2069 676e 6f72   (first is ignor
-0001ad70: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+0001ac80: 2020 2020 2020 2020 2020 2020 6966 2050              if P
+0001ac90: 696c 652e 6e61 7475 7265 203d 3d20 2273  ile.nature == "s
+0001aca0: 7572 6661 6365 7322 3a0d 0a20 2020 2020  urfaces":..     
+0001acb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001acc0: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
+0001acd0: 203d 3d20 3029 2061 6e64 2028 7331 2e6f   == 0) and (s1.o
+0001ace0: 7264 6572 203d 3d20 3129 3a20 2023 2066  rder == 1):  # f
+0001acf0: 6972 7374 2075 6e69 7420 656e 636f 756e  irst unit encoun
+0001ad00: 7465 7265 6420 6973 2061 6c73 6f20 6669  tered is also fi
+0001ad10: 7273 7420 756e 6974 2069 6e20 7069 6c65  rst unit in pile
+0001ad20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad40: 2020 2020 2020 7061 7373 0d0a 0d0a 2020        pass....  
+0001ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ad60: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0001ad70: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
 0001ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ad90: 2020 2020 2020 2020 2020 2020 206e 6f6e               non
-0001ada0: 5f75 6e69 743d 4661 6c73 6520 2023 2066  _unit=False  # f
-0001adb0: 6c61 670d 0a0d 0a20 2020 2020 2020 2020  lag....         
-0001adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001add0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001ade0: 6920 3c3d 206c 656e 2862 682e 6c6f 675f  i <= len(bh.log_
-0001adf0: 7374 7261 7469 293a 2020 2320 6f74 6865  strati):  # othe
-0001ae00: 7273 2075 6e69 7473 2065 6e63 6f75 6e74  rs units encount
-0001ae10: 6572 6564 2065 7863 6570 7420 6669 7273  ered except firs
-0001ae20: 7420 6f6e 650d 0a20 2020 2020 2020 2020  t one..         
+0001ad90: 2020 2020 2020 2020 206e 6f6e 5f75 6e69           non_uni
+0001ada0: 743d 5472 7565 2020 2320 666c 6167 2074  t=True  # flag t
+0001adb0: 6f20 6b6e 6f77 2069 6620 6162 6f76 6520  o know if above 
+0001adc0: 756e 6974 2069 7320 4e6f 6e65 206f 7220  unit is None or 
+0001add0: 6e6f 740d 0a20 2020 2020 2020 2020 2020  not..           
+0001ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001adf0: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+0001ae00: 2030 3a20 2320 6669 7273 7420 756e 6974   0: # first unit
+0001ae10: 2069 6e20 7468 6520 6c6f 670d 0a20 2020   in the log..   
+0001ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ae40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ae50: 5f61 626f 7665 3d62 682e 6c6f 675f 7374  _above=bh.log_st
-0001ae60: 7261 7469 5b69 2d31 5d20 2023 2075 6e69  rati[i-1]  # uni
-0001ae70: 7420 6a75 7374 2061 626f 7665 2075 6e69  t just above uni
-0001ae80: 7420 6f66 2069 6e74 6572 6573 7420 696e  t of interest in
-0001ae90: 2062 680d 0a20 2020 2020 2020 2020 2020   bh..           
-0001aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aeb0: 2020 2020 2020 2020 2020 2020 2023 2063               # c
-0001aec0: 6865 636b 2061 626f 7665 2069 7320 6e6f  heck above is no
-0001aed0: 7420 4e6f 6e65 0d0a 2020 2020 2020 2020  t None..        
-0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af00: 6966 2073 5f61 626f 7665 5b30 5d20 6973  if s_above[0] is
-0001af10: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0001af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af40: 2020 2020 2020 2020 735f 6162 6f76 655f          s_above_
-0001af50: 6f72 6465 723d 735f 6162 6f76 655b 305d  order=s_above[0]
-0001af60: 2e6f 7264 6572 0d0a 2020 2020 2020 2020  .order..        
-0001af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af90: 2020 2020 6e6f 6e5f 756e 6974 3d46 616c      non_unit=Fal
-0001afa0: 7365 2020 2320 666c 6167 0d0a 0d0a 2020  se  # flag....  
+0001ae40: 2020 2020 2073 5f61 626f 7665 5f6f 7264       s_above_ord
+0001ae50: 6572 3d31 2020 2320 7365 636f 6e64 2075  er=1  # second u
+0001ae60: 6e69 7420 696e 2070 696c 6520 2866 6972  nit in pile (fir
+0001ae70: 7374 2069 7320 6967 6e6f 7265 6429 0d0a  st is ignored)..
+0001ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ae90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aea0: 2020 2020 2020 2020 6e6f 6e5f 756e 6974          non_unit
+0001aeb0: 3d46 616c 7365 2020 2320 666c 6167 0d0a  =False  # flag..
+0001aec0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001aed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aee0: 2020 2020 2020 656c 6966 2069 203c 3d20        elif i <= 
+0001aef0: 6c65 6e28 6268 2e6c 6f67 5f73 7472 6174  len(bh.log_strat
+0001af00: 6929 3a20 2023 206f 7468 6572 7320 756e  i):  # others un
+0001af10: 6974 7320 656e 636f 756e 7465 7265 6420  its encountered 
+0001af20: 6578 6365 7074 2066 6972 7374 206f 6e65  except first one
+0001af30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001af50: 2020 2020 2020 2020 2020 735f 6162 6f76            s_abov
+0001af60: 653d 6268 2e6c 6f67 5f73 7472 6174 695b  e=bh.log_strati[
+0001af70: 692d 315d 2020 2320 756e 6974 206a 7573  i-1]  # unit jus
+0001af80: 7420 6162 6f76 6520 756e 6974 206f 6620  t above unit of 
+0001af90: 696e 7465 7265 7374 2069 6e20 6268 0d0a  interest in bh..
+0001afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001afd0: 2020 6966 206e 6f6e 5f75 6e69 7420 3d3d    if non_unit ==
-0001afe0: 2046 616c 7365 3a0d 0a20 2020 2020 2020   False:..       
+0001afc0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+0001afd0: 6162 6f76 6520 6973 206e 6f74 204e 6f6e  above is not Non
+0001afe0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
 0001aff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b010: 2069 6620 7331 2e63 6f6e 7461 6374 203d   if s1.contact =
-0001b020: 3d20 2263 6f6d 6622 3a0d 0a20 2020 2020  = "comf":..     
+0001b000: 2020 2020 2020 2020 2020 2069 6620 735f             if s_
+0001b010: 6162 6f76 655b 305d 2069 7320 6e6f 7420  above[0] is not 
+0001b020: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
 0001b030: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b050: 2020 2020 2020 2066 6f72 2069 6c20 696e         for il in
-0001b060: 2072 616e 6765 2873 5f61 626f 7665 5f6f   range(s_above_o
-0001b070: 7264 6572 2c20 7331 2e6f 7264 6572 2d31  rder, s1.order-1
-0001b080: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0b0: 2020 2020 7332 3d50 696c 652e 6c69 7374      s2=Pile.list
-0001b0c0: 5f75 6e69 7473 5b69 6c5d 0d0a 2020 2020  _units[il]..    
-0001b0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001b100: 322e 7375 7266 6163 652e 636f 6e74 6163  2.surface.contac
-0001b110: 7420 3d3d 2022 6572 6f64 6522 3a0d 0a20  t == "erode":.. 
-0001b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b050: 2020 2073 5f61 626f 7665 5f6f 7264 6572     s_above_order
+0001b060: 3d73 5f61 626f 7665 5b30 5d2e 6f72 6465  =s_above[0].orde
+0001b070: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
+0001b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b090: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001b0a0: 6f6e 5f75 6e69 743d 4661 6c73 6520 2023  on_unit=False  #
+0001b0b0: 2066 6c61 670d 0a0d 0a20 2020 2020 2020   flag....       
+0001b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b0d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b0e0: 6e6f 6e5f 756e 6974 203d 3d20 4661 6c73  non_unit == Fals
+0001b0f0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0001b100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b110: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001b120: 312e 636f 6e74 6163 7420 3d3d 2022 636f  1.contact == "co
+0001b130: 6d66 223a 0d0a 2020 2020 2020 2020 2020  mf":..          
 0001b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b150: 2020 2061 6464 5f63 6f6e 7461 6374 2873     add_contact(s
-0001b160: 322c 2062 682e 782c 2062 682e 792c 2073  2, bh.x, bh.y, s
-0001b170: 5b31 5d2c 2022 696e 6571 5f69 6e66 2229  [1], "ineq_inf")
-0001b180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b160: 2020 666f 7220 696c 2069 6e20 7261 6e67    for il in rang
+0001b170: 6528 735f 6162 6f76 655f 6f72 6465 722c  e(s_above_order,
+0001b180: 2073 312e 6f72 6465 722d 3129 3a0d 0a20   s1.order-1):.. 
 0001b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b1b0: 2020 656c 6966 2073 322e 7375 7266 6163    elif s2.surfac
-0001b1c0: 652e 636f 6e74 6163 7420 3d3d 2022 6f6e  e.contact == "on
-0001b1d0: 6c61 7022 3a0d 0a20 2020 2020 2020 2020  lap":..         
+0001b1b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001b1c0: 323d 5069 6c65 2e6c 6973 745f 756e 6974  2=Pile.list_unit
+0001b1d0: 735b 696c 5d0d 0a20 2020 2020 2020 2020  s[il]..         
 0001b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b200: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
-0001b210: 6f6e 7461 6374 2873 322c 2062 682e 782c  ontact(s2, bh.x,
-0001b220: 2062 682e 792c 2073 5b31 5d2c 2022 696e   bh.y, s[1], "in
-0001b230: 6571 5f73 7570 2229 0d0a 0d0a 2020 2020  eq_sup")....    
+0001b200: 2020 2020 2020 2069 6620 7332 2e73 7572         if s2.sur
+0001b210: 6661 6365 2e63 6f6e 7461 6374 203d 3d20  face.contact == 
+0001b220: 2265 726f 6465 223a 0d0a 2020 2020 2020  "erode":..      
+0001b230: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b260: 2020 2020 656c 6966 2073 312e 636f 6e74      elif s1.cont
-0001b270: 6163 7420 213d 2022 636f 6d66 223a 0d0a  act != "comf":..
-0001b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b250: 2020 2020 2020 2020 2020 2020 2020 6164                ad
+0001b260: 645f 636f 6e74 6163 7428 7332 2c20 6268  d_contact(s2, bh
+0001b270: 2e78 2c20 6268 2e79 2c20 735b 315d 2c20  .x, bh.y, s[1], 
+0001b280: 2269 6e65 715f 696e 6622 290d 0a20 2020  "ineq_inf")..   
 0001b290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2a0: 2020 2020 2020 2020 2020 2020 6572 6f64              erod
-0001b2b0: 5f6c 7374 3d5b 5d20 2023 206c 6973 7420  _lst=[]  # list 
-0001b2c0: 6f66 2065 726f 6465 2075 6e69 7473 0d0a  of erode units..
-0001b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2f0: 2020 2020 2020 2020 2020 2020 6572 6f64              erod
-0001b300: 5f6c 7374 5f32 3d5b 5d20 2023 206c 6973  _lst_2=[]  # lis
-0001b310: 7420 6f66 2065 726f 6465 2073 7572 6661  t of erode surfa
-0001b320: 6365 7320 286e 6f20 756e 6974 2c20 646f  ces (no unit, do
-0001b330: 6e27 7420 6861 7665 2076 6f6c 756d 6529  n't have volume)
-0001b340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b2b0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0001b2c0: 6620 7332 2e73 7572 6661 6365 2e63 6f6e  f s2.surface.con
+0001b2d0: 7461 6374 203d 3d20 226f 6e6c 6170 223a  tact == "onlap":
+0001b2e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b310: 2020 2020 2020 6164 645f 636f 6e74 6163        add_contac
+0001b320: 7428 7332 2c20 6268 2e78 2c20 6268 2e79  t(s2, bh.x, bh.y
+0001b330: 2c20 735b 315d 2c20 2269 6e65 715f 7375  , s[1], "ineq_su
+0001b340: 7022 290d 0a0d 0a20 2020 2020 2020 2020  p")....         
 0001b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b360: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001b370: 7220 696c 2069 6e20 7261 6e67 6528 735f  r il in range(s_
-0001b380: 6162 6f76 655f 6f72 6465 722c 2073 312e  above_order, s1.
-0001b390: 6f72 6465 722d 3129 3a20 2320 6368 6563  order-1): # chec
-0001b3a0: 6b20 6966 206f 7665 726c 6179 696e 6720  k if overlaying 
-0001b3b0: 6c61 7965 7273 2061 7265 2065 726f 6465  layers are erode
-0001b3c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b360: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001b370: 6c69 6620 7331 2e63 6f6e 7461 6374 2021  lif s1.contact !
+0001b380: 3d20 2263 6f6d 6622 3a0d 0a20 2020 2020  = "comf":..     
+0001b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b3b0: 2020 2020 2020 2065 726f 645f 6c73 743d         erod_lst=
+0001b3c0: 5b5d 2020 2320 6c69 7374 206f 6620 6572  []  # list of er
+0001b3d0: 6f64 6520 756e 6974 730d 0a20 2020 2020  ode units..     
 0001b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b3f0: 2020 7332 3d50 696c 652e 6c69 7374 5f75    s2=Pile.list_u
-0001b400: 6e69 7473 5b69 6c5d 0d0a 2020 2020 2020  nits[il]..      
-0001b410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b430: 2020 2020 2020 2020 2020 6966 2073 322e            if s2.
-0001b440: 7375 7266 6163 652e 636f 6e74 6163 7420  surface.contact 
-0001b450: 3d3d 2022 6572 6f64 6522 203a 0d0a 2020  == "erode" :..  
+0001b3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b400: 2020 2020 2020 2065 726f 645f 6c73 745f         erod_lst_
+0001b410: 323d 5b5d 2020 2320 6c69 7374 206f 6620  2=[]  # list of 
+0001b420: 6572 6f64 6520 7375 7266 6163 6573 2028  erode surfaces (
+0001b430: 6e6f 2075 6e69 742c 2064 6f6e 2774 2068  no unit, don't h
+0001b440: 6176 6520 766f 6c75 6d65 290d 0a20 2020  ave volume)..   
+0001b450: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b490: 2020 6966 2073 322e 636f 6e74 6163 7420    if s2.contact 
-0001b4a0: 3d3d 2022 6f6e 6c61 7022 3a0d 0a20 2020  == "onlap":..   
-0001b4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b470: 2020 2020 2020 2020 2066 6f72 2069 6c20           for il 
+0001b480: 696e 2072 616e 6765 2873 5f61 626f 7665  in range(s_above
+0001b490: 5f6f 7264 6572 2c20 7331 2e6f 7264 6572  _order, s1.order
+0001b4a0: 2d31 293a 2023 2063 6865 636b 2069 6620  -1): # check if 
+0001b4b0: 6f76 6572 6c61 7969 6e67 206c 6179 6572  overlaying layer
+0001b4c0: 7320 6172 6520 6572 6f64 650d 0a20 2020  s are erode..   
 0001b4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b4e0: 2020 2020 2065 726f 645f 6c73 742e 6170       erod_lst.ap
-0001b4f0: 7065 6e64 2873 3229 0d0a 2020 2020 2020  pend(s2)..      
-0001b500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b520: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001b530: 6966 2073 322e 636f 6e74 6163 7420 3d3d  if s2.contact ==
-0001b540: 2022 6572 6f64 6522 3a0d 0a20 2020 2020   "erode":..     
-0001b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4f0: 2020 2020 2020 2020 2020 2020 2073 323d               s2=
+0001b500: 5069 6c65 2e6c 6973 745f 756e 6974 735b  Pile.list_units[
+0001b510: 696c 5d0d 0a20 2020 2020 2020 2020 2020  il]..           
+0001b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b540: 2020 2020 2069 6620 7332 2e73 7572 6661       if s2.surfa
+0001b550: 6365 2e63 6f6e 7461 6374 203d 3d20 2265  ce.contact == "e
+0001b560: 726f 6465 2220 3a0d 0a20 2020 2020 2020  rode" :..       
 0001b570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b580: 2020 2065 726f 645f 6c73 745f 322e 6170     erod_lst_2.ap
-0001b590: 7065 6e64 2873 3229 0d0a 0d0a 2020 2020  pend(s2)....    
-0001b5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b5c0: 2020 2020 2020 2020 6966 2065 726f 645f          if erod_
-0001b5d0: 6c73 743a 2020 2320 6966 2061 7420 6c65  lst:  # if at le
-0001b5e0: 6173 7420 6f6e 6520 6572 6f64 6520 6c61  ast one erode la
-0001b5f0: 7965 7220 6578 6973 7473 2061 626f 7665  yer exists above
-0001b600: 202d 2d3e 2061 6464 2065 7175 616c 6974   --> add equalit
-0001b610: 7920 706f 696e 7420 746f 2065 726f 6465  y point to erode
-0001b620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b650: 2020 7332 3d6d 696e 2865 726f 645f 6c73    s2=min(erod_ls
-0001b660: 7429 2020 2320 7365 6c65 6374 2068 6967  t)  # select hig
-0001b670: 6865 7220 6f6e 650d 0a20 2020 2020 2020  her one..       
-0001b680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6a0: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-0001b6b0: 2030 3a20 2023 2066 6972 7374 2075 6e69   0:  # first uni
-0001b6c0: 7420 6174 2074 6f70 6f67 7261 7068 7920  t at topography 
-0001b6d0: 6d75 7374 2062 6520 696e 6571 5f69 6e66  must be ineq_inf
-0001b6e0: 202d 2d3e 2061 6c6c 2065 726f 7369 6f6e   --> all erosion
-0001b6f0: 7320 6d75 7374 2067 6f20 6162 6f76 650d  s must go above.
-0001b700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b730: 2020 2020 2061 6464 5f63 6f6e 7461 6374       add_contact
-0001b740: 2873 322c 2062 682e 782c 2062 682e 792c  (s2, bh.x, bh.y,
-0001b750: 2073 5b31 5d2c 2022 696e 6571 5f69 6e66   s[1], "ineq_inf
-0001b760: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0001b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b790: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0001b580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b590: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b5a0: 7332 2e63 6f6e 7461 6374 203d 3d20 226f  s2.contact == "o
+0001b5b0: 6e6c 6170 223a 0d0a 2020 2020 2020 2020  nlap":..        
+0001b5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5f0: 6572 6f64 5f6c 7374 2e61 7070 656e 6428  erod_lst.append(
+0001b600: 7332 290d 0a20 2020 2020 2020 2020 2020  s2)..           
+0001b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b630: 2020 2020 2020 2020 2065 6c69 6620 7332           elif s2
+0001b640: 2e63 6f6e 7461 6374 203d 3d20 2265 726f  .contact == "ero
+0001b650: 6465 223a 0d0a 2020 2020 2020 2020 2020  de":..          
+0001b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b680: 2020 2020 2020 2020 2020 2020 2020 6572                er
+0001b690: 6f64 5f6c 7374 5f32 2e61 7070 656e 6428  od_lst_2.append(
+0001b6a0: 7332 290d 0a0d 0a20 2020 2020 2020 2020  s2)....         
+0001b6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b6d0: 2020 2069 6620 6572 6f64 5f6c 7374 3a20     if erod_lst: 
+0001b6e0: 2023 2069 6620 6174 206c 6561 7374 206f   # if at least o
+0001b6f0: 6e65 2065 726f 6465 206c 6179 6572 2065  ne erode layer e
+0001b700: 7869 7374 7320 6162 6f76 6520 2d2d 3e20  xists above --> 
+0001b710: 6164 6420 6571 7561 6c69 7479 2070 6f69  add equality poi
+0001b720: 6e74 2074 6f20 6572 6f64 650d 0a20 2020  nt to erode..   
+0001b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b750: 2020 2020 2020 2020 2020 2020 2073 323d               s2=
+0001b760: 6d69 6e28 6572 6f64 5f6c 7374 2920 2023  min(erod_lst)  #
+0001b770: 2073 656c 6563 7420 6869 6768 6572 206f   select higher o
+0001b780: 6e65 0d0a 2020 2020 2020 2020 2020 2020  ne..            
+0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b7c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0001b7d0: 6464 5f63 6f6e 7461 6374 2873 322c 2062  dd_contact(s2, b
-0001b7e0: 682e 782c 2062 682e 792c 2073 5b31 5d2c  h.x, bh.y, s[1],
-0001b7f0: 2022 6571 7561 6c69 7479 2229 0d0a 0d0a   "equality")....
-0001b800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7b0: 2020 2020 6966 2069 203d 3d20 303a 2020      if i == 0:  
+0001b7c0: 2320 6669 7273 7420 756e 6974 2061 7420  # first unit at 
+0001b7d0: 746f 706f 6772 6170 6879 206d 7573 7420  topography must 
+0001b7e0: 6265 2069 6e65 715f 696e 6620 2d2d 3e20  be ineq_inf --> 
+0001b7f0: 616c 6c20 6572 6f73 696f 6e73 206d 7573  all erosions mus
+0001b800: 7420 676f 2061 626f 7665 0d0a 2020 2020  t go above..    
 0001b810: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b830: 6164 645f 636f 6e74 6163 7428 7331 2c20  add_contact(s1, 
-0001b840: 6268 2e78 2c20 6268 2e79 2c20 735b 315d  bh.x, bh.y, s[1]
-0001b850: 2c20 2269 6e65 715f 696e 6622 290d 0a0d  , "ineq_inf")...
-0001b860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b840: 6164 645f 636f 6e74 6163 7428 7332 2c20  add_contact(s2, 
+0001b850: 6268 2e78 2c20 6268 2e79 2c20 735b 315d  bh.x, bh.y, s[1]
+0001b860: 2c20 2269 6e65 715f 696e 6622 290d 0a20  , "ineq_inf").. 
 0001b870: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b890: 2023 2073 7570 706c 656d 656e 7461 7279   # supplementary
-0001b8a0: 2069 6e66 6f2c 206c 6179 6572 2061 626f   info, layer abo
-0001b8b0: 7665 2065 726f 7369 6f6e 206c 6179 6572  ve erosion layer
-0001b8c0: 206d 7573 7420 676f 2062 656c 6f77 2061   must go below a
-0001b8d0: 6e64 206f 7468 6572 2065 726f 7369 6f6e  nd other erosion
-0001b8e0: 206c 6179 6572 206d 7573 7420 676f 2061   layer must go a
-0001b8f0: 626f 7665 0d0a 2020 2020 2020 2020 2020  bove..          
-0001b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b890: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001b8a0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0001b8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8d0: 2020 2020 2020 2020 2020 6164 645f 636f            add_co
+0001b8e0: 6e74 6163 7428 7332 2c20 6268 2e78 2c20  ntact(s2, bh.x, 
+0001b8f0: 6268 2e79 2c20 735b 315d 2c20 2265 7175  bh.y, s[1], "equ
+0001b900: 616c 6974 7922 290d 0a0d 0a20 2020 2020  ality")....     
 0001b910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b920: 2020 2020 2020 666f 7220 696c 2069 6e20        for il in 
-0001b930: 7261 6e67 6528 735f 6162 6f76 655f 6f72  range(s_above_or
-0001b940: 6465 722c 2073 312e 6f72 6465 722d 3129  der, s1.order-1)
-0001b950: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b930: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
+0001b940: 6f6e 7461 6374 2873 312c 2062 682e 782c  ontact(s1, bh.x,
+0001b950: 2062 682e 792c 2073 5b31 5d2c 2022 696e   bh.y, s[1], "in
+0001b960: 6571 5f69 6e66 2229 0d0a 0d0a 2020 2020  eq_inf")....    
 0001b970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b980: 2020 2020 2020 2073 5f65 726f 643d 5069         s_erod=Pi
-0001b990: 6c65 2e6c 6973 745f 756e 6974 735b 696c  le.list_units[il
-0001b9a0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0001b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9d0: 2020 2020 2020 2069 6620 735f 6572 6f64         if s_erod
-0001b9e0: 2e6f 7264 6572 203c 2073 322e 6f72 6465  .order < s2.orde
-0001b9f0: 7220 616e 6420 6920 3e20 303a 2020 2320  r and i > 0:  # 
-0001ba00: 6e6f 6e20 6572 6f64 6564 206c 6179 6572  non eroded layer
-0001ba10: 7320 2d2d 3e20 6e6f 7420 6465 706f 7369  s --> not deposi
-0001ba20: 7465 6420 6120 6368 6563 6b65 720d 0a20  ted a checker.. 
-0001ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba60: 2020 2020 2020 2061 6464 5f63 6f6e 7461         add_conta
-0001ba70: 6374 2873 5f65 726f 642c 2062 682e 782c  ct(s_erod, bh.x,
-0001ba80: 2062 682e 792c 2073 5b31 5d2c 2022 696e   bh.y, s[1], "in
-0001ba90: 6571 5f73 7570 2229 0d0a 2020 2020 2020  eq_sup")..      
-0001baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b990: 2020 2020 2020 2020 2020 2020 2320 7375              # su
+0001b9a0: 7070 6c65 6d65 6e74 6172 7920 696e 666f  pplementary info
+0001b9b0: 2c20 6c61 7965 7220 6162 6f76 6520 6572  , layer above er
+0001b9c0: 6f73 696f 6e20 6c61 7965 7220 6d75 7374  osion layer must
+0001b9d0: 2067 6f20 6265 6c6f 7720 616e 6420 6f74   go below and ot
+0001b9e0: 6865 7220 6572 6f73 696f 6e20 6c61 7965  her erosion laye
+0001b9f0: 7220 6d75 7374 2067 6f20 6162 6f76 650d  r must go above.
+0001ba00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ba10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba30: 2066 6f72 2069 6c20 696e 2072 616e 6765   for il in range
+0001ba40: 2873 5f61 626f 7665 5f6f 7264 6572 2c20  (s_above_order, 
+0001ba50: 7331 2e6f 7264 6572 2d31 293a 0d0a 2020  s1.order-1):..  
+0001ba60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba90: 2020 735f 6572 6f64 3d50 696c 652e 6c69    s_erod=Pile.li
+0001baa0: 7374 5f75 6e69 7473 5b69 6c5d 0d0a 2020  st_units[il]..  
 0001bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bac0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001bad0: 2073 5f65 726f 642e 7375 7266 6163 652e   s_erod.surface.
-0001bae0: 636f 6e74 6163 7420 3d3d 2022 6572 6f64  contact == "erod
-0001baf0: 6522 3a0d 0a20 2020 2020 2020 2020 2020  e":..           
-0001bb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb20: 2020 2020 2020 2020 2020 2020 2061 6464               add
-0001bb30: 5f63 6f6e 7461 6374 2873 5f65 726f 642c  _contact(s_erod,
-0001bb40: 2062 682e 782c 2062 682e 792c 2073 5b31   bh.x, bh.y, s[1
-0001bb50: 5d2c 2022 696e 6571 5f69 6e66 2229 0d0a  ], "ineq_inf")..
-0001bb60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bb80: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001bb90: 6966 2065 726f 645f 6c73 745f 3220 616e  if erod_lst_2 an
-0001bba0: 6420 6c65 6e28 6572 6f64 5f6c 7374 2920  d len(erod_lst) 
-0001bbb0: 3d3d 2030 3a20 2023 206f 6e6c 7920 6572  == 0:  # only er
-0001bbc0: 6f64 6520 7375 7266 6163 6573 0d0a 2020  ode surfaces..  
-0001bbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bbf0: 2020 2020 2020 2020 2020 2020 2020 6c20                l 
-0001bc00: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+0001bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bae0: 2020 6966 2073 5f65 726f 642e 6f72 6465    if s_erod.orde
+0001baf0: 7220 3c20 7332 2e6f 7264 6572 2061 6e64  r < s2.order and
+0001bb00: 2069 203e 2030 3a20 2023 206e 6f6e 2065   i > 0:  # non e
+0001bb10: 726f 6465 6420 6c61 7965 7273 202d 2d3e  roded layers -->
+0001bb20: 206e 6f74 2064 6570 6f73 6974 6564 2061   not deposited a
+0001bb30: 2063 6865 636b 6572 0d0a 2020 2020 2020   checker..      
+0001bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bb70: 2020 6164 645f 636f 6e74 6163 7428 735f    add_contact(s_
+0001bb80: 6572 6f64 2c20 6268 2e78 2c20 6268 2e79  erod, bh.x, bh.y
+0001bb90: 2c20 735b 315d 2c20 2269 6e65 715f 7375  , s[1], "ineq_su
+0001bba0: 7022 290d 0a20 2020 2020 2020 2020 2020  p")..           
+0001bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bbd0: 2020 2020 2020 2020 2069 6620 735f 6572           if s_er
+0001bbe0: 6f64 2e73 7572 6661 6365 2e63 6f6e 7461  od.surface.conta
+0001bbf0: 6374 203d 3d20 2265 726f 6465 223a 0d0a  ct == "erode":..
+0001bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc30: 2020 2020 2020 2320 6361 7365 206e 6f20        # case no 
-0001bc40: 6572 6f73 696f 6e0d 0a20 2020 2020 2020  erosion..       
-0001bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bc70: 2020 2020 2020 2020 2063 6173 6520 3d20           case = 
-0001bc80: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-0001bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcb0: 2020 2020 6966 2069 203d 3d20 303a 0d0a      if i == 0:..
-0001bcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc30: 2020 2020 2020 2020 6164 645f 636f 6e74          add_cont
+0001bc40: 6163 7428 735f 6572 6f64 2c20 6268 2e78  act(s_erod, bh.x
+0001bc50: 2c20 6268 2e79 2c20 735b 315d 2c20 2269  , bh.y, s[1], "i
+0001bc60: 6e65 715f 696e 6622 290d 0a0d 0a20 2020  neq_inf")....   
+0001bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bc90: 2020 2020 2020 2020 2065 6c69 6620 6572           elif er
+0001bca0: 6f64 5f6c 7374 5f32 2061 6e64 206c 656e  od_lst_2 and len
+0001bcb0: 2865 726f 645f 6c73 7429 203d 3d20 303a  (erod_lst) == 0:
+0001bcc0: 2020 2320 6f6e 6c79 2065 726f 6465 2073    # only erode s
+0001bcd0: 7572 6661 6365 730d 0a20 2020 2020 2020  urfaces..       
 0001bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bcf0: 2020 2020 6361 7365 2e61 7070 656e 6428      case.append(
-0001bd00: 2873 312c 2022 696e 6571 5f69 6e66 2229  (s1, "ineq_inf")
-0001bd10: 2920 2023 2075 6e69 7420 6174 2074 6865  )  # unit at the
-0001bd20: 2074 6f70 6f67 7261 7068 7920 6d75 7374   topography must
-0001bd30: 2067 6f20 6162 6f76 6520 746f 706f 0d0a   go above topo..
-0001bd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd00: 2020 2020 2020 2020 206c 203d 205b 5d0d           l = [].
+0001bd10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd40: 2023 2063 6173 6520 6e6f 2065 726f 7369   # case no erosi
+0001bd50: 6f6e 0d0a 2020 2020 2020 2020 2020 2020  on..            
 0001bd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0001bd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bd80: 2020 2020 6361 7365 203d 205b 5d0d 0a20      case = [].. 
 0001bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bda0: 2020 2020 2020 2020 2020 2063 6173 652e             case.
-0001bdb0: 6170 7065 6e64 2828 7331 2c20 2265 7175  append((s1, "equ
-0001bdc0: 616c 6974 7922 2929 2020 2320 656c 7365  ality"))  # else
-0001bdd0: 2065 7175 616c 6974 790d 0a0d 0a20 2020   equality....   
+0001bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bdb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001bdc0: 6620 6920 3d3d 2030 3a0d 0a20 2020 2020  f i == 0:..     
+0001bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be00: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001be10: 2069 6c20 696e 2072 616e 6765 2873 5f61   il in range(s_a
-0001be20: 626f 7665 5f6f 7264 6572 2c20 7331 2e6f  bove_order, s1.o
-0001be30: 7264 6572 2d31 293a 2020 2320 6164 6420  rder-1):  # add 
-0001be40: 696e 6571 7561 6c69 7479 2073 7570 2074  inequality sup t
-0001be50: 6f20 6f74 6865 7220 6162 6f76 6520 6c61  o other above la
-0001be60: 7965 7273 0d0a 2020 2020 2020 2020 2020  yers..          
-0001be70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001be90: 2020 2020 2020 2020 2020 735f 3132 3d50            s_12=P
-0001bea0: 696c 652e 6c69 7374 5f75 6e69 7473 5b69  ile.list_units[i
-0001beb0: 6c5d 2020 2320 756e 6974 2061 626f 7665  l]  # unit above
-0001bec0: 2073 310d 0a20 2020 2020 2020 2020 2020   s1..           
-0001bed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bef0: 2020 2020 2020 2020 2069 6620 735f 3132           if s_12
-0001bf00: 2e73 7572 6661 6365 2e63 6f6e 7461 6374  .surface.contact
-0001bf10: 203d 3d20 226f 6e6c 6170 2220 616e 6420   == "onlap" and 
-0001bf20: 6920 3e20 303a 0d0a 2020 2020 2020 2020  i > 0:..        
-0001bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bf60: 6361 7365 2e61 7070 656e 6428 2873 5f31  case.append((s_1
-0001bf70: 322c 2022 696e 6571 5f73 7570 2229 290d  2, "ineq_sup")).
-0001bf80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bdf0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001be00: 6173 652e 6170 7065 6e64 2828 7331 2c20  ase.append((s1, 
+0001be10: 2269 6e65 715f 696e 6622 2929 2020 2320  "ineq_inf"))  # 
+0001be20: 756e 6974 2061 7420 7468 6520 746f 706f  unit at the topo
+0001be30: 6772 6170 6879 206d 7573 7420 676f 2061  graphy must go a
+0001be40: 626f 7665 2074 6f70 6f0d 0a20 2020 2020  bove topo..     
+0001be50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001be70: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001be80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001be90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001beb0: 2020 2020 2020 6361 7365 2e61 7070 656e        case.appen
+0001bec0: 6428 2873 312c 2022 6571 7561 6c69 7479  d((s1, "equality
+0001bed0: 2229 2920 2023 2065 6c73 6520 6571 7561  "))  # else equa
+0001bee0: 6c69 7479 0d0a 0d0a 2020 2020 2020 2020  lity....        
+0001bef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf10: 2020 2020 2020 2020 666f 7220 696c 2069          for il i
+0001bf20: 6e20 7261 6e67 6528 735f 6162 6f76 655f  n range(s_above_
+0001bf30: 6f72 6465 722c 2073 312e 6f72 6465 722d  order, s1.order-
+0001bf40: 3129 3a20 2023 2061 6464 2069 6e65 7175  1):  # add inequ
+0001bf50: 616c 6974 7920 7375 7020 746f 206f 7468  ality sup to oth
+0001bf60: 6572 2061 626f 7665 206c 6179 6572 730d  er above layers.
+0001bf70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bfb0: 2020 2020 2065 6c69 6620 735f 3132 2e63       elif s_12.c
-0001bfc0: 6f6e 7461 6374 203d 3d20 2265 726f 6465  ontact == "erode
-0001bfd0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0001bfa0: 2020 2020 2073 5f31 323d 5069 6c65 2e6c       s_12=Pile.l
+0001bfb0: 6973 745f 756e 6974 735b 696c 5d20 2023  ist_units[il]  #
+0001bfc0: 2075 6e69 7420 6162 6f76 6520 7331 0d0a   unit above s1..
+0001bfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c000: 2020 2020 2020 2020 2020 2020 6361 7365              case
-0001c010: 2e61 7070 656e 6428 2873 5f31 322c 2022  .append((s_12, "
-0001c020: 696e 6571 5f69 6e66 2229 290d 0a0d 0a20  ineq_inf")).... 
-0001c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c000: 2020 2020 6966 2073 5f31 322e 7375 7266      if s_12.surf
+0001c010: 6163 652e 636f 6e74 6163 7420 3d3d 2022  ace.contact == "
+0001c020: 6f6e 6c61 7022 2061 6e64 2069 203e 2030  onlap" and i > 0
+0001c030: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
 0001c040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c050: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001c060: 2e61 7070 656e 6428 6361 7365 2920 2020  .append(case)   
-0001c070: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0001c080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c060: 2020 2020 2020 2020 2020 2063 6173 652e             case.
+0001c070: 6170 7065 6e64 2828 735f 3132 2c20 2269  append((s_12, "i
+0001c080: 6e65 715f 7375 7022 2929 0d0a 2020 2020  neq_sup"))..    
 0001c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c0a0: 2020 2020 2020 2066 6f72 2065 7220 696e         for er in
-0001c0b0: 2065 726f 645f 6c73 745f 325b 3a3a 2d31   erod_lst_2[::-1
-0001c0c0: 5d20 3a20 2023 2063 6173 6573 206f 6620  ] :  # cases of 
-0001c0d0: 6572 6f73 696f 6e20 286f 6e65 2066 6f72  erosion (one for
-0001c0e0: 2065 6163 6820 6572 2e20 7375 7266 6163   each er. surfac
-0001c0f0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0001c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0c0: 656c 6966 2073 5f31 322e 636f 6e74 6163  elif s_12.contac
+0001c0d0: 7420 3d3d 2022 6572 6f64 6522 3a0d 0a20  t == "erode":.. 
+0001c0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c120: 2020 2020 2020 2020 6361 7365 203d 205b          case = [
-0001c130: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001c110: 2020 2020 2020 2063 6173 652e 6170 7065         case.appe
+0001c120: 6e64 2828 735f 3132 2c20 2269 6e65 715f  nd((s_12, "ineq_
+0001c130: 696e 6622 2929 0d0a 0d0a 2020 2020 2020  inf"))....      
 0001c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c160: 2020 2020 2020 2063 6173 652e 6170 7065         case.appe
-0001c170: 6e64 2828 6572 2c20 2265 7175 616c 6974  nd((er, "equalit
-0001c180: 7922 2929 0d0a 2020 2020 2020 2020 2020  y"))..          
+0001c160: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
+0001c170: 6e64 2863 6173 6529 2020 2020 2020 2020  nd(case)        
+0001c180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0001c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1b0: 2020 2020 2020 2020 2020 6361 7365 2e61            case.a
-0001c1c0: 7070 656e 6428 2873 312c 2022 696e 6571  ppend((s1, "ineq
-0001c1d0: 5f69 6e66 2229 290d 0a20 2020 2020 2020  _inf"))..       
-0001c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c200: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001c210: 2069 6c20 696e 2072 616e 6765 2873 5f61   il in range(s_a
-0001c220: 626f 7665 5f6f 7264 6572 2c20 7331 2e6f  bove_order, s1.o
-0001c230: 7264 6572 2d31 293a 0d0a 2020 2020 2020  rder-1):..      
+0001c1b0: 2020 666f 7220 6572 2069 6e20 6572 6f64    for er in erod
+0001c1c0: 5f6c 7374 5f32 5b3a 3a2d 315d 203a 2020  _lst_2[::-1] :  
+0001c1d0: 2320 6361 7365 7320 6f66 2065 726f 7369  # cases of erosi
+0001c1e0: 6f6e 2028 6f6e 6520 666f 7220 6561 6368  on (one for each
+0001c1f0: 2065 722e 2073 7572 6661 6365 290d 0a20   er. surface).. 
+0001c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c230: 2020 2063 6173 6520 3d20 5b5d 0d0a 2020     case = []..  
 0001c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c270: 2020 735f 6572 6f64 3d50 696c 652e 6c69    s_erod=Pile.li
-0001c280: 7374 5f75 6e69 7473 5b69 6c5d 0d0a 0d0a  st_units[il]....
-0001c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c270: 2020 6361 7365 2e61 7070 656e 6428 2865    case.append((e
+0001c280: 722c 2022 6571 7561 6c69 7479 2229 290d  r, "equality")).
+0001c290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001c2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c2c0: 2020 2020 2020 2020 6966 2073 5f65 726f          if s_ero
-0001c2d0: 642e 6f72 6465 7220 3c20 6572 2e6f 7264  d.order < er.ord
-0001c2e0: 6572 3a0d 0a20 2020 2020 2020 2020 2020  er:..           
+0001c2c0: 2020 2020 2063 6173 652e 6170 7065 6e64       case.append
+0001c2d0: 2828 7331 2c20 2269 6e65 715f 696e 6622  ((s1, "ineq_inf"
+0001c2e0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
 0001c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c320: 2069 6620 735f 6572 6f64 2e73 7572 6661   if s_erod.surfa
-0001c330: 6365 2e63 6f6e 7461 6374 203d 3d20 226f  ce.contact == "o
-0001c340: 6e6c 6170 223a 0d0a 2020 2020 2020 2020  nlap":..        
+0001c310: 2020 2020 2020 2020 666f 7220 696c 2069          for il i
+0001c320: 6e20 7261 6e67 6528 735f 6162 6f76 655f  n range(s_above_
+0001c330: 6f72 6465 722c 2073 312e 6f72 6465 722d  order, s1.order-
+0001c340: 3129 3a0d 0a20 2020 2020 2020 2020 2020  1):..           
 0001c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c380: 2020 2020 2020 2020 6361 7365 2e61 7070          case.app
-0001c390: 656e 6428 2873 5f65 726f 642c 2022 696e  end((s_erod, "in
-0001c3a0: 6571 5f73 7570 2229 290d 0a20 2020 2020  eq_sup"))..     
+0001c370: 2020 2020 2020 2020 2020 2020 2073 5f65               s_e
+0001c380: 726f 643d 5069 6c65 2e6c 6973 745f 756e  rod=Pile.list_un
+0001c390: 6974 735b 696c 5d0d 0a0d 0a20 2020 2020  its[il]....     
+0001c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c3e0: 2020 2020 2020 2065 6c69 6620 735f 6572         elif s_er
-0001c3f0: 6f64 2e73 7572 6661 6365 2e63 6f6e 7461  od.surface.conta
-0001c400: 6374 203d 3d20 2265 726f 6465 223a 0d0a  ct == "erode":..
+0001c3d0: 2020 2069 6620 735f 6572 6f64 2e6f 7264     if s_erod.ord
+0001c3e0: 6572 203c 2065 722e 6f72 6465 723a 0d0a  er < er.order:..
+0001c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c400: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c450: 6361 7365 2e61 7070 656e 6428 2873 5f65  case.append((s_e
-0001c460: 726f 642c 2022 696e 6571 5f69 6e66 2229  rod, "ineq_inf")
-0001c470: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001c420: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001c430: 5f65 726f 642e 7375 7266 6163 652e 636f  _erod.surface.co
+0001c440: 6e74 6163 7420 3d3d 2022 6f6e 6c61 7022  ntact == "onlap"
+0001c450: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4a0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001c4b0: 735f 6572 6f64 2e6f 7264 6572 203e 2065  s_erod.order > e
-0001c4c0: 722e 6f72 6465 7220 3a0d 0a20 2020 2020  r.order :..     
+0001c490: 2020 2063 6173 652e 6170 7065 6e64 2828     case.append((
+0001c4a0: 735f 6572 6f64 2c20 2269 6e65 715f 7375  s_erod, "ineq_su
+0001c4b0: 7022 2929 0d0a 2020 2020 2020 2020 2020  p"))..          
+0001c4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c500: 2020 2020 2020 2069 6620 735f 6572 6f64         if s_erod
-0001c510: 2e73 7572 6661 6365 2e63 6f6e 7461 6374  .surface.contact
-0001c520: 203d 3d20 2265 726f 6465 223a 0d0a 2020   == "erode":..  
+0001c4f0: 2020 656c 6966 2073 5f65 726f 642e 7375    elif s_erod.su
+0001c500: 7266 6163 652e 636f 6e74 6163 7420 3d3d  rface.contact ==
+0001c510: 2022 6572 6f64 6522 3a0d 0a20 2020 2020   "erode":..     
+0001c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c530: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c560: 2020 2020 2020 2020 2020 2020 2020 6361                ca
-0001c570: 7365 2e61 7070 656e 6428 2873 5f65 726f  se.append((s_ero
-0001c580: 642c 2022 696e 6571 5f69 6e66 2229 2920  d, "ineq_inf")) 
-0001c590: 2023 2065 726f 6465 206c 6179 6572 7320   # erode layers 
-0001c5a0: 6265 6c6f 7720 6572 2067 6f65 7320 6162  below er goes ab
-0001c5b0: 6f76 650d 0a0d 0a20 2020 2020 2020 2020  ove....         
-0001c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c5e0: 2020 2020 2020 2020 2020 206c 2e61 7070             l.app
-0001c5f0: 656e 6428 6361 7365 290d 0a20 2020 2020  end(case)..     
+0001c550: 2020 2020 2020 2020 2020 2063 6173 652e             case.
+0001c560: 6170 7065 6e64 2828 735f 6572 6f64 2c20  append((s_erod, 
+0001c570: 2269 6e65 715f 696e 6622 2929 0d0a 2020  "ineq_inf"))..  
+0001c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5b0: 2020 2020 2020 656c 6966 2073 5f65 726f        elif s_ero
+0001c5c0: 642e 6f72 6465 7220 3e20 6572 2e6f 7264  d.order > er.ord
+0001c5d0: 6572 203a 0d0a 2020 2020 2020 2020 2020  er :..          
+0001c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c620: 2020 2020 2020 2020 2020 2070 203d 206e             p = n
-0001c630: 702e 6f6e 6573 286c 656e 286c 2929 2a28  p.ones(len(l))*(
-0001c640: 312f 6c65 6e28 6c29 2920 2023 2075 7365  1/len(l))  # use
-0001c650: 7220 696e 7075 7420 3f20 0d0a 2020 2020  r input ? ..    
+0001c610: 2020 6966 2073 5f65 726f 642e 7375 7266    if s_erod.surf
+0001c620: 6163 652e 636f 6e74 6163 7420 3d3d 2022  ace.contact == "
+0001c630: 6572 6f64 6522 3a0d 0a20 2020 2020 2020  erode":..       
+0001c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c680: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001c690: 2e73 746f 5f68 642e 6170 7065 6e64 2828  .sto_hd.append((
-0001c6a0: 2862 682e 782c 2062 682e 792c 2073 5b31  (bh.x, bh.y, s[1
-0001c6b0: 5d29 2c20 6c2c 2070 2929 0d0a 0d0a 2020  ]), l, p))....  
-0001c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c670: 2020 2020 2020 2020 2063 6173 652e 6170           case.ap
+0001c680: 7065 6e64 2828 735f 6572 6f64 2c20 2269  pend((s_erod, "i
+0001c690: 6e65 715f 696e 6622 2929 2020 2320 6572  neq_inf"))  # er
+0001c6a0: 6f64 6520 6c61 7965 7273 2062 656c 6f77  ode layers below
+0001c6b0: 2065 7220 676f 6573 2061 626f 7665 0d0a   er goes above..
+0001c6c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0001c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c6e0: 2020 2020 2020 2020 2020 656c 6966 2065            elif e
-0001c6f0: 726f 645f 6c73 7420 616e 6420 6572 6f64  rod_lst and erod
-0001c700: 5f6c 7374 5f32 3a20 2023 2062 6f74 6820  _lst_2:  # both 
-0001c710: 2854 4f20 444f 290d 0a20 2020 2020 2020  (TO DO)..       
+0001c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c6f0: 2020 2020 2020 6c2e 6170 7065 6e64 2863        l.append(c
+0001c700: 6173 6529 0d0a 2020 2020 2020 2020 2020  ase)..          
+0001c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c740: 2020 2020 2020 2020 2070 6173 730d 0a0d           pass...
-0001c750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c770: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0001c780: 653a 2023 206e 6f20 6572 6f64 6520 6c61  e: # no erode la
-0001c790: 7965 7220 2d2d 3e20 6578 6163 7420 6461  yer --> exact da
-0001c7a0: 7461 206f 6e20 7375 7266 6163 6520 6f66  ta on surface of
-0001c7b0: 2069 6e74 6572 6573 7420 2873 3129 2061   interest (s1) a
-0001c7c0: 6e64 2069 6e65 7120 7375 7020 746f 206f  nd ineq sup to o
-0001c7d0: 7468 6572 7320 6162 6f76 650d 0a20 2020  thers above..   
+0001c730: 2020 2020 2020 7020 3d20 6e70 2e6f 6e65        p = np.one
+0001c740: 7328 6c65 6e28 6c29 292a 2831 2f6c 656e  s(len(l))*(1/len
+0001c750: 286c 2929 2020 2320 7573 6572 2069 6e70  (l))  # user inp
+0001c760: 7574 203f 200d 0a20 2020 2020 2020 2020  ut ? ..         
+0001c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c790: 2020 2020 2020 2073 656c 662e 7374 6f5f         self.sto_
+0001c7a0: 6864 2e61 7070 656e 6428 2828 6268 2e78  hd.append(((bh.x
+0001c7b0: 2c20 6268 2e79 2c20 735b 315d 292c 206c  , bh.y, s[1]), l
+0001c7c0: 2c20 7029 290d 0a0d 0a20 2020 2020 2020  , p))....       
+0001c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c800: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001c810: 6920 3d3d 2030 3a0d 0a20 2020 2020 2020  i == 0:..       
-0001c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c7f0: 2020 2020 2065 6c69 6620 6572 6f64 5f6c       elif erod_l
+0001c800: 7374 2061 6e64 2065 726f 645f 6c73 745f  st and erod_lst_
+0001c810: 323a 2020 2320 626f 7468 2028 544f 2044  2:  # both (TO D
+0001c820: 4f29 0d0a 2020 2020 2020 2020 2020 2020  O)..            
 0001c830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c840: 2020 2020 2020 2020 2020 2020 2061 6464               add
-0001c850: 5f63 6f6e 7461 6374 2873 312c 2062 682e  _contact(s1, bh.
-0001c860: 782c 2062 682e 792c 2073 5b31 5d2c 2022  x, bh.y, s[1], "
-0001c870: 696e 6571 5f69 6e66 2229 2020 2320 756e  ineq_inf")  # un
-0001c880: 6974 2061 7420 7468 6520 746f 706f 6772  it at the topogr
-0001c890: 6170 6879 206d 7573 7420 676f 2061 626f  aphy must go abo
-0001c8a0: 7665 2074 6f70 6f0d 0a20 2020 2020 2020  ve topo..       
-0001c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8d0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0001c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c850: 2020 2020 7061 7373 0d0a 0d0a 2020 2020      pass....    
+0001c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c880: 2020 2020 2020 2020 656c 7365 3a20 2320          else: # 
+0001c890: 6e6f 2065 726f 6465 206c 6179 6572 202d  no erode layer -
+0001c8a0: 2d3e 2065 7861 6374 2064 6174 6120 6f6e  -> exact data on
+0001c8b0: 2073 7572 6661 6365 206f 6620 696e 7465   surface of inte
+0001c8c0: 7265 7374 2028 7331 2920 616e 6420 696e  rest (s1) and in
+0001c8d0: 6571 2073 7570 2074 6f20 6f74 6865 7273  eq sup to others
+0001c8e0: 2061 626f 7665 0d0a 2020 2020 2020 2020   above..        
 0001c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c910: 2020 2020 6164 645f 636f 6e74 6163 7428      add_contact(
-0001c920: 7331 2c20 6268 2e78 2c20 6268 2e79 2c20  s1, bh.x, bh.y, 
-0001c930: 735b 315d 2c20 2265 7175 616c 6974 7922  s[1], "equality"
-0001c940: 2920 2023 2065 6c73 6520 6571 7561 6c69  )  # else equali
-0001c950: 7479 0d0a 0d0a 2020 2020 2020 2020 2020  ty....          
-0001c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c980: 2020 2020 2020 666f 7220 696c 2069 6e20        for il in 
-0001c990: 7261 6e67 6528 735f 6162 6f76 655f 6f72  range(s_above_or
-0001c9a0: 6465 722c 2073 312e 6f72 6465 722d 3129  der, s1.order-1)
-0001c9b0: 3a20 2320 6164 6420 696e 6571 7561 6c69  : # add inequali
-0001c9c0: 7479 2073 7570 2074 6f20 6f74 6865 7220  ty sup to other 
-0001c9d0: 6162 6f76 6520 6c61 7965 7273 0d0a 2020  above layers..  
-0001c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c910: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
+0001c920: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0001c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c950: 2020 2020 2020 2020 6164 645f 636f 6e74          add_cont
+0001c960: 6163 7428 7331 2c20 6268 2e78 2c20 6268  act(s1, bh.x, bh
+0001c970: 2e79 2c20 735b 315d 2c20 2269 6e65 715f  .y, s[1], "ineq_
+0001c980: 696e 6622 2920 2023 2075 6e69 7420 6174  inf")  # unit at
+0001c990: 2074 6865 2074 6f70 6f67 7261 7068 7920   the topography 
+0001c9a0: 6d75 7374 2067 6f20 6162 6f76 6520 746f  must go above to
+0001c9b0: 706f 0d0a 2020 2020 2020 2020 2020 2020  po..            
+0001c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c9e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
 0001c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ca00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca10: 2020 735f 3132 3d50 696c 652e 6c69 7374    s_12=Pile.list
-0001ca20: 5f75 6e69 7473 5b69 6c5d 2023 2075 6e69  _units[il] # uni
-0001ca30: 7420 6162 6f76 6520 7331 0d0a 2020 2020  t above s1..    
-0001ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ca70: 6966 2073 5f31 322e 7375 7266 6163 652e  if s_12.surface.
-0001ca80: 636f 6e74 6163 7420 3d3d 2022 6f6e 6c61  contact == "onla
-0001ca90: 7022 2061 6e64 2069 203e 2030 3a0d 0a20  p" and i > 0:.. 
-0001caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cad0: 2020 2020 2020 2061 6464 5f63 6f6e 7461         add_conta
-0001cae0: 6374 2873 5f31 322c 2062 682e 782c 2062  ct(s_12, bh.x, b
-0001caf0: 682e 792c 2073 5b31 5d2c 2022 696e 6571  h.y, s[1], "ineq
-0001cb00: 5f73 7570 2229 0d0a 0d0a 2020 2020 2020  _sup")....      
-0001cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb20: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001cb30: 7365 3a20 2023 2075 6e69 7420 6162 6f76  se:  # unit abov
-0001cb40: 6520 6973 2061 2067 6170 2020 544f 2044  e is a gap  TO D
-0001cb50: 4f20 746f 2075 7064 6174 6520 7769 7468  O to update with
-0001cb60: 206e 6577 2061 7070 726f 6163 680d 0a20   new approach.. 
-0001cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb90: 2020 2020 2020 2069 6620 6920 3d3d 2031         if i == 1
-0001cba0: 3a20 2023 2069 6620 7365 636f 6e64 2075  :  # if second u
-0001cbb0: 6e69 7420 696e 206c 6f67 2061 6e64 2061  nit in log and a
-0001cbc0: 626f 7665 2069 7320 4e6f 6e65 0d0a 2020  bove is None..  
+0001ca10: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001ca20: 6464 5f63 6f6e 7461 6374 2873 312c 2062  dd_contact(s1, b
+0001ca30: 682e 782c 2062 682e 792c 2073 5b31 5d2c  h.x, bh.y, s[1],
+0001ca40: 2022 6571 7561 6c69 7479 2229 2020 2320   "equality")  # 
+0001ca50: 656c 7365 2065 7175 616c 6974 790d 0a0d  else equality...
+0001ca60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca90: 2066 6f72 2069 6c20 696e 2072 616e 6765   for il in range
+0001caa0: 2873 5f61 626f 7665 5f6f 7264 6572 2c20  (s_above_order, 
+0001cab0: 7331 2e6f 7264 6572 2d31 293a 2023 2061  s1.order-1): # a
+0001cac0: 6464 2069 6e65 7175 616c 6974 7920 7375  dd inequality su
+0001cad0: 7020 746f 206f 7468 6572 2061 626f 7665  p to other above
+0001cae0: 206c 6179 6572 730d 0a20 2020 2020 2020   layers..       
+0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb10: 2020 2020 2020 2020 2020 2020 2073 5f31               s_1
+0001cb20: 323d 5069 6c65 2e6c 6973 745f 756e 6974  2=Pile.list_unit
+0001cb30: 735b 696c 5d20 2320 756e 6974 2061 626f  s[il] # unit abo
+0001cb40: 7665 2073 310d 0a20 2020 2020 2020 2020  ve s1..         
+0001cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb70: 2020 2020 2020 2020 2020 2069 6620 735f             if s_
+0001cb80: 3132 2e73 7572 6661 6365 2e63 6f6e 7461  12.surface.conta
+0001cb90: 6374 203d 3d20 226f 6e6c 6170 2220 616e  ct == "onlap" an
+0001cba0: 6420 6920 3e20 303a 0d0a 2020 2020 2020  d i > 0:..      
+0001cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cbf0: 2020 2020 2020 2020 2020 6164 645f 636f            add_co
-0001cc00: 6e74 6163 7428 7331 2c20 6268 2e78 2c20  ntact(s1, bh.x, 
-0001cc10: 6268 2e79 2c20 735b 315d 2c20 2269 6e65  bh.y, s[1], "ine
-0001cc20: 715f 696e 6622 2920 2023 2075 6e69 7420  q_inf")  # unit 
-0001cc30: 6d75 7374 2067 6f20 6162 6f76 650d 0a20  must go above.. 
-0001cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc60: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0001cc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbe0: 2020 6164 645f 636f 6e74 6163 7428 735f    add_contact(s_
+0001cbf0: 3132 2c20 6268 2e78 2c20 6268 2e79 2c20  12, bh.x, bh.y, 
+0001cc00: 735b 315d 2c20 2269 6e65 715f 7375 7022  s[1], "ineq_sup"
+0001cc10: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0001cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc30: 2020 2020 2020 2020 2065 6c73 653a 2020           else:  
+0001cc40: 2320 756e 6974 2061 626f 7665 2069 7320  # unit above is 
+0001cc50: 6120 6761 7020 2054 4f20 444f 2074 6f20  a gap  TO DO to 
+0001cc60: 7570 6461 7465 2077 6974 6820 6e65 7720  update with new 
+0001cc70: 6170 7072 6f61 6368 0d0a 2020 2020 2020  approach..      
 0001cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc90: 2020 2020 2020 2020 2020 735f 6761 703d            s_gap=
-0001cca0: 735f 6162 6f76 6520 2023 2073 746f 7265  s_above  # store
-0001ccb0: 2067 6170 2069 6e66 6f72 6d61 7469 6f6e   gap information
-0001ccc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cce0: 2020 2020 2020 2020 2020 2020 2020 735f                s_
-0001ccf0: 6162 6f76 653d 6268 2e6c 6f67 5f73 7472  above=bh.log_str
-0001cd00: 6174 695b 692d 325d 2020 2320 7461 6b65  ati[i-2]  # take
-0001cd10: 2075 6e69 7420 6162 6f76 6520 6761 700d   unit above gap.
-0001cd20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001cd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd40: 2020 2020 2020 2020 2020 2020 2073 5f61               s_a
-0001cd50: 626f 7665 5f6f 7264 6572 3d73 5f61 626f  bove_order=s_abo
-0001cd60: 7665 5b30 5d2e 6f72 6465 720d 0a0d 0a20  ve[0].order.... 
-0001cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cca0: 2020 6966 2069 203d 3d20 313a 2020 2320    if i == 1:  # 
+0001ccb0: 6966 2073 6563 6f6e 6420 756e 6974 2069  if second unit i
+0001ccc0: 6e20 6c6f 6720 616e 6420 6162 6f76 6520  n log and above 
+0001ccd0: 6973 204e 6f6e 650d 0a20 2020 2020 2020  is None..       
+0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd00: 2020 2020 2061 6464 5f63 6f6e 7461 6374       add_contact
+0001cd10: 2873 312c 2062 682e 782c 2062 682e 792c  (s1, bh.x, bh.y,
+0001cd20: 2073 5b31 5d2c 2022 696e 6571 5f69 6e66   s[1], "ineq_inf
+0001cd30: 2229 2020 2320 756e 6974 206d 7573 7420  ")  # unit must 
+0001cd40: 676f 2061 626f 7665 0d0a 2020 2020 2020  go above..      
+0001cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd70: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
 0001cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cd90: 2020 2020 2020 2020 2020 2065 726f 645f             erod_
-0001cda0: 6c73 743d 5b5d 0d0a 2020 2020 2020 2020  lst=[]..        
-0001cdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cdd0: 2020 2020 666f 7220 696c 2069 6e20 7261      for il in ra
-0001cde0: 6e67 6528 735f 6162 6f76 655f 6f72 6465  nge(s_above_orde
-0001cdf0: 722c 2073 312e 6f72 6465 722d 3129 3a20  r, s1.order-1): 
-0001ce00: 2023 2063 6865 636b 2069 6620 6f76 6572   # check if over
-0001ce10: 6c61 7969 6e67 206c 6179 6572 7320 6172  laying layers ar
-0001ce20: 6520 6572 6f64 650d 0a20 2020 2020 2020  e erode..       
+0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cda0: 2020 2020 2073 5f67 6170 3d73 5f61 626f       s_gap=s_abo
+0001cdb0: 7665 2020 2320 7374 6f72 6520 6761 7020  ve  # store gap 
+0001cdc0: 696e 666f 726d 6174 696f 6e0d 0a20 2020  information..   
+0001cdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdf0: 2020 2020 2020 2020 2073 5f61 626f 7665           s_above
+0001ce00: 3d62 682e 6c6f 675f 7374 7261 7469 5b69  =bh.log_strati[i
+0001ce10: 2d32 5d20 2023 2074 616b 6520 756e 6974  -2]  # take unit
+0001ce20: 2061 626f 7665 2067 6170 0d0a 2020 2020   above gap..    
 0001ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ce50: 2020 2020 2020 2020 2073 323d 5069 6c65           s2=Pile
-0001ce60: 2e6c 6973 745f 756e 6974 735b 696c 5d0d  .list_units[il].
-0001ce70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ce50: 2020 2020 2020 2020 735f 6162 6f76 655f          s_above_
+0001ce60: 6f72 6465 723d 735f 6162 6f76 655b 305d  order=s_above[0]
+0001ce70: 2e6f 7264 6572 0d0a 0d0a 2020 2020 2020  .order....      
 0001ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001ce90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cea0: 2069 6620 7332 2e73 7572 6661 6365 2e63   if s2.surface.c
-0001ceb0: 6f6e 7461 6374 203d 3d20 2265 726f 6465  ontact == "erode
-0001cec0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0001ced0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cef0: 2020 2020 2020 2020 6572 6f64 5f6c 7374          erod_lst
-0001cf00: 2e61 7070 656e 6428 7332 290d 0a0d 0a20  .append(s2).... 
-0001cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf30: 2020 2020 2020 2020 2020 2069 6620 6572             if er
-0001cf40: 6f64 5f6c 7374 3a20 2320 6966 2061 7420  od_lst: # if at 
-0001cf50: 6c65 6173 7420 6f6e 6520 6572 6f64 6520  least one erode 
-0001cf60: 6c61 7965 7220 6578 6973 7473 2061 626f  layer exists abo
-0001cf70: 7665 0d0a 2020 2020 2020 2020 2020 2020  ve..            
+0001cea0: 2020 2020 2020 6572 6f64 5f6c 7374 3d5b        erod_lst=[
+0001ceb0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ced0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001cee0: 6f72 2069 6c20 696e 2072 616e 6765 2873  or il in range(s
+0001cef0: 5f61 626f 7665 5f6f 7264 6572 2c20 7331  _above_order, s1
+0001cf00: 2e6f 7264 6572 2d31 293a 2020 2320 6368  .order-1):  # ch
+0001cf10: 6563 6b20 6966 206f 7665 726c 6179 696e  eck if overlayin
+0001cf20: 6720 6c61 7965 7273 2061 7265 2065 726f  g layers are ero
+0001cf30: 6465 0d0a 2020 2020 2020 2020 2020 2020  de..            
+0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf60: 2020 2020 7332 3d50 696c 652e 6c69 7374      s2=Pile.list
+0001cf70: 5f75 6e69 7473 5b69 6c5d 0d0a 2020 2020  _units[il]..    
 0001cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cfa0: 2020 2020 7332 3d6d 696e 2865 726f 645f      s2=min(erod_
-0001cfb0: 6c73 7429 2020 2320 7365 6c65 6374 2068  lst)  # select h
-0001cfc0: 6967 6865 7220 6f6e 650d 0a20 2020 2020  igher one..     
+0001cfa0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001cfb0: 322e 7375 7266 6163 652e 636f 6e74 6163  2.surface.contac
+0001cfc0: 7420 3d3d 2022 6572 6f64 6522 3a0d 0a20  t == "erode":.. 
 0001cfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cff0: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
-0001d000: 6f6e 7461 6374 2873 322c 2062 682e 782c  ontact(s2, bh.x,
-0001d010: 2062 682e 792c 2073 5b31 5d2c 207a 323d   bh.y, s[1], z2=
-0001d020: 735f 6761 705b 315d 2c20 7479 7065 3d22  s_gap[1], type="
-0001d030: 646f 7562 6c65 5f69 6e65 7122 2920 2023  double_ineq")  #
-0001d040: 2065 726f 6465 2073 7572 6661 6365 206d   erode surface m
-0001d050: 7573 7420 676f 2062 6574 7765 656e 2067  ust go between g
-0001d060: 6170 0d0a 2020 2020 2020 2020 2020 2020  ap..            
-0001d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d000: 2020 2065 726f 645f 6c73 742e 6170 7065     erod_lst.appe
+0001d010: 6e64 2873 3229 0d0a 0d0a 2020 2020 2020  nd(s2)....      
+0001d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d040: 2020 2020 2020 6966 2065 726f 645f 6c73        if erod_ls
+0001d050: 743a 2023 2069 6620 6174 206c 6561 7374  t: # if at least
+0001d060: 206f 6e65 2065 726f 6465 206c 6179 6572   one erode layer
+0001d070: 2065 7869 7374 7320 6162 6f76 650d 0a20   exists above.. 
 0001d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d090: 2020 2020 6164 645f 636f 6e74 6163 7428      add_contact(
-0001d0a0: 7331 2c20 6268 2e78 2c20 6268 2e79 2c20  s1, bh.x, bh.y, 
-0001d0b0: 735b 315d 2c20 2269 6e65 715f 696e 6622  s[1], "ineq_inf"
-0001d0c0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001d0b0: 323d 6d69 6e28 6572 6f64 5f6c 7374 2920  2=min(erod_lst) 
+0001d0c0: 2023 2073 656c 6563 7420 6869 6768 6572   # select higher
+0001d0d0: 206f 6e65 0d0a 2020 2020 2020 2020 2020   one..          
 0001d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0f0: 2020 2020 2023 2073 7570 706c 656d 656e       # supplemen
-0001d100: 7461 7279 2069 6e66 6f2c 206c 6179 6572  tary info, layer
-0001d110: 2061 626f 7665 2065 726f 7369 6f6e 206c   above erosion l
-0001d120: 6179 6572 206d 7573 7420 676f 2062 656c  ayer must go bel
-0001d130: 6f77 2061 6e64 206f 7468 6572 2065 726f  ow and other ero
-0001d140: 7369 6f6e 206c 6179 6572 206d 7573 7420  sion layer must 
-0001d150: 676f 2061 626f 7665 0d0a 2020 2020 2020  go above..      
-0001d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d100: 2020 2020 2020 6164 645f 636f 6e74 6163        add_contac
+0001d110: 7428 7332 2c20 6268 2e78 2c20 6268 2e79  t(s2, bh.x, bh.y
+0001d120: 2c20 735b 315d 2c20 7a32 3d73 5f67 6170  , s[1], z2=s_gap
+0001d130: 5b31 5d2c 2074 7970 653d 2264 6f75 626c  [1], type="doubl
+0001d140: 655f 696e 6571 2229 2020 2320 6572 6f64  e_ineq")  # erod
+0001d150: 6520 7375 7266 6163 6520 6d75 7374 2067  e surface must g
+0001d160: 6f20 6265 7477 6565 6e20 6761 700d 0a20  o between gap.. 
 0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d180: 2020 2020 2020 2020 2020 666f 7220 696c            for il
-0001d190: 2069 6e20 7261 6e67 6528 735f 6162 6f76   in range(s_abov
-0001d1a0: 655f 6f72 6465 722c 2073 312e 6f72 6465  e_order, s1.orde
-0001d1b0: 722d 3129 3a0d 0a20 2020 2020 2020 2020  r-1):..         
-0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d190: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001d1a0: 6464 5f63 6f6e 7461 6374 2873 312c 2062  dd_contact(s1, b
+0001d1b0: 682e 782c 2062 682e 792c 2073 5b31 5d2c  h.x, bh.y, s[1],
+0001d1c0: 2022 696e 6571 5f69 6e66 2229 0d0a 0d0a   "ineq_inf")....
 0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1e0: 2020 2020 2020 2020 2020 2073 5f65 726f             s_ero
-0001d1f0: 643d 5069 6c65 2e6c 6973 745f 756e 6974  d=Pile.list_unit
-0001d200: 735b 696c 5d0d 0a20 2020 2020 2020 2020  s[il]..         
-0001d210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d230: 2020 2020 2020 2020 2020 2069 6620 735f             if s_
-0001d240: 6572 6f64 2e6f 7264 6572 203c 2073 322e  erod.order < s2.
-0001d250: 6f72 6465 7220 616e 6420 6920 3e20 303a  order and i > 0:
-0001d260: 2020 2320 6e6f 6e20 6572 6f64 6564 206c    # non eroded l
-0001d270: 6179 6572 7320 2d2d 3e20 6e6f 7420 6465  ayers --> not de
-0001d280: 706f 7369 7465 6420 6120 6368 6563 6b65  posited a checke
-0001d290: 720d 0a20 2020 2020 2020 2020 2020 2020  r..             
-0001d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2c0: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
-0001d2d0: 6f6e 7461 6374 2873 5f65 726f 642c 2062  ontact(s_erod, b
-0001d2e0: 682e 782c 2062 682e 792c 2073 5b31 5d2c  h.x, bh.y, s[1],
-0001d2f0: 2022 696e 6571 5f73 7570 2229 0d0a 2020   "ineq_sup")..  
-0001d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d200: 2320 7375 7070 6c65 6d65 6e74 6172 7920  # supplementary 
+0001d210: 696e 666f 2c20 6c61 7965 7220 6162 6f76  info, layer abov
+0001d220: 6520 6572 6f73 696f 6e20 6c61 7965 7220  e erosion layer 
+0001d230: 6d75 7374 2067 6f20 6265 6c6f 7720 616e  must go below an
+0001d240: 6420 6f74 6865 7220 6572 6f73 696f 6e20  d other erosion 
+0001d250: 6c61 7965 7220 6d75 7374 2067 6f20 6162  layer must go ab
+0001d260: 6f76 650d 0a20 2020 2020 2020 2020 2020  ove..           
+0001d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d290: 2020 2020 2066 6f72 2069 6c20 696e 2072       for il in r
+0001d2a0: 616e 6765 2873 5f61 626f 7665 5f6f 7264  ange(s_above_ord
+0001d2b0: 6572 2c20 7331 2e6f 7264 6572 2d31 293a  er, s1.order-1):
+0001d2c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2f0: 2020 2020 2020 735f 6572 6f64 3d50 696c        s_erod=Pil
+0001d300: 652e 6c69 7374 5f75 6e69 7473 5b69 6c5d  e.list_units[il]
+0001d310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0001d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d330: 2020 656c 6966 2073 5f65 726f 642e 6f72    elif s_erod.or
-0001d340: 6465 7220 3e20 2873 322e 6f72 6465 7229  der > (s2.order)
-0001d350: 3a20 2023 206c 6179 6572 7320 6265 6c6f  :  # layers belo
-0001d360: 7720 6572 6f73 696f 6e20 686f 7269 7a6f  w erosion horizo
-0001d370: 6e20 2d2d 3e20 6d75 7374 2067 6f20 6162  n --> must go ab
-0001d380: 6f76 650d 0a20 2020 2020 2020 2020 2020  ove..           
-0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d340: 2020 2020 2020 6966 2073 5f65 726f 642e        if s_erod.
+0001d350: 6f72 6465 7220 3c20 7332 2e6f 7264 6572  order < s2.order
+0001d360: 2061 6e64 2069 203e 2030 3a20 2023 206e   and i > 0:  # n
+0001d370: 6f6e 2065 726f 6465 6420 6c61 7965 7273  on eroded layers
+0001d380: 202d 2d3e 206e 6f74 2064 6570 6f73 6974   --> not deposit
+0001d390: 6564 2061 2063 6865 636b 6572 0d0a 2020  ed a checker..  
 0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001d3c0: 735f 6572 6f64 2e73 7572 6661 6365 2e63  s_erod.surface.c
-0001d3d0: 6f6e 7461 6374 203d 3d20 2265 726f 6465  ontact == "erode
-0001d3e0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0001d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3d0: 2020 2020 2020 6164 645f 636f 6e74 6163        add_contac
+0001d3e0: 7428 735f 6572 6f64 2c20 6268 2e78 2c20  t(s_erod, bh.x, 
+0001d3f0: 6268 2e79 2c20 735b 315d 2c20 2269 6e65  bh.y, s[1], "ine
+0001d400: 715f 7375 7022 290d 0a20 2020 2020 2020  q_sup")..       
 0001d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d420: 6164 645f 636f 6e74 6163 7428 735f 6572  add_contact(s_er
-0001d430: 6f64 2c20 6268 2e78 2c20 6268 2e79 2c20  od, bh.x, bh.y, 
-0001d440: 735b 315d 2c20 2269 6e65 715f 696e 6622  s[1], "ineq_inf"
-0001d450: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d480: 2065 6c73 653a 2020 2320 6e6f 2065 726f   else:  # no ero
-0001d490: 6465 206c 6179 6572 0d0a 2020 2020 2020  de layer..      
+0001d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d430: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0001d440: 6620 735f 6572 6f64 2e6f 7264 6572 203e  f s_erod.order >
+0001d450: 2028 7332 2e6f 7264 6572 293a 2020 2320   (s2.order):  # 
+0001d460: 6c61 7965 7273 2062 656c 6f77 2065 726f  layers below ero
+0001d470: 7369 6f6e 2068 6f72 697a 6f6e 202d 2d3e  sion horizon -->
+0001d480: 206d 7573 7420 676f 2061 626f 7665 0d0a   must go above..
+0001d490: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4c0: 2020 2020 2020 2020 2020 6164 645f 636f            add_co
-0001d4d0: 6e74 6163 7428 7331 2c20 6268 2e78 2c20  ntact(s1, bh.x, 
-0001d4e0: 6268 2e79 2c20 735b 315d 2c20 7a32 3d73  bh.y, s[1], z2=s
-0001d4f0: 5f67 6170 5b31 5d2c 2074 7970 653d 2264  _gap[1], type="d
-0001d500: 6f75 626c 655f 696e 6571 2229 2020 2320  ouble_ineq")  # 
-0001d510: 7375 7266 6163 6520 6d75 7374 2067 6f20  surface must go 
-0001d520: 6265 7477 6565 6e20 6761 700d 0a0d 0a20  between gap.... 
-0001d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001d560: 2061 6464 2075 7070 6572 2062 6f75 6e64   add upper bound
-0001d570: 2074 6f20 6f74 6865 7220 6162 6f76 6520   to other above 
-0001d580: 756e 6974 7320 696e 2070 696c 650d 0a20  units in pile.. 
-0001d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001d5c0: 6f72 2069 6c20 696e 2072 616e 6765 2873  or il in range(s
-0001d5d0: 5f61 626f 7665 5f6f 7264 6572 2c20 7331  _above_order, s1
-0001d5e0: 2e6f 7264 6572 2d31 293a 2023 2061 6464  .order-1): # add
-0001d5f0: 2069 6e65 7175 616c 6974 7920 7375 7020   inequality sup 
-0001d600: 746f 206f 7468 6572 2061 626f 7665 206c  to other above l
-0001d610: 6179 6572 730d 0a20 2020 2020 2020 2020  ayers..         
-0001d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d640: 2020 2020 2020 2020 2020 2073 5f31 323d             s_12=
-0001d650: 5069 6c65 2e6c 6973 745f 756e 6974 735b  Pile.list_units[
-0001d660: 696c 5d20 2023 2075 6e69 7420 6162 6f76  il]  # unit abov
-0001d670: 6520 7331 0d0a 2020 2020 2020 2020 2020  e s1..          
-0001d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6a0: 2020 2020 2020 2020 2020 6966 2073 5f31            if s_1
-0001d6b0: 322e 7375 7266 6163 652e 636f 6e74 6163  2.surface.contac
-0001d6c0: 7420 3d3d 2022 6f6e 6c61 7022 2061 6e64  t == "onlap" and
-0001d6d0: 2069 203e 2030 3a0d 0a20 2020 2020 2020   i > 0:..       
-0001d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d710: 2061 6464 5f63 6f6e 7461 6374 2873 5f31   add_contact(s_1
-0001d720: 322c 2062 682e 782c 2062 682e 792c 2073  2, bh.x, bh.y, s
-0001d730: 5f67 6170 5b31 5d2c 2022 696e 6571 5f73  _gap[1], "ineq_s
-0001d740: 7570 2229 0d0a 0d0a 2020 2020 2020 2020  up")....        
-0001d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d760: 2020 2020 2020 2020 6966 2028 6920 3d3d          if (i ==
-0001d770: 206c 656e 2862 682e 6c6f 675f 7374 7261   len(bh.log_stra
-0001d780: 7469 292d 3129 2026 2028 7331 2e6f 7264  ti)-1) & (s1.ord
-0001d790: 6572 203c 2050 696c 652e 6c69 7374 5f75  er < Pile.list_u
-0001d7a0: 6e69 7473 5b2d 315d 2e6f 7264 6572 293a  nits[-1].order):
-0001d7b0: 2020 2320 6966 206c 6173 7420 756e 6974    # if last unit
-0001d7c0: 2069 7320 6e6f 7420 6c61 7374 2069 6e20   is not last in 
-0001d7d0: 7468 6520 7069 6c65 202d 2d3e 2062 656c  the pile --> bel
-0001d7e0: 6f77 206c 6179 6572 7320 6d75 7374 2067  ow layers must g
-0001d7f0: 6f20 6265 6c6f 770d 0a20 2020 2020 2020  o below..       
+0001d4c0: 2020 2020 2020 2020 6966 2073 5f65 726f          if s_ero
+0001d4d0: 642e 7375 7266 6163 652e 636f 6e74 6163  d.surface.contac
+0001d4e0: 7420 3d3d 2022 6572 6f64 6522 3a0d 0a20  t == "erode":.. 
+0001d4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d520: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
+0001d530: 6f6e 7461 6374 2873 5f65 726f 642c 2062  ontact(s_erod, b
+0001d540: 682e 782c 2062 682e 792c 2073 5b31 5d2c  h.x, bh.y, s[1],
+0001d550: 2022 696e 6571 5f69 6e66 2229 0d0a 0d0a   "ineq_inf")....
+0001d560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d580: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001d590: 3a20 2023 206e 6f20 6572 6f64 6520 6c61  :  # no erode la
+0001d5a0: 7965 720d 0a20 2020 2020 2020 2020 2020  yer..           
+0001d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5d0: 2020 2020 2061 6464 5f63 6f6e 7461 6374       add_contact
+0001d5e0: 2873 312c 2062 682e 782c 2062 682e 792c  (s1, bh.x, bh.y,
+0001d5f0: 2073 5b31 5d2c 207a 323d 735f 6761 705b   s[1], z2=s_gap[
+0001d600: 315d 2c20 7479 7065 3d22 646f 7562 6c65  1], type="double
+0001d610: 5f69 6e65 7122 2920 2023 2073 7572 6661  _ineq")  # surfa
+0001d620: 6365 206d 7573 7420 676f 2062 6574 7765  ce must go betwe
+0001d630: 656e 2067 6170 0d0a 0d0a 2020 2020 2020  en gap....      
+0001d640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d660: 2020 2020 2020 2020 2020 2320 6164 6420            # add 
+0001d670: 7570 7065 7220 626f 756e 6420 746f 206f  upper bound to o
+0001d680: 7468 6572 2061 626f 7665 2075 6e69 7473  ther above units
+0001d690: 2069 6e20 7069 6c65 0d0a 2020 2020 2020   in pile..      
+0001d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6c0: 2020 2020 2020 2020 2020 666f 7220 696c            for il
+0001d6d0: 2069 6e20 7261 6e67 6528 735f 6162 6f76   in range(s_abov
+0001d6e0: 655f 6f72 6465 722c 2073 312e 6f72 6465  e_order, s1.orde
+0001d6f0: 722d 3129 3a20 2320 6164 6420 696e 6571  r-1): # add ineq
+0001d700: 7561 6c69 7479 2073 7570 2074 6f20 6f74  uality sup to ot
+0001d710: 6865 7220 6162 6f76 6520 6c61 7965 7273  her above layers
+0001d720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d750: 2020 2020 2020 735f 3132 3d50 696c 652e        s_12=Pile.
+0001d760: 6c69 7374 5f75 6e69 7473 5b69 6c5d 2020  list_units[il]  
+0001d770: 2320 756e 6974 2061 626f 7665 2073 310d  # unit above s1.
+0001d780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7b0: 2020 2020 2069 6620 735f 3132 2e73 7572       if s_12.sur
+0001d7c0: 6661 6365 2e63 6f6e 7461 6374 203d 3d20  face.contact == 
+0001d7d0: 226f 6e6c 6170 2220 616e 6420 6920 3e20  "onlap" and i > 
+0001d7e0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0001d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d810: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001d820: 2069 6c20 696e 2072 616e 6765 2873 312e   il in range(s1.
-0001d830: 6f72 6465 722c 2050 696c 652e 6c69 7374  order, Pile.list
-0001d840: 5f75 6e69 7473 5b2d 315d 2e6f 7264 6572  _units[-1].order
-0001d850: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0001d810: 2020 2020 2020 2020 2020 2020 6164 645f              add_
+0001d820: 636f 6e74 6163 7428 735f 3132 2c20 6268  contact(s_12, bh
+0001d830: 2e78 2c20 6268 2e79 2c20 735f 6761 705b  .x, bh.y, s_gap[
+0001d840: 315d 2c20 2269 6e65 715f 7375 7022 290d  1], "ineq_sup").
+0001d850: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
 0001d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d870: 2020 2020 2020 2020 2020 2020 735f 3132              s_12
-0001d880: 3d50 696c 652e 6c69 7374 5f75 6e69 7473  =Pile.list_units
-0001d890: 5b69 6c5d 0d0a 0d0a 2020 2020 2020 2020  [il]....        
-0001d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8c0: 6164 645f 636f 6e74 6163 7428 735f 3132  add_contact(s_12
-0001d8d0: 2c20 6268 2e78 2c20 6268 2e79 2c20 6268  , bh.x, bh.y, bh
-0001d8e0: 2e7a 2d62 682e 6465 7074 682c 2022 696e  .z-bh.depth, "in
-0001d8f0: 6571 5f73 7570 2229 0d0a 0d0a 2020 2020  eq_sup")....    
-0001d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d910: 2020 2020 2020 2020 656c 6966 2050 696c          elif Pil
-0001d920: 652e 6e61 7475 7265 203d 3d20 2233 645f  e.nature == "3d_
-0001d930: 6361 7465 676f 7269 6361 6c22 3a0d 0a20  categorical":.. 
-0001d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d950: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001d960: 2320 6765 7420 746f 7020 616e 6420 626f  # get top and bo
-0001d970: 7474 6f6d 0d0a 2020 2020 2020 2020 2020  ttom..          
-0001d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d990: 2020 2020 2020 746f 7020 3d20 735b 315d        top = s[1]
-0001d9a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d870: 2020 2069 6620 2869 203d 3d20 6c65 6e28     if (i == len(
+0001d880: 6268 2e6c 6f67 5f73 7472 6174 6929 2d31  bh.log_strati)-1
+0001d890: 2920 2620 2873 312e 6f72 6465 7220 3c20  ) & (s1.order < 
+0001d8a0: 5069 6c65 2e6c 6973 745f 756e 6974 735b  Pile.list_units[
+0001d8b0: 2d31 5d2e 6f72 6465 7229 3a20 2023 2069  -1].order):  # i
+0001d8c0: 6620 6c61 7374 2075 6e69 7420 6973 206e  f last unit is n
+0001d8d0: 6f74 206c 6173 7420 696e 2074 6865 2070  ot last in the p
+0001d8e0: 696c 6520 2d2d 3e20 6265 6c6f 7720 6c61  ile --> below la
+0001d8f0: 7965 7273 206d 7573 7420 676f 2062 656c  yers must go bel
+0001d900: 6f77 0d0a 2020 2020 2020 2020 2020 2020  ow..            
+0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d920: 2020 2020 2020 2020 666f 7220 696c 2069          for il i
+0001d930: 6e20 7261 6e67 6528 7331 2e6f 7264 6572  n range(s1.order
+0001d940: 2c20 5069 6c65 2e6c 6973 745f 756e 6974  , Pile.list_unit
+0001d950: 735b 2d31 5d2e 6f72 6465 7229 3a0d 0a20  s[-1].order):.. 
+0001d960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d980: 2020 2020 2020 2073 5f31 323d 5069 6c65         s_12=Pile
+0001d990: 2e6c 6973 745f 756e 6974 735b 696c 5d0d  .list_units[il].
+0001d9a0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
 0001d9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d9c0: 2020 6966 2069 2021 3d20 6c65 6e28 6268    if i != len(bh
-0001d9d0: 2e6c 6f67 5f73 7472 6174 6929 202d 2031  .log_strati) - 1
-0001d9e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da00: 2020 2020 2020 2062 6f74 203d 2062 682e         bot = bh.
-0001da10: 6c6f 675f 7374 7261 7469 5b69 2b31 5d5b  log_strati[i+1][
-0001da20: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-0001da30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da40: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0001d9c0: 2020 2020 2020 2020 2020 2061 6464 5f63             add_c
+0001d9d0: 6f6e 7461 6374 2873 5f31 322c 2062 682e  ontact(s_12, bh.
+0001d9e0: 782c 2062 682e 792c 2062 682e 7a2d 6268  x, bh.y, bh.z-bh
+0001d9f0: 2e64 6570 7468 2c20 2269 6e65 715f 7375  .depth, "ineq_su
+0001da00: 7022 290d 0a0d 0a20 2020 2020 2020 2020  p")....         
+0001da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001da20: 2020 2065 6c69 6620 5069 6c65 2e6e 6174     elif Pile.nat
+0001da30: 7572 6520 3d3d 2022 3364 5f63 6174 6567  ure == "3d_categ
+0001da40: 6f72 6963 616c 223a 0d0a 2020 2020 2020  orical":..      
 0001da50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da60: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001da70: 6f74 203d 2062 682e 7a20 2d20 6268 2e64  ot = bh.z - bh.d
-0001da80: 6570 7468 0d0a 0d0a 2020 2020 2020 2020  epth....        
+0001da60: 2020 2020 2020 2020 2020 2323 2067 6574            ## get
+0001da70: 2074 6f70 2061 6e64 2062 6f74 746f 6d0d   top and bottom.
+0001da80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0001da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001daa0: 2020 2020 2020 2020 6966 2073 7465 7020          if step 
-0001dab0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-0001dac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dad0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001dae0: 6570 203d 2073 656c 662e 6765 745f 737a  ep = self.get_sz
-0001daf0: 2829 2023 2069 6e74 6572 7661 6c20 7370  () # interval sp
-0001db00: 6163 696e 6720 746f 2073 616d 706c 6520  acing to sample 
-0001db10: 6461 7461 0d0a 0d0a 2020 2020 2020 2020  data....        
-0001db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db30: 2020 2020 2020 2020 666f 7220 697a 2069          for iz i
-0001db40: 6e20 6e70 2e61 7261 6e67 6528 746f 702c  n np.arange(top,
-0001db50: 2062 6f74 2c20 2d73 7465 7029 3a0d 0a20   bot, -step):.. 
+0001daa0: 2074 6f70 203d 2073 5b31 5d0d 0a20 2020   top = s[1]..   
+0001dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dac0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001dad0: 6920 213d 206c 656e 2862 682e 6c6f 675f  i != len(bh.log_
+0001dae0: 7374 7261 7469 2920 2d20 313a 0d0a 2020  strati) - 1:..  
+0001daf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db10: 2020 626f 7420 3d20 6268 2e6c 6f67 5f73    bot = bh.log_s
+0001db20: 7472 6174 695b 692b 315d 5b31 5d0d 0a20  trati[i+1][1].. 
+0001db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001db50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
 0001db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db80: 2020 2073 312e 782e 6170 7065 6e64 2862     s1.x.append(b
-0001db90: 682e 7829 0d0a 2020 2020 2020 2020 2020  h.x)..          
+0001db70: 2020 2020 2020 2020 2020 626f 7420 3d20            bot = 
+0001db80: 6268 2e7a 202d 2062 682e 6465 7074 680d  bh.z - bh.depth.
+0001db90: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
 0001dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbb0: 2020 2020 2020 2020 2020 7331 2e79 2e61            s1.y.a
-0001dbc0: 7070 656e 6428 6268 2e79 290d 0a20 2020  ppend(bh.y)..   
+0001dbb0: 2020 2069 6620 7374 6570 2069 7320 4e6f     if step is No
+0001dbc0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
 0001dbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbf0: 2073 312e 7a2e 6170 7065 6e64 2869 7a29   s1.z.append(iz)
-0001dc00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0001dc10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001dc20: 3a20 2023 2069 6620 7468 6572 6520 6973  :  # if there is
-0001dc30: 2061 2067 6170 2069 676e 6f72 6520 616e   a gap ignore an
-0001dc40: 6420 7061 7373 0d0a 2020 2020 2020 2020  d pass..        
-0001dc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc60: 2020 2020 7061 7373 0d0a 0d0a 0d0a 2020      pass......  
-0001dc70: 2020 2020 2020 2020 2020 2320 636f 6d70            # comp
-0001dc80: 7574 6520 6469 7374 7269 6275 7469 6f6e  ute distribution
-0001dc90: 2066 6f72 2065 6163 6820 756e 6974 2069   for each unit i
-0001dca0: 6620 6e65 6365 7373 6172 790d 0a20 2020  f necessary..   
-0001dcb0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-0001dcc0: 6d70 7574 655f 6469 7374 7269 6275 7469  mpute_distributi
-0001dcd0: 6f6e 2829 0d0a 0d0a 2020 2020 2020 2020  on()....        
-0001dce0: 2020 2020 7365 6c66 2e62 6873 5f70 726f      self.bhs_pro
-0001dcf0: 6365 7373 6564 3d31 0d0a 2020 2020 2020  cessed=1..      
-0001dd00: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-0001dd10: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-0001dd20: 2020 2020 2020 2020 7072 696e 7428 2250          print("P
-0001dd30: 726f 6365 7373 696e 6720 656e 6465 6420  rocessing ended 
-0001dd40: 7375 6363 6573 7366 756c 6c79 2229 0d0a  successfully")..
-0001dd50: 2020 2020 2020 2020 656c 6966 2073 656c          elif sel
-0001dd60: 662e 6268 735f 7072 6f63 6573 7365 6420  f.bhs_processed 
-0001dd70: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
-0001dd80: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-0001dd90: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0001dda0: 2020 2020 2070 7269 6e74 2822 426f 7265       print("Bore
-0001ddb0: 686f 6c65 7320 616c 7265 6164 7920 7072  holes already pr
-0001ddc0: 6f63 6573 7365 6422 290d 0a0d 0a20 2020  ocessed")....   
-0001ddd0: 2064 6566 2063 6f6d 7075 7465 5f73 7572   def compute_sur
-0001dde0: 6628 7365 6c66 2c20 6e72 6561 6c3d 312c  f(self, nreal=1,
-0001ddf0: 2066 6c5f 746f 703d 5472 7565 2c20 726d   fl_top=True, rm
-0001de00: 5f72 6573 5f66 696c 6573 3d54 7275 6529  _res_files=True)
-0001de10: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0001de20: 0d0a 2020 2020 2020 2020 5065 7266 6f72  ..        Perfor
-0001de30: 6d73 2074 6865 2063 6f6d 7075 7461 7469  ms the computati
-0001de40: 6f6e 206f 6620 7468 6520 7375 7266 6163  on of the surfac
-0001de50: 6573 0d0a 0d0a 2020 2020 2020 2020 5061  es....        Pa
-0001de60: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0001de70: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a    ----------....
-0001de80: 2020 2020 2020 2020 6e72 6561 6c3a 2069          nreal: i
-0001de90: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
-0001dea0: 6e75 6d62 6572 206f 6620 7265 616c 697a  number of realiz
-0001deb0: 6174 696f 6e73 0d0a 2020 2020 2020 2020  ations..        
-0001dec0: 666c 5f74 6f70 3a20 626f 6f6c 0d0a 2020  fl_top: bool..  
-0001ded0: 2020 2020 2020 2020 2020 6173 7369 676e            assign
-0001dee0: 2066 6972 7374 206c 6179 6572 2074 6f20   first layer to 
-0001def0: 746f 7020 6f66 2074 6865 2064 6f6d 6169  top of the domai
-0001df00: 6e20 2854 7275 6520 6279 2064 6566 6175  n (True by defau
-0001df10: 6c74 290d 0a20 2020 2020 2020 2072 6d5f  lt)..        rm_
-0001df20: 7265 735f 6669 6c65 7320 3a20 626f 6f6c  res_files : bool
-0001df30: 0d0a 2020 2020 2020 2020 2020 2020 666c  ..            fl
-0001df40: 6167 2074 6f20 7265 6d6f 7665 2070 7265  ag to remove pre
-0001df50: 7669 6f75 7320 6578 6973 7469 6e67 2072  vious existing r
-0001df60: 6573 756c 7469 6e67 2066 696c 6573 2069  esulting files i
-0001df70: 6e20 776f 726b 696e 6720 6469 7265 6374  n working direct
-0001df80: 6f72 790d 0a0d 0a20 2020 2020 2020 2022  ory....        "
-0001df90: 2222 0d0a 0d0a 2020 2020 2020 2020 7374  ""....        st
-0001dfa0: 6172 743d 7469 6d65 2e74 696d 6528 290d  art=time.time().
-0001dfb0: 0a20 2020 2020 2020 206e 702e 7261 6e64  .        np.rand
-0001dfc0: 6f6d 2e73 6565 6428 7365 6c66 2e73 6565  om.seed(self.see
-0001dfd0: 6429 2020 2320 7365 7420 7365 6564 0d0a  d)  # set seed..
-0001dfe0: 0d0a 0d0a 2020 2020 2020 2020 6966 206e  ....        if n
-0001dff0: 7265 616c 203d 3d20 303a 0d0a 2020 2020  real == 0:..    
-0001e000: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001e010: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0001e020: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0001e030: 2257 6172 6e69 6e67 3a20 6e72 6561 6c20  "Warning: nreal 
-0001e040: 6973 2073 6574 2074 6f20 302e 2229 0d0a  is set to 0.")..
-0001e050: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e060: 726e 0d0a 0d0a 2020 2020 2020 2020 6966  rn....        if
-0001e070: 2073 656c 662e 6268 735f 7072 6f63 6573   self.bhs_proces
-0001e080: 7365 6420 3d3d 2030 3a0d 0a20 2020 2020  sed == 0:..     
-0001e090: 2020 2020 2020 2070 7269 6e74 2822 426f         print("Bo
-0001e0a0: 7265 686f 6c65 7320 6e6f 7420 7072 6f63  reholes not proc
-0001e0b0: 6573 7365 642c 2066 756c 6c79 2075 6e63  essed, fully unc
-0001e0c0: 6f6e 6469 7469 6f6e 616c 2073 696d 756c  onditional simul
-0001e0d0: 6174 696f 6e73 2077 696c 6c20 6265 2074  ations will be t
-0001e0e0: 656d 7074 6564 2229 0d0a 2020 2020 2020  empted")..      
-0001e0f0: 2020 2361 7373 6572 7420 7365 6c66 2e62    #assert self.b
-0001e100: 6873 5f70 726f 6365 7373 6564 203d 3d20  hs_processed == 
-0001e110: 312c 2022 426f 7265 686f 6c65 7320 6e6f  1, "Boreholes no
-0001e120: 7420 7072 6f63 6573 7365 6422 0d0a 0d0a  t processed"....
-0001e130: 2020 2020 2020 2020 2320 6372 6561 7465          # create
-0001e140: 2077 6f72 6b20 6469 7265 6374 6f72 7920   work directory 
-0001e150: 6966 2069 7420 646f 6573 6e27 7420 6578  if it doesn't ex
-0001e160: 6973 740d 0a20 2020 2020 2020 2069 6620  ist..        if 
-0001e170: 7365 6c66 2e77 7320 6e6f 7420 696e 206f  self.ws not in o
-0001e180: 732e 6c69 7374 6469 7228 293a 0d0a 2020  s.listdir():..  
-0001e190: 2020 2020 2020 2020 2020 6f73 2e6d 6b64            os.mkd
-0001e1a0: 6972 2873 656c 662e 7773 290d 0a0d 0a20  ir(self.ws).... 
-0001e1b0: 2020 2020 2020 2023 2072 656d 6f76 6520         # remove 
-0001e1c0: 7072 6565 7869 7374 696e 6720 7265 7375  preexisting resu
-0001e1d0: 6c74 7320 6669 6c65 7320 696e 2077 730d  lts files in ws.
-0001e1e0: 0a20 2020 2020 2020 2069 6620 726d 5f72  .        if rm_r
-0001e1f0: 6573 5f66 696c 6573 3a0d 0a20 2020 2020  es_files:..     
-0001e200: 2020 2020 2020 2066 6f72 2066 696c 6520         for file 
-0001e210: 696e 206f 732e 6c69 7374 6469 7228 7365  in os.listdir(se
-0001e220: 6c66 2e77 7329 3a0d 0a20 2020 2020 2020  lf.ws):..       
-0001e230: 2020 2020 2020 2020 2069 6620 6669 6c65           if file
-0001e240: 2e73 706c 6974 2822 2e22 295b 2d31 5d20  .split(".")[-1] 
-0001e250: 696e 2028 2275 6e74 222c 2022 6661 6322  in ("unt", "fac"
-0001e260: 2c20 2270 726f 2229 3a0d 0a20 2020 2020  , "pro"):..     
-0001e270: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001e280: 7061 7468 3d6f 732e 7061 7468 2e6a 6f69  path=os.path.joi
-0001e290: 6e28 7365 6c66 2e77 732c 2066 696c 6529  n(self.ws, file)
-0001e2a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e2b0: 2020 2020 2020 6f73 2e72 656d 6f76 6528        os.remove(
-0001e2c0: 6670 6174 6829 0d0a 0d0a 2020 2020 2020  fpath)....      
-0001e2d0: 2020 7365 6c66 2e47 656f 6c2e 756e 6974    self.Geol.unit
-0001e2e0: 735f 646f 6d61 696e 733d 6e70 2e7a 6572  s_domains=np.zer
-0001e2f0: 6f73 285b 6e72 6561 6c2c 2073 656c 662e  os([nreal, self.
-0001e300: 6765 745f 6e7a 2829 2c20 7365 6c66 2e67  get_nz(), self.g
-0001e310: 6574 5f6e 7928 292c 2073 656c 662e 6765  et_ny(), self.ge
-0001e320: 745f 6e78 2829 5d2c 2064 7479 7065 3d6e  t_nx()], dtype=n
-0001e330: 702e 696e 7438 2920 2023 2069 6e69 7469  p.int8)  # initi
-0001e340: 616c 697a 6520 746d 7020 7265 7375 6c74  alize tmp result
-0001e350: 2061 7272 6179 0d0a 0d0a 2020 2020 2020   array....      
-0001e360: 2020 6966 2073 656c 662e 6368 6563 6b5f    if self.check_
-0001e370: 756e 6974 735f 4944 2829 2069 7320 4e6f  units_ID() is No
-0001e380: 6e65 3a20 2023 2063 6865 636b 2069 6620  ne:  # check if 
-0001e390: 756e 6974 7320 6861 7665 2063 6f72 7265  units have corre
-0001e3a0: 6374 2049 4473 0d0a 2020 2020 2020 2020  ct IDs..        
-0001e3b0: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
-0001e3c0: 0a20 2020 2020 2020 2073 656c 662e 6765  .        self.ge
-0001e3d0: 745f 7069 6c65 5f6d 6173 7465 7228 292e  t_pile_master().
-0001e3e0: 636f 6d70 7574 655f 7375 7266 2873 656c  compute_surf(sel
-0001e3f0: 662c 206e 7265 616c 2c20 666c 5f74 6f70  f, nreal, fl_top
-0001e400: 2c20 7662 3d73 656c 662e 7665 7262 6f73  , vb=self.verbos
-0001e410: 6529 2020 2320 636f 6d70 7574 6520 7375  e)  # compute su
-0001e420: 7266 7320 6f66 2074 6865 2066 6972 7374  rfs of the first
-0001e430: 2070 696c 650d 0a0d 0a20 2020 2020 2020   pile....       
-0001e440: 2023 2320 7374 6f63 6861 7374 6963 2068   ## stochastic h
-0001e450: 6172 6420 6461 7461 0d0a 2020 2020 2020  ard data..      
-0001e460: 2020 2368 6965 7261 7263 6869 6573 0d0a    #hierarchies..
-0001e470: 2020 2020 2020 2020 6465 6620 6675 6e28          def fun(
-0001e480: 7069 6c65 293a 2020 2320 636f 6d70 7574  pile):  # comput
-0001e490: 6520 7375 7266 2068 6965 7261 7263 6869  e surf hierarchi
-0001e4a0: 6361 6c6c 790d 0a20 2020 2020 2020 2020  cally..         
-0001e4b0: 2020 2069 3d30 0d0a 2020 2020 2020 2020     i=0..        
-0001e4c0: 2020 2020 666f 7220 756e 6974 2069 6e20      for unit in 
-0001e4d0: 7069 6c65 2e6c 6973 745f 756e 6974 733a  pile.list_units:
-0001e4e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e4f0: 2020 6966 2075 6e69 742e 665f 6d65 7468    if unit.f_meth
-0001e500: 6f64 203d 3d20 2253 7562 5069 6c65 223a  od == "SubPile":
-0001e510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001e520: 2020 2020 2020 6966 2075 6e69 742e 5375        if unit.Su
-0001e530: 6250 696c 652e 6e61 7475 7265 203d 3d20  bPile.nature == 
-0001e540: 2273 7572 6661 6365 7322 3a0d 0a0d 0a20  "surfaces":.... 
-0001e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e560: 2020 2020 2020 2074 6f70 733d 7365 6c66         tops=self
-0001e570: 2e47 656f 6c2e 7375 7266 6163 6573 5f62  .Geol.surfaces_b
-0001e580: 795f 7069 6c65 735b 7069 6c65 2e6e 616d  y_piles[pile.nam
-0001e590: 655d 5b3a 2c20 695d 0d0a 2020 2020 2020  e][:, i]..      
-0001e5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e5b0: 2020 626f 7473 3d73 656c 662e 4765 6f6c    bots=self.Geol
-0001e5c0: 2e73 7572 6661 6365 735f 626f 745f 6279  .surfaces_bot_by
-0001e5d0: 5f70 696c 6573 5b70 696c 652e 6e61 6d65  _piles[pile.name
-0001e5e0: 5d5b 3a2c 2069 5d0d 0a20 2020 2020 2020  ][:, i]..       
-0001e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e600: 2075 6e69 742e 5375 6250 696c 652e 636f   unit.SubPile.co
-0001e610: 6d70 7574 655f 7375 7266 2873 656c 662c  mpute_surf(self,
-0001e620: 206e 7265 616c 2c20 666c 5f74 6f70 3d54   nreal, fl_top=T
-0001e630: 7275 652c 2073 7562 7069 6c65 3d54 7275  rue, subpile=Tru
-0001e640: 652c 2074 6f70 733d 746f 7073 2c20 626f  e, tops=tops, bo
-0001e650: 7473 3d62 6f74 732c 2076 623d 7365 6c66  ts=bots, vb=self
-0001e660: 2e76 6572 626f 7365 290d 0a20 2020 2020  .verbose)..     
-0001e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e680: 2020 2066 756e 2875 6e69 742e 5375 6250     fun(unit.SubP
-0001e690: 696c 6529 0d0a 0d0a 2020 2020 2020 2020  ile)....        
-0001e6a0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0001e6b0: 2075 6e69 742e 5375 6250 696c 652e 6e61   unit.SubPile.na
-0001e6c0: 7475 7265 203d 3d20 2233 645f 6361 7465  ture == "3d_cate
-0001e6d0: 676f 7269 6361 6c22 3a0d 0a20 2020 2020  gorical":..     
-0001e6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e6f0: 2020 2075 6e69 742e 636f 6d70 7574 655f     unit.compute_
-0001e700: 6661 6369 6573 2873 656c 662c 206e 7265  facies(self, nre
-0001e710: 616c 3d31 2c20 6d6f 6465 3d22 756e 6974  al=1, mode="unit
-0001e720: 7322 2c20 7665 7262 6f73 653d 7365 6c66  s", verbose=self
-0001e730: 2e76 6572 626f 7365 290d 0a20 2020 2020  .verbose)..     
-0001e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e750: 2020 2066 756e 2875 6e69 742e 5375 6250     fun(unit.SubP
-0001e760: 696c 6529 0d0a 2020 2020 2020 2020 2020  ile)..          
-0001e770: 2020 2020 2020 6920 2b3d 2031 0d0a 0d0a        i += 1....
-0001e780: 2020 2020 2020 2020 6675 6e28 7365 6c66          fun(self
-0001e790: 2e67 6574 5f70 696c 655f 6d61 7374 6572  .get_pile_master
-0001e7a0: 2829 2920 2023 2072 756e 2066 756e 6374  ())  # run funct
-0001e7b0: 696f 6e0d 0a0d 0a20 2020 2020 2020 2069  ion....        i
-0001e7c0: 6620 7365 6c66 2e66 696c 6c5f 666c 6167  f self.fill_flag
-0001e7d0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0001e7e0: 656c 662e 6669 6c6c 5f74 6f70 5f75 6e69  elf.fill_top_uni
-0001e7f0: 7428 290d 0a0d 0a20 2020 2020 2020 2065  t()....        e
-0001e800: 6e64 3d74 696d 652e 7469 6d65 2829 0d0a  nd=time.time()..
-0001e810: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001e820: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0001e830: 2020 2020 2020 7072 696e 7428 225c 6e23        print("\n#
-0001e840: 2323 207b 7d3a 2054 6f74 616c 2074 696d  ## {}: Total tim
-0001e850: 6520 656c 6170 7365 6420 666f 7220 636f  e elapsed for co
-0001e860: 6d70 7574 696e 6720 7375 7266 6163 6573  mputing surfaces
-0001e870: 2023 2323 222e 666f 726d 6174 2865 6e64   ###".format(end
-0001e880: 202d 2073 7461 7274 2929 0d0a 0d0a 0d0a   - start))......
-0001e890: 2020 2020 2020 2020 2320 7772 6974 6520          # write 
-0001e8a0: 7265 7375 6c74 730d 0a20 2020 2020 2020  results..       
-0001e8b0: 2069 6620 7365 6c66 2e77 7269 7465 5f72   if self.write_r
-0001e8c0: 6573 756c 7473 3a0d 0a20 2020 2020 2020  esults:..       
-0001e8d0: 2020 2020 2075 6e69 7473 5f64 6f6d 6169       units_domai
-0001e8e0: 6e73 3d73 656c 662e 4765 6f6c 2e75 6e69  ns=self.Geol.uni
-0001e8f0: 7473 5f64 6f6d 6169 6e73 0d0a 2020 2020  ts_domains..    
-0001e900: 2020 2020 2020 2020 666f 7220 6972 6561          for irea
-0001e910: 6c20 696e 2072 616e 6765 286e 7265 616c  l in range(nreal
-0001e920: 293a 0d0a 0d0a 2020 2020 2020 2020 2020  ):....          
-0001e930: 2020 2020 2020 7564 3d75 6e69 7473 5f64        ud=units_d
-0001e940: 6f6d 6169 6e73 5b69 7265 616c 5d0d 0a20  omains[ireal].. 
-0001e950: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001e960: 6e61 6d65 3d73 656c 662e 6e61 6d65 2b22  name=self.name+"
-0001e970: 5f7b 7d2e 7564 222e 666f 726d 6174 2869  _{}.ud".format(i
-0001e980: 7265 616c 290d 0a20 2020 2020 2020 2020  real)..         
-0001e990: 2020 2020 2020 2066 7061 7468 3d6f 732e         fpath=os.
-0001e9a0: 7061 7468 2e6a 6f69 6e28 7365 6c66 2e77  path.join(self.w
-0001e9b0: 732c 2066 6e61 6d65 290d 0a20 2020 2020  s, fname)..     
-0001e9c0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0001e9d0: 6f70 656e 2866 7061 7468 2c20 2277 6222  open(fpath, "wb"
-0001e9e0: 2920 6173 2066 3a0d 0a20 2020 2020 2020  ) as f:..       
-0001e9f0: 2020 2020 2020 2020 2020 2020 2070 6963               pic
-0001ea00: 6b6c 652e 6475 6d70 2875 642c 2066 290d  kle.dump(ud, f).
-0001ea10: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0001ea20: 6465 6c65 7420 756e 6974 7320 646f 6d61  delet units doma
-0001ea30: 696e 7320 696e 2047 656f 6c20 6f62 6a65  ins in Geol obje
-0001ea40: 6374 2074 6f20 666f 7220 6d65 6d6f 7279  ct to for memory
-0001ea50: 2073 7061 6365 0d0a 2020 2020 2020 2020   space..        
-0001ea60: 2020 2020 6465 6c28 7365 6c66 2e47 656f      del(self.Geo
-0001ea70: 6c2e 756e 6974 735f 646f 6d61 696e 7329  l.units_domains)
-0001ea80: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-0001ea90: 2e73 7572 6661 6365 735f 636f 6d70 7574  .surfaces_comput
-0001eaa0: 6564 3d31 2020 2320 666c 6167 0d0a 0d0a  ed=1  # flag....
-0001eab0: 0d0a 2020 2020 6465 6620 6465 6669 6e65  ..    def define
-0001eac0: 5f64 6f6d 6169 6e73 2873 656c 662c 2073  _domains(self, s
-0001ead0: 7572 6661 6365 732c 2066 6c5f 746f 703d  urfaces, fl_top=
-0001eae0: 5472 7565 293a 0d0a 0d0a 2020 2020 2020  True):....      
-0001eaf0: 2020 2222 220d 0a20 2020 2020 2020 2050    """..        P
-0001eb00: 6572 666f 726d 7320 7468 6520 636f 6d70  erforms the comp
-0001eb10: 7574 6174 696f 6e20 6f66 2074 6865 2075  utation of the u
-0001eb20: 6e69 7473 2064 6f6d 6169 6e73 2077 6865  nits domains whe
-0001eb30: 6e20 7375 7266 6163 6573 2061 7265 2070  n surfaces are p
-0001eb40: 726f 7669 6465 640d 0a20 2020 2020 2020  rovided..       
-0001eb50: 200d 0a20 2020 2020 2020 2050 6172 616d   ..        Param
-0001eb60: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001eb70: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001eb80: 2020 2073 7572 6661 6365 7320 3a20 6469     surfaces : di
-0001eb90: 6374 696f 6e61 7279 206f 6620 7375 7266  ctionary of surf
-0001eba0: 6163 6573 2061 7320 7661 6c75 6573 2061  aces as values a
-0001ebb0: 6e64 2070 696c 6520 6e61 6d65 2061 7320  nd pile name as 
-0001ebc0: 6b65 790d 0a20 2020 2020 2020 2066 6c5f  key..        fl_
-0001ebd0: 746f 703a 2062 6f6f 6c0d 0a20 2020 2020  top: bool..     
-0001ebe0: 2020 2020 2020 2061 7373 6967 6e20 6669         assign fi
-0001ebf0: 7273 7420 6c61 7965 7220 746f 2074 6f70  rst layer to top
-0001ec00: 206f 6620 7468 6520 646f 6d61 696e 2028   of the domain (
-0001ec10: 5472 7565 2062 7920 6465 6661 756c 7429  True by default)
-0001ec20: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0001ec30: 0a0d 0a20 2020 2020 2020 2023 6e70 2e72  ...        #np.r
-0001ec40: 616e 646f 6d2e 7365 6564 2873 656c 662e  andom.seed(self.
-0001ec50: 7365 6564 2920 2023 2073 6574 2073 6565  seed)  # set see
-0001ec60: 640d 0a0d 0a20 2020 2020 2020 206e 7265  d....        nre
-0001ec70: 616c 203d 2073 7572 6661 6365 735b 7365  al = surfaces[se
-0001ec80: 6c66 2e67 6574 5f70 696c 655f 6d61 7374  lf.get_pile_mast
-0001ec90: 6572 2829 2e6e 616d 655d 2e73 6861 7065  er().name].shape
-0001eca0: 5b30 5d20 2023 2067 6574 206e 756d 6265  [0]  # get numbe
-0001ecb0: 7220 6f66 2072 6561 6c69 7a61 7469 6f6e  r of realization
-0001ecc0: 730d 0a20 2020 2020 2020 2073 656c 662e  s..        self.
-0001ecd0: 4765 6f6c 2e75 6e69 7473 5f64 6f6d 6169  Geol.units_domai
-0001ece0: 6e73 3d6e 702e 7a65 726f 7328 5b6e 7265  ns=np.zeros([nre
-0001ecf0: 616c 2c20 7365 6c66 2e67 6574 5f6e 7a28  al, self.get_nz(
-0001ed00: 292c 2073 656c 662e 6765 745f 6e79 2829  ), self.get_ny()
-0001ed10: 2c20 7365 6c66 2e67 6574 5f6e 7828 295d  , self.get_nx()]
-0001ed20: 2c20 6474 7970 653d 6e70 2e69 6e74 3829  , dtype=np.int8)
-0001ed30: 2020 2320 696e 6974 6961 6c69 7a65 2074    # initialize t
-0001ed40: 6d70 2072 6573 756c 7420 6172 7261 790d  mp result array.
-0001ed50: 0a0d 0a0d 0a20 2020 2020 2020 2069 6620  .....        if 
-0001ed60: 7365 6c66 2e63 6865 636b 5f75 6e69 7473  self.check_units
-0001ed70: 5f49 4428 2920 6973 204e 6f6e 653a 2020  _ID() is None:  
-0001ed80: 2320 6368 6563 6b20 6966 2075 6e69 7473  # check if units
-0001ed90: 2068 6176 6520 636f 7272 6563 7420 4944   have correct ID
-0001eda0: 730d 0a20 2020 2020 2020 2020 2020 2072  s..            r
-0001edb0: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
-0001edc0: 2020 2020 2020 7365 6c66 2e67 6574 5f70        self.get_p
-0001edd0: 696c 655f 6d61 7374 6572 2829 2e64 6566  ile_master().def
-0001ede0: 696e 655f 646f 6d61 696e 7328 7365 6c66  ine_domains(self
-0001edf0: 2c20 7375 7266 6163 6573 5b73 656c 662e  , surfaces[self.
-0001ee00: 6765 745f 7069 6c65 5f6d 6173 7465 7228  get_pile_master(
-0001ee10: 292e 6e61 6d65 5d2c 2076 623d 7365 6c66  ).name], vb=self
-0001ee20: 2e76 6572 626f 7365 2c20 666c 5f74 6f70  .verbose, fl_top
-0001ee30: 3d66 6c5f 746f 7029 0d0a 0d0a 2020 2020  =fl_top)....    
-0001ee40: 2020 2020 2368 6965 7261 7263 6869 6573      #hierarchies
-0001ee50: 0d0a 2020 2020 2020 2020 6465 6620 6675  ..        def fu
-0001ee60: 6e28 7069 6c65 293a 2020 2320 636f 6d70  n(pile):  # comp
-0001ee70: 7574 6520 7375 7266 2068 6965 7261 7263  ute surf hierarc
-0001ee80: 6869 6361 6c6c 790d 0a20 2020 2020 2020  hically..       
-0001ee90: 2020 2020 2069 3d30 0d0a 2020 2020 2020       i=0..      
-0001eea0: 2020 2020 2020 666f 7220 756e 6974 2069        for unit i
-0001eeb0: 6e20 7069 6c65 2e6c 6973 745f 756e 6974  n pile.list_unit
-0001eec0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-0001eed0: 2020 2020 6966 2075 6e69 742e 665f 6d65      if unit.f_me
-0001eee0: 7468 6f64 203d 3d20 2253 7562 5069 6c65  thod == "SubPile
-0001eef0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0001ef00: 2020 2020 2020 2020 746f 7073 3d73 7572          tops=sur
-0001ef10: 6661 6365 735b 7069 6c65 2e6e 616d 655d  faces[pile.name]
-0001ef20: 5b3a 2c20 695d 0d0a 2020 2020 2020 2020  [:, i]..        
-0001ef30: 2020 2020 2020 2020 2020 2020 626f 7473              bots
-0001ef40: 3d73 7572 6661 6365 735b 7069 6c65 2e6e  =surfaces[pile.n
-0001ef50: 616d 655d 5b3a 2c20 692b 315d 0d0a 2020  ame][:, i+1]..  
-0001ef60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef70: 2020 756e 6974 2e53 7562 5069 6c65 2e64    unit.SubPile.d
-0001ef80: 6566 696e 655f 646f 6d61 696e 7328 7365  efine_domains(se
-0001ef90: 6c66 2c20 7375 7266 6163 6573 5b75 6e69  lf, surfaces[uni
-0001efa0: 742e 5375 6250 696c 652e 6e61 6d65 5d2c  t.SubPile.name],
-0001efb0: 2066 6c5f 746f 703d 5472 7565 2c20 7375   fl_top=True, su
-0001efc0: 6270 696c 653d 5472 7565 2c20 746f 7073  bpile=True, tops
-0001efd0: 3d74 6f70 732c 2062 6f74 733d 626f 7473  =tops, bots=bots
-0001efe0: 2c20 7662 3d73 656c 662e 7665 7262 6f73  , vb=self.verbos
-0001eff0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0001f000: 2020 2020 2020 2020 6675 6e28 756e 6974          fun(unit
-0001f010: 2e53 7562 5069 6c65 290d 0a20 2020 2020  .SubPile)..     
-0001f020: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-0001f030: 310d 0a0d 0a20 2020 2020 2020 2066 756e  1....        fun
-0001f040: 2873 656c 662e 6765 745f 7069 6c65 5f6d  (self.get_pile_m
-0001f050: 6173 7465 7228 2929 2020 2320 7275 6e20  aster())  # run 
-0001f060: 6675 6e63 7469 6f6e 0d0a 0d0a 2020 2020  function....    
-0001f070: 2020 2020 7365 6c66 2e73 7572 6661 6365      self.surface
-0001f080: 735f 636f 6d70 7574 6564 3d31 2020 2320  s_computed=1  # 
-0001f090: 666c 6167 0d0a 0d0a 2020 2020 6465 6620  flag....    def 
-0001f0a0: 6669 6c6c 5f49 4428 7365 6c66 2c20 6172  fill_ID(self, ar
-0001f0b0: 722c 2049 443d 3029 3a0d 0a20 2020 200d  r, ID=0):..    .
-0001f0c0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001f0d0: 2020 2020 2020 4669 6c6c 2049 4420 7661        Fill ID va
-0001f0e0: 6c75 6573 2069 6e20 616e 2033 4420 6172  lues in an 3D ar
-0001f0f0: 7261 7920 6769 7665 6e20 7375 7272 6f75  ray given surrou
-0001f100: 6e64 696e 6773 2076 616c 7565 7320 7573  ndings values us
-0001f110: 696e 6720 6e65 6172 6573 7420 6e65 6967  ing nearest neig
-0001f120: 6862 6f72 730d 0a20 2020 2020 2020 200d  hbors..        .
-0001f130: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001f140: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0001f150: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001f160: 2061 7272 3a20 6e64 6172 7261 7920 6f66   arr: ndarray of
-0001f170: 2073 697a 6520 286e 7a2c 206e 792c 206e   size (nz, ny, n
-0001f180: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
-0001f190: 7369 6d75 6c61 7469 6f6e 2067 7269 6420  simulation grid 
-0001f1a0: 7369 7a65 0d0a 2020 2020 2020 2020 4944  size..        ID
-0001f1b0: 3a20 4944 0d0a 2020 2020 2020 2020 2020  : ID..          
-0001f1c0: 2020 4944 2074 6f20 7265 706c 6163 650d    ID to replace.
-0001f1d0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0001f1e0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0001f1f0: 2d2d 2d0d 0a20 2020 2020 2020 2061 7272  ---..        arr
-0001f200: 3a20 6e64 6172 7261 7920 6f66 2073 697a  : ndarray of siz
-0001f210: 6520 286e 7a2c 206e 792c 206e 7829 0d0a  e (nz, ny, nx)..
-0001f220: 2020 2020 2020 2020 2020 2020 7369 6d75              simu
-0001f230: 6c61 7469 6f6e 2067 7269 6420 7369 7a65  lation grid size
-0001f240: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-0001f250: 0a20 2020 2020 2020 206e 7820 3d20 7365  .        nx = se
-0001f260: 6c66 2e67 6574 5f6e 7828 290d 0a20 2020  lf.get_nx()..   
-0001f270: 2020 2020 206e 7920 3d20 7365 6c66 2e67       ny = self.g
-0001f280: 6574 5f6e 7928 290d 0a20 2020 2020 2020  et_ny()..       
-0001f290: 206e 7a20 3d20 7365 6c66 2e67 6574 5f6e   nz = self.get_n
-0001f2a0: 7a28 290d 0a0d 0a20 2020 2020 2020 2066  z()....        f
-0001f2b0: 726f 6d20 736b 6c65 6172 6e2e 6e65 6967  rom sklearn.neig
-0001f2c0: 6862 6f72 7320 696d 706f 7274 204e 6561  hbors import Nea
-0001f2d0: 7265 7374 4e65 6967 6862 6f72 730d 0a0d  restNeighbors...
-0001f2e0: 0a20 2020 2020 2020 2058 203d 206e 702e  .        X = np.
-0001f2f0: 6f6e 6573 285b 6e7a 2c20 6e79 2c20 6e78  ones([nz, ny, nx
-0001f300: 5d29 2a20 7365 6c66 2e78 6763 0d0a 2020  ])* self.xgc..  
-0001f310: 2020 2020 2020 5920 3d20 6e70 2e6f 6e65        Y = np.one
-0001f320: 7328 5b6e 7a2c 206e 792c 206e 785d 290d  s([nz, ny, nx]).
-0001f330: 0a20 2020 2020 2020 2059 5b3a 5d20 3d20  .        Y[:] = 
-0001f340: 6e70 2e6f 6e65 7328 5b6e 782c 206e 795d  np.ones([nx, ny]
-0001f350: 292e 5420 2a20 7365 6c66 2e79 6763 2e72  ).T * self.ygc.r
-0001f360: 6573 6861 7065 282d 312c 2031 290d 0a20  eshape(-1, 1).. 
-0001f370: 2020 2020 2020 205a 203d 206e 702e 6f6e         Z = np.on
-0001f380: 6573 285b 6e7a 2c20 6e79 2c20 6e78 5d29  es([nz, ny, nx])
-0001f390: 0d0a 2020 2020 2020 2020 5a5b 3a2c 203a  ..        Z[:, :
-0001f3a0: 5d20 3d28 206e 702e 6f6e 6573 285b 6e7a  ] =( np.ones([nz
-0001f3b0: 2c20 6e78 5d29 202a 2073 656c 662e 7a67  , nx]) * self.zg
-0001f3c0: 632e 7265 7368 6170 6528 2d31 2c20 3129  c.reshape(-1, 1)
-0001f3d0: 292e 7265 7368 6170 6528 6e7a 2c20 312c  ).reshape(nz, 1,
-0001f3e0: 206e 7829 0d0a 0d0a 2020 2020 2020 2020   nx)....        
-0001f3f0: 7875 3344 203d 206e 702e 6172 7261 7928  xu3D = np.array(
-0001f400: 5b58 2e66 6c61 7474 656e 2829 2c20 592e  [X.flatten(), Y.
-0001f410: 666c 6174 7465 6e28 292c 205a 2e66 6c61  flatten(), Z.fla
-0001f420: 7474 656e 2829 5d29 2e54 0d0a 0d0a 2020  tten()]).T....  
-0001f430: 2020 2020 2020 6d61 736b 203d 2028 6172        mask = (ar
-0001f440: 7220 213d 2049 4429 202a 2028 6172 7220  r != ID) * (arr 
-0001f450: 213d 2030 2920 2023 206d 6173 6b20 6f66  != 0)  # mask of
-0001f460: 2064 6174 610d 0a20 2020 2020 2020 2058   data..        X
-0001f470: 5f66 6974 203d 2078 7533 445b 6d61 736b  _fit = xu3D[mask
-0001f480: 2e66 6c61 7474 656e 2829 5d0d 0a20 2020  .flatten()]..   
-0001f490: 2020 2020 2079 5f66 6974 203d 2061 7272       y_fit = arr
-0001f4a0: 2e66 6c61 7474 656e 2829 5b6d 6173 6b2e  .flatten()[mask.
-0001f4b0: 666c 6174 7465 6e28 295d 0d0a 2020 2020  flatten()]..    
-0001f4c0: 2020 2020 6d61 736b 203d 2028 6172 7220      mask = (arr 
-0001f4d0: 3d3d 2049 4429 2020 2320 6d61 736b 2077  == ID)  # mask w
-0001f4e0: 6865 7265 2074 6f20 6669 6c6c 0d0a 0d0a  here to fill....
-0001f4f0: 2020 2020 2020 2020 6966 206d 6173 6b2e          if mask.
-0001f500: 616e 7928 293a 0d0a 2020 2020 2020 2020  any():..        
-0001f510: 2020 2020 585f 7072 6564 203d 2078 7533      X_pred = xu3
-0001f520: 445b 6d61 736b 2e66 6c61 7474 656e 2829  D[mask.flatten()
-0001f530: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-0001f540: 2023 2066 6974 0d0a 2020 2020 2020 2020   # fit..        
-0001f550: 2020 2020 6e6e 203d 204e 6561 7265 7374      nn = Nearest
-0001f560: 4e65 6967 6862 6f72 7328 6e5f 6e65 6967  Neighbors(n_neig
-0001f570: 6862 6f72 733d 3129 2e66 6974 2858 5f66  hbors=1).fit(X_f
-0001f580: 6974 290d 0a0d 0a20 2020 2020 2020 2020  it)....         
-0001f590: 2020 2023 7072 6564 0d0a 2020 2020 2020     #pred..      
-0001f5a0: 2020 2020 2020 7265 7320 3d20 6e6e 2e6b        res = nn.k
-0001f5b0: 6e65 6967 6862 6f72 7328 585f 7072 6564  neighbors(X_pred
-0001f5c0: 2c20 7265 7475 726e 5f64 6973 7461 6e63  , return_distanc
-0001f5d0: 653d 4661 6c73 652c 206e 5f6e 6569 6768  e=False, n_neigh
-0001f5e0: 626f 7273 3d31 290d 0a0d 0a20 2020 2020  bors=1)....     
-0001f5f0: 2020 2020 2020 2023 2061 7373 6967 6e0d         # assign.
-0001f600: 0a20 2020 2020 2020 2020 2020 2079 5f70  .            y_p
-0001f610: 7265 6420 3d20 795f 6669 745b 7265 735d  red = y_fit[res]
-0001f620: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-0001f630: 725f 7465 7374 203d 2061 7272 2e63 6f70  r_test = arr.cop
-0001f640: 7928 290d 0a20 2020 2020 2020 2020 2020  y()..           
-0001f650: 2061 7272 5f74 6573 745b 6d61 736b 5d20   arr_test[mask] 
-0001f660: 3d20 795f 7072 6564 5b3a 2c20 305d 2020  = y_pred[:, 0]  
-0001f670: 2320 7265 6173 7369 676e 2076 616c 7565  # reassign value
-0001f680: 730d 0a0d 0a20 2020 2020 2020 2072 6574  s....        ret
-0001f690: 7572 6e20 6172 725f 7465 7374 0d0a 0d0a  urn arr_test....
-0001f6a0: 0d0a 2020 2020 6465 6620 6669 6c6c 5f74  ..    def fill_t
-0001f6b0: 6f70 5f75 6e69 7428 7365 6c66 2c20 6d65  op_unit(self, me
-0001f6c0: 7468 6f64 203d 2022 6e65 6172 6573 745f  thod = "nearest_
-0001f6d0: 6e65 6967 6862 6f72 7322 293a 2020 2320  neighbors"):  # 
-0001f6e0: 746f 2072 656d 6f76 650d 0a20 2020 200d  to remove..    .
-0001f6f0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-0001f700: 2020 2020 2020 4675 6e63 7469 6f6e 2074        Function t
-0001f710: 6f20 6669 6c6c 2065 6163 6820 6365 6c6c  o fill each cell
-0001f720: 7320 7369 6d75 6c61 7465 6420 746f 7020  s simulated top 
-0001f730: 756e 6974 2067 6976 656e 2074 6865 6972  unit given their
-0001f740: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
-0001f750: 7572 2e0d 0a0d 0a20 2020 2020 2020 2050  ur.....        P
-0001f760: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0001f770: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0001f780: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
-0001f790: 7472 0d0a 2020 2020 2020 2020 2020 2020  tr..            
-0001f7a0: 6d65 7468 6f64 2074 6f20 6669 6c6c 2074  method to fill t
-0001f7b0: 6f70 2075 6e69 742e 2044 6566 6175 6c74  op unit. Default
-0001f7c0: 2069 7320 226e 6561 7265 7374 5f6e 6569   is "nearest_nei
-0001f7d0: 6768 626f 7273 220d 0a20 2020 2020 2020  ghbors"..       
-0001f7e0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
-0001f7f0: 6e78 203d 2073 656c 662e 6765 745f 6e78  nx = self.get_nx
-0001f800: 2829 0d0a 2020 2020 2020 2020 6e79 203d  ()..        ny =
-0001f810: 2073 656c 662e 6765 745f 6e79 2829 0d0a   self.get_ny()..
-0001f820: 2020 2020 2020 2020 6e7a 203d 2073 656c          nz = sel
-0001f830: 662e 6765 745f 6e7a 2829 0d0a 2020 2020  f.get_nz()..    
-0001f840: 2020 2020 0d0a 2020 2020 2020 2020 2320      ..        # 
-0001f850: 6765 7420 746f 7020 756e 6974 2049 440d  get top unit ID.
-0001f860: 0a20 2020 2020 2020 2074 6f70 5f75 6e69  .        top_uni
-0001f870: 7420 3d20 7365 6c66 2e67 6574 5f61 6c6c  t = self.get_all
-0001f880: 5f75 6e69 7473 2831 295b 305d 0d0a 2020  _units(1)[0]..  
-0001f890: 2020 2020 2020 4944 203d 2074 6f70 5f75        ID = top_u
-0001f8a0: 6e69 742e 4944 0d0a 2020 2020 2020 2020  nit.ID..        
-0001f8b0: 0d0a 2020 2020 2020 2020 6966 206d 6574  ..        if met
-0001f8c0: 686f 6420 3d3d 2022 6e65 6172 6573 745f  hod == "nearest_
-0001f8d0: 6e65 6967 6862 6f72 7322 3a0d 0a20 2020  neighbors":..   
-0001f8e0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-0001f8f0: 2020 2020 2020 2066 726f 6d20 736b 6c65         from skle
-0001f900: 6172 6e2e 6e65 6967 6862 6f72 7320 696d  arn.neighbors im
-0001f910: 706f 7274 204e 6561 7265 7374 4e65 6967  port NearestNeig
-0001f920: 6862 6f72 730d 0a20 2020 2020 2020 2020  hbors..         
-0001f930: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
-0001f940: 2058 203d 206e 702e 6f6e 6573 285b 6e7a   X = np.ones([nz
-0001f950: 2c20 6e79 2c20 6e78 5d29 2a20 7365 6c66  , ny, nx])* self
-0001f960: 2e78 6763 0d0a 2020 2020 2020 2020 2020  .xgc..          
-0001f970: 2020 5920 3d20 6e70 2e6f 6e65 7328 5b6e    Y = np.ones([n
-0001f980: 7a2c 206e 792c 206e 785d 290d 0a20 2020  z, ny, nx])..   
-0001f990: 2020 2020 2020 2020 2059 5b3a 5d20 3d20           Y[:] = 
-0001f9a0: 6e70 2e6f 6e65 7328 5b6e 782c 206e 795d  np.ones([nx, ny]
-0001f9b0: 292e 5420 2a20 7365 6c66 2e79 6763 2e72  ).T * self.ygc.r
-0001f9c0: 6573 6861 7065 282d 312c 2031 290d 0a20  eshape(-1, 1).. 
-0001f9d0: 2020 2020 2020 2020 2020 205a 203d 206e             Z = n
-0001f9e0: 702e 6f6e 6573 285b 6e7a 2c20 6e79 2c20  p.ones([nz, ny, 
-0001f9f0: 6e78 5d29 0d0a 2020 2020 2020 2020 2020  nx])..          
-0001fa00: 2020 5a5b 3a2c 203a 5d20 3d28 206e 702e    Z[:, :] =( np.
-0001fa10: 6f6e 6573 285b 6e7a 2c20 6e78 5d29 202a  ones([nz, nx]) *
-0001fa20: 2073 656c 662e 7a67 632e 7265 7368 6170   self.zgc.reshap
-0001fa30: 6528 2d31 2c20 3129 292e 7265 7368 6170  e(-1, 1)).reshap
-0001fa40: 6528 6e7a 2c20 312c 206e 7829 0d0a 0d0a  e(nz, 1, nx)....
-0001fa50: 2020 2020 2020 2020 2020 2020 7875 3344              xu3D
-0001fa60: 203d 206e 702e 6172 7261 7928 5b58 2e66   = np.array([X.f
-0001fa70: 6c61 7474 656e 2829 2c20 592e 666c 6174  latten(), Y.flat
-0001fa80: 7465 6e28 292c 205a 2e66 6c61 7474 656e  ten(), Z.flatten
-0001fa90: 2829 5d29 2e54 0d0a 2020 2020 2020 2020  ()]).T..        
-0001faa0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
-0001fab0: 2020 666f 7220 6975 2069 6e20 7261 6e67    for iu in rang
-0001fac0: 6528 7365 6c66 2e6e 7265 616c 5f75 6e69  e(self.nreal_uni
-0001fad0: 7473 293a 0d0a 2020 2020 2020 2020 2020  ts):..          
-0001fae0: 2020 2020 2020 6172 7220 3d20 7365 6c66        arr = self
-0001faf0: 2e67 6574 5f75 6e69 7473 5f64 6f6d 6169  .get_units_domai
-0001fb00: 6e73 5f72 6561 6c69 7a61 7469 6f6e 7328  ns_realizations(
-0001fb10: 6975 290d 0a20 2020 2020 2020 2020 2020  iu)..           
-0001fb20: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0001fb30: 2020 2020 2020 206d 6173 6b20 3d20 2861         mask = (a
-0001fb40: 7272 2021 3d20 4944 2920 2a20 2861 7272  rr != ID) * (arr
-0001fb50: 2021 3d20 3029 0d0a 2020 2020 2020 2020   != 0)..        
-0001fb60: 2020 2020 2020 2020 585f 6669 7420 3d20          X_fit = 
-0001fb70: 7875 3344 5b6d 6173 6b2e 666c 6174 7465  xu3D[mask.flatte
-0001fb80: 6e28 295d 0d0a 2020 2020 2020 2020 2020  n()]..          
-0001fb90: 2020 2020 2020 795f 6669 7420 3d20 6172        y_fit = ar
-0001fba0: 722e 666c 6174 7465 6e28 295b 6d61 736b  r.flatten()[mask
-0001fbb0: 2e66 6c61 7474 656e 2829 5d0d 0a20 2020  .flatten()]..   
-0001fbc0: 2020 2020 2020 2020 2020 2020 206d 6173               mas
-0001fbd0: 6b20 3d20 2861 7272 203d 3d20 4944 290d  k = (arr == ID).
+0001dbe0: 2020 2020 2020 2020 2073 7465 7020 3d20           step = 
+0001dbf0: 7365 6c66 2e67 6574 5f73 7a28 2920 2320  self.get_sz() # 
+0001dc00: 696e 7465 7276 616c 2073 7061 6369 6e67  interval spacing
+0001dc10: 2074 6f20 7361 6d70 6c65 2064 6174 610d   to sample data.
+0001dc20: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc40: 2020 2066 6f72 2069 7a20 696e 206e 702e     for iz in np.
+0001dc50: 6172 616e 6765 2874 6f70 2c20 626f 742c  arange(top, bot,
+0001dc60: 202d 7374 6570 293a 0d0a 2020 2020 2020   -step):..      
+0001dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc80: 2020 2020 2020 2020 2020 2020 2020 7331                s1
+0001dc90: 2e78 2e61 7070 656e 6428 6268 2e78 290d  .x.append(bh.x).
+0001dca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001dcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dcc0: 2020 2020 2073 312e 792e 6170 7065 6e64       s1.y.append
+0001dcd0: 2862 682e 7929 0d0a 2020 2020 2020 2020  (bh.y)..        
+0001dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dcf0: 2020 2020 2020 2020 2020 2020 7331 2e7a              s1.z
+0001dd00: 2e61 7070 656e 6428 697a 290d 0a0d 0a20  .append(iz).... 
+0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dd20: 2020 2020 2020 2065 6c73 653a 2020 2320         else:  # 
+0001dd30: 6966 2074 6865 7265 2069 7320 6120 6761  if there is a ga
+0001dd40: 7020 6967 6e6f 7265 2061 6e64 2070 6173  p ignore and pas
+0001dd50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+0001dd60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0001dd70: 6173 730d 0a0d 0a0d 0a20 2020 2020 2020  ass......       
+0001dd80: 2020 2020 2023 2063 6f6d 7075 7465 2064       # compute d
+0001dd90: 6973 7472 6962 7574 696f 6e20 666f 7220  istribution for 
+0001dda0: 6561 6368 2075 6e69 7420 6966 206e 6563  each unit if nec
+0001ddb0: 6573 7361 7279 0d0a 2020 2020 2020 2020  essary..        
+0001ddc0: 2020 2020 7365 6c66 2e63 6f6d 7075 7465      self.compute
+0001ddd0: 5f64 6973 7472 6962 7574 696f 6e28 290d  _distribution().
+0001dde0: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
+0001ddf0: 656c 662e 6268 735f 7072 6f63 6573 7365  elf.bhs_processe
+0001de00: 643d 310d 0a20 2020 2020 2020 2020 2020  d=1..           
+0001de10: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+0001de20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001de30: 2020 2070 7269 6e74 2822 5072 6f63 6573     print("Proces
+0001de40: 7369 6e67 2065 6e64 6564 2073 7563 6365  sing ended succe
+0001de50: 7373 6675 6c6c 7922 290d 0a20 2020 2020  ssfully")..     
+0001de60: 2020 2065 6c69 6620 7365 6c66 2e62 6873     elif self.bhs
+0001de70: 5f70 726f 6365 7373 6564 203d 3d20 313a  _processed == 1:
+0001de80: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001de90: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+0001dea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001deb0: 7072 696e 7428 2242 6f72 6568 6f6c 6573  print("Boreholes
+0001dec0: 2061 6c72 6561 6479 2070 726f 6365 7373   already process
+0001ded0: 6564 2229 0d0a 0d0a 2020 2020 6465 6620  ed")....    def 
+0001dee0: 636f 6d70 7574 655f 7375 7266 2873 656c  compute_surf(sel
+0001def0: 662c 206e 7265 616c 3d31 2c20 666c 5f74  f, nreal=1, fl_t
+0001df00: 6f70 3d54 7275 652c 2072 6d5f 7265 735f  op=True, rm_res_
+0001df10: 6669 6c65 733d 5472 7565 293a 0d0a 0d0a  files=True):....
+0001df20: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0001df30: 2020 2020 2050 6572 666f 726d 7320 7468       Performs th
+0001df40: 6520 636f 6d70 7574 6174 696f 6e20 6f66  e computation of
+0001df50: 2074 6865 2073 7572 6661 6365 730d 0a0d   the surfaces...
+0001df60: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001df70: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0001df80: 2d2d 2d2d 2d2d 2d0d 0a0d 0a20 2020 2020  -------....     
+0001df90: 2020 206e 7265 616c 3a20 696e 740d 0a20     nreal: int.. 
+0001dfa0: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+0001dfb0: 7220 6f66 2072 6561 6c69 7a61 7469 6f6e  r of realization
+0001dfc0: 730d 0a20 2020 2020 2020 2066 6c5f 746f  s..        fl_to
+0001dfd0: 703a 2062 6f6f 6c0d 0a20 2020 2020 2020  p: bool..       
+0001dfe0: 2020 2020 2061 7373 6967 6e20 6669 7273       assign firs
+0001dff0: 7420 6c61 7965 7220 746f 2074 6f70 206f  t layer to top o
+0001e000: 6620 7468 6520 646f 6d61 696e 2028 5472  f the domain (Tr
+0001e010: 7565 2062 7920 6465 6661 756c 7429 0d0a  ue by default)..
+0001e020: 2020 2020 2020 2020 726d 5f72 6573 5f66          rm_res_f
+0001e030: 696c 6573 203a 2062 6f6f 6c0d 0a20 2020  iles : bool..   
+0001e040: 2020 2020 2020 2020 2066 6c61 6720 746f           flag to
+0001e050: 2072 656d 6f76 6520 7072 6576 696f 7573   remove previous
+0001e060: 2065 7869 7374 696e 6720 7265 7375 6c74   existing result
+0001e070: 696e 6720 6669 6c65 7320 696e 2077 6f72  ing files in wor
+0001e080: 6b69 6e67 2064 6972 6563 746f 7279 0d0a  king directory..
+0001e090: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+0001e0a0: 0a20 2020 2020 2020 2073 7461 7274 3d74  .        start=t
+0001e0b0: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
+0001e0c0: 2020 2020 6e70 2e72 616e 646f 6d2e 7365      np.random.se
+0001e0d0: 6564 2873 656c 662e 7365 6564 2920 2023  ed(self.seed)  #
+0001e0e0: 2073 6574 2073 6565 640d 0a0d 0a0d 0a20   set seed...... 
+0001e0f0: 2020 2020 2020 2069 6620 6e72 6561 6c20         if nreal 
+0001e100: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+0001e110: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0001e120: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0001e130: 2020 2020 2070 7269 6e74 2822 5761 726e       print("Warn
+0001e140: 696e 673a 206e 7265 616c 2069 7320 7365  ing: nreal is se
+0001e150: 7420 746f 2030 2e22 290d 0a20 2020 2020  t to 0.")..     
+0001e160: 2020 2020 2020 2072 6574 7572 6e0d 0a0d         return...
+0001e170: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001e180: 2e62 6873 5f70 726f 6365 7373 6564 203d  .bhs_processed =
+0001e190: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+0001e1a0: 2020 7072 696e 7428 2242 6f72 6568 6f6c    print("Borehol
+0001e1b0: 6573 206e 6f74 2070 726f 6365 7373 6564  es not processed
+0001e1c0: 2c20 6675 6c6c 7920 756e 636f 6e64 6974  , fully uncondit
+0001e1d0: 696f 6e61 6c20 7369 6d75 6c61 7469 6f6e  ional simulation
+0001e1e0: 7320 7769 6c6c 2062 6520 7465 6d70 7465  s will be tempte
+0001e1f0: 6422 290d 0a20 2020 2020 2020 2023 6173  d")..        #as
+0001e200: 7365 7274 2073 656c 662e 6268 735f 7072  sert self.bhs_pr
+0001e210: 6f63 6573 7365 6420 3d3d 2031 2c20 2242  ocessed == 1, "B
+0001e220: 6f72 6568 6f6c 6573 206e 6f74 2070 726f  oreholes not pro
+0001e230: 6365 7373 6564 220d 0a0d 0a20 2020 2020  cessed"....     
+0001e240: 2020 2023 2063 7265 6174 6520 776f 726b     # create work
+0001e250: 2064 6972 6563 746f 7279 2069 6620 6974   directory if it
+0001e260: 2064 6f65 736e 2774 2065 7869 7374 0d0a   doesn't exist..
+0001e270: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001e280: 7773 206e 6f74 2069 6e20 6f73 2e6c 6973  ws not in os.lis
+0001e290: 7464 6972 2829 3a0d 0a20 2020 2020 2020  tdir():..       
+0001e2a0: 2020 2020 206f 732e 6d6b 6469 7228 7365       os.mkdir(se
+0001e2b0: 6c66 2e77 7329 0d0a 0d0a 2020 2020 2020  lf.ws)....      
+0001e2c0: 2020 2320 7265 6d6f 7665 2070 7265 6578    # remove preex
+0001e2d0: 6973 7469 6e67 2072 6573 756c 7473 2066  isting results f
+0001e2e0: 696c 6573 2069 6e20 7773 0d0a 2020 2020  iles in ws..    
+0001e2f0: 2020 2020 6966 2072 6d5f 7265 735f 6669      if rm_res_fi
+0001e300: 6c65 733a 0d0a 2020 2020 2020 2020 2020  les:..          
+0001e310: 2020 666f 7220 6669 6c65 2069 6e20 6f73    for file in os
+0001e320: 2e6c 6973 7464 6972 2873 656c 662e 7773  .listdir(self.ws
+0001e330: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0001e340: 2020 2020 6966 2066 696c 652e 7370 6c69      if file.spli
+0001e350: 7428 222e 2229 5b2d 315d 2069 6e20 2822  t(".")[-1] in ("
+0001e360: 756e 7422 2c20 2266 6163 222c 2022 7072  unt", "fac", "pr
+0001e370: 6f22 293a 0d0a 2020 2020 2020 2020 2020  o"):..          
+0001e380: 2020 2020 2020 2020 2020 6670 6174 683d            fpath=
+0001e390: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
+0001e3a0: 662e 7773 2c20 6669 6c65 290d 0a20 2020  f.ws, file)..   
+0001e3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e3c0: 206f 732e 7265 6d6f 7665 2866 7061 7468   os.remove(fpath
+0001e3d0: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
+0001e3e0: 662e 4765 6f6c 2e75 6e69 7473 5f64 6f6d  f.Geol.units_dom
+0001e3f0: 6169 6e73 3d6e 702e 7a65 726f 7328 5b6e  ains=np.zeros([n
+0001e400: 7265 616c 2c20 7365 6c66 2e67 6574 5f6e  real, self.get_n
+0001e410: 7a28 292c 2073 656c 662e 6765 745f 6e79  z(), self.get_ny
+0001e420: 2829 2c20 7365 6c66 2e67 6574 5f6e 7828  (), self.get_nx(
+0001e430: 295d 2c20 6474 7970 653d 6e70 2e69 6e74  )], dtype=np.int
+0001e440: 3829 2020 2320 696e 6974 6961 6c69 7a65  8)  # initialize
+0001e450: 2074 6d70 2072 6573 756c 7420 6172 7261   tmp result arra
+0001e460: 790d 0a0d 0a20 2020 2020 2020 2069 6620  y....        if 
+0001e470: 7365 6c66 2e63 6865 636b 5f75 6e69 7473  self.check_units
+0001e480: 5f49 4428 2920 6973 204e 6f6e 653a 2020  _ID() is None:  
+0001e490: 2320 6368 6563 6b20 6966 2075 6e69 7473  # check if units
+0001e4a0: 2068 6176 6520 636f 7272 6563 7420 4944   have correct ID
+0001e4b0: 730d 0a20 2020 2020 2020 2020 2020 2072  s..            r
+0001e4c0: 6574 7572 6e20 4e6f 6e65 0d0a 2020 2020  eturn None..    
+0001e4d0: 2020 2020 7365 6c66 2e67 6574 5f70 696c      self.get_pil
+0001e4e0: 655f 6d61 7374 6572 2829 2e63 6f6d 7075  e_master().compu
+0001e4f0: 7465 5f73 7572 6628 7365 6c66 2c20 6e72  te_surf(self, nr
+0001e500: 6561 6c2c 2066 6c5f 746f 702c 2076 623d  eal, fl_top, vb=
+0001e510: 7365 6c66 2e76 6572 626f 7365 2920 2023  self.verbose)  #
+0001e520: 2063 6f6d 7075 7465 2073 7572 6673 206f   compute surfs o
+0001e530: 6620 7468 6520 6669 7273 7420 7069 6c65  f the first pile
+0001e540: 0d0a 0d0a 2020 2020 2020 2020 2323 2073  ....        ## s
+0001e550: 746f 6368 6173 7469 6320 6861 7264 2064  tochastic hard d
+0001e560: 6174 610d 0a20 2020 2020 2020 2023 6869  ata..        #hi
+0001e570: 6572 6172 6368 6965 730d 0a20 2020 2020  erarchies..     
+0001e580: 2020 2064 6566 2066 756e 2870 696c 6529     def fun(pile)
+0001e590: 3a20 2023 2063 6f6d 7075 7465 2073 7572  :  # compute sur
+0001e5a0: 6620 6869 6572 6172 6368 6963 616c 6c79  f hierarchically
+0001e5b0: 0d0a 2020 2020 2020 2020 2020 2020 693d  ..            i=
+0001e5c0: 300d 0a20 2020 2020 2020 2020 2020 2066  0..            f
+0001e5d0: 6f72 2075 6e69 7420 696e 2070 696c 652e  or unit in pile.
+0001e5e0: 6c69 7374 5f75 6e69 7473 3a0d 0a20 2020  list_units:..   
+0001e5f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001e600: 756e 6974 2e66 5f6d 6574 686f 6420 3d3d  unit.f_method ==
+0001e610: 2022 5375 6250 696c 6522 3a0d 0a20 2020   "SubPile":..   
+0001e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e630: 2069 6620 756e 6974 2e53 7562 5069 6c65   if unit.SubPile
+0001e640: 2e6e 6174 7572 6520 3d3d 2022 7375 7266  .nature == "surf
+0001e650: 6163 6573 223a 0d0a 0d0a 2020 2020 2020  aces":....      
+0001e660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e670: 2020 746f 7073 3d73 656c 662e 4765 6f6c    tops=self.Geol
+0001e680: 2e73 7572 6661 6365 735f 6279 5f70 696c  .surfaces_by_pil
+0001e690: 6573 5b70 696c 652e 6e61 6d65 5d5b 3a2c  es[pile.name][:,
+0001e6a0: 2069 5d0d 0a20 2020 2020 2020 2020 2020   i]..           
+0001e6b0: 2020 2020 2020 2020 2020 2020 2062 6f74               bot
+0001e6c0: 733d 7365 6c66 2e47 656f 6c2e 7375 7266  s=self.Geol.surf
+0001e6d0: 6163 6573 5f62 6f74 5f62 795f 7069 6c65  aces_bot_by_pile
+0001e6e0: 735b 7069 6c65 2e6e 616d 655d 5b3a 2c20  s[pile.name][:, 
+0001e6f0: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
+0001e700: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+0001e710: 2e53 7562 5069 6c65 2e63 6f6d 7075 7465  .SubPile.compute
+0001e720: 5f73 7572 6628 7365 6c66 2c20 6e72 6561  _surf(self, nrea
+0001e730: 6c2c 2066 6c5f 746f 703d 5472 7565 2c20  l, fl_top=True, 
+0001e740: 7375 6270 696c 653d 5472 7565 2c20 746f  subpile=True, to
+0001e750: 7073 3d74 6f70 732c 2062 6f74 733d 626f  ps=tops, bots=bo
+0001e760: 7473 2c20 7662 3d73 656c 662e 7665 7262  ts, vb=self.verb
+0001e770: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+0001e780: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0001e790: 6e28 756e 6974 2e53 7562 5069 6c65 290d  n(unit.SubPile).
+0001e7a0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001e7b0: 2020 2020 2020 2065 6c69 6620 756e 6974         elif unit
+0001e7c0: 2e53 7562 5069 6c65 2e6e 6174 7572 6520  .SubPile.nature 
+0001e7d0: 3d3d 2022 3364 5f63 6174 6567 6f72 6963  == "3d_categoric
+0001e7e0: 616c 223a 0d0a 2020 2020 2020 2020 2020  al":..          
+0001e7f0: 2020 2020 2020 2020 2020 2020 2020 756e                un
+0001e800: 6974 2e63 6f6d 7075 7465 5f66 6163 6965  it.compute_facie
+0001e810: 7328 7365 6c66 2c20 6e72 6561 6c3d 312c  s(self, nreal=1,
+0001e820: 206d 6f64 653d 2275 6e69 7473 222c 2076   mode="units", v
+0001e830: 6572 626f 7365 3d73 656c 662e 7665 7262  erbose=self.verb
+0001e840: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+0001e850: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0001e860: 6e28 756e 6974 2e53 7562 5069 6c65 290d  n(unit.SubPile).
+0001e870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e880: 2069 202b 3d20 310d 0a0d 0a20 2020 2020   i += 1....     
+0001e890: 2020 2066 756e 2873 656c 662e 6765 745f     fun(self.get_
+0001e8a0: 7069 6c65 5f6d 6173 7465 7228 2929 2020  pile_master())  
+0001e8b0: 2320 7275 6e20 6675 6e63 7469 6f6e 0d0a  # run function..
+0001e8c0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0001e8d0: 662e 6669 6c6c 5f66 6c61 673a 0d0a 2020  f.fill_flag:..  
+0001e8e0: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
+0001e8f0: 696c 6c5f 746f 705f 756e 6974 2829 0d0a  ill_top_unit()..
+0001e900: 0d0a 2020 2020 2020 2020 656e 643d 7469  ..        end=ti
+0001e910: 6d65 2e74 696d 6528 290d 0a20 2020 2020  me.time()..     
+0001e920: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0001e930: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0001e940: 2070 7269 6e74 2822 5c6e 2323 2320 7b7d   print("\n### {}
+0001e950: 3a20 546f 7461 6c20 7469 6d65 2065 6c61  : Total time ela
+0001e960: 7073 6564 2066 6f72 2063 6f6d 7075 7469  psed for computi
+0001e970: 6e67 2073 7572 6661 6365 7320 2323 2322  ng surfaces ###"
+0001e980: 2e66 6f72 6d61 7428 656e 6420 2d20 7374  .format(end - st
+0001e990: 6172 7429 290d 0a0d 0a0d 0a20 2020 2020  art))......     
+0001e9a0: 2020 2023 2077 7269 7465 2072 6573 756c     # write resul
+0001e9b0: 7473 0d0a 2020 2020 2020 2020 6966 2073  ts..        if s
+0001e9c0: 656c 662e 7772 6974 655f 7265 7375 6c74  elf.write_result
+0001e9d0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0001e9e0: 756e 6974 735f 646f 6d61 696e 733d 7365  units_domains=se
+0001e9f0: 6c66 2e47 656f 6c2e 756e 6974 735f 646f  lf.Geol.units_do
+0001ea00: 6d61 696e 730d 0a20 2020 2020 2020 2020  mains..         
+0001ea10: 2020 2066 6f72 2069 7265 616c 2069 6e20     for ireal in 
+0001ea20: 7261 6e67 6528 6e72 6561 6c29 3a0d 0a0d  range(nreal):...
+0001ea30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea40: 2075 643d 756e 6974 735f 646f 6d61 696e   ud=units_domain
+0001ea50: 735b 6972 6561 6c5d 0d0a 2020 2020 2020  s[ireal]..      
+0001ea60: 2020 2020 2020 2020 2020 666e 616d 653d            fname=
+0001ea70: 7365 6c66 2e6e 616d 652b 225f 7b7d 2e75  self.name+"_{}.u
+0001ea80: 6422 2e66 6f72 6d61 7428 6972 6561 6c29  d".format(ireal)
+0001ea90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001eaa0: 2020 6670 6174 683d 6f73 2e70 6174 682e    fpath=os.path.
+0001eab0: 6a6f 696e 2873 656c 662e 7773 2c20 666e  join(self.ws, fn
+0001eac0: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
+0001ead0: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+0001eae0: 6670 6174 682c 2022 7762 2229 2061 7320  fpath, "wb") as 
+0001eaf0: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
+0001eb00: 2020 2020 2020 2020 7069 636b 6c65 2e64          pickle.d
+0001eb10: 756d 7028 7564 2c20 6629 0d0a 0d0a 2020  ump(ud, f)....  
+0001eb20: 2020 2020 2020 2020 2020 2364 656c 6574            #delet
+0001eb30: 2075 6e69 7473 2064 6f6d 6169 6e73 2069   units domains i
+0001eb40: 6e20 4765 6f6c 206f 626a 6563 7420 746f  n Geol object to
+0001eb50: 2066 6f72 206d 656d 6f72 7920 7370 6163   for memory spac
+0001eb60: 650d 0a20 2020 2020 2020 2020 2020 2064  e..            d
+0001eb70: 656c 2873 656c 662e 4765 6f6c 2e75 6e69  el(self.Geol.uni
+0001eb80: 7473 5f64 6f6d 6169 6e73 290d 0a0d 0a20  ts_domains).... 
+0001eb90: 2020 2020 2020 2073 656c 662e 7375 7266         self.surf
+0001eba0: 6163 6573 5f63 6f6d 7075 7465 643d 3120  aces_computed=1 
+0001ebb0: 2023 2066 6c61 670d 0a0d 0a0d 0a20 2020   # flag......   
+0001ebc0: 2064 6566 2064 6566 696e 655f 646f 6d61   def define_doma
+0001ebd0: 696e 7328 7365 6c66 2c20 7375 7266 6163  ins(self, surfac
+0001ebe0: 6573 2c20 666c 5f74 6f70 3d54 7275 6529  es, fl_top=True)
+0001ebf0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+0001ec00: 0d0a 2020 2020 2020 2020 5065 7266 6f72  ..        Perfor
+0001ec10: 6d73 2074 6865 2063 6f6d 7075 7461 7469  ms the computati
+0001ec20: 6f6e 206f 6620 7468 6520 756e 6974 7320  on of the units 
+0001ec30: 646f 6d61 696e 7320 7768 656e 2073 7572  domains when sur
+0001ec40: 6661 6365 7320 6172 6520 7072 6f76 6964  faces are provid
+0001ec50: 6564 0d0a 2020 2020 2020 2020 0d0a 2020  ed..        ..  
+0001ec60: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0001ec70: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0001ec80: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7375  ----..        su
+0001ec90: 7266 6163 6573 203a 2064 6963 7469 6f6e  rfaces : diction
+0001eca0: 6172 7920 6f66 2073 7572 6661 6365 7320  ary of surfaces 
+0001ecb0: 6173 2076 616c 7565 7320 616e 6420 7069  as values and pi
+0001ecc0: 6c65 206e 616d 6520 6173 206b 6579 0d0a  le name as key..
+0001ecd0: 2020 2020 2020 2020 666c 5f74 6f70 3a20          fl_top: 
+0001ece0: 626f 6f6c 0d0a 2020 2020 2020 2020 2020  bool..          
+0001ecf0: 2020 6173 7369 676e 2066 6972 7374 206c    assign first l
+0001ed00: 6179 6572 2074 6f20 746f 7020 6f66 2074  ayer to top of t
+0001ed10: 6865 2064 6f6d 6169 6e20 2854 7275 6520  he domain (True 
+0001ed20: 6279 2064 6566 6175 6c74 290d 0a0d 0a20  by default).... 
+0001ed30: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+0001ed40: 2020 2020 2020 236e 702e 7261 6e64 6f6d        #np.random
+0001ed50: 2e73 6565 6428 7365 6c66 2e73 6565 6429  .seed(self.seed)
+0001ed60: 2020 2320 7365 7420 7365 6564 0d0a 0d0a    # set seed....
+0001ed70: 2020 2020 2020 2020 6e72 6561 6c20 3d20          nreal = 
+0001ed80: 7375 7266 6163 6573 5b73 656c 662e 6765  surfaces[self.ge
+0001ed90: 745f 7069 6c65 5f6d 6173 7465 7228 292e  t_pile_master().
+0001eda0: 6e61 6d65 5d2e 7368 6170 655b 305d 2020  name].shape[0]  
+0001edb0: 2320 6765 7420 6e75 6d62 6572 206f 6620  # get number of 
+0001edc0: 7265 616c 697a 6174 696f 6e73 0d0a 2020  realizations..  
+0001edd0: 2020 2020 2020 7365 6c66 2e47 656f 6c2e        self.Geol.
+0001ede0: 756e 6974 735f 646f 6d61 696e 733d 6e70  units_domains=np
+0001edf0: 2e7a 6572 6f73 285b 6e72 6561 6c2c 2073  .zeros([nreal, s
+0001ee00: 656c 662e 6765 745f 6e7a 2829 2c20 7365  elf.get_nz(), se
+0001ee10: 6c66 2e67 6574 5f6e 7928 292c 2073 656c  lf.get_ny(), sel
+0001ee20: 662e 6765 745f 6e78 2829 5d2c 2064 7479  f.get_nx()], dty
+0001ee30: 7065 3d6e 702e 696e 7438 2920 2023 2069  pe=np.int8)  # i
+0001ee40: 6e69 7469 616c 697a 6520 746d 7020 7265  nitialize tmp re
+0001ee50: 7375 6c74 2061 7272 6179 0d0a 0d0a 0d0a  sult array......
+0001ee60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001ee70: 6368 6563 6b5f 756e 6974 735f 4944 2829  check_units_ID()
+0001ee80: 2069 7320 4e6f 6e65 3a20 2023 2063 6865   is None:  # che
+0001ee90: 636b 2069 6620 756e 6974 7320 6861 7665  ck if units have
+0001eea0: 2063 6f72 7265 6374 2049 4473 0d0a 2020   correct IDs..  
+0001eeb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001eec0: 204e 6f6e 650d 0a0d 0a20 2020 2020 2020   None....       
+0001eed0: 2073 656c 662e 6765 745f 7069 6c65 5f6d   self.get_pile_m
+0001eee0: 6173 7465 7228 292e 6465 6669 6e65 5f64  aster().define_d
+0001eef0: 6f6d 6169 6e73 2873 656c 662c 2073 7572  omains(self, sur
+0001ef00: 6661 6365 735b 7365 6c66 2e67 6574 5f70  faces[self.get_p
+0001ef10: 696c 655f 6d61 7374 6572 2829 2e6e 616d  ile_master().nam
+0001ef20: 655d 2c20 7662 3d73 656c 662e 7665 7262  e], vb=self.verb
+0001ef30: 6f73 652c 2066 6c5f 746f 703d 666c 5f74  ose, fl_top=fl_t
+0001ef40: 6f70 290d 0a0d 0a20 2020 2020 2020 2023  op)....        #
+0001ef50: 6869 6572 6172 6368 6965 730d 0a20 2020  hierarchies..   
+0001ef60: 2020 2020 2064 6566 2066 756e 2870 696c       def fun(pil
+0001ef70: 6529 3a20 2023 2063 6f6d 7075 7465 2073  e):  # compute s
+0001ef80: 7572 6620 6869 6572 6172 6368 6963 616c  urf hierarchical
+0001ef90: 6c79 0d0a 2020 2020 2020 2020 2020 2020  ly..            
+0001efa0: 693d 300d 0a20 2020 2020 2020 2020 2020  i=0..           
+0001efb0: 2066 6f72 2075 6e69 7420 696e 2070 696c   for unit in pil
+0001efc0: 652e 6c69 7374 5f75 6e69 7473 3a0d 0a20  e.list_units:.. 
+0001efd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001efe0: 6620 756e 6974 2e66 5f6d 6574 686f 6420  f unit.f_method 
+0001eff0: 3d3d 2022 5375 6250 696c 6522 3a0d 0a20  == "SubPile":.. 
+0001f000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f010: 2020 2074 6f70 733d 7375 7266 6163 6573     tops=surfaces
+0001f020: 5b70 696c 652e 6e61 6d65 5d5b 3a2c 2069  [pile.name][:, i
+0001f030: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0001f040: 2020 2020 2020 2062 6f74 733d 7375 7266         bots=surf
+0001f050: 6163 6573 5b70 696c 652e 6e61 6d65 5d5b  aces[pile.name][
+0001f060: 3a2c 2069 2b31 5d0d 0a20 2020 2020 2020  :, i+1]..       
+0001f070: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
+0001f080: 742e 5375 6250 696c 652e 6465 6669 6e65  t.SubPile.define
+0001f090: 5f64 6f6d 6169 6e73 2873 656c 662c 2073  _domains(self, s
+0001f0a0: 7572 6661 6365 735b 756e 6974 2e53 7562  urfaces[unit.Sub
+0001f0b0: 5069 6c65 2e6e 616d 655d 2c20 666c 5f74  Pile.name], fl_t
+0001f0c0: 6f70 3d54 7275 652c 2073 7562 7069 6c65  op=True, subpile
+0001f0d0: 3d54 7275 652c 2074 6f70 733d 746f 7073  =True, tops=tops
+0001f0e0: 2c20 626f 7473 3d62 6f74 732c 2076 623d  , bots=bots, vb=
+0001f0f0: 7365 6c66 2e76 6572 626f 7365 290d 0a20  self.verbose).. 
+0001f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f110: 2020 2066 756e 2875 6e69 742e 5375 6250     fun(unit.SubP
+0001f120: 696c 6529 0d0a 2020 2020 2020 2020 2020  ile)..          
+0001f130: 2020 2020 2020 6920 2b3d 2031 0d0a 0d0a        i += 1....
+0001f140: 2020 2020 2020 2020 6675 6e28 7365 6c66          fun(self
+0001f150: 2e67 6574 5f70 696c 655f 6d61 7374 6572  .get_pile_master
+0001f160: 2829 2920 2023 2072 756e 2066 756e 6374  ())  # run funct
+0001f170: 696f 6e0d 0a0d 0a20 2020 2020 2020 2073  ion....        s
+0001f180: 656c 662e 7375 7266 6163 6573 5f63 6f6d  elf.surfaces_com
+0001f190: 7075 7465 643d 3120 2023 2066 6c61 670d  puted=1  # flag.
+0001f1a0: 0a0d 0a20 2020 2064 6566 2066 696c 6c5f  ...    def fill_
+0001f1b0: 4944 2873 656c 662c 2061 7272 2c20 4944  ID(self, arr, ID
+0001f1c0: 3d30 293a 0d0a 2020 2020 0d0a 2020 2020  =0):..    ..    
+0001f1d0: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0001f1e0: 2046 696c 6c20 4944 2076 616c 7565 7320   Fill ID values 
+0001f1f0: 696e 2061 6e20 3344 2061 7272 6179 2067  in an 3D array g
+0001f200: 6976 656e 2073 7572 726f 756e 6469 6e67  iven surrounding
+0001f210: 7320 7661 6c75 6573 2075 7369 6e67 206e  s values using n
+0001f220: 6561 7265 7374 206e 6569 6768 626f 7273  earest neighbors
+0001f230: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
+0001f240: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0001f250: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001f260: 2d2d 0d0a 2020 2020 2020 2020 6172 723a  --..        arr:
+0001f270: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
+0001f280: 2028 6e7a 2c20 6e79 2c20 6e78 290d 0a20   (nz, ny, nx).. 
+0001f290: 2020 2020 2020 2020 2020 2073 696d 756c             simul
+0001f2a0: 6174 696f 6e20 6772 6964 2073 697a 650d  ation grid size.
+0001f2b0: 0a20 2020 2020 2020 2049 443a 2049 440d  .        ID: ID.
+0001f2c0: 0a20 2020 2020 2020 2020 2020 2049 4420  .            ID 
+0001f2d0: 746f 2072 6570 6c61 6365 0d0a 0d0a 2020  to replace....  
+0001f2e0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0001f2f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0001f300: 2020 2020 2020 2020 6172 723a 206e 6461          arr: nda
+0001f310: 7272 6179 206f 6620 7369 7a65 2028 6e7a  rray of size (nz
+0001f320: 2c20 6e79 2c20 6e78 290d 0a20 2020 2020  , ny, nx)..     
+0001f330: 2020 2020 2020 2073 696d 756c 6174 696f         simulatio
+0001f340: 6e20 6772 6964 2073 697a 650d 0a20 2020  n grid size..   
+0001f350: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+0001f360: 2020 2020 6e78 203d 2073 656c 662e 6765      nx = self.ge
+0001f370: 745f 6e78 2829 0d0a 2020 2020 2020 2020  t_nx()..        
+0001f380: 6e79 203d 2073 656c 662e 6765 745f 6e79  ny = self.get_ny
+0001f390: 2829 0d0a 2020 2020 2020 2020 6e7a 203d  ()..        nz =
+0001f3a0: 2073 656c 662e 6765 745f 6e7a 2829 0d0a   self.get_nz()..
+0001f3b0: 0d0a 2020 2020 2020 2020 6672 6f6d 2073  ..        from s
+0001f3c0: 6b6c 6561 726e 2e6e 6569 6768 626f 7273  klearn.neighbors
+0001f3d0: 2069 6d70 6f72 7420 4e65 6172 6573 744e   import NearestN
+0001f3e0: 6569 6768 626f 7273 0d0a 0d0a 2020 2020  eighbors....    
+0001f3f0: 2020 2020 5820 3d20 6e70 2e6f 6e65 7328      X = np.ones(
+0001f400: 5b6e 7a2c 206e 792c 206e 785d 292a 2073  [nz, ny, nx])* s
+0001f410: 656c 662e 7867 630d 0a20 2020 2020 2020  elf.xgc..       
+0001f420: 2059 203d 206e 702e 6f6e 6573 285b 6e7a   Y = np.ones([nz
+0001f430: 2c20 6e79 2c20 6e78 5d29 0d0a 2020 2020  , ny, nx])..    
+0001f440: 2020 2020 595b 3a5d 203d 206e 702e 6f6e      Y[:] = np.on
+0001f450: 6573 285b 6e78 2c20 6e79 5d29 2e54 202a  es([nx, ny]).T *
+0001f460: 2073 656c 662e 7967 632e 7265 7368 6170   self.ygc.reshap
+0001f470: 6528 2d31 2c20 3129 0d0a 2020 2020 2020  e(-1, 1)..      
+0001f480: 2020 5a20 3d20 6e70 2e6f 6e65 7328 5b6e    Z = np.ones([n
+0001f490: 7a2c 206e 792c 206e 785d 290d 0a20 2020  z, ny, nx])..   
+0001f4a0: 2020 2020 205a 5b3a 2c20 3a5d 203d 2820       Z[:, :] =( 
+0001f4b0: 6e70 2e6f 6e65 7328 5b6e 7a2c 206e 785d  np.ones([nz, nx]
+0001f4c0: 2920 2a20 7365 6c66 2e7a 6763 2e72 6573  ) * self.zgc.res
+0001f4d0: 6861 7065 282d 312c 2031 2929 2e72 6573  hape(-1, 1)).res
+0001f4e0: 6861 7065 286e 7a2c 2031 2c20 6e78 290d  hape(nz, 1, nx).
+0001f4f0: 0a0d 0a20 2020 2020 2020 2078 7533 4420  ...        xu3D 
+0001f500: 3d20 6e70 2e61 7272 6179 285b 582e 666c  = np.array([X.fl
+0001f510: 6174 7465 6e28 292c 2059 2e66 6c61 7474  atten(), Y.flatt
+0001f520: 656e 2829 2c20 5a2e 666c 6174 7465 6e28  en(), Z.flatten(
+0001f530: 295d 292e 540d 0a0d 0a20 2020 2020 2020  )]).T....       
+0001f540: 206d 6173 6b20 3d20 2861 7272 2021 3d20   mask = (arr != 
+0001f550: 4944 2920 2a20 2861 7272 2021 3d20 3029  ID) * (arr != 0)
+0001f560: 2020 2320 6d61 736b 206f 6620 6461 7461    # mask of data
+0001f570: 0d0a 2020 2020 2020 2020 585f 6669 7420  ..        X_fit 
+0001f580: 3d20 7875 3344 5b6d 6173 6b2e 666c 6174  = xu3D[mask.flat
+0001f590: 7465 6e28 295d 0d0a 2020 2020 2020 2020  ten()]..        
+0001f5a0: 795f 6669 7420 3d20 6172 722e 666c 6174  y_fit = arr.flat
+0001f5b0: 7465 6e28 295b 6d61 736b 2e66 6c61 7474  ten()[mask.flatt
+0001f5c0: 656e 2829 5d0d 0a20 2020 2020 2020 206d  en()]..        m
+0001f5d0: 6173 6b20 3d20 2861 7272 203d 3d20 4944  ask = (arr == ID
+0001f5e0: 2920 2023 206d 6173 6b20 7768 6572 6520  )  # mask where 
+0001f5f0: 746f 2066 696c 6c0d 0a0d 0a20 2020 2020  to fill....     
+0001f600: 2020 2069 6620 6d61 736b 2e61 6e79 2829     if mask.any()
+0001f610: 3a0d 0a20 2020 2020 2020 2020 2020 2058  :..            X
+0001f620: 5f70 7265 6420 3d20 7875 3344 5b6d 6173  _pred = xu3D[mas
+0001f630: 6b2e 666c 6174 7465 6e28 295d 0d0a 0d0a  k.flatten()]....
+0001f640: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
+0001f650: 740d 0a20 2020 2020 2020 2020 2020 206e  t..            n
+0001f660: 6e20 3d20 4e65 6172 6573 744e 6569 6768  n = NearestNeigh
+0001f670: 626f 7273 286e 5f6e 6569 6768 626f 7273  bors(n_neighbors
+0001f680: 3d31 292e 6669 7428 585f 6669 7429 0d0a  =1).fit(X_fit)..
+0001f690: 0d0a 2020 2020 2020 2020 2020 2020 2370  ..            #p
+0001f6a0: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
+0001f6b0: 2072 6573 203d 206e 6e2e 6b6e 6569 6768   res = nn.kneigh
+0001f6c0: 626f 7273 2858 5f70 7265 642c 2072 6574  bors(X_pred, ret
+0001f6d0: 7572 6e5f 6469 7374 616e 6365 3d46 616c  urn_distance=Fal
+0001f6e0: 7365 2c20 6e5f 6e65 6967 6862 6f72 733d  se, n_neighbors=
+0001f6f0: 3129 0d0a 0d0a 2020 2020 2020 2020 2020  1)....          
+0001f700: 2020 2320 6173 7369 676e 0d0a 2020 2020    # assign..    
+0001f710: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
+0001f720: 2079 5f66 6974 5b72 6573 5d0d 0a20 2020   y_fit[res]..   
+0001f730: 2020 2020 2020 2020 2061 7272 5f74 6573           arr_tes
+0001f740: 7420 3d20 6172 722e 636f 7079 2829 0d0a  t = arr.copy()..
+0001f750: 2020 2020 2020 2020 2020 2020 6172 725f              arr_
+0001f760: 7465 7374 5b6d 6173 6b5d 203d 2079 5f70  test[mask] = y_p
+0001f770: 7265 645b 3a2c 2030 5d20 2023 2072 6561  red[:, 0]  # rea
+0001f780: 7373 6967 6e20 7661 6c75 6573 0d0a 0d0a  ssign values....
+0001f790: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+0001f7a0: 7272 5f74 6573 740d 0a0d 0a0d 0a20 2020  rr_test......   
+0001f7b0: 2064 6566 2066 696c 6c5f 746f 705f 756e   def fill_top_un
+0001f7c0: 6974 2873 656c 662c 206d 6574 686f 6420  it(self, method 
+0001f7d0: 3d20 226e 6561 7265 7374 5f6e 6569 6768  = "nearest_neigh
+0001f7e0: 626f 7273 2229 3a20 2023 2074 6f20 7265  bors"):  # to re
+0001f7f0: 6d6f 7665 0d0a 2020 2020 0d0a 2020 2020  move..    ..    
+0001f800: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+0001f810: 2046 756e 6374 696f 6e20 746f 2066 696c   Function to fil
+0001f820: 6c20 6561 6368 2063 656c 6c73 2073 696d  l each cells sim
+0001f830: 756c 6174 6564 2074 6f70 2075 6e69 7420  ulated top unit 
+0001f840: 6769 7665 6e20 7468 6569 7220 6e65 6172  given their near
+0001f850: 6573 7420 6e65 6967 6862 6f75 722e 0d0a  est neighbour...
+0001f860: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001f870: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0001f880: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0001f890: 2020 6d65 7468 6f64 3a20 7374 720d 0a20    method: str.. 
+0001f8a0: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+0001f8b0: 6420 746f 2066 696c 6c20 746f 7020 756e  d to fill top un
+0001f8c0: 6974 2e20 4465 6661 756c 7420 6973 2022  it. Default is "
+0001f8d0: 6e65 6172 6573 745f 6e65 6967 6862 6f72  nearest_neighbor
+0001f8e0: 7322 0d0a 2020 2020 2020 2020 2222 220d  s"..        """.
+0001f8f0: 0a0d 0a20 2020 2020 2020 206e 7820 3d20  ...        nx = 
+0001f900: 7365 6c66 2e67 6574 5f6e 7828 290d 0a20  self.get_nx().. 
+0001f910: 2020 2020 2020 206e 7920 3d20 7365 6c66         ny = self
+0001f920: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
+0001f930: 2020 206e 7a20 3d20 7365 6c66 2e67 6574     nz = self.get
+0001f940: 5f6e 7a28 290d 0a20 2020 2020 2020 200d  _nz()..        .
+0001f950: 0a20 2020 2020 2020 2023 2067 6574 2074  .        # get t
+0001f960: 6f70 2075 6e69 7420 4944 0d0a 2020 2020  op unit ID..    
+0001f970: 2020 2020 746f 705f 756e 6974 203d 2073      top_unit = s
+0001f980: 656c 662e 6765 745f 616c 6c5f 756e 6974  elf.get_all_unit
+0001f990: 7328 3129 5b30 5d0d 0a20 2020 2020 2020  s(1)[0]..       
+0001f9a0: 2049 4420 3d20 746f 705f 756e 6974 2e49   ID = top_unit.I
+0001f9b0: 440d 0a20 2020 2020 2020 200d 0a20 2020  D..        ..   
+0001f9c0: 2020 2020 2069 6620 6d65 7468 6f64 203d       if method =
+0001f9d0: 3d20 226e 6561 7265 7374 5f6e 6569 6768  = "nearest_neigh
+0001f9e0: 626f 7273 223a 0d0a 2020 2020 2020 2020  bors":..        
+0001f9f0: 2020 2020 0d0a 2020 2020 2020 2020 2020      ..          
+0001fa00: 2020 6672 6f6d 2073 6b6c 6561 726e 2e6e    from sklearn.n
+0001fa10: 6569 6768 626f 7273 2069 6d70 6f72 7420  eighbors import 
+0001fa20: 4e65 6172 6573 744e 6569 6768 626f 7273  NearestNeighbors
+0001fa30: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
+0001fa40: 2020 2020 2020 2020 2020 2020 5820 3d20              X = 
+0001fa50: 6e70 2e6f 6e65 7328 5b6e 7a2c 206e 792c  np.ones([nz, ny,
+0001fa60: 206e 785d 292a 2073 656c 662e 7867 630d   nx])* self.xgc.
+0001fa70: 0a20 2020 2020 2020 2020 2020 2059 203d  .            Y =
+0001fa80: 206e 702e 6f6e 6573 285b 6e7a 2c20 6e79   np.ones([nz, ny
+0001fa90: 2c20 6e78 5d29 0d0a 2020 2020 2020 2020  , nx])..        
+0001faa0: 2020 2020 595b 3a5d 203d 206e 702e 6f6e      Y[:] = np.on
+0001fab0: 6573 285b 6e78 2c20 6e79 5d29 2e54 202a  es([nx, ny]).T *
+0001fac0: 2073 656c 662e 7967 632e 7265 7368 6170   self.ygc.reshap
+0001fad0: 6528 2d31 2c20 3129 0d0a 2020 2020 2020  e(-1, 1)..      
+0001fae0: 2020 2020 2020 5a20 3d20 6e70 2e6f 6e65        Z = np.one
+0001faf0: 7328 5b6e 7a2c 206e 792c 206e 785d 290d  s([nz, ny, nx]).
+0001fb00: 0a20 2020 2020 2020 2020 2020 205a 5b3a  .            Z[:
+0001fb10: 2c20 3a5d 203d 2820 6e70 2e6f 6e65 7328  , :] =( np.ones(
+0001fb20: 5b6e 7a2c 206e 785d 2920 2a20 7365 6c66  [nz, nx]) * self
+0001fb30: 2e7a 6763 2e72 6573 6861 7065 282d 312c  .zgc.reshape(-1,
+0001fb40: 2031 2929 2e72 6573 6861 7065 286e 7a2c   1)).reshape(nz,
+0001fb50: 2031 2c20 6e78 290d 0a0d 0a20 2020 2020   1, nx)....     
+0001fb60: 2020 2020 2020 2078 7533 4420 3d20 6e70         xu3D = np
+0001fb70: 2e61 7272 6179 285b 582e 666c 6174 7465  .array([X.flatte
+0001fb80: 6e28 292c 2059 2e66 6c61 7474 656e 2829  n(), Y.flatten()
+0001fb90: 2c20 5a2e 666c 6174 7465 6e28 295d 292e  , Z.flatten()]).
+0001fba0: 540d 0a20 2020 2020 2020 2020 2020 200d  T..            .
+0001fbb0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001fbc0: 2069 7520 696e 2072 616e 6765 2873 656c   iu in range(sel
+0001fbd0: 662e 6e72 6561 6c5f 756e 6974 7329 3a0d  f.nreal_units):.
 0001fbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fbf0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0001fc00: 2020 2069 6620 6d61 736b 2e61 6e79 2829     if mask.any()
-0001fc10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001fc20: 2020 2020 2020 2058 5f70 7265 6420 3d20         X_pred = 
-0001fc30: 7875 3344 5b6d 6173 6b2e 666c 6174 7465  xu3D[mask.flatte
-0001fc40: 6e28 295d 0d0a 0d0a 2020 2020 2020 2020  n()]....        
-0001fc50: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
-0001fc60: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-0001fc70: 2020 2020 2020 206e 6e20 3d20 4e65 6172         nn = Near
-0001fc80: 6573 744e 6569 6768 626f 7273 286e 5f6e  estNeighbors(n_n
-0001fc90: 6569 6768 626f 7273 3d31 292e 6669 7428  eighbors=1).fit(
-0001fca0: 585f 6669 7429 0d0a 0d0a 2020 2020 2020  X_fit)....      
-0001fcb0: 2020 2020 2020 2020 2020 2020 2020 2370                #p
-0001fcc0: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
-0001fcd0: 2020 2020 2020 2020 2072 6573 203d 206e           res = n
-0001fce0: 6e2e 6b6e 6569 6768 626f 7273 2858 5f70  n.kneighbors(X_p
-0001fcf0: 7265 642c 2072 6574 7572 6e5f 6469 7374  red, return_dist
-0001fd00: 616e 6365 3d46 616c 7365 2c20 6e5f 6e65  ance=False, n_ne
-0001fd10: 6967 6862 6f72 733d 3129 0d0a 0d0a 2020  ighbors=1)....  
+0001fbf0: 2061 7272 203d 2073 656c 662e 6765 745f   arr = self.get_
+0001fc00: 756e 6974 735f 646f 6d61 696e 735f 7265  units_domains_re
+0001fc10: 616c 697a 6174 696f 6e73 2869 7529 0d0a  alizations(iu)..
+0001fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001fc40: 2020 6d61 736b 203d 2028 6172 7220 213d    mask = (arr !=
+0001fc50: 2049 4429 202a 2028 6172 7220 213d 2030   ID) * (arr != 0
+0001fc60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0001fc70: 2020 2058 5f66 6974 203d 2078 7533 445b     X_fit = xu3D[
+0001fc80: 6d61 736b 2e66 6c61 7474 656e 2829 5d0d  mask.flatten()].
+0001fc90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fca0: 2079 5f66 6974 203d 2061 7272 2e66 6c61   y_fit = arr.fla
+0001fcb0: 7474 656e 2829 5b6d 6173 6b2e 666c 6174  tten()[mask.flat
+0001fcc0: 7465 6e28 295d 0d0a 2020 2020 2020 2020  ten()]..        
+0001fcd0: 2020 2020 2020 2020 6d61 736b 203d 2028          mask = (
+0001fce0: 6172 7220 3d3d 2049 4429 0d0a 2020 2020  arr == ID)..    
+0001fcf0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0001fd00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001fd10: 206d 6173 6b2e 616e 7928 293a 0d0a 2020   mask.any():..  
 0001fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd30: 2020 2320 6173 7369 676e 0d0a 2020 2020    # assign..    
-0001fd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fd50: 795f 7072 6564 203d 2079 5f66 6974 5b72  y_pred = y_fit[r
-0001fd60: 6573 5d0d 0a20 2020 2020 2020 2020 2020  es]..           
-0001fd70: 2020 2020 2020 2020 2061 7272 5f74 6573           arr_tes
-0001fd80: 7420 3d20 6172 722e 636f 7079 2829 0d0a  t = arr.copy()..
-0001fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fda0: 2020 2020 6172 725f 7465 7374 5b6d 6173      arr_test[mas
-0001fdb0: 6b5d 203d 2079 5f70 7265 645b 3a2c 2030  k] = y_pred[:, 0
-0001fdc0: 5d20 2023 2072 6561 7373 6967 6e20 7661  ]  # reassign va
-0001fdd0: 6c75 6573 0d0a 0d0a 2020 2020 2020 2020  lues....        
-0001fde0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001fdf0: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
-0001fe00: 696e 735b 6975 5d20 3d20 6172 725f 7465  ins[iu] = arr_te
-0001fe10: 7374 0d0a 2020 2020 2020 2020 656c 7365  st..        else
-0001fe20: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0001fe30: 6620 7365 6c66 2e76 623a 0d0a 2020 2020  f self.vb:..    
-0001fe40: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0001fe50: 7428 2249 6e76 616c 6964 206d 6574 686f  t("Invalid metho
-0001fe60: 6422 290d 0a0d 0a20 2020 2064 6566 2063  d")....    def c
-0001fe70: 6f6d 7075 7465 5f66 6163 6965 7328 7365  ompute_facies(se
-0001fe80: 6c66 2c20 6e72 6561 6c3d 312c 2076 6572  lf, nreal=1, ver
-0001fe90: 626f 7365 5f6d 6574 686f 6473 3d30 293a  bose_methods=0):
-0001fea0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0001feb0: 0a20 2020 2020 2020 2050 6572 666f 726d  .        Perform
-0001fec0: 7320 7468 6520 636f 6d70 7574 6174 696f  s the computatio
-0001fed0: 6e20 6f66 2074 6865 2066 6163 6965 730d  n of the facies.
-0001fee0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0001fef0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0001ff00: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0001ff10: 2020 206e 7265 616c 3a20 696e 740d 0a20     nreal: int.. 
-0001ff20: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-0001ff30: 7220 6f66 2072 6561 6c69 7a61 7469 6f6e  r of realization
-0001ff40: 730d 0a20 2020 2020 2020 2076 6572 626f  s..        verbo
-0001ff50: 7365 5f6d 6574 686f 6473 3a20 696e 740d  se_methods: int.
-0001ff60: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
-0001ff70: 626f 7365 2066 6f72 2074 6865 2066 6163  bose for the fac
-0001ff80: 6965 7320 6d65 7468 6f64 732c 2030 2062  ies methods, 0 b
-0001ff90: 7920 6465 6661 756c 740d 0a20 2020 2020  y default..     
-0001ffa0: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-0001ffb0: 2020 6966 206e 7265 616c 3d3d 303a 0d0a    if nreal==0:..
-0001ffc0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001ffd0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-0001ffe0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0001fff0: 696e 7428 2257 6172 6e69 6e67 3a20 6e72  int("Warning: nr
-00020000: 6561 6c20 7365 7420 746f 2030 2229 0d0a  eal set to 0")..
-00020010: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00020020: 726e 0d0a 2020 2020 2020 2020 2361 7373  rn..        #ass
-00020030: 6572 7473 0d0a 2020 2020 2020 2020 616c  erts..        al
-00020040: 6c5f 6964 733d 5b5d 0d0a 2020 2020 2020  l_ids=[]..      
-00020050: 2020 666f 7220 6661 2069 6e20 7365 6c66    for fa in self
-00020060: 2e67 6574 5f61 6c6c 5f66 6163 6965 7328  .get_all_facies(
-00020070: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00020080: 6966 2066 612e 4944 206e 6f74 2069 6e20  if fa.ID not in 
-00020090: 616c 6c5f 6964 733a 0d0a 2020 2020 2020  all_ids:..      
-000200a0: 2020 2020 2020 2020 2020 616c 6c5f 6964            all_id
-000200b0: 732e 6170 7065 6e64 2866 612e 4944 290d  s.append(fa.ID).
-000200c0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000200d0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000200e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000200f0: 7272 6f72 2028 227b 7d20 6661 6369 6573  rror ("{} facies
-00020100: 2069 6e64 6578 2068 6173 2062 6565 6e20   index has been 
-00020110: 6465 6669 6e65 6420 6f6e 206d 756c 7469  defined on multi
-00020120: 706c 6520 756e 6974 7322 290d 0a0d 0a20  ple units").... 
-00020130: 2020 2020 2020 2023 7374 6172 740d 0a20         #start.. 
-00020140: 2020 2020 2020 2073 7461 7274 5f74 6f74         start_tot
-00020150: 3d74 696d 652e 7469 6d65 2829 0d0a 2020  =time.time()..  
-00020160: 2020 2020 2020 6e70 2e72 616e 646f 6d2e        np.random.
-00020170: 7365 6564 2028 7365 6c66 2e73 6565 6429  seed (self.seed)
-00020180: 2023 2073 6574 2073 6565 640d 0a0d 0a20   # set seed.... 
-00020190: 2020 2020 2020 2023 6772 6964 0d0a 2020         #grid..  
-000201a0: 2020 2020 2020 7867 3d73 656c 662e 7867        xg=self.xg
-000201b0: 0d0a 2020 2020 2020 2020 7967 3d73 656c  ..        yg=sel
-000201c0: 662e 7967 0d0a 2020 2020 2020 2020 7a67  f.yg..        zg
-000201d0: 3d73 656c 662e 7a67 0d0a 0d0a 2020 2020  =self.zg....    
-000201e0: 2020 2020 2369 6e69 7469 616c 697a 6520      #initialize 
-000201f0: 6172 7261 7920 616e 6420 7365 7420 6e75  array and set nu
-00020200: 6d62 6572 206f 6620 7265 616c 697a 6174  mber of realizat
-00020210: 696f 6e0d 0a20 2020 2020 2020 2073 656c  ion..        sel
-00020220: 662e 6e72 6561 6c5f 6661 3d6e 7265 616c  f.nreal_fa=nreal
-00020230: 0d0a 2020 2020 2020 2020 7365 6c66 2e47  ..        self.G
-00020240: 656f 6c2e 6661 6369 6573 5f64 6f6d 6169  eol.facies_domai
-00020250: 6e73 3d6e 702e 7a65 726f 7328 5b73 656c  ns=np.zeros([sel
-00020260: 662e 6e72 6561 6c5f 756e 6974 732c 206e  f.nreal_units, n
-00020270: 7265 616c 2c20 7365 6c66 2e67 6574 5f6e  real, self.get_n
-00020280: 7a28 292c 2073 656c 662e 6765 745f 6e79  z(), self.get_ny
-00020290: 2829 2c20 7365 6c66 2e67 6574 5f6e 7828  (), self.get_nx(
-000202a0: 295d 2c20 6474 7970 653d 6e70 2e69 6e74  )], dtype=np.int
-000202b0: 3829 0d0a 0d0a 2020 2020 2020 2020 666f  8)....        fo
-000202c0: 7220 7374 7261 7420 696e 2073 656c 662e  r strat in self.
-000202d0: 6765 745f 616c 6c5f 756e 6974 7328 293a  get_all_units():
-000202e0: 2020 2320 6c6f 6f70 206f 7665 7220 7374    # loop over st
-000202f0: 7261 7469 0d0a 2020 2020 2020 2020 2020  rati..          
-00020300: 2020 6966 2073 7472 6174 2e63 6f6e 7461    if strat.conta
-00020310: 6374 203d 3d20 226f 6e6c 6170 223a 0d0a  ct == "onlap":..
-00020320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020330: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-00020340: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020350: 2020 2020 2020 7072 696e 7428 225c 6e23        print("\n#
-00020360: 2323 2055 6e69 7420 7b7d 3a20 6661 6369  ## Unit {}: faci
-00020370: 6573 2073 696d 756c 6174 696f 6e20 7769  es simulation wi
-00020380: 7468 207b 7d20 6d65 7468 6f64 2023 2323  th {} method ###
-00020390: 2322 2e66 6f72 6d61 7428 7374 7261 742e  #".format(strat.
-000203a0: 6e61 6d65 2c20 7374 7261 742e 665f 6d65  name, strat.f_me
-000203b0: 7468 6f64 2929 0d0a 2020 2020 2020 2020  thod))..        
-000203c0: 2020 2020 2020 2020 7374 6172 743d 7469          start=ti
-000203d0: 6d65 2e74 696d 6528 290d 0a20 2020 2020  me.time()..     
-000203e0: 2020 2020 2020 2020 2020 2073 7472 6174             strat
-000203f0: 2e63 6f6d 7075 7465 5f66 6163 6965 7328  .compute_facies(
-00020400: 7365 6c66 2c20 6e72 6561 6c2c 2076 6572  self, nreal, ver
-00020410: 626f 7365 3d76 6572 626f 7365 5f6d 6574  bose=verbose_met
-00020420: 686f 6473 290d 0a20 2020 2020 2020 2020  hods)..         
-00020430: 2020 2020 2020 2065 6e64 3d74 696d 652e         end=time.
-00020440: 7469 6d65 2829 0d0a 0d0a 2020 2020 2020  time()....      
-00020450: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00020460: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-00020470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020480: 7072 696e 7428 2254 696d 6520 656c 6170  print("Time elap
-00020490: 7365 6420 7b7d 2073 222e 666f 726d 6174  sed {} s".format
-000204a0: 286e 702e 726f 756e 6428 2865 6e64 202d  (np.round((end -
-000204b0: 2073 7461 7274 292c 2064 6563 696d 616c   start), decimal
-000204c0: 733d 3229 2929 0d0a 0d0a 2020 2020 2020  s=2)))....      
-000204d0: 2020 656e 643d 7469 6d65 2e74 696d 6528    end=time.time(
-000204e0: 290d 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-000204f0: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
-00020500: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00020510: 5c6e 2323 2320 7b7d 3a20 546f 7461 6c20  \n### {}: Total 
-00020520: 7469 6d65 2065 6c61 7073 6564 2066 6f72  time elapsed for
-00020530: 2063 6f6d 7075 7469 6e67 2066 6163 6965   computing facie
-00020540: 7320 2323 2322 2e66 6f72 6d61 7428 6e70  s ###".format(np
-00020550: 2e72 6f75 6e64 2828 656e 6420 2d20 7374  .round((end - st
-00020560: 6172 745f 746f 7429 2c20 6465 6369 6d61  art_tot), decima
-00020570: 6c73 3d32 2929 290d 0a0d 0a20 2020 2020  ls=2)))....     
-00020580: 2020 2069 6620 7365 6c66 2e77 7269 7465     if self.write
-00020590: 5f72 6573 756c 7473 3a0d 0a20 2020 2020  _results:..     
-000205a0: 2020 2020 2020 2023 2077 7269 7465 2072         # write r
-000205b0: 6573 756c 7473 0d0a 2020 2020 2020 2020  esults..        
-000205c0: 2020 2020 6661 5f64 6f6d 6169 6e73 3d73      fa_domains=s
-000205d0: 656c 662e 4765 6f6c 2e66 6163 6965 735f  elf.Geol.facies_
-000205e0: 646f 6d61 696e 730d 0a20 2020 2020 2020  domains..       
-000205f0: 2020 2020 2066 6f72 2069 7520 696e 2072       for iu in r
-00020600: 616e 6765 2873 656c 662e 6e72 6561 6c5f  ange(self.nreal_
-00020610: 756e 6974 7329 3a0d 0a20 2020 2020 2020  units):..       
-00020620: 2020 2020 2020 2020 2066 6f72 2069 6661           for ifa
-00020630: 2069 6e20 7261 6e67 6528 7365 6c66 2e6e   in range(self.n
-00020640: 7265 616c 5f66 6129 3a0d 0a20 2020 2020  real_fa):..     
-00020650: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00020660: 643d 6661 5f64 6f6d 6169 6e73 5b69 752c  d=fa_domains[iu,
-00020670: 2069 6661 5d0d 0a20 2020 2020 2020 2020   ifa]..         
-00020680: 2020 2020 2020 2020 2020 2066 6e61 6d65             fname
-00020690: 3d73 656c 662e 6e61 6d65 2b22 5f7b 7d5f  =self.name+"_{}_
-000206a0: 7b7d 2e66 6422 2e66 6f72 6d61 7428 6975  {}.fd".format(iu
-000206b0: 2c20 6966 6129 0d0a 2020 2020 2020 2020  , ifa)..        
-000206c0: 2020 2020 2020 2020 2020 2020 6670 6174              fpat
-000206d0: 683d 6f73 2e70 6174 682e 6a6f 696e 2873  h=os.path.join(s
-000206e0: 656c 662e 7773 2c20 666e 616d 6529 0d0a  elf.ws, fname)..
-000206f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020700: 2020 2020 7769 7468 206f 7065 6e28 6670      with open(fp
-00020710: 6174 682c 2022 7762 2229 2061 7320 663a  ath, "wb") as f:
-00020720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00020730: 2020 2020 2020 2020 2020 7069 636b 6c65            pickle
-00020740: 2e64 756d 7028 6664 2c20 6629 0d0a 0d0a  .dump(fd, f)....
-00020750: 2020 2020 2020 2020 2020 2020 6465 6c28              del(
-00020760: 7365 6c66 2e47 656f 6c2e 6661 6369 6573  self.Geol.facies
-00020770: 5f64 6f6d 6169 6e73 2920 2023 2064 656c  _domains)  # del
-00020780: 6574 6520 6661 6369 6573 2064 6f6d 6169  ete facies domai
-00020790: 6e20 746f 2066 7265 6520 736f 6d65 206d  n to free some m
-000207a0: 656d 6f72 790d 0a0d 0a20 2020 2020 2020  emory....       
-000207b0: 2073 656c 662e 6661 6369 6573 5f63 6f6d   self.facies_com
-000207c0: 7075 7465 643d 310d 0a0d 0a20 2020 2064  puted=1....    d
-000207d0: 6566 2063 6f6d 7075 7465 5f64 6f6d 6169  ef compute_domai
-000207e0: 6e28 7365 6c66 2c20 7331 2c20 7332 293a  n(self, s1, s2):
-000207f0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00020800: 0a20 2020 2020 2020 2052 6574 7572 6e20  .        Return 
-00020810: 6120 626f 6f6c 2032 4420 6172 7261 7920  a bool 2D array 
-00020820: 7468 6174 2064 6566 696e 6520 7468 6520  that define the 
-00020830: 646f 6d61 696e 2077 6865 7265 2074 6865  domain where the
-00020840: 2075 6e69 7473 0d0a 2020 2020 2020 2020   units..        
-00020850: 6578 6973 7420 2862 6574 7765 656e 2074  exist (between t
-00020860: 776f 2073 7572 6661 6365 732c 2073 3120  wo surfaces, s1 
-00020870: 616e 6420 7332 290d 0a0d 0a20 2020 2020  and s2)....     
-00020880: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00020890: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000208a0: 2d0d 0a20 2020 2020 2020 2073 312c 2073  -..        s1, s
-000208b0: 323a 2032 4420 6e64 6172 7261 7973 0d0a  2: 2D ndarrays..
-000208c0: 2020 2020 2020 2020 2020 2020 7477 6f20              two 
-000208d0: 7375 7266 6163 6573 206f 7665 7220 7468  surfaces over th
-000208e0: 6520 7369 6d75 6c61 7469 6f6e 2064 6f6d  e simulation dom
-000208f0: 6169 6e20 7369 7a65 3a20 286e 792c 206e  ain size: (ny, n
-00020900: 7829 0d0a 2020 2020 2020 2020 0d0a 2020  x)..        ..  
-00020910: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00020920: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00020930: 2020 2020 2020 2020 646f 6d61 696e 0d0a          domain..
-00020940: 2020 2020 2020 2020 2020 2020 3344 206e              3D n
-00020950: 6461 7272 6179 206f 6620 626f 6f6c 730d  darray of bools.
-00020960: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-00020970: 2020 2020 2020 2020 7a67 3d73 656c 662e          zg=self.
-00020980: 6765 745f 7a67 2829 0d0a 2020 2020 2020  get_zg()..      
-00020990: 2020 7867 3d73 656c 662e 6765 745f 7867    xg=self.get_xg
-000209a0: 2829 0d0a 2020 2020 2020 2020 7967 3d73  ()..        yg=s
-000209b0: 656c 662e 6765 745f 7967 2829 0d0a 2020  elf.get_yg()..  
-000209c0: 2020 2020 2020 737a 3d73 656c 662e 6765        sz=self.ge
-000209d0: 745f 737a 2829 0d0a 2020 2020 2020 2020  t_sz()..        
-000209e0: 6e78 3d73 656c 662e 6765 745f 6e78 2829  nx=self.get_nx()
-000209f0: 0d0a 2020 2020 2020 2020 6e79 3d73 656c  ..        ny=sel
-00020a00: 662e 6765 745f 6e79 2829 0d0a 2020 2020  f.get_ny()..    
-00020a10: 2020 2020 6e7a 3d73 656c 662e 6765 745f      nz=self.get_
-00020a20: 6e7a 2829 0d0a 0d0a 2020 2020 2020 2020  nz()....        
-00020a30: 746f 703d 7365 6c66 2e74 6f70 0d0a 2020  top=self.top..  
-00020a40: 2020 2020 2020 626f 743d 7365 6c66 2e62        bot=self.b
-00020a50: 6f74 0d0a 0d0a 2020 2020 2020 2020 7a30  ot....        z0
-00020a60: 3d7a 675b 305d 0d0a 2020 2020 2020 2020  =zg[0]..        
-00020a70: 7a31 3d7a 675b 2d31 5d0d 0a0d 0a20 2020  z1=zg[-1]....   
-00020a80: 2020 2020 2073 315b 7331 203c 207a 305d       s1[s1 < z0]
-00020a90: 3d7a 300d 0a20 2020 2020 2020 2073 315b  =z0..        s1[
-00020aa0: 7331 203e 207a 315d 3d7a 310d 0a20 2020  s1 > z1]=z1..   
-00020ab0: 2020 2020 2073 325b 7332 203c 207a 305d       s2[s2 < z0]
-00020ac0: 3d7a 300d 0a20 2020 2020 2020 2073 325b  =z0..        s2[
-00020ad0: 7332 203e 207a 315d 3d7a 310d 0a0d 0a20  s2 > z1]=z1.... 
-00020ae0: 2020 2020 2020 2069 6478 5f73 313d 286e         idx_s1=(n
-00020af0: 702e 726f 756e 6428 2873 312d 7a30 292f  p.round((s1-z0)/
-00020b00: 737a 2929 2e61 7374 7970 6528 696e 7429  sz)).astype(int)
-00020b10: 0d0a 2020 2020 2020 2020 6964 785f 7332  ..        idx_s2
-00020b20: 3d28 6e70 2e72 6f75 6e64 2828 7332 2d7a  =(np.round((s2-z
-00020b30: 3029 2f73 7a29 292e 6173 7479 7065 2869  0)/sz)).astype(i
-00020b40: 6e74 290d 0a0d 0a20 2020 2020 2020 2023  nt)....        #
-00020b50: 646f 6d61 696e 0d0a 2020 2020 2020 2020  domain..        
-00020b60: 613d 6e70 2e7a 6572 6f73 285b 6e7a 2c20  a=np.zeros([nz, 
-00020b70: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d62  ny, nx], dtype=b
-00020b80: 6f6f 6c29 0d0a 2020 2020 2020 2020 666f  ool)..        fo
-00020b90: 7220 6979 2069 6e20 7261 6e67 6528 6e79  r iy in range(ny
-00020ba0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00020bb0: 666f 7220 6978 2069 6e20 7261 6e67 6528  for ix in range(
-00020bc0: 6e78 293a 0d0a 2020 2020 2020 2020 2020  nx):..          
-00020bd0: 2020 2020 2020 615b 6964 785f 7332 5b69        a[idx_s2[i
-00020be0: 792c 2069 785d 3a20 6964 785f 7331 5b69  y, ix]: idx_s1[i
-00020bf0: 792c 2069 785d 2c20 6979 2c20 6978 5d3d  y, ix], iy, ix]=
-00020c00: 310d 0a0d 0a20 2020 2020 2020 2072 6574  1....        ret
-00020c10: 7572 6e20 610d 0a0d 0a0d 0a20 2020 2064  urn a......    d
-00020c20: 6566 2063 6f6d 7075 7465 5f70 726f 7028  ef compute_prop(
-00020c30: 7365 6c66 2c20 6e72 6561 6c3d 3129 3a0d  self, nreal=1):.
-00020c40: 0a20 2020 2020 2020 2023 544f 2044 4f20  .        #TO DO 
-00020c50: 2d2d 3e20 6164 6420 616e 206f 7074 696f  --> add an optio
-00020c60: 6e20 746f 2072 6573 696d 756c 6174 6520  n to resimulate 
-00020c70: 6f6e 6c79 2063 6572 7461 696e 2070 726f  only certain pro
-00020c80: 7065 7274 6965 7320 2865 2e67 2e20 2a61  perties (e.g. *a
-00020c90: 7267 7329 0d0a 0d0a 2020 2020 2020 2020  rgs)....        
-00020ca0: 2222 220d 0a20 2020 2020 2020 2050 6572  """..        Per
-00020cb0: 666f 726d 7320 7468 6520 636f 6d70 7574  forms the comput
-00020cc0: 6174 696f 6e20 6f66 2074 6865 2070 726f  ation of the pro
-00020cd0: 7065 7274 6965 7320 6164 6465 6420 746f  perties added to
-00020ce0: 2074 6865 2041 7263 6854 6162 6c65 0d0a   the ArchTable..
-00020cf0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00020d00: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00020d10: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00020d20: 2020 6e72 6561 6c3a 2069 6e74 0d0a 2020    nreal: int..  
-00020d30: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00020d40: 206f 6620 7265 616c 697a 6174 696f 6e73   of realizations
-00020d50: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-00020d60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00020d70: 6c65 6e28 7365 6c66 2e6c 6973 745f 7072  len(self.list_pr
-00020d80: 6f70 7329 203e 2030 2c20 224e 6f20 7072  ops) > 0, "No pr
-00020d90: 6f70 6572 7479 2068 6176 6520 6265 656e  operty have been
-00020da0: 2061 6464 6564 2074 6f20 4172 6368 5f74   added to Arch_t
-00020db0: 6162 6c65 206f 626a 6563 7422 0d0a 2020  able object"..  
-00020dc0: 2020 2020 2020 6173 7365 7274 206e 7265        assert nre
-00020dd0: 616c 203e 202d 312c 2022 596f 7520 6361  al > -1, "You ca
-00020de0: 6e6e 6f74 206d 616b 6520 6120 6e65 6761  nnot make a nega
-00020df0: 7469 7665 206e 756d 6265 7220 6f66 2072  tive number of r
-00020e00: 6561 6c69 7a61 7469 6f6e 732c 206e 6963  ealizations, nic
-00020e10: 6520 7472 7920 7468 6f22 0d0a 2020 2020  e try tho"..    
-00020e20: 2020 2020 6966 206e 7265 616c 3d3d 303a      if nreal==0:
-00020e30: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00020e40: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-00020e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020e60: 7072 696e 7428 2257 6172 6e69 6e67 3a20  print("Warning: 
-00020e70: 6e72 6561 6c20 6973 2073 6574 2074 6f20  nreal is set to 
-00020e80: 3022 290d 0a20 2020 2020 2020 2020 2020  0")..           
-00020e90: 2072 6574 7572 6e0d 0a20 2020 2020 2020   return..       
-00020ea0: 206e 702e 7261 6e64 6f6d 2e73 6565 6420   np.random.seed 
-00020eb0: 2873 656c 662e 7365 6564 2920 2320 7365  (self.seed) # se
-00020ec0: 7420 7365 6564 0d0a 2020 2020 2020 2020  t seed..        
-00020ed0: 7365 6c66 2e6e 7265 616c 5f70 726f 703d  self.nreal_prop=
-00020ee0: 6e72 6561 6c0d 0a20 2020 2020 2020 2078  nreal..        x
-00020ef0: 673d 7365 6c66 2e78 6763 0d0a 2020 2020  g=self.xgc..    
-00020f00: 2020 2020 7967 3d73 656c 662e 7967 630d      yg=self.ygc.
-00020f10: 0a20 2020 2020 2020 207a 673d 7365 6c66  .        zg=self
-00020f20: 2e7a 6763 0d0a 2020 2020 2020 2020 6e78  .zgc..        nx
-00020f30: 3d73 656c 662e 6765 745f 6e78 2829 0d0a  =self.get_nx()..
-00020f40: 2020 2020 2020 2020 6e79 3d73 656c 662e          ny=self.
-00020f50: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
-00020f60: 2020 6e7a 3d73 656c 662e 6765 745f 6e7a    nz=self.get_nz
-00020f70: 2829 0d0a 2020 2020 2020 2020 7830 3d73  ()..        x0=s
-00020f80: 656c 662e 6765 745f 6f78 2829 0d0a 2020  elf.get_ox()..  
-00020f90: 2020 2020 2020 7930 3d73 656c 662e 6765        y0=self.ge
-00020fa0: 745f 6f79 2829 0d0a 2020 2020 2020 2020  t_oy()..        
-00020fb0: 7a30 3d73 656c 662e 6765 745f 6f7a 2829  z0=self.get_oz()
-00020fc0: 0d0a 2020 2020 2020 2020 7378 3d73 656c  ..        sx=sel
-00020fd0: 662e 6765 745f 7378 2829 0d0a 2020 2020  f.get_sx()..    
-00020fe0: 2020 2020 7379 3d73 656c 662e 6765 745f      sy=self.get_
-00020ff0: 7379 2829 0d0a 2020 2020 2020 2020 737a  sy()..        sz
-00021000: 3d73 656c 662e 6765 745f 737a 2829 0d0a  =self.get_sz()..
-00021010: 2020 2020 2020 2020 6e72 6561 6c5f 756e          nreal_un
-00021020: 6974 733d 7365 6c66 2e6e 7265 616c 5f75  its=self.nreal_u
-00021030: 6e69 7473 0d0a 2020 2020 2020 2020 6e72  nits..        nr
-00021040: 6561 6c5f 6661 3d73 656c 662e 6e72 6561  eal_fa=self.nrea
-00021050: 6c5f 6661 0d0a 2020 2020 2020 2020 7365  l_fa..        se
-00021060: 6c66 2e47 656f 6c2e 7072 6f70 5f76 616c  lf.Geol.prop_val
-00021070: 7565 733d 7b7d 2023 7265 6d6f 7665 2070  ues={} #remove p
-00021080: 7265 7669 6f75 7320 7072 6f70 2073 696d  revious prop sim
-00021090: 756c 6174 696f 6e73 0d0a 0d0a 0d0a 2020  ulations......  
-000210a0: 2020 2020 2020 666f 7220 7072 6f70 2069        for prop i
-000210b0: 6e20 7365 6c66 2e6c 6973 745f 7072 6f70  n self.list_prop
-000210c0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000210d0: 636f 756e 7465 723d 300d 0a20 2020 2020  counter=0..     
-000210e0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-000210f0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-00021100: 2020 2020 2020 2020 2070 7269 6e74 2028           print (
-00021110: 2223 2323 207b 7d20 7b7d 2070 726f 7065  "### {} {} prope
-00021120: 7274 7920 6d6f 6465 6c73 2077 696c 6c20  rty models will 
-00021130: 6265 206d 6f64 656c 6564 2023 2323 222e  be modeled ###".
-00021140: 666f 726d 6174 286e 7265 616c 5f75 6e69  format(nreal_uni
-00021150: 7473 2a6e 7265 616c 5f66 612a 6e72 6561  ts*nreal_fa*nrea
-00021160: 6c2c 2070 726f 702e 6e61 6d65 2929 0d0a  l, prop.name))..
-00021170: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
-00021180: 5f76 616c 7565 733d 6e70 2e7a 6572 6f73  _values=np.zeros
-00021190: 285b 6e72 6561 6c5f 756e 6974 732c 206e  ([nreal_units, n
-000211a0: 7265 616c 5f66 612c 206e 7265 616c 2c20  real_fa, nreal, 
-000211b0: 6e7a 2c20 6e79 2c20 6e78 5d2c 2064 7479  nz, ny, nx], dty
-000211c0: 7065 3d6e 702e 666c 6f61 7433 3229 2023  pe=np.float32) #
-000211d0: 2070 726f 7065 7274 7920 7661 6c75 6573   property values
-000211e0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000211f0: 2348 440d 0a20 2020 2020 2020 2020 2020  #HD..           
-00021200: 2078 3d70 726f 702e 780d 0a20 2020 2020   x=prop.x..     
-00021210: 2020 2020 2020 2076 3d70 726f 702e 760d         v=prop.v.
-00021220: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00021230: 6c6f 6f70 0d0a 2020 2020 2020 2020 2020  loop..          
-00021240: 2020 666f 7220 6975 2069 6e20 7261 6e67    for iu in rang
-00021250: 6528 6e72 6561 6c5f 756e 6974 7329 3a20  e(nreal_units): 
-00021260: 2320 6c6f 6f70 206f 7665 7220 756e 6974  # loop over unit
-00021270: 7320 6d6f 6465 6c73 0d0a 2020 2020 2020  s models..      
-00021280: 2020 2020 2020 2020 2020 666f 7220 6966            for if
-00021290: 6120 696e 2072 616e 6765 286e 7265 616c  a in range(nreal
-000212a0: 5f66 6129 3a20 2320 6c6f 6f70 206f 7665  _fa): # loop ove
-000212b0: 7220 6c69 7468 6f6c 6f67 6963 616c 206d  r lithological m
-000212c0: 6f64 656c 730d 0a20 2020 2020 2020 2020  odels..         
-000212d0: 2020 2020 2020 2020 2020 204b 5f66 613d             K_fa=
-000212e0: 6e70 2e7a 6572 6f73 285b 6e72 6561 6c2c  np.zeros([nreal,
-000212f0: 206e 7a2c 206e 792c 206e 785d 2c20 6474   nz, ny, nx], dt
-00021300: 7970 653d 6e70 2e66 6c6f 6174 3332 290d  ype=np.float32).
-00021310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021320: 2020 2020 2066 6f72 2073 7472 6174 2069       for strat i
-00021330: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f75  n self.get_all_u
-00021340: 6e69 7473 2829 3a0d 0a20 2020 2020 2020  nits():..       
-00021350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021360: 2069 6620 7374 7261 742e 665f 6d65 7468   if strat.f_meth
-00021370: 6f64 2021 3d20 2253 7562 7069 6c65 223a  od != "Subpile":
-00021380: 2023 6469 7363 6172 6420 756e 6974 7320   #discard units 
-00021390: 6669 6c6c 6564 2062 7920 7375 6275 6e69  filled by subuni
-000213a0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-000213b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000213c0: 2320 6d61 736b 5f73 7472 6174 3d28 7365  # mask_strat=(se
-000213d0: 6c66 2e67 6574 5f75 6e69 7473 5f64 6f6d  lf.get_units_dom
-000213e0: 6169 6e73 5f72 6561 6c69 7a61 7469 6f6e  ains_realization
-000213f0: 7328 6975 2920 3d3d 2073 7472 6174 2e49  s(iu) == strat.I
-00021400: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-00021410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021420: 6d61 736b 5f73 7472 6174 3d28 7365 6c66  mask_strat=(self
-00021430: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
-00021440: 696e 735b 6975 5d20 3d3d 2073 7472 6174  ins[iu] == strat
-00021450: 2e49 4429 2020 2320 6d61 736b 2075 6e69  .ID)  # mask uni
-00021460: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-00021470: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021480: 6f72 2069 7465 2c66 6120 696e 2065 6e75  or ite,fa in enu
-00021490: 6d65 7261 7465 2873 7472 6174 2e6c 6973  merate(strat.lis
-000214a0: 745f 6661 6369 6573 293a 0d0a 0d0a 2020  t_facies):....  
+0001fd30: 2020 585f 7072 6564 203d 2078 7533 445b    X_pred = xu3D[
+0001fd40: 6d61 736b 2e66 6c61 7474 656e 2829 5d0d  mask.flatten()].
+0001fd50: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001fd60: 2020 2020 2020 2023 2066 6974 0d0a 2020         # fit..  
+0001fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd80: 2020 6e6e 203d 204e 6561 7265 7374 4e65    nn = NearestNe
+0001fd90: 6967 6862 6f72 7328 6e5f 6e65 6967 6862  ighbors(n_neighb
+0001fda0: 6f72 733d 3129 2e66 6974 2858 5f66 6974  ors=1).fit(X_fit
+0001fdb0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0001fdc0: 2020 2020 2020 2020 2023 7072 6564 0d0a           #pred..
+0001fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fde0: 2020 2020 7265 7320 3d20 6e6e 2e6b 6e65      res = nn.kne
+0001fdf0: 6967 6862 6f72 7328 585f 7072 6564 2c20  ighbors(X_pred, 
+0001fe00: 7265 7475 726e 5f64 6973 7461 6e63 653d  return_distance=
+0001fe10: 4661 6c73 652c 206e 5f6e 6569 6768 626f  False, n_neighbo
+0001fe20: 7273 3d31 290d 0a0d 0a20 2020 2020 2020  rs=1)....       
+0001fe30: 2020 2020 2020 2020 2020 2020 2023 2061               # a
+0001fe40: 7373 6967 6e0d 0a20 2020 2020 2020 2020  ssign..         
+0001fe50: 2020 2020 2020 2020 2020 2079 5f70 7265             y_pre
+0001fe60: 6420 3d20 795f 6669 745b 7265 735d 0d0a  d = y_fit[res]..
+0001fe70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe80: 2020 2020 6172 725f 7465 7374 203d 2061      arr_test = a
+0001fe90: 7272 2e63 6f70 7928 290d 0a20 2020 2020  rr.copy()..     
+0001fea0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001feb0: 7272 5f74 6573 745b 6d61 736b 5d20 3d20  rr_test[mask] = 
+0001fec0: 795f 7072 6564 5b3a 2c20 305d 2020 2320  y_pred[:, 0]  # 
+0001fed0: 7265 6173 7369 676e 2076 616c 7565 730d  reassign values.
+0001fee0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0001fef0: 2020 2020 2020 2073 656c 662e 4765 6f6c         self.Geol
+0001ff00: 2e75 6e69 7473 5f64 6f6d 6169 6e73 5b69  .units_domains[i
+0001ff10: 755d 203d 2061 7272 5f74 6573 740d 0a20  u] = arr_test.. 
+0001ff20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0001ff30: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0001ff40: 662e 7662 3a0d 0a20 2020 2020 2020 2020  f.vb:..         
+0001ff50: 2020 2020 2020 2070 7269 6e74 2822 496e         print("In
+0001ff60: 7661 6c69 6420 6d65 7468 6f64 2229 0d0a  valid method")..
+0001ff70: 0d0a 2020 2020 6465 6620 636f 6d70 7574  ..    def comput
+0001ff80: 655f 6661 6369 6573 2873 656c 662c 206e  e_facies(self, n
+0001ff90: 7265 616c 3d31 2c20 7665 7262 6f73 655f  real=1, verbose_
+0001ffa0: 6d65 7468 6f64 733d 3029 3a0d 0a0d 0a20  methods=0):.... 
+0001ffb0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001ffc0: 2020 2020 5065 7266 6f72 6d73 2074 6865      Performs the
+0001ffd0: 2063 6f6d 7075 7461 7469 6f6e 206f 6620   computation of 
+0001ffe0: 7468 6520 6661 6369 6573 0d0a 0d0a 2020  the facies....  
+0001fff0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00020000: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00020010: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6e72  ----..        nr
+00020020: 6561 6c3a 2069 6e74 0d0a 2020 2020 2020  eal: int..      
+00020030: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
+00020040: 7265 616c 697a 6174 696f 6e73 0d0a 2020  realizations..  
+00020050: 2020 2020 2020 7665 7262 6f73 655f 6d65        verbose_me
+00020060: 7468 6f64 733a 2069 6e74 0d0a 2020 2020  thods: int..    
+00020070: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
+00020080: 666f 7220 7468 6520 6661 6369 6573 206d  for the facies m
+00020090: 6574 686f 6473 2c20 3020 6279 2064 6566  ethods, 0 by def
+000200a0: 6175 6c74 0d0a 2020 2020 2020 2020 2222  ault..        ""
+000200b0: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
+000200c0: 6e72 6561 6c3d 3d30 3a0d 0a20 2020 2020  nreal==0:..     
+000200d0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000200e0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+000200f0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00020100: 5761 726e 696e 673a 206e 7265 616c 2073  Warning: nreal s
+00020110: 6574 2074 6f20 3022 290d 0a20 2020 2020  et to 0")..     
+00020120: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
+00020130: 2020 2020 2020 2023 6173 7365 7274 730d         #asserts.
+00020140: 0a20 2020 2020 2020 2061 6c6c 5f69 6473  .        all_ids
+00020150: 3d5b 5d0d 0a20 2020 2020 2020 2066 6f72  =[]..        for
+00020160: 2066 6120 696e 2073 656c 662e 6765 745f   fa in self.get_
+00020170: 616c 6c5f 6661 6369 6573 2829 3a0d 0a20  all_facies():.. 
+00020180: 2020 2020 2020 2020 2020 2069 6620 6661             if fa
+00020190: 2e49 4420 6e6f 7420 696e 2061 6c6c 5f69  .ID not in all_i
+000201a0: 6473 3a0d 0a20 2020 2020 2020 2020 2020  ds:..           
+000201b0: 2020 2020 2061 6c6c 5f69 6473 2e61 7070       all_ids.app
+000201c0: 656e 6428 6661 2e49 4429 0d0a 2020 2020  end(fa.ID)..    
+000201d0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000201e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000201f0: 6169 7365 2056 616c 7565 4572 726f 7220  aise ValueError 
+00020200: 2822 7b7d 2066 6163 6965 7320 696e 6465  ("{} facies inde
+00020210: 7820 6861 7320 6265 656e 2064 6566 696e  x has been defin
+00020220: 6564 206f 6e20 6d75 6c74 6970 6c65 2075  ed on multiple u
+00020230: 6e69 7473 2229 0d0a 0d0a 2020 2020 2020  nits")....      
+00020240: 2020 2373 7461 7274 0d0a 2020 2020 2020    #start..      
+00020250: 2020 7374 6172 745f 746f 743d 7469 6d65    start_tot=time
+00020260: 2e74 696d 6528 290d 0a20 2020 2020 2020  .time()..       
+00020270: 206e 702e 7261 6e64 6f6d 2e73 6565 6420   np.random.seed 
+00020280: 2873 656c 662e 7365 6564 2920 2320 7365  (self.seed) # se
+00020290: 7420 7365 6564 0d0a 0d0a 2020 2020 2020  t seed....      
+000202a0: 2020 2367 7269 640d 0a20 2020 2020 2020    #grid..       
+000202b0: 2078 673d 7365 6c66 2e78 670d 0a20 2020   xg=self.xg..   
+000202c0: 2020 2020 2079 673d 7365 6c66 2e79 670d       yg=self.yg.
+000202d0: 0a20 2020 2020 2020 207a 673d 7365 6c66  .        zg=self
+000202e0: 2e7a 670d 0a0d 0a20 2020 2020 2020 2023  .zg....        #
+000202f0: 696e 6974 6961 6c69 7a65 2061 7272 6179  initialize array
+00020300: 2061 6e64 2073 6574 206e 756d 6265 7220   and set number 
+00020310: 6f66 2072 6561 6c69 7a61 7469 6f6e 0d0a  of realization..
+00020320: 2020 2020 2020 2020 7365 6c66 2e6e 7265          self.nre
+00020330: 616c 5f66 613d 6e72 6561 6c0d 0a20 2020  al_fa=nreal..   
+00020340: 2020 2020 2073 656c 662e 4765 6f6c 2e66       self.Geol.f
+00020350: 6163 6965 735f 646f 6d61 696e 733d 6e70  acies_domains=np
+00020360: 2e7a 6572 6f73 285b 7365 6c66 2e6e 7265  .zeros([self.nre
+00020370: 616c 5f75 6e69 7473 2c20 6e72 6561 6c2c  al_units, nreal,
+00020380: 2073 656c 662e 6765 745f 6e7a 2829 2c20   self.get_nz(), 
+00020390: 7365 6c66 2e67 6574 5f6e 7928 292c 2073  self.get_ny(), s
+000203a0: 656c 662e 6765 745f 6e78 2829 5d2c 2064  elf.get_nx()], d
+000203b0: 7479 7065 3d6e 702e 696e 7438 290d 0a0d  type=np.int8)...
+000203c0: 0a20 2020 2020 2020 2066 6f72 2073 7472  .        for str
+000203d0: 6174 2069 6e20 7365 6c66 2e67 6574 5f61  at in self.get_a
+000203e0: 6c6c 5f75 6e69 7473 2829 3a20 2023 206c  ll_units():  # l
+000203f0: 6f6f 7020 6f76 6572 2073 7472 6174 690d  oop over strati.
+00020400: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00020410: 7374 7261 742e 636f 6e74 6163 7420 3d3d  strat.contact ==
+00020420: 2022 6f6e 6c61 7022 3a0d 0a20 2020 2020   "onlap":..     
+00020430: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00020440: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+00020450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020460: 2070 7269 6e74 2822 5c6e 2323 2320 556e   print("\n### Un
+00020470: 6974 207b 7d3a 2066 6163 6965 7320 7369  it {}: facies si
+00020480: 6d75 6c61 7469 6f6e 2077 6974 6820 7b7d  mulation with {}
+00020490: 206d 6574 686f 6420 2323 2323 222e 666f   method ####".fo
+000204a0: 726d 6174 2873 7472 6174 2e6e 616d 652c  rmat(strat.name,
+000204b0: 2073 7472 6174 2e66 5f6d 6574 686f 6429   strat.f_method)
+000204c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000204d0: 2020 2073 7461 7274 3d74 696d 652e 7469     start=time.ti
+000204e0: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
+000204f0: 2020 2020 2020 7374 7261 742e 636f 6d70        strat.comp
+00020500: 7574 655f 6661 6369 6573 2873 656c 662c  ute_facies(self,
+00020510: 206e 7265 616c 2c20 7665 7262 6f73 653d   nreal, verbose=
+00020520: 7665 7262 6f73 655f 6d65 7468 6f64 7329  verbose_methods)
+00020530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020540: 2020 656e 643d 7469 6d65 2e74 696d 6528    end=time.time(
+00020550: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00020560: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00020570: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+00020580: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00020590: 2822 5469 6d65 2065 6c61 7073 6564 207b  ("Time elapsed {
+000205a0: 7d20 7322 2e66 6f72 6d61 7428 6e70 2e72  } s".format(np.r
+000205b0: 6f75 6e64 2828 656e 6420 2d20 7374 6172  ound((end - star
+000205c0: 7429 2c20 6465 6369 6d61 6c73 3d32 2929  t), decimals=2))
+000205d0: 290d 0a0d 0a20 2020 2020 2020 2065 6e64  )....        end
+000205e0: 3d74 696d 652e 7469 6d65 2829 0d0a 2020  =time.time()..  
+000205f0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00020600: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
+00020610: 2020 2020 7072 696e 7428 225c 6e23 2323      print("\n###
+00020620: 207b 7d3a 2054 6f74 616c 2074 696d 6520   {}: Total time 
+00020630: 656c 6170 7365 6420 666f 7220 636f 6d70  elapsed for comp
+00020640: 7574 696e 6720 6661 6369 6573 2023 2323  uting facies ###
+00020650: 222e 666f 726d 6174 286e 702e 726f 756e  ".format(np.roun
+00020660: 6428 2865 6e64 202d 2073 7461 7274 5f74  d((end - start_t
+00020670: 6f74 292c 2064 6563 696d 616c 733d 3229  ot), decimals=2)
+00020680: 2929 0d0a 0d0a 2020 2020 2020 2020 6966  ))....        if
+00020690: 2073 656c 662e 7772 6974 655f 7265 7375   self.write_resu
+000206a0: 6c74 733a 0d0a 2020 2020 2020 2020 2020  lts:..          
+000206b0: 2020 2320 7772 6974 6520 7265 7375 6c74    # write result
+000206c0: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+000206d0: 615f 646f 6d61 696e 733d 7365 6c66 2e47  a_domains=self.G
+000206e0: 656f 6c2e 6661 6369 6573 5f64 6f6d 6169  eol.facies_domai
+000206f0: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
+00020700: 666f 7220 6975 2069 6e20 7261 6e67 6528  for iu in range(
+00020710: 7365 6c66 2e6e 7265 616c 5f75 6e69 7473  self.nreal_units
+00020720: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00020730: 2020 2020 666f 7220 6966 6120 696e 2072      for ifa in r
+00020740: 616e 6765 2873 656c 662e 6e72 6561 6c5f  ange(self.nreal_
+00020750: 6661 293a 0d0a 2020 2020 2020 2020 2020  fa):..          
+00020760: 2020 2020 2020 2020 2020 6664 3d66 615f            fd=fa_
+00020770: 646f 6d61 696e 735b 6975 2c20 6966 615d  domains[iu, ifa]
+00020780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00020790: 2020 2020 2020 666e 616d 653d 7365 6c66        fname=self
+000207a0: 2e6e 616d 652b 225f 7b7d 5f7b 7d2e 6664  .name+"_{}_{}.fd
+000207b0: 222e 666f 726d 6174 2869 752c 2069 6661  ".format(iu, ifa
+000207c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000207d0: 2020 2020 2020 2066 7061 7468 3d6f 732e         fpath=os.
+000207e0: 7061 7468 2e6a 6f69 6e28 7365 6c66 2e77  path.join(self.w
+000207f0: 732c 2066 6e61 6d65 290d 0a20 2020 2020  s, fname)..     
+00020800: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00020810: 6974 6820 6f70 656e 2866 7061 7468 2c20  ith open(fpath, 
+00020820: 2277 6222 2920 6173 2066 3a0d 0a20 2020  "wb") as f:..   
+00020830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020840: 2020 2020 2070 6963 6b6c 652e 6475 6d70       pickle.dump
+00020850: 2866 642c 2066 290d 0a0d 0a20 2020 2020  (fd, f)....     
+00020860: 2020 2020 2020 2064 656c 2873 656c 662e         del(self.
+00020870: 4765 6f6c 2e66 6163 6965 735f 646f 6d61  Geol.facies_doma
+00020880: 696e 7329 2020 2320 6465 6c65 7465 2066  ins)  # delete f
+00020890: 6163 6965 7320 646f 6d61 696e 2074 6f20  acies domain to 
+000208a0: 6672 6565 2073 6f6d 6520 6d65 6d6f 7279  free some memory
+000208b0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+000208c0: 2e66 6163 6965 735f 636f 6d70 7574 6564  .facies_computed
+000208d0: 3d31 0d0a 0d0a 2020 2020 6465 6620 636f  =1....    def co
+000208e0: 6d70 7574 655f 646f 6d61 696e 2873 656c  mpute_domain(sel
+000208f0: 662c 2073 312c 2073 3229 3a0d 0a0d 0a20  f, s1, s2):.... 
+00020900: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00020910: 2020 2020 5265 7475 726e 2061 2062 6f6f      Return a boo
+00020920: 6c20 3244 2061 7272 6179 2074 6861 7420  l 2D array that 
+00020930: 6465 6669 6e65 2074 6865 2064 6f6d 6169  define the domai
+00020940: 6e20 7768 6572 6520 7468 6520 756e 6974  n where the unit
+00020950: 730d 0a20 2020 2020 2020 2065 7869 7374  s..        exist
+00020960: 2028 6265 7477 6565 6e20 7477 6f20 7375   (between two su
+00020970: 7266 6163 6573 2c20 7331 2061 6e64 2073  rfaces, s1 and s
+00020980: 3229 0d0a 0d0a 2020 2020 2020 2020 5061  2)....        Pa
+00020990: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+000209a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000209b0: 2020 2020 2020 7331 2c20 7332 3a20 3244        s1, s2: 2D
+000209c0: 206e 6461 7272 6179 730d 0a20 2020 2020   ndarrays..     
+000209d0: 2020 2020 2020 2074 776f 2073 7572 6661         two surfa
+000209e0: 6365 7320 6f76 6572 2074 6865 2073 696d  ces over the sim
+000209f0: 756c 6174 696f 6e20 646f 6d61 696e 2073  ulation domain s
+00020a00: 697a 653a 2028 6e79 2c20 6e78 290d 0a20  ize: (ny, nx).. 
+00020a10: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00020a20: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00020a30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00020a40: 2020 2064 6f6d 6169 6e0d 0a20 2020 2020     domain..     
+00020a50: 2020 2020 2020 2033 4420 6e64 6172 7261         3D ndarra
+00020a60: 7920 6f66 2062 6f6f 6c73 0d0a 2020 2020  y of bools..    
+00020a70: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00020a80: 2020 207a 673d 7365 6c66 2e67 6574 5f7a     zg=self.get_z
+00020a90: 6728 290d 0a20 2020 2020 2020 2078 673d  g()..        xg=
+00020aa0: 7365 6c66 2e67 6574 5f78 6728 290d 0a20  self.get_xg().. 
+00020ab0: 2020 2020 2020 2079 673d 7365 6c66 2e67         yg=self.g
+00020ac0: 6574 5f79 6728 290d 0a20 2020 2020 2020  et_yg()..       
+00020ad0: 2073 7a3d 7365 6c66 2e67 6574 5f73 7a28   sz=self.get_sz(
+00020ae0: 290d 0a20 2020 2020 2020 206e 783d 7365  )..        nx=se
+00020af0: 6c66 2e67 6574 5f6e 7828 290d 0a20 2020  lf.get_nx()..   
+00020b00: 2020 2020 206e 793d 7365 6c66 2e67 6574       ny=self.get
+00020b10: 5f6e 7928 290d 0a20 2020 2020 2020 206e  _ny()..        n
+00020b20: 7a3d 7365 6c66 2e67 6574 5f6e 7a28 290d  z=self.get_nz().
+00020b30: 0a0d 0a20 2020 2020 2020 2074 6f70 3d73  ...        top=s
+00020b40: 656c 662e 746f 700d 0a20 2020 2020 2020  elf.top..       
+00020b50: 2062 6f74 3d73 656c 662e 626f 740d 0a0d   bot=self.bot...
+00020b60: 0a20 2020 2020 2020 207a 303d 7a67 5b30  .        z0=zg[0
+00020b70: 5d0d 0a20 2020 2020 2020 207a 313d 7a67  ]..        z1=zg
+00020b80: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
+00020b90: 7331 5b73 3120 3c20 7a30 5d3d 7a30 0d0a  s1[s1 < z0]=z0..
+00020ba0: 2020 2020 2020 2020 7331 5b73 3120 3e20          s1[s1 > 
+00020bb0: 7a31 5d3d 7a31 0d0a 2020 2020 2020 2020  z1]=z1..        
+00020bc0: 7332 5b73 3220 3c20 7a30 5d3d 7a30 0d0a  s2[s2 < z0]=z0..
+00020bd0: 2020 2020 2020 2020 7332 5b73 3220 3e20          s2[s2 > 
+00020be0: 7a31 5d3d 7a31 0d0a 0d0a 2020 2020 2020  z1]=z1....      
+00020bf0: 2020 6964 785f 7331 3d28 6e70 2e72 6f75    idx_s1=(np.rou
+00020c00: 6e64 2828 7331 2d7a 3029 2f73 7a29 292e  nd((s1-z0)/sz)).
+00020c10: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00020c20: 2020 2020 2069 6478 5f73 323d 286e 702e       idx_s2=(np.
+00020c30: 726f 756e 6428 2873 322d 7a30 292f 737a  round((s2-z0)/sz
+00020c40: 2929 2e61 7374 7970 6528 696e 7429 0d0a  )).astype(int)..
+00020c50: 0d0a 2020 2020 2020 2020 2364 6f6d 6169  ..        #domai
+00020c60: 6e0d 0a20 2020 2020 2020 2061 3d6e 702e  n..        a=np.
+00020c70: 7a65 726f 7328 5b6e 7a2c 206e 792c 206e  zeros([nz, ny, n
+00020c80: 785d 2c20 6474 7970 653d 626f 6f6c 290d  x], dtype=bool).
+00020c90: 0a20 2020 2020 2020 2066 6f72 2069 7920  .        for iy 
+00020ca0: 696e 2072 616e 6765 286e 7929 3a0d 0a20  in range(ny):.. 
+00020cb0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00020cc0: 7820 696e 2072 616e 6765 286e 7829 3a0d  x in range(nx):.
+00020cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020ce0: 2061 5b69 6478 5f73 325b 6979 2c20 6978   a[idx_s2[iy, ix
+00020cf0: 5d3a 2069 6478 5f73 315b 6979 2c20 6978  ]: idx_s1[iy, ix
+00020d00: 5d2c 2069 792c 2069 785d 3d31 0d0a 0d0a  ], iy, ix]=1....
+00020d10: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00020d20: 0d0a 0d0a 0d0a 2020 2020 6465 6620 636f  ......    def co
+00020d30: 6d70 7574 655f 7072 6f70 2873 656c 662c  mpute_prop(self,
+00020d40: 206e 7265 616c 3d31 293a 0d0a 2020 2020   nreal=1):..    
+00020d50: 2020 2020 2354 4f20 444f 202d 2d3e 2061      #TO DO --> a
+00020d60: 6464 2061 6e20 6f70 7469 6f6e 2074 6f20  dd an option to 
+00020d70: 7265 7369 6d75 6c61 7465 206f 6e6c 7920  resimulate only 
+00020d80: 6365 7274 6169 6e20 7072 6f70 6572 7469  certain properti
+00020d90: 6573 2028 652e 672e 202a 6172 6773 290d  es (e.g. *args).
+00020da0: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00020db0: 2020 2020 2020 2020 5065 7266 6f72 6d73          Performs
+00020dc0: 2074 6865 2063 6f6d 7075 7461 7469 6f6e   the computation
+00020dd0: 206f 6620 7468 6520 7072 6f70 6572 7469   of the properti
+00020de0: 6573 2061 6464 6564 2074 6f20 7468 6520  es added to the 
+00020df0: 4172 6368 5461 626c 650d 0a0d 0a20 2020  ArchTable....   
+00020e00: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00020e10: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00020e20: 2d2d 2d0d 0a20 2020 2020 2020 206e 7265  ---..        nre
+00020e30: 616c 3a20 696e 740d 0a20 2020 2020 2020  al: int..       
+00020e40: 2020 2020 206e 756d 6265 7220 6f66 2072       number of r
+00020e50: 6561 6c69 7a61 7469 6f6e 730d 0a20 2020  ealizations..   
+00020e60: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00020e70: 2020 2020 6173 7365 7274 206c 656e 2873      assert len(s
+00020e80: 656c 662e 6c69 7374 5f70 726f 7073 2920  elf.list_props) 
+00020e90: 3e20 302c 2022 4e6f 2070 726f 7065 7274  > 0, "No propert
+00020ea0: 7920 6861 7665 2062 6565 6e20 6164 6465  y have been adde
+00020eb0: 6420 746f 2041 7263 685f 7461 626c 6520  d to Arch_table 
+00020ec0: 6f62 6a65 6374 220d 0a20 2020 2020 2020  object"..       
+00020ed0: 2061 7373 6572 7420 6e72 6561 6c20 3e20   assert nreal > 
+00020ee0: 2d31 2c20 2259 6f75 2063 616e 6e6f 7420  -1, "You cannot 
+00020ef0: 6d61 6b65 2061 206e 6567 6174 6976 6520  make a negative 
+00020f00: 6e75 6d62 6572 206f 6620 7265 616c 697a  number of realiz
+00020f10: 6174 696f 6e73 2c20 6e69 6365 2074 7279  ations, nice try
+00020f20: 2074 686f 220d 0a20 2020 2020 2020 2069   tho"..        i
+00020f30: 6620 6e72 6561 6c3d 3d30 3a0d 0a20 2020  f nreal==0:..   
+00020f40: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00020f50: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+00020f60: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00020f70: 2822 5761 726e 696e 673a 206e 7265 616c  ("Warning: nreal
+00020f80: 2069 7320 7365 7420 746f 2030 2229 0d0a   is set to 0")..
+00020f90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00020fa0: 726e 0d0a 2020 2020 2020 2020 6e70 2e72  rn..        np.r
+00020fb0: 616e 646f 6d2e 7365 6564 2028 7365 6c66  andom.seed (self
+00020fc0: 2e73 6565 6429 2023 2073 6574 2073 6565  .seed) # set see
+00020fd0: 640d 0a20 2020 2020 2020 2073 656c 662e  d..        self.
+00020fe0: 6e72 6561 6c5f 7072 6f70 3d6e 7265 616c  nreal_prop=nreal
+00020ff0: 0d0a 2020 2020 2020 2020 7867 3d73 656c  ..        xg=sel
+00021000: 662e 7867 630d 0a20 2020 2020 2020 2079  f.xgc..        y
+00021010: 673d 7365 6c66 2e79 6763 0d0a 2020 2020  g=self.ygc..    
+00021020: 2020 2020 7a67 3d73 656c 662e 7a67 630d      zg=self.zgc.
+00021030: 0a20 2020 2020 2020 206e 783d 7365 6c66  .        nx=self
+00021040: 2e67 6574 5f6e 7828 290d 0a20 2020 2020  .get_nx()..     
+00021050: 2020 206e 793d 7365 6c66 2e67 6574 5f6e     ny=self.get_n
+00021060: 7928 290d 0a20 2020 2020 2020 206e 7a3d  y()..        nz=
+00021070: 7365 6c66 2e67 6574 5f6e 7a28 290d 0a20  self.get_nz().. 
+00021080: 2020 2020 2020 2078 303d 7365 6c66 2e67         x0=self.g
+00021090: 6574 5f6f 7828 290d 0a20 2020 2020 2020  et_ox()..       
+000210a0: 2079 303d 7365 6c66 2e67 6574 5f6f 7928   y0=self.get_oy(
+000210b0: 290d 0a20 2020 2020 2020 207a 303d 7365  )..        z0=se
+000210c0: 6c66 2e67 6574 5f6f 7a28 290d 0a20 2020  lf.get_oz()..   
+000210d0: 2020 2020 2073 783d 7365 6c66 2e67 6574       sx=self.get
+000210e0: 5f73 7828 290d 0a20 2020 2020 2020 2073  _sx()..        s
+000210f0: 793d 7365 6c66 2e67 6574 5f73 7928 290d  y=self.get_sy().
+00021100: 0a20 2020 2020 2020 2073 7a3d 7365 6c66  .        sz=self
+00021110: 2e67 6574 5f73 7a28 290d 0a20 2020 2020  .get_sz()..     
+00021120: 2020 206e 7265 616c 5f75 6e69 7473 3d73     nreal_units=s
+00021130: 656c 662e 6e72 6561 6c5f 756e 6974 730d  elf.nreal_units.
+00021140: 0a20 2020 2020 2020 206e 7265 616c 5f66  .        nreal_f
+00021150: 613d 7365 6c66 2e6e 7265 616c 5f66 610d  a=self.nreal_fa.
+00021160: 0a20 2020 2020 2020 2073 656c 662e 4765  .        self.Ge
+00021170: 6f6c 2e70 726f 705f 7661 6c75 6573 3d7b  ol.prop_values={
+00021180: 7d20 2372 656d 6f76 6520 7072 6576 696f  } #remove previo
+00021190: 7573 2070 726f 7020 7369 6d75 6c61 7469  us prop simulati
+000211a0: 6f6e 730d 0a0d 0a0d 0a20 2020 2020 2020  ons......       
+000211b0: 2066 6f72 2070 726f 7020 696e 2073 656c   for prop in sel
+000211c0: 662e 6c69 7374 5f70 726f 7073 3a0d 0a20  f.list_props:.. 
+000211d0: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
+000211e0: 6572 3d30 0d0a 2020 2020 2020 2020 2020  er=0..          
+000211f0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+00021200: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00021210: 2020 2020 7072 696e 7420 2822 2323 2320      print ("### 
+00021220: 7b7d 207b 7d20 7072 6f70 6572 7479 206d  {} {} property m
+00021230: 6f64 656c 7320 7769 6c6c 2062 6520 6d6f  odels will be mo
+00021240: 6465 6c65 6420 2323 2322 2e66 6f72 6d61  deled ###".forma
+00021250: 7428 6e72 6561 6c5f 756e 6974 732a 6e72  t(nreal_units*nr
+00021260: 6561 6c5f 6661 2a6e 7265 616c 2c20 7072  eal_fa*nreal, pr
+00021270: 6f70 2e6e 616d 6529 290d 0a20 2020 2020  op.name))..     
+00021280: 2020 2020 2020 2070 726f 705f 7661 6c75         prop_valu
+00021290: 6573 3d6e 702e 7a65 726f 7328 5b6e 7265  es=np.zeros([nre
+000212a0: 616c 5f75 6e69 7473 2c20 6e72 6561 6c5f  al_units, nreal_
+000212b0: 6661 2c20 6e72 6561 6c2c 206e 7a2c 206e  fa, nreal, nz, n
+000212c0: 792c 206e 785d 2c20 6474 7970 653d 6e70  y, nx], dtype=np
+000212d0: 2e66 6c6f 6174 3332 2920 2320 7072 6f70  .float32) # prop
+000212e0: 6572 7479 2076 616c 7565 730d 0a0d 0a20  erty values.... 
+000212f0: 2020 2020 2020 2020 2020 2023 4844 0d0a             #HD..
+00021300: 2020 2020 2020 2020 2020 2020 783d 7072              x=pr
+00021310: 6f70 2e78 0d0a 2020 2020 2020 2020 2020  op.x..          
+00021320: 2020 763d 7072 6f70 2e76 0d0a 0d0a 2020    v=prop.v....  
+00021330: 2020 2020 2020 2020 2020 236c 6f6f 700d            #loop.
+00021340: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00021350: 2069 7520 696e 2072 616e 6765 286e 7265   iu in range(nre
+00021360: 616c 5f75 6e69 7473 293a 2023 206c 6f6f  al_units): # loo
+00021370: 7020 6f76 6572 2075 6e69 7473 206d 6f64  p over units mod
+00021380: 656c 730d 0a20 2020 2020 2020 2020 2020  els..           
+00021390: 2020 2020 2066 6f72 2069 6661 2069 6e20       for ifa in 
+000213a0: 7261 6e67 6528 6e72 6561 6c5f 6661 293a  range(nreal_fa):
+000213b0: 2023 206c 6f6f 7020 6f76 6572 206c 6974   # loop over lit
+000213c0: 686f 6c6f 6769 6361 6c20 6d6f 6465 6c73  hological models
+000213d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000213e0: 2020 2020 2020 4b5f 6661 3d6e 702e 7a65        K_fa=np.ze
+000213f0: 726f 7328 5b6e 7265 616c 2c20 6e7a 2c20  ros([nreal, nz, 
+00021400: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d6e  ny, nx], dtype=n
+00021410: 702e 666c 6f61 7433 3229 0d0a 2020 2020  p.float32)..    
+00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021430: 666f 7220 7374 7261 7420 696e 2073 656c  for strat in sel
+00021440: 662e 6765 745f 616c 6c5f 756e 6974 7328  f.get_all_units(
+00021450: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00021460: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00021470: 7472 6174 2e66 5f6d 6574 686f 6420 213d  trat.f_method !=
+00021480: 2022 5375 6270 696c 6522 3a20 2364 6973   "Subpile": #dis
+00021490: 6361 7264 2075 6e69 7473 2066 696c 6c65  card units fille
+000214a0: 6420 6279 2073 7562 756e 6974 730d 0a20  d by subunits.. 
 000214b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214c0: 2020 2020 2020 2020 2020 2020 2020 2363                #c
-000214d0: 7265 6174 6520 6d61 736b 2066 6163 6965  reate mask facie
-000214e0: 7320 666f 7220 7072 6f70 2073 696d 756c  s for prop simul
-000214f0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
-00021500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021510: 2020 2020 2020 2023 2066 6163 6965 735f         # facies_
-00021520: 646f 6d61 696e 3d73 656c 662e 6765 745f  domain=self.get_
-00021530: 6661 6369 6573 2869 752c 2069 6661 2c20  facies(iu, ifa, 
-00021540: 616c 6c5f 6461 7461 3d46 616c 7365 290d  all_data=False).
-00021550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021570: 2066 6163 6965 735f 646f 6d61 696e 3d73   facies_domain=s
-00021580: 656c 662e 4765 6f6c 2e66 6163 6965 735f  elf.Geol.facies_
-00021590: 646f 6d61 696e 735b 6975 2c20 6966 615d  domains[iu, ifa]
-000215a0: 2e63 6f70 7928 2920 2023 2067 6174 6865  .copy()  # gathe
-000215b0: 7220 6120 7265 616c 697a 6174 696f 6e20  r a realization 
-000215c0: 6f66 2066 6163 6965 7320 646f 6d61 696e  of facies domain
-000215d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000215e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000215f0: 2020 6661 6369 6573 5f64 6f6d 6169 6e5b    facies_domain[
-00021600: 6661 6369 6573 5f64 6f6d 6169 6e20 213d  facies_domain !=
-00021610: 2066 612e 4944 5d3d 3020 2023 2073 6574   fa.ID]=0  # set
-00021620: 2030 2074 6f20 6f74 6865 7220 6661 6369   0 to other faci
-00021630: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-00021640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021650: 2020 2020 6661 6369 6573 5f64 6f6d 6169      facies_domai
-00021660: 6e5b 7e6d 6173 6b5f 7374 7261 745d 3d30  n[~mask_strat]=0
-00021670: 2020 2320 7365 7420 3020 6f75 7473 6964    # set 0 outsid
-00021680: 6520 6f66 2074 6865 2073 7472 6174 6920  e of the strati 
-00021690: 746f 2073 696d 756c 6174 6520 7361 6d65  to simulate same
-000216a0: 2066 6163 6965 7320 6275 7420 696e 206f   facies but in o
-000216b0: 7468 6572 2073 7472 6174 2069 6e64 6570  ther strat indep
-000216c0: 656e 6461 6e74 656c 790d 0a20 2020 2020  endantely..     
-000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000216e0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-000216f0: 6661 6369 6573 3d66 6163 6965 735f 646f  facies=facies_do
-00021700: 6d61 696e 2e63 6f70 7928 290d 0a20 2020  main.copy()..   
-00021710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021720: 2020 2020 2020 2020 2020 2020 206d 6173               mas
-00021730: 6b5f 6661 6369 6573 5b6d 6173 6b5f 6661  k_facies[mask_fa
-00021740: 6369 6573 2021 3d20 305d 3d31 2020 2320  cies != 0]=1  # 
-00021750: 7365 7420 746f 2031 2066 6f72 206d 6173  set to 1 for mas
-00021760: 6b0d 0a0d 0a20 2020 2020 2020 2020 2020  k....           
-00021770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021780: 2020 2020 2023 7369 6d75 6c61 7465 0d0a       #simulate..
-00021790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000217a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000217b0: 6966 2028 6661 2069 6e20 7072 6f70 2e66  if (fa in prop.f
-000217c0: 6163 6965 7329 2061 6e64 2028 6661 2e49  acies) and (fa.I
-000217d0: 4420 696e 2066 6163 6965 735f 646f 6d61  D in facies_doma
-000217e0: 696e 293a 2023 2073 696d 756c 6174 696f  in): # simulatio
-000217f0: 6e20 6f66 2074 6865 2070 726f 7065 7274  n of the propert
-00021800: 7920 2863 6865 636b 2069 6620 6661 6369  y (check if faci
-00021810: 6573 2069 7320 696e 7369 6465 2073 7472  es is inside str
-00021820: 6174 2075 6e69 7429 0d0a 2020 2020 2020  at unit)..      
-00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021840: 2020 2020 2020 2020 2020 2020 2020 693d                i=
-00021850: 7072 6f70 2e66 6163 6965 732e 696e 6465  prop.facies.inde
-00021860: 7828 6661 2920 2320 7265 7472 6965 7665  x(fa) # retrieve
-00021870: 2069 6e64 6578 0d0a 2020 2020 2020 2020   index..        
+000214c0: 2020 2020 2020 2020 2020 2023 206d 6173             # mas
+000214d0: 6b5f 7374 7261 743d 2873 656c 662e 6765  k_strat=(self.ge
+000214e0: 745f 756e 6974 735f 646f 6d61 696e 735f  t_units_domains_
+000214f0: 7265 616c 697a 6174 696f 6e73 2869 7529  realizations(iu)
+00021500: 203d 3d20 7374 7261 742e 4944 290d 0a20   == strat.ID).. 
+00021510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021520: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00021530: 7374 7261 743d 2873 656c 662e 4765 6f6c  strat=(self.Geol
+00021540: 2e75 6e69 7473 5f64 6f6d 6169 6e73 5b69  .units_domains[i
+00021550: 755d 203d 3d20 7374 7261 742e 4944 2920  u] == strat.ID) 
+00021560: 2023 206d 6173 6b20 756e 6974 0d0a 2020   # mask unit..  
+00021570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021580: 2020 2020 2020 2020 2020 666f 7220 6974            for it
+00021590: 652c 6661 2069 6e20 656e 756d 6572 6174  e,fa in enumerat
+000215a0: 6528 7374 7261 742e 6c69 7374 5f66 6163  e(strat.list_fac
+000215b0: 6965 7329 3a0d 0a0d 0a20 2020 2020 2020  ies):....       
+000215c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000215d0: 2020 2020 2020 2020 2023 6372 6561 7465           #create
+000215e0: 206d 6173 6b20 6661 6369 6573 2066 6f72   mask facies for
+000215f0: 2070 726f 7020 7369 6d75 6c61 7469 6f6e   prop simulation
+00021600: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021620: 2020 2320 6661 6369 6573 5f64 6f6d 6169    # facies_domai
+00021630: 6e3d 7365 6c66 2e67 6574 5f66 6163 6965  n=self.get_facie
+00021640: 7328 6975 2c20 6966 612c 2061 6c6c 5f64  s(iu, ifa, all_d
+00021650: 6174 613d 4661 6c73 6529 0d0a 2020 2020  ata=False)..    
+00021660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021670: 2020 2020 2020 2020 2020 2020 6661 6369              faci
+00021680: 6573 5f64 6f6d 6169 6e3d 7365 6c66 2e47  es_domain=self.G
+00021690: 656f 6c2e 6661 6369 6573 5f64 6f6d 6169  eol.facies_domai
+000216a0: 6e73 5b69 752c 2069 6661 5d2e 636f 7079  ns[iu, ifa].copy
+000216b0: 2829 2020 2320 6761 7468 6572 2061 2072  ()  # gather a r
+000216c0: 6561 6c69 7a61 7469 6f6e 206f 6620 6661  ealization of fa
+000216d0: 6369 6573 2064 6f6d 6169 6e0d 0a20 2020  cies domain..   
+000216e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216f0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
+00021700: 6965 735f 646f 6d61 696e 5b66 6163 6965  ies_domain[facie
+00021710: 735f 646f 6d61 696e 2021 3d20 6661 2e49  s_domain != fa.I
+00021720: 445d 3d30 2020 2320 7365 7420 3020 746f  D]=0  # set 0 to
+00021730: 206f 7468 6572 2066 6163 6965 730d 0a20   other facies.. 
+00021740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021750: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00021760: 6163 6965 735f 646f 6d61 696e 5b7e 6d61  acies_domain[~ma
+00021770: 736b 5f73 7472 6174 5d3d 3020 2023 2073  sk_strat]=0  # s
+00021780: 6574 2030 206f 7574 7369 6465 206f 6620  et 0 outside of 
+00021790: 7468 6520 7374 7261 7469 2074 6f20 7369  the strati to si
+000217a0: 6d75 6c61 7465 2073 616d 6520 6661 6369  mulate same faci
+000217b0: 6573 2062 7574 2069 6e20 6f74 6865 7220  es but in other 
+000217c0: 7374 7261 7420 696e 6465 7065 6e64 616e  strat independan
+000217d0: 7465 6c79 0d0a 2020 2020 2020 2020 2020  tely..          
+000217e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000217f0: 2020 2020 2020 6d61 736b 5f66 6163 6965        mask_facie
+00021800: 733d 6661 6369 6573 5f64 6f6d 6169 6e2e  s=facies_domain.
+00021810: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
+00021820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021830: 2020 2020 2020 2020 6d61 736b 5f66 6163          mask_fac
+00021840: 6965 735b 6d61 736b 5f66 6163 6965 7320  ies[mask_facies 
+00021850: 213d 2030 5d3d 3120 2023 2073 6574 2074  != 0]=1  # set t
+00021860: 6f20 3120 666f 7220 6d61 736b 0d0a 0d0a  o 1 for mask....
+00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021890: 2020 2020 2020 2020 2020 2020 6d3d 7072              m=pr
-000218a0: 6f70 2e6d 6561 6e73 5b69 5d20 236d 6561  op.means[i] #mea
-000218b0: 6e20 7661 6c75 650d 0a20 2020 2020 2020  n value..       
-000218c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000218d0: 2020 2020 2020 2020 2020 2020 2063 6f76               cov
-000218e0: 6d6f 6465 6c3d 7072 6f70 2e63 6f76 6d6f  model=prop.covmo
-000218f0: 6465 6c73 5b69 5d20 2320 636f 7661 7269  dels[i] # covari
-00021900: 616e 6365 206d 6f64 656c 2075 7365 640d  ance model used.
-00021910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021930: 2020 2020 206d 6574 686f 643d 7072 6f70       method=prop
-00021940: 2e69 6e74 5b69 5d20 236d 6574 686f 6420  .int[i] #method 
-00021950: 6f66 2069 6e74 6572 706f 6c61 7469 6f6e  of interpolation
-00021960: 2028 7367 7320 6f72 2066 6674 290d 0a0d   (sgs or fft)...
-00021970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021990: 2020 2020 2069 6620 6d65 7468 6f64 203d       if method =
-000219a0: 3d20 2266 6674 223a 0d0a 2020 2020 2020  = "fft":..      
-000219b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219d0: 2020 7369 6d73 3d67 7266 2e67 7266 3344    sims=grf.grf3D
-000219e0: 2863 6f76 6d6f 6465 6c2c 205b 6e78 2c20  (covmodel, [nx, 
-000219f0: 6e79 2c20 6e7a 5d2c 205b 7378 2c20 7379  ny, nz], [sx, sy
-00021a00: 2c20 737a 5d2c 205b 7830 2c20 7930 2c20  , sz], [x0, y0, 
-00021a10: 7a30 5d2c 0d0a 2020 2020 2020 2020 2020  z0],..          
+00021890: 2373 696d 756c 6174 650d 0a20 2020 2020  #simulate..     
+000218a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218b0: 2020 2020 2020 2020 2020 2069 6620 2866             if (f
+000218c0: 6120 696e 2070 726f 702e 6661 6369 6573  a in prop.facies
+000218d0: 2920 616e 6420 2866 612e 4944 2069 6e20  ) and (fa.ID in 
+000218e0: 6661 6369 6573 5f64 6f6d 6169 6e29 3a20  facies_domain): 
+000218f0: 2320 7369 6d75 6c61 7469 6f6e 206f 6620  # simulation of 
+00021900: 7468 6520 7072 6f70 6572 7479 2028 6368  the property (ch
+00021910: 6563 6b20 6966 2066 6163 6965 7320 6973  eck if facies is
+00021920: 2069 6e73 6964 6520 7374 7261 7420 756e   inside strat un
+00021930: 6974 290d 0a20 2020 2020 2020 2020 2020  it)..           
+00021940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021950: 2020 2020 2020 2020 2069 3d70 726f 702e           i=prop.
+00021960: 6661 6369 6573 2e69 6e64 6578 2866 6129  facies.index(fa)
+00021970: 2023 2072 6574 7269 6576 6520 696e 6465   # retrieve inde
+00021980: 780d 0a20 2020 2020 2020 2020 2020 2020  x..             
+00021990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219a0: 2020 2020 2020 206d 3d70 726f 702e 6d65         m=prop.me
+000219b0: 616e 735b 695d 2023 6d65 616e 2076 616c  ans[i] #mean val
+000219c0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+000219d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219e0: 2020 2020 2020 2020 636f 766d 6f64 656c          covmodel
+000219f0: 3d70 726f 702e 636f 766d 6f64 656c 735b  =prop.covmodels[
+00021a00: 695d 2023 2063 6f76 6172 6961 6e63 6520  i] # covariance 
+00021a10: 6d6f 6465 6c20 7573 6564 0d0a 2020 2020  model used..    
 00021a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a40: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00021a50: 7265 616c 3d6e 7265 616c 2c20 6d65 616e  real=nreal, mean
-00021a60: 3d6d 2c20 783d 782c 2076 3d76 2c20 7072  =m, x=x, v=v, pr
-00021a70: 696e 7449 6e66 6f3d 4661 6c73 6529 0d0a  intInfo=False)..
+00021a40: 6d65 7468 6f64 3d70 726f 702e 696e 745b  method=prop.int[
+00021a50: 695d 2023 6d65 7468 6f64 206f 6620 696e  i] #method of in
+00021a60: 7465 7270 6f6c 6174 696f 6e20 2873 6773  terpolation (sgs
+00021a70: 206f 7220 6666 7429 0d0a 0d0a 2020 2020   or fft)....    
 00021a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021aa0: 2020 2020 656c 6966 206d 6574 686f 6420      elif method 
-00021ab0: 3d3d 2022 686f 6d6f 6765 6e6f 7573 223a  == "homogenous":
-00021ac0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ae0: 2020 2020 2020 2020 2020 7369 6d73 3d6e            sims=n
-00021af0: 702e 6f6e 6573 285b 6e72 6561 6c2c 206e  p.ones([nreal, n
-00021b00: 7a2c 206e 792c 206e 785d 292a 6d0d 0a20  z, ny, nx])*m.. 
-00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b30: 2020 2020 2020 2069 6620 7820 6973 206e         if x is n
-00021b40: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-00021b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b70: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00021b80: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
+00021aa0: 6966 206d 6574 686f 6420 3d3d 2022 6666  if method == "ff
+00021ab0: 7422 3a0d 0a20 2020 2020 2020 2020 2020  t":..           
+00021ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ad0: 2020 2020 2020 2020 2020 2020 2073 696d               sim
+00021ae0: 733d 6772 662e 6772 6633 4428 636f 766d  s=grf.grf3D(covm
+00021af0: 6f64 656c 2c20 5b6e 782c 206e 792c 206e  odel, [nx, ny, n
+00021b00: 7a5d 2c20 5b73 782c 2073 792c 2073 7a5d  z], [sx, sy, sz]
+00021b10: 2c20 5b78 302c 2079 302c 207a 305d 2c0d  , [x0, y0, z0],.
+00021b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b50: 2020 2020 2020 2020 2020 6e72 6561 6c3d            nreal=
+00021b60: 6e72 6561 6c2c 206d 6561 6e3d 6d2c 2078  nreal, mean=m, x
+00021b70: 3d78 2c20 763d 762c 2070 7269 6e74 496e  =x, v=v, printIn
+00021b80: 666f 3d46 616c 7365 290d 0a20 2020 2020  fo=False)..     
 00021b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bb0: 2020 2020 2020 2020 7072 696e 7428 2268          print("h
-00021bc0: 6f6d 6f67 656e 6f75 7320 6d65 7468 6f64  omogenous method
-00021bd0: 2063 686f 7365 6e20 2120 5761 726e 696e   chosen ! Warnin
-00021be0: 673a 2053 6f6d 6520 4844 2063 616e 2062  g: Some HD can b
-00021bf0: 6520 6e6f 7420 7265 7370 6563 7465 6422  e not respected"
-00021c00: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00021c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c20: 2020 2020 2020 2020 2065 6c69 6620 6d65           elif me
-00021c30: 7468 6f64 203d 3d20 2268 6f6d 6f67 656e  thod == "homogen
-00021c40: 6f75 735f 756e 6966 6f72 6d22 3a0d 0a20  ous_uniform":.. 
-00021c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ba0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00021bb0: 6c69 6620 6d65 7468 6f64 203d 3d20 2268  lif method == "h
+00021bc0: 6f6d 6f67 656e 6f75 7322 3a0d 0a20 2020  omogenous":..   
+00021bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021bf0: 2020 2020 2073 696d 733d 6e70 2e6f 6e65       sims=np.one
+00021c00: 7328 5b6e 7265 616c 2c20 6e7a 2c20 6e79  s([nreal, nz, ny
+00021c10: 2c20 6e78 5d29 2a6d 0d0a 2020 2020 2020  , nx])*m..      
+00021c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c40: 2020 6966 2078 2069 7320 6e6f 7420 4e6f    if x is not No
+00021c50: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
 00021c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c70: 2020 2020 2020 2064 6174 203d 206e 702e         dat = np.
-00021c80: 7261 6e64 6f6d 2e75 6e69 666f 726d 286d  random.uniform(m
-00021c90: 5b30 5d2c 206d 5b31 5d2c 206e 7265 616c  [0], m[1], nreal
-00021ca0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00021c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c80: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
+00021c90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00021ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cc0: 2020 2020 2020 2020 2020 2073 696d 733d             sims=
-00021cd0: 6e70 2e6f 6e65 7328 5b6e 7265 616c 2c20  np.ones([nreal, 
-00021ce0: 6e7a 2c20 6e79 2c20 6e78 5d29 202a 2064  nz, ny, nx]) * d
-00021cf0: 6174 5b3a 2c6e 702e 6e65 7761 7869 732c  at[:,np.newaxis,
-00021d00: 6e70 2e6e 6577 6178 6973 2c6e 702e 6e65  np.newaxis,np.ne
-00021d10: 7761 7869 735d 0d0a 2020 2020 2020 2020  waxis]..        
+00021cc0: 2020 2070 7269 6e74 2822 686f 6d6f 6765     print("homoge
+00021cd0: 6e6f 7573 206d 6574 686f 6420 6368 6f73  nous method chos
+00021ce0: 656e 2021 2057 6172 6e69 6e67 3a20 536f  en ! Warning: So
+00021cf0: 6d65 2048 4420 6361 6e20 6265 206e 6f74  me HD can be not
+00021d00: 2072 6573 7065 6374 6564 2229 0d0a 0d0a   respected")....
+00021d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d40: 6966 2078 2069 7320 6e6f 7420 4e6f 6e65  if x is not None
-00021d50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00021d30: 2020 2020 656c 6966 206d 6574 686f 6420      elif method 
+00021d40: 3d3d 2022 686f 6d6f 6765 6e6f 7573 5f75  == "homogenous_u
+00021d50: 6e69 666f 726d 223a 0d0a 2020 2020 2020  niform":..      
 00021d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00021d80: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-00021d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d80: 2020 6461 7420 3d20 6e70 2e72 616e 646f    dat = np.rando
+00021d90: 6d2e 756e 6966 6f72 6d28 6d5b 305d 2c20  m.uniform(m[0], 
+00021da0: 6d5b 315d 2c20 6e72 6561 6c29 0d0a 2020  m[1], nreal)..  
 00021db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021dc0: 2070 7269 6e74 2822 686f 6d6f 6765 6e6f   print("homogeno
-00021dd0: 7573 206d 6574 686f 6420 6368 6f73 656e  us method chosen
-00021de0: 2021 2057 6172 6e69 6e67 3a20 536f 6d65   ! Warning: Some
-00021df0: 2048 4420 6361 6e20 6265 206e 6f74 2072   HD can be not r
-00021e00: 6573 7065 6374 6564 2229 0d0a 0d0a 2020  espected")....  
-00021e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e30: 2020 656c 6966 206d 6574 686f 6420 3d3d    elif method ==
-00021e40: 2022 7367 7322 3a0d 0a0d 0a20 2020 2020   "sgs":....     
-00021e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021dd0: 2020 2020 2020 7369 6d73 3d6e 702e 6f6e        sims=np.on
+00021de0: 6573 285b 6e72 6561 6c2c 206e 7a2c 206e  es([nreal, nz, n
+00021df0: 792c 206e 785d 2920 2a20 6461 745b 3a2c  y, nx]) * dat[:,
+00021e00: 6e70 2e6e 6577 6178 6973 2c6e 702e 6e65  np.newaxis,np.ne
+00021e10: 7761 7869 732c 6e70 2e6e 6577 6178 6973  waxis,np.newaxis
+00021e20: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00021e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e40: 2020 2020 2020 2020 2020 2069 6620 7820             if x 
+00021e50: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
 00021e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e70: 2020 2073 696d 7320 3d20 6763 692e 7369     sims = gci.si
-00021e80: 6d75 6c61 7465 3344 2863 6f76 6d6f 6465  mulate3D(covmode
-00021e90: 6c2c 205b 6e78 2c20 206e 792c 2020 6e7a  l, [nx,  ny,  nz
-00021ea0: 5d2c 2020 5b73 782c 2020 7379 2c20 2073  ],  [sx,  sy,  s
-00021eb0: 7a5d 2c20 205b 7830 2c20 2079 302c 2020  z],  [x0,  y0,  
-00021ec0: 7a30 5d2c 0d0a 2020 2020 2020 2020 2020  z0],..          
-00021ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f00: 2020 206e 7265 616c 3d6e 7265 616c 2c20     nreal=nreal, 
-00021f10: 6d65 616e 3d6d 2c20 6d61 736b 3d6d 6173  mean=m, mask=mas
-00021f20: 6b5f 6661 6369 6573 2c20 783d 782c 2076  k_facies, x=x, v
-00021f30: 3d76 2c20 7665 7262 6f73 653d 302c 206e  =v, verbose=0, n
-00021f40: 7468 7265 6164 733d 7365 6c66 2e6e 6370  threads=self.ncp
-00021f50: 752c 2073 6565 643d 7365 6c66 2e73 6565  u, seed=self.see
-00021f60: 6420 2b20 6975 2a31 3030 3030 202b 2069  d + iu*10000 + i
-00021f70: 7465 2a31 3030 202b 2069 6661 295b 2269  te*100 + ifa)["i
-00021f80: 6d61 6765 225d 2e76 616c 0d0a 0d0a 2020  mage"].val....  
-00021f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021fb0: 2020 2020 2020 7369 6d73 3d6e 702e 6e61        sims=np.na
-00021fc0: 6e5f 746f 5f6e 756d 2873 696d 7329 2023  n_to_num(sims) #
-00021fd0: 7265 6d6f 7665 206e 616e 0d0a 0d0a 2020  remove nan....  
+00021e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e80: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00021e90: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00021ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ec0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00021ed0: 7428 2268 6f6d 6f67 656e 6f75 7320 6d65  t("homogenous me
+00021ee0: 7468 6f64 2063 686f 7365 6e20 2120 5761  thod chosen ! Wa
+00021ef0: 726e 696e 673a 2053 6f6d 6520 4844 2063  rning: Some HD c
+00021f00: 616e 2062 6520 6e6f 7420 7265 7370 6563  an be not respec
+00021f10: 7465 6422 290d 0a0d 0a20 2020 2020 2020  ted")....       
+00021f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f30: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00021f40: 6620 6d65 7468 6f64 203d 3d20 2273 6773  f method == "sgs
+00021f50: 223a 0d0a 0d0a 2020 2020 2020 2020 2020  ":....          
+00021f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f70: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00021f80: 6d73 203d 2067 6369 2e73 696d 756c 6174  ms = gci.simulat
+00021f90: 6533 4428 636f 766d 6f64 656c 2c20 5b6e  e3D(covmodel, [n
+00021fa0: 782c 2020 6e79 2c20 206e 7a5d 2c20 205b  x,  ny,  nz],  [
+00021fb0: 7378 2c20 2073 792c 2020 737a 5d2c 2020  sx,  sy,  sz],  
+00021fc0: 5b78 302c 2020 7930 2c20 207a 305d 2c0d  [x0,  y0,  z0],.
+00021fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00021fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022000: 2020 656c 6966 206d 6574 686f 6420 3d3d    elif method ==
-00022010: 2022 6d70 7322 3a0d 0a20 2020 2020 2020   "mps":..       
-00022020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022040: 2023 544f 2044 4f0d 0a20 2020 2020 2020   #TO DO..       
-00022050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022070: 2070 6173 730d 0a20 2020 2020 2020 2020   pass..         
-00022080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022090: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000220a0: 2023 206e 6f74 2064 6566 696e 6520 2d2d   # not define --
-000220b0: 3e20 686f 6d6f 6765 6e6f 7573 2061 6e64  > homogenous and
-000220c0: 2064 6566 6175 6c74 206d 6561 6e20 7661   default mean va
-000220d0: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
-000220e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220f0: 2020 2020 2020 2020 2020 2020 206d 3d70               m=p
-00022100: 726f 702e 6465 665f 6d65 616e 0d0a 2020  rop.def_mean..  
-00022110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022130: 2020 2020 2020 7369 6d73 3d6e 702e 6f6e        sims=np.on
-00022140: 6573 285b 6e72 6561 6c2c 206e 7a2c 206e  es([nreal, nz, n
-00022150: 792c 206e 785d 292a 6d0d 0a20 2020 2020  y, nx])*m..     
+00022000: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
+00022010: 6561 6c3d 6e72 6561 6c2c 206d 6561 6e3d  eal=nreal, mean=
+00022020: 6d2c 206d 6173 6b3d 6d61 736b 5f66 6163  m, mask=mask_fac
+00022030: 6965 732c 2078 3d78 2c20 763d 762c 2076  ies, x=x, v=v, v
+00022040: 6572 626f 7365 3d30 2c20 6e74 6872 6561  erbose=0, nthrea
+00022050: 6473 3d73 656c 662e 6e63 7075 2c20 7365  ds=self.ncpu, se
+00022060: 6564 3d73 656c 662e 7365 6564 202b 2069  ed=self.seed + i
+00022070: 752a 3130 3030 3020 2b20 6974 652a 3130  u*10000 + ite*10
+00022080: 3020 2b20 6966 6129 5b22 696d 6167 6522  0 + ifa)["image"
+00022090: 5d2e 7661 6c0d 0a0d 0a20 2020 2020 2020  ].val....       
+000220a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220c0: 2073 696d 733d 6e70 2e6e 616e 5f74 6f5f   sims=np.nan_to_
+000220d0: 6e75 6d28 7369 6d73 2920 2372 656d 6f76  num(sims) #remov
+000220e0: 6520 6e61 6e0d 0a0d 0a20 2020 2020 2020  e nan....       
+000220f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022100: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00022110: 6620 6d65 7468 6f64 203d 3d20 226d 7073  f method == "mps
+00022120: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00022130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022140: 2020 2020 2020 2020 2020 2020 2354 4f20              #TO 
+00022150: 444f 0d0a 2020 2020 2020 2020 2020 2020  DO..            
 00022160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022170: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00022170: 2020 2020 2020 2020 2020 2020 7061 7373              pass
 00022180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00022190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221a0: 2020 2020 2020 6d3d 7072 6f70 2e64 6566        m=prop.def
-000221b0: 5f6d 6561 6e0d 0a20 2020 2020 2020 2020  _mean..         
-000221c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221d0: 2020 2020 2020 2020 2020 2073 696d 733d             sims=
-000221e0: 6e70 2e6f 6e65 7328 5b6e 7265 616c 2c20  np.ones([nreal, 
-000221f0: 6e7a 2c20 6e79 2c20 6e78 5d29 2a6d 0d0a  nz, ny, nx])*m..
-00022200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022220: 2020 666f 7220 6972 2069 6e20 7261 6e67    for ir in rang
-00022230: 6528 6e72 6561 6c29 3a0d 0a20 2020 2020  e(nreal):..     
-00022240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022250: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00022260: 696d 3d73 696d 735b 6972 5d0d 0a20 2020  im=sims[ir]..   
+000221a0: 2020 2020 2020 656c 7365 3a20 2320 6e6f        else: # no
+000221b0: 7420 6465 6669 6e65 202d 2d3e 2068 6f6d  t define --> hom
+000221c0: 6f67 656e 6f75 7320 616e 6420 6465 6661  ogenous and defa
+000221d0: 756c 7420 6d65 616e 2076 616c 7565 0d0a  ult mean value..
+000221e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022200: 2020 2020 2020 2020 6d3d 7072 6f70 2e64          m=prop.d
+00022210: 6566 5f6d 6561 6e0d 0a20 2020 2020 2020  ef_mean..       
+00022220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022240: 2073 696d 733d 6e70 2e6f 6e65 7328 5b6e   sims=np.ones([n
+00022250: 7265 616c 2c20 6e7a 2c20 6e79 2c20 6e78  real, nz, ny, nx
+00022260: 5d29 2a6d 0d0a 2020 2020 2020 2020 2020  ])*m..          
 00022270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022290: 2073 696d 5b66 6163 6965 735f 646f 6d61   sim[facies_doma
-000222a0: 696e 2021 3d20 6661 2e49 445d 3d30 0d0a  in != fa.ID]=0..
-000222b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222d0: 2020 2020 4b5f 6661 5b69 725d 202b 3d20      K_fa[ir] += 
-000222e0: 7369 6d0d 0a0d 0a20 2020 2020 2020 2020  sim....         
-000222f0: 2020 2020 2020 2020 2020 204b 5f66 615b             K_fa[
-00022300: 3a2c 207e 7365 6c66 2e6d 6173 6b5d 3d6e  :, ~self.mask]=n
-00022310: 702e 6e61 6e20 2023 6465 6661 756c 7420  p.nan  #default 
-00022320: 7661 6c75 6520 6973 2030 202d 2d3e 2077  value is 0 --> w
-00022330: 6172 6e69 6e67 203f 0d0a 2020 2020 2020  arning ?..      
-00022340: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00022350: 6d61 3d28 2873 656c 662e 6765 745f 6661  ma=((self.get_fa
-00022360: 6369 6573 2869 752c 2069 6661 2c20 616c  cies(iu, ifa, al
-00022370: 6c5f 6461 7461 3d46 616c 7365 2920 3d3d  l_data=False) ==
-00022380: 2030 2920 2a20 7365 6c66 2e6d 6173 6b29   0) * self.mask)
-00022390: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000223a0: 2020 2020 2020 6d61 3d28 2873 656c 662e        ma=((self.
-000223b0: 4765 6f6c 2e66 6163 6965 735f 646f 6d61  Geol.facies_doma
-000223c0: 696e 735b 6975 2c20 6966 615d 203d 3d20  ins[iu, ifa] == 
-000223d0: 3029 202a 2073 656c 662e 6d61 736b 290d  0) * self.mask).
-000223e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000223f0: 2020 2020 204b 5f66 615b 3a2c 206d 615d       K_fa[:, ma]
-00022400: 3d70 726f 702e 6465 665f 6d65 616e 0d0a  =prop.def_mean..
-00022410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022420: 2020 2020 2020 6966 2070 726f 702e 766d        if prop.vm
-00022430: 696e 2069 7320 6e6f 7420 4e6f 6e65 3a0d  in is not None:.
-00022440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022450: 2020 2020 2020 2020 204b 5f66 615b 4b5f           K_fa[K_
-00022460: 6661 203c 2070 726f 702e 766d 696e 5d3d  fa < prop.vmin]=
-00022470: 7072 6f70 2e76 6d69 6e0d 0a20 2020 2020  prop.vmin..     
-00022480: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022490: 6620 7072 6f70 2e76 6d61 7820 6973 206e  f prop.vmax is n
-000224a0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-000224b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224c0: 2020 4b5f 6661 5b4b 5f66 6120 3e20 7072    K_fa[K_fa > pr
-000224d0: 6f70 2e76 6d61 785d 3d70 726f 702e 766d  op.vmax]=prop.vm
-000224e0: 6178 0d0a 0d0a 2020 2020 2020 2020 2020  ax....          
-000224f0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00022500: 662e 7772 6974 655f 7265 7375 6c74 733a  f.write_results:
-00022510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022520: 2020 2020 2020 2020 2020 666f 7220 6972            for ir
-00022530: 6561 6c20 696e 2072 616e 6765 286e 7265  eal in range(nre
-00022540: 616c 293a 0d0a 2020 2020 2020 2020 2020  al):..          
+00022280: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00022290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222b0: 206d 3d70 726f 702e 6465 665f 6d65 616e   m=prop.def_mean
+000222c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000222d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222e0: 2020 2020 2020 7369 6d73 3d6e 702e 6f6e        sims=np.on
+000222f0: 6573 285b 6e72 6561 6c2c 206e 7a2c 206e  es([nreal, nz, n
+00022300: 792c 206e 785d 292a 6d0d 0a0d 0a20 2020  y, nx])*m....   
+00022310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022320: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00022330: 2069 7220 696e 2072 616e 6765 286e 7265   ir in range(nre
+00022340: 616c 293a 0d0a 2020 2020 2020 2020 2020  al):..          
+00022350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022360: 2020 2020 2020 2020 2020 7369 6d3d 7369            sim=si
+00022370: 6d73 5b69 725d 0d0a 2020 2020 2020 2020  ms[ir]..        
+00022380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022390: 2020 2020 2020 2020 2020 2020 7369 6d5b              sim[
+000223a0: 6661 6369 6573 5f64 6f6d 6169 6e20 213d  facies_domain !=
+000223b0: 2066 612e 4944 5d3d 300d 0a20 2020 2020   fa.ID]=0..     
+000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223d0: 2020 2020 2020 2020 2020 2020 2020 204b                 K
+000223e0: 5f66 615b 6972 5d20 2b3d 2073 696d 0d0a  _fa[ir] += sim..
+000223f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022400: 2020 2020 2020 4b5f 6661 5b3a 2c20 7e73        K_fa[:, ~s
+00022410: 656c 662e 6d61 736b 5d3d 6e70 2e6e 616e  elf.mask]=np.nan
+00022420: 2020 2364 6566 6175 6c74 2076 616c 7565    #default value
+00022430: 2069 7320 3020 2d2d 3e20 7761 726e 696e   is 0 --> warnin
+00022440: 6720 3f0d 0a20 2020 2020 2020 2020 2020  g ?..           
+00022450: 2020 2020 2020 2020 2023 206d 613d 2828           # ma=((
+00022460: 7365 6c66 2e67 6574 5f66 6163 6965 7328  self.get_facies(
+00022470: 6975 2c20 6966 612c 2061 6c6c 5f64 6174  iu, ifa, all_dat
+00022480: 613d 4661 6c73 6529 203d 3d20 3029 202a  a=False) == 0) *
+00022490: 2073 656c 662e 6d61 736b 290d 0a20 2020   self.mask)..   
+000224a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224b0: 206d 613d 2828 7365 6c66 2e47 656f 6c2e   ma=((self.Geol.
+000224c0: 6661 6369 6573 5f64 6f6d 6169 6e73 5b69  facies_domains[i
+000224d0: 752c 2069 6661 5d20 3d3d 2030 2920 2a20  u, ifa] == 0) * 
+000224e0: 7365 6c66 2e6d 6173 6b29 0d0a 2020 2020  self.mask)..    
+000224f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022500: 4b5f 6661 5b3a 2c20 6d61 5d3d 7072 6f70  K_fa[:, ma]=prop
+00022510: 2e64 6566 5f6d 6561 6e0d 0a0d 0a20 2020  .def_mean....   
+00022520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022530: 2069 6620 7072 6f70 2e76 6d69 6e20 6973   if prop.vmin is
+00022540: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
 00022550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022560: 2020 666e 616d 653d 7365 6c66 2e6e 616d    fname=self.nam
-00022570: 652b 227b 7d5f 7b7d 5f7b 7d5f 7b7d 2e70  e+"{}_{}_{}_{}.p
-00022580: 726f 222e 666f 726d 6174 2870 726f 702e  ro".format(prop.
-00022590: 6e61 6d65 2c20 6975 2c20 6966 612c 2069  name, iu, ifa, i
-000225a0: 7265 616c 290d 0a20 2020 2020 2020 2020  real)..         
-000225b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000225c0: 2020 2066 7061 7468 3d6f 732e 7061 7468     fpath=os.path
-000225d0: 2e6a 6f69 6e28 7365 6c66 2e77 732c 2066  .join(self.ws, f
-000225e0: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
-000225f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022600: 2020 2077 6974 6820 6f70 656e 2866 7061     with open(fpa
-00022610: 7468 2c20 2277 6222 2920 6173 2066 3a0d  th, "wb") as f:.
-00022620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022640: 2070 6963 6b6c 652e 6475 6d70 284b 5f66   pickle.dump(K_f
-00022650: 615b 6972 6561 6c5d 2c20 6629 0d0a 2020  a[ireal], f)..  
-00022660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022670: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00022680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022690: 2070 726f 705f 7661 6c75 6573 5b69 752c   prop_values[iu,
-000226a0: 2069 6661 5d3d 4b5f 6661 0d0a 0d0a 2020   ifa]=K_fa....  
-000226b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000226c0: 2020 636f 756e 7465 7220 2b3d 206e 7265    counter += nre
-000226d0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-000226e0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000226f0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-00022700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022710: 2020 7072 696e 7428 2223 2323 207b 7d20    print("### {} 
-00022720: 7b7d 206d 6f64 656c 7320 646f 6e65 222e  {} models done".
-00022730: 666f 726d 6174 2863 6f75 6e74 6572 2c20  format(counter, 
-00022740: 7072 6f70 2e6e 616d 6529 290d 0a0d 0a20  prop.name)).... 
-00022750: 2020 2020 2020 2020 2020 2069 6620 7e73             if ~s
-00022760: 656c 662e 7772 6974 655f 7265 7375 6c74  elf.write_result
-00022770: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00022780: 2020 2020 7365 6c66 2e47 656f 6c2e 7072      self.Geol.pr
-00022790: 6f70 5f76 616c 7565 735b 7072 6f70 2e6e  op_values[prop.n
-000227a0: 616d 655d 3d70 726f 705f 7661 6c75 6573  ame]=prop_values
-000227b0: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-000227c0: 2e70 726f 705f 636f 6d70 7574 6564 3d31  .prop_computed=1
-000227d0: 0d0a 0d0a 2020 2020 6465 6620 7068 7973  ....    def phys
-000227e0: 6963 7366 6f72 7761 7264 2873 656c 662c  icsforward(self,
-000227f0: 206d 6574 686f 642c 2070 6f73 6974 696f   method, positio
-00022800: 6e73 2c20 7374 7261 7449 6e64 6578 3d4e  ns, stratIndex=N
-00022810: 6f6e 652c 2066 6163 6965 7349 6e64 6578  one, faciesIndex
-00022820: 3d4e 6f6e 652c 2070 726f 7049 6e64 6578  =None, propIndex
-00022830: 3d4e 6f6e 652c 2069 6478 3d30 2c20 6370  =None, idx=0, cp
-00022840: 7549 443d 3029 3a0d 0a0d 0a20 2020 2020  uID=0):....     
-00022850: 2020 2069 6d70 6f72 7420 4172 6368 5079     import ArchPy
-00022860: 2e66 6f72 7761 7264 2061 7320 6664 0d0a  .forward as fd..
-00022870: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00022880: 2020 2222 2241 6c69 6173 2074 6f20 7468    """Alias to th
-00022890: 6520 6675 6e63 7469 6f6e 2041 7263 6850  e function ArchP
-000228a0: 792e 666f 7277 6172 642e 7068 7973 6963  y.forward.physic
-000228b0: 7366 6f72 7761 7264 2e0d 0a20 2020 2020  sforward...     
-000228c0: 2020 206d 6574 686f 643a 2073 7472 696e     method: strin
-000228d0: 672e 206d 6574 686f 6420 746f 2046 6f72  g. method to For
-000228e0: 7761 7264 0d0a 2020 2020 2020 2020 706f  ward..        po
-000228f0: 7369 7469 6f6e 3a20 706f 7369 7469 6f6e  sition: position
-00022900: 206f 6620 7468 6520 666f 7277 6172 6422   of the forward"
-00022910: 2222 0d0a 2020 2020 2020 2020 7265 7475  ""..        retu
-00022920: 726e 2066 642e 7068 7973 6963 7366 6f72  rn fd.physicsfor
-00022930: 7761 7264 2873 656c 662c 206d 6574 686f  ward(self, metho
-00022940: 642c 2070 6f73 6974 696f 6e73 2c20 7374  d, positions, st
-00022950: 7261 7449 6e64 6578 2c20 6661 6369 6573  ratIndex, facies
-00022960: 496e 6465 782c 2070 726f 7049 6e64 6578  Index, propIndex
-00022970: 2c20 6964 782c 2063 7075 4944 290d 0a0d  , idx, cpuID)...
-00022980: 0a20 2020 2064 6566 2075 6e69 745f 6d61  .    def unit_ma
-00022990: 736b 2873 656c 662c 2075 6e69 745f 6e61  sk(self, unit_na
-000229a0: 6d65 2c20 6975 3d30 2c20 616c 6c5f 7265  me, iu=0, all_re
-000229b0: 616c 3d46 616c 7365 293a 0d0a 0d0a 2020  al=False):....  
-000229c0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000229d0: 2020 2052 6574 7572 6e20 7468 6520 6d61     Return the ma
-000229e0: 736b 206f 6620 7468 6520 6769 7665 6e20  sk of the given 
-000229f0: 756e 6974 2066 6f72 2061 2072 6561 6c69  unit for a reali
-00022a00: 7a61 7469 6f6e 2069 750d 0a0d 0a20 2020  zation iu....   
-00022a10: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00022a20: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022a30: 2d2d 2d0d 0a20 2020 2020 2020 2075 6e69  ---..        uni
-00022a40: 745f 6e61 6d65 3a20 7374 7269 6e67 0d0a  t_name: string..
-00022a50: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-00022a60: 206e 616d 6520 6465 6669 6e65 6420 7768   name defined wh
-00022a70: 656e 2063 7265 6174 696e 6720 7468 6520  en creating the 
-00022a80: 756e 6974 206f 626a 6563 740d 0a20 2020  unit object..   
-00022a90: 2020 2020 2020 2020 2066 6f72 206d 6f72           for mor
-00022aa0: 6520 6465 7461 696c 733a 203a 636c 6173  e details: :clas
-00022ab0: 733a 6055 6e69 7460 0d0a 2020 2020 2020  s:`Unit`..      
-00022ac0: 2020 6975 3a20 696e 740d 0a20 2020 2020    iu: int..     
-00022ad0: 2020 2020 2020 2075 6e69 7420 7265 616c         unit real
-00022ae0: 697a 6174 696f 6e20 696e 6465 7820 2830  ization index (0
-00022af0: 2c20 312c 202e 2e2e 2c20 4e75 290d 0a20  , 1, ..., Nu).. 
-00022b00: 2020 2020 2020 2061 6c6c 5f72 6561 6c3a         all_real:
-00022b10: 2062 6f6f 6c0d 0a20 2020 2020 2020 2020   bool..         
-00022b20: 2020 2066 6c61 6720 746f 206b 6e6f 7720     flag to know 
-00022b30: 6966 2061 206d 6173 6b20 6f66 2061 6c6c  if a mask of all
-00022b40: 2072 6561 6c69 7a61 7469 6f6e 730d 0a20   realizations.. 
-00022b50: 2020 2020 2020 2020 2020 206d 7573 7420             must 
-00022b60: 6265 2072 6574 7572 6e65 640d 0a0d 0a20  be returned.... 
-00022b70: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-00022b80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-00022b90: 0a20 2020 2020 2020 2033 4420 286f 7220  .        3D (or 
-00022ba0: 3444 2920 6e64 6172 7261 790d 0a20 2020  4D) ndarray..   
-00022bb0: 2020 2020 2020 2020 206d 6173 6b20 6172           mask ar
-00022bc0: 7261 7920 0d0a 2020 2020 2020 2020 2222  ray ..        ""
-00022bd0: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
-00022be0: 616c 6c5f 7265 616c 3a20 2361 6c6c 2072  all_real: #all r
-00022bf0: 6561 6c69 7a61 7469 6f6e 730d 0a20 2020  ealizations..   
-00022c00: 2020 2020 2020 2020 2075 6e69 743d 7365           unit=se
-00022c10: 6c66 2e67 6574 5f75 6e69 7428 6e61 6d65  lf.get_unit(name
-00022c20: 3d75 6e69 745f 6e61 6d65 2c20 7479 7065  =unit_name, type
-00022c30: 3d22 6e61 6d65 2229 0d0a 2020 2020 2020  ="name")..      
-00022c40: 2020 2020 2020 6c3d 5b5d 0d0a 2020 2020        l=[]..    
-00022c50: 2020 2020 2020 2020 6465 6620 6675 6e28          def fun(
-00022c60: 756e 6974 293a 2023 2048 6965 7261 7263  unit): # Hierarc
-00022c70: 6879 2075 6e69 740d 0a20 2020 2020 2020  hy unit..       
-00022c80: 2020 2020 2020 2020 2069 6620 756e 6974           if unit
-00022c90: 2e66 5f6d 6574 686f 6420 3d3d 2022 5375  .f_method == "Su
-00022ca0: 6250 696c 6522 3a0d 0a20 2020 2020 2020  bPile":..       
-00022cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022cc0: 2066 6f72 2073 7520 696e 2075 6e69 742e   for su in unit.
-00022cd0: 5375 6250 696c 652e 6c69 7374 5f75 6e69  SubPile.list_uni
-00022ce0: 7473 3a0d 0a20 2020 2020 2020 2020 2020  ts:..           
-00022cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d00: 206c 2e61 7070 656e 6428 7375 2e49 4429   l.append(su.ID)
-00022d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022d20: 2020 2020 2020 2020 2020 6966 2073 752e            if su.
-00022d30: 665f 6d65 7468 6f64 203d 3d20 2253 7562  f_method == "Sub
-00022d40: 5069 6c65 223a 0d0a 2020 2020 2020 2020  Pile":..        
-00022d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d60: 2020 2020 6675 6e28 7375 290d 0a20 2020      fun(su)..   
-00022d70: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00022d80: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00022d90: 2020 2020 2020 2020 6c2e 6170 7065 6e64          l.append
-00022da0: 2875 6e69 742e 4944 290d 0a20 2020 2020  (unit.ID)..     
-00022db0: 2020 2020 2020 2066 756e 2875 6e69 7429         fun(unit)
-00022dc0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00022dd0: 6172 723d 6e70 2e7a 6572 6f73 285b 7365  arr=np.zeros([se
-00022de0: 6c66 2e6e 7265 616c 5f75 6e69 7473 2c20  lf.nreal_units, 
-00022df0: 7365 6c66 2e67 6574 5f6e 7a28 292c 2073  self.get_nz(), s
-00022e00: 656c 662e 6765 745f 6e79 2829 2c20 7365  elf.get_ny(), se
-00022e10: 6c66 2e67 6574 5f6e 7828 295d 2920 2023  lf.get_nx()])  #
-00022e20: 206d 6173 6b20 7769 7468 2030 2065 7665   mask with 0 eve
-00022e30: 7279 7768 6572 650d 0a20 2020 2020 2020  rywhere..       
-00022e40: 2020 2020 2066 6f72 2069 6478 2069 6e20       for idx in 
-00022e50: 6c3a 0d0a 2020 2020 2020 2020 2020 2020  l:..            
-00022e60: 2020 2020 6172 725b 7365 6c66 2e67 6574      arr[self.get
-00022e70: 5f75 6e69 7473 5f64 6f6d 6169 6e73 5f72  _units_domains_r
-00022e80: 6561 6c69 7a61 7469 6f6e 7328 2920 3d3d  ealizations() ==
-00022e90: 2069 6478 5d3d 3120 2023 2073 6574 2031   idx]=1  # set 1
-00022ea0: 2077 6865 7265 2075 6e69 7420 6f72 2073   where unit or s
-00022eb0: 7562 2d75 6e69 7473 2061 7265 2070 7265  ub-units are pre
-00022ec0: 7365 6e74 0d0a 0d0a 2020 2020 2020 2020  sent....        
-00022ed0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00022ee0: 2020 2075 6e69 743d 7365 6c66 2e67 6574     unit=self.get
-00022ef0: 5f75 6e69 7428 6e61 6d65 3d75 6e69 745f  _unit(name=unit_
-00022f00: 6e61 6d65 2c20 7479 7065 3d22 6e61 6d65  name, type="name
-00022f10: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00022f20: 6c3d 5b5d 0d0a 2020 2020 2020 2020 2020  l=[]..          
-00022f30: 2020 6465 6620 6675 6e28 756e 6974 293a    def fun(unit):
-00022f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022f50: 2020 6966 2075 6e69 742e 665f 6d65 7468    if unit.f_meth
-00022f60: 6f64 203d 3d20 2253 7562 5069 6c65 223a  od == "SubPile":
-00022f70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022f80: 2020 2020 2020 666f 7220 7375 2069 6e20        for su in 
-00022f90: 756e 6974 2e53 7562 5069 6c65 2e6c 6973  unit.SubPile.lis
-00022fa0: 745f 756e 6974 733a 0d0a 2020 2020 2020  t_units:..      
-00022fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fc0: 2020 6c2e 6170 7065 6e64 2873 752e 4944    l.append(su.ID
-00022fd0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00022fe0: 2020 2020 2020 2020 2020 2069 6620 7375             if su
-00022ff0: 2e66 5f6d 6574 686f 6420 3d3d 2022 5375  .f_method == "Su
-00023000: 6250 696c 6522 3a0d 0a20 2020 2020 2020  bPile":..       
-00023010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023020: 2020 2020 2066 756e 2873 7529 0d0a 2020       fun(su)..  
-00023030: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00023040: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00023050: 2020 2020 2020 2020 206c 2e61 7070 656e           l.appen
-00023060: 6428 756e 6974 2e49 4429 0d0a 2020 2020  d(unit.ID)..    
-00023070: 2020 2020 2020 2020 6675 6e28 756e 6974          fun(unit
-00023080: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00023090: 2061 7272 3d6e 702e 7a65 726f 7328 5b73   arr=np.zeros([s
-000230a0: 656c 662e 6765 745f 6e7a 2829 2c20 7365  elf.get_nz(), se
-000230b0: 6c66 2e67 6574 5f6e 7928 292c 2073 656c  lf.get_ny(), sel
-000230c0: 662e 6765 745f 6e78 2829 5d29 2023 6d61  f.get_nx()]) #ma
-000230d0: 736b 2077 6974 6820 3020 6576 6572 7977  sk with 0 everyw
-000230e0: 6865 7265 0d0a 2020 2020 2020 2020 2020  here..          
-000230f0: 2020 666f 7220 6964 7820 696e 206c 3a0d    for idx in l:.
-00023100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023110: 2061 7272 5b73 656c 662e 6765 745f 756e   arr[self.get_un
-00023120: 6974 735f 646f 6d61 696e 735f 7265 616c  its_domains_real
-00023130: 697a 6174 696f 6e73 2869 7529 203d 3d20  izations(iu) == 
-00023140: 6964 785d 3d31 2020 2373 6574 2031 2077  idx]=1  #set 1 w
-00023150: 6865 7265 2075 6e69 7420 6f72 2073 7562  here unit or sub
-00023160: 2d75 6e69 7473 2061 7265 2070 7265 7365  -units are prese
-00023170: 6e74 0d0a 0d0a 2020 2020 2020 2020 7265  nt....        re
-00023180: 7475 726e 2061 7272 0d0a 0d0a 0d0a 2020  turn arr......  
-00023190: 2020 2323 2320 6f74 6865 7273 2066 756e    ### others fun
-000231a0: 7320 2323 230d 0a20 2020 2064 6566 206f  s ###..    def o
-000231b0: 7269 656e 7461 7469 6f6e 5f6d 6170 2873  rientation_map(s
-000231c0: 656c 662c 2075 6e69 742c 0d0a 2020 2020  elf, unit,..    
-000231d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000231e0: 2020 2020 617a 695f 746f 703d 2267 7261      azi_top="gra
-000231f0: 6469 656e 7422 2c20 6469 705f 746f 703d  dient", dip_top=
-00023200: 2267 7261 6469 656e 7422 2c0d 0a20 2020  "gradient",..   
-00023210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023220: 2020 2020 2061 7a69 5f62 6f74 3d22 6772       azi_bot="gr
-00023230: 6164 6965 6e74 222c 2064 6970 5f62 6f74  adient", dip_bot
-00023240: 3d22 6772 6164 6965 6e74 222c 0d0a 2020  ="gradient",..  
-00023250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023260: 2020 2020 2020 6975 3d30 2c20 736d 6f6f        iu=0, smoo
-00023270: 7468 3d32 293a 0d0a 0d0a 2020 2020 2020  th=2):....      
-00023280: 2020 2222 220d 0a20 2020 2020 2020 2043    """..        C
-00023290: 6f6d 7075 7465 206f 7269 656e 7461 7469  ompute orientati
-000232a0: 6f6e 206d 6170 7320 666f 7220 6120 6769  on maps for a gi
-000232b0: 7665 6e20 756e 6974 2028 617a 696d 7574  ven unit (azimut
-000232c0: 6820 616e 6420 6469 7029 0d0a 0d0a 2020  h and dip)....  
-000232d0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000232e0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000232f0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 756e  ----..        un
-00023300: 6974 3a20 3a63 6c61 7373 3a60 556e 6974  it: :class:`Unit
-00023310: 6020 6f62 6a65 6374 0d0a 2020 2020 2020  ` object..      
-00023320: 2020 2020 2020 756e 6974 206f 626a 6563        unit objec
-00023330: 7420 6672 6f6d 2077 6869 6368 2077 6520  t from which we 
-00023340: 7761 6e74 2074 6f20 6861 7665 2074 6865  want to have the
-00023350: 206f 7269 656e 7461 7469 6f6e 206d 6170   orientation map
-00023360: 0d0a 2020 2020 2020 2020 617a 695f 746f  ..        azi_to
-00023370: 703a 2073 7472 696e 6720 6f72 2066 6c6f  p: string or flo
-00023380: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-00023390: 6d65 7468 6f64 2074 6f20 7573 6520 746f  method to use to
-000233a0: 2069 6e66 6572 2061 7a69 6d75 7468 206f   infer azimuth o
-000233b0: 6620 7468 6520 746f 7020 6f66 2074 6865  f the top of the
-000233c0: 2075 6e69 740d 0a20 2020 2020 2020 2061   unit..        a
-000233d0: 7a69 5f62 6f74 3a20 7374 7269 6e67 206f  zi_bot: string o
-000233e0: 7220 666c 6f61 740d 0a20 2020 2020 2020  r float..       
-000233f0: 2020 2020 206d 6574 686f 6420 746f 2075       method to u
-00023400: 7365 2074 6f20 696e 6665 7220 617a 6920  se to infer azi 
-00023410: 6f66 2074 6865 2062 6f74 746f 6d20 6f66  of the bottom of
-00023420: 2074 6865 2075 6e69 740d 0a20 2020 2020   the unit..     
-00023430: 2020 2020 2020 2054 6865 2061 6e67 6c65         The angle
-00023440: 7320 6172 6520 7468 656e 2069 6e74 6572  s are then inter
-00023450: 706f 6c61 7465 6420 6265 7477 6565 6e20  polated between 
-00023460: 746f 7020 616e 6420 626f 7474 6f6d 2028  top and bottom (
-00023470: 6c69 6e65 6172 2069 6e74 6572 706f 6c61  linear interpola
-00023480: 7469 6f6e 290d 0a20 2020 2020 2020 2064  tion)..        d
-00023490: 6970 5f74 6f70 3a20 7374 7269 6e67 206f  ip_top: string o
-000234a0: 7220 666c 6f61 740d 0a20 2020 2020 2020  r float..       
-000234b0: 2020 2020 2073 616d 6520 6173 2061 7a69       same as azi
-000234c0: 6d75 7468 2062 7574 2066 6f72 2064 6970  muth but for dip
-000234d0: 0d0a 2020 2020 2020 2020 6469 705f 626f  ..        dip_bo
+00022560: 2020 2020 4b5f 6661 5b4b 5f66 6120 3c20      K_fa[K_fa < 
+00022570: 7072 6f70 2e76 6d69 6e5d 3d70 726f 702e  prop.vmin]=prop.
+00022580: 766d 696e 0d0a 2020 2020 2020 2020 2020  vmin..          
+00022590: 2020 2020 2020 2020 2020 6966 2070 726f            if pro
+000225a0: 702e 766d 6178 2069 7320 6e6f 7420 4e6f  p.vmax is not No
+000225b0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+000225c0: 2020 2020 2020 2020 2020 2020 204b 5f66               K_f
+000225d0: 615b 4b5f 6661 203e 2070 726f 702e 766d  a[K_fa > prop.vm
+000225e0: 6178 5d3d 7072 6f70 2e76 6d61 780d 0a0d  ax]=prop.vmax...
+000225f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022600: 2020 2020 2069 6620 7365 6c66 2e77 7269       if self.wri
+00022610: 7465 5f72 6573 756c 7473 3a0d 0a20 2020  te_results:..   
+00022620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022630: 2020 2020 2066 6f72 2069 7265 616c 2069       for ireal i
+00022640: 6e20 7261 6e67 6528 6e72 6561 6c29 3a0d  n range(nreal):.
+00022650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022660: 2020 2020 2020 2020 2020 2020 2066 6e61               fna
+00022670: 6d65 3d73 656c 662e 6e61 6d65 2b22 7b7d  me=self.name+"{}
+00022680: 5f7b 7d5f 7b7d 5f7b 7d2e 7072 6f22 2e66  _{}_{}_{}.pro".f
+00022690: 6f72 6d61 7428 7072 6f70 2e6e 616d 652c  ormat(prop.name,
+000226a0: 2069 752c 2069 6661 2c20 6972 6561 6c29   iu, ifa, ireal)
+000226b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000226c0: 2020 2020 2020 2020 2020 2020 2020 6670                fp
+000226d0: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
+000226e0: 2873 656c 662e 7773 2c20 666e 616d 6529  (self.ws, fname)
+000226f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022700: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00022710: 7468 206f 7065 6e28 6670 6174 682c 2022  th open(fpath, "
+00022720: 7762 2229 2061 7320 663a 0d0a 2020 2020  wb") as f:..    
+00022730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022740: 2020 2020 2020 2020 2020 2020 7069 636b              pick
+00022750: 6c65 2e64 756d 7028 4b5f 6661 5b69 7265  le.dump(K_fa[ire
+00022760: 616c 5d2c 2066 290d 0a20 2020 2020 2020  al], f)..       
+00022770: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00022780: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00022790: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
+000227a0: 5f76 616c 7565 735b 6975 2c20 6966 615d  _values[iu, ifa]
+000227b0: 3d4b 5f66 610d 0a0d 0a20 2020 2020 2020  =K_fa....       
+000227c0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+000227d0: 6e74 6572 202b 3d20 6e72 6561 6c0d 0a20  nter += nreal.. 
+000227e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227f0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00022800: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00022810: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00022820: 6e74 2822 2323 2320 7b7d 207b 7d20 6d6f  nt("### {} {} mo
+00022830: 6465 6c73 2064 6f6e 6522 2e66 6f72 6d61  dels done".forma
+00022840: 7428 636f 756e 7465 722c 2070 726f 702e  t(counter, prop.
+00022850: 6e61 6d65 2929 0d0a 0d0a 2020 2020 2020  name))....      
+00022860: 2020 2020 2020 6966 207e 7365 6c66 2e77        if ~self.w
+00022870: 7269 7465 5f72 6573 756c 7473 3a0d 0a20  rite_results:.. 
+00022880: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00022890: 656c 662e 4765 6f6c 2e70 726f 705f 7661  elf.Geol.prop_va
+000228a0: 6c75 6573 5b70 726f 702e 6e61 6d65 5d3d  lues[prop.name]=
+000228b0: 7072 6f70 5f76 616c 7565 730d 0a0d 0a20  prop_values.... 
+000228c0: 2020 2020 2020 2073 656c 662e 7072 6f70         self.prop
+000228d0: 5f63 6f6d 7075 7465 643d 310d 0a0d 0a20  _computed=1.... 
+000228e0: 2020 2064 6566 2070 6879 7369 6373 666f     def physicsfo
+000228f0: 7277 6172 6428 7365 6c66 2c20 6d65 7468  rward(self, meth
+00022900: 6f64 2c20 706f 7369 7469 6f6e 732c 2073  od, positions, s
+00022910: 7472 6174 496e 6465 783d 4e6f 6e65 2c20  tratIndex=None, 
+00022920: 6661 6369 6573 496e 6465 783d 4e6f 6e65  faciesIndex=None
+00022930: 2c20 7072 6f70 496e 6465 783d 4e6f 6e65  , propIndex=None
+00022940: 2c20 6964 783d 302c 2063 7075 4944 3d30  , idx=0, cpuID=0
+00022950: 293a 0d0a 0d0a 2020 2020 2020 2020 696d  ):....        im
+00022960: 706f 7274 2041 7263 6850 792e 666f 7277  port ArchPy.forw
+00022970: 6172 6420 6173 2066 640d 0a20 2020 2020  ard as fd..     
+00022980: 2020 200d 0a20 2020 2020 2020 2022 2222     ..        """
+00022990: 416c 6961 7320 746f 2074 6865 2066 756e  Alias to the fun
+000229a0: 6374 696f 6e20 4172 6368 5079 2e66 6f72  ction ArchPy.for
+000229b0: 7761 7264 2e70 6879 7369 6373 666f 7277  ward.physicsforw
+000229c0: 6172 642e 0d0a 2020 2020 2020 2020 6d65  ard...        me
+000229d0: 7468 6f64 3a20 7374 7269 6e67 2e20 6d65  thod: string. me
+000229e0: 7468 6f64 2074 6f20 466f 7277 6172 640d  thod to Forward.
+000229f0: 0a20 2020 2020 2020 2070 6f73 6974 696f  .        positio
+00022a00: 6e3a 2070 6f73 6974 696f 6e20 6f66 2074  n: position of t
+00022a10: 6865 2066 6f72 7761 7264 2222 220d 0a20  he forward""".. 
+00022a20: 2020 2020 2020 2072 6574 7572 6e20 6664         return fd
+00022a30: 2e70 6879 7369 6373 666f 7277 6172 6428  .physicsforward(
+00022a40: 7365 6c66 2c20 6d65 7468 6f64 2c20 706f  self, method, po
+00022a50: 7369 7469 6f6e 732c 2073 7472 6174 496e  sitions, stratIn
+00022a60: 6465 782c 2066 6163 6965 7349 6e64 6578  dex, faciesIndex
+00022a70: 2c20 7072 6f70 496e 6465 782c 2069 6478  , propIndex, idx
+00022a80: 2c20 6370 7549 4429 0d0a 0d0a 2020 2020  , cpuID)....    
+00022a90: 6465 6620 756e 6974 5f6d 6173 6b28 7365  def unit_mask(se
+00022aa0: 6c66 2c20 756e 6974 5f6e 616d 652c 2069  lf, unit_name, i
+00022ab0: 753d 302c 2061 6c6c 5f72 6561 6c3d 4661  u=0, all_real=Fa
+00022ac0: 6c73 6529 3a0d 0a0d 0a20 2020 2020 2020  lse):....       
+00022ad0: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+00022ae0: 7475 726e 2074 6865 206d 6173 6b20 6f66  turn the mask of
+00022af0: 2074 6865 2067 6976 656e 2075 6e69 7420   the given unit 
+00022b00: 666f 7220 6120 7265 616c 697a 6174 696f  for a realizatio
+00022b10: 6e20 6975 0d0a 0d0a 2020 2020 2020 2020  n iu....        
+00022b20: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00022b30: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00022b40: 2020 2020 2020 2020 756e 6974 5f6e 616d          unit_nam
+00022b50: 653a 2073 7472 696e 670d 0a20 2020 2020  e: string..     
+00022b60: 2020 2020 2020 2075 6e69 7420 6e61 6d65         unit name
+00022b70: 2064 6566 696e 6564 2077 6865 6e20 6372   defined when cr
+00022b80: 6561 7469 6e67 2074 6865 2075 6e69 7420  eating the unit 
+00022b90: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
+00022ba0: 2020 2020 666f 7220 6d6f 7265 2064 6574      for more det
+00022bb0: 6169 6c73 3a20 3a63 6c61 7373 3a60 556e  ails: :class:`Un
+00022bc0: 6974 600d 0a20 2020 2020 2020 2069 753a  it`..        iu:
+00022bd0: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
+00022be0: 2020 756e 6974 2072 6561 6c69 7a61 7469    unit realizati
+00022bf0: 6f6e 2069 6e64 6578 2028 302c 2031 2c20  on index (0, 1, 
+00022c00: 2e2e 2e2c 204e 7529 0d0a 2020 2020 2020  ..., Nu)..      
+00022c10: 2020 616c 6c5f 7265 616c 3a20 626f 6f6c    all_real: bool
+00022c20: 0d0a 2020 2020 2020 2020 2020 2020 666c  ..            fl
+00022c30: 6167 2074 6f20 6b6e 6f77 2069 6620 6120  ag to know if a 
+00022c40: 6d61 736b 206f 6620 616c 6c20 7265 616c  mask of all real
+00022c50: 697a 6174 696f 6e73 0d0a 2020 2020 2020  izations..      
+00022c60: 2020 2020 2020 6d75 7374 2062 6520 7265        must be re
+00022c70: 7475 726e 6564 0d0a 0d0a 2020 2020 2020  turned....      
+00022c80: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00022c90: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00022ca0: 2020 2020 3344 2028 6f72 2034 4429 206e      3D (or 4D) n
+00022cb0: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
+00022cc0: 2020 2020 6d61 736b 2061 7272 6179 200d      mask array .
+00022cd0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+00022ce0: 2020 2020 2020 2020 6966 2061 6c6c 5f72          if all_r
+00022cf0: 6561 6c3a 2023 616c 6c20 7265 616c 697a  eal: #all realiz
+00022d00: 6174 696f 6e73 0d0a 2020 2020 2020 2020  ations..        
+00022d10: 2020 2020 756e 6974 3d73 656c 662e 6765      unit=self.ge
+00022d20: 745f 756e 6974 286e 616d 653d 756e 6974  t_unit(name=unit
+00022d30: 5f6e 616d 652c 2074 7970 653d 226e 616d  _name, type="nam
+00022d40: 6522 290d 0a20 2020 2020 2020 2020 2020  e")..           
+00022d50: 206c 3d5b 5d0d 0a20 2020 2020 2020 2020   l=[]..         
+00022d60: 2020 2064 6566 2066 756e 2875 6e69 7429     def fun(unit)
+00022d70: 3a20 2320 4869 6572 6172 6368 7920 756e  : # Hierarchy un
+00022d80: 6974 0d0a 2020 2020 2020 2020 2020 2020  it..            
+00022d90: 2020 2020 6966 2075 6e69 742e 665f 6d65      if unit.f_me
+00022da0: 7468 6f64 203d 3d20 2253 7562 5069 6c65  thod == "SubPile
+00022db0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00022dc0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00022dd0: 7375 2069 6e20 756e 6974 2e53 7562 5069  su in unit.SubPi
+00022de0: 6c65 2e6c 6973 745f 756e 6974 733a 0d0a  le.list_units:..
+00022df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e00: 2020 2020 2020 2020 2020 2020 6c2e 6170              l.ap
+00022e10: 7065 6e64 2873 752e 4944 290d 0a20 2020  pend(su.ID)..   
+00022e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e30: 2020 2020 2069 6620 7375 2e66 5f6d 6574       if su.f_met
+00022e40: 686f 6420 3d3d 2022 5375 6250 696c 6522  hod == "SubPile"
+00022e50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00022e60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00022e70: 756e 2873 7529 0d0a 2020 2020 2020 2020  un(su)..        
+00022e80: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00022e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ea0: 2020 206c 2e61 7070 656e 6428 756e 6974     l.append(unit
+00022eb0: 2e49 4429 0d0a 2020 2020 2020 2020 2020  .ID)..          
+00022ec0: 2020 6675 6e28 756e 6974 290d 0a0d 0a20    fun(unit).... 
+00022ed0: 2020 2020 2020 2020 2020 2061 7272 3d6e             arr=n
+00022ee0: 702e 7a65 726f 7328 5b73 656c 662e 6e72  p.zeros([self.nr
+00022ef0: 6561 6c5f 756e 6974 732c 2073 656c 662e  eal_units, self.
+00022f00: 6765 745f 6e7a 2829 2c20 7365 6c66 2e67  get_nz(), self.g
+00022f10: 6574 5f6e 7928 292c 2073 656c 662e 6765  et_ny(), self.ge
+00022f20: 745f 6e78 2829 5d29 2020 2320 6d61 736b  t_nx()])  # mask
+00022f30: 2077 6974 6820 3020 6576 6572 7977 6865   with 0 everywhe
+00022f40: 7265 0d0a 2020 2020 2020 2020 2020 2020  re..            
+00022f50: 666f 7220 6964 7820 696e 206c 3a0d 0a20  for idx in l:.. 
+00022f60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00022f70: 7272 5b73 656c 662e 6765 745f 756e 6974  rr[self.get_unit
+00022f80: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
+00022f90: 6174 696f 6e73 2829 203d 3d20 6964 785d  ations() == idx]
+00022fa0: 3d31 2020 2320 7365 7420 3120 7768 6572  =1  # set 1 wher
+00022fb0: 6520 756e 6974 206f 7220 7375 622d 756e  e unit or sub-un
+00022fc0: 6974 7320 6172 6520 7072 6573 656e 740d  its are present.
+00022fd0: 0a0d 0a20 2020 2020 2020 2065 6c73 653a  ...        else:
+00022fe0: 0d0a 2020 2020 2020 2020 2020 2020 756e  ..            un
+00022ff0: 6974 3d73 656c 662e 6765 745f 756e 6974  it=self.get_unit
+00023000: 286e 616d 653d 756e 6974 5f6e 616d 652c  (name=unit_name,
+00023010: 2074 7970 653d 226e 616d 6522 290d 0a20   type="name").. 
+00023020: 2020 2020 2020 2020 2020 206c 3d5b 5d0d             l=[].
+00023030: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+00023040: 2066 756e 2875 6e69 7429 3a0d 0a20 2020   fun(unit):..   
+00023050: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00023060: 756e 6974 2e66 5f6d 6574 686f 6420 3d3d  unit.f_method ==
+00023070: 2022 5375 6250 696c 6522 3a0d 0a20 2020   "SubPile":..   
+00023080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023090: 2066 6f72 2073 7520 696e 2075 6e69 742e   for su in unit.
+000230a0: 5375 6250 696c 652e 6c69 7374 5f75 6e69  SubPile.list_uni
+000230b0: 7473 3a0d 0a20 2020 2020 2020 2020 2020  ts:..           
+000230c0: 2020 2020 2020 2020 2020 2020 206c 2e61               l.a
+000230d0: 7070 656e 6428 7375 2e49 4429 0d0a 2020  ppend(su.ID)..  
+000230e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000230f0: 2020 2020 2020 6966 2073 752e 665f 6d65        if su.f_me
+00023100: 7468 6f64 203d 3d20 2253 7562 5069 6c65  thod == "SubPile
+00023110: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00023120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023130: 6675 6e28 7375 290d 0a20 2020 2020 2020  fun(su)..       
+00023140: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00023150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023160: 2020 2020 6c2e 6170 7065 6e64 2875 6e69      l.append(uni
+00023170: 742e 4944 290d 0a20 2020 2020 2020 2020  t.ID)..         
+00023180: 2020 2066 756e 2875 6e69 7429 0d0a 0d0a     fun(unit)....
+00023190: 2020 2020 2020 2020 2020 2020 6172 723d              arr=
+000231a0: 6e70 2e7a 6572 6f73 285b 7365 6c66 2e67  np.zeros([self.g
+000231b0: 6574 5f6e 7a28 292c 2073 656c 662e 6765  et_nz(), self.ge
+000231c0: 745f 6e79 2829 2c20 7365 6c66 2e67 6574  t_ny(), self.get
+000231d0: 5f6e 7828 295d 2920 236d 6173 6b20 7769  _nx()]) #mask wi
+000231e0: 7468 2030 2065 7665 7279 7768 6572 650d  th 0 everywhere.
+000231f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00023200: 2069 6478 2069 6e20 6c3a 0d0a 2020 2020   idx in l:..    
+00023210: 2020 2020 2020 2020 2020 2020 6172 725b              arr[
+00023220: 7365 6c66 2e67 6574 5f75 6e69 7473 5f64  self.get_units_d
+00023230: 6f6d 6169 6e73 5f72 6561 6c69 7a61 7469  omains_realizati
+00023240: 6f6e 7328 6975 2920 3d3d 2069 6478 5d3d  ons(iu) == idx]=
+00023250: 3120 2023 7365 7420 3120 7768 6572 6520  1  #set 1 where 
+00023260: 756e 6974 206f 7220 7375 622d 756e 6974  unit or sub-unit
+00023270: 7320 6172 6520 7072 6573 656e 740d 0a0d  s are present...
+00023280: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023290: 6172 720d 0a0d 0a0d 0a20 2020 2023 2323  arr......    ###
+000232a0: 206f 7468 6572 7320 6675 6e73 2023 2323   others funs ###
+000232b0: 0d0a 2020 2020 6465 6620 6f72 6965 6e74  ..    def orient
+000232c0: 6174 696f 6e5f 6d61 7028 7365 6c66 2c20  ation_map(self, 
+000232d0: 756e 6974 2c0d 0a20 2020 2020 2020 2020  unit,..         
+000232e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000232f0: 7a69 5f74 6f70 3d22 6772 6164 6965 6e74  zi_top="gradient
+00023300: 222c 2064 6970 5f74 6f70 3d22 6772 6164  ", dip_top="grad
+00023310: 6965 6e74 222c 0d0a 2020 2020 2020 2020  ient",..        
+00023320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023330: 617a 695f 626f 743d 2267 7261 6469 656e  azi_bot="gradien
+00023340: 7422 2c20 6469 705f 626f 743d 2267 7261  t", dip_bot="gra
+00023350: 6469 656e 7422 2c0d 0a20 2020 2020 2020  dient",..       
+00023360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023370: 2069 753d 302c 2073 6d6f 6f74 683d 3229   iu=0, smooth=2)
+00023380: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+00023390: 0d0a 2020 2020 2020 2020 436f 6d70 7574  ..        Comput
+000233a0: 6520 6f72 6965 6e74 6174 696f 6e20 6d61  e orientation ma
+000233b0: 7073 2066 6f72 2061 2067 6976 656e 2075  ps for a given u
+000233c0: 6e69 7420 2861 7a69 6d75 7468 2061 6e64  nit (azimuth and
+000233d0: 2064 6970 290d 0a0d 0a20 2020 2020 2020   dip)....       
+000233e0: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+000233f0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00023400: 0a20 2020 2020 2020 2075 6e69 743a 203a  .        unit: :
+00023410: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
+00023420: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
+00023430: 2075 6e69 7420 6f62 6a65 6374 2066 726f   unit object fro
+00023440: 6d20 7768 6963 6820 7765 2077 616e 7420  m which we want 
+00023450: 746f 2068 6176 6520 7468 6520 6f72 6965  to have the orie
+00023460: 6e74 6174 696f 6e20 6d61 700d 0a20 2020  ntation map..   
+00023470: 2020 2020 2061 7a69 5f74 6f70 3a20 7374       azi_top: st
+00023480: 7269 6e67 206f 7220 666c 6f61 740d 0a20  ring or float.. 
+00023490: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+000234a0: 6420 746f 2075 7365 2074 6f20 696e 6665  d to use to infe
+000234b0: 7220 617a 696d 7574 6820 6f66 2074 6865  r azimuth of the
+000234c0: 2074 6f70 206f 6620 7468 6520 756e 6974   top of the unit
+000234d0: 0d0a 2020 2020 2020 2020 617a 695f 626f  ..        azi_bo
 000234e0: 743a 2073 7472 696e 6720 6f72 2066 6c6f  t: string or flo
 000234f0: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-00023500: 7361 6d65 2061 7320 617a 696d 7574 6820  same as azimuth 
-00023510: 6275 7420 666f 7220 6469 700d 0a20 2020  but for dip..   
-00023520: 2020 2020 2069 753a 2069 6e74 0d0a 2020       iu: int..  
-00023530: 2020 2020 2020 2020 2020 756e 6974 2072            unit r
-00023540: 6561 6c69 7a61 7469 6f6e 2069 6e64 6578  ealization index
-00023550: 2028 302c 2031 2c20 2e2e 2e2c 204e 7529   (0, 1, ..., Nu)
-00023560: 0d0a 2020 2020 2020 2020 736d 6f6f 7468  ..        smooth
-00023570: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
-00023580: 2020 2068 616c 662d 7369 7a65 2077 696e     half-size win
-00023590: 646f 7773 2066 6f72 2072 6f6c 6c69 6e67  dows for rolling
-000235a0: 206d 6561 6e0d 0a0d 0a20 2020 2020 2020   mean....       
-000235b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-000235c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000235d0: 2020 2032 4420 6e64 6172 7261 790d 0a20     2D ndarray.. 
-000235e0: 2020 2020 2020 2020 2020 206f 7269 656e             orien
-000235f0: 7461 7469 6f6e 206d 6170 0d0a 2020 2020  tation map..    
-00023600: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00023610: 2020 2064 6566 2061 7a69 5f64 6970 2873     def azi_dip(s
-00023620: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00023630: 6479 3d2d 6e70 2e64 6966 6628 732c 2061  dy=-np.diff(s, a
-00023640: 7869 733d 3029 5b3a 2c20 313a 205d 2f73  xis=0)[:, 1: ]/s
-00023650: 790d 0a20 2020 2020 2020 2020 2020 2064  y..            d
-00023660: 783d 2d6e 702e 6469 6666 2873 2c20 6178  x=-np.diff(s, ax
-00023670: 6973 3d31 295b 313a 2c3a 205d 2f73 780d  is=1)[1:,: ]/sx.
-00023680: 0a20 2020 2020 2020 2020 2020 2065 323d  .            e2=
-00023690: 2830 2c20 3129 2023 2070 7269 6e63 6970  (0, 1) # princip
-000236a0: 616c 2064 6972 6563 7469 6f6e 2028 4e6f  al direction (No
-000236b0: 7274 6829 0d0a 2020 2020 2020 2020 2020  rth)..          
-000236c0: 2020 616e 673d 6e70 2e6f 6e65 7328 5b64    ang=np.ones([d
-000236d0: 792e 7368 6170 655b 305d 2a64 792e 7368  y.shape[0]*dy.sh
-000236e0: 6170 655b 315d 5d2c 2064 7479 7065 3d6e  ape[1]], dtype=n
-000236f0: 702e 666c 6f61 7433 3229 0d0a 2020 2020  p.float32)..    
-00023700: 2020 2020 2020 2020 693d 2d31 0d0a 2020          i=-1..  
-00023710: 2020 2020 2020 2020 2020 666f 7220 6978            for ix
-00023720: 2c20 6979 2069 6e20 7a69 7028 6478 2e66  , iy in zip(dx.f
-00023730: 6c61 7474 656e 2829 2c20 6479 2e66 6c61  latten(), dy.fla
-00023740: 7474 656e 2829 293a 0d0a 2020 2020 2020  tten()):..      
-00023750: 2020 2020 2020 2020 2020 692b 3d20 310d            i+= 1.
-00023760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023770: 2076 3d28 6978 2c20 6979 290d 0a20 2020   v=(ix, iy)..   
-00023780: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00023790: 6e70 2e73 7172 7428 765b 305d 2a2a 322b  np.sqrt(v[0]**2+
-000237a0: 765b 315d 2a2a 3229 203d 3d20 303a 2023  v[1]**2) == 0: #
-000237b0: 6469 7669 6465 2062 7920 300d 0a20 2020  divide by 0..   
-000237c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000237d0: 2076 616c 3d30 0d0a 2020 2020 2020 2020   val=0..        
-000237e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000237f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023800: 2020 2076 616c 3d28 6e70 2e72 6164 3264     val=(np.rad2d
-00023810: 6567 286e 702e 6172 6363 6f73 286e 702e  eg(np.arccos(np.
-00023820: 646f 7428 6532 2c20 7629 2f6e 702e 7371  dot(e2, v)/np.sq
-00023830: 7274 2876 5b30 5d2a 2a32 2b76 5b31 5d2a  rt(v[0]**2+v[1]*
-00023840: 2a32 2929 2929 0d0a 2020 2020 2020 2020  *2))))..        
-00023850: 2020 2020 2020 2020 6966 2076 5b30 5d3c          if v[0]<
-00023860: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00023870: 2020 2020 2020 2020 7661 6c20 2a3d 202d          val *= -
-00023880: 310d 0a0d 0a20 2020 2020 2020 2020 2020  1....           
-00023890: 2020 2020 2061 6e67 5b69 5d3d 7661 6c0d       ang[i]=val.
-000238a0: 0a0d 0a20 2020 2020 2020 2020 2020 2064  ...            d
-000238b0: 6970 3d6e 702e 7261 6432 6465 6728 6e70  ip=np.rad2deg(np
-000238c0: 2e61 7263 7461 6e28 2d64 792f 6e70 2e63  .arctan(-dy/np.c
-000238d0: 6f73 286e 702e 6465 6732 7261 6428 616e  os(np.deg2rad(an
-000238e0: 6729 2e72 6573 6861 7065 286e 792d 312c  g).reshape(ny-1,
-000238f0: 206e 782d 3129 2929 290d 0a0d 0a20 2020   nx-1))))....   
-00023900: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00023910: 616e 672e 7265 7368 6170 6528 6e79 2d31  ang.reshape(ny-1
-00023920: 2c20 6e78 2d31 292c 2064 6970 0d0a 0d0a  , nx-1), dip....
-00023930: 2020 2020 2020 2020 6465 6620 617a 695f          def azi_
-00023940: 6469 705f 4a53 2873 293a 0d0a 2020 2020  dip_JS(s):..    
-00023950: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00023960: 2020 2020 2020 6679 2c20 6678 203d 206e        fy, fx = n
-00023970: 702e 6772 6164 6965 6e74 2873 2c20 7379  p.gradient(s, sy
-00023980: 2c20 7378 290d 0a20 2020 2020 2020 2020  , sx)..         
-00023990: 2020 2066 7820 3d20 2d66 780d 0a20 2020     fx = -fx..   
-000239a0: 2020 2020 2020 2020 2066 7920 3d20 2d66           fy = -f
-000239b0: 790d 0a20 2020 2020 2020 2020 2020 2061  y..            a
-000239c0: 7a69 203d 2031 3830 2f6e 702e 7069 202a  zi = 180/np.pi *
-000239d0: 286e 702e 7069 2f32 202d 206e 702e 6172  (np.pi/2 - np.ar
-000239e0: 6374 616e 3228 6679 2c20 6678 2929 0d0a  ctan2(fy, fx))..
-000239f0: 2020 2020 2020 2020 2020 2020 6469 7020              dip 
-00023a00: 3d20 2d20 3138 302f 6e70 2e70 6920 2a20  = - 180/np.pi * 
-00023a10: 286e 702e 7069 2f32 202d 206e 702e 6172  (np.pi/2 - np.ar
-00023a20: 6373 696e 2831 2f6e 702e 7371 7274 2831  csin(1/np.sqrt(1
-00023a30: 2b66 782a 6678 2b66 792a 6679 2929 290d  +fx*fx+fy*fy))).
-00023a40: 0a0d 0a20 2020 2020 2020 2020 2020 2072  ...            r
-00023a50: 6574 7572 6e20 617a 692c 2064 6970 0d0a  eturn azi, dip..
-00023a60: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00023a70: 2020 7867 3d73 656c 662e 6765 745f 7867    xg=self.get_xg
-00023a80: 6328 290d 0a20 2020 2020 2020 2079 673d  c()..        yg=
-00023a90: 7365 6c66 2e67 6574 5f79 6763 2829 0d0a  self.get_ygc()..
-00023aa0: 2020 2020 2020 2020 7a67 3d73 656c 662e          zg=self.
-00023ab0: 6765 745f 7a67 6328 290d 0a20 2020 2020  get_zgc()..     
-00023ac0: 2020 206e 783d 7365 6c66 2e67 6574 5f6e     nx=self.get_n
-00023ad0: 7828 290d 0a20 2020 2020 2020 206e 793d  x()..        ny=
-00023ae0: 7365 6c66 2e67 6574 5f6e 7928 290d 0a20  self.get_ny().. 
-00023af0: 2020 2020 2020 206e 7a3d 7365 6c66 2e67         nz=self.g
-00023b00: 6574 5f6e 7a28 290d 0a20 2020 2020 2020  et_nz()..       
-00023b10: 2073 783d 7365 6c66 2e67 6574 5f73 7828   sx=self.get_sx(
-00023b20: 290d 0a20 2020 2020 2020 2073 793d 7365  )..        sy=se
-00023b30: 6c66 2e67 6574 5f73 7928 290d 0a20 2020  lf.get_sy()..   
-00023b40: 2020 2020 2073 7a3d 7365 6c66 2e67 6574       sz=self.get
-00023b50: 5f73 7a28 290d 0a0d 0a20 2020 2020 2020  _sz()....       
-00023b60: 2069 6620 756e 6974 2e67 6574 5f68 5f6c   if unit.get_h_l
-00023b70: 6576 656c 2829 203d 3d20 313a 0d0a 2020  evel() == 1:..  
-00023b80: 2020 2020 2020 2020 2020 7069 6c65 3d73            pile=s
-00023b90: 656c 662e 6765 745f 7069 6c65 5f6d 6173  elf.get_pile_mas
-00023ba0: 7465 7228 290d 0a20 2020 2020 2020 2065  ter()..        e
-00023bb0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00023bc0: 2020 7069 6c65 3d75 6e69 742e 6d75 6d6d    pile=unit.mumm
-00023bd0: 795f 756e 6974 2e53 7562 5069 6c65 0d0a  y_unit.SubPile..
-00023be0: 0d0a 2020 2020 2020 2020 2320 736d 6f6f  ..        # smoo
-00023bf0: 7468 696e 670d 0a20 2020 2020 2020 2074  thing..        t
-00023c00: 6f70 2020 2020 3d72 756e 6e69 6e67 5f6d  op    =running_m
-00023c10: 6561 6e5f 3244 2873 656c 662e 4765 6f6c  ean_2D(self.Geol
-00023c20: 2e73 7572 6661 6365 735f 6279 5f70 696c  .surfaces_by_pil
-00023c30: 6573 5b70 696c 652e 6e61 6d65 5d5b 6975  es[pile.name][iu
-00023c40: 2c20 756e 6974 2e6f 7264 6572 2d31 5d2c  , unit.order-1],
-00023c50: 204e 3d73 6d6f 6f74 6829 0d0a 2020 2020   N=smooth)..    
-00023c60: 2020 2020 626f 7420 2020 203d 7275 6e6e      bot    =runn
-00023c70: 696e 675f 6d65 616e 5f32 4428 7365 6c66  ing_mean_2D(self
-00023c80: 2e47 656f 6c2e 7375 7266 6163 6573 5f62  .Geol.surfaces_b
-00023c90: 6f74 5f62 795f 7069 6c65 735b 7069 6c65  ot_by_piles[pile
-00023ca0: 2e6e 616d 655d 5b69 752c 2075 6e69 742e  .name][iu, unit.
-00023cb0: 6f72 6465 722d 315d 2c20 4e3d 736d 6f6f  order-1], N=smoo
-00023cc0: 7468 290d 0a0d 0a20 2020 2020 2020 2023  th)....        #
-00023cd0: 2063 6f6d 7075 7465 2061 6e67 6c65 7320   compute angles 
-00023ce0: 666f 7220 746f 7020 616e 6420 626f 7474  for top and bott
-00023cf0: 6f6d 0d0a 2020 2020 2020 2020 2320 746f  om..        # to
-00023d00: 700d 0a20 2020 2020 2020 2069 6620 617a  p..        if az
-00023d10: 695f 746f 7020 203d 3d20 2267 7261 6469  i_top  == "gradi
-00023d20: 656e 7422 2061 6e64 2064 6970 5f74 6f70  ent" and dip_top
-00023d30: 203d 3d20 2267 7261 6469 656e 7422 3a0d   == "gradient":.
-00023d40: 0a20 2020 2020 2020 2020 2020 2061 7a69  .            azi
-00023d50: 5f74 6f70 2c20 6469 705f 746f 7020 3d20  _top, dip_top = 
-00023d60: 617a 695f 6469 705f 4a53 2874 6f70 290d  azi_dip_JS(top).
-00023d70: 0a20 2020 2020 2020 2065 6c69 6620 617a  .        elif az
-00023d80: 695f 746f 7020 3d3d 2022 6772 6164 6965  i_top == "gradie
-00023d90: 6e74 2220 616e 6420 6469 705f 746f 7020  nt" and dip_top 
-00023da0: 213d 2022 6772 6164 6965 6e74 223a 0d0a  != "gradient":..
-00023db0: 2020 2020 2020 2020 2020 2020 617a 695f              azi_
-00023dc0: 746f 7020 3d20 617a 695f 6469 705f 4a53  top = azi_dip_JS
-00023dd0: 2874 6f70 295b 305d 0d0a 2020 2020 2020  (top)[0]..      
-00023de0: 2020 2020 2020 6469 705f 746f 7020 3d20        dip_top = 
-00023df0: 6e70 2e6f 6e65 7328 5b6e 792c 206e 785d  np.ones([ny, nx]
-00023e00: 292a 6469 705f 746f 700d 0a20 2020 2020  )*dip_top..     
-00023e10: 2020 2065 6c69 6620 617a 695f 746f 7020     elif azi_top 
-00023e20: 213d 2022 6772 6164 6965 6e74 2220 616e  != "gradient" an
-00023e30: 6420 6469 705f 746f 7020 3d3d 2022 6772  d dip_top == "gr
-00023e40: 6164 6965 6e74 223a 0d0a 2020 2020 2020  adient":..      
-00023e50: 2020 2020 2020 617a 695f 746f 7020 3d20        azi_top = 
-00023e60: 6e70 2e6f 6e65 7328 5b6e 792c 206e 785d  np.ones([ny, nx]
-00023e70: 292a 617a 695f 746f 700d 0a20 2020 2020  )*azi_top..     
-00023e80: 2020 2020 2020 2064 6970 5f74 6f70 203d         dip_top =
-00023e90: 2061 7a69 5f64 6970 5f4a 5328 746f 7029   azi_dip_JS(top)
-00023ea0: 5b31 5d0d 0a20 2020 2020 2020 2065 6c73  [1]..        els
-00023eb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00023ec0: 617a 695f 746f 703d 6e70 2e6f 6e65 7328  azi_top=np.ones(
-00023ed0: 5b6e 792c 206e 785d 292a 617a 695f 746f  [ny, nx])*azi_to
-00023ee0: 700d 0a20 2020 2020 2020 2020 2020 2064  p..            d
-00023ef0: 6970 5f74 6f70 3d6e 702e 6f6e 6573 285b  ip_top=np.ones([
-00023f00: 6e79 2c20 6e78 5d29 2a64 6970 5f74 6f70  ny, nx])*dip_top
-00023f10: 0d0a 0d0a 2020 2020 2020 2020 2320 626f  ....        # bo
-00023f20: 7474 6f6d 0d0a 2020 2020 2020 2020 6966  ttom..        if
-00023f30: 2061 7a69 5f62 6f74 2020 3d3d 2022 6772   azi_bot  == "gr
-00023f40: 6164 6965 6e74 2220 616e 6420 6469 705f  adient" and dip_
-00023f50: 626f 7420 3d3d 2022 6772 6164 6965 6e74  bot == "gradient
-00023f60: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00023f70: 617a 695f 626f 742c 2064 6970 5f62 6f74  azi_bot, dip_bot
-00023f80: 203d 2061 7a69 5f64 6970 5f4a 5328 626f   = azi_dip_JS(bo
-00023f90: 7429 0d0a 2020 2020 2020 2020 656c 6966  t)..        elif
-00023fa0: 2061 7a69 5f62 6f74 203d 3d20 2267 7261   azi_bot == "gra
-00023fb0: 6469 656e 7422 2061 6e64 2064 6970 5f62  dient" and dip_b
-00023fc0: 6f74 2021 3d20 2267 7261 6469 656e 7422  ot != "gradient"
-00023fd0: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-00023fe0: 7a69 5f62 6f74 203d 2061 7a69 5f64 6970  zi_bot = azi_dip
-00023ff0: 5f4a 5328 626f 7429 5b30 5d0d 0a20 2020  _JS(bot)[0]..   
-00024000: 2020 2020 2020 2020 2064 6970 5f62 6f74           dip_bot
-00024010: 203d 206e 702e 6f6e 6573 285b 6e79 2c20   = np.ones([ny, 
-00024020: 6e78 5d29 2a64 6970 5f62 6f74 0d0a 2020  nx])*dip_bot..  
-00024030: 2020 2020 2020 656c 6966 2061 7a69 5f62        elif azi_b
-00024040: 6f74 2021 3d20 2267 7261 6469 656e 7422  ot != "gradient"
-00024050: 2061 6e64 2064 6970 5f62 6f74 203d 3d20   and dip_bot == 
-00024060: 2267 7261 6469 656e 7422 3a0d 0a20 2020  "gradient":..   
-00024070: 2020 2020 2020 2020 2061 7a69 5f62 6f74           azi_bot
-00024080: 203d 206e 702e 6f6e 6573 285b 6e79 2c20   = np.ones([ny, 
-00024090: 6e78 5d29 2a61 7a69 5f62 6f74 0d0a 2020  nx])*azi_bot..  
-000240a0: 2020 2020 2020 2020 2020 6469 705f 626f            dip_bo
-000240b0: 7420 3d20 617a 695f 6469 705f 4a53 2862  t = azi_dip_JS(b
-000240c0: 6f74 295b 315d 0d0a 2020 2020 2020 2020  ot)[1]..        
-000240d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000240e0: 2020 2061 7a69 5f62 6f74 3d6e 702e 6f6e     azi_bot=np.on
-000240f0: 6573 285b 6e79 2c20 6e78 5d29 2a61 7a69  es([ny, nx])*azi
-00024100: 5f62 6f74 0d0a 2020 2020 2020 2020 2020  _bot..          
-00024110: 2020 6469 705f 626f 743d 6e70 2e6f 6e65    dip_bot=np.one
-00024120: 7328 5b6e 792c 206e 785d 292a 6469 705f  s([ny, nx])*dip_
-00024130: 626f 740d 0a0d 0a20 2020 2020 2020 2061  bot....        a
-00024140: 7a69 3d6e 702e 7a65 726f 7328 5b6e 7a2c  zi=np.zeros([nz,
-00024150: 206e 792c 206e 785d 2c20 6474 7970 653d   ny, nx], dtype=
-00024160: 6e70 2e66 6c6f 6174 3332 290d 0a20 2020  np.float32)..   
-00024170: 2020 2020 206d 6173 6b3d 7365 6c66 2e75       mask=self.u
-00024180: 6e69 745f 6d61 736b 2875 6e69 745f 6e61  nit_mask(unit_na
-00024190: 6d65 3d75 6e69 742e 6e61 6d65 2c20 6975  me=unit.name, iu
-000241a0: 3d69 7529 0d0a 2020 2020 2020 2020 666f  =iu)..        fo
-000241b0: 7220 6978 2069 6e20 7261 6e67 6528 6e78  r ix in range(nx
-000241c0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000241d0: 666f 7220 6979 2069 6e20 7261 6e67 6528  for iy in range(
-000241e0: 6e79 293a 2020 2320 544f 2046 494e 4953  ny):  # TO FINIS
-000241f0: 480d 0a20 2020 2020 2020 2020 2020 2020  H..             
-00024200: 2020 2074 3d6e 702e 7768 6572 6528 6d61     t=np.where(ma
-00024210: 736b 5b3a 2c20 6979 2c20 6978 5d29 2020  sk[:, iy, ix])  
-00024220: 2320 7265 7472 6965 7665 2069 6478 2074  # retrieve idx t
-00024230: 6f20 696e 6469 6361 7465 2077 6865 7265  o indicate where
-00024240: 206c 6179 6572 2065 7869 7374 2076 6572   layer exist ver
-00024250: 7469 6361 6c6c 7920 6174 2063 6572 7461  tically at certa
-00024260: 696e 206c 6f63 6174 696f 6e20 780d 0a0d  in location x...
-00024270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024280: 2069 6620 6c65 6e28 745b 305d 293e 303a   if len(t[0])>0:
-00024290: 2020 2320 6966 206c 6179 6572 2065 7869    # if layer exi
-000242a0: 7374 7320 6174 2070 6f73 6974 696f 6e20  sts at position 
-000242b0: 6978 2069 790d 0a20 2020 2020 2020 2020  ix iy..         
-000242c0: 2020 2020 2020 2020 2020 2069 323d 6e70             i2=np
-000242d0: 2e6d 696e 2874 290d 0a20 2020 2020 2020  .min(t)..       
-000242e0: 2020 2020 2020 2020 2020 2020 2069 313d               i1=
-000242f0: 6e70 2e6d 6178 2874 290d 0a20 2020 2020  np.max(t)..     
-00024300: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00024310: 626f 743d 617a 695f 626f 745b 6979 2c20  bot=azi_bot[iy, 
-00024320: 6978 5d0d 0a20 2020 2020 2020 2020 2020  ix]..           
-00024330: 2020 2020 2020 2020 2076 746f 703d 617a           vtop=az
-00024340: 695f 746f 705b 6979 2c20 6978 5d0d 0a0d  i_top[iy, ix]...
-00024350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024360: 2020 2020 2069 6620 286e 702e 6162 7328       if (np.abs(
-00024370: 6e70 2e6d 696e 2828 7662 6f74 2c20 7674  np.min((vbot, vt
-00024380: 6f70 2929 202d 206e 702e 6d61 7828 2876  op)) - np.max((v
-00024390: 626f 742c 2076 746f 7029 2929 2920 3c20  bot, vtop)))) < 
-000243a0: 286e 702e 6162 7328 3336 3020 2b20 6e70  (np.abs(360 + np
-000243b0: 2e6d 696e 2828 7662 6f74 2c20 7674 6f70  .min((vbot, vtop
-000243c0: 2929 202d 206e 702e 6d61 7828 2876 626f  )) - np.max((vbo
-000243d0: 742c 2076 746f 7029 2929 293a 0d0a 2020  t, vtop)))):..  
-000243e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000243f0: 2020 2020 2020 617a 695b 3a2c 2069 792c        azi[:, iy,
-00024400: 2069 785d 3d6e 702e 696e 7465 7270 287a   ix]=np.interp(z
-00024410: 672c 205b 7a67 5b69 325d 2c20 7a67 5b69  g, [zg[i2], zg[i
-00024420: 315d 5d2c 205b 7662 6f74 2c20 7674 6f70  1]], [vbot, vtop
-00024430: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00024440: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00024450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024460: 2020 2020 2020 2069 6620 7662 6f74 203c         if vbot <
-00024470: 2076 746f 703a 0d0a 2020 2020 2020 2020   vtop:..        
-00024480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024490: 2020 2020 617a 695b 3a2c 2069 792c 2069      azi[:, iy, i
-000244a0: 785d 3d6e 702e 696e 7465 7270 287a 672c  x]=np.interp(zg,
-000244b0: 205b 7a67 5b69 325d 2c20 7a67 5b69 315d   [zg[i2], zg[i1]
-000244c0: 5d2c 205b 7662 6f74 2b33 3630 2c20 7674  ], [vbot+360, vt
-000244d0: 6f70 5d29 0d0a 2020 2020 2020 2020 2020  op])..          
-000244e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000244f0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00024500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024510: 2061 7a69 5b3a 2c20 6979 2c20 6978 5d3d   azi[:, iy, ix]=
-00024520: 6e70 2e69 6e74 6572 7028 7a67 2c20 5b7a  np.interp(zg, [z
-00024530: 675b 6932 5d2c 207a 675b 6931 5d5d 2c20  g[i2], zg[i1]], 
-00024540: 5b76 626f 742c 2076 746f 702b 3336 305d  [vbot, vtop+360]
-00024550: 290d 0a20 2020 2020 2020 2061 7a69 5b6d  )..        azi[m
-00024560: 6173 6b21 3d31 5d3d 300d 0a0d 0a20 2020  ask!=1]=0....   
-00024570: 2020 2020 2064 6970 3d6e 702e 7a65 726f       dip=np.zero
-00024580: 7328 5b6e 7a2c 206e 792c 206e 785d 2c20  s([nz, ny, nx], 
-00024590: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
-000245a0: 290d 0a20 2020 2020 2020 2066 6f72 2069  )..        for i
-000245b0: 7820 696e 2072 616e 6765 286e 7829 3a0d  x in range(nx):.
-000245c0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000245d0: 2069 7920 696e 2072 616e 6765 286e 7929   iy in range(ny)
-000245e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000245f0: 2020 2074 3d6e 702e 7768 6572 6528 6d61     t=np.where(ma
-00024600: 736b 5b3a 2c20 6979 2c20 6978 5d29 2023  sk[:, iy, ix]) #
-00024610: 2072 6574 7269 6576 6520 6964 7820 746f   retrieve idx to
-00024620: 2069 6e64 6963 6174 6520 7768 6572 6520   indicate where 
-00024630: 6c61 7965 7220 6578 6973 7420 7665 7274  layer exist vert
-00024640: 6963 616c 6c79 2061 7420 6365 7274 6169  ically at certai
-00024650: 6e20 6c6f 6361 7469 6f6e 2078 0d0a 0d0a  n location x....
-00024660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024670: 6966 206c 656e 2874 5b30 5d29 3e30 3a20  if len(t[0])>0: 
-00024680: 2320 6966 206c 6179 6572 2065 7869 7374  # if layer exist
-00024690: 7320 6174 2070 6f73 6974 696f 6e20 6978  s at position ix
-000246a0: 2069 790d 0a20 2020 2020 2020 2020 2020   iy..           
-000246b0: 2020 2020 2020 2020 2069 323d 6e70 2e6d           i2=np.m
-000246c0: 696e 2874 290d 0a20 2020 2020 2020 2020  in(t)..         
-000246d0: 2020 2020 2020 2020 2020 2069 313d 6e70             i1=np
-000246e0: 2e6d 6178 2874 290d 0a20 2020 2020 2020  .max(t)..       
-000246f0: 2020 2020 2020 2020 2020 2020 2064 6970               dip
-00024700: 5b3a 2c20 6979 2c20 6978 5d3d 6e70 2e69  [:, iy, ix]=np.i
-00024710: 6e74 6572 7028 7a67 2c20 5b7a 675b 6932  nterp(zg, [zg[i2
-00024720: 5d2c 207a 675b 6931 5d5d 2c20 5b64 6970  ], zg[i1]], [dip
-00024730: 5f62 6f74 5b69 792c 2069 785d 2c20 6469  _bot[iy, ix], di
-00024740: 705f 746f 705b 6979 2c20 6978 5d5d 290d  p_top[iy, ix]]).
-00024750: 0a0d 0a20 2020 2020 2020 2064 6970 5b6d  ...        dip[m
-00024760: 6173 6b21 3d31 5d3d 300d 0a0d 0a20 2020  ask!=1]=0....   
-00024770: 2020 2020 2072 6574 7572 6e20 617a 692c       return azi,
-00024780: 2064 6970 0d0a 0d0a 0d0a 0d0a 2020 2020   dip........    
-00024790: 6465 6620 6578 7472 6163 745f 6c6f 675f  def extract_log_
-000247a0: 6661 6369 6573 5f62 6828 7365 6c66 2c20  facies_bh(self, 
-000247b0: 6661 6369 6573 2c20 6268 782c 2062 6879  facies, bhx, bhy
-000247c0: 2c20 6268 7a2c 2064 6570 7468 293a 0d0a  , bhz, depth):..
-000247d0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000247e0: 2020 2020 2020 2045 7874 7261 6374 2074         Extract t
-000247f0: 6865 206c 6f67 2066 6163 6965 7320 696e  he log facies in
-00024800: 2074 6865 2041 7263 6850 7920 666f 726d   the ArchPy form
-00024810: 6174 2061 7420 7468 6520 7370 6563 6966  at at the specif
-00024820: 6963 206c 6f63 6174 696f 6e0d 0a0d 0a20  ic location.... 
-00024830: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00024840: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00024850: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
-00024860: 6163 6965 733a 2033 4420 6e64 6172 7261  acies: 3D ndarra
-00024870: 790d 0a20 2020 2020 2020 2020 2020 2066  y..            f
-00024880: 6163 6965 7320 7265 616c 697a 6174 696f  acies realizatio
-00024890: 6e0d 0a20 2020 2020 2020 2062 6878 2c20  n..        bhx, 
-000248a0: 6268 792c 2062 687a 3a20 666c 6f61 740d  bhy, bhz: float.
-000248b0: 0a20 2020 2020 2020 2020 2020 2062 6f72  .            bor
-000248c0: 6568 6f6c 6520 6c6f 6361 7469 6f6e 0d0a  ehole location..
-000248d0: 2020 2020 2020 2020 6465 7074 683a 2066          depth: f
-000248e0: 6c6f 6174 0d0a 2020 2020 2020 2020 2020  loat..          
-000248f0: 2020 6465 7074 6820 6f66 2069 6e76 6573    depth of inves
-00024900: 7469 6761 7469 6f6e 0d0a 2020 2020 2020  tigation..      
-00024910: 2020 0d0a 2020 2020 2020 2020 5265 7475    ..        Retu
-00024920: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00024930: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c6f  ----..        lo
-00024940: 675f 6661 6369 6573 3a20 6c69 7374 206f  g_facies: list o
-00024950: 6620 3a63 6c61 7373 3a60 4661 6369 6573  f :class:`Facies
-00024960: 6020 6f62 6a65 6374 0d0a 2020 2020 2020  ` object..      
-00024970: 2020 2020 2020 6120 6c6f 6720 6661 6369        a log faci
-00024980: 6573 2028 6c69 7374 206f 6620 6661 6369  es (list of faci
-00024990: 6573 206f 626a 6563 7420 7769 7468 2065  es object with e
-000249a0: 6c65 7661 7469 6f6e 7329 0d0a 2020 2020  levations)..    
-000249b0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-000249c0: 2020 2062 685f 6365 6c6c 3d73 656c 662e     bh_cell=self.
-000249d0: 636f 6f72 6432 6365 6c6c 2862 6878 2c20  coord2cell(bhx, 
-000249e0: 6268 792c 2062 687a 290d 0a20 2020 2020  bhy, bhz)..     
-000249f0: 2020 2062 685f 626f 745f 6365 6c6c 3d73     bh_bot_cell=s
-00024a00: 656c 662e 636f 6f72 6432 6365 6c6c 2862  elf.coord2cell(b
-00024a10: 6878 2c20 6268 792c 2062 687a 2d64 6570  hx, bhy, bhz-dep
-00024a20: 7468 290d 0a20 2020 2020 2020 2069 6620  th)..        if 
-00024a30: 6268 5f62 6f74 5f63 656c 6c20 6973 206e  bh_bot_cell is n
-00024a40: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-00024a50: 2020 2020 2020 6268 5f62 6f74 5f63 656c        bh_bot_cel
-00024a60: 6c3d 6268 5f62 6f74 5f63 656c 6c5b 305d  l=bh_bot_cell[0]
-00024a70: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00024a80: 0a20 2020 2020 2020 2020 2020 2062 685f  .            bh_
-00024a90: 626f 745f 6365 6c6c 3d30 0d0a 0d0a 2020  bot_cell=0....  
-00024aa0: 2020 2020 2020 6964 5f66 6163 6965 733d        id_facies=
-00024ab0: 6661 6369 6573 5b62 685f 626f 745f 6365  facies[bh_bot_ce
-00024ac0: 6c6c 3a20 6268 5f63 656c 6c5b 302b 315d  ll: bh_cell[0+1]
-00024ad0: 2c20 6268 5f63 656c 6c5b 315d 2c20 6268  , bh_cell[1], bh
-00024ae0: 5f63 656c 6c5b 325d 5d5b 3a3a 202d 315d  _cell[2]][:: -1]
-00024af0: 0d0a 2020 2020 2020 2020 7a5f 6661 6369  ..        z_faci
-00024b00: 6573 3d73 656c 662e 7a67 635b 6268 5f62  es=self.zgc[bh_b
-00024b10: 6f74 5f63 656c 6c3a 2062 685f 6365 6c6c  ot_cell: bh_cell
-00024b20: 5b30 5d2b 315d 5b3a 3a20 2d31 5d0d 0a0d  [0]+1][:: -1]...
-00024b30: 0a20 2020 2020 2020 2069 3d30 0d0a 2020  .        i=0..  
-00024b40: 2020 2020 2020 6c6f 675f 6661 6369 6573        log_facies
-00024b50: 3d5b 5d0d 0a20 2020 2020 2020 2066 615f  =[]..        fa_
-00024b60: 7072 6576 3d30 0d0a 2020 2020 2020 2020  prev=0..        
-00024b70: 666f 7220 6661 2069 6e20 6964 5f66 6163  for fa in id_fac
-00024b80: 6965 733a 0d0a 0d0a 2020 2020 2020 2020  ies:....        
-00024b90: 2020 2020 6966 2066 6120 213d 2066 615f      if fa != fa_
-00024ba0: 7072 6576 2061 6e64 2066 6120 213d 2030  prev and fa != 0
-00024bb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00024bc0: 2020 206c 6f67 5f66 6163 6965 732e 6170     log_facies.ap
-00024bd0: 7065 6e64 2828 7365 6c66 2e67 6574 5f66  pend((self.get_f
-00024be0: 6163 6965 735f 6f62 6a28 4944 203d 6661  acies_obj(ID =fa
-00024bf0: 2c20 7479 7065 3d22 4944 2229 2c20 6e70  , type="ID"), np
-00024c00: 2e72 6f75 6e64 287a 5f66 6163 6965 735b  .round(z_facies[
-00024c10: 695d 2c20 3229 2929 0d0a 2020 2020 2020  i], 2)))..      
-00024c20: 2020 2020 2020 2020 2020 6661 5f70 7265            fa_pre
-00024c30: 763d 6661 0d0a 0d0a 2020 2020 2020 2020  v=fa....        
-00024c40: 2020 2020 6920 2b3d 2031 0d0a 0d0a 2020      i += 1....  
-00024c50: 2020 2020 2020 7265 7475 726e 206c 6f67        return log
-00024c60: 5f66 6163 6965 730d 0a0d 0a20 2020 2064  _facies....    d
-00024c70: 6566 2067 6574 5f65 6e74 726f 7079 2873  ef get_entropy(s
-00024c80: 656c 662c 2074 7970 203d 2022 756e 6974  elf, typ = "unit
-00024c90: 7322 2c20 685f 6c65 7665 6c20 3d20 4e6f  s", h_level = No
-00024ca0: 6e65 2c20 7265 636f 6d70 7574 653d 4661  ne, recompute=Fa
-00024cb0: 6c73 6529 3a0d 0a0d 0a20 2020 2020 2020  lse):....       
-00024cc0: 2022 2222 0d0a 2020 2020 2020 2020 436f   """..        Co
-00024cd0: 6d70 7574 6520 7468 6520 5368 616e 6e6f  mpute the Shanno
-00024ce0: 6e20 656e 7472 6f70 7920 666f 7220 756e  n entropy for un
-00024cf0: 6974 7320 6f72 2066 6163 6965 7320 616e  its or facies an
-00024d00: 6420 7265 7475 726e 2069 742e 0d0a 0d0a  d return it.....
-00024d10: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00024d20: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00024d30: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00024d40: 7479 703a 2073 7472 696e 670d 0a20 2020  typ: string..   
-00024d50: 2020 2020 2020 2020 2074 7970 6520 6f66           type of
-00024d60: 206d 6f64 656c 7320 746f 2075 7365 2074   models to use t
-00024d70: 6f20 636f 6d70 7574 6520 7468 6520 656e  o compute the en
-00024d80: 7472 6f70 792c 0d0a 2020 2020 2020 2020  tropy,..        
-00024d90: 2020 2020 7661 6c69 6420 7661 6c75 6573      valid values
-00024da0: 2061 7265 2022 756e 6974 7322 2061 6e64   are "units" and
-00024db0: 2022 6661 6369 6573 220d 0a20 2020 2020   "facies"..     
-00024dc0: 2020 2068 5f6c 6576 656c 3a20 696e 740d     h_level: int.
-00024dd0: 0a20 2020 2020 2020 2020 2020 2068 6965  .            hie
-00024de0: 6172 6368 6963 616c 206c 6576 656c 2074  archical level t
-00024df0: 6f20 7573 6520 746f 2063 6f6d 7075 7465  o use to compute
-00024e00: 2074 6865 2065 6e74 726f 7079 2c0d 0a20   the entropy,.. 
-00024e10: 2020 2020 2020 2020 2020 206f 6e6c 7920             only 
-00024e20: 7573 6564 2069 6620 7479 7020 6973 2022  used if typ is "
-00024e30: 756e 6974 7322 0d0a 2020 2020 2020 2020  units"..        
-00024e40: 7265 636f 6d70 7574 653a 2062 6f6f 6c0d  recompute: bool.
-00024e50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00024e60: 5472 7565 2c20 7265 636f 6d70 7574 6520  True, recompute 
-00024e70: 7468 6520 656e 7472 6f70 790d 0a20 2020  the entropy..   
-00024e80: 2020 2020 200d 0a20 2020 2020 2020 2052       ..        R
-00024e90: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00024ea0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00024eb0: 2033 4420 6e64 6172 7261 7920 6f66 2073   3D ndarray of s
-00024ec0: 697a 6520 286e 7a2c 206e 792c 206e 7829  ize (nz, ny, nx)
-00024ed0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-00024ee0: 0a20 2020 2020 2020 2069 6620 7479 7020  .        if typ 
-00024ef0: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
-00024f00: 2020 2020 2020 2020 2073 7472 696e 6720           string 
-00024f10: 3d20 2275 6e69 7473 5f65 6e74 726f 7079  = "units_entropy
-00024f20: 220d 0a20 2020 2020 2020 2065 6c69 6620  "..        elif 
-00024f30: 7479 703d 3d20 2266 6163 6965 7322 3a0d  typ== "facies":.
-00024f40: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00024f50: 696e 6720 3d20 2275 6e69 7473 5f66 6163  ing = "units_fac
-00024f60: 6965 7322 0d0a 0d0a 2020 2020 2020 2020  ies"....        
-00024f70: 6966 2068 6173 6174 7472 2873 656c 662e  if hasattr(self.
-00024f80: 4765 6f6c 2c20 7374 7269 6e67 2920 616e  Geol, string) an
-00024f90: 6420 7265 636f 6d70 7574 6520 3d3d 2046  d recompute == F
-00024fa0: 616c 7365 3a0d 0a0d 0a20 2020 2020 2020  alse:....       
-00024fb0: 2020 2020 2069 6620 7265 636f 6d70 7574       if recomput
-00024fc0: 6520 3d3d 2022 6661 6c73 6522 3a0d 0a20  e == "false":.. 
-00024fd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00024fe0: 6620 7479 7020 3d3d 2022 756e 6974 7322  f typ == "units"
-00024ff0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00025000: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00025010: 6c66 2e47 656f 6c2e 756e 6974 735f 656e  lf.Geol.units_en
-00025020: 7472 6f70 790d 0a20 2020 2020 2020 2020  tropy..         
-00025030: 2020 2020 2020 2065 6c69 6620 7479 7020         elif typ 
-00025040: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
-00025050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025060: 2020 7265 7475 726e 2073 656c 662e 4765    return self.Ge
-00025070: 6f6c 2e66 6163 6965 735f 656e 7472 6f70  ol.facies_entrop
-00025080: 790d 0a20 0d0a 2020 2020 2020 2020 656c  y.. ..        el
-00025090: 6966 2072 6563 6f6d 7075 7465 206f 7220  if recompute or 
-000250a0: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-000250b0: 2e47 656f 6c2c 2073 7472 696e 6729 3a0d  .Geol, string):.
-000250c0: 0a0d 0a20 2020 2020 2020 2020 2020 206e  ...            n
-000250d0: 7a20 3d20 7365 6c66 2e67 6574 5f6e 7a28  z = self.get_nz(
-000250e0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-000250f0: 7920 3d20 7365 6c66 2e67 6574 5f6e 7928  y = self.get_ny(
-00025100: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-00025110: 7820 3d20 7365 6c66 2e67 6574 5f6e 7828  x = self.get_nx(
-00025120: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00025130: 2061 7272 203d 206e 702e 7a65 726f 7328   arr = np.zeros(
-00025140: 5b6e 7a2c 206e 792c 206e 785d 290d 0a20  [nz, ny, nx]).. 
-00025150: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-00025160: 7020 3d3d 2275 6e69 7473 223a 0d0a 2020  p =="units":..  
-00025170: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00025180: 6974 7320 3d20 7365 6c66 2e67 6574 5f75  its = self.get_u
-00025190: 6e69 7473 5f64 6f6d 6169 6e73 5f72 6561  nits_domains_rea
-000251a0: 6c69 7a61 7469 6f6e 7328 685f 6c65 7665  lizations(h_leve
-000251b0: 6c20 3d20 685f 6c65 7665 6c29 0d0a 2020  l = h_level)..  
-000251c0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-000251d0: 7374 5f75 6e69 7473 5f69 6473 203d 206e  st_units_ids = n
-000251e0: 702e 756e 6971 7565 2875 6e69 7473 5b75  p.unique(units[u
-000251f0: 6e69 7473 2021 3d20 305d 290d 0a0d 0a20  nits != 0]).... 
-00025200: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00025210: 6174 6120 3d20 756e 6974 735b 3a2c 2073  ata = units[:, s
-00025220: 656c 662e 6d61 736b 5d0d 0a20 2020 2020  elf.mask]..     
-00025230: 2020 2020 2020 2020 2020 2053 4520 3d20             SE = 
-00025240: 6e70 2e7a 6572 6f73 285b 6461 7461 2e73  np.zeros([data.s
-00025250: 6861 7065 5b31 5d5d 290d 0a20 2020 2020  hape[1]])..     
-00025260: 2020 2020 2020 2020 2020 2023 623d 6c65             #b=le
-00025270: 6e28 7365 6c66 2e67 6574 5f61 6c6c 5f75  n(self.get_all_u
-00025280: 6e69 7473 2829 290d 0a20 2020 2020 2020  nits())..       
-00025290: 2020 2020 2020 2020 2062 203d 206c 656e           b = len
-000252a0: 286c 6973 745f 756e 6974 735f 6964 7329  (list_units_ids)
-000252b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000252c0: 2020 6e72 6561 6c3d 756e 6974 732e 7368    nreal=units.sh
-000252d0: 6170 655b 305d 0d0a 0d0a 2020 2020 2020  ape[0]....      
-000252e0: 2020 2020 2020 2020 2020 666f 7220 6964            for id
-000252f0: 7820 696e 206c 6973 745f 756e 6974 735f  x in list_units_
-00025300: 6964 733a 0d0a 2020 2020 2020 2020 2020  ids:..          
-00025310: 2020 2020 2020 2020 2020 756e 6974 203d            unit =
-00025320: 2073 656c 662e 6765 745f 756e 6974 2849   self.get_unit(I
-00025330: 443d 6964 782c 2074 7970 653d 2249 4422  D=idx, type="ID"
-00025340: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00025350: 2020 2020 2020 2050 6920 3d20 2864 6174         Pi = (dat
-00025360: 6120 3d3d 2075 6e69 742e 4944 292e 7375  a == unit.ID).su
-00025370: 6d28 3029 2f6e 7265 616c 0d0a 2020 2020  m(0)/nreal..    
-00025380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025390: 7069 5f6d 6173 6b20 3d20 2850 6920 213d  pi_mask = (Pi !=
-000253a0: 2030 290d 0a20 2020 2020 2020 2020 2020   0)..           
-000253b0: 2020 2020 2020 2020 2053 455b 7069 5f6d           SE[pi_m
-000253c0: 6173 6b5d 202b 3d20 5069 5b70 695f 6d61  ask] += Pi[pi_ma
-000253d0: 736b 5d20 2a20 286e 702e 6c6f 6728 5069  sk] * (np.log(Pi
-000253e0: 5b70 695f 6d61 736b 5d29 2f6e 702e 6c6f  [pi_mask])/np.lo
-000253f0: 6728 6229 290d 0a20 2020 2020 2020 2020  g(b))..         
-00025400: 2020 2020 2020 2020 2020 2061 7272 5b73             arr[s
-00025410: 656c 662e 6d61 736b 5d20 3d2d 2053 450d  elf.mask] =- SE.
-00025420: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00025430: 2020 2061 7272 5b7e 7365 6c66 2e6d 6173     arr[~self.mas
-00025440: 6b5d 3d6e 702e 6e61 6e0d 0a0d 0a20 2020  k]=np.nan....   
-00025450: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00025460: 662e 4765 6f6c 2e75 6e69 7473 5f65 6e74  f.Geol.units_ent
-00025470: 726f 7079 203d 2061 7272 2020 2020 0d0a  ropy = arr    ..
-00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025490: 7265 7475 726e 2061 7272 0d0a 0d0a 2020  return arr....  
-000254a0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-000254b0: 7970 203d 3d20 2266 6163 6965 7322 3a0d  yp == "facies":.
-000254c0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000254d0: 2020 2066 6163 6965 735f 646f 6d61 696e     facies_domain
-000254e0: 7320 3d20 7365 6c66 2e67 6574 5f66 6163  s = self.get_fac
-000254f0: 6965 7328 292e 7265 7368 6170 6528 2d31  ies().reshape(-1
-00025500: 2c20 7365 6c66 2e6e 7a2c 2073 656c 662e  , self.nz, self.
-00025510: 6e79 2c20 7365 6c66 2e6e 7829 0d0a 2020  ny, self.nx)..  
-00025520: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00025530: 7461 203d 2075 6e69 7473 5b3a 2c20 7365  ta = units[:, se
-00025540: 6c66 2e6d 6173 6b5d 0d0a 2020 2020 2020  lf.mask]..      
-00025550: 2020 2020 2020 2020 2020 5345 203d 206e            SE = n
-00025560: 702e 7a65 726f 7328 5b64 6174 612e 7368  p.zeros([data.sh
-00025570: 6170 655b 315d 5d29 2020 2320 7368 616e  ape[1]])  # shan
-00025580: 6e6f 6e20 656e 7472 6f70 790d 0a20 2020  non entropy..   
-00025590: 2020 2020 2020 2020 2020 2020 2062 203d               b =
-000255a0: 206c 656e 2873 656c 662e 6765 745f 616c   len(self.get_al
-000255b0: 6c5f 6661 6369 6573 2829 290d 0a20 2020  l_facies())..   
-000255c0: 2020 2020 2020 2020 2020 2020 206e 7265               nre
-000255d0: 616c 3d66 6163 6965 735f 646f 6d61 696e  al=facies_domain
-000255e0: 732e 7368 6170 655b 305d 0d0a 0d0a 2020  s.shape[0]....  
-000255f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00025600: 7220 6661 6369 6573 2069 6e20 7365 6c66  r facies in self
-00025610: 2e67 6574 5f61 6c6c 5f66 6163 6965 7328  .get_all_facies(
-00025620: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00025630: 2020 2020 2020 2020 5069 203d 2028 6461          Pi = (da
-00025640: 7461 203d 3d20 6661 6369 6573 2e49 4429  ta == facies.ID)
-00025650: 2e73 756d 2830 292f 6e72 6561 6c0d 0a20  .sum(0)/nreal.. 
-00025660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025670: 2020 2070 695f 6d61 736b 203d 2028 5069     pi_mask = (Pi
-00025680: 2021 3d20 3029 0d0a 2020 2020 2020 2020   != 0)..        
-00025690: 2020 2020 2020 2020 2020 2020 5345 5b70              SE[p
-000256a0: 695f 6d61 736b 5d20 2b3d 2050 695b 7069  i_mask] += Pi[pi
-000256b0: 5f6d 6173 6b5d 202a 2028 6e70 2e6c 6f67  _mask] * (np.log
-000256c0: 2850 695b 7069 5f6d 6173 6b5d 292f 6e70  (Pi[pi_mask])/np
-000256d0: 2e6c 6f67 2862 2929 0d0a 2020 2020 2020  .log(b))..      
-000256e0: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-000256f0: 725b 7365 6c66 2e6d 6173 6b5d 203d 2d20  r[self.mask] =- 
-00025700: 5345 0d0a 0d0a 2020 2020 2020 2020 2020  SE....          
-00025710: 2020 2020 2020 6172 725b 7e73 656c 662e        arr[~self.
-00025720: 6d61 736b 5d3d 6e70 2e6e 616e 0d0a 0d0a  mask]=np.nan....
+00023500: 6d65 7468 6f64 2074 6f20 7573 6520 746f  method to use to
+00023510: 2069 6e66 6572 2061 7a69 206f 6620 7468   infer azi of th
+00023520: 6520 626f 7474 6f6d 206f 6620 7468 6520  e bottom of the 
+00023530: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
+00023540: 2020 5468 6520 616e 676c 6573 2061 7265    The angles are
+00023550: 2074 6865 6e20 696e 7465 7270 6f6c 6174   then interpolat
+00023560: 6564 2062 6574 7765 656e 2074 6f70 2061  ed between top a
+00023570: 6e64 2062 6f74 746f 6d20 286c 696e 6561  nd bottom (linea
+00023580: 7220 696e 7465 7270 6f6c 6174 696f 6e29  r interpolation)
+00023590: 0d0a 2020 2020 2020 2020 6469 705f 746f  ..        dip_to
+000235a0: 703a 2073 7472 696e 6720 6f72 2066 6c6f  p: string or flo
+000235b0: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
+000235c0: 7361 6d65 2061 7320 617a 696d 7574 6820  same as azimuth 
+000235d0: 6275 7420 666f 7220 6469 700d 0a20 2020  but for dip..   
+000235e0: 2020 2020 2064 6970 5f62 6f74 3a20 7374       dip_bot: st
+000235f0: 7269 6e67 206f 7220 666c 6f61 740d 0a20  ring or float.. 
+00023600: 2020 2020 2020 2020 2020 2073 616d 6520             same 
+00023610: 6173 2061 7a69 6d75 7468 2062 7574 2066  as azimuth but f
+00023620: 6f72 2064 6970 0d0a 2020 2020 2020 2020  or dip..        
+00023630: 6975 3a20 696e 740d 0a20 2020 2020 2020  iu: int..       
+00023640: 2020 2020 2075 6e69 7420 7265 616c 697a       unit realiz
+00023650: 6174 696f 6e20 696e 6465 7820 2830 2c20  ation index (0, 
+00023660: 312c 202e 2e2e 2c20 4e75 290d 0a20 2020  1, ..., Nu)..   
+00023670: 2020 2020 2073 6d6f 6f74 683a 2069 6e74       smooth: int
+00023680: 0d0a 2020 2020 2020 2020 2020 2020 6861  ..            ha
+00023690: 6c66 2d73 697a 6520 7769 6e64 6f77 7320  lf-size windows 
+000236a0: 666f 7220 726f 6c6c 696e 6720 6d65 616e  for rolling mean
+000236b0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+000236c0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000236d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3244  ----..        2D
+000236e0: 206e 6461 7272 6179 0d0a 2020 2020 2020   ndarray..      
+000236f0: 2020 2020 2020 6f72 6965 6e74 6174 696f        orientatio
+00023700: 6e20 6d61 700d 0a20 2020 2020 2020 2022  n map..        "
+00023710: 2222 0d0a 0d0a 2020 2020 2020 2020 6465  ""....        de
+00023720: 6620 617a 695f 6469 7028 7329 3a0d 0a20  f azi_dip(s):.. 
+00023730: 2020 2020 2020 2020 2020 2064 793d 2d6e             dy=-n
+00023740: 702e 6469 6666 2873 2c20 6178 6973 3d30  p.diff(s, axis=0
+00023750: 295b 3a2c 2031 3a20 5d2f 7379 0d0a 2020  )[:, 1: ]/sy..  
+00023760: 2020 2020 2020 2020 2020 6478 3d2d 6e70            dx=-np
+00023770: 2e64 6966 6628 732c 2061 7869 733d 3129  .diff(s, axis=1)
+00023780: 5b31 3a2c 3a20 5d2f 7378 0d0a 2020 2020  [1:,: ]/sx..    
+00023790: 2020 2020 2020 2020 6532 3d28 302c 2031          e2=(0, 1
+000237a0: 2920 2320 7072 696e 6369 7061 6c20 6469  ) # principal di
+000237b0: 7265 6374 696f 6e20 284e 6f72 7468 290d  rection (North).
+000237c0: 0a20 2020 2020 2020 2020 2020 2061 6e67  .            ang
+000237d0: 3d6e 702e 6f6e 6573 285b 6479 2e73 6861  =np.ones([dy.sha
+000237e0: 7065 5b30 5d2a 6479 2e73 6861 7065 5b31  pe[0]*dy.shape[1
+000237f0: 5d5d 2c20 6474 7970 653d 6e70 2e66 6c6f  ]], dtype=np.flo
+00023800: 6174 3332 290d 0a20 2020 2020 2020 2020  at32)..         
+00023810: 2020 2069 3d2d 310d 0a20 2020 2020 2020     i=-1..       
+00023820: 2020 2020 2066 6f72 2069 782c 2069 7920       for ix, iy 
+00023830: 696e 207a 6970 2864 782e 666c 6174 7465  in zip(dx.flatte
+00023840: 6e28 292c 2064 792e 666c 6174 7465 6e28  n(), dy.flatten(
+00023850: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00023860: 2020 2020 2069 2b3d 2031 0d0a 2020 2020       i+= 1..    
+00023870: 2020 2020 2020 2020 2020 2020 763d 2869              v=(i
+00023880: 782c 2069 7929 0d0a 2020 2020 2020 2020  x, iy)..        
+00023890: 2020 2020 2020 2020 6966 206e 702e 7371          if np.sq
+000238a0: 7274 2876 5b30 5d2a 2a32 2b76 5b31 5d2a  rt(v[0]**2+v[1]*
+000238b0: 2a32 2920 3d3d 2030 3a20 2364 6976 6964  *2) == 0: #divid
+000238c0: 6520 6279 2030 0d0a 2020 2020 2020 2020  e by 0..        
+000238d0: 2020 2020 2020 2020 2020 2020 7661 6c3d              val=
+000238e0: 300d 0a20 2020 2020 2020 2020 2020 2020  0..             
+000238f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00023900: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00023910: 6c3d 286e 702e 7261 6432 6465 6728 6e70  l=(np.rad2deg(np
+00023920: 2e61 7263 636f 7328 6e70 2e64 6f74 2865  .arccos(np.dot(e
+00023930: 322c 2076 292f 6e70 2e73 7172 7428 765b  2, v)/np.sqrt(v[
+00023940: 305d 2a2a 322b 765b 315d 2a2a 3229 2929  0]**2+v[1]**2)))
+00023950: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00023960: 2020 2069 6620 765b 305d 3c30 3a0d 0a20     if v[0]<0:.. 
+00023970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023980: 2020 2076 616c 202a 3d20 2d31 0d0a 0d0a     val *= -1....
+00023990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000239a0: 616e 675b 695d 3d76 616c 0d0a 0d0a 2020  ang[i]=val....  
+000239b0: 2020 2020 2020 2020 2020 6469 703d 6e70            dip=np
+000239c0: 2e72 6164 3264 6567 286e 702e 6172 6374  .rad2deg(np.arct
+000239d0: 616e 282d 6479 2f6e 702e 636f 7328 6e70  an(-dy/np.cos(np
+000239e0: 2e64 6567 3272 6164 2861 6e67 292e 7265  .deg2rad(ang).re
+000239f0: 7368 6170 6528 6e79 2d31 2c20 6e78 2d31  shape(ny-1, nx-1
+00023a00: 2929 2929 0d0a 0d0a 2020 2020 2020 2020  ))))....        
+00023a10: 2020 2020 7265 7475 726e 2061 6e67 2e72      return ang.r
+00023a20: 6573 6861 7065 286e 792d 312c 206e 782d  eshape(ny-1, nx-
+00023a30: 3129 2c20 6469 700d 0a0d 0a20 2020 2020  1), dip....     
+00023a40: 2020 2064 6566 2061 7a69 5f64 6970 5f4a     def azi_dip_J
+00023a50: 5328 7329 3a0d 0a20 2020 2020 2020 2020  S(s):..         
+00023a60: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00023a70: 2066 792c 2066 7820 3d20 6e70 2e67 7261   fy, fx = np.gra
+00023a80: 6469 656e 7428 732c 2073 792c 2073 7829  dient(s, sy, sx)
+00023a90: 0d0a 2020 2020 2020 2020 2020 2020 6678  ..            fx
+00023aa0: 203d 202d 6678 0d0a 2020 2020 2020 2020   = -fx..        
+00023ab0: 2020 2020 6679 203d 202d 6679 0d0a 2020      fy = -fy..  
+00023ac0: 2020 2020 2020 2020 2020 617a 6920 3d20            azi = 
+00023ad0: 3138 302f 6e70 2e70 6920 2a28 6e70 2e70  180/np.pi *(np.p
+00023ae0: 692f 3220 2d20 6e70 2e61 7263 7461 6e32  i/2 - np.arctan2
+00023af0: 2866 792c 2066 7829 290d 0a20 2020 2020  (fy, fx))..     
+00023b00: 2020 2020 2020 2064 6970 203d 202d 2031         dip = - 1
+00023b10: 3830 2f6e 702e 7069 202a 2028 6e70 2e70  80/np.pi * (np.p
+00023b20: 692f 3220 2d20 6e70 2e61 7263 7369 6e28  i/2 - np.arcsin(
+00023b30: 312f 6e70 2e73 7172 7428 312b 6678 2a66  1/np.sqrt(1+fx*f
+00023b40: 782b 6679 2a66 7929 2929 0d0a 0d0a 2020  x+fy*fy)))....  
+00023b50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00023b60: 2061 7a69 2c20 6469 700d 0a20 2020 2020   azi, dip..     
+00023b70: 2020 200d 0a20 2020 2020 2020 2078 673d     ..        xg=
+00023b80: 7365 6c66 2e67 6574 5f78 6763 2829 0d0a  self.get_xgc()..
+00023b90: 2020 2020 2020 2020 7967 3d73 656c 662e          yg=self.
+00023ba0: 6765 745f 7967 6328 290d 0a20 2020 2020  get_ygc()..     
+00023bb0: 2020 207a 673d 7365 6c66 2e67 6574 5f7a     zg=self.get_z
+00023bc0: 6763 2829 0d0a 2020 2020 2020 2020 6e78  gc()..        nx
+00023bd0: 3d73 656c 662e 6765 745f 6e78 2829 0d0a  =self.get_nx()..
+00023be0: 2020 2020 2020 2020 6e79 3d73 656c 662e          ny=self.
+00023bf0: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
+00023c00: 2020 6e7a 3d73 656c 662e 6765 745f 6e7a    nz=self.get_nz
+00023c10: 2829 0d0a 2020 2020 2020 2020 7378 3d73  ()..        sx=s
+00023c20: 656c 662e 6765 745f 7378 2829 0d0a 2020  elf.get_sx()..  
+00023c30: 2020 2020 2020 7379 3d73 656c 662e 6765        sy=self.ge
+00023c40: 745f 7379 2829 0d0a 2020 2020 2020 2020  t_sy()..        
+00023c50: 737a 3d73 656c 662e 6765 745f 737a 2829  sz=self.get_sz()
+00023c60: 0d0a 0d0a 2020 2020 2020 2020 6966 2075  ....        if u
+00023c70: 6e69 742e 6765 745f 685f 6c65 7665 6c28  nit.get_h_level(
+00023c80: 2920 3d3d 2031 3a0d 0a20 2020 2020 2020  ) == 1:..       
+00023c90: 2020 2020 2070 696c 653d 7365 6c66 2e67       pile=self.g
+00023ca0: 6574 5f70 696c 655f 6d61 7374 6572 2829  et_pile_master()
+00023cb0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00023cc0: 0a20 2020 2020 2020 2020 2020 2070 696c  .            pil
+00023cd0: 653d 756e 6974 2e6d 756d 6d79 5f75 6e69  e=unit.mummy_uni
+00023ce0: 742e 5375 6250 696c 650d 0a0d 0a20 2020  t.SubPile....   
+00023cf0: 2020 2020 2023 2073 6d6f 6f74 6869 6e67       # smoothing
+00023d00: 0d0a 2020 2020 2020 2020 746f 7020 2020  ..        top   
+00023d10: 203d 7275 6e6e 696e 675f 6d65 616e 5f32   =running_mean_2
+00023d20: 4428 7365 6c66 2e47 656f 6c2e 7375 7266  D(self.Geol.surf
+00023d30: 6163 6573 5f62 795f 7069 6c65 735b 7069  aces_by_piles[pi
+00023d40: 6c65 2e6e 616d 655d 5b69 752c 2075 6e69  le.name][iu, uni
+00023d50: 742e 6f72 6465 722d 315d 2c20 4e3d 736d  t.order-1], N=sm
+00023d60: 6f6f 7468 290d 0a20 2020 2020 2020 2062  ooth)..        b
+00023d70: 6f74 2020 2020 3d72 756e 6e69 6e67 5f6d  ot    =running_m
+00023d80: 6561 6e5f 3244 2873 656c 662e 4765 6f6c  ean_2D(self.Geol
+00023d90: 2e73 7572 6661 6365 735f 626f 745f 6279  .surfaces_bot_by
+00023da0: 5f70 696c 6573 5b70 696c 652e 6e61 6d65  _piles[pile.name
+00023db0: 5d5b 6975 2c20 756e 6974 2e6f 7264 6572  ][iu, unit.order
+00023dc0: 2d31 5d2c 204e 3d73 6d6f 6f74 6829 0d0a  -1], N=smooth)..
+00023dd0: 0d0a 2020 2020 2020 2020 2320 636f 6d70  ..        # comp
+00023de0: 7574 6520 616e 676c 6573 2066 6f72 2074  ute angles for t
+00023df0: 6f70 2061 6e64 2062 6f74 746f 6d0d 0a20  op and bottom.. 
+00023e00: 2020 2020 2020 2023 2074 6f70 0d0a 2020         # top..  
+00023e10: 2020 2020 2020 6966 2061 7a69 5f74 6f70        if azi_top
+00023e20: 2020 3d3d 2022 6772 6164 6965 6e74 2220    == "gradient" 
+00023e30: 616e 6420 6469 705f 746f 7020 3d3d 2022  and dip_top == "
+00023e40: 6772 6164 6965 6e74 223a 0d0a 2020 2020  gradient":..    
+00023e50: 2020 2020 2020 2020 617a 695f 746f 702c          azi_top,
+00023e60: 2064 6970 5f74 6f70 203d 2061 7a69 5f64   dip_top = azi_d
+00023e70: 6970 5f4a 5328 746f 7029 0d0a 2020 2020  ip_JS(top)..    
+00023e80: 2020 2020 656c 6966 2061 7a69 5f74 6f70      elif azi_top
+00023e90: 203d 3d20 2267 7261 6469 656e 7422 2061   == "gradient" a
+00023ea0: 6e64 2064 6970 5f74 6f70 2021 3d20 2267  nd dip_top != "g
+00023eb0: 7261 6469 656e 7422 3a0d 0a20 2020 2020  radient":..     
+00023ec0: 2020 2020 2020 2061 7a69 5f74 6f70 203d         azi_top =
+00023ed0: 2061 7a69 5f64 6970 5f4a 5328 746f 7029   azi_dip_JS(top)
+00023ee0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00023ef0: 2064 6970 5f74 6f70 203d 206e 702e 6f6e   dip_top = np.on
+00023f00: 6573 285b 6e79 2c20 6e78 5d29 2a64 6970  es([ny, nx])*dip
+00023f10: 5f74 6f70 0d0a 2020 2020 2020 2020 656c  _top..        el
+00023f20: 6966 2061 7a69 5f74 6f70 2021 3d20 2267  if azi_top != "g
+00023f30: 7261 6469 656e 7422 2061 6e64 2064 6970  radient" and dip
+00023f40: 5f74 6f70 203d 3d20 2267 7261 6469 656e  _top == "gradien
+00023f50: 7422 3a0d 0a20 2020 2020 2020 2020 2020  t":..           
+00023f60: 2061 7a69 5f74 6f70 203d 206e 702e 6f6e   azi_top = np.on
+00023f70: 6573 285b 6e79 2c20 6e78 5d29 2a61 7a69  es([ny, nx])*azi
+00023f80: 5f74 6f70 0d0a 2020 2020 2020 2020 2020  _top..          
+00023f90: 2020 6469 705f 746f 7020 3d20 617a 695f    dip_top = azi_
+00023fa0: 6469 705f 4a53 2874 6f70 295b 315d 0d0a  dip_JS(top)[1]..
+00023fb0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00023fc0: 2020 2020 2020 2020 2020 2061 7a69 5f74             azi_t
+00023fd0: 6f70 3d6e 702e 6f6e 6573 285b 6e79 2c20  op=np.ones([ny, 
+00023fe0: 6e78 5d29 2a61 7a69 5f74 6f70 0d0a 2020  nx])*azi_top..  
+00023ff0: 2020 2020 2020 2020 2020 6469 705f 746f            dip_to
+00024000: 703d 6e70 2e6f 6e65 7328 5b6e 792c 206e  p=np.ones([ny, n
+00024010: 785d 292a 6469 705f 746f 700d 0a0d 0a20  x])*dip_top.... 
+00024020: 2020 2020 2020 2023 2062 6f74 746f 6d0d         # bottom.
+00024030: 0a20 2020 2020 2020 2069 6620 617a 695f  .        if azi_
+00024040: 626f 7420 203d 3d20 2267 7261 6469 656e  bot  == "gradien
+00024050: 7422 2061 6e64 2064 6970 5f62 6f74 203d  t" and dip_bot =
+00024060: 3d20 2267 7261 6469 656e 7422 3a0d 0a20  = "gradient":.. 
+00024070: 2020 2020 2020 2020 2020 2061 7a69 5f62             azi_b
+00024080: 6f74 2c20 6469 705f 626f 7420 3d20 617a  ot, dip_bot = az
+00024090: 695f 6469 705f 4a53 2862 6f74 290d 0a20  i_dip_JS(bot).. 
+000240a0: 2020 2020 2020 2065 6c69 6620 617a 695f         elif azi_
+000240b0: 626f 7420 3d3d 2022 6772 6164 6965 6e74  bot == "gradient
+000240c0: 2220 616e 6420 6469 705f 626f 7420 213d  " and dip_bot !=
+000240d0: 2022 6772 6164 6965 6e74 223a 0d0a 2020   "gradient":..  
+000240e0: 2020 2020 2020 2020 2020 617a 695f 626f            azi_bo
+000240f0: 7420 3d20 617a 695f 6469 705f 4a53 2862  t = azi_dip_JS(b
+00024100: 6f74 295b 305d 0d0a 2020 2020 2020 2020  ot)[0]..        
+00024110: 2020 2020 6469 705f 626f 7420 3d20 6e70      dip_bot = np
+00024120: 2e6f 6e65 7328 5b6e 792c 206e 785d 292a  .ones([ny, nx])*
+00024130: 6469 705f 626f 740d 0a20 2020 2020 2020  dip_bot..       
+00024140: 2065 6c69 6620 617a 695f 626f 7420 213d   elif azi_bot !=
+00024150: 2022 6772 6164 6965 6e74 2220 616e 6420   "gradient" and 
+00024160: 6469 705f 626f 7420 3d3d 2022 6772 6164  dip_bot == "grad
+00024170: 6965 6e74 223a 0d0a 2020 2020 2020 2020  ient":..        
+00024180: 2020 2020 617a 695f 626f 7420 3d20 6e70      azi_bot = np
+00024190: 2e6f 6e65 7328 5b6e 792c 206e 785d 292a  .ones([ny, nx])*
+000241a0: 617a 695f 626f 740d 0a20 2020 2020 2020  azi_bot..       
+000241b0: 2020 2020 2064 6970 5f62 6f74 203d 2061       dip_bot = a
+000241c0: 7a69 5f64 6970 5f4a 5328 626f 7429 5b31  zi_dip_JS(bot)[1
+000241d0: 5d0d 0a20 2020 2020 2020 2065 6c73 653a  ]..        else:
+000241e0: 0d0a 2020 2020 2020 2020 2020 2020 617a  ..            az
+000241f0: 695f 626f 743d 6e70 2e6f 6e65 7328 5b6e  i_bot=np.ones([n
+00024200: 792c 206e 785d 292a 617a 695f 626f 740d  y, nx])*azi_bot.
+00024210: 0a20 2020 2020 2020 2020 2020 2064 6970  .            dip
+00024220: 5f62 6f74 3d6e 702e 6f6e 6573 285b 6e79  _bot=np.ones([ny
+00024230: 2c20 6e78 5d29 2a64 6970 5f62 6f74 0d0a  , nx])*dip_bot..
+00024240: 0d0a 2020 2020 2020 2020 617a 693d 6e70  ..        azi=np
+00024250: 2e7a 6572 6f73 285b 6e7a 2c20 6e79 2c20  .zeros([nz, ny, 
+00024260: 6e78 5d2c 2064 7479 7065 3d6e 702e 666c  nx], dtype=np.fl
+00024270: 6f61 7433 3229 0d0a 2020 2020 2020 2020  oat32)..        
+00024280: 6d61 736b 3d73 656c 662e 756e 6974 5f6d  mask=self.unit_m
+00024290: 6173 6b28 756e 6974 5f6e 616d 653d 756e  ask(unit_name=un
+000242a0: 6974 2e6e 616d 652c 2069 753d 6975 290d  it.name, iu=iu).
+000242b0: 0a20 2020 2020 2020 2066 6f72 2069 7820  .        for ix 
+000242c0: 696e 2072 616e 6765 286e 7829 3a0d 0a20  in range(nx):.. 
+000242d0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+000242e0: 7920 696e 2072 616e 6765 286e 7929 3a20  y in range(ny): 
+000242f0: 2023 2054 4f20 4649 4e49 5348 0d0a 2020   # TO FINISH..  
+00024300: 2020 2020 2020 2020 2020 2020 2020 743d                t=
+00024310: 6e70 2e77 6865 7265 286d 6173 6b5b 3a2c  np.where(mask[:,
+00024320: 2069 792c 2069 785d 2920 2023 2072 6574   iy, ix])  # ret
+00024330: 7269 6576 6520 6964 7820 746f 2069 6e64  rieve idx to ind
+00024340: 6963 6174 6520 7768 6572 6520 6c61 7965  icate where laye
+00024350: 7220 6578 6973 7420 7665 7274 6963 616c  r exist vertical
+00024360: 6c79 2061 7420 6365 7274 6169 6e20 6c6f  ly at certain lo
+00024370: 6361 7469 6f6e 2078 0d0a 0d0a 2020 2020  cation x....    
+00024380: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00024390: 656e 2874 5b30 5d29 3e30 3a20 2023 2069  en(t[0])>0:  # i
+000243a0: 6620 6c61 7965 7220 6578 6973 7473 2061  f layer exists a
+000243b0: 7420 706f 7369 7469 6f6e 2069 7820 6979  t position ix iy
+000243c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000243d0: 2020 2020 2020 6932 3d6e 702e 6d69 6e28        i2=np.min(
+000243e0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+000243f0: 2020 2020 2020 2020 6931 3d6e 702e 6d61          i1=np.ma
+00024400: 7828 7429 0d0a 2020 2020 2020 2020 2020  x(t)..          
+00024410: 2020 2020 2020 2020 2020 7662 6f74 3d61            vbot=a
+00024420: 7a69 5f62 6f74 5b69 792c 2069 785d 0d0a  zi_bot[iy, ix]..
+00024430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024440: 2020 2020 7674 6f70 3d61 7a69 5f74 6f70      vtop=azi_top
+00024450: 5b69 792c 2069 785d 0d0a 0d0a 2020 2020  [iy, ix]....    
+00024460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024470: 6966 2028 6e70 2e61 6273 286e 702e 6d69  if (np.abs(np.mi
+00024480: 6e28 2876 626f 742c 2076 746f 7029 2920  n((vbot, vtop)) 
+00024490: 2d20 6e70 2e6d 6178 2828 7662 6f74 2c20  - np.max((vbot, 
+000244a0: 7674 6f70 2929 2929 203c 2028 6e70 2e61  vtop)))) < (np.a
+000244b0: 6273 2833 3630 202b 206e 702e 6d69 6e28  bs(360 + np.min(
+000244c0: 2876 626f 742c 2076 746f 7029 2920 2d20  (vbot, vtop)) - 
+000244d0: 6e70 2e6d 6178 2828 7662 6f74 2c20 7674  np.max((vbot, vt
+000244e0: 6f70 2929 2929 3a0d 0a20 2020 2020 2020  op)))):..       
+000244f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024500: 2061 7a69 5b3a 2c20 6979 2c20 6978 5d3d   azi[:, iy, ix]=
+00024510: 6e70 2e69 6e74 6572 7028 7a67 2c20 5b7a  np.interp(zg, [z
+00024520: 675b 6932 5d2c 207a 675b 6931 5d5d 2c20  g[i2], zg[i1]], 
+00024530: 5b76 626f 742c 2076 746f 705d 290d 0a20  [vbot, vtop]).. 
+00024540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024550: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00024560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024570: 2020 6966 2076 626f 7420 3c20 7674 6f70    if vbot < vtop
+00024580: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00024590: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000245a0: 7a69 5b3a 2c20 6979 2c20 6978 5d3d 6e70  zi[:, iy, ix]=np
+000245b0: 2e69 6e74 6572 7028 7a67 2c20 5b7a 675b  .interp(zg, [zg[
+000245c0: 6932 5d2c 207a 675b 6931 5d5d 2c20 5b76  i2], zg[i1]], [v
+000245d0: 626f 742b 3336 302c 2076 746f 705d 290d  bot+360, vtop]).
+000245e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000245f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00024600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024610: 2020 2020 2020 2020 2020 2020 617a 695b              azi[
+00024620: 3a2c 2069 792c 2069 785d 3d6e 702e 696e  :, iy, ix]=np.in
+00024630: 7465 7270 287a 672c 205b 7a67 5b69 325d  terp(zg, [zg[i2]
+00024640: 2c20 7a67 5b69 315d 5d2c 205b 7662 6f74  , zg[i1]], [vbot
+00024650: 2c20 7674 6f70 2b33 3630 5d29 0d0a 2020  , vtop+360])..  
+00024660: 2020 2020 2020 617a 695b 6d61 736b 213d        azi[mask!=
+00024670: 315d 3d30 0d0a 0d0a 2020 2020 2020 2020  1]=0....        
+00024680: 6469 703d 6e70 2e7a 6572 6f73 285b 6e7a  dip=np.zeros([nz
+00024690: 2c20 6e79 2c20 6e78 5d2c 2064 7479 7065  , ny, nx], dtype
+000246a0: 3d6e 702e 666c 6f61 7433 3229 0d0a 2020  =np.float32)..  
+000246b0: 2020 2020 2020 666f 7220 6978 2069 6e20        for ix in 
+000246c0: 7261 6e67 6528 6e78 293a 0d0a 2020 2020  range(nx):..    
+000246d0: 2020 2020 2020 2020 666f 7220 6979 2069          for iy i
+000246e0: 6e20 7261 6e67 6528 6e79 293a 0d0a 2020  n range(ny):..  
+000246f0: 2020 2020 2020 2020 2020 2020 2020 743d                t=
+00024700: 6e70 2e77 6865 7265 286d 6173 6b5b 3a2c  np.where(mask[:,
+00024710: 2069 792c 2069 785d 2920 2320 7265 7472   iy, ix]) # retr
+00024720: 6965 7665 2069 6478 2074 6f20 696e 6469  ieve idx to indi
+00024730: 6361 7465 2077 6865 7265 206c 6179 6572  cate where layer
+00024740: 2065 7869 7374 2076 6572 7469 6361 6c6c   exist verticall
+00024750: 7920 6174 2063 6572 7461 696e 206c 6f63  y at certain loc
+00024760: 6174 696f 6e20 780d 0a0d 0a20 2020 2020  ation x....     
+00024770: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00024780: 6e28 745b 305d 293e 303a 2023 2069 6620  n(t[0])>0: # if 
+00024790: 6c61 7965 7220 6578 6973 7473 2061 7420  layer exists at 
+000247a0: 706f 7369 7469 6f6e 2069 7820 6979 0d0a  position ix iy..
+000247b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000247c0: 2020 2020 6932 3d6e 702e 6d69 6e28 7429      i2=np.min(t)
+000247d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000247e0: 2020 2020 2020 6931 3d6e 702e 6d61 7828        i1=np.max(
+000247f0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00024800: 2020 2020 2020 2020 6469 705b 3a2c 2069          dip[:, i
+00024810: 792c 2069 785d 3d6e 702e 696e 7465 7270  y, ix]=np.interp
+00024820: 287a 672c 205b 7a67 5b69 325d 2c20 7a67  (zg, [zg[i2], zg
+00024830: 5b69 315d 5d2c 205b 6469 705f 626f 745b  [i1]], [dip_bot[
+00024840: 6979 2c20 6978 5d2c 2064 6970 5f74 6f70  iy, ix], dip_top
+00024850: 5b69 792c 2069 785d 5d29 0d0a 0d0a 2020  [iy, ix]])....  
+00024860: 2020 2020 2020 6469 705b 6d61 736b 213d        dip[mask!=
+00024870: 315d 3d30 0d0a 0d0a 2020 2020 2020 2020  1]=0....        
+00024880: 7265 7475 726e 2061 7a69 2c20 6469 700d  return azi, dip.
+00024890: 0a0d 0a0d 0a0d 0a20 2020 2064 6566 2065  .......    def e
+000248a0: 7874 7261 6374 5f6c 6f67 5f66 6163 6965  xtract_log_facie
+000248b0: 735f 6268 2873 656c 662c 2066 6163 6965  s_bh(self, facie
+000248c0: 732c 2062 6878 2c20 6268 792c 2062 687a  s, bhx, bhy, bhz
+000248d0: 2c20 6465 7074 6829 3a0d 0a0d 0a20 2020  , depth):....   
+000248e0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000248f0: 2020 4578 7472 6163 7420 7468 6520 6c6f    Extract the lo
+00024900: 6720 6661 6369 6573 2069 6e20 7468 6520  g facies in the 
+00024910: 4172 6368 5079 2066 6f72 6d61 7420 6174  ArchPy format at
+00024920: 2074 6865 2073 7065 6369 6669 6320 6c6f   the specific lo
+00024930: 6361 7469 6f6e 0d0a 0d0a 2020 2020 2020  cation....      
+00024940: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00024950: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00024960: 0d0a 2020 2020 2020 2020 6661 6369 6573  ..        facies
+00024970: 3a20 3344 206e 6461 7272 6179 0d0a 2020  : 3D ndarray..  
+00024980: 2020 2020 2020 2020 2020 6661 6369 6573            facies
+00024990: 2072 6561 6c69 7a61 7469 6f6e 0d0a 2020   realization..  
+000249a0: 2020 2020 2020 6268 782c 2062 6879 2c20        bhx, bhy, 
+000249b0: 6268 7a3a 2066 6c6f 6174 0d0a 2020 2020  bhz: float..    
+000249c0: 2020 2020 2020 2020 626f 7265 686f 6c65          borehole
+000249d0: 206c 6f63 6174 696f 6e0d 0a20 2020 2020   location..     
+000249e0: 2020 2064 6570 7468 3a20 666c 6f61 740d     depth: float.
+000249f0: 0a20 2020 2020 2020 2020 2020 2064 6570  .            dep
+00024a00: 7468 206f 6620 696e 7665 7374 6967 6174  th of investigat
+00024a10: 696f 6e0d 0a20 2020 2020 2020 200d 0a20  ion..        .. 
+00024a20: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+00024a30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+00024a40: 0a20 2020 2020 2020 206c 6f67 5f66 6163  .        log_fac
+00024a50: 6965 733a 206c 6973 7420 6f66 203a 636c  ies: list of :cl
+00024a60: 6173 733a 6046 6163 6965 7360 206f 626a  ass:`Facies` obj
+00024a70: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
+00024a80: 2061 206c 6f67 2066 6163 6965 7320 286c   a log facies (l
+00024a90: 6973 7420 6f66 2066 6163 6965 7320 6f62  ist of facies ob
+00024aa0: 6a65 6374 2077 6974 6820 656c 6576 6174  ject with elevat
+00024ab0: 696f 6e73 290d 0a20 2020 2020 2020 2022  ions)..        "
+00024ac0: 2222 0d0a 0d0a 2020 2020 2020 2020 6268  ""....        bh
+00024ad0: 5f63 656c 6c3d 7365 6c66 2e63 6f6f 7264  _cell=self.coord
+00024ae0: 3263 656c 6c28 6268 782c 2062 6879 2c20  2cell(bhx, bhy, 
+00024af0: 6268 7a29 0d0a 2020 2020 2020 2020 6268  bhz)..        bh
+00024b00: 5f62 6f74 5f63 656c 6c3d 7365 6c66 2e63  _bot_cell=self.c
+00024b10: 6f6f 7264 3263 656c 6c28 6268 782c 2062  oord2cell(bhx, b
+00024b20: 6879 2c20 6268 7a2d 6465 7074 6829 0d0a  hy, bhz-depth)..
+00024b30: 2020 2020 2020 2020 6966 2062 685f 626f          if bh_bo
+00024b40: 745f 6365 6c6c 2069 7320 6e6f 7420 4e6f  t_cell is not No
+00024b50: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00024b60: 2062 685f 626f 745f 6365 6c6c 3d62 685f   bh_bot_cell=bh_
+00024b70: 626f 745f 6365 6c6c 5b30 5d0d 0a20 2020  bot_cell[0]..   
+00024b80: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00024b90: 2020 2020 2020 2020 6268 5f62 6f74 5f63          bh_bot_c
+00024ba0: 656c 6c3d 300d 0a0d 0a20 2020 2020 2020  ell=0....       
+00024bb0: 2069 645f 6661 6369 6573 3d66 6163 6965   id_facies=facie
+00024bc0: 735b 6268 5f62 6f74 5f63 656c 6c3a 2062  s[bh_bot_cell: b
+00024bd0: 685f 6365 6c6c 5b30 2b31 5d2c 2062 685f  h_cell[0+1], bh_
+00024be0: 6365 6c6c 5b31 5d2c 2062 685f 6365 6c6c  cell[1], bh_cell
+00024bf0: 5b32 5d5d 5b3a 3a20 2d31 5d0d 0a20 2020  [2]][:: -1]..   
+00024c00: 2020 2020 207a 5f66 6163 6965 733d 7365       z_facies=se
+00024c10: 6c66 2e7a 6763 5b62 685f 626f 745f 6365  lf.zgc[bh_bot_ce
+00024c20: 6c6c 3a20 6268 5f63 656c 6c5b 305d 2b31  ll: bh_cell[0]+1
+00024c30: 5d5b 3a3a 202d 315d 0d0a 0d0a 2020 2020  ][:: -1]....    
+00024c40: 2020 2020 693d 300d 0a20 2020 2020 2020      i=0..       
+00024c50: 206c 6f67 5f66 6163 6965 733d 5b5d 0d0a   log_facies=[]..
+00024c60: 2020 2020 2020 2020 6661 5f70 7265 763d          fa_prev=
+00024c70: 300d 0a20 2020 2020 2020 2066 6f72 2066  0..        for f
+00024c80: 6120 696e 2069 645f 6661 6369 6573 3a0d  a in id_facies:.
+00024c90: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+00024ca0: 6620 6661 2021 3d20 6661 5f70 7265 7620  f fa != fa_prev 
+00024cb0: 616e 6420 6661 2021 3d20 303a 0d0a 2020  and fa != 0:..  
+00024cc0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00024cd0: 675f 6661 6369 6573 2e61 7070 656e 6428  g_facies.append(
+00024ce0: 2873 656c 662e 6765 745f 6661 6369 6573  (self.get_facies
+00024cf0: 5f6f 626a 2849 4420 3d66 612c 2074 7970  _obj(ID =fa, typ
+00024d00: 653d 2249 4422 292c 206e 702e 726f 756e  e="ID"), np.roun
+00024d10: 6428 7a5f 6661 6369 6573 5b69 5d2c 2032  d(z_facies[i], 2
+00024d20: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
+00024d30: 2020 2020 2066 615f 7072 6576 3d66 610d       fa_prev=fa.
+00024d40: 0a0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
+00024d50: 202b 3d20 310d 0a0d 0a20 2020 2020 2020   += 1....       
+00024d60: 2072 6574 7572 6e20 6c6f 675f 6661 6369   return log_faci
+00024d70: 6573 0d0a 0d0a 2020 2020 6465 6620 6765  es....    def ge
+00024d80: 745f 656e 7472 6f70 7928 7365 6c66 2c20  t_entropy(self, 
+00024d90: 7479 7020 3d20 2275 6e69 7473 222c 2068  typ = "units", h
+00024da0: 5f6c 6576 656c 203d 204e 6f6e 652c 2072  _level = None, r
+00024db0: 6563 6f6d 7075 7465 3d46 616c 7365 293a  ecompute=False):
+00024dc0: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
+00024dd0: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
+00024de0: 2074 6865 2053 6861 6e6e 6f6e 2065 6e74   the Shannon ent
+00024df0: 726f 7079 2066 6f72 2075 6e69 7473 206f  ropy for units o
+00024e00: 7220 6661 6369 6573 2061 6e64 2072 6574  r facies and ret
+00024e10: 7572 6e20 6974 2e0d 0a0d 0a20 2020 2020  urn it.....     
+00024e20: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00024e30: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00024e40: 2d0d 0a20 2020 2020 2020 2074 7970 3a20  -..        typ: 
+00024e50: 7374 7269 6e67 0d0a 2020 2020 2020 2020  string..        
+00024e60: 2020 2020 7479 7065 206f 6620 6d6f 6465      type of mode
+00024e70: 6c73 2074 6f20 7573 6520 746f 2063 6f6d  ls to use to com
+00024e80: 7075 7465 2074 6865 2065 6e74 726f 7079  pute the entropy
+00024e90: 2c0d 0a20 2020 2020 2020 2020 2020 2076  ,..            v
+00024ea0: 616c 6964 2076 616c 7565 7320 6172 6520  alid values are 
+00024eb0: 2275 6e69 7473 2220 616e 6420 2266 6163  "units" and "fac
+00024ec0: 6965 7322 0d0a 2020 2020 2020 2020 685f  ies"..        h_
+00024ed0: 6c65 7665 6c3a 2069 6e74 0d0a 2020 2020  level: int..    
+00024ee0: 2020 2020 2020 2020 6869 6561 7263 6869          hiearchi
+00024ef0: 6361 6c20 6c65 7665 6c20 746f 2075 7365  cal level to use
+00024f00: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00024f10: 656e 7472 6f70 792c 0d0a 2020 2020 2020  entropy,..      
+00024f20: 2020 2020 2020 6f6e 6c79 2075 7365 6420        only used 
+00024f30: 6966 2074 7970 2069 7320 2275 6e69 7473  if typ is "units
+00024f40: 220d 0a20 2020 2020 2020 2072 6563 6f6d  "..        recom
+00024f50: 7075 7465 3a20 626f 6f6c 0d0a 2020 2020  pute: bool..    
+00024f60: 2020 2020 2020 2020 6966 2054 7275 652c          if True,
+00024f70: 2072 6563 6f6d 7075 7465 2074 6865 2065   recompute the e
+00024f80: 6e74 726f 7079 0d0a 2020 2020 2020 2020  ntropy..        
+00024f90: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00024fa0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00024fb0: 2d2d 0d0a 2020 2020 2020 2020 3344 206e  --..        3D n
+00024fc0: 6461 7272 6179 206f 6620 7369 7a65 2028  darray of size (
+00024fd0: 6e7a 2c20 6e79 2c20 6e78 290d 0a20 2020  nz, ny, nx)..   
+00024fe0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00024ff0: 2020 2020 6966 2074 7970 203d 3d20 2275      if typ == "u
+00025000: 6e69 7473 223a 0d0a 2020 2020 2020 2020  nits":..        
+00025010: 2020 2020 7374 7269 6e67 203d 2022 756e      string = "un
+00025020: 6974 735f 656e 7472 6f70 7922 0d0a 2020  its_entropy"..  
+00025030: 2020 2020 2020 656c 6966 2074 7970 3d3d        elif typ==
+00025040: 2022 6661 6369 6573 223a 0d0a 2020 2020   "facies":..    
+00025050: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
+00025060: 2022 756e 6974 735f 6661 6369 6573 220d   "units_facies".
+00025070: 0a0d 0a20 2020 2020 2020 2069 6620 6861  ...        if ha
+00025080: 7361 7474 7228 7365 6c66 2e47 656f 6c2c  sattr(self.Geol,
+00025090: 2073 7472 696e 6729 2061 6e64 2072 6563   string) and rec
+000250a0: 6f6d 7075 7465 203d 3d20 4661 6c73 653a  ompute == False:
+000250b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000250c0: 6966 2072 6563 6f6d 7075 7465 203d 3d20  if recompute == 
+000250d0: 2266 616c 7365 223a 0d0a 2020 2020 2020  "false":..      
+000250e0: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
+000250f0: 203d 3d20 2275 6e69 7473 223a 0d0a 2020   == "units":..  
+00025100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025110: 2020 7265 7475 726e 2073 656c 662e 4765    return self.Ge
+00025120: 6f6c 2e75 6e69 7473 5f65 6e74 726f 7079  ol.units_entropy
+00025130: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025140: 2020 656c 6966 2074 7970 203d 3d20 2266    elif typ == "f
+00025150: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
+00025160: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00025170: 7572 6e20 7365 6c66 2e47 656f 6c2e 6661  urn self.Geol.fa
+00025180: 6369 6573 5f65 6e74 726f 7079 0d0a 200d  cies_entropy.. .
+00025190: 0a20 2020 2020 2020 2065 6c69 6620 7265  .        elif re
+000251a0: 636f 6d70 7574 6520 6f72 206e 6f74 2068  compute or not h
+000251b0: 6173 6174 7472 2873 656c 662e 4765 6f6c  asattr(self.Geol
+000251c0: 2c20 7374 7269 6e67 293a 0d0a 0d0a 2020  , string):....  
+000251d0: 2020 2020 2020 2020 2020 6e7a 203d 2073            nz = s
+000251e0: 656c 662e 6765 745f 6e7a 2829 0d0a 2020  elf.get_nz()..  
+000251f0: 2020 2020 2020 2020 2020 6e79 203d 2073            ny = s
+00025200: 656c 662e 6765 745f 6e79 2829 0d0a 2020  elf.get_ny()..  
+00025210: 2020 2020 2020 2020 2020 6e78 203d 2073            nx = s
+00025220: 656c 662e 6765 745f 6e78 2829 0d0a 0d0a  elf.get_nx()....
+00025230: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+00025240: 3d20 6e70 2e7a 6572 6f73 285b 6e7a 2c20  = np.zeros([nz, 
+00025250: 6e79 2c20 6e78 5d29 0d0a 2020 2020 2020  ny, nx])..      
+00025260: 2020 2020 2020 6966 2074 7970 203d 3d22        if typ =="
+00025270: 756e 6974 7322 3a0d 0a20 2020 2020 2020  units":..       
+00025280: 2020 2020 2020 2020 2075 6e69 7473 203d           units =
+00025290: 2073 656c 662e 6765 745f 756e 6974 735f   self.get_units_
+000252a0: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
+000252b0: 696f 6e73 2868 5f6c 6576 656c 203d 2068  ions(h_level = h
+000252c0: 5f6c 6576 656c 290d 0a20 2020 2020 2020  _level)..       
+000252d0: 2020 2020 2020 2020 206c 6973 745f 756e           list_un
+000252e0: 6974 735f 6964 7320 3d20 6e70 2e75 6e69  its_ids = np.uni
+000252f0: 7175 6528 756e 6974 735b 756e 6974 7320  que(units[units 
+00025300: 213d 2030 5d29 0d0a 0d0a 2020 2020 2020  != 0])....      
+00025310: 2020 2020 2020 2020 2020 6461 7461 203d            data =
+00025320: 2075 6e69 7473 5b3a 2c20 7365 6c66 2e6d   units[:, self.m
+00025330: 6173 6b5d 0d0a 2020 2020 2020 2020 2020  ask]..          
+00025340: 2020 2020 2020 5345 203d 206e 702e 7a65        SE = np.ze
+00025350: 726f 7328 5b64 6174 612e 7368 6170 655b  ros([data.shape[
+00025360: 315d 5d29 0d0a 2020 2020 2020 2020 2020  1]])..          
+00025370: 2020 2020 2020 2362 3d6c 656e 2873 656c        #b=len(sel
+00025380: 662e 6765 745f 616c 6c5f 756e 6974 7328  f.get_all_units(
+00025390: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+000253a0: 2020 2020 6220 3d20 6c65 6e28 6c69 7374      b = len(list
+000253b0: 5f75 6e69 7473 5f69 6473 290d 0a20 2020  _units_ids)..   
+000253c0: 2020 2020 2020 2020 2020 2020 206e 7265               nre
+000253d0: 616c 3d75 6e69 7473 2e73 6861 7065 5b30  al=units.shape[0
+000253e0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
+000253f0: 2020 2020 2066 6f72 2069 6478 2069 6e20       for idx in 
+00025400: 6c69 7374 5f75 6e69 7473 5f69 6473 3a0d  list_units_ids:.
+00025410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025420: 2020 2020 2075 6e69 7420 3d20 7365 6c66       unit = self
+00025430: 2e67 6574 5f75 6e69 7428 4944 3d69 6478  .get_unit(ID=idx
+00025440: 2c20 7479 7065 3d22 4944 2229 0d0a 2020  , type="ID")..  
+00025450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025460: 2020 5069 203d 2028 6461 7461 203d 3d20    Pi = (data == 
+00025470: 756e 6974 2e49 4429 2e73 756d 2830 292f  unit.ID).sum(0)/
+00025480: 6e72 6561 6c0d 0a20 2020 2020 2020 2020  nreal..         
+00025490: 2020 2020 2020 2020 2020 2070 695f 6d61             pi_ma
+000254a0: 736b 203d 2028 5069 2021 3d20 3029 0d0a  sk = (Pi != 0)..
+000254b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254c0: 2020 2020 5345 5b70 695f 6d61 736b 5d20      SE[pi_mask] 
+000254d0: 2b3d 2050 695b 7069 5f6d 6173 6b5d 202a  += Pi[pi_mask] *
+000254e0: 2028 6e70 2e6c 6f67 2850 695b 7069 5f6d   (np.log(Pi[pi_m
+000254f0: 6173 6b5d 292f 6e70 2e6c 6f67 2862 2929  ask])/np.log(b))
+00025500: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025510: 2020 2020 2020 6172 725b 7365 6c66 2e6d        arr[self.m
+00025520: 6173 6b5d 203d 2d20 5345 0d0a 0d0a 2020  ask] =- SE....  
+00025530: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00025540: 725b 7e73 656c 662e 6d61 736b 5d3d 6e70  r[~self.mask]=np
+00025550: 2e6e 616e 0d0a 0d0a 2020 2020 2020 2020  .nan....        
+00025560: 2020 2020 2020 2020 7365 6c66 2e47 656f          self.Geo
+00025570: 6c2e 756e 6974 735f 656e 7472 6f70 7920  l.units_entropy 
+00025580: 3d20 6172 7220 2020 200d 0a20 2020 2020  = arr    ..     
+00025590: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000255a0: 6e20 6172 720d 0a0d 0a20 2020 2020 2020  n arr....       
+000255b0: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
+000255c0: 2022 6661 6369 6573 223a 0d0a 0d0a 2020   "facies":....  
+000255d0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+000255e0: 6369 6573 5f64 6f6d 6169 6e73 203d 2073  cies_domains = s
+000255f0: 656c 662e 6765 745f 6661 6369 6573 2829  elf.get_facies()
+00025600: 2e72 6573 6861 7065 282d 312c 2073 656c  .reshape(-1, sel
+00025610: 662e 6e7a 2c20 7365 6c66 2e6e 792c 2073  f.nz, self.ny, s
+00025620: 656c 662e 6e78 290d 0a20 2020 2020 2020  elf.nx)..       
+00025630: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
+00025640: 756e 6974 735b 3a2c 2073 656c 662e 6d61  units[:, self.ma
+00025650: 736b 5d0d 0a20 2020 2020 2020 2020 2020  sk]..           
+00025660: 2020 2020 2053 4520 3d20 6e70 2e7a 6572       SE = np.zer
+00025670: 6f73 285b 6461 7461 2e73 6861 7065 5b31  os([data.shape[1
+00025680: 5d5d 2920 2023 2073 6861 6e6e 6f6e 2065  ]])  # shannon e
+00025690: 6e74 726f 7079 0d0a 2020 2020 2020 2020  ntropy..        
+000256a0: 2020 2020 2020 2020 6220 3d20 6c65 6e28          b = len(
+000256b0: 7365 6c66 2e67 6574 5f61 6c6c 5f66 6163  self.get_all_fac
+000256c0: 6965 7328 2929 0d0a 2020 2020 2020 2020  ies())..        
+000256d0: 2020 2020 2020 2020 6e72 6561 6c3d 6661          nreal=fa
+000256e0: 6369 6573 5f64 6f6d 6169 6e73 2e73 6861  cies_domains.sha
+000256f0: 7065 5b30 5d0d 0a0d 0a20 2020 2020 2020  pe[0]....       
+00025700: 2020 2020 2020 2020 2066 6f72 2066 6163           for fac
+00025710: 6965 7320 696e 2073 656c 662e 6765 745f  ies in self.get_
+00025720: 616c 6c5f 6661 6369 6573 2829 3a0d 0a20  all_facies():.. 
 00025730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025740: 7365 6c66 2e47 656f 6c2e 6661 6369 6573  self.Geol.facies
-00025750: 5f65 6e74 726f 7079 203d 2061 7272 0d0a  _entropy = arr..
-00025760: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00025770: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00025780: 2020 2020 2070 7269 6e74 2822 4368 6f6f       print("Choo
-00025790: 7365 2062 6574 7765 656e 2075 6e69 7473  se between units
-000257a0: 206f 7220 6661 6369 6573 2229 0d0a 0d0a   or facies")....
-000257b0: 0d0a 2020 2020 6465 6620 7265 616c 697a  ..    def realiz
-000257c0: 6174 696f 6e73 5f61 6767 7265 6761 7469  ations_aggregati
-000257d0: 6f6e 2873 656c 662c 206d 6574 686f 643d  on(self, method=
-000257e0: 2262 6173 6963 222c 0d0a 2020 2020 2020  "basic",..      
-000257f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025800: 2020 2020 2020 2064 6570 7468 3d31 3030         depth=100
-00025810: 2c20 6967 6e6f 7265 5f75 6e69 7473 3d4e  , ignore_units=N
-00025820: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
-00025830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025840: 2020 2075 6e69 7473 5f74 6f5f 6669 6c6c     units_to_fill
-00025850: 3d5b 5d2c 0d0a 2020 2020 2020 2020 2020  =[],..          
-00025860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025870: 2020 206e 5f69 7465 7220 3d20 3530 293a     n_iter = 50):
-00025880: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-00025890: 2222 220d 0a20 2020 2020 2020 204d 6574  """..        Met
-000258a0: 686f 6420 746f 2061 6767 7265 6761 7465  hod to aggregate
-000258b0: 206d 756c 7469 706c 6520 4172 6368 5079   multiple ArchPy
-000258c0: 2072 6561 6c69 7a61 7469 6f6e 7320 696e   realizations in
-000258d0: 746f 206f 6e65 2066 6f72 2075 6e69 7473  to one for units
-000258e0: 2061 6e64 2066 6163 6965 7320 2854 4f20   and facies (TO 
-000258f0: 444f 290d 0a20 2020 2020 2020 200d 0a20  DO)..        .. 
-00025900: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00025910: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00025920: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206d  -----..        m
-00025930: 6574 686f 643a 2073 7472 0d0a 2020 2020  ethod: str..    
-00025940: 2020 2020 2020 2020 6d65 7468 6f64 2074          method t
-00025950: 6f20 7573 6520 746f 2061 6767 7265 6761  o use to aggrega
-00025960: 7465 2074 6865 2072 6561 6c69 7a61 7469  te the realizati
-00025970: 6f6e 730d 0a20 2020 2020 2020 2020 2020  ons..           
-00025980: 2076 616c 6964 206d 6574 686f 6420 6172   valid method ar
-00025990: 653a 0d0a 0d0a 2020 2020 2020 2020 2020  e:....          
-000259a0: 2020 2d20 6261 7369 632c 2072 6574 7572    - basic, retur
-000259b0: 6e20 6120 6d6f 6465 6c20 7769 7468 2074  n a model with t
-000259c0: 6865 206d 6f73 7420 7072 6f62 6162 6c65  he most probable
-000259d0: 2075 6e69 7473 2f66 6163 6965 7320 696e   units/facies in
-000259e0: 2065 6163 6820 6365 6c6c 730d 0a20 2020   each cells..   
-000259f0: 2020 2020 2020 2020 202d 2070 726f 6261           - proba
-00025a00: 735f 7072 6f70 2c20 7265 7475 726e 2061  s_prop, return a
-00025a10: 206d 6f64 656c 2063 6f6e 7374 7275 6374   model construct
-00025a20: 6564 2073 6571 7565 6e74 6961 6c6c 7920  ed sequentially 
-00025a30: 6279 2065 6e73 7572 696e 6720 7468 6174  by ensuring that
-00025a40: 2070 726f 706f 7274 696f 6e73 2061 7265   proportions are
-00025a50: 2072 6573 7065 6374 6564 2028 6174 2062   respected (at b
-00025a60: 6573 742e 2e2e 290d 0a20 2020 2020 2020  est...)..       
-00025a70: 2020 2020 202d 206d 6561 6e5f 7375 7266       - mean_surf
-00025a80: 732c 2020 7265 7475 726e 2061 206d 6f64  s,  return a mod
-00025a90: 656c 2063 7265 6174 6564 2062 7920 6d65  el created by me
-00025aa0: 616e 696e 6720 7468 6520 7375 7266 6163  aning the surfac
-00025ab0: 6520 656c 6576 6174 696f 6e20 6966 2075  e elevation if u
-00025ac0: 6e69 7473 2077 6572 6520 7369 6d75 6c61  nits were simula
-00025ad0: 7465 6420 7769 7468 2063 6174 6567 6f72  ted with categor
-00025ae0: 6963 616c 206d 6574 686f 642c 2062 6173  ical method, bas
-00025af0: 6963 206d 6574 686f 6420 6973 2075 7365  ic method is use
-00025b00: 6420 666f 7220 7468 6573 6520 756e 6974  d for these unit
-00025b10: 730d 0a0d 0a20 2020 2020 2020 2064 6570  s....        dep
-00025b20: 7468 3a20 666c 6f61 740d 0a20 2020 2020  th: float..     
-00025b30: 2020 2020 2020 2070 726f 6261 735f 7072         probas_pr
-00025b40: 6f70 2070 6172 616d 6574 6572 2c20 6d61  op parameter, ma
-00025b50: 7869 6d75 6d20 6465 7074 6820 6f66 2069  ximum depth of i
-00025b60: 6e76 6573 7469 6761 7469 6f6e 200d 0a20  nvestigation .. 
-00025b70: 2020 2020 2020 2020 2020 2074 6f20 636f             to co
-00025b80: 6d70 7574 6520 7072 6f62 6173 2061 6e64  mpute probas and
-00025b90: 2070 726f 706f 7274 696f 6e73 2e20 0d0a   proportions. ..
-00025ba0: 2020 2020 2020 2020 2020 2020 5368 6f75              Shou
-00025bb0: 6c64 2062 6520 6172 6f75 6e64 2074 6865  ld be around the
-00025bc0: 206d 6564 6961 6e20 6465 7074 6820 6f66   median depth of
-00025bd0: 2074 6865 2062 6f72 6568 6f6c 6573 0d0a   the boreholes..
-00025be0: 2020 2020 2020 2020 6967 6e6f 7265 5f75          ignore_u
-00025bf0: 6e69 7473 3a20 6c69 7374 0d0a 2020 2020  nits: list..    
-00025c00: 2020 2020 2020 2020 7072 6f62 6173 5f70          probas_p
-00025c10: 726f 7020 7061 7261 6d65 7465 722c 2075  rop parameter, u
-00025c20: 6e69 7473 206e 616d 6520 746f 2069 676e  nits name to ign
-00025c30: 6f72 652e 200d 0a20 2020 2020 2020 2020  ore. ..         
-00025c40: 2020 2054 6865 7365 2075 6e69 7473 2077     These units w
-00025c50: 696c 6c20 6e6f 7420 6265 2061 6767 7265  ill not be aggre
-00025c60: 6761 7465 6420 696e 2074 6865 2066 696e  gated in the fin
-00025c70: 616c 206d 6f64 656c 2e0d 0a20 2020 2020  al model...     
-00025c80: 2020 2075 6e69 7473 5f74 6f5f 6669 6c6c     units_to_fill
-00025c90: 3a20 6c69 7374 0d0a 2020 2020 2020 2020  : list..        
-00025ca0: 2020 2020 6d65 616e 5f73 7572 6673 2070      mean_surfs p
-00025cb0: 6172 616d 6574 6572 2c20 756e 6974 7320  arameter, units 
-00025cc0: 6e61 6d65 2074 6f20 6669 6c6c 2077 6974  name to fill wit
-00025cd0: 6820 4e4e 2061 7420 7468 6520 656e 642e  h NN at the end.
-00025ce0: 0d0a 2020 2020 2020 2020 2020 2020 5368  ..            Sh
-00025cf0: 6f75 6c64 206e 6f74 2062 6520 7573 6564  ould not be used
-00025d00: 2065 7863 6570 7420 746f 2066 696c 6c20   except to fill 
-00025d10: 7468 6520 746f 7020 756e 6974 2e0d 0a0d  the top unit....
-00025d20: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00025d30: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00025d40: 2d0d 0a20 2020 2020 2020 2033 4420 6e64  -..        3D nd
-00025d50: 6172 7261 7920 6f66 2073 697a 6520 286e  array of size (n
-00025d60: 7a2c 206e 792c 206e 7829 0d0a 2020 2020  z, ny, nx)..    
-00025d70: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00025d80: 2020 2069 6620 6967 6e6f 7265 5f75 6e69     if ignore_uni
-00025d90: 7473 2069 7320 4e6f 6e65 3a0d 0a20 2020  ts is None:..   
-00025da0: 2020 2020 2020 2020 2069 676e 6f72 655f           ignore_
-00025db0: 756e 6974 7320 3d20 5b5d 0d0a 0d0a 2020  units = []....  
-00025dc0: 2020 2020 2020 6967 6e5f 756e 203d 205b        ign_un = [
-00025dd0: 5d0d 0a20 2020 2020 2020 2066 6f72 2075  ]..        for u
-00025de0: 6e20 696e 2069 676e 6f72 655f 756e 6974  n in ignore_unit
-00025df0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00025e00: 6967 6e5f 756e 2e61 7070 656e 6428 756e  ign_un.append(un
-00025e10: 290d 0a0d 0a20 2020 2020 2020 206e 7a20  )....        nz 
-00025e20: 3d20 7365 6c66 2e67 6574 5f6e 7a28 290d  = self.get_nz().
-00025e30: 0a20 2020 2020 2020 206e 7920 3d20 7365  .        ny = se
-00025e40: 6c66 2e67 6574 5f6e 7928 290d 0a20 2020  lf.get_ny()..   
-00025e50: 2020 2020 206e 7820 3d20 7365 6c66 2e67       nx = self.g
-00025e60: 6574 5f6e 7828 290d 0a0d 0a20 2020 2020  et_nx()....     
-00025e70: 2020 2069 6620 6d65 7468 6f64 203d 3d20     if method == 
-00025e80: 2262 6173 6963 223a 0d0a 2020 2020 2020  "basic":..      
-00025e90: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-00025ea0: 2020 2020 756e 6974 7320 3d20 7365 6c66      units = self
-00025eb0: 2e67 6574 5f75 6e69 7473 5f64 6f6d 6169  .get_units_domai
-00025ec0: 6e73 5f72 6561 6c69 7a61 7469 6f6e 7328  ns_realizations(
-00025ed0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00025ee0: 206d 6f73 745f 7072 6f62 203d 206e 702e   most_prob = np.
-00025ef0: 7a65 726f 7328 286e 7a2c 206e 792c 206e  zeros((nz, ny, n
-00025f00: 7829 2c20 6474 7970 653d 6e70 2e69 6e74  x), dtype=np.int
-00025f10: 3829 0d0a 0d0a 2020 2020 2020 2020 2020  8)....          
-00025f20: 2020 666f 7220 697a 2069 6e20 7261 6e67    for iz in rang
-00025f30: 6528 7365 6c66 2e67 6574 5f6e 7a28 2929  e(self.get_nz())
-00025f40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00025f50: 2020 2066 6f72 2069 7920 696e 2072 616e     for iy in ran
-00025f60: 6765 2873 656c 662e 6765 745f 6e79 2829  ge(self.get_ny()
-00025f70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00025f80: 2020 2020 2020 2020 666f 7220 6978 2069          for ix i
-00025f90: 6e20 7261 6e67 6528 7365 6c66 2e67 6574  n range(self.get
-00025fa0: 5f6e 7828 2929 3a0d 0a20 2020 2020 2020  _nx()):..       
-00025fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025fc0: 2069 6620 7365 6c66 2e6d 6173 6b5b 697a   if self.mask[iz
-00025fd0: 2c20 6979 2c20 6978 5d3a 0d0a 2020 2020  , iy, ix]:..    
-00025fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ff0: 2020 2020 2020 2020 6f63 6320 3d20 6e70          occ = np
-00026000: 2e62 696e 636f 756e 7428 756e 6974 735b  .bincount(units[
-00026010: 3a2c 2069 7a2c 2069 792c 2069 785d 290d  :, iz, iy, ix]).
-00026020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026030: 2020 2020 2020 2020 2020 2020 2069 6478               idx
-00026040: 203d 206e 702e 7768 6572 6528 6f63 633d   = np.where(occ=
-00026050: 3d6d 6178 286f 6363 2929 0d0a 2020 2020  =max(occ))..    
-00026060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026070: 2020 2020 2020 2020 6d6f 7374 5f70 726f          most_pro
-00026080: 625b 697a 2c20 6979 2c20 6978 5d20 3d20  b[iz, iy, ix] = 
-00026090: 6964 785b 305d 5b30 5d0d 0a0d 0a20 2020  idx[0][0]....   
-000260a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000260b0: 6d6f 7374 5f70 726f 620d 0a20 2020 2020  most_prob..     
-000260c0: 2020 200d 0a20 2020 2020 2020 2065 6c69     ..        eli
-000260d0: 6620 6d65 7468 6f64 203d 3d20 2270 726f  f method == "pro
-000260e0: 6261 735f 7072 6f70 223a 0d0a 0d0a 2020  bas_prop":....  
-000260f0: 2020 2020 2020 2020 2020 2323 2074 6972            ## tir
-00026100: 6572 206c 6573 2070 726f 706f 7274 696f  er les proportio
-00026110: 6e73 2064 6520 6368 6171 7565 2075 6e69  ns de chaque uni
-00026120: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-00026130: 645f 7072 6f70 5f75 6e69 7473 203d 2073  d_prop_units = s
-00026140: 656c 662e 6765 745f 7072 6f70 6f72 7469  elf.get_proporti
-00026150: 6f6e 7328 6465 7074 685f 6d69 6e20 3d20  ons(depth_min = 
-00026160: 302c 2064 6570 7468 5f6d 6178 203d 2064  0, depth_max = d
-00026170: 6570 7468 2c20 6967 6e6f 7265 5f75 6e69  epth, ignore_uni
-00026180: 7473 203d 2069 676e 5f75 6e29 0d0a 0d0a  ts = ign_un)....
-00026190: 2020 2020 2020 2020 2020 2020 2320 6372              # cr
-000261a0: 6561 7465 206d 6173 6b0d 0a20 2020 2020  eate mask..     
-000261b0: 2020 2020 2020 2069 6e74 6572 203d 2069         inter = i
-000261c0: 6e74 2864 6570 7468 2f73 656c 662e 6765  nt(depth/self.ge
-000261d0: 745f 737a 2829 290d 0a20 2020 2020 2020  t_sz())..       
-000261e0: 2020 2020 206d 6173 6b5f 6465 7074 6820       mask_depth 
-000261f0: 3d20 6e70 2e7a 6572 6f73 285b 6e7a 2c20  = np.zeros([nz, 
-00026200: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d62  ny, nx], dtype=b
-00026210: 6f6f 6c29 0d0a 2020 2020 2020 2020 2020  ool)..          
-00026220: 2020 666f 7220 6979 2069 6e20 7261 6e67    for iy in rang
-00026230: 6528 6e79 293a 0d0a 2020 2020 2020 2020  e(ny):..        
-00026240: 2020 2020 2020 2020 666f 7220 6978 2069          for ix i
-00026250: 6e20 7261 6e67 6528 6e78 293a 0d0a 2020  n range(nx):..  
-00026260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026270: 2020 6120 3d20 6e70 2e77 6865 7265 2873    a = np.where(s
-00026280: 656c 662e 6d61 736b 5b3a 2c20 6979 2c20  elf.mask[:, iy, 
-00026290: 6978 5d29 0d0a 2020 2020 2020 2020 2020  ix])..          
-000262a0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-000262b0: 2861 5b30 5d29 203e 2030 3a0d 0a0d 0a20  (a[0]) > 0:.... 
-000262c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262d0: 2020 2020 2020 2076 203d 2069 6e74 286d         v = int(m
-000262e0: 6178 2861 5b30 5d29 202d 206d 696e 2861  ax(a[0]) - min(a
-000262f0: 5b30 5d29 290d 0a20 2020 2020 2020 2020  [0]))..         
-00026300: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00026310: 6620 7620 3e20 696e 7465 723a 0d0a 2020  f v > inter:..  
-00026320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026330: 2020 2020 2020 2020 2020 6d61 736b 5f64            mask_d
-00026340: 6570 7468 5b6d 6178 2861 5b30 5d29 2d69  epth[max(a[0])-i
-00026350: 6e74 6572 3a6d 6178 2861 5b30 5d29 2c20  nter:max(a[0]), 
-00026360: 6979 2c20 6978 5d20 3d20 5472 7565 0d0a  iy, ix] = True..
-00026370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026380: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00026390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000263a0: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
-000263b0: 6465 7074 685b 6d69 6e28 615b 305d 293a  depth[min(a[0]):
-000263c0: 6d61 7828 615b 305d 292c 2069 792c 2069  max(a[0]), iy, i
-000263d0: 785d 203d 2054 7275 650d 0a0d 0a20 2020  x] = True....   
-000263e0: 2020 2020 2020 2020 2023 2063 6f6d 7075           # compu
-000263f0: 7465 2070 726f 6261 730d 0a20 2020 2020  te probas..     
-00026400: 2020 2020 2020 2064 5f73 6f72 7465 6420         d_sorted 
-00026410: 3d20 7b6b 3a20 7620 666f 7220 6b2c 2076  = {k: v for k, v
-00026420: 2069 6e20 736f 7274 6564 2864 5f70 726f   in sorted(d_pro
-00026430: 705f 756e 6974 732e 6974 656d 7328 292c  p_units.items(),
-00026440: 206b 6579 3d6c 616d 6264 6120 6974 656d   key=lambda item
-00026450: 3a20 6974 656d 5b31 5d29 7d0d 0a20 2020  : item[1])}..   
-00026460: 2020 2020 2020 2020 2075 6e69 7473 3d73           units=s
-00026470: 656c 662e 6765 745f 756e 6974 735f 646f  elf.get_units_do
-00026480: 6d61 696e 735f 7265 616c 697a 6174 696f  mains_realizatio
-00026490: 6e73 2861 6c6c 5f64 6174 613d 5472 7565  ns(all_data=True
-000264a0: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-000264b0: 6f74 5f63 656c 6c73 203d 206d 6173 6b5f  ot_cells = mask_
-000264c0: 6465 7074 682e 7375 6d28 290d 0a0d 0a20  depth.sum().... 
-000264d0: 2020 2020 2020 2020 2020 2062 6573 745f             best_
-000264e0: 6d6f 6465 6c20 3d20 6e70 2e7a 6572 6f73  model = np.zeros
-000264f0: 285b 6e7a 2c20 6e79 2c20 6e78 5d2c 2064  ([nz, ny, nx], d
-00026500: 7479 7065 3d6e 702e 696e 7438 290d 0a0d  type=np.int8)...
-00026510: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00026520: 206b 2c76 2069 6e20 645f 736f 7274 6564   k,v in d_sorted
-00026530: 2e69 7465 6d73 2829 3a0d 0a20 2020 2020  .items():..     
-00026540: 2020 2023 2020 2020 2020 2020 2070 7269     #         pri
-00026550: 6e74 286b 290d 0a0d 0a20 2020 2020 2020  nt(k)....       
-00026560: 2020 2020 2020 2020 2023 2063 6f6d 7075           # compu
-00026570: 7465 2070 726f 7020 6f66 2075 6e69 740d  te prop of unit.
-00026580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026590: 2023 6420 3d20 7365 6c66 2e67 6574 5f70   #d = self.get_p
-000265a0: 726f 706f 7274 696f 6e73 2864 6570 7468  roportions(depth
-000265b0: 5f6d 696e 203d 2030 2c20 6465 7074 685f  _min = 0, depth_
-000265c0: 6d61 7820 3d20 6465 7074 6829 0d0a 2020  max = depth)..  
-000265d0: 2020 2020 2020 2020 2020 2020 2020 2376                #v
-000265e0: 203d 2064 5b6b 5d0d 0a0d 0a20 2020 2020   = d[k]....     
-000265f0: 2020 2020 2020 2020 2020 2023 2063 6f6d             # com
-00026600: 7075 7465 2070 726f 6261 2075 6e69 740d  pute proba unit.
-00026610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026620: 2061 7272 3d6e 702e 7a65 726f 7328 5b73   arr=np.zeros([s
-00026630: 656c 662e 6e7a 2c20 7365 6c66 2e6e 792c  elf.nz, self.ny,
-00026640: 2073 656c 662e 6e78 5d29 0d0a 0d0a 2020   self.nx])....  
-00026650: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00026660: 636f 6d70 7574 6520 7072 6f62 6162 696c  compute probabil
-00026670: 6974 6965 730d 0a20 2020 2020 2020 2020  ities..         
-00026680: 2020 2020 2020 2061 7272 202b 3d20 2875         arr += (u
-00026690: 6e69 7473 203d 3d20 7365 6c66 2e67 6574  nits == self.get
-000266a0: 5f75 6e69 7428 6b29 2e49 4429 2e73 756d  _unit(k).ID).sum
-000266b0: 2830 290d 0a20 2020 2020 2020 2020 2020  (0)..           
-000266c0: 2020 2020 2061 7272 202f 3d20 756e 6974       arr /= unit
-000266d0: 732e 7368 6170 655b 305d 0d0a 2020 2020  s.shape[0]..    
-000266e0: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
-000266f0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00026700: 6c6f 6f70 2070 726f 6261 730d 0a20 2020  loop probas..   
-00026710: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00026720: 2069 7620 696e 206e 702e 6172 616e 6765   iv in np.arange
-00026730: 2831 2c20 302c 202d 302e 3031 293a 0d0a  (1, 0, -0.01):..
-00026740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026750: 2020 2020 7072 6f70 203d 2028 6172 725b      prop = (arr[
-00026760: 6d61 736b 5f64 6570 7468 5d20 3e3d 2069  mask_depth] >= i
-00026770: 7629 2e73 756d 2829 202f 206d 6173 6b5f  v).sum() / mask_
-00026780: 6465 7074 682e 7375 6d28 290d 0a20 2020  depth.sum()..   
-00026790: 2020 2020 2023 2020 2020 2020 2020 2020       #          
-000267a0: 2020 2070 7269 6e74 2870 726f 702c 2076     print(prop, v
-000267b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000267c0: 2020 2020 2020 2069 6620 7072 6f70 203e         if prop >
-000267d0: 2076 3a0d 0a20 2020 2020 2020 2020 2020   v:..           
-000267e0: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-000267f0: 616b 0d0a 0d0a 2020 2020 2020 2020 2320  ak....        # 
-00026800: 2020 2020 2020 2020 7072 696e 7428 6e70          print(np
-00026810: 2e72 6f75 6e64 2869 762c 2033 2929 0d0a  .round(iv, 3))..
-00026820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026830: 6d61 736b 5f73 696d 203d 2028 6265 7374  mask_sim = (best
-00026840: 5f6d 6f64 656c 3d3d 3029 2026 2028 6172  _model==0) & (ar
-00026850: 7220 3e3d 2069 7629 0d0a 2020 2020 2020  r >= iv)..      
-00026860: 2020 2020 2020 2020 2020 6265 7374 5f6d            best_m
-00026870: 6f64 656c 5b6d 6173 6b5f 7369 6d5d 203d  odel[mask_sim] =
-00026880: 206d 6173 6b5f 7369 6d5b 6d61 736b 5f73   mask_sim[mask_s
-00026890: 696d 5d2e 6173 7479 7065 2869 6e74 2920  im].astype(int) 
-000268a0: 2a20 7365 6c66 2e67 6574 5f75 6e69 7428  * self.get_unit(
-000268b0: 6b29 2e49 440d 0a20 2020 2020 2020 2020  k).ID..         
-000268c0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000268d0: 2020 2020 2020 2020 2023 746f 745f 6365           #tot_ce
-000268e0: 6c6c 7320 2d3d 206d 6173 6b5f 7369 6d5b  lls -= mask_sim[
-000268f0: 6d61 736b 5f64 6570 7468 5d2e 7375 6d28  mask_depth].sum(
-00026900: 2920 2023 2072 656d 6f76 6520 6174 7472  )  # remove attr
-00026910: 6962 7574 6564 2063 656c 6c73 2066 726f  ibuted cells fro
-00026920: 6d20 746f 7461 6c0d 0a20 2020 2020 2020  m total..       
-00026930: 2020 2020 2020 2020 2023 2075 6e69 7473           # units
-00026940: 5b3a 2c20 6d61 736b 5f73 696d 5d20 3d20  [:, mask_sim] = 
-00026950: 3020 2023 2072 656d 6f76 6520 7369 6d75  0  # remove simu
-00026960: 6c61 7465 6420 756e 6974 7320 0d0a 0d0a  lated units ....
-00026970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026980: 2320 6967 6e5f 756e 2e61 7070 656e 6428  # ign_un.append(
-00026990: 6b29 0d0a 0d0a 2020 2020 2020 2020 2020  k)....          
-000269a0: 2020 6d61 736b 203d 2028 6265 7374 5f6d    mask = (best_m
-000269b0: 6f64 656c 203d 3d20 3029 2026 2028 7365  odel == 0) & (se
-000269c0: 6c66 2e6d 6173 6b29 0d0a 2020 2020 2020  lf.mask)..      
-000269d0: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
-000269e0: 5b6d 6173 6b5d 203d 202d 3939 2020 2320  [mask] = -99  # 
-000269f0: 6e6f 6e20 6669 6c6c 6564 2075 6e69 7473  non filled units
-00026a00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00026a10: 2323 2066 696c 6c20 6c61 7374 2063 656c  ## fill last cel
-00026a20: 6c73 2077 6974 6820 6e65 6172 6573 7420  ls with nearest 
-00026a30: 6e65 6967 6862 6f72 7320 0d0a 2020 2020  neighbors ..    
-00026a40: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
-00026a50: 6c66 2e66 696c 6c5f 4944 2862 6573 745f  lf.fill_ID(best_
-00026a60: 6d6f 6465 6c2c 2049 443d 2d39 3929 0d0a  model, ID=-99)..
-00026a70: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00026a80: 7475 726e 2072 6573 0d0a 0d0a 2020 2020  turn res....    
-00026a90: 2020 2020 656c 6966 206d 6574 686f 6420      elif method 
-00026aa0: 3d3d 2022 6d65 616e 5f73 7572 6673 223a  == "mean_surfs":
-00026ab0: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00026ac0: 2020 2020 2020 2020 2020 2020 6265 7374              best
-00026ad0: 5f6d 6f64 656c 203d 206e 702e 7a65 726f  _model = np.zero
-00026ae0: 7328 5b6e 7a2c 206e 792c 206e 785d 2c20  s([nz, ny, nx], 
-00026af0: 6474 7970 653d 6e70 2e69 6e74 3829 0d0a  dtype=np.int8)..
-00026b00: 0d0a 2020 2020 2020 2020 2020 2020 6465  ..            de
-00026b10: 6620 6675 6e28 7069 6c65 2c20 626f 743d  f fun(pile, bot=
-00026b20: 4e6f 6e65 2c20 6d61 736b 5f75 6e69 743d  None, mask_unit=
-00026b30: 4e6f 6e65 293a 0d0a 0d0a 2020 2020 2020  None):....      
-00026b40: 2020 2020 2020 2020 2020 6966 2070 696c            if pil
-00026b50: 652e 6e61 7475 7265 203d 3d20 2273 7572  e.nature == "sur
-00026b60: 6661 6365 7322 3a0d 0a0d 0a20 2020 2020  faces":....     
-00026b70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00026b80: 6561 6e5f 7375 7266 7320 3d20 5b5d 0d0a  ean_surfs = []..
-00026b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00026ba0: 2020 2020 2020 2320 756e 6974 732c 2067        # units, g
-00026bb0: 6574 206d 6561 6e73 2073 7572 6661 6365  et means surface
-00026bc0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00026bd0: 2020 2020 2020 2066 6f72 2075 6e5f 7020         for un_p 
-00026be0: 696e 2070 696c 652e 6c69 7374 5f75 6e69  in pile.list_uni
-00026bf0: 7473 3a0d 0a20 2020 2020 2020 2020 2020  ts:..           
-00026c00: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-00026c10: 6e5f 7375 7266 732e 6170 7065 6e64 286e  n_surfs.append(n
-00026c20: 702e 6e61 6e6d 6561 6e28 7365 6c66 2e67  p.nanmean(self.g
-00026c30: 6574 5f73 7572 6661 6365 735f 756e 6974  et_surfaces_unit
-00026c40: 2875 6e5f 7029 2c20 3029 290d 0a0d 0a20  (un_p), 0)).... 
-00026c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c60: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00026c70: 6528 6c65 6e28 6d65 616e 5f73 7572 6673  e(len(mean_surfs
-00026c80: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00026c90: 2020 2020 2020 2020 2020 2020 2075 6e20               un 
-00026ca0: 3d20 7069 6c65 2e6c 6973 745f 756e 6974  = pile.list_unit
-00026cb0: 735b 695d 0d0a 2020 2020 2020 2020 2020  s[i]..          
-00026cc0: 2020 2020 2020 2020 2020 2020 2020 7320                s 
-00026cd0: 3d20 6d65 616e 5f73 7572 6673 5b69 5d0d  = mean_surfs[i].
-00026ce0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00026cf0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-00026d00: 3d3d 206c 656e 286d 6561 6e5f 7375 7266  == len(mean_surf
-00026d10: 7329 2d31 3a0d 0a20 2020 2020 2020 2020  s)-1:..         
-00026d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d30: 2020 2073 3220 3d20 626f 740d 0a20 2020     s2 = bot..   
-00026d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00026d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026d70: 2020 2020 2020 2020 7332 203d 206d 6561          s2 = mea
-00026d80: 6e5f 7375 7266 735b 692b 315d 0d0a 0d0a  n_surfs[i+1]....
+00025740: 2020 2050 6920 3d20 2864 6174 6120 3d3d     Pi = (data ==
+00025750: 2066 6163 6965 732e 4944 292e 7375 6d28   facies.ID).sum(
+00025760: 3029 2f6e 7265 616c 0d0a 2020 2020 2020  0)/nreal..      
+00025770: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+00025780: 5f6d 6173 6b20 3d20 2850 6920 213d 2030  _mask = (Pi != 0
+00025790: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000257a0: 2020 2020 2020 2053 455b 7069 5f6d 6173         SE[pi_mas
+000257b0: 6b5d 202b 3d20 5069 5b70 695f 6d61 736b  k] += Pi[pi_mask
+000257c0: 5d20 2a20 286e 702e 6c6f 6728 5069 5b70  ] * (np.log(Pi[p
+000257d0: 695f 6d61 736b 5d29 2f6e 702e 6c6f 6728  i_mask])/np.log(
+000257e0: 6229 290d 0a20 2020 2020 2020 2020 2020  b))..           
+000257f0: 2020 2020 2020 2020 2061 7272 5b73 656c           arr[sel
+00025800: 662e 6d61 736b 5d20 3d2d 2053 450d 0a0d  f.mask] =- SE...
+00025810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025820: 2061 7272 5b7e 7365 6c66 2e6d 6173 6b5d   arr[~self.mask]
+00025830: 3d6e 702e 6e61 6e0d 0a0d 0a20 2020 2020  =np.nan....     
+00025840: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00025850: 4765 6f6c 2e66 6163 6965 735f 656e 7472  Geol.facies_entr
+00025860: 6f70 7920 3d20 6172 720d 0a0d 0a20 2020  opy = arr....   
+00025870: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00025880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025890: 7072 696e 7428 2243 686f 6f73 6520 6265  print("Choose be
+000258a0: 7477 6565 6e20 756e 6974 7320 6f72 2066  tween units or f
+000258b0: 6163 6965 7322 290d 0a0d 0a0d 0a20 2020  acies")......   
+000258c0: 2064 6566 2072 6561 6c69 7a61 7469 6f6e   def realization
+000258d0: 735f 6167 6772 6567 6174 696f 6e28 7365  s_aggregation(se
+000258e0: 6c66 2c20 6d65 7468 6f64 3d22 6261 7369  lf, method="basi
+000258f0: 6322 2c0d 0a20 2020 2020 2020 2020 2020  c",..           
+00025900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025910: 2020 6465 7074 683d 3130 302c 2069 676e    depth=100, ign
+00025920: 6f72 655f 756e 6974 733d 4e6f 6e65 2c0d  ore_units=None,.
+00025930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025940: 2020 2020 2020 2020 2020 2020 2020 756e                un
+00025950: 6974 735f 746f 5f66 696c 6c3d 5b5d 2c0d  its_to_fill=[],.
+00025960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025970: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+00025980: 6974 6572 203d 2035 3029 3a0d 0a20 2020  iter = 50):..   
+00025990: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+000259a0: 2020 2020 2020 2020 4d65 7468 6f64 2074          Method t
+000259b0: 6f20 6167 6772 6567 6174 6520 6d75 6c74  o aggregate mult
+000259c0: 6970 6c65 2041 7263 6850 7920 7265 616c  iple ArchPy real
+000259d0: 697a 6174 696f 6e73 2069 6e74 6f20 6f6e  izations into on
+000259e0: 6520 666f 7220 756e 6974 7320 616e 6420  e for units and 
+000259f0: 6661 6369 6573 2028 544f 2044 4f29 0d0a  facies (TO DO)..
+00025a00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00025a10: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00025a20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00025a30: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+00025a40: 3a20 7374 720d 0a20 2020 2020 2020 2020  : str..         
+00025a50: 2020 206d 6574 686f 6420 746f 2075 7365     method to use
+00025a60: 2074 6f20 6167 6772 6567 6174 6520 7468   to aggregate th
+00025a70: 6520 7265 616c 697a 6174 696f 6e73 0d0a  e realizations..
+00025a80: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00025a90: 6420 6d65 7468 6f64 2061 7265 3a0d 0a0d  d method are:...
+00025aa0: 0a20 2020 2020 2020 2020 2020 202d 2062  .            - b
+00025ab0: 6173 6963 2c20 7265 7475 726e 2061 206d  asic, return a m
+00025ac0: 6f64 656c 2077 6974 6820 7468 6520 6d6f  odel with the mo
+00025ad0: 7374 2070 726f 6261 626c 6520 756e 6974  st probable unit
+00025ae0: 732f 6661 6369 6573 2069 6e20 6561 6368  s/facies in each
+00025af0: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
+00025b00: 2020 2020 2d20 7072 6f62 6173 5f70 726f      - probas_pro
+00025b10: 702c 2072 6574 7572 6e20 6120 6d6f 6465  p, return a mode
+00025b20: 6c20 636f 6e73 7472 7563 7465 6420 7365  l constructed se
+00025b30: 7175 656e 7469 616c 6c79 2062 7920 656e  quentially by en
+00025b40: 7375 7269 6e67 2074 6861 7420 7072 6f70  suring that prop
+00025b50: 6f72 7469 6f6e 7320 6172 6520 7265 7370  ortions are resp
+00025b60: 6563 7465 6420 2861 7420 6265 7374 2e2e  ected (at best..
+00025b70: 2e29 0d0a 2020 2020 2020 2020 2020 2020  .)..            
+00025b80: 2d20 6d65 616e 5f73 7572 6673 2c20 2072  - mean_surfs,  r
+00025b90: 6574 7572 6e20 6120 6d6f 6465 6c20 6372  eturn a model cr
+00025ba0: 6561 7465 6420 6279 206d 6561 6e69 6e67  eated by meaning
+00025bb0: 2074 6865 2073 7572 6661 6365 2065 6c65   the surface ele
+00025bc0: 7661 7469 6f6e 2069 6620 756e 6974 7320  vation if units 
+00025bd0: 7765 7265 2073 696d 756c 6174 6564 2077  were simulated w
+00025be0: 6974 6820 6361 7465 676f 7269 6361 6c20  ith categorical 
+00025bf0: 6d65 7468 6f64 2c20 6261 7369 6320 6d65  method, basic me
+00025c00: 7468 6f64 2069 7320 7573 6564 2066 6f72  thod is used for
+00025c10: 2074 6865 7365 2075 6e69 7473 0d0a 0d0a   these units....
+00025c20: 2020 2020 2020 2020 6465 7074 683a 2066          depth: f
+00025c30: 6c6f 6174 0d0a 2020 2020 2020 2020 2020  loat..          
+00025c40: 2020 7072 6f62 6173 5f70 726f 7020 7061    probas_prop pa
+00025c50: 7261 6d65 7465 722c 206d 6178 696d 756d  rameter, maximum
+00025c60: 2064 6570 7468 206f 6620 696e 7665 7374   depth of invest
+00025c70: 6967 6174 696f 6e20 0d0a 2020 2020 2020  igation ..      
+00025c80: 2020 2020 2020 746f 2063 6f6d 7075 7465        to compute
+00025c90: 2070 726f 6261 7320 616e 6420 7072 6f70   probas and prop
+00025ca0: 6f72 7469 6f6e 732e 200d 0a20 2020 2020  ortions. ..     
+00025cb0: 2020 2020 2020 2053 686f 756c 6420 6265         Should be
+00025cc0: 2061 726f 756e 6420 7468 6520 6d65 6469   around the medi
+00025cd0: 616e 2064 6570 7468 206f 6620 7468 6520  an depth of the 
+00025ce0: 626f 7265 686f 6c65 730d 0a20 2020 2020  boreholes..     
+00025cf0: 2020 2069 676e 6f72 655f 756e 6974 733a     ignore_units:
+00025d00: 206c 6973 740d 0a20 2020 2020 2020 2020   list..         
+00025d10: 2020 2070 726f 6261 735f 7072 6f70 2070     probas_prop p
+00025d20: 6172 616d 6574 6572 2c20 756e 6974 7320  arameter, units 
+00025d30: 6e61 6d65 2074 6f20 6967 6e6f 7265 2e20  name to ignore. 
+00025d40: 0d0a 2020 2020 2020 2020 2020 2020 5468  ..            Th
+00025d50: 6573 6520 756e 6974 7320 7769 6c6c 206e  ese units will n
+00025d60: 6f74 2062 6520 6167 6772 6567 6174 6564  ot be aggregated
+00025d70: 2069 6e20 7468 6520 6669 6e61 6c20 6d6f   in the final mo
+00025d80: 6465 6c2e 0d0a 2020 2020 2020 2020 756e  del...        un
+00025d90: 6974 735f 746f 5f66 696c 6c3a 206c 6973  its_to_fill: lis
+00025da0: 740d 0a20 2020 2020 2020 2020 2020 206d  t..            m
+00025db0: 6561 6e5f 7375 7266 7320 7061 7261 6d65  ean_surfs parame
+00025dc0: 7465 722c 2075 6e69 7473 206e 616d 6520  ter, units name 
+00025dd0: 746f 2066 696c 6c20 7769 7468 204e 4e20  to fill with NN 
+00025de0: 6174 2074 6865 2065 6e64 2e0d 0a20 2020  at the end...   
+00025df0: 2020 2020 2020 2020 2053 686f 756c 6420           Should 
+00025e00: 6e6f 7420 6265 2075 7365 6420 6578 6365  not be used exce
+00025e10: 7074 2074 6f20 6669 6c6c 2074 6865 2074  pt to fill the t
+00025e20: 6f70 2075 6e69 742e 0d0a 0d0a 2020 2020  op unit.....    
+00025e30: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+00025e40: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+00025e50: 2020 2020 2020 3344 206e 6461 7272 6179        3D ndarray
+00025e60: 206f 6620 7369 7a65 2028 6e7a 2c20 6e79   of size (nz, ny
+00025e70: 2c20 6e78 290d 0a20 2020 2020 2020 2022  , nx)..        "
+00025e80: 2222 0d0a 0d0a 2020 2020 2020 2020 6966  ""....        if
+00025e90: 2069 676e 6f72 655f 756e 6974 7320 6973   ignore_units is
+00025ea0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00025eb0: 2020 2020 6967 6e6f 7265 5f75 6e69 7473      ignore_units
+00025ec0: 203d 205b 5d0d 0a0d 0a20 2020 2020 2020   = []....       
+00025ed0: 2069 676e 5f75 6e20 3d20 5b5d 0d0a 2020   ign_un = []..  
+00025ee0: 2020 2020 2020 666f 7220 756e 2069 6e20        for un in 
+00025ef0: 6967 6e6f 7265 5f75 6e69 7473 3a0d 0a20  ignore_units:.. 
+00025f00: 2020 2020 2020 2020 2020 2069 676e 5f75             ign_u
+00025f10: 6e2e 6170 7065 6e64 2875 6e29 0d0a 0d0a  n.append(un)....
+00025f20: 2020 2020 2020 2020 6e7a 203d 2073 656c          nz = sel
+00025f30: 662e 6765 745f 6e7a 2829 0d0a 2020 2020  f.get_nz()..    
+00025f40: 2020 2020 6e79 203d 2073 656c 662e 6765      ny = self.ge
+00025f50: 745f 6e79 2829 0d0a 2020 2020 2020 2020  t_ny()..        
+00025f60: 6e78 203d 2073 656c 662e 6765 745f 6e78  nx = self.get_nx
+00025f70: 2829 0d0a 0d0a 2020 2020 2020 2020 6966  ()....        if
+00025f80: 206d 6574 686f 6420 3d3d 2022 6261 7369   method == "basi
+00025f90: 6322 3a0d 0a20 2020 2020 2020 2020 2020  c":..           
+00025fa0: 200d 0a20 2020 2020 2020 2020 2020 2075   ..            u
+00025fb0: 6e69 7473 203d 2073 656c 662e 6765 745f  nits = self.get_
+00025fc0: 756e 6974 735f 646f 6d61 696e 735f 7265  units_domains_re
+00025fd0: 616c 697a 6174 696f 6e73 2829 0d0a 0d0a  alizations()....
+00025fe0: 2020 2020 2020 2020 2020 2020 6d6f 7374              most
+00025ff0: 5f70 726f 6220 3d20 6e70 2e7a 6572 6f73  _prob = np.zeros
+00026000: 2828 6e7a 2c20 6e79 2c20 6e78 292c 2064  ((nz, ny, nx), d
+00026010: 7479 7065 3d6e 702e 696e 7438 290d 0a0d  type=np.int8)...
+00026020: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00026030: 2069 7a20 696e 2072 616e 6765 2873 656c   iz in range(sel
+00026040: 662e 6765 745f 6e7a 2829 293a 0d0a 2020  f.get_nz()):..  
+00026050: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00026060: 7220 6979 2069 6e20 7261 6e67 6528 7365  r iy in range(se
+00026070: 6c66 2e67 6574 5f6e 7928 2929 3a0d 0a20  lf.get_ny()):.. 
+00026080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026090: 2020 2066 6f72 2069 7820 696e 2072 616e     for ix in ran
+000260a0: 6765 2873 656c 662e 6765 745f 6e78 2829  ge(self.get_nx()
+000260b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000260c0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000260d0: 656c 662e 6d61 736b 5b69 7a2c 2069 792c  elf.mask[iz, iy,
+000260e0: 2069 785d 3a0d 0a20 2020 2020 2020 2020   ix]:..         
+000260f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026100: 2020 206f 6363 203d 206e 702e 6269 6e63     occ = np.binc
+00026110: 6f75 6e74 2875 6e69 7473 5b3a 2c20 697a  ount(units[:, iz
+00026120: 2c20 6979 2c20 6978 5d29 0d0a 2020 2020  , iy, ix])..    
+00026130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026140: 2020 2020 2020 2020 6964 7820 3d20 6e70          idx = np
+00026150: 2e77 6865 7265 286f 6363 3d3d 6d61 7828  .where(occ==max(
+00026160: 6f63 6329 290d 0a20 2020 2020 2020 2020  occ))..         
+00026170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026180: 2020 206d 6f73 745f 7072 6f62 5b69 7a2c     most_prob[iz,
+00026190: 2069 792c 2069 785d 203d 2069 6478 5b30   iy, ix] = idx[0
+000261a0: 5d5b 305d 0d0a 0d0a 2020 2020 2020 2020  ][0]....        
+000261b0: 2020 2020 7265 7475 726e 206d 6f73 745f      return most_
+000261c0: 7072 6f62 0d0a 2020 2020 2020 2020 0d0a  prob..        ..
+000261d0: 2020 2020 2020 2020 656c 6966 206d 6574          elif met
+000261e0: 686f 6420 3d3d 2022 7072 6f62 6173 5f70  hod == "probas_p
+000261f0: 726f 7022 3a0d 0a0d 0a20 2020 2020 2020  rop":....       
+00026200: 2020 2020 2023 2320 7469 7265 7220 6c65       ## tirer le
+00026210: 7320 7072 6f70 6f72 7469 6f6e 7320 6465  s proportions de
+00026220: 2063 6861 7175 6520 756e 6974 730d 0a20   chaque units.. 
+00026230: 2020 2020 2020 2020 2020 2064 5f70 726f             d_pro
+00026240: 705f 756e 6974 7320 3d20 7365 6c66 2e67  p_units = self.g
+00026250: 6574 5f70 726f 706f 7274 696f 6e73 2864  et_proportions(d
+00026260: 6570 7468 5f6d 696e 203d 2030 2c20 6465  epth_min = 0, de
+00026270: 7074 685f 6d61 7820 3d20 6465 7074 682c  pth_max = depth,
+00026280: 2069 676e 6f72 655f 756e 6974 7320 3d20   ignore_units = 
+00026290: 6967 6e5f 756e 290d 0a0d 0a20 2020 2020  ign_un)....     
+000262a0: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+000262b0: 6d61 736b 0d0a 2020 2020 2020 2020 2020  mask..          
+000262c0: 2020 696e 7465 7220 3d20 696e 7428 6465    inter = int(de
+000262d0: 7074 682f 7365 6c66 2e67 6574 5f73 7a28  pth/self.get_sz(
+000262e0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+000262f0: 6d61 736b 5f64 6570 7468 203d 206e 702e  mask_depth = np.
+00026300: 7a65 726f 7328 5b6e 7a2c 206e 792c 206e  zeros([nz, ny, n
+00026310: 785d 2c20 6474 7970 653d 626f 6f6c 290d  x], dtype=bool).
+00026320: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00026330: 2069 7920 696e 2072 616e 6765 286e 7929   iy in range(ny)
+00026340: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00026350: 2020 2066 6f72 2069 7820 696e 2072 616e     for ix in ran
+00026360: 6765 286e 7829 3a0d 0a20 2020 2020 2020  ge(nx):..       
+00026370: 2020 2020 2020 2020 2020 2020 2061 203d               a =
+00026380: 206e 702e 7768 6572 6528 7365 6c66 2e6d   np.where(self.m
+00026390: 6173 6b5b 3a2c 2069 792c 2069 785d 290d  ask[:, iy, ix]).
+000263a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000263b0: 2020 2020 2069 6620 6c65 6e28 615b 305d       if len(a[0]
+000263c0: 2920 3e20 303a 0d0a 0d0a 2020 2020 2020  ) > 0:....      
+000263d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263e0: 2020 7620 3d20 696e 7428 6d61 7828 615b    v = int(max(a[
+000263f0: 305d 2920 2d20 6d69 6e28 615b 305d 2929  0]) - min(a[0]))
+00026400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026410: 2020 2020 2020 2020 2020 6966 2076 203e            if v >
+00026420: 2069 6e74 6572 3a0d 0a20 2020 2020 2020   inter:..       
+00026430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026440: 2020 2020 206d 6173 6b5f 6465 7074 685b       mask_depth[
+00026450: 6d61 7828 615b 305d 292d 696e 7465 723a  max(a[0])-inter:
+00026460: 6d61 7828 615b 305d 292c 2069 792c 2069  max(a[0]), iy, i
+00026470: 785d 203d 2054 7275 650d 0a20 2020 2020  x] = True..     
+00026480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026490: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000264a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000264b0: 2020 2020 2020 6d61 736b 5f64 6570 7468        mask_depth
+000264c0: 5b6d 696e 2861 5b30 5d29 3a6d 6178 2861  [min(a[0]):max(a
+000264d0: 5b30 5d29 2c20 6979 2c20 6978 5d20 3d20  [0]), iy, ix] = 
+000264e0: 5472 7565 0d0a 0d0a 2020 2020 2020 2020  True....        
+000264f0: 2020 2020 2320 636f 6d70 7574 6520 7072      # compute pr
+00026500: 6f62 6173 0d0a 2020 2020 2020 2020 2020  obas..          
+00026510: 2020 645f 736f 7274 6564 203d 207b 6b3a    d_sorted = {k:
+00026520: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
+00026530: 6f72 7465 6428 645f 7072 6f70 5f75 6e69  orted(d_prop_uni
+00026540: 7473 2e69 7465 6d73 2829 2c20 6b65 793d  ts.items(), key=
+00026550: 6c61 6d62 6461 2069 7465 6d3a 2069 7465  lambda item: ite
+00026560: 6d5b 315d 297d 0d0a 2020 2020 2020 2020  m[1])}..        
+00026570: 2020 2020 756e 6974 733d 7365 6c66 2e67      units=self.g
+00026580: 6574 5f75 6e69 7473 5f64 6f6d 6169 6e73  et_units_domains
+00026590: 5f72 6561 6c69 7a61 7469 6f6e 7328 616c  _realizations(al
+000265a0: 6c5f 6461 7461 3d54 7275 6529 0d0a 2020  l_data=True)..  
+000265b0: 2020 2020 2020 2020 2020 746f 745f 6365            tot_ce
+000265c0: 6c6c 7320 3d20 6d61 736b 5f64 6570 7468  lls = mask_depth
+000265d0: 2e73 756d 2829 0d0a 0d0a 2020 2020 2020  .sum()....      
+000265e0: 2020 2020 2020 6265 7374 5f6d 6f64 656c        best_model
+000265f0: 203d 206e 702e 7a65 726f 7328 5b6e 7a2c   = np.zeros([nz,
+00026600: 206e 792c 206e 785d 2c20 6474 7970 653d   ny, nx], dtype=
+00026610: 6e70 2e69 6e74 3829 0d0a 0d0a 2020 2020  np.int8)....    
+00026620: 2020 2020 2020 2020 666f 7220 6b2c 7620          for k,v 
+00026630: 696e 2064 5f73 6f72 7465 642e 6974 656d  in d_sorted.item
+00026640: 7328 293a 0d0a 2020 2020 2020 2020 2320  s():..        # 
+00026650: 2020 2020 2020 2020 7072 696e 7428 6b29          print(k)
+00026660: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00026670: 2020 2020 2320 636f 6d70 7574 6520 7072      # compute pr
+00026680: 6f70 206f 6620 756e 6974 0d0a 2020 2020  op of unit..    
+00026690: 2020 2020 2020 2020 2020 2020 2364 203d              #d =
+000266a0: 2073 656c 662e 6765 745f 7072 6f70 6f72   self.get_propor
+000266b0: 7469 6f6e 7328 6465 7074 685f 6d69 6e20  tions(depth_min 
+000266c0: 3d20 302c 2064 6570 7468 5f6d 6178 203d  = 0, depth_max =
+000266d0: 2064 6570 7468 290d 0a20 2020 2020 2020   depth)..       
+000266e0: 2020 2020 2020 2020 2023 7620 3d20 645b           #v = d[
+000266f0: 6b5d 0d0a 0d0a 2020 2020 2020 2020 2020  k]....          
+00026700: 2020 2020 2020 2320 636f 6d70 7574 6520        # compute 
+00026710: 7072 6f62 6120 756e 6974 0d0a 2020 2020  proba unit..    
+00026720: 2020 2020 2020 2020 2020 2020 6172 723d              arr=
+00026730: 6e70 2e7a 6572 6f73 285b 7365 6c66 2e6e  np.zeros([self.n
+00026740: 7a2c 2073 656c 662e 6e79 2c20 7365 6c66  z, self.ny, self
+00026750: 2e6e 785d 290d 0a0d 0a20 2020 2020 2020  .nx])....       
+00026760: 2020 2020 2020 2020 2023 2063 6f6d 7075           # compu
+00026770: 7465 2070 726f 6261 6269 6c69 7469 6573  te probabilities
+00026780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026790: 2020 6172 7220 2b3d 2028 756e 6974 7320    arr += (units 
+000267a0: 3d3d 2073 656c 662e 6765 745f 756e 6974  == self.get_unit
+000267b0: 286b 292e 4944 292e 7375 6d28 3029 0d0a  (k).ID).sum(0)..
+000267c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000267d0: 6172 7220 2f3d 2075 6e69 7473 2e73 6861  arr /= units.sha
+000267e0: 7065 5b30 5d0d 0a20 2020 2020 2020 2020  pe[0]..         
+000267f0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00026800: 2020 2020 2020 2020 2023 206c 6f6f 7020           # loop 
+00026810: 7072 6f62 6173 0d0a 2020 2020 2020 2020  probas..        
+00026820: 2020 2020 2020 2020 666f 7220 6976 2069          for iv i
+00026830: 6e20 6e70 2e61 7261 6e67 6528 312c 2030  n np.arange(1, 0
+00026840: 2c20 2d30 2e30 3129 3a0d 0a20 2020 2020  , -0.01):..     
+00026850: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00026860: 726f 7020 3d20 2861 7272 5b6d 6173 6b5f  rop = (arr[mask_
+00026870: 6465 7074 685d 203e 3d20 6976 292e 7375  depth] >= iv).su
+00026880: 6d28 2920 2f20 6d61 736b 5f64 6570 7468  m() / mask_depth
+00026890: 2e73 756d 2829 0d0a 2020 2020 2020 2020  .sum()..        
+000268a0: 2320 2020 2020 2020 2020 2020 2020 7072  #             pr
+000268b0: 696e 7428 7072 6f70 2c20 7629 0d0a 2020  int(prop, v)..  
+000268c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268d0: 2020 6966 2070 726f 7020 3e20 763a 0d0a    if prop > v:..
+000268e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268f0: 2020 2020 2020 2020 6272 6561 6b0d 0a0d          break...
+00026900: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
+00026910: 2020 2070 7269 6e74 286e 702e 726f 756e     print(np.roun
+00026920: 6428 6976 2c20 3329 290d 0a20 2020 2020  d(iv, 3))..     
+00026930: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00026940: 7369 6d20 3d20 2862 6573 745f 6d6f 6465  sim = (best_mode
+00026950: 6c3d 3d30 2920 2620 2861 7272 203e 3d20  l==0) & (arr >= 
+00026960: 6976 290d 0a20 2020 2020 2020 2020 2020  iv)..           
+00026970: 2020 2020 2062 6573 745f 6d6f 6465 6c5b       best_model[
+00026980: 6d61 736b 5f73 696d 5d20 3d20 6d61 736b  mask_sim] = mask
+00026990: 5f73 696d 5b6d 6173 6b5f 7369 6d5d 2e61  _sim[mask_sim].a
+000269a0: 7374 7970 6528 696e 7429 202a 2073 656c  stype(int) * sel
+000269b0: 662e 6765 745f 756e 6974 286b 292e 4944  f.get_unit(k).ID
+000269c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000269d0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+000269e0: 2020 2020 2374 6f74 5f63 656c 6c73 202d      #tot_cells -
+000269f0: 3d20 6d61 736b 5f73 696d 5b6d 6173 6b5f  = mask_sim[mask_
+00026a00: 6465 7074 685d 2e73 756d 2829 2020 2320  depth].sum()  # 
+00026a10: 7265 6d6f 7665 2061 7474 7269 6275 7465  remove attribute
+00026a20: 6420 6365 6c6c 7320 6672 6f6d 2074 6f74  d cells from tot
+00026a30: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00026a40: 2020 2020 2320 756e 6974 735b 3a2c 206d      # units[:, m
+00026a50: 6173 6b5f 7369 6d5d 203d 2030 2020 2320  ask_sim] = 0  # 
+00026a60: 7265 6d6f 7665 2073 696d 756c 6174 6564  remove simulated
+00026a70: 2075 6e69 7473 200d 0a0d 0a20 2020 2020   units ....     
+00026a80: 2020 2020 2020 2020 2020 2023 2069 676e             # ign
+00026a90: 5f75 6e2e 6170 7065 6e64 286b 290d 0a0d  _un.append(k)...
+00026aa0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+00026ab0: 6b20 3d20 2862 6573 745f 6d6f 6465 6c20  k = (best_model 
+00026ac0: 3d3d 2030 2920 2620 2873 656c 662e 6d61  == 0) & (self.ma
+00026ad0: 736b 290d 0a20 2020 2020 2020 2020 2020  sk)..           
+00026ae0: 2062 6573 745f 6d6f 6465 6c5b 6d61 736b   best_model[mask
+00026af0: 5d20 3d20 2d39 3920 2023 206e 6f6e 2066  ] = -99  # non f
+00026b00: 696c 6c65 6420 756e 6974 730d 0a0d 0a20  illed units.... 
+00026b10: 2020 2020 2020 2020 2020 2023 2320 6669             ## fi
+00026b20: 6c6c 206c 6173 7420 6365 6c6c 7320 7769  ll last cells wi
+00026b30: 7468 206e 6561 7265 7374 206e 6569 6768  th nearest neigh
+00026b40: 626f 7273 200d 0a20 2020 2020 2020 2020  bors ..         
+00026b50: 2020 2072 6573 203d 2073 656c 662e 6669     res = self.fi
+00026b60: 6c6c 5f49 4428 6265 7374 5f6d 6f64 656c  ll_ID(best_model
+00026b70: 2c20 4944 3d2d 3939 290d 0a0d 0a20 2020  , ID=-99)....   
+00026b80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00026b90: 7265 730d 0a0d 0a20 2020 2020 2020 2065  res....        e
+00026ba0: 6c69 6620 6d65 7468 6f64 203d 3d20 226d  lif method == "m
+00026bb0: 6561 6e5f 7375 7266 7322 3a0d 0a20 2020  ean_surfs":..   
+00026bc0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00026bd0: 2020 2020 2020 2062 6573 745f 6d6f 6465         best_mode
+00026be0: 6c20 3d20 6e70 2e7a 6572 6f73 285b 6e7a  l = np.zeros([nz
+00026bf0: 2c20 6e79 2c20 6e78 5d2c 2064 7479 7065  , ny, nx], dtype
+00026c00: 3d6e 702e 696e 7438 290d 0a0d 0a20 2020  =np.int8)....   
+00026c10: 2020 2020 2020 2020 2064 6566 2066 756e           def fun
+00026c20: 2870 696c 652c 2062 6f74 3d4e 6f6e 652c  (pile, bot=None,
+00026c30: 206d 6173 6b5f 756e 6974 3d4e 6f6e 6529   mask_unit=None)
+00026c40: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00026c50: 2020 2020 2069 6620 7069 6c65 2e6e 6174       if pile.nat
+00026c60: 7572 6520 3d3d 2022 7375 7266 6163 6573  ure == "surfaces
+00026c70: 223a 0d0a 0d0a 2020 2020 2020 2020 2020  ":....          
+00026c80: 2020 2020 2020 2020 2020 6d65 616e 5f73            mean_s
+00026c90: 7572 6673 203d 205b 5d0d 0a0d 0a20 2020  urfs = []....   
+00026ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cb0: 2023 2075 6e69 7473 2c20 6765 7420 6d65   # units, get me
+00026cc0: 616e 7320 7375 7266 6163 6573 0d0a 2020  ans surfaces..  
+00026cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026ce0: 2020 666f 7220 756e 5f70 2069 6e20 7069    for un_p in pi
+00026cf0: 6c65 2e6c 6973 745f 756e 6974 733a 0d0a  le.list_units:..
+00026d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d10: 2020 2020 2020 2020 6d65 616e 5f73 7572          mean_sur
+00026d20: 6673 2e61 7070 656e 6428 6e70 2e6e 616e  fs.append(np.nan
+00026d30: 6d65 616e 2873 656c 662e 6765 745f 7375  mean(self.get_su
+00026d40: 7266 6163 6573 5f75 6e69 7428 756e 5f70  rfaces_unit(un_p
+00026d50: 292c 2030 2929 0d0a 0d0a 2020 2020 2020  ), 0))....      
+00026d60: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00026d70: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00026d80: 286d 6561 6e5f 7375 7266 7329 293a 0d0a  (mean_surfs)):..
 00026d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026da0: 2020 2020 2020 2020 6120 3d20 7365 6c66          a = self
-00026db0: 2e63 6f6d 7075 7465 5f64 6f6d 6169 6e28  .compute_domain(
-00026dc0: 732c 2073 3229 0d0a 2020 2020 2020 2020  s, s2)..        
-00026dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026de0: 6265 7374 5f6d 6f64 656c 5b61 5d20 3d20  best_model[a] = 
-00026df0: 756e 2e49 4420 2a20 7365 6c66 2e6d 6173  un.ID * self.mas
-00026e00: 6b5b 615d 0d0a 0d0a 2020 2020 2020 2020  k[a]....        
-00026e10: 2020 2020 2020 2020 656c 6966 2070 696c          elif pil
-00026e20: 652e 6e61 7475 7265 203d 3d20 2233 645f  e.nature == "3d_
-00026e30: 6361 7465 676f 7269 6361 6c22 3a0d 0a20  categorical":.. 
-00026e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e50: 2020 2069 6473 203d 205b 752e 4944 2066     ids = [u.ID f
-00026e60: 6f72 2075 2069 6e20 7069 6c65 2e6c 6973  or u in pile.lis
-00026e70: 745f 756e 6974 735d 0d0a 0d0a 2020 2020  t_units]....    
-00026e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e90: 685f 6c65 7620 3d20 7069 6c65 2e6c 6973  h_lev = pile.lis
-00026ea0: 745f 756e 6974 735b 305d 2e67 6574 5f68  t_units[0].get_h
-00026eb0: 5f6c 6576 656c 2829 0d0a 0d0a 2020 2020  _level()....    
-00026ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ed0: 756e 6974 7320 3d20 7365 6c66 2e67 6574  units = self.get
-00026ee0: 5f75 6e69 7473 5f64 6f6d 6169 6e73 5f72  _units_domains_r
-00026ef0: 6561 6c69 7a61 7469 6f6e 7328 685f 6c65  ealizations(h_le
-00026f00: 7665 6c3d 685f 6c65 7629 0d0a 2020 2020  vel=h_lev)..    
-00026f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f20: 756e 6974 7320 3d20 756e 6974 735b 3a2c  units = units[:,
-00026f30: 206d 6173 6b5f 756e 6974 5d0d 0a0d 0a20   mask_unit].... 
-00026f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026f50: 2020 206c 203d 205b 5d0d 0a20 2020 2020     l = []..     
-00026f60: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00026f70: 2067 6574 206d 6f73 7420 7072 6f62 6162   get most probab
-00026f80: 6c65 2075 6e69 7473 2062 7920 6365 6c6c  le units by cell
-00026f90: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00026fa0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-00026fb0: 7261 6e67 6528 756e 6974 732e 7368 6170  range(units.shap
-00026fc0: 655b 315d 293a 0d0a 2020 2020 2020 2020  e[1]):..        
-00026fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026fe0: 6120 3d20 6e70 2e62 696e 636f 756e 7428  a = np.bincount(
-00026ff0: 756e 6974 735b 3a2c 2069 5d29 0d0a 2020  units[:, i])..  
-00027000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027010: 2020 2020 2020 6964 7873 3d20 6e70 2e77        idxs= np.w
-00027020: 6865 7265 2861 203d 3d20 6d61 7828 6129  here(a == max(a)
-00027030: 295b 305d 0d0a 0d0a 2020 2020 2020 2020  )[0]....        
-00027040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027050: 6966 206c 656e 2869 6478 7329 3e20 313a  if len(idxs)> 1:
-00027060: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027070: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00027080: 7820 3d20 6e70 2e72 616e 646f 6d2e 6368  x = np.random.ch
-00027090: 6f69 6365 2869 6478 7329 0d0a 2020 2020  oice(idxs)..    
+00026da0: 2020 2020 2020 2020 756e 203d 2070 696c          un = pil
+00026db0: 652e 6c69 7374 5f75 6e69 7473 5b69 5d0d  e.list_units[i].
+00026dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026dd0: 2020 2020 2020 2020 2073 203d 206d 6561           s = mea
+00026de0: 6e5f 7375 7266 735b 695d 0d0a 0d0a 2020  n_surfs[i]....  
+00026df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e00: 2020 2020 2020 6966 2069 203d 3d20 6c65        if i == le
+00026e10: 6e28 6d65 616e 5f73 7572 6673 292d 313a  n(mean_surfs)-1:
+00026e20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026e30: 2020 2020 2020 2020 2020 2020 2020 7332                s2
+00026e40: 203d 2062 6f74 0d0a 2020 2020 2020 2020   = bot..        
+00026e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e60: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00026e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e80: 2020 2073 3220 3d20 6d65 616e 5f73 7572     s2 = mean_sur
+00026e90: 6673 5b69 2b31 5d0d 0a0d 0a20 2020 2020  fs[i+1]....     
+00026ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026eb0: 2020 2061 203d 2073 656c 662e 636f 6d70     a = self.comp
+00026ec0: 7574 655f 646f 6d61 696e 2873 2c20 7332  ute_domain(s, s2
+00026ed0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00026ee0: 2020 2020 2020 2020 2020 2062 6573 745f             best_
+00026ef0: 6d6f 6465 6c5b 615d 203d 2075 6e2e 4944  model[a] = un.ID
+00026f00: 202a 2073 656c 662e 6d61 736b 5b61 5d0d   * self.mask[a].
+00026f10: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00026f20: 2020 2065 6c69 6620 7069 6c65 2e6e 6174     elif pile.nat
+00026f30: 7572 6520 3d3d 2022 3364 5f63 6174 6567  ure == "3d_categ
+00026f40: 6f72 6963 616c 223a 0d0a 2020 2020 2020  orical":..      
+00026f50: 2020 2020 2020 2020 2020 2020 2020 6964                id
+00026f60: 7320 3d20 5b75 2e49 4420 666f 7220 7520  s = [u.ID for u 
+00026f70: 696e 2070 696c 652e 6c69 7374 5f75 6e69  in pile.list_uni
+00026f80: 7473 5d0d 0a0d 0a20 2020 2020 2020 2020  ts]....         
+00026f90: 2020 2020 2020 2020 2020 2068 5f6c 6576             h_lev
+00026fa0: 203d 2070 696c 652e 6c69 7374 5f75 6e69   = pile.list_uni
+00026fb0: 7473 5b30 5d2e 6765 745f 685f 6c65 7665  ts[0].get_h_leve
+00026fc0: 6c28 290d 0a0d 0a20 2020 2020 2020 2020  l()....         
+00026fd0: 2020 2020 2020 2020 2020 2075 6e69 7473             units
+00026fe0: 203d 2073 656c 662e 6765 745f 756e 6974   = self.get_unit
+00026ff0: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
+00027000: 6174 696f 6e73 2868 5f6c 6576 656c 3d68  ations(h_level=h
+00027010: 5f6c 6576 290d 0a20 2020 2020 2020 2020  _lev)..         
+00027020: 2020 2020 2020 2020 2020 2075 6e69 7473             units
+00027030: 203d 2075 6e69 7473 5b3a 2c20 6d61 736b   = units[:, mask
+00027040: 5f75 6e69 745d 0d0a 0d0a 2020 2020 2020  _unit]....      
+00027050: 2020 2020 2020 2020 2020 2020 2020 6c20                l 
+00027060: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+00027070: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00027080: 6d6f 7374 2070 726f 6261 626c 6520 756e  most probable un
+00027090: 6974 7320 6279 2063 656c 6c73 0d0a 2020  its by cells..  
 000270a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270b0: 2020 2020 656c 6966 206c 656e 2869 6478      elif len(idx
-000270c0: 7329 203d 3d20 313a 0d0a 2020 2020 2020  s) == 1:..      
-000270d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270e0: 2020 2020 2020 6964 7820 3d20 6964 7873        idx = idxs
-000270f0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00027100: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00027110: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00027120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027130: 6964 7820 3d20 300d 0a20 2020 2020 2020  idx = 0..       
-00027140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027150: 2020 2020 2070 6173 730d 0a0d 0a20 2020       pass....   
-00027160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027170: 2020 2020 206c 2e61 7070 656e 6428 6964       l.append(id
-00027180: 7829 0d0a 0d0a 2020 2020 2020 2020 2020  x)....          
-00027190: 2020 2020 2020 2020 2020 6c20 3d20 6e70            l = np
-000271a0: 2e61 7272 6179 286c 290d 0a0d 0a20 2020  .array(l)....   
-000271b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000271c0: 2062 6573 745f 6d6f 6465 6c5b 6d61 736b   best_model[mask
-000271d0: 5f75 6e69 745d 203d 206c 2020 2320 6173  _unit] = l  # as
-000271e0: 7369 676e 0d0a 2020 2020 2020 2020 2020  sign..          
-000271f0: 2020 2020 2020 2020 2020 2320 6e65 6172            # near
-00027200: 6573 7420 6e65 6967 6862 6f72 203f 200d  est neighbor ? .
-00027210: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00027220: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00027230: 6528 6c65 6e28 7069 6c65 2e6c 6973 745f  e(len(pile.list_
-00027240: 756e 6974 7329 293a 0d0a 2020 2020 2020  units)):..      
-00027250: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00027260: 5f70 203d 2070 696c 652e 6c69 7374 5f75  _p = pile.list_u
-00027270: 6e69 7473 5b69 5d0d 0a20 2020 2020 2020  nits[i]..       
-00027280: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00027290: 756e 5f70 2e53 7562 5069 6c65 2069 7320  un_p.SubPile is 
-000272a0: 6e6f 7420 4e6f 6e65 3a0d 0a0d 0a20 2020  not None:....   
-000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272c0: 2020 2020 2069 6620 7069 6c65 2e6e 6174       if pile.nat
-000272d0: 7572 6520 3d3d 2022 7375 7266 6163 6522  ure == "surface"
-000272e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000272f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00027300: 6f74 203d 206d 6561 6e5f 7375 7266 735b  ot = mean_surfs[
-00027310: 692b 315d 2020 2320 6765 7420 626f 7474  i+1]  # get bott
-00027320: 6f6d 206f 6620 756e 5f70 0d0a 2020 2020  om of un_p..    
-00027330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027340: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00027350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027360: 2020 2020 2020 2062 6f74 203d 204e 6f6e         bot = Non
-00027370: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00027380: 2020 2020 2020 2020 2020 206d 6173 6b20             mask 
-00027390: 3d20 2862 6573 745f 6d6f 6465 6c20 3d3d  = (best_model ==
-000273a0: 2075 6e5f 702e 4944 290d 0a0d 0a20 2020   un_p.ID)....   
-000273b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273c0: 2020 2020 2066 756e 2875 6e5f 702e 5375       fun(un_p.Su
-000273d0: 6250 696c 652c 2062 6f74 2c20 6d61 736b  bPile, bot, mask
-000273e0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-000273f0: 2066 756e 2873 656c 662e 6765 745f 7069   fun(self.get_pi
-00027400: 6c65 5f6d 6173 7465 7228 292c 2073 656c  le_master(), sel
-00027410: 662e 626f 742c 2073 656c 662e 6d61 736b  f.bot, self.mask
-00027420: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-00027430: 2069 6473 203d 205b 7365 6c66 2e67 6574   ids = [self.get
-00027440: 5f75 6e69 7428 7529 2e49 4420 666f 7220  _unit(u).ID for 
-00027450: 7520 696e 2075 6e69 7473 5f74 6f5f 6669  u in units_to_fi
-00027460: 6c6c 5d0d 0a20 2020 2020 2020 2020 2020  ll]..           
-00027470: 2066 6f72 2069 7620 696e 2069 6473 202b   for iv in ids +
-00027480: 205b 305d 3a0d 0a20 2020 2020 2020 2020   [0]:..         
-00027490: 2020 2020 2020 2062 6573 745f 6d6f 6465         best_mode
-000274a0: 6c5b 2862 6573 745f 6d6f 6465 6c3d 3d69  l[(best_model==i
-000274b0: 7629 2026 2028 7365 6c66 2e6d 6173 6b29  v) & (self.mask)
-000274c0: 5d20 3d20 2d39 390d 0a20 2020 2020 2020  ] = -99..       
-000274d0: 2020 2020 2020 2020 2062 6573 745f 6d6f           best_mo
-000274e0: 6465 6c20 3d20 7365 6c66 2e66 696c 6c5f  del = self.fill_
-000274f0: 4944 2862 6573 745f 6d6f 6465 6c2c 202d  ID(best_model, -
-00027500: 3939 290d 0a0d 0a20 2020 2020 2020 2020  99)....         
-00027510: 2020 2072 6574 7572 6e20 6265 7374 5f6d     return best_m
-00027520: 6f64 656c 0d0a 2020 2020 2020 2020 0d0a  odel..        ..
-00027530: 2020 2020 2020 2020 656c 6966 206d 6574          elif met
-00027540: 686f 6420 3d3d 2022 4d44 535f 6572 726f  hod == "MDS_erro
-00027550: 7273 223a 2020 2320 6120 6469 7363 7574  rs":  # a discut
-00027560: 6572 2061 7665 6320 5068 696c 6970 7065  er avec Philippe
-00027570: 0d0a 2020 2020 2020 2020 2020 2020 0d0a  ..            ..
-00027580: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00027590: 2073 6b6c 6561 726e 2e6d 616e 6966 6f6c   sklearn.manifol
-000275a0: 6420 696d 706f 7274 204d 4453 0d0a 2020  d import MDS..  
-000275b0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000275c0: 2020 2020 2020 2020 2320 6d61 7472 6978          # matrix
-000275d0: 206f 6620 6469 7374 616e 6365 7320 6265   of distances be
-000275e0: 7477 6565 6e20 7369 6d75 6c61 7469 6f6e  tween simulation
-000275f0: 730d 0a20 2020 2020 2020 2020 2020 204d  s..            M
-00027600: 203d 206e 702e 7a65 726f 7328 5b73 656c   = np.zeros([sel
-00027610: 662e 6e72 6561 6c5f 756e 6974 732c 2073  f.nreal_units, s
-00027620: 656c 662e 6e72 6561 6c5f 756e 6974 735d  elf.nreal_units]
-00027630: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00027640: 6f72 2069 7265 616c 2069 6e20 7261 6e67  or ireal in rang
-00027650: 6528 6c65 6e28 7365 6c66 2e47 656f 6c2e  e(len(self.Geol.
-00027660: 756e 6974 735f 646f 6d61 696e 7329 293a  units_domains)):
-00027670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027680: 2020 666f 7220 6f72 6561 6c20 696e 2072    for oreal in r
-00027690: 616e 6765 2869 7265 616c 293a 0d0a 2020  ange(ireal):..  
-000276a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000276b0: 2020 7331 203d 2073 656c 662e 4765 6f6c    s1 = self.Geol
-000276c0: 2e75 6e69 7473 5f64 6f6d 6169 6e73 5b69  .units_domains[i
-000276d0: 7265 616c 5d0d 0a20 2020 2020 2020 2020  real]..         
-000276e0: 2020 2020 2020 2020 2020 2073 3220 3d20             s2 = 
-000276f0: 7365 6c66 2e47 656f 6c2e 756e 6974 735f  self.Geol.units_
-00027700: 646f 6d61 696e 735b 6f72 6561 6c5d 0d0a  domains[oreal]..
-00027710: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027720: 2020 2020 2020 4d5b 6972 6561 6c2c 206f        M[ireal, o
-00027730: 7265 616c 5d20 3d20 6e70 2e73 756d 2873  real] = np.sum(s
-00027740: 3120 213d 2073 3229 0d0a 2020 2020 2020  1 != s2)..      
-00027750: 2020 2020 2020 2020 2020 2020 2020 4d5b                M[
-00027760: 6f72 6561 6c2c 2069 7265 616c 5d20 3d20  oreal, ireal] = 
-00027770: 4d5b 6972 6561 6c2c 206f 7265 616c 5d0d  M[ireal, oreal].
-00027780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027790: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-000277a0: 2020 2023 206d 6473 203d 204d 4453 2872     # mds = MDS(r
-000277b0: 616e 646f 6d5f 7374 6174 653d 4e6f 6e65  andom_state=None
-000277c0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-000277d0: 204d 5f74 7261 6e73 666f 726d 203d 206d   M_transform = m
-000277e0: 6473 2e66 6974 5f74 7261 6e73 666f 726d  ds.fit_transform
-000277f0: 284d 290d 0a20 2020 2020 2020 2020 2020  (M)..           
-00027800: 200d 0a20 2020 2020 2020 2020 2020 2023   ..            #
-00027810: 2066 726f 6d20 736b 6c65 6172 6e2e 636c   from sklearn.cl
-00027820: 7573 7465 7220 696d 706f 7274 206b 5f6d  uster import k_m
-00027830: 6561 6e73 0d0a 0d0a 2020 2020 2020 2020  eans....        
-00027840: 2020 2020 2320 6365 6e74 722c 2063 6f64      # centr, cod
-00027850: 652c 206a 7370 203d 206b 5f6d 6561 6e73  e, jsp = k_means
-00027860: 284d 5f74 7261 6e73 666f 726d 2c20 3129  (M_transform, 1)
-00027870: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00027880: 2320 706c 742e 7363 6174 7465 7228 6365  # plt.scatter(ce
-00027890: 6e74 725b 3a2c 2030 5d2c 2063 656e 7472  ntr[:, 0], centr
-000278a0: 5b3a 2c20 315d 2c20 633d 2272 222c 2073  [:, 1], c="r", s
-000278b0: 3d31 3030 2c20 6d61 726b 6572 3d22 7822  =100, marker="x"
-000278c0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-000278d0: 2023 2070 6c74 2e73 6361 7474 6572 284d   # plt.scatter(M
-000278e0: 5f74 7261 6e73 666f 726d 5b3a 2c20 305d  _transform[:, 0]
-000278f0: 2c20 4d5f 7472 616e 7366 6f72 6d5b 3a2c  , M_transform[:,
-00027900: 2031 5d2c 2063 3d63 6f64 6529 0d0a 0d0a   1], c=code)....
-00027910: 2020 2020 2020 2020 2020 2020 2320 6469              # di
-00027920: 7374 5f73 696d 203d 206e 702e 7371 7274  st_sim = np.sqrt
-00027930: 2828 4d5f 7472 616e 7366 6f72 6d5b 3a2c  ((M_transform[:,
-00027940: 2030 5d20 2d20 6365 6e74 725b 305d 5b30   0] - centr[0][0
-00027950: 5d29 2a2a 3220 2b20 284d 5f74 7261 6e73  ])**2 + (M_trans
-00027960: 666f 726d 5b3a 2c20 315d 202d 2063 656e  form[:, 1] - cen
-00027970: 7472 5b30 5d5b 315d 292a 2a32 290d 0a0d  tr[0][1])**2)...
-00027980: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00027990: 6478 203d 206e 702e 7768 6572 6528 6469  dx = np.where(di
-000279a0: 7374 5f73 696d 3d3d 6d69 6e28 6469 7374  st_sim==min(dist
-000279b0: 5f73 696d 2929 5b30 5d5b 305d 0d0a 2020  _sim))[0][0]..  
-000279c0: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-000279d0: 2020 2020 2020 2020 2320 6c6f 6f70 2074          # loop t
-000279e0: 6f20 6669 6e64 2074 6865 206d 6f73 7420  o find the most 
-000279f0: 7265 7072 6573 656e 7461 7469 7665 2073  representative s
-00027a00: 696d 756c 6174 696f 6e0d 0a20 2020 2020  imulation..     
-00027a10: 2020 2020 2020 206c 203d 205b 5d0d 0a20         l = [].. 
-00027a20: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00027a30: 2069 6e20 7261 6e67 6528 6e5f 6974 6572   in range(n_iter
-00027a40: 293a 0d0a 0d0a 2020 2020 2020 2020 2020  ):....          
-00027a50: 2020 2020 2020 6d64 7320 3d20 4d44 5328        mds = MDS(
-00027a60: 7261 6e64 6f6d 5f73 7461 7465 3d4e 6f6e  random_state=Non
-00027a70: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00027a80: 2020 2020 4d5f 7472 616e 7366 6f72 6d20      M_transform 
-00027a90: 3d20 6d64 732e 6669 745f 7472 616e 7366  = mds.fit_transf
-00027aa0: 6f72 6d28 4d29 0d0a 0d0a 2020 2020 2020  orm(M)....      
-00027ab0: 2020 2020 2020 2020 2020 6672 6f6d 2073            from s
-00027ac0: 6b6c 6561 726e 2e63 6c75 7374 6572 2069  klearn.cluster i
-00027ad0: 6d70 6f72 7420 6b5f 6d65 616e 730d 0a0d  mport k_means...
-00027ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027af0: 2063 656e 7472 2c20 636f 6465 2c20 6a73   centr, code, js
-00027b00: 7020 3d20 6b5f 6d65 616e 7328 4d5f 7472  p = k_means(M_tr
-00027b10: 616e 7366 6f72 6d2c 2031 290d 0a20 2020  ansform, 1)..   
-00027b20: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-00027b30: 745f 7369 6d20 3d20 6e70 2e73 7172 7428  t_sim = np.sqrt(
-00027b40: 284d 5f74 7261 6e73 666f 726d 5b3a 2c20  (M_transform[:, 
-00027b50: 305d 202d 2063 656e 7472 5b30 5d5b 305d  0] - centr[0][0]
-00027b60: 292a 2a32 202b 2028 4d5f 7472 616e 7366  )**2 + (M_transf
-00027b70: 6f72 6d5b 3a2c 2031 5d20 2d20 6365 6e74  orm[:, 1] - cent
-00027b80: 725b 305d 5b31 5d29 2a2a 3229 0d0a 0d0a  r[0][1])**2)....
-00027b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ba0: 6964 7820 3d20 6e70 2e77 6865 7265 2864  idx = np.where(d
-00027bb0: 6973 745f 7369 6d3d 3d6d 696e 2864 6973  ist_sim==min(dis
-00027bc0: 745f 7369 6d29 295b 305d 5b30 5d0d 0a20  t_sim))[0][0].. 
-00027bd0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00027be0: 2e61 7070 656e 6428 6964 7829 0d0a 0d0a  .append(idx)....
-00027bf0: 2020 2020 2020 2020 2020 2020 6c20 3d20              l = 
-00027c00: 6e70 2e61 7272 6179 286c 290d 0a20 2020  np.array(l)..   
-00027c10: 2020 2020 2020 2020 2072 6573 203d 206e           res = n
-00027c20: 702e 6269 6e63 6f75 6e74 286c 290d 0a20  p.bincount(l).. 
-00027c30: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-00027c40: 206e 702e 7768 6572 6528 6e70 2e62 696e   np.where(np.bin
-00027c50: 636f 756e 7428 6c29 203d 3d20 6d61 7828  count(l) == max(
-00027c60: 6e70 2e62 696e 636f 756e 7428 6c29 2929  np.bincount(l)))
-00027c70: 5b30 5d5b 305d 0d0a 2020 2020 2020 2020  [0][0]..        
-00027c80: 2020 2020 6265 7374 5f6d 6f64 656c 203d      best_model =
-00027c90: 2073 656c 662e 4765 6f6c 2e75 6e69 7473   self.Geol.units
-00027ca0: 5f64 6f6d 6169 6e73 5b69 6478 5d0d 0a20  _domains[idx].. 
-00027cb0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00027cc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00027cd0: 6265 7374 5f6d 6f64 656c 0d0a 0d0a 2020  best_model....  
-00027ce0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00027cf0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00027d00: 6865 6c70 2229 0d0a 0d0a 2020 2020 2323  help")....    ##
-00027d10: 2320 706c 6f74 7469 6e67 2023 2323 0d0a  # plotting ###..
-00027d20: 2020 2020 6465 6620 706c 6f74 5f62 6873      def plot_bhs
-00027d30: 2873 656c 662c 206c 6f67 3d22 7374 7261  (self, log="stra
-00027d40: 7469 222c 2070 6c6f 7474 6572 3d4e 6f6e  ti", plotter=Non
-00027d50: 652c 2076 5f65 783d 312c 2070 6c6f 745f  e, v_ex=1, plot_
-00027d60: 746f 703d 4661 6c73 652c 2070 6c6f 745f  top=False, plot_
-00027d70: 626f 743d 4661 6c73 6529 3a0d 0a0d 0a20  bot=False):.... 
-00027d80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00027d90: 2020 2020 506c 6f74 2074 6865 2062 6f72      Plot the bor
-00027da0: 6568 6f6c 6573 206f 6620 7468 6520 4172  eholes of the Ar
-00027db0: 6368 5f74 6162 6c65 2070 726f 6a65 6374  ch_table project
-00027dc0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-00027dd0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00027de0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00027df0: 2020 2020 206c 6f67 3a20 7374 7269 6e67       log: string
-00027e00: 0d0a 2020 2020 2020 2020 2020 2020 7768  ..            wh
-00027e10: 6963 6820 6c6f 6720 746f 2070 6c6f 7420  ich log to plot 
-00027e20: 2d2d 3e20 7374 7261 7469 206f 7220 6661  --> strati or fa
-00027e30: 6369 6573 0d0a 2020 2020 2020 2020 706c  cies..        pl
-00027e40: 6f74 7465 723a 2070 7976 6973 7461 2070  otter: pyvista p
-00027e50: 6c6f 7474 6572 0d0a 2020 2020 2020 2020  lotter..        
-00027e60: 765f 6578 3a20 666c 6f61 740d 0a20 2020  v_ex: float..   
-00027e70: 2020 2020 2020 2020 2076 6572 7469 6361           vertica
-00027e80: 6c20 6578 6167 6765 7261 7469 6f6e 0d0a  l exaggeration..
-00027e90: 2020 2020 2020 2020 706c 6f74 5f74 6f70          plot_top
-00027ea0: 3a20 626f 6f6c 0d0a 2020 2020 2020 2020  : bool..        
-00027eb0: 2020 2020 6966 2074 6865 2074 6f70 206f      if the top o
-00027ec0: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
-00027ed0: 2064 6f6d 6169 6e20 6d75 7374 2062 6520   domain must be 
-00027ee0: 706c 6f74 7465 640d 0a20 2020 2020 2020  plotted..       
-00027ef0: 2070 6c6f 745f 626f 743a 2062 6f6f 6c0d   plot_bot: bool.
-00027f00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00027f10: 7468 6520 626f 7420 6f66 2074 6865 2073  the bot of the s
-00027f20: 696d 756c 6174 696f 6e20 646f 6d61 696e  imulation domain
-00027f30: 206d 7573 7420 6265 2070 6c6f 7474 6564   must be plotted
-00027f40: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-00027f50: 0a0d 0a20 2020 2020 2020 207a 303d 7365  ...        z0=se
-00027f60: 6c66 2e67 6574 5f6f 7a28 290d 0a0d 0a20  lf.get_oz().... 
-00027f70: 2020 2020 2020 2064 6566 206c 696e 6573         def lines
-00027f80: 5f66 726f 6d5f 706f 696e 7473 2870 6f69  _from_points(poi
-00027f90: 6e74 7329 3a0d 0a20 2020 2020 2020 2020  nts):..         
-00027fa0: 2020 2022 2222 4769 7665 6e20 616e 2061     """Given an a
-00027fb0: 7272 6179 206f 6620 706f 696e 7473 2c20  rray of points, 
-00027fc0: 6d61 6b65 2061 206c 696e 6520 7365 7422  make a line set"
-00027fd0: 2222 0d0a 2020 2020 2020 2020 2020 2020  ""..            
-00027fe0: 706f 6c79 3d70 762e 506f 6c79 4461 7461  poly=pv.PolyData
-00027ff0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00028000: 706f 6c79 2e70 6f69 6e74 733d 706f 696e  poly.points=poin
-00028010: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-00028020: 6365 6c6c 733d 6e70 2e66 756c 6c28 286c  cells=np.full((l
-00028030: 656e 2870 6f69 6e74 7329 2d31 2c20 3329  en(points)-1, 3)
-00028040: 2c20 322c 2064 7479 7065 3d6e 702e 696e  , 2, dtype=np.in
-00028050: 745f 290d 0a20 2020 2020 2020 2020 2020  t_)..           
-00028060: 2063 656c 6c73 5b3a 2c20 315d 3d6e 702e   cells[:, 1]=np.
-00028070: 6172 616e 6765 2830 2c20 6c65 6e28 706f  arange(0, len(po
-00028080: 696e 7473 292d 312c 2064 7479 7065 3d6e  ints)-1, dtype=n
-00028090: 702e 696e 745f 290d 0a20 2020 2020 2020  p.int_)..       
-000280a0: 2020 2020 2063 656c 6c73 5b3a 2c20 325d       cells[:, 2]
-000280b0: 3d6e 702e 6172 616e 6765 2831 2c20 6c65  =np.arange(1, le
-000280c0: 6e28 706f 696e 7473 292c 2064 7479 7065  n(points), dtype
-000280d0: 3d6e 702e 696e 745f 290d 0a20 2020 2020  =np.int_)..     
-000280e0: 2020 2020 2020 2070 6f6c 792e 6c69 6e65         poly.line
-000280f0: 733d 6365 6c6c 730d 0a20 2020 2020 2020  s=cells..       
-00028100: 2020 2020 2072 6574 7572 6e20 706f 6c79       return poly
-00028110: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-00028120: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-00028130: 0a20 2020 2020 2020 2020 2020 2070 3d70  .            p=p
-00028140: 762e 506c 6f74 7465 7228 290d 0a20 2020  v.Plotter()..   
-00028150: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00028160: 2020 2020 2020 2020 703d 706c 6f74 7465          p=plotte
-00028170: 720d 0a0d 0a20 2020 2020 2020 206c 5f63  r....        l_c
-00028180: 6f6c 6f72 7320 3d20 5b69 2e63 2066 6f72  olors = [i.c for
-00028190: 2069 2069 6e20 7365 6c66 2e67 6574 5f61   i in self.get_a
-000281a0: 6c6c 5f75 6e69 7473 2829 5d0d 0a0d 0a20  ll_units()].... 
-000281b0: 2020 2020 2020 2077 656c 6c73 203d 2070         wells = p
-000281c0: 762e 4d75 6c74 6942 6c6f 636b 2829 0d0a  v.MultiBlock()..
-000281d0: 2020 2020 2020 2020 4944 7320 3d20 5b5d          IDs = []
-000281e0: 0d0a 0d0a 2020 2020 2020 2020 2320 6465  ....        # de
-000281f0: 6669 6e65 206e 6577 2049 4473 2066 6f72  fine new IDs for
-00028200: 2075 6e69 7473 2061 6e64 2067 6574 2063   units and get c
-00028210: 6f6c 6f72 730d 0a20 2020 2020 2020 2064  olors..        d
-00028220: 203d 207b 7d0d 0a20 2020 2020 2020 2064   = {}..        d
-00028230: 5f63 6f6c 6f72 7320 3d20 7b7d 0d0a 2020  _colors = {}..  
-00028240: 2020 2020 2020 4944 203d 2030 0d0a 2020        ID = 0..  
-00028250: 2020 2020 2020 666f 7220 6268 2069 6e20        for bh in 
-00028260: 7365 6c66 2e6c 6973 745f 6268 733a 0d0a  self.list_bhs:..
-00028270: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-00028280: 682e 6c6f 675f 7374 7261 7469 2069 7320  h.log_strati is 
-00028290: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-000282a0: 2020 2020 2020 2020 2020 2066 6f72 2075             for u
-000282b0: 6e69 7420 696e 2062 682e 6765 745f 6c69  nit in bh.get_li
-000282c0: 7374 5f73 7472 6174 6973 2829 3a0d 0a20  st_stratis():.. 
-000282d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282e0: 2020 2069 6620 756e 6974 2069 7320 6e6f     if unit is no
-000282f0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00028300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028310: 2069 6620 756e 6974 2e49 4420 6e6f 7420   if unit.ID not 
-00028320: 696e 2064 2e6b 6579 7328 293a 0d0a 2020  in d.keys():..  
-00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028340: 2020 2020 2020 2020 2020 645b 756e 6974            d[unit
-00028350: 2e49 445d 203d 2049 440d 0a20 2020 2020  .ID] = ID..     
-00028360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028370: 2020 2020 2020 2064 5f63 6f6c 6f72 735b         d_colors[
-00028380: 4944 5d20 3d20 756e 6974 2e63 0d0a 2020  ID] = unit.c..  
-00028390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283a0: 2020 2020 2020 2020 2020 4944 202b 3d20            ID += 
-000283b0: 310d 0a0d 0a20 2020 2020 2020 2023 2064  1....        # d
-000283c0: 6566 696e 6520 6e65 7720 4944 7320 666f  efine new IDs fo
-000283d0: 7220 6661 6369 6573 2061 6e64 2067 6574  r facies and get
-000283e0: 2063 6f6c 6f72 730d 0a20 2020 2020 2020   colors..       
-000283f0: 2064 5f66 203d 207b 7d0d 0a20 2020 2020   d_f = {}..     
-00028400: 2020 2064 5f63 6f6c 6f72 735f 6620 3d20     d_colors_f = 
-00028410: 7b7d 0d0a 2020 2020 2020 2020 4944 5f66  {}..        ID_f
-00028420: 203d 2030 0d0a 2020 2020 2020 2020 666f   = 0..        fo
-00028430: 7220 6268 2069 6e20 7365 6c66 2e6c 6973  r bh in self.lis
-00028440: 745f 6268 733a 0d0a 2020 2020 2020 2020  t_bhs:..        
-00028450: 2020 2020 6966 2062 682e 6c6f 675f 6661      if bh.log_fa
-00028460: 6369 6573 2069 7320 6e6f 7420 4e6f 6e65  cies is not None
-00028470: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00028480: 2020 2066 6f72 2066 6163 6965 7320 696e     for facies in
-00028490: 2062 682e 6765 745f 6c69 7374 5f66 6163   bh.get_list_fac
-000284a0: 6965 7328 293a 0d0a 2020 2020 2020 2020  ies():..        
-000284b0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-000284c0: 6163 6965 7320 6973 206e 6f74 204e 6f6e  acies is not Non
-000284d0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000284e0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-000284f0: 6163 6965 732e 4944 206e 6f74 2069 6e20  acies.ID not in 
-00028500: 645f 662e 6b65 7973 2829 3a0d 0a20 2020  d_f.keys():..   
-00028510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028520: 2020 2020 2020 2020 2064 5f66 5b66 6163           d_f[fac
-00028530: 6965 732e 4944 5d20 3d20 4944 5f66 0d0a  ies.ID] = ID_f..
-00028540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028550: 2020 2020 2020 2020 2020 2020 645f 636f              d_co
-00028560: 6c6f 7273 5f66 5b49 445f 665d 203d 2066  lors_f[ID_f] = f
-00028570: 6163 6965 732e 630d 0a20 2020 2020 2020  acies.c..       
-00028580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028590: 2020 2020 2049 445f 6620 2b3d 2031 0d0a       ID_f += 1..
-000285a0: 0d0a 2020 2020 2020 2020 6966 206c 6f67  ..        if log
-000285b0: 203d 3d20 2273 7472 6174 6922 3a0d 0a20   == "strati":.. 
-000285c0: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
-000285d0: 6820 696e 2073 656c 662e 6c69 7374 5f62  h in self.list_b
-000285e0: 6873 3a0d 0a20 2020 2020 2020 2020 2020  hs:..           
-000285f0: 2020 2020 2069 6620 6268 2e6c 6f67 5f73       if bh.log_s
-00028600: 7472 6174 6920 6973 206e 6f74 204e 6f6e  trati is not Non
-00028610: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00028620: 2020 2020 2020 2020 636f 6f72 6420 3d20          coord = 
-00028630: 6e70 2e61 7272 6179 285b 6268 2e78 2c20  np.array([bh.x, 
-00028640: 6268 2e79 5d29 0d0a 2020 2020 2020 2020  bh.y])..        
-00028650: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00028660: 6920 696e 2072 616e 6765 286c 656e 2862  i in range(len(b
-00028670: 682e 6c6f 675f 7374 7261 7469 2929 3a0d  h.log_strati)):.
-00028680: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00028690: 2020 2020 2020 2020 2020 2073 743d 6268             st=bh
-000286a0: 2e6c 6f67 5f73 7472 6174 695b 695d 5b30  .log_strati[i][0
-000286b0: 5d20 2023 2075 6e69 7420 6f62 6a65 6374  ]  # unit object
-000286c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000286d0: 2020 2020 2020 2020 2020 6c20 3d20 5b5d            l = []
-000286e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000286f0: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
-00028700: 6e64 2862 682e 6c6f 675f 7374 7261 7469  nd(bh.log_strati
-00028710: 5b69 5d5b 315d 290d 0a20 2020 2020 2020  [i][1])..       
+000270b0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+000270c0: 2875 6e69 7473 2e73 6861 7065 5b31 5d29  (units.shape[1])
+000270d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000270e0: 2020 2020 2020 2020 2020 2061 203d 206e             a = n
+000270f0: 702e 6269 6e63 6f75 6e74 2875 6e69 7473  p.bincount(units
+00027100: 5b3a 2c20 695d 290d 0a20 2020 2020 2020  [:, i])..       
+00027110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027120: 2069 6478 733d 206e 702e 7768 6572 6528   idxs= np.where(
+00027130: 6120 3d3d 206d 6178 2861 2929 5b30 5d0d  a == max(a))[0].
+00027140: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00027150: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00027160: 6e28 6964 7873 293e 2031 3a0d 0a20 2020  n(idxs)> 1:..   
+00027170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027180: 2020 2020 2020 2020 2069 6478 203d 206e           idx = n
+00027190: 702e 7261 6e64 6f6d 2e63 686f 6963 6528  p.random.choice(
+000271a0: 6964 7873 290d 0a20 2020 2020 2020 2020  idxs)..         
+000271b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000271c0: 6c69 6620 6c65 6e28 6964 7873 2920 3d3d  lif len(idxs) ==
+000271d0: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+000271e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000271f0: 2069 6478 203d 2069 6478 735b 305d 0d0a   idx = idxs[0]..
+00027200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027210: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00027220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027230: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+00027240: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+00027250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027260: 7061 7373 0d0a 0d0a 2020 2020 2020 2020  pass....        
+00027270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027280: 6c2e 6170 7065 6e64 2869 6478 290d 0a0d  l.append(idx)...
+00027290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000272a0: 2020 2020 206c 203d 206e 702e 6172 7261       l = np.arra
+000272b0: 7928 6c29 0d0a 0d0a 2020 2020 2020 2020  y(l)....        
+000272c0: 2020 2020 2020 2020 2020 2020 6265 7374              best
+000272d0: 5f6d 6f64 656c 5b6d 6173 6b5f 756e 6974  _model[mask_unit
+000272e0: 5d20 3d20 6c20 2023 2061 7373 6967 6e0d  ] = l  # assign.
+000272f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027300: 2020 2020 2023 206e 6561 7265 7374 206e       # nearest n
+00027310: 6569 6768 626f 7220 3f20 0d0a 0d0a 2020  eighbor ? ....  
+00027320: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00027330: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00027340: 2870 696c 652e 6c69 7374 5f75 6e69 7473  (pile.list_units
+00027350: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00027360: 2020 2020 2020 2020 2075 6e5f 7020 3d20           un_p = 
+00027370: 7069 6c65 2e6c 6973 745f 756e 6974 735b  pile.list_units[
+00027380: 695d 0d0a 2020 2020 2020 2020 2020 2020  i]..            
+00027390: 2020 2020 2020 2020 6966 2075 6e5f 702e          if un_p.
+000273a0: 5375 6250 696c 6520 6973 206e 6f74 204e  SubPile is not N
+000273b0: 6f6e 653a 0d0a 0d0a 2020 2020 2020 2020  one:....        
+000273c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000273d0: 6966 2070 696c 652e 6e61 7475 7265 203d  if pile.nature =
+000273e0: 3d20 2273 7572 6661 6365 223a 0d0a 2020  = "surface":..  
+000273f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027400: 2020 2020 2020 2020 2020 626f 7420 3d20            bot = 
+00027410: 6d65 616e 5f73 7572 6673 5b69 2b31 5d20  mean_surfs[i+1] 
+00027420: 2023 2067 6574 2062 6f74 746f 6d20 6f66   # get bottom of
+00027430: 2075 6e5f 700d 0a20 2020 2020 2020 2020   un_p..         
+00027440: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00027450: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00027460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027470: 2020 626f 7420 3d20 4e6f 6e65 0d0a 2020    bot = None..  
+00027480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027490: 2020 2020 2020 6d61 736b 203d 2028 6265        mask = (be
+000274a0: 7374 5f6d 6f64 656c 203d 3d20 756e 5f70  st_model == un_p
+000274b0: 2e49 4429 0d0a 0d0a 2020 2020 2020 2020  .ID)....        
+000274c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000274d0: 6675 6e28 756e 5f70 2e53 7562 5069 6c65  fun(un_p.SubPile
+000274e0: 2c20 626f 742c 206d 6173 6b29 0d0a 0d0a  , bot, mask)....
+000274f0: 2020 2020 2020 2020 2020 2020 6675 6e28              fun(
+00027500: 7365 6c66 2e67 6574 5f70 696c 655f 6d61  self.get_pile_ma
+00027510: 7374 6572 2829 2c20 7365 6c66 2e62 6f74  ster(), self.bot
+00027520: 2c20 7365 6c66 2e6d 6173 6b29 0d0a 0d0a  , self.mask)....
+00027530: 2020 2020 2020 2020 2020 2020 6964 7320              ids 
+00027540: 3d20 5b73 656c 662e 6765 745f 756e 6974  = [self.get_unit
+00027550: 2875 292e 4944 2066 6f72 2075 2069 6e20  (u).ID for u in 
+00027560: 756e 6974 735f 746f 5f66 696c 6c5d 0d0a  units_to_fill]..
+00027570: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00027580: 6976 2069 6e20 6964 7320 2b20 5b30 5d3a  iv in ids + [0]:
+00027590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000275a0: 2020 6265 7374 5f6d 6f64 656c 5b28 6265    best_model[(be
+000275b0: 7374 5f6d 6f64 656c 3d3d 6976 2920 2620  st_model==iv) & 
+000275c0: 2873 656c 662e 6d61 736b 295d 203d 202d  (self.mask)] = -
+000275d0: 3939 0d0a 2020 2020 2020 2020 2020 2020  99..            
+000275e0: 2020 2020 6265 7374 5f6d 6f64 656c 203d      best_model =
+000275f0: 2073 656c 662e 6669 6c6c 5f49 4428 6265   self.fill_ID(be
+00027600: 7374 5f6d 6f64 656c 2c20 2d39 3929 0d0a  st_model, -99)..
+00027610: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00027620: 7475 726e 2062 6573 745f 6d6f 6465 6c0d  turn best_model.
+00027630: 0a20 2020 2020 2020 200d 0a20 2020 2020  .        ..     
+00027640: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
+00027650: 3d20 224d 4453 5f65 7272 6f72 7322 3a20  = "MDS_errors": 
+00027660: 2023 2061 2064 6973 6375 7465 7220 6176   # a discuter av
+00027670: 6563 2050 6869 6c69 7070 650d 0a20 2020  ec Philippe..   
+00027680: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+00027690: 2020 2020 2020 2066 726f 6d20 736b 6c65         from skle
+000276a0: 6172 6e2e 6d61 6e69 666f 6c64 2069 6d70  arn.manifold imp
+000276b0: 6f72 7420 4d44 530d 0a20 2020 2020 2020  ort MDS..       
+000276c0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+000276d0: 2020 2023 206d 6174 7269 7820 6f66 2064     # matrix of d
+000276e0: 6973 7461 6e63 6573 2062 6574 7765 656e  istances between
+000276f0: 2073 696d 756c 6174 696f 6e73 0d0a 2020   simulations..  
+00027700: 2020 2020 2020 2020 2020 4d20 3d20 6e70            M = np
+00027710: 2e7a 6572 6f73 285b 7365 6c66 2e6e 7265  .zeros([self.nre
+00027720: 616c 5f75 6e69 7473 2c20 7365 6c66 2e6e  al_units, self.n
+00027730: 7265 616c 5f75 6e69 7473 5d29 0d0a 2020  real_units])..  
+00027740: 2020 2020 2020 2020 2020 666f 7220 6972            for ir
+00027750: 6561 6c20 696e 2072 616e 6765 286c 656e  eal in range(len
+00027760: 2873 656c 662e 4765 6f6c 2e75 6e69 7473  (self.Geol.units
+00027770: 5f64 6f6d 6169 6e73 2929 3a0d 0a20 2020  _domains)):..   
+00027780: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00027790: 206f 7265 616c 2069 6e20 7261 6e67 6528   oreal in range(
+000277a0: 6972 6561 6c29 3a0d 0a20 2020 2020 2020  ireal):..       
+000277b0: 2020 2020 2020 2020 2020 2020 2073 3120               s1 
+000277c0: 3d20 7365 6c66 2e47 656f 6c2e 756e 6974  = self.Geol.unit
+000277d0: 735f 646f 6d61 696e 735b 6972 6561 6c5d  s_domains[ireal]
+000277e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000277f0: 2020 2020 2020 7332 203d 2073 656c 662e        s2 = self.
+00027800: 4765 6f6c 2e75 6e69 7473 5f64 6f6d 6169  Geol.units_domai
+00027810: 6e73 5b6f 7265 616c 5d0d 0a0d 0a20 2020  ns[oreal]....   
+00027820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027830: 204d 5b69 7265 616c 2c20 6f72 6561 6c5d   M[ireal, oreal]
+00027840: 203d 206e 702e 7375 6d28 7331 2021 3d20   = np.sum(s1 != 
+00027850: 7332 290d 0a20 2020 2020 2020 2020 2020  s2)..           
+00027860: 2020 2020 2020 2020 204d 5b6f 7265 616c           M[oreal
+00027870: 2c20 6972 6561 6c5d 203d 204d 5b69 7265  , ireal] = M[ire
+00027880: 616c 2c20 6f72 6561 6c5d 0d0a 2020 2020  al, oreal]..    
+00027890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278a0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000278b0: 6d64 7320 3d20 4d44 5328 7261 6e64 6f6d  mds = MDS(random
+000278c0: 5f73 7461 7465 3d4e 6f6e 6529 0d0a 2020  _state=None)..  
+000278d0: 2020 2020 2020 2020 2020 2320 4d5f 7472            # M_tr
+000278e0: 616e 7366 6f72 6d20 3d20 6d64 732e 6669  ansform = mds.fi
+000278f0: 745f 7472 616e 7366 6f72 6d28 4d29 0d0a  t_transform(M)..
+00027900: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+00027910: 2020 2020 2020 2020 2020 2320 6672 6f6d            # from
+00027920: 2073 6b6c 6561 726e 2e63 6c75 7374 6572   sklearn.cluster
+00027930: 2069 6d70 6f72 7420 6b5f 6d65 616e 730d   import k_means.
+00027940: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00027950: 2063 656e 7472 2c20 636f 6465 2c20 6a73   centr, code, js
+00027960: 7020 3d20 6b5f 6d65 616e 7328 4d5f 7472  p = k_means(M_tr
+00027970: 616e 7366 6f72 6d2c 2031 290d 0a20 2020  ansform, 1)..   
+00027980: 2020 2020 2020 2020 2023 2023 2070 6c74           # # plt
+00027990: 2e73 6361 7474 6572 2863 656e 7472 5b3a  .scatter(centr[:
+000279a0: 2c20 305d 2c20 6365 6e74 725b 3a2c 2031  , 0], centr[:, 1
+000279b0: 5d2c 2063 3d22 7222 2c20 733d 3130 302c  ], c="r", s=100,
+000279c0: 206d 6172 6b65 723d 2278 2229 0d0a 2020   marker="x")..  
+000279d0: 2020 2020 2020 2020 2020 2320 2320 706c            # # pl
+000279e0: 742e 7363 6174 7465 7228 4d5f 7472 616e  t.scatter(M_tran
+000279f0: 7366 6f72 6d5b 3a2c 2030 5d2c 204d 5f74  sform[:, 0], M_t
+00027a00: 7261 6e73 666f 726d 5b3a 2c20 315d 2c20  ransform[:, 1], 
+00027a10: 633d 636f 6465 290d 0a0d 0a20 2020 2020  c=code)....     
+00027a20: 2020 2020 2020 2023 2064 6973 745f 7369         # dist_si
+00027a30: 6d20 3d20 6e70 2e73 7172 7428 284d 5f74  m = np.sqrt((M_t
+00027a40: 7261 6e73 666f 726d 5b3a 2c20 305d 202d  ransform[:, 0] -
+00027a50: 2063 656e 7472 5b30 5d5b 305d 292a 2a32   centr[0][0])**2
+00027a60: 202b 2028 4d5f 7472 616e 7366 6f72 6d5b   + (M_transform[
+00027a70: 3a2c 2031 5d20 2d20 6365 6e74 725b 305d  :, 1] - centr[0]
+00027a80: 5b31 5d29 2a2a 3229 0d0a 0d0a 2020 2020  [1])**2)....    
+00027a90: 2020 2020 2020 2020 2320 6964 7820 3d20          # idx = 
+00027aa0: 6e70 2e77 6865 7265 2864 6973 745f 7369  np.where(dist_si
+00027ab0: 6d3d 3d6d 696e 2864 6973 745f 7369 6d29  m==min(dist_sim)
+00027ac0: 295b 305d 5b30 5d0d 0a20 2020 2020 2020  )[0][0]..       
+00027ad0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
+00027ae0: 2020 2023 206c 6f6f 7020 746f 2066 696e     # loop to fin
+00027af0: 6420 7468 6520 6d6f 7374 2072 6570 7265  d the most repre
+00027b00: 7365 6e74 6174 6976 6520 7369 6d75 6c61  sentative simula
+00027b10: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
+00027b20: 2020 6c20 3d20 5b5d 0d0a 2020 2020 2020    l = []..      
+00027b30: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00027b40: 616e 6765 286e 5f69 7465 7229 3a0d 0a0d  ange(n_iter):...
+00027b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027b60: 206d 6473 203d 204d 4453 2872 616e 646f   mds = MDS(rando
+00027b70: 6d5f 7374 6174 653d 4e6f 6e65 290d 0a20  m_state=None).. 
+00027b80: 2020 2020 2020 2020 2020 2020 2020 204d                 M
+00027b90: 5f74 7261 6e73 666f 726d 203d 206d 6473  _transform = mds
+00027ba0: 2e66 6974 5f74 7261 6e73 666f 726d 284d  .fit_transform(M
+00027bb0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00027bc0: 2020 2020 2066 726f 6d20 736b 6c65 6172       from sklear
+00027bd0: 6e2e 636c 7573 7465 7220 696d 706f 7274  n.cluster import
+00027be0: 206b 5f6d 6561 6e73 0d0a 0d0a 2020 2020   k_means....    
+00027bf0: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
+00027c00: 722c 2063 6f64 652c 206a 7370 203d 206b  r, code, jsp = k
+00027c10: 5f6d 6561 6e73 284d 5f74 7261 6e73 666f  _means(M_transfo
+00027c20: 726d 2c20 3129 0d0a 2020 2020 2020 2020  rm, 1)..        
+00027c30: 2020 2020 2020 2020 6469 7374 5f73 696d          dist_sim
+00027c40: 203d 206e 702e 7371 7274 2828 4d5f 7472   = np.sqrt((M_tr
+00027c50: 616e 7366 6f72 6d5b 3a2c 2030 5d20 2d20  ansform[:, 0] - 
+00027c60: 6365 6e74 725b 305d 5b30 5d29 2a2a 3220  centr[0][0])**2 
+00027c70: 2b20 284d 5f74 7261 6e73 666f 726d 5b3a  + (M_transform[:
+00027c80: 2c20 315d 202d 2063 656e 7472 5b30 5d5b  , 1] - centr[0][
+00027c90: 315d 292a 2a32 290d 0a0d 0a20 2020 2020  1])**2)....     
+00027ca0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+00027cb0: 206e 702e 7768 6572 6528 6469 7374 5f73   np.where(dist_s
+00027cc0: 696d 3d3d 6d69 6e28 6469 7374 5f73 696d  im==min(dist_sim
+00027cd0: 2929 5b30 5d5b 305d 0d0a 2020 2020 2020  ))[0][0]..      
+00027ce0: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
+00027cf0: 6e64 2869 6478 290d 0a0d 0a20 2020 2020  nd(idx)....     
+00027d00: 2020 2020 2020 206c 203d 206e 702e 6172         l = np.ar
+00027d10: 7261 7928 6c29 0d0a 2020 2020 2020 2020  ray(l)..        
+00027d20: 2020 2020 7265 7320 3d20 6e70 2e62 696e      res = np.bin
+00027d30: 636f 756e 7428 6c29 0d0a 2020 2020 2020  count(l)..      
+00027d40: 2020 2020 2020 6964 7820 3d20 6e70 2e77        idx = np.w
+00027d50: 6865 7265 286e 702e 6269 6e63 6f75 6e74  here(np.bincount
+00027d60: 286c 2920 3d3d 206d 6178 286e 702e 6269  (l) == max(np.bi
+00027d70: 6e63 6f75 6e74 286c 2929 295b 305d 5b30  ncount(l)))[0][0
+00027d80: 5d0d 0a20 2020 2020 2020 2020 2020 2062  ]..            b
+00027d90: 6573 745f 6d6f 6465 6c20 3d20 7365 6c66  est_model = self
+00027da0: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
+00027db0: 696e 735b 6964 785d 0d0a 2020 2020 2020  ins[idx]..      
+00027dc0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00027dd0: 2020 2020 7265 7475 726e 2062 6573 745f      return best_
+00027de0: 6d6f 6465 6c0d 0a0d 0a20 2020 2020 2020  model....       
+00027df0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00027e00: 2020 2020 7072 696e 7428 2268 656c 7022      print("help"
+00027e10: 290d 0a0d 0a20 2020 2023 2323 2070 6c6f  )....    ### plo
+00027e20: 7474 696e 6720 2323 230d 0a20 2020 2064  tting ###..    d
+00027e30: 6566 2070 6c6f 745f 6268 7328 7365 6c66  ef plot_bhs(self
+00027e40: 2c20 6c6f 673d 2273 7472 6174 6922 2c20  , log="strati", 
+00027e50: 706c 6f74 7465 723d 4e6f 6e65 2c20 765f  plotter=None, v_
+00027e60: 6578 3d31 2c20 706c 6f74 5f74 6f70 3d46  ex=1, plot_top=F
+00027e70: 616c 7365 2c20 706c 6f74 5f62 6f74 3d46  alse, plot_bot=F
+00027e80: 616c 7365 293a 0d0a 0d0a 2020 2020 2020  alse):....      
+00027e90: 2020 2222 220d 0a20 2020 2020 2020 2050    """..        P
+00027ea0: 6c6f 7420 7468 6520 626f 7265 686f 6c65  lot the borehole
+00027eb0: 7320 6f66 2074 6865 2041 7263 685f 7461  s of the Arch_ta
+00027ec0: 626c 6520 7072 6f6a 6563 742e 0d0a 0d0a  ble project.....
+00027ed0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00027ee0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00027ef0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00027f00: 6c6f 673a 2073 7472 696e 670d 0a20 2020  log: string..   
+00027f10: 2020 2020 2020 2020 2077 6869 6368 206c           which l
+00027f20: 6f67 2074 6f20 706c 6f74 202d 2d3e 2073  og to plot --> s
+00027f30: 7472 6174 6920 6f72 2066 6163 6965 730d  trati or facies.
+00027f40: 0a20 2020 2020 2020 2070 6c6f 7474 6572  .        plotter
+00027f50: 3a20 7079 7669 7374 6120 706c 6f74 7465  : pyvista plotte
+00027f60: 720d 0a20 2020 2020 2020 2076 5f65 783a  r..        v_ex:
+00027f70: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+00027f80: 2020 2020 7665 7274 6963 616c 2065 7861      vertical exa
+00027f90: 6767 6572 6174 696f 6e0d 0a20 2020 2020  ggeration..     
+00027fa0: 2020 2070 6c6f 745f 746f 703a 2062 6f6f     plot_top: boo
+00027fb0: 6c0d 0a20 2020 2020 2020 2020 2020 2069  l..            i
+00027fc0: 6620 7468 6520 746f 7020 6f66 2074 6865  f the top of the
+00027fd0: 2073 696d 756c 6174 696f 6e20 646f 6d61   simulation doma
+00027fe0: 696e 206d 7573 7420 6265 2070 6c6f 7474  in must be plott
+00027ff0: 6564 0d0a 2020 2020 2020 2020 706c 6f74  ed..        plot
+00028000: 5f62 6f74 3a20 626f 6f6c 0d0a 2020 2020  _bot: bool..    
+00028010: 2020 2020 2020 2020 6966 2074 6865 2062          if the b
+00028020: 6f74 206f 6620 7468 6520 7369 6d75 6c61  ot of the simula
+00028030: 7469 6f6e 2064 6f6d 6169 6e20 6d75 7374  tion domain must
+00028040: 2062 6520 706c 6f74 7465 640d 0a0d 0a20   be plotted.... 
+00028050: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00028060: 2020 2020 2020 7a30 3d73 656c 662e 6765        z0=self.ge
+00028070: 745f 6f7a 2829 0d0a 0d0a 2020 2020 2020  t_oz()....      
+00028080: 2020 6465 6620 6c69 6e65 735f 6672 6f6d    def lines_from
+00028090: 5f70 6f69 6e74 7328 706f 696e 7473 293a  _points(points):
+000280a0: 0d0a 2020 2020 2020 2020 2020 2020 2222  ..            ""
+000280b0: 2247 6976 656e 2061 6e20 6172 7261 7920  "Given an array 
+000280c0: 6f66 2070 6f69 6e74 732c 206d 616b 6520  of points, make 
+000280d0: 6120 6c69 6e65 2073 6574 2222 220d 0a20  a line set""".. 
+000280e0: 2020 2020 2020 2020 2020 2070 6f6c 793d             poly=
+000280f0: 7076 2e50 6f6c 7944 6174 6128 290d 0a20  pv.PolyData().. 
+00028100: 2020 2020 2020 2020 2020 2070 6f6c 792e             poly.
+00028110: 706f 696e 7473 3d70 6f69 6e74 730d 0a20  points=points.. 
+00028120: 2020 2020 2020 2020 2020 2063 656c 6c73             cells
+00028130: 3d6e 702e 6675 6c6c 2828 6c65 6e28 706f  =np.full((len(po
+00028140: 696e 7473 292d 312c 2033 292c 2032 2c20  ints)-1, 3), 2, 
+00028150: 6474 7970 653d 6e70 2e69 6e74 5f29 0d0a  dtype=np.int_)..
+00028160: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+00028170: 735b 3a2c 2031 5d3d 6e70 2e61 7261 6e67  s[:, 1]=np.arang
+00028180: 6528 302c 206c 656e 2870 6f69 6e74 7329  e(0, len(points)
+00028190: 2d31 2c20 6474 7970 653d 6e70 2e69 6e74  -1, dtype=np.int
+000281a0: 5f29 0d0a 2020 2020 2020 2020 2020 2020  _)..            
+000281b0: 6365 6c6c 735b 3a2c 2032 5d3d 6e70 2e61  cells[:, 2]=np.a
+000281c0: 7261 6e67 6528 312c 206c 656e 2870 6f69  range(1, len(poi
+000281d0: 6e74 7329 2c20 6474 7970 653d 6e70 2e69  nts), dtype=np.i
+000281e0: 6e74 5f29 0d0a 2020 2020 2020 2020 2020  nt_)..          
+000281f0: 2020 706f 6c79 2e6c 696e 6573 3d63 656c    poly.lines=cel
+00028200: 6c73 0d0a 2020 2020 2020 2020 2020 2020  ls..            
+00028210: 7265 7475 726e 2070 6f6c 790d 0a0d 0a20  return poly.... 
+00028220: 2020 2020 2020 2069 6620 706c 6f74 7465         if plotte
+00028230: 7220 6973 204e 6f6e 653a 0d0a 2020 2020  r is None:..    
+00028240: 2020 2020 2020 2020 703d 7076 2e50 6c6f          p=pv.Plo
+00028250: 7474 6572 2829 0d0a 2020 2020 2020 2020  tter()..        
+00028260: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00028270: 2020 2070 3d70 6c6f 7474 6572 0d0a 0d0a     p=plotter....
+00028280: 2020 2020 2020 2020 6c5f 636f 6c6f 7273          l_colors
+00028290: 203d 205b 692e 6320 666f 7220 6920 696e   = [i.c for i in
+000282a0: 2073 656c 662e 6765 745f 616c 6c5f 756e   self.get_all_un
+000282b0: 6974 7328 295d 0d0a 0d0a 2020 2020 2020  its()]....      
+000282c0: 2020 7765 6c6c 7320 3d20 7076 2e4d 756c    wells = pv.Mul
+000282d0: 7469 426c 6f63 6b28 290d 0a20 2020 2020  tiBlock()..     
+000282e0: 2020 2049 4473 203d 205b 5d0d 0a0d 0a20     IDs = [].... 
+000282f0: 2020 2020 2020 2023 2064 6566 696e 6520         # define 
+00028300: 6e65 7720 4944 7320 666f 7220 756e 6974  new IDs for unit
+00028310: 7320 616e 6420 6765 7420 636f 6c6f 7273  s and get colors
+00028320: 0d0a 2020 2020 2020 2020 6420 3d20 7b7d  ..        d = {}
+00028330: 0d0a 2020 2020 2020 2020 645f 636f 6c6f  ..        d_colo
+00028340: 7273 203d 207b 7d0d 0a20 2020 2020 2020  rs = {}..       
+00028350: 2049 4420 3d20 300d 0a20 2020 2020 2020   ID = 0..       
+00028360: 2066 6f72 2062 6820 696e 2073 656c 662e   for bh in self.
+00028370: 6c69 7374 5f62 6873 3a0d 0a20 2020 2020  list_bhs:..     
+00028380: 2020 2020 2020 2069 6620 6268 2e6c 6f67         if bh.log
+00028390: 5f73 7472 6174 6920 6973 206e 6f74 204e  _strati is not N
+000283a0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+000283b0: 2020 2020 2020 666f 7220 756e 6974 2069        for unit i
+000283c0: 6e20 6268 2e67 6574 5f6c 6973 745f 7374  n bh.get_list_st
+000283d0: 7261 7469 7328 293a 0d0a 2020 2020 2020  ratis():..      
+000283e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000283f0: 2075 6e69 7420 6973 206e 6f74 204e 6f6e   unit is not Non
+00028400: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00028410: 2020 2020 2020 2020 2020 2020 6966 2075              if u
+00028420: 6e69 742e 4944 206e 6f74 2069 6e20 642e  nit.ID not in d.
+00028430: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+00028440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028450: 2020 2020 2064 5b75 6e69 742e 4944 5d20       d[unit.ID] 
+00028460: 3d20 4944 0d0a 2020 2020 2020 2020 2020  = ID..          
+00028470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028480: 2020 645f 636f 6c6f 7273 5b49 445d 203d    d_colors[ID] =
+00028490: 2075 6e69 742e 630d 0a20 2020 2020 2020   unit.c..       
+000284a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284b0: 2020 2020 2049 4420 2b3d 2031 0d0a 0d0a       ID += 1....
+000284c0: 2020 2020 2020 2020 2320 6465 6669 6e65          # define
+000284d0: 206e 6577 2049 4473 2066 6f72 2066 6163   new IDs for fac
+000284e0: 6965 7320 616e 6420 6765 7420 636f 6c6f  ies and get colo
+000284f0: 7273 0d0a 2020 2020 2020 2020 645f 6620  rs..        d_f 
+00028500: 3d20 7b7d 0d0a 2020 2020 2020 2020 645f  = {}..        d_
+00028510: 636f 6c6f 7273 5f66 203d 207b 7d0d 0a20  colors_f = {}.. 
+00028520: 2020 2020 2020 2049 445f 6620 3d20 300d         ID_f = 0.
+00028530: 0a20 2020 2020 2020 2066 6f72 2062 6820  .        for bh 
+00028540: 696e 2073 656c 662e 6c69 7374 5f62 6873  in self.list_bhs
+00028550: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00028560: 6620 6268 2e6c 6f67 5f66 6163 6965 7320  f bh.log_facies 
+00028570: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+00028580: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00028590: 7220 6661 6369 6573 2069 6e20 6268 2e67  r facies in bh.g
+000285a0: 6574 5f6c 6973 745f 6661 6369 6573 2829  et_list_facies()
+000285b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000285c0: 2020 2020 2020 2069 6620 6661 6369 6573         if facies
+000285d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+000285e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000285f0: 2020 2020 2020 2069 6620 6661 6369 6573         if facies
+00028600: 2e49 4420 6e6f 7420 696e 2064 5f66 2e6b  .ID not in d_f.k
+00028610: 6579 7328 293a 0d0a 2020 2020 2020 2020  eys():..        
+00028620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028630: 2020 2020 645f 665b 6661 6369 6573 2e49      d_f[facies.I
+00028640: 445d 203d 2049 445f 660d 0a20 2020 2020  D] = ID_f..     
+00028650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028660: 2020 2020 2020 2064 5f63 6f6c 6f72 735f         d_colors_
+00028670: 665b 4944 5f66 5d20 3d20 6661 6369 6573  f[ID_f] = facies
+00028680: 2e63 0d0a 2020 2020 2020 2020 2020 2020  .c..            
+00028690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286a0: 4944 5f66 202b 3d20 310d 0a0d 0a20 2020  ID_f += 1....   
+000286b0: 2020 2020 2069 6620 6c6f 6720 3d3d 2022       if log == "
+000286c0: 7374 7261 7469 223a 0d0a 2020 2020 2020  strati":..      
+000286d0: 2020 2020 2020 666f 7220 6268 2069 6e20        for bh in 
+000286e0: 7365 6c66 2e6c 6973 745f 6268 733a 0d0a  self.list_bhs:..
+000286f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028700: 6966 2062 682e 6c6f 675f 7374 7261 7469  if bh.log_strati
+00028710: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
 00028720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028730: 2069 6620 6920 3c20 6c65 6e28 6268 2e6c   if i < len(bh.l
-00028740: 6f67 5f73 7472 6174 6929 2d31 3a0d 0a20  og_strati)-1:.. 
-00028750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028760: 2020 2020 2020 2020 2020 206c 2e61 7070             l.app
-00028770: 656e 6428 6268 2e6c 6f67 5f73 7472 6174  end(bh.log_strat
-00028780: 695b 692b 315d 5b31 5d29 0d0a 0d0a 2020  i[i+1][1])....  
+00028730: 2020 2063 6f6f 7264 203d 206e 702e 6172     coord = np.ar
+00028740: 7261 7928 5b62 682e 782c 2062 682e 795d  ray([bh.x, bh.y]
+00028750: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00028760: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00028770: 7261 6e67 6528 6c65 6e28 6268 2e6c 6f67  range(len(bh.log
+00028780: 5f73 7472 6174 6929 293a 0d0a 0d0a 2020  _strati)):....  
 00028790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287a0: 2020 2020 2020 656c 6966 2069 203d 3d20        elif i == 
-000287b0: 6c65 6e28 6268 2e6c 6f67 5f73 7472 6174  len(bh.log_strat
-000287c0: 6929 2d31 3a0d 0a20 2020 2020 2020 2020  i)-1:..         
+000287a0: 2020 2020 2020 7374 3d62 682e 6c6f 675f        st=bh.log_
+000287b0: 7374 7261 7469 5b69 5d5b 305d 2020 2320  strati[i][0]  # 
+000287c0: 756e 6974 206f 626a 6563 740d 0a20 2020  unit object..   
 000287d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287e0: 2020 206c 2e61 7070 656e 6428 6268 2e7a     l.append(bh.z
-000287f0: 2d62 682e 6465 7074 6829 0d0a 2020 2020  -bh.depth)..    
-00028800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028810: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028820: 2020 2020 2020 2020 2020 6120 3d20 2863            a = (c
-00028830: 6f6f 7264 5b30 5d2c 2063 6f6f 7264 5b31  oord[0], coord[1
-00028840: 5d2c 2028 6c5b 305d 202d 207a 3029 202a  ], (l[0] - z0) *
-00028850: 2076 5f65 7820 2b20 7a30 290d 0a20 2020   v_ex + z0)..   
+000287e0: 2020 2020 206c 203d 205b 5d0d 0a20 2020       l = []..   
+000287f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028800: 2020 2020 206c 2e61 7070 656e 6428 6268       l.append(bh
+00028810: 2e6c 6f67 5f73 7472 6174 695b 695d 5b31  .log_strati[i][1
+00028820: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00028830: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00028840: 203c 206c 656e 2862 682e 6c6f 675f 7374   < len(bh.log_st
+00028850: 7261 7469 292d 313a 0d0a 2020 2020 2020  rati)-1:..      
 00028860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028870: 2020 2020 2062 203d 2028 636f 6f72 645b       b = (coord[
-00028880: 305d 2c20 636f 6f72 645b 315d 2c20 286c  0], coord[1], (l
-00028890: 5b31 5d20 2d20 7a30 2920 2a20 765f 6578  [1] - z0) * v_ex
-000288a0: 202b 207a 3029 0d0a 2020 2020 2020 2020   + z0)..        
-000288b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288c0: 6c69 6e65 203d 2070 762e 4c69 6e65 2861  line = pv.Line(a
-000288d0: 2c20 6229 0d0a 2020 2020 2020 2020 2020  , b)..          
-000288e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000288f0: 2073 7420 6973 206e 6f74 204e 6f6e 653a   st is not None:
-00028900: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028910: 2020 2020 2020 2020 2020 2020 2020 7765                we
-00028920: 6c6c 732e 6170 7065 6e64 286c 696e 6529  lls.append(line)
-00028930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028940: 2020 2020 2020 2020 2020 2020 2020 4944                ID
-00028950: 732e 6170 7065 6e64 2864 5b73 742e 4944  s.append(d[st.ID
-00028960: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00028970: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00028980: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00028990: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-000289a0: 7265 616b 0d0a 2020 2020 2020 2020 2020  reak..          
-000289b0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-000289c0: 7765 6c6c 7320 3d20 7765 6c6c 732e 636f  wells = wells.co
-000289d0: 6d62 696e 6528 2920 2020 0d0a 2020 2020  mbine()   ..    
-000289e0: 2020 2020 2020 2020 702e 6164 645f 6d65          p.add_me
-000289f0: 7368 2877 656c 6c73 2c20 7265 6e64 6572  sh(wells, render
-00028a00: 5f6c 696e 6573 5f61 735f 7475 6265 733d  _lines_as_tubes=
-00028a10: 5472 7565 2c20 6c69 6e65 5f77 6964 7468  True, line_width
-00028a20: 3d31 352c 2073 6361 6c61 7273 3d49 4473  =15, scalars=IDs
-00028a30: 2c20 636d 6170 3d6c 6973 7428 645f 636f  , cmap=list(d_co
-00028a40: 6c6f 7273 2e76 616c 7565 7328 2929 2c20  lors.values()), 
-00028a50: 7368 6f77 5f73 6361 6c61 725f 6261 723d  show_scalar_bar=
-00028a60: 4661 6c73 6529 0d0a 0d0a 2020 2020 2020  False)....      
-00028a70: 2020 656c 6966 206c 6f67 203d 3d20 2266    elif log == "f
-00028a80: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-00028a90: 2020 2020 2066 6f72 2062 6820 696e 2073       for bh in s
-00028aa0: 656c 662e 6c69 7374 5f62 6873 3a0d 0a20  elf.list_bhs:.. 
-00028ab0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00028ac0: 6620 6268 2e6c 6f67 5f66 6163 6965 7320  f bh.log_facies 
-00028ad0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00028ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028af0: 2020 636f 6f72 6420 3d20 6e70 2e61 7272    coord = np.arr
-00028b00: 6179 285b 6268 2e78 2c20 6268 2e79 5d29  ay([bh.x, bh.y])
-00028b10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00028b20: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00028b30: 616e 6765 286c 656e 2862 682e 6c6f 675f  ange(len(bh.log_
-00028b40: 6661 6369 6573 2929 3a0d 0a0d 0a20 2020  facies)):....   
-00028b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b60: 2020 2020 2073 743d 6268 2e6c 6f67 5f66       st=bh.log_f
-00028b70: 6163 6965 735b 695d 5b30 5d20 2023 2066  acies[i][0]  # f
-00028b80: 6163 6965 7320 6f62 6a65 6374 0d0a 2020  acies object..  
-00028b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ba0: 2020 2020 2020 6c20 3d20 5b5d 0d0a 2020        l = []..  
-00028bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bc0: 2020 2020 2020 6c2e 6170 7065 6e64 2862        l.append(b
-00028bd0: 682e 6c6f 675f 6661 6369 6573 5b69 5d5b  h.log_facies[i][
-00028be0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00028bf0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00028c00: 6920 3c20 6c65 6e28 6268 2e6c 6f67 5f66  i < len(bh.log_f
-00028c10: 6163 6965 7329 2d31 3a0d 0a20 2020 2020  acies)-1:..     
+00028870: 2020 2020 2020 6c2e 6170 7065 6e64 2862        l.append(b
+00028880: 682e 6c6f 675f 7374 7261 7469 5b69 2b31  h.log_strati[i+1
+00028890: 5d5b 315d 290d 0a0d 0a20 2020 2020 2020  ][1])....       
+000288a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000288b0: 2065 6c69 6620 6920 3d3d 206c 656e 2862   elif i == len(b
+000288c0: 682e 6c6f 675f 7374 7261 7469 292d 313a  h.log_strati)-1:
+000288d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000288e0: 2020 2020 2020 2020 2020 2020 2020 6c2e                l.
+000288f0: 6170 7065 6e64 2862 682e 7a2d 6268 2e64  append(bh.z-bh.d
+00028900: 6570 7468 290d 0a20 2020 2020 2020 2020  epth)..         
+00028910: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+00028920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028930: 2020 2020 2061 203d 2028 636f 6f72 645b       a = (coord[
+00028940: 305d 2c20 636f 6f72 645b 315d 2c20 286c  0], coord[1], (l
+00028950: 5b30 5d20 2d20 7a30 2920 2a20 765f 6578  [0] - z0) * v_ex
+00028960: 202b 207a 3029 0d0a 2020 2020 2020 2020   + z0)..        
+00028970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028980: 6220 3d20 2863 6f6f 7264 5b30 5d2c 2063  b = (coord[0], c
+00028990: 6f6f 7264 5b31 5d2c 2028 6c5b 315d 202d  oord[1], (l[1] -
+000289a0: 207a 3029 202a 2076 5f65 7820 2b20 7a30   z0) * v_ex + z0
+000289b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000289c0: 2020 2020 2020 2020 2020 206c 696e 6520             line 
+000289d0: 3d20 7076 2e4c 696e 6528 612c 2062 290d  = pv.Line(a, b).
+000289e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000289f0: 2020 2020 2020 2020 2069 6620 7374 2069           if st i
+00028a00: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+00028a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a20: 2020 2020 2020 2020 2077 656c 6c73 2e61           wells.a
+00028a30: 7070 656e 6428 6c69 6e65 290d 0a20 2020  ppend(line)..   
+00028a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a50: 2020 2020 2020 2020 2049 4473 2e61 7070           IDs.app
+00028a60: 656e 6428 645b 7374 2e49 445d 290d 0a20  end(d[st.ID]).. 
+00028a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a80: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00028a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028aa0: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
+00028ab0: 0a20 2020 2020 2020 2020 2020 200d 0a20  .            .. 
+00028ac0: 2020 2020 2020 2020 2020 2077 656c 6c73             wells
+00028ad0: 203d 2077 656c 6c73 2e63 6f6d 6269 6e65   = wells.combine
+00028ae0: 2829 2020 200d 0a20 2020 2020 2020 2020  ()   ..         
+00028af0: 2020 2070 2e61 6464 5f6d 6573 6828 7765     p.add_mesh(we
+00028b00: 6c6c 732c 2072 656e 6465 725f 6c69 6e65  lls, render_line
+00028b10: 735f 6173 5f74 7562 6573 3d54 7275 652c  s_as_tubes=True,
+00028b20: 206c 696e 655f 7769 6474 683d 3135 2c20   line_width=15, 
+00028b30: 7363 616c 6172 733d 4944 732c 2063 6d61  scalars=IDs, cma
+00028b40: 703d 6c69 7374 2864 5f63 6f6c 6f72 732e  p=list(d_colors.
+00028b50: 7661 6c75 6573 2829 292c 2073 686f 775f  values()), show_
+00028b60: 7363 616c 6172 5f62 6172 3d46 616c 7365  scalar_bar=False
+00028b70: 290d 0a0d 0a20 2020 2020 2020 2065 6c69  )....        eli
+00028b80: 6620 6c6f 6720 3d3d 2022 6661 6369 6573  f log == "facies
+00028b90: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+00028ba0: 666f 7220 6268 2069 6e20 7365 6c66 2e6c  for bh in self.l
+00028bb0: 6973 745f 6268 733a 0d0a 2020 2020 2020  ist_bhs:..      
+00028bc0: 2020 2020 2020 2020 2020 6966 2062 682e            if bh.
+00028bd0: 6c6f 675f 6661 6369 6573 2069 7320 6e6f  log_facies is no
+00028be0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00028bf0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00028c00: 7264 203d 206e 702e 6172 7261 7928 5b62  rd = np.array([b
+00028c10: 682e 782c 2062 682e 795d 290d 0a20 2020  h.x, bh.y])..   
 00028c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c30: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
-00028c40: 6268 2e6c 6f67 5f66 6163 6965 735b 692b  bh.log_facies[i+
-00028c50: 315d 5b31 5d29 0d0a 0d0a 2020 2020 2020  1][1])....      
+00028c30: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00028c40: 6c65 6e28 6268 2e6c 6f67 5f66 6163 6965  len(bh.log_facie
+00028c50: 7329 293a 0d0a 0d0a 2020 2020 2020 2020  s)):....        
 00028c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c70: 2020 656c 6966 2069 203d 3d20 6c65 6e28    elif i == len(
-00028c80: 6268 2e6c 6f67 5f66 6163 6965 7329 2d31  bh.log_facies)-1
-00028c90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00028ca0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00028cb0: 2e61 7070 656e 6428 6268 2e7a 2d62 682e  .append(bh.z-bh.
-00028cc0: 6465 7074 6829 0d0a 0d0a 2020 2020 2020  depth)....      
-00028cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ce0: 2020 6120 3d20 2863 6f6f 7264 5b30 5d2c    a = (coord[0],
-00028cf0: 2063 6f6f 7264 5b31 5d2c 2028 6c5b 305d   coord[1], (l[0]
-00028d00: 202d 207a 3029 202a 2076 5f65 7820 2b20   - z0) * v_ex + 
-00028d10: 7a30 290d 0a20 2020 2020 2020 2020 2020  z0)..           
-00028d20: 2020 2020 2020 2020 2020 2020 2062 203d               b =
-00028d30: 2028 636f 6f72 645b 305d 2c20 636f 6f72   (coord[0], coor
-00028d40: 645b 315d 2c20 286c 5b31 5d20 2d20 7a30  d[1], (l[1] - z0
-00028d50: 2920 2a20 765f 6578 202b 207a 3029 0d0a  ) * v_ex + z0)..
-00028d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d70: 2020 2020 2020 2020 6c69 6e65 203d 2070          line = p
-00028d80: 762e 4c69 6e65 2861 2c20 6229 0d0a 2020  v.Line(a, b)..  
-00028d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028da0: 2020 2020 2020 6966 2073 7420 6973 206e        if st is n
-00028db0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-00028dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028dd0: 2020 2020 2020 7765 6c6c 732e 6170 7065        wells.appe
-00028de0: 6e64 286c 696e 6529 0d0a 2020 2020 2020  nd(line)..      
-00028df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e00: 2020 2020 2020 4944 732e 6170 7065 6e64        IDs.append
-00028e10: 2864 5f66 5b73 742e 4944 5d29 0d0a 2020  (d_f[st.ID])..  
+00028c70: 7374 3d62 682e 6c6f 675f 6661 6369 6573  st=bh.log_facies
+00028c80: 5b69 5d5b 305d 2020 2320 6661 6369 6573  [i][0]  # facies
+00028c90: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00028ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028cb0: 206c 203d 205b 5d0d 0a20 2020 2020 2020   l = []..       
+00028cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028cd0: 206c 2e61 7070 656e 6428 6268 2e6c 6f67   l.append(bh.log
+00028ce0: 5f66 6163 6965 735b 695d 5b31 5d29 0d0a  _facies[i][1])..
+00028cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d00: 2020 2020 2020 2020 6966 2069 203c 206c          if i < l
+00028d10: 656e 2862 682e 6c6f 675f 6661 6369 6573  en(bh.log_facies
+00028d20: 292d 313a 0d0a 2020 2020 2020 2020 2020  )-1:..          
+00028d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028d40: 2020 6c2e 6170 7065 6e64 2862 682e 6c6f    l.append(bh.lo
+00028d50: 675f 6661 6369 6573 5b69 2b31 5d5b 315d  g_facies[i+1][1]
+00028d60: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00028d70: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00028d80: 6620 6920 3d3d 206c 656e 2862 682e 6c6f  f i == len(bh.lo
+00028d90: 675f 6661 6369 6573 292d 313a 0d0a 2020  g_facies)-1:..  
+00028da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028db0: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
+00028dc0: 6e64 2862 682e 7a2d 6268 2e64 6570 7468  nd(bh.z-bh.depth
+00028dd0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00028de0: 2020 2020 2020 2020 2020 2020 2061 203d               a =
+00028df0: 2028 636f 6f72 645b 305d 2c20 636f 6f72   (coord[0], coor
+00028e00: 645b 315d 2c20 286c 5b30 5d20 2d20 7a30  d[1], (l[0] - z0
+00028e10: 2920 2a20 765f 6578 202b 207a 3029 0d0a  ) * v_ex + z0)..
 00028e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e30: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00028e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e50: 2020 2020 2020 2020 2062 7265 616b 0d0a           break..
-00028e60: 0d0a 2020 2020 2020 2020 2020 2020 7765  ..            we
-00028e70: 6c6c 7320 3d20 7765 6c6c 732e 636f 6d62  lls = wells.comb
-00028e80: 696e 6528 2920 2020 0d0a 2020 2020 2020  ine()   ..      
-00028e90: 2020 2020 2020 702e 6164 645f 6d65 7368        p.add_mesh
-00028ea0: 2877 656c 6c73 2c20 7265 6e64 6572 5f6c  (wells, render_l
-00028eb0: 696e 6573 5f61 735f 7475 6265 733d 5472  ines_as_tubes=Tr
-00028ec0: 7565 2c20 6c69 6e65 5f77 6964 7468 3d31  ue, line_width=1
-00028ed0: 352c 2073 6361 6c61 7273 3d49 4473 2c20  5, scalars=IDs, 
-00028ee0: 636d 6170 3d6c 6973 7428 645f 636f 6c6f  cmap=list(d_colo
-00028ef0: 7273 5f66 2e76 616c 7565 7328 2929 2c20  rs_f.values()), 
-00028f00: 7368 6f77 5f73 6361 6c61 725f 6261 723d  show_scalar_bar=
-00028f10: 4661 6c73 6529 0d0a 0d0a 2020 2020 2020  False)....      
-00028f20: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
-00028f30: 6620 6c6f 6720 3d3d 2022 7374 7261 7469  f log == "strati
-00028f40: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-00028f50: 666f 7220 6268 2069 6e20 7365 6c66 2e6c  for bh in self.l
-00028f60: 6973 745f 6268 733a 0d0a 2020 2020 2020  ist_bhs:..      
-00028f70: 2020 2020 2020 2020 2020 6966 2062 682e            if bh.
-00028f80: 6c6f 675f 7374 7261 7469 2069 7320 6e6f  log_strati is no
-00028f90: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00028fa0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00028fb0: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
-00028fc0: 6268 2e6c 6f67 5f73 7472 6174 6929 293a  bh.log_strati)):
-00028fd0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00028fe0: 2020 2020 2020 2020 2020 2020 6c3d 5b5d              l=[]
-00028ff0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029000: 2020 2020 2020 2020 2020 7374 3d62 682e            st=bh.
-00029010: 6c6f 675f 7374 7261 7469 5b69 5d5b 305d  log_strati[i][0]
-00029020: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00029030: 2020 2020 2020 2020 2020 6c2e 6170 7065            l.appe
-00029040: 6e64 2862 682e 6c6f 675f 7374 7261 7469  nd(bh.log_strati
-00029050: 5b69 5d5b 315d 290d 0a20 2020 2020 2020  [i][1])..       
-00029060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029070: 2069 6620 6920 3c20 6c65 6e28 6268 2e6c   if i < len(bh.l
-00029080: 6f67 5f73 7472 6174 6929 2d31 3a0d 0a20  og_strati)-1:.. 
-00029090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000290a0: 2020 2020 2020 2020 2020 206c 2e61 7070             l.app
-000290b0: 656e 6428 6268 2e6c 6f67 5f73 7472 6174  end(bh.log_strat
-000290c0: 695b 692b 315d 5b31 5d29 0d0a 0d0a 2020  i[i+1][1])....  
-000290d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000290e0: 2020 2020 2020 656c 6966 2069 203d 3d20        elif i == 
-000290f0: 6c65 6e28 6268 2e6c 6f67 5f73 7472 6174  len(bh.log_strat
-00029100: 6929 2d31 3a0d 0a20 2020 2020 2020 2020  i)-1:..         
-00029110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029120: 2020 206c 2e61 7070 656e 6428 6268 2e7a     l.append(bh.z
-00029130: 2d62 682e 6465 7074 6829 0d0a 0d0a 2020  -bh.depth)....  
-00029140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029150: 2020 2020 2020 7074 733d 6e70 2e61 7272        pts=np.arr
-00029160: 6179 285b 6e70 2e6f 6e65 7328 5b6c 656e  ay([np.ones([len
-00029170: 286c 295d 292a 6268 2e78 2c20 6e70 2e6f  (l)])*bh.x, np.o
-00029180: 6e65 7328 5b6c 656e 286c 295d 292a 6268  nes([len(l)])*bh
-00029190: 2e79 2c20 6c5d 292e 540d 0a20 2020 2020  .y, l]).T..     
+00028e30: 2020 2020 2020 2020 6220 3d20 2863 6f6f          b = (coo
+00028e40: 7264 5b30 5d2c 2063 6f6f 7264 5b31 5d2c  rd[0], coord[1],
+00028e50: 2028 6c5b 315d 202d 207a 3029 202a 2076   (l[1] - z0) * v
+00028e60: 5f65 7820 2b20 7a30 290d 0a20 2020 2020  _ex + z0)..     
+00028e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e80: 2020 206c 696e 6520 3d20 7076 2e4c 696e     line = pv.Lin
+00028e90: 6528 612c 2062 290d 0a20 2020 2020 2020  e(a, b)..       
+00028ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028eb0: 2069 6620 7374 2069 7320 6e6f 7420 4e6f   if st is not No
+00028ec0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00028ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ee0: 2077 656c 6c73 2e61 7070 656e 6428 6c69   wells.append(li
+00028ef0: 6e65 290d 0a20 2020 2020 2020 2020 2020  ne)..           
+00028f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f10: 2049 4473 2e61 7070 656e 6428 645f 665b   IDs.append(d_f[
+00028f20: 7374 2e49 445d 290d 0a20 2020 2020 2020  st.ID])..       
+00028f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f40: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00028f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028f60: 2020 2020 6272 6561 6b0d 0a0d 0a20 2020      break....   
+00028f70: 2020 2020 2020 2020 2077 656c 6c73 203d           wells =
+00028f80: 2077 656c 6c73 2e63 6f6d 6269 6e65 2829   wells.combine()
+00028f90: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00028fa0: 2070 2e61 6464 5f6d 6573 6828 7765 6c6c   p.add_mesh(well
+00028fb0: 732c 2072 656e 6465 725f 6c69 6e65 735f  s, render_lines_
+00028fc0: 6173 5f74 7562 6573 3d54 7275 652c 206c  as_tubes=True, l
+00028fd0: 696e 655f 7769 6474 683d 3135 2c20 7363  ine_width=15, sc
+00028fe0: 616c 6172 733d 4944 732c 2063 6d61 703d  alars=IDs, cmap=
+00028ff0: 6c69 7374 2864 5f63 6f6c 6f72 735f 662e  list(d_colors_f.
+00029000: 7661 6c75 6573 2829 292c 2073 686f 775f  values()), show_
+00029010: 7363 616c 6172 5f62 6172 3d46 616c 7365  scalar_bar=False
+00029020: 290d 0a0d 0a20 2020 2020 2020 2022 2222  )....        """
+00029030: 0d0a 2020 2020 2020 2020 6966 206c 6f67  ..        if log
+00029040: 203d 3d20 2273 7472 6174 6922 3a0d 0a20   == "strati":.. 
+00029050: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
+00029060: 6820 696e 2073 656c 662e 6c69 7374 5f62  h in self.list_b
+00029070: 6873 3a0d 0a20 2020 2020 2020 2020 2020  hs:..           
+00029080: 2020 2020 2069 6620 6268 2e6c 6f67 5f73       if bh.log_s
+00029090: 7472 6174 6920 6973 206e 6f74 204e 6f6e  trati is not Non
+000290a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000290b0: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+000290c0: 2072 616e 6765 286c 656e 2862 682e 6c6f   range(len(bh.lo
+000290d0: 675f 7374 7261 7469 2929 3a0d 0a0d 0a20  g_strati)):.... 
+000290e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000290f0: 2020 2020 2020 206c 3d5b 5d0d 0a20 2020         l=[]..   
+00029100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029110: 2020 2020 2073 743d 6268 2e6c 6f67 5f73       st=bh.log_s
+00029120: 7472 6174 695b 695d 5b30 5d0d 0a20 2020  trati[i][0]..   
+00029130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029140: 2020 2020 206c 2e61 7070 656e 6428 6268       l.append(bh
+00029150: 2e6c 6f67 5f73 7472 6174 695b 695d 5b31  .log_strati[i][1
+00029160: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00029170: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00029180: 203c 206c 656e 2862 682e 6c6f 675f 7374   < len(bh.log_st
+00029190: 7261 7469 292d 313a 0d0a 2020 2020 2020  rati)-1:..      
 000291a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291b0: 2020 206c 696e 653d 6c69 6e65 735f 6672     line=lines_fr
-000291c0: 6f6d 5f70 6f69 6e74 7328 7074 7329 0d0a  om_points(pts)..
-000291d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000291e0: 2020 2020 2020 2020 6c69 6e65 2e70 6f69          line.poi
-000291f0: 6e74 735b 3a2c 202d 315d 3d28 6c69 6e65  nts[:, -1]=(line
-00029200: 2e70 6f69 6e74 735b 3a2c 202d 315d 202d  .points[:, -1] -
-00029210: 207a 3029 2a76 5f65 782b 7a30 0d0a 0d0a   z0)*v_ex+z0....
-00029220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029230: 2020 2020 2020 2020 6966 2073 7420 6973          if st is
-00029240: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+000291b0: 2020 2020 2020 6c2e 6170 7065 6e64 2862        l.append(b
+000291c0: 682e 6c6f 675f 7374 7261 7469 5b69 2b31  h.log_strati[i+1
+000291d0: 5d5b 315d 290d 0a0d 0a20 2020 2020 2020  ][1])....       
+000291e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000291f0: 2065 6c69 6620 6920 3d3d 206c 656e 2862   elif i == len(b
+00029200: 682e 6c6f 675f 7374 7261 7469 292d 313a  h.log_strati)-1:
+00029210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029220: 2020 2020 2020 2020 2020 2020 2020 6c2e                l.
+00029230: 6170 7065 6e64 2862 682e 7a2d 6268 2e64  append(bh.z-bh.d
+00029240: 6570 7468 290d 0a0d 0a20 2020 2020 2020  epth)....       
 00029250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029260: 2020 2020 2020 2020 636f 6c6f 723d 7374          color=st
-00029270: 2e63 0d0a 2020 2020 2020 2020 2020 2020  .c..            
-00029280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029290: 6f70 6163 6974 793d 310d 0a20 2020 2020  opacity=1..     
-000292a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292b0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000292c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000292d0: 2020 2020 2020 636f 6c6f 723d 2277 6869        color="whi
-000292e0: 7465 220d 0a20 2020 2020 2020 2020 2020  te"..           
-000292f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029300: 206f 7061 6369 7479 3d30 0d0a 2020 2020   opacity=0..    
-00029310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029320: 2020 2020 702e 6164 645f 6d65 7368 286c      p.add_mesh(l
-00029330: 696e 652c 2063 6f6c 6f72 3d63 6f6c 6f72  ine, color=color
-00029340: 2c20 6c69 6e65 5f77 6964 7468 3d31 352c  , line_width=15,
-00029350: 206f 7061 6369 7479 3d6f 7061 6369 7479   opacity=opacity
-00029360: 290d 0a0d 0a0d 0a20 2020 2020 2020 2065  )......        e
-00029370: 6c69 6620 6c6f 6720 3d3d 2022 6661 6369  lif log == "faci
-00029380: 6573 223a 0d0a 2020 2020 2020 2020 2020  es":..          
-00029390: 2020 666f 7220 6268 2069 6e20 7365 6c66    for bh in self
-000293a0: 2e6c 6973 745f 6268 733a 0d0a 2020 2020  .list_bhs:..    
-000293b0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-000293c0: 682e 6c6f 675f 6661 6369 6573 2069 7320  h.log_facies is 
-000293d0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-000293e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000293f0: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00029400: 6e28 6268 2e6c 6f67 5f66 6163 6965 7329  n(bh.log_facies)
-00029410: 293a 0d0a 0d0a 2020 2020 2020 2020 2020  ):....          
-00029420: 2020 2020 2020 2020 2020 2020 2020 6c3d                l=
-00029430: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
-00029440: 2020 2020 2020 2020 2020 2020 7374 3d62              st=b
-00029450: 682e 6c6f 675f 6661 6369 6573 5b69 5d5b  h.log_facies[i][
-00029460: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-00029470: 2020 2020 2020 2020 2020 2020 6c2e 6170              l.ap
-00029480: 7065 6e64 2862 682e 6c6f 675f 6661 6369  pend(bh.log_faci
-00029490: 6573 5b69 5d5b 315d 290d 0a20 2020 2020  es[i][1])..     
-000294a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294b0: 2020 2069 6620 6920 3c20 6c65 6e28 6268     if i < len(bh
-000294c0: 2e6c 6f67 5f66 6163 6965 7329 2d31 3a0d  .log_facies)-1:.
-000294d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000294e0: 2020 2020 2020 2020 2020 2020 206c 2e61               l.a
-000294f0: 7070 656e 6428 6268 2e6c 6f67 5f66 6163  ppend(bh.log_fac
-00029500: 6965 735b 692b 315d 5b31 5d29 0d0a 0d0a  ies[i+1][1])....
-00029510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029520: 2020 2020 2020 2020 6966 2069 203d 3d20          if i == 
-00029530: 6c65 6e28 6268 2e6c 6f67 5f66 6163 6965  len(bh.log_facie
-00029540: 7329 2d31 3a0d 0a20 2020 2020 2020 2020  s)-1:..         
-00029550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029560: 2020 206c 2e61 7070 656e 6428 6268 2e7a     l.append(bh.z
-00029570: 2d62 682e 6465 7074 6829 0d0a 0d0a 2020  -bh.depth)....  
-00029580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029590: 2020 2020 2020 7074 733d 6e70 2e61 7272        pts=np.arr
-000295a0: 6179 285b 6e70 2e6f 6e65 7328 5b6c 656e  ay([np.ones([len
-000295b0: 286c 295d 292a 6268 2e78 2c20 6e70 2e6f  (l)])*bh.x, np.o
-000295c0: 6e65 7328 5b6c 656e 286c 295d 292a 6268  nes([len(l)])*bh
-000295d0: 2e79 2c20 6c5d 292e 540d 0a20 2020 2020  .y, l]).T..     
+00029260: 2070 7473 3d6e 702e 6172 7261 7928 5b6e   pts=np.array([n
+00029270: 702e 6f6e 6573 285b 6c65 6e28 6c29 5d29  p.ones([len(l)])
+00029280: 2a62 682e 782c 206e 702e 6f6e 6573 285b  *bh.x, np.ones([
+00029290: 6c65 6e28 6c29 5d29 2a62 682e 792c 206c  len(l)])*bh.y, l
+000292a0: 5d29 2e54 0d0a 2020 2020 2020 2020 2020  ]).T..          
+000292b0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+000292c0: 6e65 3d6c 696e 6573 5f66 726f 6d5f 706f  ne=lines_from_po
+000292d0: 696e 7473 2870 7473 290d 0a20 2020 2020  ints(pts)..     
+000292e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000292f0: 2020 206c 696e 652e 706f 696e 7473 5b3a     line.points[:
+00029300: 2c20 2d31 5d3d 286c 696e 652e 706f 696e  , -1]=(line.poin
+00029310: 7473 5b3a 2c20 2d31 5d20 2d20 7a30 292a  ts[:, -1] - z0)*
+00029320: 765f 6578 2b7a 300d 0a0d 0a20 2020 2020  v_ex+z0....     
+00029330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029340: 2020 2069 6620 7374 2069 7320 6e6f 7420     if st is not 
+00029350: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00029360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029370: 2020 2063 6f6c 6f72 3d73 742e 630d 0a20     color=st.c.. 
+00029380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029390: 2020 2020 2020 2020 2020 206f 7061 6369             opaci
+000293a0: 7479 3d31 0d0a 2020 2020 2020 2020 2020  ty=1..          
+000293b0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000293c0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000293d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293e0: 2063 6f6c 6f72 3d22 7768 6974 6522 0d0a   color="white"..
+000293f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029400: 2020 2020 2020 2020 2020 2020 6f70 6163              opac
+00029410: 6974 793d 300d 0a20 2020 2020 2020 2020  ity=0..         
+00029420: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00029430: 2e61 6464 5f6d 6573 6828 6c69 6e65 2c20  .add_mesh(line, 
+00029440: 636f 6c6f 723d 636f 6c6f 722c 206c 696e  color=color, lin
+00029450: 655f 7769 6474 683d 3135 2c20 6f70 6163  e_width=15, opac
+00029460: 6974 793d 6f70 6163 6974 7929 0d0a 0d0a  ity=opacity)....
+00029470: 0d0a 2020 2020 2020 2020 656c 6966 206c  ..        elif l
+00029480: 6f67 203d 3d20 2266 6163 6965 7322 3a0d  og == "facies":.
+00029490: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+000294a0: 2062 6820 696e 2073 656c 662e 6c69 7374   bh in self.list
+000294b0: 5f62 6873 3a0d 0a20 2020 2020 2020 2020  _bhs:..         
+000294c0: 2020 2020 2020 2069 6620 6268 2e6c 6f67         if bh.log
+000294d0: 5f66 6163 6965 7320 6973 206e 6f74 204e  _facies is not N
+000294e0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+000294f0: 2020 2020 2020 2020 2020 666f 7220 6920            for i 
+00029500: 696e 2072 616e 6765 286c 656e 2862 682e  in range(len(bh.
+00029510: 6c6f 675f 6661 6369 6573 2929 3a0d 0a0d  log_facies)):...
+00029520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029530: 2020 2020 2020 2020 206c 3d5b 5d0d 0a20           l=[].. 
+00029540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029550: 2020 2020 2020 2073 743d 6268 2e6c 6f67         st=bh.log
+00029560: 5f66 6163 6965 735b 695d 5b30 5d0d 0a20  _facies[i][0].. 
+00029570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029580: 2020 2020 2020 206c 2e61 7070 656e 6428         l.append(
+00029590: 6268 2e6c 6f67 5f66 6163 6965 735b 695d  bh.log_facies[i]
+000295a0: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
+000295b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000295c0: 2069 203c 206c 656e 2862 682e 6c6f 675f   i < len(bh.log_
+000295d0: 6661 6369 6573 292d 313a 0d0a 2020 2020  facies)-1:..    
 000295e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295f0: 2020 206c 696e 653d 6c69 6e65 735f 6672     line=lines_fr
-00029600: 6f6d 5f70 6f69 6e74 7328 7074 7329 0d0a  om_points(pts)..
-00029610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029620: 2020 2020 2020 2020 6c69 6e65 2e70 6f69          line.poi
-00029630: 6e74 735b 3a2c 202d 315d 3d28 6c69 6e65  nts[:, -1]=(line
-00029640: 2e70 6f69 6e74 735b 3a2c 202d 315d 202d  .points[:, -1] -
-00029650: 207a 3029 2a76 5f65 782b 7a30 0d0a 2020   z0)*v_ex+z0..  
-00029660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029670: 2020 2020 2020 6966 2073 7420 6973 206e        if st is n
-00029680: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+000295f0: 2020 2020 2020 2020 6c2e 6170 7065 6e64          l.append
+00029600: 2862 682e 6c6f 675f 6661 6369 6573 5b69  (bh.log_facies[i
+00029610: 2b31 5d5b 315d 290d 0a0d 0a20 2020 2020  +1][1])....     
+00029620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029630: 2020 2069 6620 6920 3d3d 206c 656e 2862     if i == len(b
+00029640: 682e 6c6f 675f 6661 6369 6573 292d 313a  h.log_facies)-1:
+00029650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029660: 2020 2020 2020 2020 2020 2020 2020 6c2e                l.
+00029670: 6170 7065 6e64 2862 682e 7a2d 6268 2e64  append(bh.z-bh.d
+00029680: 6570 7468 290d 0a0d 0a20 2020 2020 2020  epth)....       
 00029690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000296a0: 2020 2020 2020 636f 6c6f 723d 7374 2e63        color=st.c
-000296b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000296c0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-000296d0: 6163 6974 793d 310d 0a20 2020 2020 2020  acity=1..       
-000296e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000296f0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00029700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029710: 2020 2020 636f 6c6f 723d 2277 6869 7465      color="white
-00029720: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00029730: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00029740: 7061 6369 7479 3d30 0d0a 2020 2020 2020  pacity=0..      
-00029750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029760: 2020 702e 6164 645f 6d65 7368 286c 696e    p.add_mesh(lin
-00029770: 652c 2063 6f6c 6f72 3d63 6f6c 6f72 2c20  e, color=color, 
-00029780: 696e 7465 7270 6f6c 6174 655f 6265 666f  interpolate_befo
-00029790: 7265 5f6d 6170 3d54 7275 652c 2072 656e  re_map=True, ren
-000297a0: 6465 725f 6c69 6e65 735f 6173 5f74 7562  der_lines_as_tub
-000297b0: 6573 3d54 7275 652c 206c 696e 655f 7769  es=True, line_wi
-000297c0: 6474 683d 3135 2c20 6f70 6163 6974 793d  dth=15, opacity=
-000297d0: 6f70 6163 6974 7929 0d0a 2020 2020 2020  opacity)..      
-000297e0: 2020 2222 2220 2020 0d0a 0d0a 2020 2020    """   ....    
-000297f0: 2020 2020 6966 2070 6c6f 745f 746f 703a      if plot_top:
-00029800: 0d0a 2020 2020 2020 2020 2020 2020 582c  ..            X,
-00029810: 2059 3d6e 702e 6d65 7368 6772 6964 2873   Y=np.meshgrid(s
-00029820: 656c 662e 6765 745f 7867 6328 292c 2073  elf.get_xgc(), s
-00029830: 656c 662e 6765 745f 7967 6328 2929 0d0a  elf.get_ygc())..
-00029840: 2020 2020 2020 2020 2020 2020 6772 6964              grid
-00029850: 3d70 762e 5374 7275 6374 7572 6564 4772  =pv.StructuredGr
-00029860: 6964 2858 2c20 592c 2028 7365 6c66 2e74  id(X, Y, (self.t
-00029870: 6f70 2d7a 3029 2a76 5f65 782b 7a30 290d  op-z0)*v_ex+z0).
-00029880: 0a20 2020 2020 2020 2020 2020 2070 2e61  .            p.a
-00029890: 6464 5f6d 6573 6828 6772 6964 2c20 6f70  dd_mesh(grid, op
-000298a0: 6163 6974 793d 302e 382c 2063 6f6c 6f72  acity=0.8, color
-000298b0: 3d22 7768 6974 6522 290d 0a0d 0a20 2020  ="white")....   
-000298c0: 2020 2020 2069 6620 706c 6f74 5f62 6f74       if plot_bot
-000298d0: 3a0d 0a20 2020 2020 2020 2020 2020 2058  :..            X
-000298e0: 2c20 593d 6e70 2e6d 6573 6867 7269 6428  , Y=np.meshgrid(
-000298f0: 7365 6c66 2e67 6574 5f78 6763 2829 2c20  self.get_xgc(), 
-00029900: 7365 6c66 2e67 6574 5f79 6763 2829 290d  self.get_ygc()).
-00029910: 0a20 2020 2020 2020 2020 2020 2067 7269  .            gri
-00029920: 643d 7076 2e53 7472 7563 7475 7265 6447  d=pv.StructuredG
-00029930: 7269 6428 582c 2059 2c20 2873 656c 662e  rid(X, Y, (self.
-00029940: 626f 742d 7a30 292a 765f 6578 2b7a 3029  bot-z0)*v_ex+z0)
-00029950: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
-00029960: 6164 645f 6d65 7368 2867 7269 642c 206f  add_mesh(grid, o
-00029970: 7061 6369 7479 3d30 2e38 2c20 636f 6c6f  pacity=0.8, colo
-00029980: 723d 2272 6564 2229 0d0a 0d0a 2020 2020  r="red")....    
-00029990: 2020 2020 6966 2070 6c6f 7474 6572 2069      if plotter i
-000299a0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-000299b0: 2020 2020 2070 2e61 6464 5f62 6f75 6e64       p.add_bound
-000299c0: 696e 675f 626f 7828 290d 0a20 2020 2020  ing_box()..     
-000299d0: 2020 2020 2020 2070 2e73 686f 775f 6178         p.show_ax
-000299e0: 6573 2829 0d0a 2020 2020 2020 2020 2020  es()..          
-000299f0: 2020 702e 7368 6f77 2829 0d0a 0d0a 2020    p.show()....  
-00029a00: 2020 6465 6620 706c 6f74 5f67 656f 6c5f    def plot_geol_
-00029a10: 6d61 7028 7365 6c66 2c20 706c 6f74 7465  map(self, plotte
-00029a20: 723d 4e6f 6e65 2c20 765f 6578 3d31 2c20  r=None, v_ex=1, 
-00029a30: 7570 3d30 293a 0d0a 2020 2020 0d0a 2020  up=0):..    ..  
-00029a40: 2020 2020 2020 6e78 203d 2073 656c 662e        nx = self.
-00029a50: 6765 745f 6e78 2829 0d0a 2020 2020 2020  get_nx()..      
-00029a60: 2020 6e79 203d 2073 656c 662e 6765 745f    ny = self.get_
-00029a70: 6e79 2829 0d0a 2020 2020 2020 2020 0d0a  ny()..        ..
-00029a80: 2020 2020 2020 2020 2320 706c 6f74 2067          # plot g
-00029a90: 656f 6c0d 0a20 2020 2020 2020 2058 2c59  eol..        X,Y
-00029aa0: 203d 206e 702e 6d65 7368 6772 6964 2873   = np.meshgrid(s
-00029ab0: 656c 662e 7867 632c 2073 656c 662e 7967  elf.xgc, self.yg
-00029ac0: 6329 0d0a 2020 2020 2020 2020 6772 6964  c)..        grid
-00029ad0: 203d 2070 762e 5374 7275 6374 7572 6564   = pv.Structured
-00029ae0: 4772 6964 2858 2c20 592c 2076 5f65 782a  Grid(X, Y, v_ex*
-00029af0: 2873 656c 662e 746f 7020 2d20 7365 6c66  (self.top - self
-00029b00: 2e6f 7a29 2b73 656c 662e 6f7a 202b 2075  .oz)+self.oz + u
-00029b10: 7029 0d0a 2020 2020 2020 2020 0d0a 2020  p)..        ..  
-00029b20: 2020 2020 2020 6765 6f6c 5f6d 6170 203d        geol_map =
-00029b30: 2073 656c 662e 6765 6f6c 5f6d 6170 0d0a   self.geol_map..
-00029b40: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00029b50: 2020 6172 7220 3d20 6e70 2e6f 6e65 7328    arr = np.ones(
-00029b60: 5b6e 792c 206e 782c 2033 5d29 2a6e 702e  [ny, nx, 3])*np.
-00029b70: 6e61 6e0d 0a20 2020 2020 2020 2066 6f72  nan..        for
-00029b80: 2069 7920 696e 2072 616e 6765 2867 656f   iy in range(geo
-00029b90: 6c5f 6d61 702e 7368 6170 655b 305d 293a  l_map.shape[0]):
-00029ba0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00029bb0: 7220 6978 2069 6e20 7261 6e67 6528 6765  r ix in range(ge
-00029bc0: 6f6c 5f6d 6170 2e73 6861 7065 5b31 5d29  ol_map.shape[1])
-00029bd0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00029be0: 2020 2075 6e69 7420 3d20 7365 6c66 2e67     unit = self.g
-00029bf0: 6574 5f75 6e69 7428 4944 3d67 656f 6c5f  et_unit(ID=geol_
-00029c00: 6d61 705b 6979 2c20 6978 5d2c 2074 7970  map[iy, ix], typ
-00029c10: 653d 2249 4422 2c20 7662 3d30 290d 0a20  e="ID", vb=0).. 
-00029c20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00029c30: 6620 756e 6974 2069 7320 6e6f 7420 4e6f  f unit is not No
-00029c40: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00029c50: 2020 2020 2020 2020 2061 7272 5b69 792c           arr[iy,
-00029c60: 2069 785d 203d 206d 6174 706c 6f74 6c69   ix] = matplotli
-00029c70: 622e 636f 6c6f 7273 2e74 6f5f 7267 6228  b.colors.to_rgb(
-00029c80: 756e 6974 2e63 290d 0a20 2020 2020 2020  unit.c)..       
-00029c90: 200d 0a20 2020 2020 2020 2069 6620 706c   ..        if pl
-00029ca0: 6f74 7465 7220 6973 204e 6f6e 653a 0d0a  otter is None:..
-00029cb0: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
-00029cc0: 7076 2e50 6c6f 7474 6572 2829 0d0a 0d0a  pv.Plotter()....
-00029cd0: 2020 2020 2020 2020 2020 2020 702e 6164              p.ad
-00029ce0: 645f 6d65 7368 2867 7269 642c 2272 6564  d_mesh(grid,"red
-00029cf0: 222c 2073 6361 6c61 7273 3d61 7272 2e72  ", scalars=arr.r
-00029d00: 6573 6861 7065 2828 6e78 2a6e 792c 2033  eshape((nx*ny, 3
-00029d10: 292c 6f72 6465 723d 2246 2229 2c20 6f70  ),order="F"), op
-00029d20: 6163 6974 793d 2e35 2c20 7267 623d 5472  acity=.5, rgb=Tr
-00029d30: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
-00029d40: 2070 2e61 6464 5f62 6f75 6e64 696e 675f   p.add_bounding_
-00029d50: 626f 7828 290d 0a20 2020 2020 2020 2020  box()..         
-00029d60: 2020 2070 2e73 686f 7728 290d 0a20 2020     p.show()..   
-00029d70: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
-00029d80: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00029d90: 2020 706c 6f74 7465 722e 6164 645f 6d65    plotter.add_me
-00029da0: 7368 2867 7269 642c 2272 6564 222c 7363  sh(grid,"red",sc
-00029db0: 616c 6172 733d 6172 722e 7265 7368 6170  alars=arr.reshap
-00029dc0: 6528 286e 782a 6e79 2c20 3329 2c6f 7264  e((nx*ny, 3),ord
-00029dd0: 6572 3d22 4622 292c 206f 7061 6369 7479  er="F"), opacity
-00029de0: 3d2e 352c 2072 6762 3d54 7275 6529 0d0a  =.5, rgb=True)..
-00029df0: 0d0a 2020 2020 6465 6620 6765 745f 756e  ..    def get_un
-00029e00: 6974 735f 646f 6d61 696e 735f 7265 616c  its_domains_real
-00029e10: 697a 6174 696f 6e73 2873 656c 662c 2069  izations(self, i
-00029e20: 753d 4e6f 6e65 2c20 616c 6c5f 6461 7461  u=None, all_data
-00029e30: 3d54 7275 652c 2066 696c 6c3d 2249 4422  =True, fill="ID"
-00029e40: 2c20 685f 6c65 7665 6c3d 2261 6c6c 2229  , h_level="all")
-00029e50: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-00029e60: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00029e70: 2061 206e 756d 7079 2061 7272 6179 206f   a numpy array o
-00029e80: 6620 3120 6f72 2061 6c6c 2075 6e69 7473  f 1 or all units
-00029e90: 2072 6561 6c69 7a61 7469 6f6e 2873 292e   realization(s).
-00029ea0: 0d0a 0d0a 2020 2020 2020 2020 6975 3a20  ....        iu: 
-00029eb0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-00029ec0: 2073 696d 756c 6174 696f 6e20 746f 2072   simulation to r
-00029ed0: 6574 7572 6e0d 0a20 2020 2020 2020 2061  eturn..        a
-00029ee0: 6c6c 5f64 6174 613a 2062 6f6f 6c0d 0a20  ll_data: bool.. 
-00029ef0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00029f00: 6e20 616c 6c20 7468 6520 756e 6974 7320  n all the units 
-00029f10: 7369 6d75 6c61 7469 6f6e 732c 0d0a 2020  simulations,..  
-00029f20: 2020 2020 2020 2020 2020 696e 2074 6861            in tha
-00029f30: 7420 6361 7365 2c20 6975 2069 7320 6967  t case, iu is ig
-00029f40: 6e6f 7265 640d 0a20 2020 2020 2020 2066  nored..        f
-00029f50: 696c 6c3a 2073 7472 696e 670d 0a20 2020  ill: string..   
-00029f60: 2020 2020 2020 2020 2049 4420 6f72 2063           ID or c
-00029f70: 6f6c 6f72 2061 7265 2070 6f73 7369 626c  olor are possibl
-00029f80: 652c 2074 6f20 7265 7475 726e 0d0a 2020  e, to return..  
-00029f90: 2020 2020 2020 2020 2020 7265 616c 697a            realiz
-00029fa0: 6174 696f 6e73 2077 6974 6820 756e 6974  ations with unit
-00029fb0: 2049 4420 6f72 2052 4742 4120 636f 6c6f   ID or RGBA colo
-00029fc0: 720d 0a20 2020 2020 2020 2020 2020 2028  r..            (
-00029fd0: 666f 7220 706c 6f74 7469 6e67 2070 7572  for plotting pur
-00029fe0: 706f 7365 2065 2e67 2e20 7769 7468 2070  pose e.g. with p
-00029ff0: 6c74 2e69 6d73 686f 7729 0d0a 2020 2020  lt.imshow)..    
-0002a000: 2020 2020 685f 6c65 7665 6c3a 2073 7472      h_level: str
-0002a010: 696e 6720 6f72 2069 6e74 0d0a 2020 2020  ing or int..    
-0002a020: 2020 2020 2020 2020 6869 6572 6172 6368          hierarch
-0002a030: 6963 616c 206c 6576 656c 2074 6f20 706c  ical level to pl
-0002a040: 6f74 2e0d 0a20 2020 2020 2020 2020 2020  ot...           
-0002a050: 2041 2076 616c 7565 206f 6620 3120 696e   A value of 1 in
-0002a060: 6469 6361 7465 7320 7468 6174 206f 6e6c  dicates that onl
-0002a070: 7920 756e 6974 206f 6620 7468 650d 0a20  y unit of the.. 
-0002a080: 2020 2020 2020 2020 2020 206d 6173 7465             maste
-0002a090: 7220 7069 6c65 2077 696c 6c20 6265 2070  r pile will be p
-0002a0a0: 6c6f 7474 6564 2e20 2261 6c6c 2220 746f  lotted. "all" to
-0002a0b0: 2070 6c6f 7420 616c 6c20 706f 7373 6962   plot all possib
-0002a0c0: 6c65 2075 6e69 7473 0d0a 2020 2020 2020  le units..      
-0002a0d0: 2020 2222 220d 0a0d 0a20 2020 2020 2020    """....       
-0002a0e0: 2023 2069 6620 7365 6c66 2e47 656f 6c2e   # if self.Geol.
-0002a0f0: 756e 6974 735f 646f 6d61 696e 7320 6973  units_domains is
-0002a100: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0002a110: 2320 2020 2020 7261 6973 6520 5661 6c75  #     raise Valu
-0002a120: 6545 7272 6f72 2822 556e 6974 7320 6861  eError("Units ha
-0002a130: 7665 206e 6f74 2062 6565 6e20 636f 6d70  ve not been comp
-0002a140: 7574 6564 2079 6574 2229 0d0a 2020 2020  uted yet")..    
-0002a150: 2020 2020 6966 2073 656c 662e 7772 6974      if self.writ
-0002a160: 655f 7265 7375 6c74 733a 0d0a 2020 2020  e_results:..    
-0002a170: 2020 2020 2020 2020 6966 2022 7564 2220          if "ud" 
-0002a180: 6e6f 7420 696e 205b 692e 7370 6c69 7428  not in [i.split(
-0002a190: 222e 2229 5b2d 315d 2066 6f72 2069 2069  ".")[-1] for i i
-0002a1a0: 6e20 6f73 2e6c 6973 7464 6972 2873 656c  n os.listdir(sel
-0002a1b0: 662e 7773 295d 3a0d 0a20 2020 2020 2020  f.ws)]:..       
-0002a1c0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0002a1d0: 616c 7565 4572 726f 7228 2255 6e69 7473  alueError("Units
-0002a1e0: 2068 6176 6520 6e6f 7420 6265 656e 2063   have not been c
-0002a1f0: 6f6d 7075 7465 6420 7965 7422 290d 0a0d  omputed yet")...
-0002a200: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0002a210: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002a220: 7365 6c66 2e47 656f 6c2e 756e 6974 735f  self.Geol.units_
-0002a230: 646f 6d61 696e 7320 6973 204e 6f6e 653a  domains is None:
-0002a240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a250: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0002a260: 6f72 2822 556e 6974 7320 6861 7665 206e  or("Units have n
-0002a270: 6f74 2062 6565 6e20 636f 6d70 7574 6564  ot been computed
-0002a280: 2079 6574 2229 0d0a 0d0a 2020 2020 2020   yet")....      
-0002a290: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0002a2a0: 6975 2c20 696e 7429 3a0d 0a20 2020 2020  iu, int):..     
-0002a2b0: 2020 2020 2020 2061 6c6c 5f64 6174 613d         all_data=
-0002a2c0: 4661 6c73 650d 0a0d 0a20 2020 2020 2020  False....       
-0002a2d0: 206e 7265 616c 3d73 656c 662e 6e72 6561   nreal=self.nrea
-0002a2e0: 6c5f 756e 6974 730d 0a20 2020 2020 2020  l_units..       
-0002a2f0: 206e 783d 7365 6c66 2e67 6574 5f6e 7828   nx=self.get_nx(
-0002a300: 290d 0a20 2020 2020 2020 206e 793d 7365  )..        ny=se
-0002a310: 6c66 2e67 6574 5f6e 7928 290d 0a20 2020  lf.get_ny()..   
-0002a320: 2020 2020 206e 7a3d 7365 6c66 2e67 6574       nz=self.get
-0002a330: 5f6e 7a28 290d 0a0d 0a20 2020 2020 2020  _nz()....       
-0002a340: 2069 6620 616c 6c5f 6461 7461 3a0d 0a20   if all_data:.. 
-0002a350: 2020 2020 2020 2020 2020 2075 643d 6e70             ud=np
-0002a360: 2e7a 6572 6f73 285b 6e72 6561 6c2c 206e  .zeros([nreal, n
-0002a370: 7a2c 206e 792c 206e 785d 2c20 6474 7970  z, ny, nx], dtyp
-0002a380: 653d 6e70 2e69 6e74 3829 0d0a 0d0a 2020  e=np.int8)....  
-0002a390: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0002a3a0: 662e 7772 6974 655f 7265 7375 6c74 733a  f.write_results:
-0002a3b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a3c0: 2020 2320 6765 7420 616c 6c20 7265 616c    # get all real
-0002a3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a3e0: 2020 666f 7220 6972 6561 6c20 696e 2072    for ireal in r
-0002a3f0: 616e 6765 286e 7265 616c 293a 0d0a 2020  ange(nreal):..  
-0002a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a410: 2020 666e 616d 653d 7365 6c66 2e6e 616d    fname=self.nam
-0002a420: 652b 225f 7b7d 2e75 6422 2e66 6f72 6d61  e+"_{}.ud".forma
-0002a430: 7428 6972 6561 6c29 0d0a 2020 2020 2020  t(ireal)..      
-0002a440: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-0002a450: 6174 683d 6f73 2e70 6174 682e 6a6f 696e  ath=os.path.join
-0002a460: 2873 656c 662e 7773 2c20 666e 616d 6529  (self.ws, fname)
-0002a470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a480: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
-0002a490: 6670 6174 682c 2022 7262 2229 2061 7320  fpath, "rb") as 
-0002a4a0: 663a 0d0a 2020 2020 2020 2020 2020 2020  f:..            
-0002a4b0: 2020 2020 2020 2020 2020 2020 7564 5b69              ud[i
-0002a4c0: 7265 616c 5d3d 7069 636b 6c65 2e6c 6f61  real]=pickle.loa
-0002a4d0: 6428 6629 0d0a 2020 2020 2020 2020 2020  d(f)..          
-0002a4e0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002a4f0: 2020 2020 2020 2020 2075 643d 7365 6c66           ud=self
-0002a500: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
-0002a510: 696e 732e 636f 7079 2829 0d0a 0d0a 2020  ins.copy()....  
-0002a520: 2020 2020 2020 2020 2020 6966 2066 696c            if fil
-0002a530: 6c20 3d3d 2022 4944 223a 0d0a 2020 2020  l == "ID":..    
-0002a540: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0002a550: 735f 646f 6d61 696e 733d 7564 0d0a 2020  s_domains=ud..  
-0002a560: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002a570: 2068 5f6c 6576 656c 203d 3d20 2261 6c6c   h_level == "all
-0002a580: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0002a590: 2020 2020 2020 2020 7061 7373 0d0a 0d0a          pass....
-0002a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5b0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0002a5c0: 685f 6c65 7665 6c2c 2069 6e74 2920 616e  h_level, int) an
-0002a5d0: 6420 685f 6c65 7665 6c20 3e20 303a 0d0a  d h_level > 0:..
-0002a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a5f0: 2020 2020 6c73 745f 4944 3d6e 702e 756e      lst_ID=np.un
-0002a600: 6971 7565 2875 6e69 7473 5f64 6f6d 6169  ique(units_domai
-0002a610: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
-0002a620: 2020 2020 2020 2020 2066 6f72 2069 6478           for idx
-0002a630: 2069 6e20 6c73 745f 4944 3a0d 0a20 2020   in lst_ID:..   
-0002a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a650: 2020 2020 2069 6620 6964 7820 213d 2030       if idx != 0
-0002a660: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002a670: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0002a680: 3d73 656c 662e 6765 745f 756e 6974 2849  =self.get_unit(I
-0002a690: 443d 6964 782c 2074 7970 653d 2249 4422  D=idx, type="ID"
-0002a6a0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002a6b0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0002a6c0: 5f6c 6576 3d73 2e67 6574 5f68 5f6c 6576  _lev=s.get_h_lev
-0002a6d0: 656c 2829 2020 2320 6869 6572 6172 6368  el()  # hierarch
-0002a6e0: 6963 616c 206c 6576 656c 206f 6620 756e  ical level of un
-0002a6f0: 6974 0d0a 2020 2020 2020 2020 2020 2020  it..            
-0002a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a710: 6966 2068 5f6c 6576 203e 2068 5f6c 6576  if h_lev > h_lev
-0002a720: 656c 3a20 2023 2063 6f6d 7061 7265 2075  el:  # compare u
-0002a730: 6e69 7420 6c65 7665 6c20 7769 7468 206c  nit level with l
-0002a740: 6576 656c 2074 6f20 706c 6f74 0d0a 2020  evel to plot..  
-0002a750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a760: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0002a770: 7220 6920 696e 2072 616e 6765 2868 5f6c  r i in range(h_l
-0002a780: 6576 202d 2068 5f6c 6576 656c 293a 0d0a  ev - h_level):..
+000296a0: 2070 7473 3d6e 702e 6172 7261 7928 5b6e   pts=np.array([n
+000296b0: 702e 6f6e 6573 285b 6c65 6e28 6c29 5d29  p.ones([len(l)])
+000296c0: 2a62 682e 782c 206e 702e 6f6e 6573 285b  *bh.x, np.ones([
+000296d0: 6c65 6e28 6c29 5d29 2a62 682e 792c 206c  len(l)])*bh.y, l
+000296e0: 5d29 2e54 0d0a 2020 2020 2020 2020 2020  ]).T..          
+000296f0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00029700: 6e65 3d6c 696e 6573 5f66 726f 6d5f 706f  ne=lines_from_po
+00029710: 696e 7473 2870 7473 290d 0a20 2020 2020  ints(pts)..     
+00029720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029730: 2020 206c 696e 652e 706f 696e 7473 5b3a     line.points[:
+00029740: 2c20 2d31 5d3d 286c 696e 652e 706f 696e  , -1]=(line.poin
+00029750: 7473 5b3a 2c20 2d31 5d20 2d20 7a30 292a  ts[:, -1] - z0)*
+00029760: 765f 6578 2b7a 300d 0a20 2020 2020 2020  v_ex+z0..       
+00029770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029780: 2069 6620 7374 2069 7320 6e6f 7420 4e6f   if st is not No
+00029790: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+000297a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297b0: 2063 6f6c 6f72 3d73 742e 630d 0a20 2020   color=st.c..   
+000297c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000297d0: 2020 2020 2020 2020 206f 7061 6369 7479           opacity
+000297e0: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
+000297f0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00029800: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00029810: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00029820: 6f6c 6f72 3d22 7768 6974 6522 0d0a 2020  olor="white"..  
+00029830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029840: 2020 2020 2020 2020 2020 6f70 6163 6974            opacit
+00029850: 793d 300d 0a20 2020 2020 2020 2020 2020  y=0..           
+00029860: 2020 2020 2020 2020 2020 2020 2070 2e61               p.a
+00029870: 6464 5f6d 6573 6828 6c69 6e65 2c20 636f  dd_mesh(line, co
+00029880: 6c6f 723d 636f 6c6f 722c 2069 6e74 6572  lor=color, inter
+00029890: 706f 6c61 7465 5f62 6566 6f72 655f 6d61  polate_before_ma
+000298a0: 703d 5472 7565 2c20 7265 6e64 6572 5f6c  p=True, render_l
+000298b0: 696e 6573 5f61 735f 7475 6265 733d 5472  ines_as_tubes=Tr
+000298c0: 7565 2c20 6c69 6e65 5f77 6964 7468 3d31  ue, line_width=1
+000298d0: 352c 206f 7061 6369 7479 3d6f 7061 6369  5, opacity=opaci
+000298e0: 7479 290d 0a20 2020 2020 2020 2022 2222  ty)..        """
+000298f0: 2020 200d 0a0d 0a20 2020 2020 2020 2069     ....        i
+00029900: 6620 706c 6f74 5f74 6f70 3a0d 0a20 2020  f plot_top:..   
+00029910: 2020 2020 2020 2020 2058 2c20 593d 6e70           X, Y=np
+00029920: 2e6d 6573 6867 7269 6428 7365 6c66 2e67  .meshgrid(self.g
+00029930: 6574 5f78 6763 2829 2c20 7365 6c66 2e67  et_xgc(), self.g
+00029940: 6574 5f79 6763 2829 290d 0a20 2020 2020  et_ygc())..     
+00029950: 2020 2020 2020 2067 7269 643d 7076 2e53         grid=pv.S
+00029960: 7472 7563 7475 7265 6447 7269 6428 582c  tructuredGrid(X,
+00029970: 2059 2c20 2873 656c 662e 746f 702d 7a30   Y, (self.top-z0
+00029980: 292a 765f 6578 2b7a 3029 0d0a 2020 2020  )*v_ex+z0)..    
+00029990: 2020 2020 2020 2020 702e 6164 645f 6d65          p.add_me
+000299a0: 7368 2867 7269 642c 206f 7061 6369 7479  sh(grid, opacity
+000299b0: 3d30 2e38 2c20 636f 6c6f 723d 2277 6869  =0.8, color="whi
+000299c0: 7465 2229 0d0a 0d0a 2020 2020 2020 2020  te")....        
+000299d0: 6966 2070 6c6f 745f 626f 743a 0d0a 2020  if plot_bot:..  
+000299e0: 2020 2020 2020 2020 2020 582c 2059 3d6e            X, Y=n
+000299f0: 702e 6d65 7368 6772 6964 2873 656c 662e  p.meshgrid(self.
+00029a00: 6765 745f 7867 6328 292c 2073 656c 662e  get_xgc(), self.
+00029a10: 6765 745f 7967 6328 2929 0d0a 2020 2020  get_ygc())..    
+00029a20: 2020 2020 2020 2020 6772 6964 3d70 762e          grid=pv.
+00029a30: 5374 7275 6374 7572 6564 4772 6964 2858  StructuredGrid(X
+00029a40: 2c20 592c 2028 7365 6c66 2e62 6f74 2d7a  , Y, (self.bot-z
+00029a50: 3029 2a76 5f65 782b 7a30 290d 0a20 2020  0)*v_ex+z0)..   
+00029a60: 2020 2020 2020 2020 2070 2e61 6464 5f6d           p.add_m
+00029a70: 6573 6828 6772 6964 2c20 6f70 6163 6974  esh(grid, opacit
+00029a80: 793d 302e 382c 2063 6f6c 6f72 3d22 7265  y=0.8, color="re
+00029a90: 6422 290d 0a0d 0a20 2020 2020 2020 2069  d")....        i
+00029aa0: 6620 706c 6f74 7465 7220 6973 204e 6f6e  f plotter is Non
+00029ab0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00029ac0: 702e 6164 645f 626f 756e 6469 6e67 5f62  p.add_bounding_b
+00029ad0: 6f78 2829 0d0a 2020 2020 2020 2020 2020  ox()..          
+00029ae0: 2020 702e 7368 6f77 5f61 7865 7328 290d    p.show_axes().
+00029af0: 0a20 2020 2020 2020 2020 2020 2070 2e73  .            p.s
+00029b00: 686f 7728 290d 0a0d 0a20 2020 2064 6566  how()....    def
+00029b10: 2070 6c6f 745f 6765 6f6c 5f6d 6170 2873   plot_geol_map(s
+00029b20: 656c 662c 2070 6c6f 7474 6572 3d4e 6f6e  elf, plotter=Non
+00029b30: 652c 2076 5f65 783d 312c 2075 703d 3029  e, v_ex=1, up=0)
+00029b40: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
+00029b50: 200d 0a20 2020 2020 2020 206e 7820 3d20   ..        nx = 
+00029b60: 7365 6c66 2e67 6574 5f6e 7828 290d 0a20  self.get_nx().. 
+00029b70: 2020 2020 2020 206e 7920 3d20 7365 6c66         ny = self
+00029b80: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
+00029b90: 2020 200d 0a20 2020 2020 2020 2023 2070     ..        # p
+00029ba0: 6c6f 7420 6765 6f6c 0d0a 2020 2020 2020  lot geol..      
+00029bb0: 2020 582c 5920 3d20 6e70 2e6d 6573 6867    X,Y = np.meshg
+00029bc0: 7269 6428 7365 6c66 2e78 6763 2c20 7365  rid(self.xgc, se
+00029bd0: 6c66 2e79 6763 290d 0a20 2020 2020 2020  lf.ygc)..       
+00029be0: 2067 7269 6420 3d20 7076 2e53 7472 7563   grid = pv.Struc
+00029bf0: 7475 7265 6447 7269 6428 582c 2059 2c20  turedGrid(X, Y, 
+00029c00: 765f 6578 2a28 7365 6c66 2e74 6f70 202d  v_ex*(self.top -
+00029c10: 2073 656c 662e 6f7a 292b 7365 6c66 2e6f   self.oz)+self.o
+00029c20: 7a20 2b20 7570 290d 0a20 2020 2020 2020  z + up)..       
+00029c30: 200d 0a20 2020 2020 2020 2067 656f 6c5f   ..        geol_
+00029c40: 6d61 7020 3d20 7365 6c66 2e67 656f 6c5f  map = self.geol_
+00029c50: 6d61 700d 0a20 2020 2020 2020 200d 0a20  map..        .. 
+00029c60: 2020 2020 2020 2061 7272 203d 206e 702e         arr = np.
+00029c70: 6f6e 6573 285b 6e79 2c20 6e78 2c20 345d  ones([ny, nx, 4]
+00029c80: 292a 6e70 2e6e 616e 0d0a 2020 2020 2020  )*np.nan..      
+00029c90: 2020 666f 7220 6979 2069 6e20 7261 6e67    for iy in rang
+00029ca0: 6528 6765 6f6c 5f6d 6170 2e73 6861 7065  e(geol_map.shape
+00029cb0: 5b30 5d29 3a0d 0a20 2020 2020 2020 2020  [0]):..         
+00029cc0: 2020 2066 6f72 2069 7820 696e 2072 616e     for ix in ran
+00029cd0: 6765 2867 656f 6c5f 6d61 702e 7368 6170  ge(geol_map.shap
+00029ce0: 655b 315d 293a 0d0a 2020 2020 2020 2020  e[1]):..        
+00029cf0: 2020 2020 2020 2020 756e 6974 203d 2073          unit = s
+00029d00: 656c 662e 6765 745f 756e 6974 2849 443d  elf.get_unit(ID=
+00029d10: 6765 6f6c 5f6d 6170 5b69 792c 2069 785d  geol_map[iy, ix]
+00029d20: 2c20 7479 7065 3d22 4944 222c 2076 623d  , type="ID", vb=
+00029d30: 3029 0d0a 2020 2020 2020 2020 2020 2020  0)..            
+00029d40: 2020 2020 6966 2075 6e69 7420 6973 206e      if unit is n
+00029d50: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+00029d60: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00029d70: 725b 6979 2c20 6978 5d20 3d20 6d61 7470  r[iy, ix] = matp
+00029d80: 6c6f 746c 6962 2e63 6f6c 6f72 732e 746f  lotlib.colors.to
+00029d90: 5f72 6762 6128 756e 6974 2e63 290d 0a20  _rgba(unit.c).. 
+00029da0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+00029db0: 2069 6620 706c 6f74 7465 7220 6973 204e   if plotter is N
+00029dc0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00029dd0: 2020 7020 3d20 7076 2e50 6c6f 7474 6572    p = pv.Plotter
+00029de0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00029df0: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
+00029e00: 6164 645f 6d65 7368 2867 7269 642c 2272  add_mesh(grid,"r
+00029e10: 6564 222c 2073 6361 6c61 7273 3d61 7272  ed", scalars=arr
+00029e20: 2e72 6573 6861 7065 2828 6e78 2a6e 792c  .reshape((nx*ny,
+00029e30: 2034 292c 6f72 6465 723d 2246 2229 2c20   4),order="F"), 
+00029e40: 6f70 6163 6974 793d 302e 352c 2072 6762  opacity=0.5, rgb
+00029e50: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
+00029e60: 2020 2020 702e 6164 645f 626f 756e 6469      p.add_boundi
+00029e70: 6e67 5f62 6f78 2829 0d0a 2020 2020 2020  ng_box()..      
+00029e80: 2020 2020 2020 702e 7368 6f77 2829 0d0a        p.show()..
+00029e90: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+00029ea0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00029eb0: 2020 2020 2070 6c6f 7474 6572 2e61 6464       plotter.add
+00029ec0: 5f6d 6573 6828 6772 6964 2c22 7265 6422  _mesh(grid,"red"
+00029ed0: 2c73 6361 6c61 7273 3d61 7272 2e72 6573  ,scalars=arr.res
+00029ee0: 6861 7065 2828 6e78 2a6e 792c 2034 292c  hape((nx*ny, 4),
+00029ef0: 6f72 6465 723d 2246 2229 2c20 6f70 6163  order="F"), opac
+00029f00: 6974 793d 302e 352c 2072 6762 3d54 7275  ity=0.5, rgb=Tru
+00029f10: 6529 0d0a 0d0a 2020 2020 6465 6620 6765  e)....    def ge
+00029f20: 745f 756e 6974 735f 646f 6d61 696e 735f  t_units_domains_
+00029f30: 7265 616c 697a 6174 696f 6e73 2873 656c  realizations(sel
+00029f40: 662c 2069 753d 4e6f 6e65 2c20 616c 6c5f  f, iu=None, all_
+00029f50: 6461 7461 3d54 7275 652c 2066 696c 6c3d  data=True, fill=
+00029f60: 2249 4422 2c20 685f 6c65 7665 6c3d 2261  "ID", h_level="a
+00029f70: 6c6c 2229 3a0d 0a0d 0a20 2020 2020 2020  ll"):....       
+00029f80: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+00029f90: 7475 726e 2061 206e 756d 7079 2061 7272  turn a numpy arr
+00029fa0: 6179 206f 6620 3120 6f72 2061 6c6c 2075  ay of 1 or all u
+00029fb0: 6e69 7473 2072 6561 6c69 7a61 7469 6f6e  nits realization
+00029fc0: 2873 292e 0d0a 0d0a 2020 2020 2020 2020  (s).....        
+00029fd0: 6975 3a20 696e 740d 0a20 2020 2020 2020  iu: int..       
+00029fe0: 2020 2020 2073 696d 756c 6174 696f 6e20       simulation 
+00029ff0: 746f 2072 6574 7572 6e0d 0a20 2020 2020  to return..     
+0002a000: 2020 2061 6c6c 5f64 6174 613a 2062 6f6f     all_data: boo
+0002a010: 6c0d 0a20 2020 2020 2020 2020 2020 2072  l..            r
+0002a020: 6574 7572 6e20 616c 6c20 7468 6520 756e  eturn all the un
+0002a030: 6974 7320 7369 6d75 6c61 7469 6f6e 732c  its simulations,
+0002a040: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+0002a050: 2074 6861 7420 6361 7365 2c20 6975 2069   that case, iu i
+0002a060: 7320 6967 6e6f 7265 640d 0a20 2020 2020  s ignored..     
+0002a070: 2020 2066 696c 6c3a 2073 7472 696e 670d     fill: string.
+0002a080: 0a20 2020 2020 2020 2020 2020 2049 4420  .            ID 
+0002a090: 6f72 2063 6f6c 6f72 2061 7265 2070 6f73  or color are pos
+0002a0a0: 7369 626c 652c 2074 6f20 7265 7475 726e  sible, to return
+0002a0b0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0002a0c0: 616c 697a 6174 696f 6e73 2077 6974 6820  alizations with 
+0002a0d0: 756e 6974 2049 4420 6f72 2052 4742 4120  unit ID or RGBA 
+0002a0e0: 636f 6c6f 720d 0a20 2020 2020 2020 2020  color..         
+0002a0f0: 2020 2028 666f 7220 706c 6f74 7469 6e67     (for plotting
+0002a100: 2070 7572 706f 7365 2065 2e67 2e20 7769   purpose e.g. wi
+0002a110: 7468 2070 6c74 2e69 6d73 686f 7729 0d0a  th plt.imshow)..
+0002a120: 2020 2020 2020 2020 685f 6c65 7665 6c3a          h_level:
+0002a130: 2073 7472 696e 6720 6f72 2069 6e74 0d0a   string or int..
+0002a140: 2020 2020 2020 2020 2020 2020 6869 6572              hier
+0002a150: 6172 6368 6963 616c 206c 6576 656c 2074  archical level t
+0002a160: 6f20 706c 6f74 2e0d 0a20 2020 2020 2020  o plot...       
+0002a170: 2020 2020 2041 2076 616c 7565 206f 6620       A value of 
+0002a180: 3120 696e 6469 6361 7465 7320 7468 6174  1 indicates that
+0002a190: 206f 6e6c 7920 756e 6974 206f 6620 7468   only unit of th
+0002a1a0: 650d 0a20 2020 2020 2020 2020 2020 206d  e..            m
+0002a1b0: 6173 7465 7220 7069 6c65 2077 696c 6c20  aster pile will 
+0002a1c0: 6265 2070 6c6f 7474 6564 2e20 2261 6c6c  be plotted. "all
+0002a1d0: 2220 746f 2070 6c6f 7420 616c 6c20 706f  " to plot all po
+0002a1e0: 7373 6962 6c65 2075 6e69 7473 0d0a 2020  ssible units..  
+0002a1f0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
+0002a200: 2020 2020 2023 2069 6620 7365 6c66 2e47       # if self.G
+0002a210: 656f 6c2e 756e 6974 735f 646f 6d61 696e  eol.units_domain
+0002a220: 7320 6973 204e 6f6e 653a 0d0a 2020 2020  s is None:..    
+0002a230: 2020 2020 2320 2020 2020 7261 6973 6520      #     raise 
+0002a240: 5661 6c75 6545 7272 6f72 2822 556e 6974  ValueError("Unit
+0002a250: 7320 6861 7665 206e 6f74 2062 6565 6e20  s have not been 
+0002a260: 636f 6d70 7574 6564 2079 6574 2229 0d0a  computed yet")..
+0002a270: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002a280: 7772 6974 655f 7265 7375 6c74 733a 0d0a  write_results:..
+0002a290: 2020 2020 2020 2020 2020 2020 6966 2022              if "
+0002a2a0: 7564 2220 6e6f 7420 696e 205b 692e 7370  ud" not in [i.sp
+0002a2b0: 6c69 7428 222e 2229 5b2d 315d 2066 6f72  lit(".")[-1] for
+0002a2c0: 2069 2069 6e20 6f73 2e6c 6973 7464 6972   i in os.listdir
+0002a2d0: 2873 656c 662e 7773 295d 3a0d 0a20 2020  (self.ws)]:..   
+0002a2e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0002a2f0: 7365 2056 616c 7565 4572 726f 7228 2255  se ValueError("U
+0002a300: 6e69 7473 2068 6176 6520 6e6f 7420 6265  nits have not be
+0002a310: 656e 2063 6f6d 7075 7465 6420 7965 7422  en computed yet"
+0002a320: 290d 0a0d 0a20 2020 2020 2020 2065 6c73  )....        els
+0002a330: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002a340: 2069 6620 7365 6c66 2e47 656f 6c2e 756e   if self.Geol.un
+0002a350: 6974 735f 646f 6d61 696e 7320 6973 204e  its_domains is N
+0002a360: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+0002a370: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0002a380: 6545 7272 6f72 2822 556e 6974 7320 6861  eError("Units ha
+0002a390: 7665 206e 6f74 2062 6565 6e20 636f 6d70  ve not been comp
+0002a3a0: 7574 6564 2079 6574 2229 0d0a 0d0a 2020  uted yet")....  
+0002a3b0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002a3c0: 6e63 6528 6975 2c20 696e 7429 3a0d 0a20  nce(iu, int):.. 
+0002a3d0: 2020 2020 2020 2020 2020 2061 6c6c 5f64             all_d
+0002a3e0: 6174 613d 4661 6c73 650d 0a0d 0a20 2020  ata=False....   
+0002a3f0: 2020 2020 206e 7265 616c 3d73 656c 662e       nreal=self.
+0002a400: 6e72 6561 6c5f 756e 6974 730d 0a20 2020  nreal_units..   
+0002a410: 2020 2020 206e 783d 7365 6c66 2e67 6574       nx=self.get
+0002a420: 5f6e 7828 290d 0a20 2020 2020 2020 206e  _nx()..        n
+0002a430: 793d 7365 6c66 2e67 6574 5f6e 7928 290d  y=self.get_ny().
+0002a440: 0a20 2020 2020 2020 206e 7a3d 7365 6c66  .        nz=self
+0002a450: 2e67 6574 5f6e 7a28 290d 0a0d 0a20 2020  .get_nz()....   
+0002a460: 2020 2020 2069 6620 616c 6c5f 6461 7461       if all_data
+0002a470: 3a0d 0a20 2020 2020 2020 2020 2020 2075  :..            u
+0002a480: 643d 6e70 2e7a 6572 6f73 285b 6e72 6561  d=np.zeros([nrea
+0002a490: 6c2c 206e 7a2c 206e 792c 206e 785d 2c20  l, nz, ny, nx], 
+0002a4a0: 6474 7970 653d 6e70 2e69 6e74 3829 0d0a  dtype=np.int8)..
+0002a4b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0002a4c0: 2073 656c 662e 7772 6974 655f 7265 7375   self.write_resu
+0002a4d0: 6c74 733a 0d0a 2020 2020 2020 2020 2020  lts:..          
+0002a4e0: 2020 2020 2020 2320 6765 7420 616c 6c20        # get all 
+0002a4f0: 7265 616c 0d0a 2020 2020 2020 2020 2020  real..          
+0002a500: 2020 2020 2020 666f 7220 6972 6561 6c20        for ireal 
+0002a510: 696e 2072 616e 6765 286e 7265 616c 293a  in range(nreal):
+0002a520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a530: 2020 2020 2020 666e 616d 653d 7365 6c66        fname=self
+0002a540: 2e6e 616d 652b 225f 7b7d 2e75 6422 2e66  .name+"_{}.ud".f
+0002a550: 6f72 6d61 7428 6972 6561 6c29 0d0a 2020  ormat(ireal)..  
+0002a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a570: 2020 6670 6174 683d 6f73 2e70 6174 682e    fpath=os.path.
+0002a580: 6a6f 696e 2873 656c 662e 7773 2c20 666e  join(self.ws, fn
+0002a590: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
+0002a5a0: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+0002a5b0: 7065 6e28 6670 6174 682c 2022 7262 2229  pen(fpath, "rb")
+0002a5c0: 2061 7320 663a 0d0a 2020 2020 2020 2020   as f:..        
+0002a5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5e0: 7564 5b69 7265 616c 5d3d 7069 636b 6c65  ud[ireal]=pickle
+0002a5f0: 2e6c 6f61 6428 6629 0d0a 2020 2020 2020  .load(f)..      
+0002a600: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0002a610: 2020 2020 2020 2020 2020 2020 2075 643d               ud=
+0002a620: 7365 6c66 2e47 656f 6c2e 756e 6974 735f  self.Geol.units_
+0002a630: 646f 6d61 696e 732e 636f 7079 2829 0d0a  domains.copy()..
+0002a640: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0002a650: 2066 696c 6c20 3d3d 2022 4944 223a 0d0a   fill == "ID":..
+0002a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a670: 756e 6974 735f 646f 6d61 696e 733d 7564  units_domains=ud
+0002a680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a690: 2020 6966 2068 5f6c 6576 656c 203d 3d20    if h_level == 
+0002a6a0: 2261 6c6c 223a 0d0a 2020 2020 2020 2020  "all":..        
+0002a6b0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+0002a6c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0002a6d0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0002a6e0: 6e63 6528 685f 6c65 7665 6c2c 2069 6e74  nce(h_level, int
+0002a6f0: 2920 616e 6420 685f 6c65 7665 6c20 3e20  ) and h_level > 
+0002a700: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0002a710: 2020 2020 2020 2020 6c73 745f 4944 3d6e          lst_ID=n
+0002a720: 702e 756e 6971 7565 2875 6e69 7473 5f64  p.unique(units_d
+0002a730: 6f6d 6169 6e73 290d 0a20 2020 2020 2020  omains)..       
+0002a740: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0002a750: 2069 6478 2069 6e20 6c73 745f 4944 3a0d   idx in lst_ID:.
+0002a760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a770: 2020 2020 2020 2020 2069 6620 6964 7820           if idx 
+0002a780: 213d 2030 3a0d 0a20 2020 2020 2020 2020  != 0:..         
 0002a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7b0: 2020 2020 733d 732e 6d75 6d6d 795f 756e      s=s.mummy_un
-0002a7c0: 6974 0d0a 2020 2020 2020 2020 2020 2020  it..            
+0002a7a0: 2020 2073 3d73 656c 662e 6765 745f 756e     s=self.get_un
+0002a7b0: 6974 2849 443d 6964 782c 2074 7970 653d  it(ID=idx, type=
+0002a7c0: 2249 4422 290d 0a20 2020 2020 2020 2020  "ID")..         
 0002a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7e0: 2020 2020 6966 2073 2069 7320 4e6f 6e65      if s is None
-0002a7f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002a800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a810: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002a820: 7565 4572 726f 7228 2245 7272 6f72 3a20  ueError("Error: 
-0002a830: 7061 7265 6e74 2075 6e69 7420 7265 7475  parent unit retu
-0002a840: 726e 2069 7320 4e6f 6e65 2c20 6869 6572  rn is None, hier
-0002a850: 6172 6368 7920 7265 6c61 7469 6f6e 7320  archy relations 
-0002a860: 6172 6520 696e 636f 6e73 6973 7465 6e74  are inconsistent
-0002a870: 2077 6974 6820 5069 6c65 2061 6e64 2073   with Pile and s
-0002a880: 696d 756c 6174 696f 6e73 2229 0d0a 2020  imulations")..  
-0002a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8a0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-0002a8b0: 6974 735f 646f 6d61 696e 735b 756e 6974  its_domains[unit
-0002a8c0: 735f 646f 6d61 696e 7320 3d3d 2069 6478  s_domains == idx
-0002a8d0: 5d3d 732e 4944 2020 2320 6368 616e 6765  ]=s.ID  # change
-0002a8e0: 2049 4420 7661 6c75 6573 2074 6f20 4d75   ID values to Mu
-0002a8f0: 6d6d 7920 4944 0d0a 2020 2020 2020 2020  mmy ID..        
-0002a900: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-0002a910: 2020 2020 2020 656c 6966 2066 696c 6c20        elif fill 
-0002a920: 3d3d 2022 636f 6c6f 7222 3a0d 0a20 2020  == "color":..   
-0002a930: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
-0002a940: 7473 5f64 6f6d 6169 6e73 3d6e 702e 7a65  ts_domains=np.ze
-0002a950: 726f 7328 5b6e 7265 616c 2c20 6e7a 2c20  ros([nreal, nz, 
-0002a960: 6e79 2c20 6e78 2c20 345d 2c20 6474 7970  ny, nx, 4], dtyp
-0002a970: 653d 6e70 2e66 6c6f 6174 3332 290d 0a20  e=np.float32).. 
-0002a980: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002a990: 6f72 2075 6e69 7420 696e 2073 656c 662e  or unit in self.
-0002a9a0: 6765 745f 616c 6c5f 756e 6974 7328 293a  get_all_units():
+0002a7e0: 2020 2068 5f6c 6576 3d73 2e67 6574 5f68     h_lev=s.get_h
+0002a7f0: 5f6c 6576 656c 2829 2020 2320 6869 6572  _level()  # hier
+0002a800: 6172 6368 6963 616c 206c 6576 656c 206f  archical level o
+0002a810: 6620 756e 6974 0d0a 2020 2020 2020 2020  f unit..        
+0002a820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a830: 2020 2020 6966 2068 5f6c 6576 203e 2068      if h_lev > h
+0002a840: 5f6c 6576 656c 3a20 2023 2063 6f6d 7061  _level:  # compa
+0002a850: 7265 2075 6e69 7420 6c65 7665 6c20 7769  re unit level wi
+0002a860: 7468 206c 6576 656c 2074 6f20 706c 6f74  th level to plot
+0002a870: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a890: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0002a8a0: 2868 5f6c 6576 202d 2068 5f6c 6576 656c  (h_lev - h_level
+0002a8b0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0002a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a8d0: 2020 2020 2020 2020 733d 732e 6d75 6d6d          s=s.mumm
+0002a8e0: 795f 756e 6974 0d0a 2020 2020 2020 2020  y_unit..        
+0002a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a900: 2020 2020 2020 2020 6966 2073 2069 7320          if s is 
+0002a910: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a930: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0002a940: 2056 616c 7565 4572 726f 7228 2245 7272   ValueError("Err
+0002a950: 6f72 3a20 7061 7265 6e74 2075 6e69 7420  or: parent unit 
+0002a960: 7265 7475 726e 2069 7320 4e6f 6e65 2c20  return is None, 
+0002a970: 6869 6572 6172 6368 7920 7265 6c61 7469  hierarchy relati
+0002a980: 6f6e 7320 6172 6520 696e 636f 6e73 6973  ons are inconsis
+0002a990: 7465 6e74 2077 6974 6820 5069 6c65 2061  tent with Pile a
+0002a9a0: 6e64 2073 696d 756c 6174 696f 6e73 2229  nd simulations")
 0002a9b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002a9c0: 2020 2020 2020 6966 2075 6e69 742e 665f        if unit.f_
-0002a9d0: 6d65 7468 6f64 2021 3d20 2253 7562 7069  method != "Subpi
-0002a9e0: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
-0002a9f0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0002aa00: 736b 3d28 7564 203d 3d20 756e 6974 2e49  sk=(ud == unit.I
-0002aa10: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-0002aa20: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0002aa30: 735f 646f 6d61 696e 735b 6d61 736b 2c3a  s_domains[mask,:
-0002aa40: 205d 3d6d 6174 706c 6f74 6c69 622e 636f   ]=matplotlib.co
-0002aa50: 6c6f 7273 2e74 6f5f 7267 6261 2875 6e69  lors.to_rgba(uni
-0002aa60: 742e 6329 0d0a 0d0a 2020 2020 2020 2020  t.c)....        
-0002aa70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0002aa80: 2020 2069 6620 7365 6c66 2e77 7269 7465     if self.write
-0002aa90: 5f72 6573 756c 7473 3a0d 0a20 2020 2020  _results:..     
-0002aaa0: 2020 2020 2020 2020 2020 2066 6e61 6d65             fname
-0002aab0: 3d73 656c 662e 6e61 6d65 2b22 5f7b 7d2e  =self.name+"_{}.
-0002aac0: 7564 222e 666f 726d 6174 2869 7529 0d0a  ud".format(iu)..
-0002aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aae0: 6670 6174 683d 6f73 2e70 6174 682e 6a6f  fpath=os.path.jo
-0002aaf0: 696e 2873 656c 662e 7773 2c20 666e 616d  in(self.ws, fnam
-0002ab00: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0002ab10: 2020 2020 7769 7468 206f 7065 6e28 6670      with open(fp
-0002ab20: 6174 682c 2022 7262 2229 2061 7320 663a  ath, "rb") as f:
-0002ab30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ab40: 2020 2020 2020 7564 3d70 6963 6b6c 652e        ud=pickle.
-0002ab50: 6c6f 6164 2866 290d 0a20 2020 2020 2020  load(f)..       
-0002ab60: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002ab70: 2020 2020 2020 2020 2020 2020 7564 3d73              ud=s
-0002ab80: 656c 662e 4765 6f6c 2e75 6e69 7473 5f64  elf.Geol.units_d
-0002ab90: 6f6d 6169 6e73 2e63 6f70 7928 295b 6975  omains.copy()[iu
-0002aba0: 5d0d 0a0d 0a20 2020 2020 2020 2020 2020  ]....           
-0002abb0: 2069 6620 6669 6c6c 203d 3d20 2249 4422   if fill == "ID"
-0002abc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002abd0: 2020 2075 6e69 7473 5f64 6f6d 6169 6e73     units_domains
-0002abe0: 3d75 640d 0a20 2020 2020 2020 2020 2020  =ud..           
-0002abf0: 2020 2020 2069 6620 685f 6c65 7665 6c20       if h_level 
-0002ac00: 3d3d 2022 616c 6c22 3a0d 0a20 2020 2020  == "all":..     
-0002ac10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002ac20: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-0002ac30: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-0002ac40: 616e 6365 2868 5f6c 6576 656c 2c20 696e  ance(h_level, in
-0002ac50: 7429 2061 6e64 2068 5f6c 6576 656c 203e  t) and h_level >
-0002ac60: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-0002ac70: 2020 2020 2020 2020 206c 7374 5f49 443d           lst_ID=
-0002ac80: 6e70 2e75 6e69 7175 6528 756e 6974 735f  np.unique(units_
-0002ac90: 646f 6d61 696e 7329 0d0a 2020 2020 2020  domains)..      
-0002aca0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0002acb0: 7220 6964 7820 696e 206c 7374 5f49 443a  r idx in lst_ID:
-0002acc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002acd0: 2020 2020 2020 2020 2020 6966 2069 6478            if idx
-0002ace0: 2021 3d20 303a 0d0a 2020 2020 2020 2020   != 0:..        
-0002acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad00: 2020 2020 733d 7365 6c66 2e67 6574 5f75      s=self.get_u
-0002ad10: 6e69 7428 4944 3d69 6478 2c20 7479 7065  nit(ID=idx, type
-0002ad20: 3d22 4944 2229 0d0a 2020 2020 2020 2020  ="ID")..        
+0002a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a9d0: 2020 756e 6974 735f 646f 6d61 696e 735b    units_domains[
+0002a9e0: 756e 6974 735f 646f 6d61 696e 7320 3d3d  units_domains ==
+0002a9f0: 2069 6478 5d3d 732e 4944 2020 2320 6368   idx]=s.ID  # ch
+0002aa00: 616e 6765 2049 4420 7661 6c75 6573 2074  ange ID values t
+0002aa10: 6f20 4d75 6d6d 7920 4944 0d0a 2020 2020  o Mummy ID..    
+0002aa20: 2020 2020 2020 2020 2020 2020 0d0a 2020              ..  
+0002aa30: 2020 2020 2020 2020 2020 656c 6966 2066            elif f
+0002aa40: 696c 6c20 3d3d 2022 636f 6c6f 7222 3a0d  ill == "color":.
+0002aa50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002aa60: 2075 6e69 7473 5f64 6f6d 6169 6e73 3d6e   units_domains=n
+0002aa70: 702e 7a65 726f 7328 5b6e 7265 616c 2c20  p.zeros([nreal, 
+0002aa80: 6e7a 2c20 6e79 2c20 6e78 2c20 345d 2c20  nz, ny, nx, 4], 
+0002aa90: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
+0002aaa0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002aab0: 2020 2066 6f72 2075 6e69 7420 696e 2073     for unit in s
+0002aac0: 656c 662e 6765 745f 616c 6c5f 756e 6974  elf.get_all_unit
+0002aad0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
+0002aae0: 2020 2020 2020 2020 2020 6966 2075 6e69            if uni
+0002aaf0: 742e 665f 6d65 7468 6f64 2021 3d20 2253  t.f_method != "S
+0002ab00: 7562 7069 6c65 223a 0d0a 2020 2020 2020  ubpile":..      
+0002ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab20: 2020 6d61 736b 3d28 7564 203d 3d20 756e    mask=(ud == un
+0002ab30: 6974 2e49 4429 0d0a 2020 2020 2020 2020  it.ID)..        
+0002ab40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab50: 756e 6974 735f 646f 6d61 696e 735b 6d61  units_domains[ma
+0002ab60: 736b 2c3a 205d 3d6d 6174 706c 6f74 6c69  sk,: ]=matplotli
+0002ab70: 622e 636f 6c6f 7273 2e74 6f5f 7267 6261  b.colors.to_rgba
+0002ab80: 2875 6e69 742e 6329 0d0a 0d0a 2020 2020  (unit.c)....    
+0002ab90: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002aba0: 2020 2020 2020 2069 6620 7365 6c66 2e77         if self.w
+0002abb0: 7269 7465 5f72 6573 756c 7473 3a0d 0a20  rite_results:.. 
+0002abc0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002abd0: 6e61 6d65 3d73 656c 662e 6e61 6d65 2b22  name=self.name+"
+0002abe0: 5f7b 7d2e 7564 222e 666f 726d 6174 2869  _{}.ud".format(i
+0002abf0: 7529 0d0a 2020 2020 2020 2020 2020 2020  u)..            
+0002ac00: 2020 2020 6670 6174 683d 6f73 2e70 6174      fpath=os.pat
+0002ac10: 682e 6a6f 696e 2873 656c 662e 7773 2c20  h.join(self.ws, 
+0002ac20: 666e 616d 6529 0d0a 2020 2020 2020 2020  fname)..        
+0002ac30: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+0002ac40: 6e28 6670 6174 682c 2022 7262 2229 2061  n(fpath, "rb") a
+0002ac50: 7320 663a 0d0a 2020 2020 2020 2020 2020  s f:..          
+0002ac60: 2020 2020 2020 2020 2020 7564 3d70 6963            ud=pic
+0002ac70: 6b6c 652e 6c6f 6164 2866 290d 0a20 2020  kle.load(f)..   
+0002ac80: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0002ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aca0: 7564 3d73 656c 662e 4765 6f6c 2e75 6e69  ud=self.Geol.uni
+0002acb0: 7473 5f64 6f6d 6169 6e73 2e63 6f70 7928  ts_domains.copy(
+0002acc0: 295b 6975 5d0d 0a0d 0a20 2020 2020 2020  )[iu]....       
+0002acd0: 2020 2020 2069 6620 6669 6c6c 203d 3d20       if fill == 
+0002ace0: 2249 4422 3a0d 0a20 2020 2020 2020 2020  "ID":..         
+0002acf0: 2020 2020 2020 2075 6e69 7473 5f64 6f6d         units_dom
+0002ad00: 6169 6e73 3d75 640d 0a20 2020 2020 2020  ains=ud..       
+0002ad10: 2020 2020 2020 2020 2069 6620 685f 6c65           if h_le
+0002ad20: 7665 6c20 3d3d 2022 616c 6c22 3a0d 0a20  vel == "all":.. 
 0002ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad40: 2020 2020 685f 6c65 763d 732e 6765 745f      h_lev=s.get_
-0002ad50: 685f 6c65 7665 6c28 2920 2023 2068 6965  h_level()  # hie
-0002ad60: 7261 7263 6869 6361 6c20 6c65 7665 6c20  rarchical level 
-0002ad70: 6f66 2075 6e69 740d 0a20 2020 2020 2020  of unit..       
-0002ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad90: 2020 2020 2069 6620 685f 6c65 7620 3e20       if h_lev > 
-0002ada0: 685f 6c65 7665 6c3a 2020 2320 636f 6d70  h_level:  # comp
-0002adb0: 6172 6520 756e 6974 206c 6576 656c 2077  are unit level w
-0002adc0: 6974 6820 6c65 7665 6c20 746f 2070 6c6f  ith level to plo
-0002add0: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
-0002ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002adf0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0002ae00: 6528 685f 6c65 7620 2d20 685f 6c65 7665  e(h_lev - h_leve
-0002ae10: 6c29 3a0d 0a20 2020 2020 2020 2020 2020  l):..           
-0002ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae30: 2020 2020 2020 2020 2073 3d73 2e6d 756d           s=s.mum
-0002ae40: 6d79 5f75 6e69 740d 0a20 2020 2020 2020  my_unit..       
+0002ad40: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
+0002ad50: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
+0002ad60: 696e 7374 616e 6365 2868 5f6c 6576 656c  instance(h_level
+0002ad70: 2c20 696e 7429 2061 6e64 2068 5f6c 6576  , int) and h_lev
+0002ad80: 656c 203e 2030 3a0d 0a20 2020 2020 2020  el > 0:..       
+0002ad90: 2020 2020 2020 2020 2020 2020 206c 7374               lst
+0002ada0: 5f49 443d 6e70 2e75 6e69 7175 6528 756e  _ID=np.unique(un
+0002adb0: 6974 735f 646f 6d61 696e 7329 0d0a 2020  its_domains)..  
+0002adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002add0: 2020 666f 7220 6964 7820 696e 206c 7374    for idx in lst
+0002ade0: 5f49 443a 0d0a 2020 2020 2020 2020 2020  _ID:..          
+0002adf0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002ae00: 2069 6478 2021 3d20 303a 0d0a 2020 2020   idx != 0:..    
+0002ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ae20: 2020 2020 2020 2020 733d 7365 6c66 2e67          s=self.g
+0002ae30: 6574 5f75 6e69 7428 4944 3d69 6478 2c20  et_unit(ID=idx, 
+0002ae40: 7479 7065 3d22 4944 2229 0d0a 2020 2020  type="ID")..    
 0002ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae60: 2020 2020 2020 2020 2069 6620 7320 6973           if s is
-0002ae70: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0002ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae90: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002aea0: 6520 5661 6c75 6545 7272 6f72 2822 4572  e ValueError("Er
-0002aeb0: 726f 723a 2070 6172 656e 7420 756e 6974  ror: parent unit
-0002aec0: 2072 6574 7572 6e20 6973 204e 6f6e 652c   return is None,
-0002aed0: 2068 6965 7261 7263 6879 2072 656c 6174   hierarchy relat
-0002aee0: 696f 6e73 2061 7265 2069 6e63 6f6e 7369  ions are inconsi
-0002aef0: 7374 656e 7420 7769 7468 2050 696c 6520  stent with Pile 
-0002af00: 616e 6420 7369 6d75 6c61 7469 6f6e 7322  and simulations"
-0002af10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002af20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002af30: 2020 2075 6e69 7473 5f64 6f6d 6169 6e73     units_domains
-0002af40: 5b75 6e69 7473 5f64 6f6d 6169 6e73 203d  [units_domains =
-0002af50: 3d20 6964 785d 3d73 2e49 4420 2023 2063  = idx]=s.ID  # c
-0002af60: 6861 6e67 6520 4944 2076 616c 7565 7320  hange ID values 
-0002af70: 746f 204d 756d 6d79 2049 440d 0a0d 0a0d  to Mummy ID.....
-0002af80: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0002af90: 6620 6669 6c6c 203d 3d20 2263 6f6c 6f72  f fill == "color
-0002afa0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0002afb0: 2020 2020 6e7a 2c20 6e79 2c20 6e78 3d75      nz, ny, nx=u
-0002afc0: 642e 7368 6170 650d 0a20 2020 2020 2020  d.shape..       
-0002afd0: 2020 2020 2020 2020 2075 6e69 7473 5f64           units_d
-0002afe0: 6f6d 6169 6e73 3d6e 702e 7a65 726f 7328  omains=np.zeros(
-0002aff0: 5b6e 7a2c 206e 792c 206e 782c 2034 5d29  [nz, ny, nx, 4])
-0002b000: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b010: 2020 666f 7220 756e 6974 2069 6e20 7365    for unit in se
-0002b020: 6c66 2e67 6574 5f61 6c6c 5f75 6e69 7473  lf.get_all_units
-0002b030: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
-0002b040: 2020 2020 2020 2020 2069 6620 756e 6974           if unit
-0002b050: 2e66 5f6d 6574 686f 6420 213d 2022 5375  .f_method != "Su
-0002b060: 6270 696c 6522 3a0d 0a20 2020 2020 2020  bpile":..       
-0002b070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b080: 206d 6173 6b3d 2875 6420 3d3d 2075 6e69   mask=(ud == uni
-0002b090: 742e 4944 290d 0a20 2020 2020 2020 2020  t.ID)..         
-0002b0a0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0002b0b0: 6e69 7473 5f64 6f6d 6169 6e73 5b6d 6173  nits_domains[mas
-0002b0c0: 6b2c 3a20 5d3d 6d61 7470 6c6f 746c 6962  k,: ]=matplotlib
-0002b0d0: 2e63 6f6c 6f72 732e 746f 5f72 6762 6128  .colors.to_rgba(
-0002b0e0: 756e 6974 2e63 290d 0a0d 0a20 2020 2020  unit.c)....     
-0002b0f0: 2020 2072 6574 7572 6e20 756e 6974 735f     return units_
-0002b100: 646f 6d61 696e 730d 0a0d 0a0d 0a20 2020  domains......   
-0002b110: 2064 6566 2070 6c6f 745f 756e 6974 7328   def plot_units(
-0002b120: 7365 6c66 2c20 6975 3d30 2c20 765f 6578  self, iu=0, v_ex
-0002b130: 3d31 2c20 706c 6f74 7465 723d 4e6f 6e65  =1, plotter=None
-0002b140: 2c20 685f 6c65 7665 6c3d 2261 6c6c 222c  , h_level="all",
-0002b150: 2073 6c69 6365 783d 4e6f 6e65 2c20 736c   slicex=None, sl
-0002b160: 6963 6579 3d4e 6f6e 652c 2073 6c69 6365  icey=None, slice
-0002b170: 7a3d 4e6f 6e65 2c0d 0a20 2020 2020 2020  z=None,..       
-0002b180: 2020 2020 2020 2020 2020 2020 6578 636c              excl
-0002b190: 7564 6564 5661 6c3d 4e6f 6e65 2c0d 0a20  udedVal=None,.. 
-0002b1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b1b0: 2020 2073 6361 6c61 725f 6261 725f 6b77     scalar_bar_kw
-0002b1c0: 6172 6773 3d4e 6f6e 652c 2073 686f 775f  args=None, show_
-0002b1d0: 7363 616c 6172 5f62 6172 3d54 7275 652c  scalar_bar=True,
-0002b1e0: 202a 2a6b 7761 7267 7329 3a0d 0a0d 0a20   **kwargs):.... 
-0002b1f0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0002b200: 2020 2020 706c 6f74 2075 6e69 7473 2064      plot units d
-0002b210: 6f6d 6169 6e20 666f 7220 6120 7370 6563  omain for a spec
-0002b220: 6966 6963 2072 6561 6c69 7a61 7469 6f6e  ific realization
-0002b230: 2069 750d 0a0d 0a20 2020 2020 2020 2050   iu....        P
-0002b240: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0002b250: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0002b260: 2020 2020 2020 2069 753a 2069 6e74 0d0a         iu: int..
-0002b270: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-0002b280: 2069 6e64 6578 2074 6f20 706c 6f74 0d0a   index to plot..
-0002b290: 2020 2020 2020 2020 765f 6578 3a20 666c          v_ex: fl
-0002b2a0: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
-0002b2b0: 2076 6572 7469 6361 6c20 6578 6167 6572   vertical exager
-0002b2c0: 6174 696f 6e0d 0a20 2020 2020 2020 2070  ation..        p
-0002b2d0: 6c6f 7474 6572 3a20 7079 7669 7374 612e  lotter: pyvista.
-0002b2e0: 506c 6f74 7465 720d 0a20 2020 2020 2020  Plotter..       
-0002b2f0: 2020 2020 2070 7976 6973 7461 2e50 6c6f       pyvista.Plo
-0002b300: 7474 6572 206f 626a 6563 7420 746f 2070  tter object to p
-0002b310: 6c6f 7420 6f6e 0d0a 2020 2020 2020 2020  lot on..        
-0002b320: 685f 6c65 7665 6c3a 2073 7472 696e 6720  h_level: string 
-0002b330: 6f72 2069 6e74 0d0a 2020 2020 2020 2020  or int..        
-0002b340: 2020 2020 6869 6572 6172 6368 6963 616c      hierarchical
-0002b350: 206c 6576 656c 2074 6f20 706c 6f74 2e0d   level to plot..
-0002b360: 0a20 2020 2020 2020 2020 2020 2041 2076  .            A v
-0002b370: 616c 7565 206f 6620 3120 696e 6469 6361  alue of 1 indica
-0002b380: 7465 7320 7468 6174 206f 6e6c 7920 756e  tes that only un
-0002b390: 6974 206f 6620 7468 650d 0a20 2020 2020  it of the..     
-0002b3a0: 2020 2020 2020 206d 6173 7465 7220 7069         master pi
-0002b3b0: 6c65 2077 696c 6c20 6265 2070 6c6f 7474  le will be plott
-0002b3c0: 6564 2e20 2261 6c6c 2220 746f 2070 6c6f  ed. "all" to plo
-0002b3d0: 7420 616c 6c20 706f 7373 6962 6c65 2075  t all possible u
-0002b3e0: 6e69 7473 0d0a 2020 2020 2020 2020 736c  nits..        sl
-0002b3f0: 6963 6578 3a20 666c 6f61 7420 6f72 2073  icex: float or s
-0002b400: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
-0002b410: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
-0002b420: 7261 6374 696f 6e20 6f66 2078 2061 7869  raction of x axi
-0002b430: 7320 7768 6572 6520 746f 2073 6c69 6365  s where to slice
-0002b440: 0d0a 2020 2020 2020 2020 736c 6963 6579  ..        slicey
-0002b450: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
-0002b460: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
-0002b470: 2020 2020 2020 2020 2020 2066 7261 6374             fract
-0002b480: 696f 6e20 6f66 2079 2061 7869 7320 7768  ion of y axis wh
-0002b490: 6572 6520 746f 2073 6c69 6365 0d0a 2020  ere to slice..  
-0002b4a0: 2020 2020 2020 736c 6963 657a 3a20 666c        slicez: fl
-0002b4b0: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
-0002b4c0: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
-0002b4d0: 2020 2020 2020 2066 7261 6374 696f 6e20         fraction 
-0002b4e0: 6f66 207a 2061 7869 7320 7768 6572 6520  of z axis where 
-0002b4f0: 746f 2073 6c69 6365 0d0a 2020 2020 2020  to slice..      
-0002b500: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
-0002b510: 7267 733a 2064 6963 740d 0a20 2020 2020  rgs: dict..     
-0002b520: 2020 2020 2020 206b 7761 7267 7320 746f         kwargs to
-0002b530: 2070 6173 7320 746f 2074 6865 2073 6361   pass to the sca
-0002b540: 6c61 7220 6261 720d 0a20 2020 2020 2020  lar bar..       
-0002b550: 2073 686f 775f 7363 616c 6172 5f62 6172   show_scalar_bar
-0002b560: 3a20 626f 6f6c 0d0a 2020 2020 2020 2020  : bool..        
-0002b570: 2020 2020 7368 6f77 2073 6361 6c61 7220      show scalar 
-0002b580: 6261 7220 6f72 206e 6f74 200d 0a20 2020  bar or not ..   
-0002b590: 2020 2020 206b 7761 7267 733a 6469 6374       kwargs:dict
-0002b5a0: 0d0a 2020 2020 2020 2020 2020 2020 6b77  ..            kw
-0002b5b0: 6172 6773 2074 6f20 7061 7373 2074 6f20  args to pass to 
-0002b5c0: 6765 6f6e 652e 696d 6770 6c6f 742e 6472  geone.imgplot.dr
-0002b5d0: 6177 496d 6167 6533 445f 736c 6963 6520  awImage3D_slice 
-0002b5e0: 6f72 2067 656f 6e65 2e69 6d67 706c 6f74  or geone.imgplot
-0002b5f0: 2e64 7261 7749 6d61 6765 3344 5f73 7572  .drawImage3D_sur
-0002b600: 6661 6365 2020 2020 2020 2020 200d 0a20  face         .. 
-0002b610: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-0002b620: 2020 2020 2020 2365 6e73 7572 6520 6869        #ensure hi
-0002b630: 6572 6172 6368 795f 7265 6c61 7469 6f6e  erarchy_relation
-0002b640: 7320 6861 7665 2062 6565 6e20 7365 740d  s have been set.
-0002b650: 0a20 2020 2020 2020 2073 656c 662e 6869  .        self.hi
-0002b660: 6572 6172 6368 795f 7265 6c61 7469 6f6e  erarchy_relation
-0002b670: 7328 7662 3d30 290d 0a0d 0a20 2020 2020  s(vb=0)....     
-0002b680: 2020 2063 6f6c 6f72 733d 5b5d 0d0a 2020     colors=[]..  
-0002b690: 2020 2020 2020 643d 7b7d 0d0a 2020 2020        d={}..    
-0002b6a0: 2020 2020 6e78 3d73 656c 662e 6765 745f      nx=self.get_
-0002b6b0: 6e78 2829 0d0a 2020 2020 2020 2020 6e79  nx()..        ny
-0002b6c0: 3d73 656c 662e 6765 745f 6e79 2829 0d0a  =self.get_ny()..
-0002b6d0: 2020 2020 2020 2020 6e7a 3d73 656c 662e          nz=self.
-0002b6e0: 6765 745f 6e7a 2829 0d0a 2020 2020 2020  get_nz()..      
-0002b6f0: 2020 7378 3d73 656c 662e 6765 745f 7378    sx=self.get_sx
-0002b700: 2829 0d0a 2020 2020 2020 2020 7379 3d73  ()..        sy=s
-0002b710: 656c 662e 6765 745f 7379 2829 0d0a 2020  elf.get_sy()..  
-0002b720: 2020 2020 2020 737a 3d73 656c 662e 6765        sz=self.ge
-0002b730: 745f 737a 2829 0d0a 2020 2020 2020 2020  t_sz()..        
-0002b740: 7830 3d73 656c 662e 6765 745f 6f78 2829  x0=self.get_ox()
-0002b750: 0d0a 2020 2020 2020 2020 7930 3d73 656c  ..        y0=sel
-0002b760: 662e 6765 745f 6f79 2829 0d0a 2020 2020  f.get_oy()..    
-0002b770: 2020 2020 7a30 3d73 656c 662e 6765 745f      z0=self.get_
-0002b780: 6f7a 2829 0d0a 0d0a 2020 2020 2020 2020  oz()....        
-0002b790: 7374 7261 7469 735f 646f 6d61 696e 3d73  stratis_domain=s
-0002b7a0: 656c 662e 6765 745f 756e 6974 735f 646f  elf.get_units_do
-0002b7b0: 6d61 696e 735f 7265 616c 697a 6174 696f  mains_realizatio
-0002b7c0: 6e73 2869 753d 6975 2c20 6669 6c6c 3d22  ns(iu=iu, fill="
-0002b7d0: 4944 222c 2068 5f6c 6576 656c 3d68 5f6c  ID", h_level=h_l
-0002b7e0: 6576 656c 292e 6173 7479 7065 286e 702e  evel).astype(np.
-0002b7f0: 666c 6f61 7433 3229 0d0a 2020 2020 2020  float32)..      
-0002b800: 2020 6c73 745f 4944 3d6e 702e 756e 6971    lst_ID=np.uniq
-0002b810: 7565 2873 7472 6174 6973 5f64 6f6d 6169  ue(stratis_domai
-0002b820: 6e29 0d0a 2020 2020 2020 2020 6e65 775f  n)..        new_
-0002b830: 6c73 745f 4944 203d 205b 5d0d 0a20 2020  lst_ID = []..   
-0002b840: 2020 2020 2069 6620 6578 636c 7564 6564       if excluded
-0002b850: 5661 6c20 6973 204e 6f6e 653a 0d0a 2020  Val is None:..  
-0002b860: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
-0002b870: 6564 5661 6c3d 5b5d 0d0a 2020 2020 2020  edVal=[]..      
-0002b880: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0002b890: 6578 636c 7564 6564 5661 6c2c 2069 6e74  excludedVal, int
-0002b8a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002b8b0: 6578 636c 7564 6564 5661 6c3d 5b65 7863  excludedVal=[exc
-0002b8c0: 6c75 6465 6456 616c 5d0d 0a0d 0a20 2020  ludedVal]....   
-0002b8d0: 2020 2020 2023 2320 6368 616e 6765 2076       ## change v
-0002b8e0: 616c 7565 730d 0a20 2020 2020 2020 206e  alues..        n
-0002b8f0: 6577 5f69 643d 310d 0a20 2020 2020 2020  ew_id=1..       
-0002b900: 2066 6f72 2069 2069 6e20 6c73 745f 4944   for i in lst_ID
-0002b910: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0002b920: 6620 6920 213d 2030 3a0d 0a20 2020 2020  f i != 0:..     
-0002b930: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-0002b940: 6e6f 7420 696e 2065 7863 6c75 6465 6456  not in excludedV
-0002b950: 616c 3a0d 0a20 2020 2020 2020 2020 2020  al:..           
-0002b960: 2020 2020 2020 2020 2073 3d73 656c 662e           s=self.
-0002b970: 6765 745f 756e 6974 2849 443d 692c 2074  get_unit(ID=i, t
-0002b980: 7970 653d 2249 4422 290d 0a20 2020 2020  ype="ID")..     
-0002b990: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-0002b9a0: 2073 7472 6174 6973 5f64 6f6d 6169 6e5b   stratis_domain[
-0002b9b0: 7374 7261 7469 735f 646f 6d61 696e 203d  stratis_domain =
-0002b9c0: 3d20 695d 3d6e 6577 5f69 640d 0a20 2020  = i]=new_id..   
-0002b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b9e0: 2063 6f6c 6f72 732e 6170 7065 6e64 2873   colors.append(s
-0002b9f0: 2e63 290d 0a20 2020 2020 2020 2020 2020  .c)..           
-0002ba00: 2020 2020 2020 2020 2064 5b6e 6577 5f69           d[new_i
-0002ba10: 6420 2d20 302e 355d 3d73 2e6e 616d 650d  d - 0.5]=s.name.
-0002ba20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ba30: 2020 2020 206e 6577 5f69 6420 2b3d 2031       new_id += 1
-0002ba40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002ba50: 2020 2020 2020 6e65 775f 6c73 745f 4944        new_lst_ID
-0002ba60: 2e61 7070 656e 6428 6929 0d0a 0d0a 2020  .append(i)....  
-0002ba70: 2020 2020 2020 2370 6c6f 740d 0a20 2020        #plot..   
-0002ba80: 2020 2020 2073 7472 6174 6973 5f64 6f6d       stratis_dom
-0002ba90: 6169 6e5b 7374 7261 7469 735f 646f 6d61  ain[stratis_doma
-0002baa0: 696e 3d3d 305d 3d6e 702e 6e61 6e20 2023  in==0]=np.nan  #
-0002bab0: 2072 656d 6f76 6520 7768 6572 6520 6e6f   remove where no
-0002bac0: 2066 6f72 6d61 7469 6f6e 7320 6172 6520   formations are 
-0002bad0: 7072 6573 656e 740d 0a20 2020 2020 2020  present..       
-0002bae0: 2069 6620 706c 6f74 7465 7220 6973 204e   if plotter is N
-0002baf0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0002bb00: 2020 703d 7076 2e50 6c6f 7474 6572 2829    p=pv.Plotter()
-0002bb10: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0002bb20: 0a20 2020 2020 2020 2020 2020 2070 3d70  .            p=p
-0002bb30: 6c6f 7474 6572 0d0a 0d0a 2020 2020 2020  lotter....      
-0002bb40: 2020 696d 3d67 656f 6e65 2e69 6d67 2e49    im=geone.img.I
-0002bb50: 6d67 286e 782c 206e 792c 206e 7a2c 2073  mg(nx, ny, nz, s
-0002bb60: 782c 2073 792c 2073 7a2a 765f 6578 2c20  x, sy, sz*v_ex, 
-0002bb70: 7830 2c20 7930 2c20 7a30 2c20 6e76 3d31  x0, y0, z0, nv=1
-0002bb80: 2c20 7661 6c3d 7374 7261 7469 735f 646f  , val=stratis_do
-0002bb90: 6d61 696e 2c20 7661 726e 616d 653d 2255  main, varname="U
-0002bba0: 6e69 7473 2229 0d0a 0d0a 2020 2020 2020  nits")....      
-0002bbb0: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
-0002bbc0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0002bbd0: 2020 2020 2020 736c 6963 6578 3d6e 702e        slicex=np.
-0002bbe0: 6172 7261 7928 736c 6963 6578 290d 0a20  array(slicex).. 
-0002bbf0: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002bc00: 785b 736c 6963 6578 3c30 5d3d 300d 0a20  x[slicex<0]=0.. 
-0002bc10: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002bc20: 785b 736c 6963 6578 3e31 5d3d 310d 0a20  x[slicex>1]=1.. 
-0002bc30: 2020 2020 2020 2020 2020 2063 783d 696d             cx=im
-0002bc40: 2e6f 7820 2b20 736c 6963 6578 202a 2069  .ox + slicex * i
-0002bc50: 6d2e 6e78 202a 2069 6d2e 7378 2020 2320  m.nx * im.sx  # 
-0002bc60: 6365 6e74 6572 2061 6c6f 6e67 2078 0d0a  center along x..
-0002bc70: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002bc80: 2020 2020 2020 2020 2020 2063 783d 4e6f             cx=No
-0002bc90: 6e65 0d0a 2020 2020 2020 2020 6966 2073  ne..        if s
-0002bca0: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
-0002bcb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002bcc0: 736c 6963 6579 3d6e 702e 6172 7261 7928  slicey=np.array(
-0002bcd0: 736c 6963 6579 290d 0a20 2020 2020 2020  slicey)..       
-0002bce0: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002bcf0: 6579 3c30 5d3d 300d 0a20 2020 2020 2020  ey<0]=0..       
-0002bd00: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002bd10: 6579 3e31 5d3d 310d 0a20 2020 2020 2020  ey>1]=1..       
-0002bd20: 2020 2020 2063 793d 696d 2e6f 7920 2b20       cy=im.oy + 
-0002bd30: 736c 6963 6579 202a 2069 6d2e 6e79 202a  slicey * im.ny *
-0002bd40: 2069 6d2e 7379 2020 2320 6365 6e74 6572   im.sy  # center
-0002bd50: 2061 6c6f 6e67 2078 0d0a 2020 2020 2020   along x..      
-0002bd60: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002bd70: 2020 2020 2063 793d 4e6f 6e65 0d0a 2020       cy=None..  
-0002bd80: 2020 2020 2020 6966 2073 6c69 6365 7a20        if slicez 
-0002bd90: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0002bda0: 2020 2020 2020 2020 2020 736c 6963 657a            slicez
-0002bdb0: 3d6e 702e 6172 7261 7928 736c 6963 657a  =np.array(slicez
-0002bdc0: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002bdd0: 6c69 6365 7a5b 736c 6963 657a 3c30 5d3d  licez[slicez<0]=
-0002bde0: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-0002bdf0: 6c69 6365 7a5b 736c 6963 657a 3e31 5d3d  licez[slicez>1]=
-0002be00: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
-0002be10: 7a3d 696d 2e6f 7a20 2b20 736c 6963 657a  z=im.oz + slicez
-0002be20: 202a 2069 6d2e 6e7a 202a 2069 6d2e 737a   * im.nz * im.sz
-0002be30: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
-0002be40: 2078 0d0a 2020 2020 2020 2020 656c 7365   x..        else
-0002be50: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-0002be60: 7a3d 4e6f 6e65 0d0a 0d0a 2020 2020 2020  z=None....      
-0002be70: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
-0002be80: 6f74 204e 6f6e 6520 6f72 2073 6c69 6365  ot None or slice
-0002be90: 7920 6973 206e 6f74 204e 6f6e 6520 6f72  y is not None or
-0002bea0: 2073 6c69 6365 7a20 6973 206e 6f74 204e   slicez is not N
-0002beb0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0002bec0: 2020 696d 6770 6c74 332e 6472 6177 496d    imgplt3.drawIm
-0002bed0: 6167 6533 445f 736c 6963 6528 696d 2c20  age3D_slice(im, 
-0002bee0: 706c 6f74 7465 723d 702c 2073 6c69 6365  plotter=p, slice
-0002bef0: 5f6e 6f72 6d61 6c5f 783d 6378 2c20 736c  _normal_x=cx, sl
-0002bf00: 6963 655f 6e6f 726d 616c 5f79 3d63 792c  ice_normal_y=cy,
-0002bf10: 2073 6c69 6365 5f6e 6f72 6d61 6c5f 7a3d   slice_normal_z=
-0002bf20: 637a 2c0d 0a20 2020 2020 2020 2020 2020  cz,..           
-0002bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bf40: 2020 2020 2020 2020 2063 6174 6567 3d54           categ=T
-0002bf50: 7275 652c 2063 6174 6567 5661 6c3d 6e65  rue, categVal=ne
-0002bf60: 775f 6c73 745f 4944 2c20 6361 7465 6743  w_lst_ID, categC
-0002bf70: 6f6c 3d63 6f6c 6f72 732c 2073 6361 6c61  ol=colors, scala
-0002bf80: 725f 6261 725f 616e 6e6f 7461 7469 6f6e  r_bar_annotation
-0002bf90: 733d 642c 0d0a 2020 2020 2020 2020 2020  s=d,..          
-0002bfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bfb0: 2020 2020 2020 2020 2020 7363 616c 6172            scalar
-0002bfc0: 5f62 6172 5f6b 7761 7267 733d 7363 616c  _bar_kwargs=scal
-0002bfd0: 6172 5f62 6172 5f6b 7761 7267 732c 2073  ar_bar_kwargs, s
-0002bfe0: 686f 775f 7363 616c 6172 5f62 6172 203d  how_scalar_bar =
-0002bff0: 2073 686f 775f 7363 616c 6172 5f62 6172   show_scalar_bar
-0002c000: 2c20 2a2a 6b77 6172 6773 290d 0a20 2020  , **kwargs)..   
-0002c010: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002c020: 2020 2020 2020 2020 696d 6770 6c74 332e          imgplt3.
-0002c030: 6472 6177 496d 6167 6533 445f 7375 7266  drawImage3D_surf
-0002c040: 6163 6528 696d 2c20 706c 6f74 7465 723d  ace(im, plotter=
-0002c050: 702c 2063 6174 6567 3d54 7275 652c 2063  p, categ=True, c
-0002c060: 6174 6567 5661 6c3d 6e65 775f 6c73 745f  ategVal=new_lst_
-0002c070: 4944 2c20 6361 7465 6743 6f6c 3d63 6f6c  ID, categCol=col
-0002c080: 6f72 732c 2073 6361 6c61 725f 6261 725f  ors, scalar_bar_
-0002c090: 616e 6e6f 7461 7469 6f6e 733d 642c 0d0a  annotations=d,..
-0002c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c0c0: 2020 2020 2020 2020 7363 616c 6172 5f62          scalar_b
-0002c0d0: 6172 5f6b 7761 7267 733d 7363 616c 6172  ar_kwargs=scalar
-0002c0e0: 5f62 6172 5f6b 7761 7267 732c 2073 686f  _bar_kwargs, sho
-0002c0f0: 775f 7363 616c 6172 5f62 6172 203d 2073  w_scalar_bar = s
-0002c100: 686f 775f 7363 616c 6172 5f62 6172 2c20  how_scalar_bar, 
-0002c110: 2a2a 6b77 6172 6773 290d 0a0d 0a20 2020  **kwargs)....   
-0002c120: 2020 2020 2069 6620 706c 6f74 7465 7220       if plotter 
-0002c130: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-0002c140: 2020 2020 2020 702e 6164 645f 626f 756e        p.add_boun
-0002c150: 6469 6e67 5f62 6f78 2829 0d0a 2020 2020  ding_box()..    
-0002c160: 2020 2020 2020 2020 702e 7368 6f77 5f61          p.show_a
-0002c170: 7865 7328 290d 0a20 2020 2020 2020 2020  xes()..         
-0002c180: 2020 2070 2e73 686f 7728 290d 0a0d 0a0d     p.show().....
-0002c190: 0a20 2020 2064 6566 2070 6c6f 745f 7072  .    def plot_pr
-0002c1a0: 6f62 6128 7365 6c66 2c20 6f62 6a2c 2076  oba(self, obj, v
-0002c1b0: 5f65 783d 312c 2070 6c6f 7474 6572 3d4e  _ex=1, plotter=N
-0002c1c0: 6f6e 652c 2066 696c 7465 7269 6e67 5f69  one, filtering_i
-0002c1d0: 6e74 6572 7661 6c3d 5b30 2e30 312c 2031  nterval=[0.01, 1
-0002c1e0: 2e30 305d 2c0d 0a20 2020 2020 2020 2020  .00],..         
-0002c1f0: 2020 2020 2020 2020 2020 736c 6963 6578            slicex
-0002c200: 3d4e 6f6e 652c 2073 6c69 6365 793d 4e6f  =None, slicey=No
-0002c210: 6e65 2c20 736c 6963 657a 3d4e 6f6e 652c  ne, slicez=None,
-0002c220: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002c230: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
-0002c240: 6b77 6172 6773 3d4e 6f6e 652c 2065 7863  kwargs=None, exc
-0002c250: 6c75 6465 6456 616c 3d4e 6f6e 652c 202a  ludedVal=None, *
-0002c260: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
-0002c270: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0002c280: 2020 506c 6f74 2074 6865 2070 726f 6261    Plot the proba
-0002c290: 6269 6c69 7479 206f 6620 6f63 6375 7265  bility of occure
-0002c2a0: 6e63 6520 6f66 2061 2073 7065 6369 6669  nce of a specifi
-0002c2b0: 6320 756e 6974 206f 7220 6661 6369 6573  c unit or facies
-0002c2c0: 0d0a 2020 2020 2020 2020 2863 616e 2062  ..        (can b
-0002c2d0: 6520 7061 7373 6564 2062 7920 6120 6e61  e passed by a na
-0002c2e0: 6d65 206f 7220 7468 6520 6f62 6a65 6374  me or the object
-0002c2f0: 2064 6972 6563 746c 7929 0d0a 0d0a 2020   directly)....  
-0002c300: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0002c310: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0002c320: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6f62  ----..        ob
-0002c330: 6a3a 203a 636c 6173 733a 6055 6e69 7460  j: :class:`Unit`
-0002c340: 206f 7220 3a63 6c61 7373 3a60 4661 6369   or :class:`Faci
-0002c350: 6573 6020 6f72 2073 7472 0d0a 2020 2020  es` or str..    
-0002c360: 2020 2020 2020 2020 756e 6974 206f 7220          unit or 
-0002c370: 6661 6369 6573 206f 626a 6563 7420 6f72  facies object or
-0002c380: 2073 7472 696e 6720 6e61 6d65 206f 6620   string name of 
-0002c390: 7468 6520 756e 6974 2f66 6163 6965 730d  the unit/facies.
-0002c3a0: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
-0002c3b0: 706c 6f74 2074 6865 2070 726f 6261 6269  plot the probabi
-0002c3c0: 6c69 7479 206f 6620 6f63 6375 7265 6e63  lity of occurenc
-0002c3d0: 650d 0a20 2020 2020 2020 2076 5f65 783a  e..        v_ex:
-0002c3e0: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-0002c3f0: 2020 2020 7665 7274 6963 616c 2065 7861      vertical exa
-0002c400: 6765 7261 7469 6f6e 2c20 6465 6661 756c  geration, defaul
-0002c410: 7420 6973 2031 0d0a 2020 2020 2020 2020  t is 1..        
-0002c420: 706c 6f74 7465 723a 2070 7976 6973 7461  plotter: pyvista
-0002c430: 2e50 6c6f 7474 6572 0d0a 2020 2020 2020  .Plotter..      
-0002c440: 2020 2020 2020 7079 7669 7374 612e 506c        pyvista.Pl
-0002c450: 6f74 7465 7220 6f62 6a65 6374 2074 6f20  otter object to 
-0002c460: 706c 6f74 206f 6e0d 0a20 2020 2020 2020  plot on..       
-0002c470: 2073 6c69 6365 783a 2066 6c6f 6174 206f   slicex: float o
-0002c480: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
-0002c490: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
-0002c4a0: 2020 6672 6163 7469 6f6e 206f 6620 7820    fraction of x 
-0002c4b0: 6178 6973 2077 6865 7265 2074 6f20 736c  axis where to sl
-0002c4c0: 6963 650d 0a20 2020 2020 2020 2073 6c69  ice..        sli
-0002c4d0: 6365 793a 2066 6c6f 6174 206f 7220 7365  cey: float or se
-0002c4e0: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
-0002c4f0: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-0002c500: 6163 7469 6f6e 206f 6620 7920 6178 6973  action of y axis
-0002c510: 2077 6865 7265 2074 6f20 736c 6963 650d   where to slice.
-0002c520: 0a20 2020 2020 2020 2073 6c69 6365 7a3a  .        slicez:
-0002c530: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002c540: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002c550: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
-0002c560: 6f6e 206f 6620 7a20 6178 6973 2077 6865  on of z axis whe
-0002c570: 7265 2074 6f20 736c 6963 650d 0a20 2020  re to slice..   
-0002c580: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
-0002c590: 6b77 6172 6773 3a20 6469 6374 0d0a 2020  kwargs: dict..  
-0002c5a0: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0002c5b0: 2074 6f20 7061 7373 2074 6f20 7468 6520   to pass to the 
-0002c5c0: 7363 616c 6172 2062 6172 0d0a 2020 2020  scalar bar..    
-0002c5d0: 2020 2020 6578 636c 7564 6564 5661 6c3a      excludedVal:
-0002c5e0: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002c5f0: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002c600: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-0002c610: 2074 6f20 6578 636c 7564 6520 6672 6f6d   to exclude from
-0002c620: 2074 6865 2070 6c6f 740d 0a20 2020 2020   the plot..     
-0002c630: 2020 206b 7761 7267 733a 6469 6374 0d0a     kwargs:dict..
-0002c640: 2020 2020 2020 2020 2020 2020 6b77 6172              kwar
-0002c650: 6773 2074 6f20 7061 7373 2074 6f20 6765  gs to pass to ge
-0002c660: 6f6e 652e 696d 6770 6c6f 742e 6472 6177  one.imgplot.draw
-0002c670: 496d 6167 6533 445f 736c 6963 6520 6f72  Image3D_slice or
-0002c680: 2067 656f 6e65 2e69 6d67 706c 6f74 2e64   geone.imgplot.d
-0002c690: 7261 7749 6d61 6765 3344 5f73 7572 6661  rawImage3D_surfa
-0002c6a0: 6365 0d0a 2020 2020 2020 2020 2222 220d  ce..        """.
-0002c6b0: 0a0d 0a20 2020 2020 2020 206e 783d 7365  ...        nx=se
-0002c6c0: 6c66 2e67 6574 5f6e 7828 290d 0a20 2020  lf.get_nx()..   
-0002c6d0: 2020 2020 206e 793d 7365 6c66 2e67 6574       ny=self.get
-0002c6e0: 5f6e 7928 290d 0a20 2020 2020 2020 206e  _ny()..        n
-0002c6f0: 7a3d 7365 6c66 2e67 6574 5f6e 7a28 290d  z=self.get_nz().
-0002c700: 0a20 2020 2020 2020 2073 783d 7365 6c66  .        sx=self
-0002c710: 2e67 6574 5f73 7828 290d 0a20 2020 2020  .get_sx()..     
-0002c720: 2020 2073 793d 7365 6c66 2e67 6574 5f73     sy=self.get_s
-0002c730: 7928 290d 0a20 2020 2020 2020 2073 7a3d  y()..        sz=
-0002c740: 7365 6c66 2e67 6574 5f73 7a28 290d 0a20  self.get_sz().. 
-0002c750: 2020 2020 2020 2078 303d 7365 6c66 2e67         x0=self.g
-0002c760: 6574 5f6f 7828 290d 0a20 2020 2020 2020  et_ox()..       
-0002c770: 2079 303d 7365 6c66 2e67 6574 5f6f 7928   y0=self.get_oy(
-0002c780: 290d 0a20 2020 2020 2020 207a 303d 7365  )..        z0=se
-0002c790: 6c66 2e67 6574 5f6f 7a28 290d 0a0d 0a20  lf.get_oz().... 
-0002c7a0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0002c7b0: 616e 6365 286f 626a 2c20 7374 7229 3a0d  ance(obj, str):.
-0002c7c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002c7d0: 7365 6c66 2e67 6574 5f75 6e69 7428 6f62  self.get_unit(ob
-0002c7e0: 6a2c 2076 623d 3029 2069 7320 6e6f 7420  j, vb=0) is not 
-0002c7f0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002c800: 2020 2020 2020 2075 3d73 656c 662e 6765         u=self.ge
-0002c810: 745f 756e 6974 286f 626a 290d 0a20 2020  t_unit(obj)..   
-0002c820: 2020 2020 2020 2020 2020 2020 2069 3d75               i=u
-0002c830: 2e49 440d 0a20 2020 2020 2020 2020 2020  .ID..           
-0002c840: 2020 2020 2068 6c3d 752e 6765 745f 685f       hl=u.get_h_
-0002c850: 6c65 7665 6c28 290d 0a20 2020 2020 2020  level()..       
-0002c860: 2020 2020 2020 2020 2074 7970 3d22 756e           typ="un
-0002c870: 6974 220d 0a20 2020 2020 2020 2020 2020  it"..           
-0002c880: 2065 6c69 6620 7365 6c66 2e67 6574 5f66   elif self.get_f
-0002c890: 6163 6965 735f 6f62 6a28 6f62 6a2c 2076  acies_obj(obj, v
-0002c8a0: 623d 3029 2069 7320 6e6f 7420 4e6f 6e65  b=0) is not None
-0002c8b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002c8c0: 2020 2066 613d 7365 6c66 2e67 6574 5f66     fa=self.get_f
-0002c8d0: 6163 6965 735f 6f62 6a28 6f62 6a29 0d0a  acies_obj(obj)..
-0002c8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8f0: 693d 6661 2e49 440d 0a20 2020 2020 2020  i=fa.ID..       
-0002c900: 2020 2020 2020 2020 2074 7970 3d22 6661           typ="fa
-0002c910: 6369 6573 220d 0a20 2020 2020 2020 2065  cies"..        e
-0002c920: 6c69 6620 6973 696e 7374 616e 6365 286f  lif isinstance(o
-0002c930: 626a 2c20 556e 6974 293a 0d0a 2020 2020  bj, Unit):..    
-0002c940: 2020 2020 2020 2020 693d 6f62 6a2e 4944          i=obj.ID
-0002c950: 0d0a 2020 2020 2020 2020 2020 2020 686c  ..            hl
-0002c960: 3d6f 626a 2e67 6574 5f68 5f6c 6576 656c  =obj.get_h_level
-0002c970: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0002c980: 7479 703d 2275 6e69 7422 0d0a 2020 2020  typ="unit"..    
-0002c990: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0002c9a0: 6e63 6528 6f62 6a2c 2046 6163 6965 7329  nce(obj, Facies)
-0002c9b0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-0002c9c0: 3d6f 626a 2e49 440d 0a20 2020 2020 2020  =obj.ID..       
-0002c9d0: 2020 2020 2074 7970 3d22 6661 6369 6573       typ="facies
-0002c9e0: 220d 0a20 2020 2020 2020 2065 6c73 653a  "..        else:
-0002c9f0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0002ca00: 6973 6520 5661 6c75 6545 7272 6f72 2028  ise ValueError (
-0002ca10: 2275 6e69 742f 6661 6369 6573 206d 7573  "unit/facies mus
-0002ca20: 7420 6265 2061 2073 7472 696e 6720 6e61  t be a string na
-0002ca30: 6d65 206f 6620 6120 756e 6974 206f 7220  me of a unit or 
-0002ca40: 6120 756e 6974 206f 626a 6563 7420 7468  a unit object th
-0002ca50: 6174 2069 7320 636f 6e74 6169 6e65 6420  at is contained 
-0002ca60: 696e 7369 6465 2074 6865 204d 6173 7465  inside the Maste
-0002ca70: 7220 5069 6c65 2229 0d0a 0d0a 2020 2020  r Pile")....    
-0002ca80: 2020 2020 6966 2074 7970 203d 3d20 2275      if typ == "u
-0002ca90: 6e69 7422 3a0d 0a20 2020 2020 2020 2020  nit":..         
-0002caa0: 2020 2061 7272 3d6e 702e 7a65 726f 7328     arr=np.zeros(
-0002cab0: 5b73 656c 662e 6e7a 2c20 7365 6c66 2e6e  [self.nz, self.n
-0002cac0: 792c 2073 656c 662e 6e78 5d29 0d0a 2020  y, self.nx])..  
-0002cad0: 2020 2020 2020 2020 2020 2320 636f 6d70            # comp
-0002cae0: 7574 6520 7072 6f62 6162 696c 6974 6965  ute probabilitie
-0002caf0: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
-0002cb00: 6f72 2069 7520 696e 2072 616e 6765 2873  or iu in range(s
-0002cb10: 656c 662e 6e72 6561 6c5f 756e 6974 7329  elf.nreal_units)
-0002cb20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002cb30: 2020 2075 6e69 7473 3d73 656c 662e 6765     units=self.ge
-0002cb40: 745f 756e 6974 735f 646f 6d61 696e 735f  t_units_domains_
-0002cb50: 7265 616c 697a 6174 696f 6e73 2869 753d  realizations(iu=
-0002cb60: 6975 2c20 685f 6c65 7665 6c3d 686c 2c20  iu, h_level=hl, 
-0002cb70: 616c 6c5f 6461 7461 3d46 616c 7365 290d  all_data=False).
-0002cb80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cb90: 2061 7272 2b3d 2875 6e69 7473 203d 3d20   arr+=(units == 
-0002cba0: 6929 0d0a 2020 2020 2020 2020 2020 2020  i)..            
-0002cbb0: 6172 722f 3d73 656c 662e 6e72 6561 6c5f  arr/=self.nreal_
-0002cbc0: 756e 6974 730d 0a0d 0a20 2020 2020 2020  units....       
-0002cbd0: 2065 6c69 6620 7479 7020 3d3d 2022 6661   elif typ == "fa
-0002cbe0: 6369 6573 223a 0d0a 2020 2020 2020 2020  cies":..        
-0002cbf0: 2020 2020 6172 723d 6e70 2e7a 6572 6f73      arr=np.zeros
-0002cc00: 285b 7365 6c66 2e6e 7a2c 2073 656c 662e  ([self.nz, self.
-0002cc10: 6e79 2c20 7365 6c66 2e6e 785d 290d 0a20  ny, self.nx]).. 
-0002cc20: 2020 2020 2020 2020 2020 2023 2063 6f6d             # com
-0002cc30: 7075 7465 2070 726f 6261 6269 6c69 7469  pute probabiliti
-0002cc40: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-0002cc50: 666f 7220 6975 2069 6e20 7261 6e67 6528  for iu in range(
-0002cc60: 7365 6c66 2e6e 7265 616c 5f75 6e69 7473  self.nreal_units
-0002cc70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0002cc80: 2020 2020 666f 7220 6966 6120 696e 2072      for ifa in r
-0002cc90: 616e 6765 2873 656c 662e 6e72 6561 6c5f  ange(self.nreal_
-0002cca0: 6661 293a 0d0a 2020 2020 2020 2020 2020  fa):..          
-0002ccb0: 2020 2020 2020 2020 2020 6661 6369 6573            facies
-0002ccc0: 3d73 656c 662e 6765 745f 6661 6369 6573  =self.get_facies
-0002ccd0: 2869 753d 6975 2c20 6966 613d 6966 612c  (iu=iu, ifa=ifa,
-0002cce0: 2061 6c6c 5f64 6174 613d 4661 6c73 6529   all_data=False)
-0002ccf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002cd00: 2020 2020 2020 6172 722b 3d28 6661 6369        arr+=(faci
-0002cd10: 6573 203d 3d20 6929 0d0a 2020 2020 2020  es == i)..      
-0002cd20: 2020 2020 2020 6172 722f 3d28 7365 6c66        arr/=(self
-0002cd30: 2e6e 7265 616c 5f75 6e69 7473 2a73 656c  .nreal_units*sel
-0002cd40: 662e 6e72 6561 6c5f 6661 290d 0a20 2020  f.nreal_fa)..   
-0002cd50: 2020 2020 2069 6d3d 6765 6f6e 652e 696d       im=geone.im
-0002cd60: 672e 496d 6728 6e78 2c20 6e79 2c20 6e7a  g.Img(nx, ny, nz
-0002cd70: 2c20 7378 2c20 7379 2c20 737a 2a76 5f65  , sx, sy, sz*v_e
-0002cd80: 782c 2078 302c 2079 302c 207a 302c 206e  x, x0, y0, z0, n
-0002cd90: 763d 312c 2076 616c 3d61 7272 2c20 7661  v=1, val=arr, va
-0002cda0: 726e 616d 653d 2250 205b 2d5d 2229 2023  rname="P [-]") #
-0002cdb0: 6372 6561 7465 2069 6d67 206f 626a 6563  create img objec
-0002cdc0: 740d 0a0d 0a20 2020 2020 2020 2023 6372  t....        #cr
-0002cdd0: 6561 7465 2073 6c69 6365 730d 0a20 2020  eate slices..   
-0002cde0: 2020 2020 2069 6620 736c 6963 6578 2069       if slicex i
-0002cdf0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0002ce00: 2020 2020 2020 2020 2073 6c69 6365 783d           slicex=
-0002ce10: 6e70 2e61 7272 6179 2873 6c69 6365 7829  np.array(slicex)
-0002ce20: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002ce30: 6963 6578 5b73 6c69 6365 783c 305d 3d30  icex[slicex<0]=0
-0002ce40: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002ce50: 6963 6578 5b73 6c69 6365 783e 315d 3d31  icex[slicex>1]=1
-0002ce60: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
-0002ce70: 3d69 6d2e 6f78 202b 2073 6c69 6365 7820  =im.ox + slicex 
-0002ce80: 2a20 696d 2e6e 7820 2a20 696d 2e73 7820  * im.nx * im.sx 
-0002ce90: 2023 2063 656e 7465 7220 616c 6f6e 6720   # center along 
-0002cea0: 780d 0a20 2020 2020 2020 2065 6c73 653a  x..        else:
-0002ceb0: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
-0002cec0: 3d4e 6f6e 650d 0a20 2020 2020 2020 2069  =None..        i
-0002ced0: 6620 736c 6963 6579 2069 7320 6e6f 7420  f slicey is not 
-0002cee0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002cef0: 2020 2073 6c69 6365 793d 6e70 2e61 7272     slicey=np.arr
-0002cf00: 6179 2873 6c69 6365 7929 0d0a 2020 2020  ay(slicey)..    
-0002cf10: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
-0002cf20: 6c69 6365 793c 305d 3d30 0d0a 2020 2020  licey<0]=0..    
-0002cf30: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
-0002cf40: 6c69 6365 793e 315d 3d31 0d0a 2020 2020  licey>1]=1..    
-0002cf50: 2020 2020 2020 2020 6379 3d69 6d2e 6f79          cy=im.oy
-0002cf60: 202b 2073 6c69 6365 7920 2a20 696d 2e6e   + slicey * im.n
-0002cf70: 7920 2a20 696d 2e73 7920 2023 2063 656e  y * im.sy  # cen
-0002cf80: 7465 7220 616c 6f6e 6720 790d 0a20 2020  ter along y..   
-0002cf90: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002cfa0: 2020 2020 2020 2020 6379 3d4e 6f6e 650d          cy=None.
-0002cfb0: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
-0002cfc0: 657a 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ez is not None:.
-0002cfd0: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-0002cfe0: 6365 7a3d 6e70 2e61 7272 6179 2873 6c69  cez=np.array(sli
-0002cff0: 6365 7a29 0d0a 2020 2020 2020 2020 2020  cez)..          
-0002d000: 2020 736c 6963 657a 5b73 6c69 6365 7a3c    slicez[slicez<
-0002d010: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
-0002d020: 2020 736c 6963 657a 5b73 6c69 6365 7a3e    slicez[slicez>
-0002d030: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
-0002d040: 2020 637a 3d69 6d2e 6f7a 202b 2073 6c69    cz=im.oz + sli
-0002d050: 6365 7a20 2a20 696d 2e6e 7a20 2a20 696d  cez * im.nz * im
-0002d060: 2e73 7a20 2023 2063 656e 7465 7220 616c  .sz  # center al
-0002d070: 6f6e 6720 7a0d 0a20 2020 2020 2020 2065  ong z..        e
-0002d080: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0002d090: 2020 637a 3d4e 6f6e 650d 0a0d 0a20 2020    cz=None....   
-0002d0a0: 2020 2020 2069 6620 6172 722e 616e 7928       if arr.any(
-0002d0b0: 293a 2023 6966 2076 616c 7565 7320 6172  ): #if values ar
-0002d0c0: 6520 666f 756e 640d 0a20 2020 2020 2020  e found..       
-0002d0d0: 2020 2020 200d 0a20 2020 2020 2020 2020       ..         
-0002d0e0: 2020 2023 2066 696c 7465 7220 7661 6c75     # filter valu
-0002d0f0: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-0002d100: 6966 2066 696c 7465 7269 6e67 5f69 6e74  if filtering_int
-0002d110: 6572 7661 6c20 6973 206e 6f74 204e 6f6e  erval is not Non
-0002d120: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002d130: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0002d140: 6528 6669 6c74 6572 696e 675f 696e 7465  e(filtering_inte
-0002d150: 7276 616c 2c20 6c69 7374 293a 0d0a 2020  rval, list):..  
-0002d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d170: 2020 6966 206c 656e 2866 696c 7465 7269    if len(filteri
-0002d180: 6e67 5f69 6e74 6572 7661 6c29 203d 3d20  ng_interval) == 
-0002d190: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-0002d1a0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-0002d1b0: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
-0002d1c0: 6c5b 305d 203c 2066 696c 7465 7269 6e67  l[0] < filtering
-0002d1d0: 5f69 6e74 6572 7661 6c5b 315d 3a0d 0a20  _interval[1]:.. 
-0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d1f0: 2020 2020 2020 2020 2020 2061 7272 5b61             arr[a
-0002d200: 7272 203c 2066 696c 7465 7269 6e67 5f69  rr < filtering_i
-0002d210: 6e74 6572 7661 6c5b 305d 5d20 3d20 6e70  nterval[0]] = np
-0002d220: 2e6e 616e 0d0a 2020 2020 2020 2020 2020  .nan..          
-0002d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d240: 2020 6172 725b 6172 7220 3e20 6669 6c74    arr[arr > filt
-0002d250: 6572 696e 675f 696e 7465 7276 616c 5b31  ering_interval[1
-0002d260: 5d5d 203d 206e 702e 6e61 6e0d 0a20 2020  ]] = np.nan..   
-0002d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d280: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002d290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2a0: 2020 2020 2020 2020 7072 696e 7428 2266          print("f
-0002d2b0: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
-0002d2c0: 6c5b 305d 206d 7573 7420 6265 2073 6d61  l[0] must be sma
-0002d2d0: 6c6c 6572 2074 6861 6e20 6669 6c74 6572  ller than filter
-0002d2e0: 696e 675f 696e 7465 7276 616c 5b31 5d22  ing_interval[1]"
-0002d2f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002d300: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0002d310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d320: 2020 2020 2020 7072 696e 7428 2266 696c        print("fil
-0002d330: 7465 7269 6e67 5f69 6e74 6572 7661 6c20  tering_interval 
-0002d340: 6d75 7374 2062 6520 6120 6c69 7374 206f  must be a list o
-0002d350: 6620 7477 6f20 7661 6c75 6573 2229 0d0a  f two values")..
-0002d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d370: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0002d380: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002d390: 2822 6669 6c74 6572 696e 675f 696e 7465  ("filtering_inte
-0002d3a0: 7276 616c 206d 7573 7420 6265 2061 206c  rval must be a l
-0002d3b0: 6973 7420 6f66 2074 776f 2076 616c 7565  ist of two value
-0002d3c0: 7322 290d 0a0d 0a20 2020 2020 2020 2020  s")....         
-0002d3d0: 2020 2069 6620 706c 6f74 7465 7220 6973     if plotter is
-0002d3e0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0002d3f0: 2020 2020 2020 2020 703d 7076 2e50 6c6f          p=pv.Plo
-0002d400: 7474 6572 2829 0d0a 2020 2020 2020 2020  tter()..        
-0002d410: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0002d420: 2020 2020 2020 2020 2020 2070 3d70 6c6f             p=plo
-0002d430: 7474 6572 0d0a 0d0a 2020 2020 2020 2020  tter....        
-0002d440: 2020 2020 6966 2073 6c69 6365 7820 6973      if slicex is
-0002d450: 206e 6f74 204e 6f6e 6520 6f72 2073 6c69   not None or sli
-0002d460: 6365 7920 6973 206e 6f74 204e 6f6e 6520  cey is not None 
-0002d470: 6f72 2073 6c69 6365 7a20 6973 206e 6f74  or slicez is not
-0002d480: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0002d490: 2020 2020 2020 2020 696d 6770 6c74 332e          imgplt3.
-0002d4a0: 6472 6177 496d 6167 6533 445f 736c 6963  drawImage3D_slic
-0002d4b0: 6528 696d 2c20 706c 6f74 7465 723d 702c  e(im, plotter=p,
-0002d4c0: 2073 6c69 6365 5f6e 6f72 6d61 6c5f 783d   slice_normal_x=
-0002d4d0: 6378 2c20 736c 6963 655f 6e6f 726d 616c  cx, slice_normal
-0002d4e0: 5f79 3d63 792c 2073 6c69 6365 5f6e 6f72  _y=cy, slice_nor
-0002d4f0: 6d61 6c5f 7a3d 637a 2c20 7363 616c 6172  mal_z=cz, scalar
-0002d500: 5f62 6172 5f6b 7761 7267 733d 7363 616c  _bar_kwargs=scal
-0002d510: 6172 5f62 6172 5f6b 7761 7267 732c 2065  ar_bar_kwargs, e
-0002d520: 7863 6c75 6465 6456 616c 3d65 7863 6c75  xcludedVal=exclu
-0002d530: 6465 6456 616c 2c20 2a2a 6b77 6172 6773  dedVal, **kwargs
-0002d540: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0002d550: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0002d560: 2020 2020 2020 696d 6770 6c74 332e 6472        imgplt3.dr
-0002d570: 6177 496d 6167 6533 445f 7375 7266 6163  awImage3D_surfac
-0002d580: 6528 696d 2c20 706c 6f74 7465 723d 702c  e(im, plotter=p,
-0002d590: 2073 6361 6c61 725f 6261 725f 6b77 6172   scalar_bar_kwar
-0002d5a0: 6773 3d73 6361 6c61 725f 6261 725f 6b77  gs=scalar_bar_kw
-0002d5b0: 6172 6773 2c20 6578 636c 7564 6564 5661  args, excludedVa
-0002d5c0: 6c3d 6578 636c 7564 6564 5661 6c2c 2020  l=excludedVal,  
-0002d5d0: 2a2a 6b77 6172 6773 290d 0a0d 0a20 2020  **kwargs)....   
-0002d5e0: 2020 2020 2020 2020 2069 6620 706c 6f74           if plot
-0002d5f0: 7465 7220 6973 204e 6f6e 653a 0d0a 2020  ter is None:..  
-0002d600: 2020 2020 2020 2020 2020 2020 2020 702e                p.
-0002d610: 6164 645f 626f 756e 6469 6e67 5f62 6f78  add_bounding_box
-0002d620: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0002d630: 2020 2020 702e 7368 6f77 5f61 7865 7328      p.show_axes(
-0002d640: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0002d650: 2020 2070 2e73 686f 7728 290d 0a0d 0a20     p.show().... 
-0002d660: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0002d670: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0002d680: 224e 6f20 7661 6c75 6573 2066 6f75 6e64  "No values found
-0002d690: 2066 6f72 2074 6869 7320 756e 6974 2229   for this unit")
-0002d6a0: 0d0a 0d0a 0d0a 2020 2020 6465 6620 706c  ......    def pl
-0002d6b0: 6f74 5f66 6163 6965 7328 7365 6c66 2c20  ot_facies(self, 
-0002d6c0: 6975 3d30 2c20 6966 613d 302c 2076 5f65  iu=0, ifa=0, v_e
-0002d6d0: 783d 312c 2069 6e73 6964 655f 756e 6974  x=1, inside_unit
-0002d6e0: 733d 4e6f 6e65 2c20 6578 636c 7564 6564  s=None, excluded
-0002d6f0: 5661 6c3d 4e6f 6e65 2c0d 0a20 2020 2020  Val=None,..     
-0002d700: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002d710: 6c6f 7474 6572 3d4e 6f6e 652c 2073 6c69  lotter=None, sli
-0002d720: 6365 783d 4e6f 6e65 2c20 736c 6963 6579  cex=None, slicey
-0002d730: 3d4e 6f6e 652c 2073 6c69 6365 7a3d 4e6f  =None, slicez=No
-0002d740: 6e65 2c0d 0a20 2020 2020 2020 2020 2020  ne,..           
-0002d750: 2020 2020 2020 2020 2073 6361 6c61 725f           scalar_
-0002d760: 6261 725f 6b77 6172 6773 3d4e 6f6e 652c  bar_kwargs=None,
-0002d770: 2073 686f 775f 7363 616c 6172 5f62 6172   show_scalar_bar
-0002d780: 3d54 7275 652c 202a 2a6b 7761 7267 7329  =True, **kwargs)
-0002d790: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0002d7a0: 0d0a 2020 2020 2020 2020 506c 6f74 2074  ..        Plot t
-0002d7b0: 6865 2066 6163 6965 7320 7265 616c 697a  he facies realiz
-0002d7c0: 6174 696f 6e73 206f 7665 7220 7468 6520  ations over the 
-0002d7d0: 646f 6d61 696e 2077 6974 6820 7468 6520  domain with the 
-0002d7e0: 636f 6c6f 7273 2061 7474 7269 6275 7465  colors attribute
-0002d7f0: 6420 746f 2066 6163 6965 730d 0a0d 0a20  d to facies.... 
-0002d800: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0002d810: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0002d820: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2069  -----..        i
-0002d830: 753a 2069 6e74 0d0a 2020 2020 2020 2020  u: int..        
-0002d840: 2020 2020 696e 6469 6365 206f 6620 756e      indice of un
-0002d850: 6974 7320 7265 616c 697a 6174 696f 6e0d  its realization.
-0002d860: 0a20 2020 2020 2020 2069 6661 3a20 696e  .        ifa: in
-0002d870: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
-0002d880: 6e64 6963 6520 6f66 2066 6163 6965 7320  ndice of facies 
-0002d890: 7265 616c 7a69 6174 696f 6e0d 0a20 2020  realziation..   
-0002d8a0: 2020 2020 2076 5f65 783a 2069 6e74 206f       v_ex: int o
-0002d8b0: 7220 666c 6f61 740d 0a20 2020 2020 2020  r float..       
-0002d8c0: 2020 2020 2076 6572 7469 6361 6c20 6578       vertical ex
-0002d8d0: 6167 6572 6174 696f 6e0d 0a20 2020 2020  ageration..     
-0002d8e0: 2020 2069 6e73 6964 655f 756e 6974 733a     inside_units:
-0002d8f0: 2061 7272 6179 2d6c 696b 6520 6f66 203a   array-like of :
-0002d900: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
-0002d910: 6563 7473 0d0a 2020 2020 2020 2020 2020  ects..          
-0002d920: 2020 6c69 7374 206f 6620 756e 6974 7320    list of units 
-0002d930: 696e 7369 6465 2077 6869 6368 2077 6520  inside which we 
-0002d940: 7761 6e74 2074 6f20 6861 7665 2074 6865  want to have the
-0002d950: 2070 6c6f 742e 0d0a 2020 2020 2020 2020   plot...        
-0002d960: 2020 2020 6966 204e 6f6e 6520 2d2d 3e20      if None --> 
-0002d970: 616c 6c0d 0a20 2020 2020 2020 2070 6c6f  all..        plo
-0002d980: 7474 6572 3a20 7079 7669 7374 6120 706c  tter: pyvista pl
-0002d990: 6f74 7465 7220 6966 2077 616e 7465 640d  otter if wanted.
-0002d9a0: 0a20 2020 2020 2020 2073 6c69 6365 783a  .        slicex:
-0002d9b0: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
-0002d9c0: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
-0002d9d0: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
-0002d9e0: 6f6e 206f 6620 7820 6178 6973 2077 6865  on of x axis whe
-0002d9f0: 7265 2074 6f20 736c 6963 650d 0a20 2020  re to slice..   
-0002da00: 2020 2020 2073 6c69 6365 793a 2066 6c6f       slicey: flo
-0002da10: 6174 206f 7220 7365 7175 656e 6365 206f  at or sequence o
-0002da20: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
-0002da30: 2020 2020 2020 6672 6163 7469 6f6e 206f        fraction o
-0002da40: 6620 7920 6178 6973 2077 6865 7265 2074  f y axis where t
-0002da50: 6f20 736c 6963 650d 0a20 2020 2020 2020  o slice..       
-0002da60: 2073 6c69 6365 7a3a 2066 6c6f 6174 206f   slicez: float o
-0002da70: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
-0002da80: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
-0002da90: 2020 6672 6163 7469 6f6e 206f 6620 7a20    fraction of z 
-0002daa0: 6178 6973 2077 6865 7265 2074 6f20 736c  axis where to sl
-0002dab0: 6963 650d 0a20 2020 2020 2020 2073 6361  ice..        sca
-0002dac0: 6c61 725f 6261 725f 6b77 6172 6773 3a20  lar_bar_kwargs: 
-0002dad0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
-0002dae0: 2020 6b77 6172 6773 2066 6f72 2074 6865    kwargs for the
-0002daf0: 2073 6361 6c61 7220 6261 720d 0a20 2020   scalar bar..   
-0002db00: 2020 2020 2073 686f 775f 7363 616c 6172       show_scalar
-0002db10: 5f62 6172 3a20 626f 6f6c 0d0a 2020 2020  _bar: bool..    
-0002db20: 2020 2020 2020 2020 6966 2054 7275 652c          if True,
-0002db30: 2073 686f 7720 7468 6520 7363 616c 6172   show the scalar
-0002db40: 2062 6172 0d0a 2020 2020 2020 2020 6b77   bar..        kw
-0002db50: 6172 6773 3a64 6963 740d 0a20 2020 2020  args:dict..     
-0002db60: 2020 2020 2020 206b 7761 7267 7320 746f         kwargs to
-0002db70: 2070 6173 7320 746f 2067 656f 6e65 2e69   pass to geone.i
-0002db80: 6d67 706c 6f74 2e64 7261 7749 6d61 6765  mgplot.drawImage
-0002db90: 3344 5f73 6c69 6365 206f 7220 6765 6f6e  3D_slice or geon
-0002dba0: 652e 696d 6770 6c6f 742e 6472 6177 496d  e.imgplot.drawIm
-0002dbb0: 6167 6533 445f 7375 7266 6163 650d 0a20  age3D_surface.. 
-0002dbc0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-0002dbd0: 2020 2020 2020 6661 5f64 6f6d 6169 6e73        fa_domains
-0002dbe0: 3d73 656c 662e 6765 745f 6661 6369 6573  =self.get_facies
-0002dbf0: 2869 752c 2069 6661 2c20 616c 6c5f 6461  (iu, ifa, all_da
-0002dc00: 7461 3d46 616c 7365 292e 6173 7479 7065  ta=False).astype
-0002dc10: 286e 702e 666c 6f61 7433 3229 0d0a 0d0a  (np.float32)....
-0002dc20: 2020 2020 2020 2020 236b 6565 7020 6661          #keep fa
-0002dc30: 6369 6573 2069 6e20 6f6e 6c79 2077 616e  cies in only wan
-0002dc40: 7465 6420 756e 6974 730d 0a20 2020 2020  ted units..     
-0002dc50: 2020 2069 6620 696e 7369 6465 5f75 6e69     if inside_uni
-0002dc60: 7473 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ts is not None:.
-0002dc70: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-0002dc80: 6b5f 616c 6c3d 6e70 2e7a 6572 6f73 285b  k_all=np.zeros([
-0002dc90: 7365 6c66 2e67 6574 5f6e 7a28 292c 2073  self.get_nz(), s
-0002dca0: 656c 662e 6765 745f 6e79 2829 2c20 7365  elf.get_ny(), se
-0002dcb0: 6c66 2e67 6574 5f6e 7828 295d 290d 0a20  lf.get_nx()]).. 
-0002dcc0: 2020 2020 2020 2020 2020 2066 6f72 2075             for u
-0002dcd0: 2069 6e20 696e 7369 6465 5f75 6e69 7473   in inside_units
-0002dce0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002dcf0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-0002dd00: 2875 2c20 7374 7229 3a0d 0a20 2020 2020  (u, str):..     
-0002dd10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002dd20: 6173 6b3d 7365 6c66 2e75 6e69 745f 6d61  ask=self.unit_ma
-0002dd30: 736b 2875 2c20 6975 3d20 6975 290d 0a20  sk(u, iu= iu).. 
-0002dd40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002dd50: 6c69 6620 6973 696e 7374 616e 6365 2875  lif isinstance(u
-0002dd60: 2c20 556e 6974 2920 616e 6420 7520 696e  , Unit) and u in
-0002dd70: 2073 656c 662e 6765 745f 616c 6c5f 756e   self.get_all_un
-0002dd80: 6974 7328 293a 0d0a 2020 2020 2020 2020  its():..        
-0002dd90: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-0002dda0: 3d73 656c 662e 756e 6974 5f6d 6173 6b28  =self.unit_mask(
-0002ddb0: 752e 6e61 6d65 2c20 6975 3d20 6975 290d  u.name, iu= iu).
-0002ddc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ddd0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0002dde0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0002ddf0: 6520 5661 6c75 6545 7272 6f72 2028 2255  e ValueError ("U
-0002de00: 6e69 7420 7061 7373 6564 2069 6e20 696e  nit passed in in
-0002de10: 7369 6465 5f75 6e69 7473 206d 7573 7420  side_units must 
-0002de20: 6265 2061 2075 6e69 7420 6e61 6d65 206f  be a unit name o
-0002de30: 7220 6120 756e 6974 206f 626a 6563 7420  r a unit object 
-0002de40: 636f 6e74 6169 6e65 6420 696e 2074 6865  contained in the
-0002de50: 2041 7263 6854 6162 6c65 2229 0d0a 2020   ArchTable")..  
-0002de60: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0002de70: 736b 5f61 6c6c 5b6d 6173 6b20 3d3d 2031  sk_all[mask == 1
-0002de80: 5d3d 310d 0a0d 0a20 2020 2020 2020 2020  ]=1....         
-0002de90: 2020 2066 615f 646f 6d61 696e 735b 6d61     fa_domains[ma
-0002dea0: 736b 5f61 6c6c 2021 3d20 315d 3d30 0d0a  sk_all != 1]=0..
-0002deb0: 0d0a 2020 2020 2020 2020 643d 7b7d 0d0a  ..        d={}..
-0002dec0: 2020 2020 2020 2020 636f 6c6f 7273 3d5b          colors=[
-0002ded0: 5d0d 0a20 2020 2020 2020 206e 783d 7365  ]..        nx=se
-0002dee0: 6c66 2e67 6574 5f6e 7828 290d 0a20 2020  lf.get_nx()..   
-0002def0: 2020 2020 206e 793d 7365 6c66 2e67 6574       ny=self.get
-0002df00: 5f6e 7928 290d 0a20 2020 2020 2020 206e  _ny()..        n
-0002df10: 7a3d 7365 6c66 2e67 6574 5f6e 7a28 290d  z=self.get_nz().
-0002df20: 0a20 2020 2020 2020 2073 783d 7365 6c66  .        sx=self
-0002df30: 2e67 6574 5f73 7828 290d 0a20 2020 2020  .get_sx()..     
-0002df40: 2020 2073 793d 7365 6c66 2e67 6574 5f73     sy=self.get_s
-0002df50: 7928 290d 0a20 2020 2020 2020 2073 7a3d  y()..        sz=
-0002df60: 7365 6c66 2e67 6574 5f73 7a28 290d 0a20  self.get_sz().. 
-0002df70: 2020 2020 2020 2078 303d 7365 6c66 2e67         x0=self.g
-0002df80: 6574 5f6f 7828 290d 0a20 2020 2020 2020  et_ox()..       
-0002df90: 2079 303d 7365 6c66 2e67 6574 5f6f 7928   y0=self.get_oy(
-0002dfa0: 290d 0a20 2020 2020 2020 207a 303d 7365  )..        z0=se
-0002dfb0: 6c66 2e67 6574 5f6f 7a28 290d 0a20 2020  lf.get_oz()..   
-0002dfc0: 2020 2020 206c 7374 5f49 443d 6e70 2e75       lst_ID=np.u
-0002dfd0: 6e69 7175 6528 6661 5f64 6f6d 6169 6e73  nique(fa_domains
-0002dfe0: 290d 0a20 2020 2020 2020 206e 6577 5f6c  )..        new_l
-0002dff0: 7374 5f49 4420 3d20 5b5d 0d0a 2020 2020  st_ID = []..    
-0002e000: 2020 2020 6966 2065 7863 6c75 6465 6456      if excludedV
-0002e010: 616c 2069 7320 4e6f 6e65 3a0d 0a20 2020  al is None:..   
-0002e020: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
-0002e030: 6456 616c 3d5b 5d0d 0a20 2020 2020 2020  dVal=[]..       
-0002e040: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-0002e050: 7863 6c75 6465 6456 616c 2c20 696e 7429  xcludedVal, int)
-0002e060: 3a0d 0a20 2020 2020 2020 2020 2020 2065  :..            e
-0002e070: 7863 6c75 6465 6456 616c 3d5b 6578 636c  xcludedVal=[excl
-0002e080: 7564 6564 5661 6c5d 0d0a 0d0a 2020 2020  udedVal]....    
-0002e090: 2020 2020 2323 2063 7265 6174 6520 6120      ## create a 
-0002e0a0: 6469 6374 696f 6e6e 6172 7920 746f 206d  dictionnary to m
-0002e0b0: 6170 2074 6865 2066 6163 6965 7320 4944  ap the facies ID
-0002e0c0: 2074 6f20 7468 6520 6661 6369 6573 206e   to the facies n
-0002e0d0: 616d 650d 0a20 2020 2020 2020 206e 6577  ame..        new
-0002e0e0: 5f69 643d 310d 0a20 2020 2020 2020 2066  _id=1..        f
-0002e0f0: 6f72 2069 2069 6e20 6c73 745f 4944 3a0d  or i in lst_ID:.
-0002e100: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002e110: 6920 213d 2030 3a0d 0a20 2020 2020 2020  i != 0:..       
-0002e120: 2020 2020 2020 2020 2069 6620 6920 6e6f           if i no
-0002e130: 7420 696e 2065 7863 6c75 6465 6456 616c  t in excludedVal
-0002e140: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0002e150: 2020 2020 2020 2066 613d 7365 6c66 2e67         fa=self.g
-0002e160: 6574 5f66 6163 6965 735f 6f62 6a28 4944  et_facies_obj(ID
-0002e170: 3d69 2c20 7479 7065 3d22 4944 2229 0d0a  =i, type="ID")..
-0002e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e190: 2020 2020 2320 6661 5f64 6f6d 6169 6e73      # fa_domains
-0002e1a0: 5b66 615f 646f 6d61 696e 7320 3d3d 2066  [fa_domains == f
-0002e1b0: 612e 4944 5d3d 6e65 775f 6964 0d0a 2020  a.ID]=new_id..  
-0002e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1d0: 2020 636f 6c6f 7273 2e61 7070 656e 6428    colors.append(
-0002e1e0: 6661 2e63 290d 0a20 2020 2020 2020 2020  fa.c)..         
-0002e1f0: 2020 2020 2020 2020 2020 2064 5b6e 6577             d[new
-0002e200: 5f69 6420 2b20 302e 355d 3d66 612e 6e61  _id + 0.5]=fa.na
-0002e210: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
-0002e220: 2020 2020 2020 2020 6e65 775f 6964 202b          new_id +
-0002e230: 3d20 310d 0a20 2020 2020 2020 2020 2020  = 1..           
-0002e240: 2020 2020 2020 2020 206e 6577 5f6c 7374           new_lst
-0002e250: 5f49 442e 6170 7065 6e64 2869 290d 0a0d  _ID.append(i)...
-0002e260: 0a20 2020 2020 2020 2023 7265 6d6f 7665  .        #remove
-0002e270: 2030 206f 6363 7572 656e 6365 2028 7768   0 occurence (wh
-0002e280: 6572 6520 6e6f 2066 6163 6965 7320 6172  ere no facies ar
-0002e290: 6520 7072 6573 656e 7429 0d0a 2020 2020  e present)..    
-0002e2a0: 2020 2020 6661 5f64 6f6d 6169 6e73 5b66      fa_domains[f
-0002e2b0: 615f 646f 6d61 696e 733d 3d30 5d3d 6e70  a_domains==0]=np
-0002e2c0: 2e6e 616e 0d0a 0d0a 2020 2020 2020 2020  .nan....        
-0002e2d0: 6966 2070 6c6f 7474 6572 2069 7320 4e6f  if plotter is No
-0002e2e0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-0002e2f0: 2070 3d70 762e 506c 6f74 7465 7228 290d   p=pv.Plotter().
-0002e300: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0002e310: 2020 2020 2020 2020 2020 2020 703d 706c              p=pl
-0002e320: 6f74 7465 720d 0a20 2020 2020 2020 2069  otter..        i
-0002e330: 6d3d 6765 6f6e 652e 696d 672e 496d 6728  m=geone.img.Img(
-0002e340: 6e78 2c20 6e79 2c20 6e7a 2c20 7378 2c20  nx, ny, nz, sx, 
-0002e350: 7379 2c20 737a 2a76 5f65 782c 2078 302c  sy, sz*v_ex, x0,
-0002e360: 2079 302c 207a 302c 206e 763d 312c 2076   y0, z0, nv=1, v
-0002e370: 616c 3d66 615f 646f 6d61 696e 732c 2076  al=fa_domains, v
-0002e380: 6172 6e61 6d65 3d22 4c69 7468 6f6c 6f67  arname="Litholog
-0002e390: 6965 7322 290d 0a0d 0a20 2020 2020 2020  ies")....       
-0002e3a0: 2069 6620 736c 6963 6578 2069 7320 6e6f   if slicex is no
-0002e3b0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0002e3c0: 2020 2020 2073 6c69 6365 783d 6e70 2e61       slicex=np.a
-0002e3d0: 7272 6179 2873 6c69 6365 7829 0d0a 2020  rray(slicex)..  
-0002e3e0: 2020 2020 2020 2020 2020 736c 6963 6578            slicex
-0002e3f0: 5b73 6c69 6365 783c 305d 3d30 0d0a 2020  [slicex<0]=0..  
-0002e400: 2020 2020 2020 2020 2020 736c 6963 6578            slicex
-0002e410: 5b73 6c69 6365 783e 315d 3d31 0d0a 2020  [slicex>1]=1..  
-0002e420: 2020 2020 2020 2020 2020 6378 3d69 6d2e            cx=im.
-0002e430: 6f78 202b 2073 6c69 6365 7820 2a20 696d  ox + slicex * im
-0002e440: 2e6e 7820 2a20 696d 2e73 7820 2023 2063  .nx * im.sx  # c
-0002e450: 656e 7465 7220 616c 6f6e 6720 780d 0a20  enter along x.. 
-0002e460: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0002e470: 2020 2020 2020 2020 2020 6378 3d4e 6f6e            cx=Non
-0002e480: 650d 0a20 2020 2020 2020 2069 6620 736c  e..        if sl
-0002e490: 6963 6579 2069 7320 6e6f 7420 4e6f 6e65  icey is not None
-0002e4a0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0002e4b0: 6c69 6365 793d 6e70 2e61 7272 6179 2873  licey=np.array(s
-0002e4c0: 6c69 6365 7929 0d0a 2020 2020 2020 2020  licey)..        
-0002e4d0: 2020 2020 736c 6963 6579 5b73 6c69 6365      slicey[slice
-0002e4e0: 793c 305d 3d30 0d0a 2020 2020 2020 2020  y<0]=0..        
-0002e4f0: 2020 2020 736c 6963 6579 5b73 6c69 6365      slicey[slice
-0002e500: 793e 315d 3d31 0d0a 2020 2020 2020 2020  y>1]=1..        
-0002e510: 2020 2020 6379 3d69 6d2e 6f79 202b 2073      cy=im.oy + s
-0002e520: 6c69 6365 7920 2a20 696d 2e6e 7920 2a20  licey * im.ny * 
-0002e530: 696d 2e73 7920 2023 2063 656e 7465 7220  im.sy  # center 
-0002e540: 616c 6f6e 6720 790d 0a20 2020 2020 2020  along y..       
-0002e550: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0002e560: 2020 2020 6379 3d4e 6f6e 650d 0a20 2020      cy=None..   
-0002e570: 2020 2020 2069 6620 736c 6963 657a 2069       if slicez i
-0002e580: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-0002e590: 2020 2020 2020 2020 2073 6c69 6365 7a3d           slicez=
-0002e5a0: 6e70 2e61 7272 6179 2873 6c69 6365 7a29  np.array(slicez)
-0002e5b0: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002e5c0: 6963 657a 5b73 6c69 6365 7a3c 305d 3d30  icez[slicez<0]=0
-0002e5d0: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-0002e5e0: 6963 657a 5b73 6c69 6365 7a3e 315d 3d31  icez[slicez>1]=1
-0002e5f0: 0d0a 2020 2020 2020 2020 2020 2020 637a  ..            cz
-0002e600: 3d69 6d2e 6f7a 202b 2073 6c69 6365 7a20  =im.oz + slicez 
-0002e610: 2a20 696d 2e6e 7a20 2a20 696d 2e73 7a20  * im.nz * im.sz 
-0002e620: 2023 2063 656e 7465 7220 616c 6f6e 6720   # center along 
-0002e630: 7a0d 0a20 2020 2020 2020 2065 6c73 653a  z..        else:
-0002e640: 0d0a 2020 2020 2020 2020 2020 2020 637a  ..            cz
-0002e650: 3d4e 6f6e 650d 0a0d 0a0d 0a20 2020 2020  =None......     
-0002e660: 2020 2069 6620 736c 6963 6578 2069 7320     if slicex is 
-0002e670: 6e6f 7420 4e6f 6e65 206f 7220 736c 6963  not None or slic
-0002e680: 6579 2069 7320 6e6f 7420 4e6f 6e65 206f  ey is not None o
-0002e690: 7220 736c 6963 657a 2069 7320 6e6f 7420  r slicez is not 
-0002e6a0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0002e6b0: 2020 2069 6d67 706c 7433 2e64 7261 7749     imgplt3.drawI
-0002e6c0: 6d61 6765 3344 5f73 6c69 6365 2869 6d2c  mage3D_slice(im,
-0002e6d0: 2070 6c6f 7474 6572 3d70 2c20 736c 6963   plotter=p, slic
-0002e6e0: 655f 6e6f 726d 616c 5f78 3d63 782c 2073  e_normal_x=cx, s
-0002e6f0: 6c69 6365 5f6e 6f72 6d61 6c5f 793d 6379  lice_normal_y=cy
-0002e700: 2c20 736c 6963 655f 6e6f 726d 616c 5f7a  , slice_normal_z
-0002e710: 3d63 7a2c 0d0a 2020 2020 2020 2020 2020  =cz,..          
-0002e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e730: 2020 2020 2020 2020 2020 6361 7465 673d            categ=
-0002e740: 5472 7565 2c20 6361 7465 6756 616c 3d6e  True, categVal=n
-0002e750: 6577 5f6c 7374 5f49 442c 2065 7863 6c75  ew_lst_ID, exclu
-0002e760: 6465 6456 616c 3d65 7863 6c75 6465 6456  dedVal=excludedV
-0002e770: 616c 2c0d 0a20 2020 2020 2020 2020 2020  al,..           
-0002e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e790: 2020 2020 2020 2020 2063 6174 6567 436f           categCo
-0002e7a0: 6c3d 636f 6c6f 7273 2c20 7363 616c 6172  l=colors, scalar
-0002e7b0: 5f62 6172 5f61 6e6e 6f74 6174 696f 6e73  _bar_annotations
-0002e7c0: 3d64 2c0d 0a20 2020 2020 2020 2020 2020  =d,..           
-0002e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e7e0: 2020 2020 2020 2020 2073 6361 6c61 725f           scalar_
-0002e7f0: 6261 725f 6b77 6172 6773 3d73 6361 6c61  bar_kwargs=scala
-0002e800: 725f 6261 725f 6b77 6172 6773 2c20 7368  r_bar_kwargs, sh
-0002e810: 6f77 5f73 6361 6c61 725f 6261 7220 3d20  ow_scalar_bar = 
-0002e820: 7368 6f77 5f73 6361 6c61 725f 6261 722c  show_scalar_bar,
-0002e830: 202a 2a6b 7761 7267 7329 0d0a 2020 2020   **kwargs)..    
-0002e840: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0002e850: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
-0002e860: 7261 7749 6d61 6765 3344 5f73 7572 6661  rawImage3D_surfa
-0002e870: 6365 2869 6d2c 2070 6c6f 7474 6572 3d70  ce(im, plotter=p
-0002e880: 2c20 6361 7465 673d 5472 7565 2c20 6361  , categ=True, ca
-0002e890: 7465 6756 616c 3d6e 6577 5f6c 7374 5f49  tegVal=new_lst_I
-0002e8a0: 442c 2065 7863 6c75 6465 6456 616c 3d65  D, excludedVal=e
-0002e8b0: 7863 6c75 6465 6456 616c 2c0d 0a20 2020  xcludedVal,..   
-0002e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e8e0: 2063 6174 6567 436f 6c3d 636f 6c6f 7273   categCol=colors
-0002e8f0: 2c20 7363 616c 6172 5f62 6172 5f61 6e6e  , scalar_bar_ann
-0002e900: 6f74 6174 696f 6e73 3d64 2c0d 0a20 2020  otations=d,..   
-0002e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e930: 2073 6361 6c61 725f 6261 725f 6b77 6172   scalar_bar_kwar
-0002e940: 6773 3d73 6361 6c61 725f 6261 725f 6b77  gs=scalar_bar_kw
-0002e950: 6172 6773 2c20 7368 6f77 5f73 6361 6c61  args, show_scala
-0002e960: 725f 6261 7220 3d20 7368 6f77 5f73 6361  r_bar = show_sca
-0002e970: 6c61 725f 6261 722c 202a 2a6b 7761 7267  lar_bar, **kwarg
-0002e980: 7329 0d0a 0d0a 2020 2020 2020 2020 6966  s)....        if
-0002e990: 2070 6c6f 7474 6572 2069 7320 4e6f 6e65   plotter is None
-0002e9a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0002e9b0: 2e61 6464 5f62 6f75 6e64 696e 675f 626f  .add_bounding_bo
-0002e9c0: 7828 290d 0a20 2020 2020 2020 2020 2020  x()..           
-0002e9d0: 2070 2e73 686f 775f 6178 6573 2829 0d0a   p.show_axes()..
-0002e9e0: 2020 2020 2020 2020 2020 2020 702e 7368              p.sh
-0002e9f0: 6f77 2829 0d0a 0d0a 0d0a 2020 2020 6465  ow()......    de
-0002ea00: 6620 706c 6f74 5f70 726f 7028 7365 6c66  f plot_prop(self
-0002ea10: 2c20 7072 6f70 6572 7479 2c20 6975 3d30  , property, iu=0
-0002ea20: 2c20 6966 613d 302c 2069 703d 302c 2076  , ifa=0, ip=0, v
-0002ea30: 5f65 783d 312c 2069 6e73 6964 655f 756e  _ex=1, inside_un
-0002ea40: 6974 733d 4e6f 6e65 2c20 696e 7369 6465  its=None, inside
-0002ea50: 5f66 6163 6965 733d 4e6f 6e65 2c20 6669  _facies=None, fi
-0002ea60: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
-0002ea70: 3d4e 6f6e 652c 0d0a 2020 2020 2020 2020  =None,..        
-0002ea80: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
-0002ea90: 7465 723d 4e6f 6e65 2c20 736c 6963 6578  ter=None, slicex
-0002eaa0: 3d4e 6f6e 652c 2073 6c69 6365 793d 4e6f  =None, slicey=No
-0002eab0: 6e65 2c20 736c 6963 657a 3d4e 6f6e 652c  ne, slicez=None,
-0002eac0: 2063 6d69 6e3d 4e6f 6e65 2c20 636d 6178   cmin=None, cmax
-0002ead0: 3d4e 6f6e 652c 2073 6361 6c61 725f 6261  =None, scalar_ba
-0002eae0: 725f 6b77 6172 6773 3d4e 6f6e 652c 202a  r_kwargs=None, *
-0002eaf0: 2a6b 7761 7267 7329 3a0d 0a0d 0a20 2020  *kwargs):....   
-0002eb00: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0002eb10: 2020 506c 6f74 2074 6865 2066 6163 6965    Plot the facie
-0002eb20: 7320 7265 616c 697a 6174 696f 6e73 206f  s realizations o
-0002eb30: 7665 7220 7468 6520 646f 6d61 696e 2077  ver the domain w
-0002eb40: 6974 6820 7468 6520 636f 6c6f 7273 2061  ith the colors a
-0002eb50: 7474 7269 6275 7465 6420 746f 2066 6163  ttributed to fac
-0002eb60: 6965 730d 0a0d 0a20 2020 2020 2020 2050  ies....        P
-0002eb70: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0002eb80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0002eb90: 2020 2020 2020 2069 753a 696e 7420 0d0a         iu:int ..
-0002eba0: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-0002ebb0: 6365 206f 6620 756e 6974 7320 7265 616c  ce of units real
-0002ebc0: 697a 6174 696f 6e0d 0a20 2020 2020 2020  ization..       
-0002ebd0: 2069 6661 3a69 6e74 0d0a 2020 2020 2020   ifa:int..      
-0002ebe0: 2020 2020 2020 696e 6469 6365 206f 6620        indice of 
-0002ebf0: 6661 6369 6573 2072 6561 6c69 7a61 7469  facies realizati
-0002ec00: 6f6e 0d0a 2020 2020 2020 2020 6970 3a69  on..        ip:i
-0002ec10: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
-0002ec20: 696e 6469 6365 206f 6620 7072 6f70 6572  indice of proper
-0002ec30: 7479 2072 6561 6c69 7a61 7469 6f6e 0d0a  ty realization..
-0002ec40: 2020 2020 2020 2020 765f 6578 3a69 6e74          v_ex:int
-0002ec50: 206f 7220 666c 6f61 740d 0a20 2020 2020   or float..     
-0002ec60: 2020 2020 2020 2076 6572 7469 6361 6c20         vertical 
-0002ec70: 6578 6167 6572 6174 696f 6e0d 0a20 2020  exageration..   
-0002ec80: 2020 2020 2069 6e73 6964 655f 756e 6974       inside_unit
-0002ec90: 733a 6172 7261 792d 6c69 6b65 206f 6620  s:array-like of 
-0002eca0: 3a63 6c61 7373 3a60 556e 6974 6020 6f62  :class:`Unit` ob
-0002ecb0: 6a65 6374 7320 6f72 2075 6e69 7420 6e61  jects or unit na
-0002ecc0: 6d65 7320 2873 7472 696e 6729 0d0a 2020  mes (string)..  
-0002ecd0: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
-0002ece0: 6620 756e 6974 7320 696e 7369 6465 2077  f units inside w
-0002ecf0: 6869 6368 2077 6520 7761 6e74 2074 6f20  hich we want to 
-0002ed00: 6861 7665 2074 6865 2070 6c6f 742e 2042  have the plot. B
-0002ed10: 7920 6465 6661 756c 7420 616c 6c0d 0a20  y default all.. 
-0002ed20: 2020 2020 2020 2069 6e73 6964 655f 6661         inside_fa
-0002ed30: 6369 6573 3a61 7272 6179 2d6c 696b 6520  cies:array-like 
-0002ed40: 6f66 203a 636c 6173 733a 6046 6163 6965  of :class:`Facie
-0002ed50: 7360 206f 626a 6563 7473 206f 7220 6661  s` objects or fa
-0002ed60: 6369 6573 206e 616d 6573 2028 7374 7269  cies names (stri
-0002ed70: 6e67 290d 0a20 2020 2020 2020 2020 2020  ng)..           
-0002ed80: 206c 6973 7420 6f66 2066 6163 6965 7320   list of facies 
-0002ed90: 696e 7369 6465 2077 6869 6368 2077 6520  inside which we 
-0002eda0: 7761 6e74 2074 6f20 6861 7665 2074 6865  want to have the
-0002edb0: 2070 6c6f 742e 2042 7920 6465 6661 756c   plot. By defaul
-0002edc0: 7420 616c 6c0d 0a20 2020 2020 2020 2070  t all..        p
-0002edd0: 6c6f 7474 6572 3a70 7976 6973 7461 2070  lotter:pyvista p
-0002ede0: 6c6f 7474 6572 2069 6620 7761 6e74 6564  lotter if wanted
-0002edf0: 0d0a 2020 2020 2020 2020 736c 6963 6578  ..        slicex
-0002ee00: 2c20 736c 6963 6579 2c20 736c 6963 657a  , slicey, slicez
-0002ee10: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
-0002ee20: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
-0002ee30: 2020 2020 2020 2020 2020 2066 7261 6374             fract
-0002ee40: 696f 6e20 696e 2078 2c20 7920 6f72 207a  ion in x, y or z
-0002ee50: 2064 6972 6563 7469 6f6e 2077 6865 7265   direction where
-0002ee60: 2074 6865 2073 6c69 6365 2069 7320 646f   the slice is do
-0002ee70: 6e65 0d0a 2020 2020 2020 2020 636d 696e  ne..        cmin
-0002ee80: 2c20 636d 6178 3a66 6c6f 6174 0d0a 2020  , cmax:float..  
-0002ee90: 2020 2020 2020 2020 2020 6d69 6e20 616e            min an
-0002eea0: 6420 6d61 7820 7661 6c75 6520 6f66 2074  d max value of t
-0002eeb0: 6865 2063 6f6c 6f72 6261 720d 0a20 2020  he colorbar..   
-0002eec0: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
-0002eed0: 6b77 6172 6773 3a64 6963 740d 0a20 2020  kwargs:dict..   
-0002eee0: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
-0002eef0: 666f 7220 7468 6520 7363 616c 6172 2062  for the scalar b
-0002ef00: 6172 0d0a 2020 2020 2020 2020 6b77 6172  ar..        kwar
-0002ef10: 6773 3a64 6963 740d 0a20 2020 2020 2020  gs:dict..       
-0002ef20: 2020 2020 206b 7761 7267 7320 746f 2070       kwargs to p
-0002ef30: 6173 7320 746f 2067 656f 6e65 2e69 6d67  ass to geone.img
-0002ef40: 706c 6f74 2e64 7261 7749 6d61 6765 3344  plot.drawImage3D
-0002ef50: 5f73 6c69 6365 206f 7220 6765 6f6e 652e  _slice or geone.
-0002ef60: 696d 6770 6c6f 742e 6472 6177 496d 6167  imgplot.drawImag
-0002ef70: 6533 445f 7375 7266 6163 650d 0a20 2020  e3D_surface..   
-0002ef80: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-0002ef90: 2020 2020 7072 6f70 3d73 656c 662e 6765      prop=self.ge
-0002efa0: 745f 7072 6f70 2870 726f 7065 7274 792c  t_prop(property,
-0002efb0: 2069 752c 2069 6661 2c20 6970 2c20 616c   iu, ifa, ip, al
-0002efc0: 6c5f 6461 7461 3d46 616c 7365 290d 0a20  l_data=False).. 
-0002efd0: 2020 2020 2020 2066 6163 6965 733d 7365         facies=se
-0002efe0: 6c66 2e67 6574 5f66 6163 6965 7328 6975  lf.get_facies(iu
-0002eff0: 2c20 6966 612c 2061 6c6c 5f64 6174 613d  , ifa, all_data=
-0002f000: 4661 6c73 6529 0d0a 0d0a 2020 2020 2020  False)....      
-0002f010: 2020 236b 6565 7020 7661 6c75 6573 2069    #keep values i
-0002f020: 6e20 6f6e 6c79 2077 616e 7465 6420 756e  n only wanted un
-0002f030: 6974 730d 0a20 2020 2020 2020 2069 6620  its..        if 
-0002f040: 696e 7369 6465 5f75 6e69 7473 2069 7320  inside_units is 
-0002f050: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
-0002f060: 2020 2020 2020 206d 6173 6b5f 616c 6c3d         mask_all=
-0002f070: 6e70 2e7a 6572 6f73 285b 7365 6c66 2e67  np.zeros([self.g
-0002f080: 6574 5f6e 7a28 292c 2073 656c 662e 6765  et_nz(), self.ge
-0002f090: 745f 6e79 2829 2c20 7365 6c66 2e67 6574  t_ny(), self.get
-0002f0a0: 5f6e 7828 295d 290d 0a20 2020 2020 2020  _nx()])..       
-0002f0b0: 2020 2020 2066 6f72 2075 2069 6e20 696e       for u in in
-0002f0c0: 7369 6465 5f75 6e69 7473 3a0d 0a20 2020  side_units:..   
-0002f0d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002f0e0: 6973 696e 7374 616e 6365 2875 2c20 7374  isinstance(u, st
-0002f0f0: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-0002f100: 2020 2020 2020 2020 206d 6173 6b3d 7365           mask=se
-0002f110: 6c66 2e75 6e69 745f 6d61 736b 2875 2c20  lf.unit_mask(u, 
-0002f120: 6975 3d69 7529 0d0a 2020 2020 2020 2020  iu=iu)..        
-0002f130: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0002f140: 6e73 7461 6e63 6528 752c 2055 6e69 7429  nstance(u, Unit)
-0002f150: 2061 6e64 2075 2069 6e20 7365 6c66 2e67   and u in self.g
-0002f160: 6574 5f61 6c6c 5f75 6e69 7473 2829 3a0d  et_all_units():.
-0002f170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f180: 2020 2020 206d 6173 6b3d 7365 6c66 2e75       mask=self.u
-0002f190: 6e69 745f 6d61 736b 2875 2e6e 616d 652c  nit_mask(u.name,
-0002f1a0: 2069 753d 6975 290d 0a20 2020 2020 2020   iu=iu)..       
-0002f1b0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-0002f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002f1e0: 7272 6f72 2028 2255 6e69 7420 7061 7373  rror ("Unit pass
-0002f1f0: 6564 2069 6e20 696e 7369 6465 5f75 6e69  ed in inside_uni
-0002f200: 7473 206d 7573 7420 6265 2061 2075 6e69  ts must be a uni
-0002f210: 7420 6e61 6d65 206f 7220 6120 756e 6974  t name or a unit
-0002f220: 206f 626a 6563 7420 636f 6e74 6169 6e65   object containe
-0002f230: 6420 696e 2074 6865 2041 7263 6854 6162  d in the ArchTab
-0002f240: 6c65 2229 0d0a 2020 2020 2020 2020 2020  le")..          
-0002f250: 2020 2020 2020 6d61 736b 5f61 6c6c 5b6d        mask_all[m
-0002f260: 6173 6b20 3d3d 2031 5d3d 310d 0a0d 0a20  ask == 1]=1.... 
-0002f270: 2020 2020 2020 2020 2020 2070 726f 705b             prop[
-0002f280: 6d61 736b 5f61 6c6c 2021 3d20 315d 3d6e  mask_all != 1]=n
-0002f290: 702e 6e61 6e0d 0a0d 0a20 2020 2020 2020  p.nan....       
-0002f2a0: 2023 6b65 6570 2076 616c 7565 7320 696e   #keep values in
-0002f2b0: 206f 6e6c 7920 7761 6e74 6564 2066 6163   only wanted fac
-0002f2c0: 6965 730d 0a20 2020 2020 2020 2069 6620  ies..        if 
-0002f2d0: 696e 7369 6465 5f66 6163 6965 7320 6973  inside_facies is
-0002f2e0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0002f2f0: 2020 2020 2020 2020 6d61 736b 5f61 6c6c          mask_all
-0002f300: 3d6e 702e 7a65 726f 7328 5b73 656c 662e  =np.zeros([self.
-0002f310: 6765 745f 6e7a 2829 2c20 7365 6c66 2e67  get_nz(), self.g
-0002f320: 6574 5f6e 7928 292c 2073 656c 662e 6765  et_ny(), self.ge
-0002f330: 745f 6e78 2829 5d29 0d0a 2020 2020 2020  t_nx()])..      
-0002f340: 2020 2020 2020 666f 7220 6661 2069 6e20        for fa in 
-0002f350: 696e 7369 6465 5f66 6163 6965 733a 0d0a  inside_facies:..
-0002f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f370: 6966 2069 7369 6e73 7461 6e63 6528 6661  if isinstance(fa
-0002f380: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-0002f390: 2020 2020 2020 2020 2020 2020 206d 6173               mas
-0002f3a0: 6b3d 2866 6163 6965 7320 3d3d 2073 656c  k=(facies == sel
-0002f3b0: 662e 6765 745f 6661 6369 6573 5f6f 626a  f.get_facies_obj
-0002f3c0: 2866 6129 2e49 4429 0d0a 2020 2020 2020  (fa).ID)..      
-0002f3d0: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
-0002f3e0: 7369 6e73 7461 6e63 6528 6661 2c20 4661  sinstance(fa, Fa
-0002f3f0: 6369 6573 2920 616e 6420 6661 2069 6e20  cies) and fa in 
-0002f400: 7365 6c66 2e67 6574 5f61 6c6c 5f66 6163  self.get_all_fac
-0002f410: 6965 7328 293a 0d0a 2020 2020 2020 2020  ies():..        
-0002f420: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-0002f430: 3d28 6661 6369 6573 203d 3d20 6661 2e49  =(facies == fa.I
-0002f440: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
-0002f450: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0002f460: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002f470: 6169 7365 2056 616c 7565 4572 726f 7220  aise ValueError 
-0002f480: 2822 556e 6974 2070 6173 7365 6420 696e  ("Unit passed in
-0002f490: 2069 6e73 6964 655f 756e 6974 7320 6d75   inside_units mu
-0002f4a0: 7374 2062 6520 6120 756e 6974 206e 616d  st be a unit nam
-0002f4b0: 6520 6f72 2061 2075 6e69 7420 6f62 6a65  e or a unit obje
-0002f4c0: 6374 2063 6f6e 7461 696e 6564 2069 6e20  ct contained in 
-0002f4d0: 7468 6520 4172 6368 5461 626c 6522 290d  the ArchTable").
-0002f4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f4f0: 206d 6173 6b5f 616c 6c5b 6d61 736b 203d   mask_all[mask =
-0002f500: 3d20 315d 3d31 0d0a 0d0a 2020 2020 2020  = 1]=1....      
-0002f510: 2020 2020 2020 7072 6f70 5b6d 6173 6b5f        prop[mask_
-0002f520: 616c 6c20 213d 2031 5d3d 6e70 2e6e 616e  all != 1]=np.nan
-0002f530: 0d0a 0d0a 2020 2020 2020 2020 6966 207e  ....        if ~
-0002f540: 7072 6f70 2e61 6e79 2829 3a0d 0a20 2020  prop.any():..   
-0002f550: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0002f560: 616c 7565 4572 726f 7220 2822 4572 726f  alueError ("Erro
-0002f570: 723a 204e 6f20 7661 6c75 6573 2066 6f75  r: No values fou
-0002f580: 6e64 2229 0d0a 0d0a 2020 2020 2020 2020  nd")....        
-0002f590: 6e78 3d73 656c 662e 6765 745f 6e78 2829  nx=self.get_nx()
-0002f5a0: 0d0a 2020 2020 2020 2020 6e79 3d73 656c  ..        ny=sel
-0002f5b0: 662e 6765 745f 6e79 2829 0d0a 2020 2020  f.get_ny()..    
-0002f5c0: 2020 2020 6e7a 3d73 656c 662e 6765 745f      nz=self.get_
-0002f5d0: 6e7a 2829 0d0a 2020 2020 2020 2020 7378  nz()..        sx
-0002f5e0: 3d73 656c 662e 6765 745f 7378 2829 0d0a  =self.get_sx()..
-0002f5f0: 2020 2020 2020 2020 7379 3d73 656c 662e          sy=self.
-0002f600: 6765 745f 7379 2829 0d0a 2020 2020 2020  get_sy()..      
-0002f610: 2020 737a 3d73 656c 662e 6765 745f 737a    sz=self.get_sz
-0002f620: 2829 0d0a 2020 2020 2020 2020 7830 3d73  ()..        x0=s
-0002f630: 656c 662e 6765 745f 6f78 2829 0d0a 2020  elf.get_ox()..  
-0002f640: 2020 2020 2020 7930 3d73 656c 662e 6765        y0=self.ge
-0002f650: 745f 6f79 2829 0d0a 2020 2020 2020 2020  t_oy()..        
-0002f660: 7a30 3d73 656c 662e 6765 745f 6f7a 2829  z0=self.get_oz()
-0002f670: 0d0a 0d0a 2020 2020 2020 2020 2320 6669  ....        # fi
-0002f680: 6c74 6572 2076 616c 7565 730d 0a20 2020  lter values..   
-0002f690: 2020 2020 2069 6620 6669 6c74 6572 696e       if filterin
-0002f6a0: 675f 696e 7465 7276 616c 2069 7320 6e6f  g_interval is no
-0002f6b0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0002f6c0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0002f6d0: 6365 2866 696c 7465 7269 6e67 5f69 6e74  ce(filtering_int
-0002f6e0: 6572 7661 6c2c 206c 6973 7429 3a0d 0a20  erval, list):.. 
-0002f6f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002f700: 6620 6c65 6e28 6669 6c74 6572 696e 675f  f len(filtering_
-0002f710: 696e 7465 7276 616c 2920 3d3d 2032 3a0d  interval) == 2:.
-0002f720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f730: 2020 2020 2069 6620 6669 6c74 6572 696e       if filterin
-0002f740: 675f 696e 7465 7276 616c 5b30 5d20 3c20  g_interval[0] < 
-0002f750: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
-0002f760: 616c 5b31 5d3a 0d0a 2020 2020 2020 2020  al[1]:..        
-0002f770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f780: 7072 6f70 5b70 726f 7020 3c20 6669 6c74  prop[prop < filt
-0002f790: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
-0002f7a0: 5d5d 203d 206e 702e 6e61 6e0d 0a20 2020  ]] = np.nan..   
-0002f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f7c0: 2020 2020 2070 726f 705b 7072 6f70 203e       prop[prop >
-0002f7d0: 2066 696c 7465 7269 6e67 5f69 6e74 6572   filtering_inter
-0002f7e0: 7661 6c5b 315d 5d20 3d20 6e70 2e6e 616e  val[1]] = np.nan
-0002f7f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f800: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0002f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f820: 2020 2020 2070 7269 6e74 2822 6669 6c74       print("filt
-0002f830: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
-0002f840: 5d20 6d75 7374 2062 6520 736d 616c 6c65  ] must be smalle
-0002f850: 7220 7468 616e 2066 696c 7465 7269 6e67  r than filtering
-0002f860: 5f69 6e74 6572 7661 6c5b 315d 2229 0d0a  _interval[1]")..
-0002f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f880: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0002f890: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0002f8a0: 2822 6669 6c74 6572 696e 675f 696e 7465  ("filtering_inte
-0002f8b0: 7276 616c 206d 7573 7420 6265 2061 206c  rval must be a l
-0002f8c0: 6973 7420 6f66 2074 776f 2076 616c 7565  ist of two value
-0002f8d0: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
-0002f8e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0002f8f0: 2020 2020 2020 2020 7072 696e 7428 2266          print("f
-0002f900: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
-0002f910: 6c20 6d75 7374 2062 6520 6120 6c69 7374  l must be a list
-0002f920: 206f 6620 7477 6f20 7661 6c75 6573 2229   of two values")
-0002f930: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-0002f940: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-0002f950: 0a20 2020 2020 2020 2020 2020 2070 3d70  .            p=p
-0002f960: 762e 506c 6f74 7465 7228 290d 0a20 2020  v.Plotter()..   
-0002f970: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0002f980: 2020 2020 2020 2020 703d 706c 6f74 7465          p=plotte
-0002f990: 720d 0a20 2020 2020 2020 2069 6d3d 6765  r..        im=ge
-0002f9a0: 6f6e 652e 696d 672e 496d 6728 6e78 2c20  one.img.Img(nx, 
-0002f9b0: 6e79 2c20 6e7a 2c20 7378 2c20 7379 2c20  ny, nz, sx, sy, 
-0002f9c0: 737a 2a76 5f65 782c 2078 302c 2079 302c  sz*v_ex, x0, y0,
-0002f9d0: 207a 302c 206e 763d 312c 2076 616c 3d70   z0, nv=1, val=p
-0002f9e0: 726f 702c 2076 6172 6e61 6d65 3d70 726f  rop, varname=pro
-0002f9f0: 7065 7274 7929 0d0a 0d0a 2020 2020 2020  perty)....      
-0002fa00: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
-0002fa10: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
-0002fa20: 2020 2020 2020 736c 6963 6578 3d6e 702e        slicex=np.
-0002fa30: 6172 7261 7928 736c 6963 6578 290d 0a20  array(slicex).. 
-0002fa40: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002fa50: 785b 736c 6963 6578 3c30 5d3d 300d 0a20  x[slicex<0]=0.. 
-0002fa60: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
-0002fa70: 785b 736c 6963 6578 3e31 5d3d 310d 0a20  x[slicex>1]=1.. 
-0002fa80: 2020 2020 2020 2020 2020 2063 783d 696d             cx=im
-0002fa90: 2e6f 7820 2b20 736c 6963 6578 202a 2069  .ox + slicex * i
-0002faa0: 6d2e 6e78 202a 2069 6d2e 7378 2020 2320  m.nx * im.sx  # 
-0002fab0: 6365 6e74 6572 2061 6c6f 6e67 2078 0d0a  center along x..
-0002fac0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002fad0: 2020 2020 2020 2020 2020 2063 783d 4e6f             cx=No
-0002fae0: 6e65 0d0a 2020 2020 2020 2020 6966 2073  ne..        if s
-0002faf0: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
-0002fb00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0002fb10: 736c 6963 6579 3d6e 702e 6172 7261 7928  slicey=np.array(
-0002fb20: 736c 6963 6579 290d 0a20 2020 2020 2020  slicey)..       
-0002fb30: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002fb40: 6579 3c30 5d3d 300d 0a20 2020 2020 2020  ey<0]=0..       
-0002fb50: 2020 2020 2073 6c69 6365 795b 736c 6963       slicey[slic
-0002fb60: 6579 3e31 5d3d 310d 0a20 2020 2020 2020  ey>1]=1..       
-0002fb70: 2020 2020 2063 793d 696d 2e6f 7920 2b20       cy=im.oy + 
-0002fb80: 736c 6963 6579 202a 2069 6d2e 6e79 202a  slicey * im.ny *
-0002fb90: 2069 6d2e 7379 2020 2320 6365 6e74 6572   im.sy  # center
-0002fba0: 2061 6c6f 6e67 2079 0d0a 2020 2020 2020   along y..      
-0002fbb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0002fbc0: 2020 2020 2063 793d 4e6f 6e65 0d0a 2020       cy=None..  
-0002fbd0: 2020 2020 2020 6966 2073 6c69 6365 7a20        if slicez 
-0002fbe0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0002fbf0: 2020 2020 2020 2020 2020 736c 6963 657a            slicez
-0002fc00: 3d6e 702e 6172 7261 7928 736c 6963 657a  =np.array(slicez
-0002fc10: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
-0002fc20: 6c69 6365 7a5b 736c 6963 657a 3c30 5d3d  licez[slicez<0]=
-0002fc30: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
-0002fc40: 6c69 6365 7a5b 736c 6963 657a 3e31 5d3d  licez[slicez>1]=
-0002fc50: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
-0002fc60: 7a3d 696d 2e6f 7a20 2b20 736c 6963 657a  z=im.oz + slicez
-0002fc70: 202a 2069 6d2e 6e7a 202a 2069 6d2e 737a   * im.nz * im.sz
-0002fc80: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
-0002fc90: 207a 0d0a 2020 2020 2020 2020 656c 7365   z..        else
-0002fca0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
-0002fcb0: 7a3d 4e6f 6e65 0d0a 0d0a 2020 2020 2020  z=None....      
-0002fcc0: 2020 6966 2073 6c69 6365 7820 6973 206e    if slicex is n
-0002fcd0: 6f74 204e 6f6e 6520 6f72 2073 6c69 6365  ot None or slice
-0002fce0: 7920 6973 206e 6f74 204e 6f6e 6520 6f72  y is not None or
-0002fcf0: 2073 6c69 6365 7a20 6973 206e 6f74 204e   slicez is not N
-0002fd00: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0002fd10: 2020 696d 6770 6c74 332e 6472 6177 496d    imgplt3.drawIm
-0002fd20: 6167 6533 445f 736c 6963 6528 696d 2c20  age3D_slice(im, 
-0002fd30: 706c 6f74 7465 723d 702c 2073 6c69 6365  plotter=p, slice
-0002fd40: 5f6e 6f72 6d61 6c5f 783d 6378 2c20 736c  _normal_x=cx, sl
-0002fd50: 6963 655f 6e6f 726d 616c 5f79 3d63 792c  ice_normal_y=cy,
-0002fd60: 2073 6c69 6365 5f6e 6f72 6d61 6c5f 7a3d   slice_normal_z=
-0002fd70: 637a 2c20 636d 696e 3d63 6d69 6e2c 2063  cz, cmin=cmin, c
-0002fd80: 6d61 783d 636d 6178 2c0d 0a20 2020 2020  max=cmax,..     
-0002fd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fdb0: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
-0002fdc0: 733d 7363 616c 6172 5f62 6172 5f6b 7761  s=scalar_bar_kwa
-0002fdd0: 7267 732c 202a 2a6b 7761 7267 7329 0d0a  rgs, **kwargs)..
-0002fde0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0002fdf0: 2020 2020 2020 2020 2020 2069 6d67 706c             imgpl
-0002fe00: 7433 2e64 7261 7749 6d61 6765 3344 5f73  t3.drawImage3D_s
-0002fe10: 7572 6661 6365 2869 6d2c 2070 6c6f 7474  urface(im, plott
-0002fe20: 6572 3d70 2c20 636d 696e 3d63 6d69 6e2c  er=p, cmin=cmin,
-0002fe30: 2063 6d61 783d 636d 6178 2c0d 0a20 2020   cmax=cmax,..   
-0002fe40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe60: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
-0002fe70: 7267 733d 7363 616c 6172 5f62 6172 5f6b  rgs=scalar_bar_k
-0002fe80: 7761 7267 732c 202a 2a6b 7761 7267 7329  wargs, **kwargs)
-0002fe90: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-0002fea0: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-0002feb0: 0a20 2020 2020 2020 2020 2020 2070 2e61  .            p.a
-0002fec0: 6464 5f62 6f75 6e64 696e 675f 626f 7828  dd_bounding_box(
-0002fed0: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-0002fee0: 2e73 686f 775f 6178 6573 2829 0d0a 2020  .show_axes()..  
-0002fef0: 2020 2020 2020 2020 2020 702e 7368 6f77            p.show
-0002ff00: 2829 0d0a 0d0a 0d0a 2020 2020 6465 6620  ()......    def 
-0002ff10: 706c 6f74 5f6d 6561 6e5f 7072 6f70 2873  plot_mean_prop(s
-0002ff20: 656c 662c 2070 726f 7065 7274 792c 2074  elf, property, t
-0002ff30: 7970 653d 2261 7269 7468 6d65 7469 6322  ype="arithmetic"
-0002ff40: 2c20 765f 6578 3d31 2c20 696e 7369 6465  , v_ex=1, inside
-0002ff50: 5f75 6e69 7473 3d4e 6f6e 652c 2069 6e73  _units=None, ins
-0002ff60: 6964 655f 6661 6369 6573 3d4e 6f6e 652c  ide_facies=None,
-0002ff70: 2066 696c 7465 7269 6e67 5f69 6e74 6572   filtering_inter
-0002ff80: 7661 6c3d 4e6f 6e65 2c0d 0a20 2020 2020  val=None,..     
-0002ff90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002ffa0: 6c6f 7474 6572 3d4e 6f6e 652c 2073 6c69  lotter=None, sli
-0002ffb0: 6365 783d 4e6f 6e65 2c20 736c 6963 6579  cex=None, slicey
-0002ffc0: 3d4e 6f6e 652c 2073 6c69 6365 7a3d 4e6f  =None, slicez=No
-0002ffd0: 6e65 2c20 636d 696e 3d4e 6f6e 652c 2063  ne, cmin=None, c
-0002ffe0: 6d61 783d 4e6f 6e65 2c20 7363 616c 6172  max=None, scalar
-0002fff0: 5f62 6172 5f6b 7761 7267 733d 4e6f 6e65  _bar_kwargs=None
-00030000: 2c20 2a2a 6b77 6172 6773 293a 0d0a 0d0a  , **kwargs):....
-00030010: 2020 2020 2020 2020 2354 4f20 444f 202d          #TO DO -
-00030020: 2d3e 2074 6f20 6f70 7469 6d69 7a65 0d0a  -> to optimize..
-00030030: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00030040: 2020 2020 2046 756e 6374 696f 6e20 7468       Function th
-00030050: 6174 2070 6c6f 7473 2074 6865 2061 7269  at plots the ari
-00030060: 7468 6d65 7469 6320 6d65 616e 206f 6620  thmetic mean of 
-00030070: 6120 7072 6f70 6572 7479 2061 7420 6576  a property at ev
-00030080: 6572 7920 6365 6c6c 730d 0a20 2020 2020  ery cells..     
-00030090: 2020 206f 6620 7468 6520 7369 6d75 6c61     of the simula
-000300a0: 7469 6f6e 2064 6f6d 6169 6e20 6769 7665  tion domain give
-000300b0: 6e20 616c 6c20 7468 6520 7072 6f70 6572  n all the proper
-000300c0: 7479 2073 696d 756c 6174 696f 6e73 0d0a  ty simulations..
-000300d0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000300e0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-000300f0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00030100: 2020 7072 6f70 6572 7479 3a20 7374 7269    property: stri
-00030110: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-00030120: 6e61 6d65 206f 6620 7468 6520 7072 6f70  name of the prop
-00030130: 6572 7479 2074 6f20 706c 6f74 0d0a 2020  erty to plot..  
-00030140: 2020 2020 2020 7479 7065 3a20 7374 7269        type: stri
-00030150: 6e67 0d0a 2020 2020 2020 2020 2020 2020  ng..            
-00030160: 7479 7065 206f 6620 6d65 616e 2074 6f20  type of mean to 
-00030170: 706c 6f74 3a0d 0a20 2020 2020 2020 2020  plot:..         
-00030180: 2020 202d 2022 6172 6974 686d 6574 6963     - "arithmetic
-00030190: 2220 666f 7220 6172 6974 686d 6574 6963  " for arithmetic
-000301a0: 206d 6561 6e0d 0a20 2020 2020 2020 2020   mean..         
-000301b0: 2020 202d 2022 7374 6422 2066 6f72 2073     - "std" for s
-000301c0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
-000301d0: 6e0d 0a20 2020 2020 2020 2020 2020 202d  n..            -
-000301e0: 2022 6d65 6469 616e 2220 666f 7220 6d65   "median" for me
-000301f0: 6469 616e 2076 616c 7565 0d0a 2020 2020  dian value..    
-00030200: 2020 2020 765f 6578 3a20 666c 6f61 740d      v_ex: float.
-00030210: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
-00030220: 7469 6361 6c20 6578 6167 6765 7261 7469  tical exaggerati
-00030230: 6f6e 0d0a 2020 2020 2020 2020 696e 7369  on..        insi
-00030240: 6465 5f75 6e69 7473 3a20 6c69 7374 206f  de_units: list o
-00030250: 6620 7374 7269 6e67 206f 7220 3a63 6c61  f string or :cla
-00030260: 7373 3a60 556e 6974 6020 6f62 6a65 6374  ss:`Unit` object
-00030270: 730d 0a20 2020 2020 2020 2020 2020 206c  s..            l
-00030280: 6973 7420 6f66 2075 6e69 7473 2074 6f20  ist of units to 
-00030290: 636f 6e73 6964 6572 2066 6f72 2074 6865  consider for the
-000302a0: 206d 6561 6e0d 0a20 2020 2020 2020 2020   mean..         
-000302b0: 2020 2022 7374 6422 2066 6f72 2073 7461     "std" for sta
-000302c0: 6e64 6172 6420 6465 7669 6174 696f 6e2c  ndard deviation,
-000302d0: 2022 6d65 6469 616e 2220 666f 7220 6d65   "median" for me
-000302e0: 6469 616e 2076 616c 7565 0d0a 2020 2020  dian value..    
-000302f0: 2020 2020 696e 7369 6465 5f66 6163 6965      inside_facie
-00030300: 733a 206c 6973 7420 6f66 2073 7472 696e  s: list of strin
-00030310: 6720 6f72 203a 636c 6173 733a 6046 6163  g or :class:`Fac
-00030320: 6965 7360 206f 626a 6563 7473 0d0a 2020  ies` objects..  
-00030330: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
-00030340: 6620 6661 6369 6573 2074 6f20 636f 6e73  f facies to cons
-00030350: 6964 6572 2066 6f72 2074 6865 206d 6561  ider for the mea
-00030360: 6e0d 0a20 2020 2020 2020 2066 696c 7465  n..        filte
-00030370: 7269 6e67 5f69 6e74 6572 7661 6c3a 206c  ring_interval: l
-00030380: 6973 7420 6f66 2074 776f 2066 6c6f 6174  ist of two float
-00030390: 730d 0a20 2020 2020 2020 2020 2020 2069  s..            i
-000303a0: 6e74 6572 7661 6c20 6f66 2076 616c 7565  nterval of value
-000303b0: 7320 746f 206b 6565 700d 0a20 2020 2020  s to keep..     
-000303c0: 2020 2070 6c6f 7474 6572 3a20 7079 7669     plotter: pyvi
-000303d0: 7374 612e 506c 6f74 7465 720d 0a20 2020  sta.Plotter..   
-000303e0: 2020 2020 2020 2020 2070 7976 6973 7461           pyvista
-000303f0: 2070 6c6f 7474 6572 2074 6f20 706c 6f74   plotter to plot
-00030400: 206f 6e0d 0a20 2020 2020 2020 2073 6c69   on..        sli
-00030410: 6365 783a 2066 6c6f 6174 206f 7220 7365  cex: float or se
-00030420: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
-00030430: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
-00030440: 6163 7469 6f6e 206f 6620 7468 6520 7820  action of the x 
-00030450: 6178 6973 2074 6f20 706c 6f74 0d0a 2020  axis to plot..  
-00030460: 2020 2020 2020 736c 6963 6579 3a20 666c        slicey: fl
-00030470: 6f61 7420 6f72 2073 6571 7565 6e63 6520  oat or sequence 
-00030480: 6f66 2066 6c6f 6174 730d 0a20 2020 2020  of floats..     
-00030490: 2020 2020 2020 2066 7261 6374 696f 6e20         fraction 
-000304a0: 6f66 2074 6865 2079 2061 7869 7320 746f  of the y axis to
-000304b0: 2070 6c6f 740d 0a20 2020 2020 2020 2073   plot..        s
-000304c0: 6c69 6365 7a3a 2066 6c6f 6174 206f 7220  licez: float or 
-000304d0: 7365 7175 656e 6365 206f 6620 666c 6f61  sequence of floa
-000304e0: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
-000304f0: 6672 6163 7469 6f6e 206f 6620 7468 6520  fraction of the 
-00030500: 7a20 6178 6973 2074 6f20 706c 6f74 0d0a  z axis to plot..
-00030510: 2020 2020 2020 2020 636d 696e 3a20 666c          cmin: fl
-00030520: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
-00030530: 206d 696e 696d 756d 2076 616c 7565 2066   minimum value f
-00030540: 6f72 2074 6865 2063 6f6c 6f72 6261 720d  or the colorbar.
-00030550: 0a20 2020 2020 2020 2063 6d61 783a 2066  .        cmax: f
-00030560: 6c6f 6174 0d0a 2020 2020 2020 2020 2020  loat..          
-00030570: 2020 6d61 7869 6d75 6d20 7661 6c75 6520    maximum value 
-00030580: 666f 7220 7468 6520 636f 6c6f 7262 6172  for the colorbar
-00030590: 0d0a 2020 2020 2020 2020 7363 616c 6172  ..        scalar
-000305a0: 5f62 6172 5f6b 7761 7267 733a 2064 6963  _bar_kwargs: dic
-000305b0: 740d 0a20 2020 2020 2020 2020 2020 2064  t..            d
-000305c0: 6963 7469 6f6e 6172 7920 6f66 2061 7267  ictionary of arg
-000305d0: 756d 656e 7473 2074 6f20 7061 7373 2074  uments to pass t
-000305e0: 6f20 7468 6520 7079 7669 7374 6120 7363  o the pyvista sc
-000305f0: 616c 6172 2062 6172 0d0a 0d0a 2020 2020  alar bar....    
-00030600: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00030610: 2020 2023 6c6f 6164 2070 726f 7065 7274     #load propert
-00030620: 7920 6172 7261 7920 616e 6420 6661 6369  y array and faci
-00030630: 6573 2061 7272 6179 0d0a 2020 2020 2020  es array..      
-00030640: 2020 7072 6f70 3d73 656c 662e 6765 745f    prop=self.get_
-00030650: 7072 6f70 2870 726f 7065 7274 7929 2020  prop(property)  
-00030660: 2320 746f 206d 6f64 6966 790d 0a20 2020  # to modify..   
-00030670: 2020 2020 2070 726f 705f 7368 6170 653d       prop_shape=
-00030680: 7072 6f70 2e73 6861 7065 0d0a 2020 2020  prop.shape..    
-00030690: 2020 2020 6661 6369 6573 3d73 656c 662e      facies=self.
-000306a0: 6765 745f 6661 6369 6573 2829 0d0a 2020  get_facies()..  
-000306b0: 2020 2020 2020 6661 6369 6573 5f73 6861        facies_sha
-000306c0: 7065 3d66 6163 6965 732e 7368 6170 650d  pe=facies.shape.
-000306d0: 0a0d 0a20 2020 2020 2020 2023 6b65 6570  ...        #keep
-000306e0: 2076 616c 7565 7320 696e 206f 6e6c 7920   values in only 
-000306f0: 7761 6e74 6564 2075 6e69 7473 0d0a 2020  wanted units..  
-00030700: 2020 2020 2020 6966 2069 6e73 6964 655f        if inside_
-00030710: 756e 6974 7320 6973 206e 6f74 204e 6f6e  units is not Non
-00030720: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00030730: 6e72 6561 6c5f 756e 6974 733d 7365 6c66  nreal_units=self
-00030740: 2e6e 7265 616c 5f75 6e69 7473 2020 2320  .nreal_units  # 
-00030750: 6e75 6d62 6572 206f 6620 756e 6974 7320  number of units 
-00030760: 7265 616c 0d0a 2020 2020 2020 2020 2020  real..          
-00030770: 2020 6d61 736b 5f61 6c6c 3d6e 702e 7a65    mask_all=np.ze
-00030780: 726f 7328 7072 6f70 5f73 6861 7065 290d  ros(prop_shape).
-00030790: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000307a0: 2069 7520 696e 2072 616e 6765 286e 7265   iu in range(nre
-000307b0: 616c 5f75 6e69 7473 293a 0d0a 2020 2020  al_units):..    
-000307c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000307d0: 7520 696e 2069 6e73 6964 655f 756e 6974  u in inside_unit
-000307e0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-000307f0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00030800: 7461 6e63 6528 752c 2073 7472 293a 0d0a  tance(u, str):..
-00030810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030820: 2020 2020 2020 2020 6d61 736b 3d73 656c          mask=sel
-00030830: 662e 756e 6974 5f6d 6173 6b28 752c 2069  f.unit_mask(u, i
-00030840: 753d 6975 290d 0a20 2020 2020 2020 2020  u=iu)..         
-00030850: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00030860: 6973 696e 7374 616e 6365 2875 2c20 556e  isinstance(u, Un
-00030870: 6974 2920 616e 6420 7520 696e 2073 656c  it) and u in sel
-00030880: 662e 6765 745f 616c 6c5f 756e 6974 7328  f.get_all_units(
-00030890: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000308a0: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-000308b0: 3d73 656c 662e 756e 6974 5f6d 6173 6b28  =self.unit_mask(
-000308c0: 752e 6e61 6d65 2c20 6975 3d69 7529 0d0a  u.name, iu=iu)..
-000308d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000308e0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000308f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030900: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00030910: 726f 7220 2822 556e 6974 2070 6173 7365  ror ("Unit passe
-00030920: 6420 696e 2069 6e73 6964 655f 756e 6974  d in inside_unit
-00030930: 7320 6d75 7374 2062 6520 6120 756e 6974  s must be a unit
-00030940: 206e 616d 6520 6f72 2061 2075 6e69 7420   name or a unit 
-00030950: 6f62 6a65 6374 2063 6f6e 7461 696e 6564  object contained
-00030960: 2069 6e20 7468 6520 4172 6368 5461 626c   in the ArchTabl
-00030970: 6522 290d 0a20 2020 2020 2020 2020 2020  e")..           
-00030980: 2020 2020 2020 2020 206d 6173 6b5f 616c           mask_al
-00030990: 6c5b 6975 2c3a 2c3a 2c6d 6173 6b20 3d3d  l[iu,:,:,mask ==
-000309a0: 2031 5d3d 310d 0a0d 0a20 2020 2020 2020   1]=1....       
-000309b0: 2020 2020 2070 726f 705b 6d61 736b 5f61       prop[mask_a
-000309c0: 6c6c 2021 3d20 315d 3d6e 702e 6e61 6e0d  ll != 1]=np.nan.
-000309d0: 0a0d 0a20 2020 2020 2020 2023 6b65 6570  ...        #keep
-000309e0: 2076 616c 7565 7320 696e 206f 6e6c 7920   values in only 
-000309f0: 7761 6e74 6564 2066 6163 6965 730d 0a20  wanted facies.. 
-00030a00: 2020 2020 2020 2069 6620 696e 7369 6465         if inside
-00030a10: 5f66 6163 6965 7320 6973 206e 6f74 204e  _facies is not N
-00030a20: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00030a30: 2020 6d61 736b 5f61 6c6c 3d6e 702e 7a65    mask_all=np.ze
-00030a40: 726f 7328 7072 6f70 5f73 6861 7065 290d  ros(prop_shape).
-00030a50: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00030a60: 2069 7520 696e 2072 616e 6765 286e 7265   iu in range(nre
-00030a70: 616c 5f75 6e69 7473 293a 0d0a 2020 2020  al_units):..    
-00030a80: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00030a90: 6966 6120 696e 2072 616e 6765 2873 656c  ifa in range(sel
-00030aa0: 662e 6e72 6561 6c5f 6661 293a 0d0a 2020  f.nreal_fa):..  
-00030ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ac0: 2020 666f 7220 6661 2069 6e20 696e 7369    for fa in insi
-00030ad0: 6465 5f66 6163 6965 733a 0d0a 2020 2020  de_facies:..    
-00030ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030af0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00030b00: 6528 6661 2c20 7374 7229 3a0d 0a20 2020  e(fa, str):..   
-00030b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b20: 2020 2020 2020 2020 206d 6173 6b3d 2866           mask=(f
-00030b30: 6163 6965 735b 6975 2c69 6661 5d20 3d3d  acies[iu,ifa] ==
-00030b40: 2073 656c 662e 6765 745f 6661 6369 6573   self.get_facies
-00030b50: 5f6f 626a 2866 6129 2e49 4429 0d0a 2020  _obj(fa).ID)..  
-00030b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b70: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00030b80: 7461 6e63 6528 6661 2c20 4661 6369 6573  tance(fa, Facies
-00030b90: 2920 616e 6420 6661 2069 6e20 7365 6c66  ) and fa in self
-00030ba0: 2e67 6574 5f61 6c6c 5f66 6163 6965 7328  .get_all_facies(
-00030bb0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00030bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030bd0: 6d61 736b 3d28 6661 6369 6573 5b69 752c  mask=(facies[iu,
-00030be0: 6966 615d 203d 3d20 6661 2e49 4429 0d0a  ifa] == fa.ID)..
-00030bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030c00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00030c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030c20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00030c30: 2056 616c 7565 4572 726f 7220 2822 556e   ValueError ("Un
-00030c40: 6974 2070 6173 7365 6420 696e 2069 6e73  it passed in ins
-00030c50: 6964 655f 756e 6974 7320 6d75 7374 2062  ide_units must b
-00030c60: 6520 6120 756e 6974 206e 616d 6520 6f72  e a unit name or
-00030c70: 2061 2075 6e69 7420 6f62 6a65 6374 2063   a unit object c
-00030c80: 6f6e 7461 696e 6564 2069 6e20 7468 6520  ontained in the 
-00030c90: 4172 6368 5461 626c 6522 290d 0a20 2020  ArchTable")..   
-00030ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030cb0: 2020 2020 206d 6173 6b5f 616c 6c5b 6975       mask_all[iu
-00030cc0: 2c69 6661 2c3a 2c6d 6173 6b20 3d3d 2031  ,ifa,:,mask == 1
-00030cd0: 5d3d 310d 0a0d 0a20 2020 2020 2020 2020  ]=1....         
-00030ce0: 2020 2070 726f 705b 6d61 736b 5f61 6c6c     prop[mask_all
-00030cf0: 2021 3d20 315d 3d6e 702e 6e61 6e0d 0a0d   != 1]=np.nan...
-00030d00: 0a20 2020 2020 2020 2069 6620 7e70 726f  .        if ~pro
-00030d10: 702e 616e 7928 293a 0d0a 2020 2020 2020  p.any():..      
-00030d20: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00030d30: 6545 7272 6f72 2028 2245 7272 6f72 3a20  eError ("Error: 
-00030d40: 4e6f 2076 616c 7565 7320 666f 756e 6422  No values found"
-00030d50: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-00030d60: 7479 7065 203d 3d20 2261 7269 7468 6d65  type == "arithme
-00030d70: 7469 6322 3a0d 0a20 2020 2020 2020 2020  tic":..         
-00030d80: 2020 2061 7272 3d6e 702e 6e61 6e6d 6561     arr=np.nanmea
-00030d90: 6e28 7072 6f70 2e72 6573 6861 7065 282d  n(prop.reshape(-
-00030da0: 312c 7365 6c66 2e67 6574 5f6e 7a28 292c  1,self.get_nz(),
-00030db0: 7365 6c66 2e67 6574 5f6e 7928 292c 7365  self.get_ny(),se
-00030dc0: 6c66 2e67 6574 5f6e 7828 2929 2c61 7869  lf.get_nx()),axi
-00030dd0: 733d 3029 0d0a 0d0a 2020 2020 2020 2020  s=0)....        
-00030de0: 656c 6966 2074 7970 6520 3d3d 2022 7374  elif type == "st
-00030df0: 6422 3a0d 0a20 2020 2020 2020 2020 2020  d":..           
-00030e00: 2061 7272 3d6e 702e 6e61 6e73 7464 2870   arr=np.nanstd(p
-00030e10: 726f 702e 7265 7368 6170 6528 2d31 2c73  rop.reshape(-1,s
-00030e20: 656c 662e 6765 745f 6e7a 2829 2c73 656c  elf.get_nz(),sel
-00030e30: 662e 6765 745f 6e79 2829 2c73 656c 662e  f.get_ny(),self.
-00030e40: 6765 745f 6e78 2829 292c 6178 6973 3d30  get_nx()),axis=0
-00030e50: 290d 0a0d 0a20 2020 2020 2020 2065 6c69  )....        eli
-00030e60: 6620 7479 7065 203d 3d20 226d 6564 6961  f type == "media
-00030e70: 6e22 3a0d 0a20 2020 2020 2020 2020 2020  n":..           
-00030e80: 2061 7272 3d6e 702e 6e61 6e6d 6564 6961   arr=np.nanmedia
-00030e90: 6e28 7072 6f70 2e72 6573 6861 7065 282d  n(prop.reshape(-
-00030ea0: 312c 7365 6c66 2e67 6574 5f6e 7a28 292c  1,self.get_nz(),
-00030eb0: 7365 6c66 2e67 6574 5f6e 7928 292c 7365  self.get_ny(),se
-00030ec0: 6c66 2e67 6574 5f6e 7828 2929 2c61 7869  lf.get_nx()),axi
-00030ed0: 733d 3029 0d0a 0d0a 2020 2020 2020 2020  s=0)....        
-00030ee0: 7365 6c66 2e70 6c6f 745f 6172 7228 6172  self.plot_arr(ar
-00030ef0: 722c 7072 6f70 6572 7479 2c76 5f65 783d  r,property,v_ex=
-00030f00: 765f 6578 2c20 706c 6f74 7465 723d 706c  v_ex, plotter=pl
-00030f10: 6f74 7465 722c 2073 6c69 6365 783d 736c  otter, slicex=sl
-00030f20: 6963 6578 2c20 736c 6963 6579 3d73 6c69  icex, slicey=sli
-00030f30: 6365 792c 2073 6c69 6365 7a3d 736c 6963  cey, slicez=slic
-00030f40: 657a 2c0d 0a20 2020 2020 2020 2020 2020  ez,..           
-00030f50: 2020 2020 2020 2020 2020 2063 6d69 6e3d             cmin=
-00030f60: 636d 696e 2c20 636d 6178 3d63 6d61 782c  cmin, cmax=cmax,
-00030f70: 2073 6361 6c61 725f 6261 725f 6b77 6172   scalar_bar_kwar
-00030f80: 6773 3d73 6361 6c61 725f 6261 725f 6b77  gs=scalar_bar_kw
-00030f90: 6172 6773 2c20 2a2a 6b77 6172 6773 290d  args, **kwargs).
-00030fa0: 0a0d 0a20 2020 2064 6566 2070 6c6f 745f  ...    def plot_
-00030fb0: 6772 6964 2873 656c 662c 2076 5f65 783d  grid(self, v_ex=
-00030fc0: 3129 3a0d 0a0d 0a20 2020 2020 2020 2022  1):....        "
-00030fd0: 2222 0d0a 2020 2020 2020 2020 4675 6e63  ""..        Func
-00030fe0: 7469 6f6e 2074 6861 7420 706c 6f74 7320  tion that plots 
-00030ff0: 7468 6520 6772 6964 206f 6620 7468 6520  the grid of the 
-00031000: 7369 6d75 6c61 7469 6f6e 2064 6f6d 6169  simulation domai
-00031010: 6e0d 0a0d 0a20 2020 2020 2020 2050 6172  n....        Par
-00031020: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00031030: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00031040: 2020 2020 2076 5f65 783a 2066 6c6f 6174       v_ex: float
-00031050: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
-00031060: 7274 6963 616c 2065 7861 6767 6572 6174  rtical exaggerat
-00031070: 696f 6e0d 0a0d 0a20 2020 2020 2020 2022  ion....        "
-00031080: 2222 0d0a 0d0a 2020 2020 2020 2020 6e78  ""....        nx
-00031090: 3d73 656c 662e 6765 745f 6e78 2829 0d0a  =self.get_nx()..
-000310a0: 2020 2020 2020 2020 6e79 3d73 656c 662e          ny=self.
-000310b0: 6765 745f 6e79 2829 0d0a 2020 2020 2020  get_ny()..      
-000310c0: 2020 6e7a 3d73 656c 662e 6765 745f 6e7a    nz=self.get_nz
-000310d0: 2829 0d0a 2020 2020 2020 2020 7378 3d73  ()..        sx=s
-000310e0: 656c 662e 6765 745f 7378 2829 0d0a 2020  elf.get_sx()..  
-000310f0: 2020 2020 2020 7379 3d73 656c 662e 6765        sy=self.ge
-00031100: 745f 7379 2829 0d0a 2020 2020 2020 2020  t_sy()..        
-00031110: 737a 3d73 656c 662e 6765 745f 737a 2829  sz=self.get_sz()
-00031120: 0d0a 2020 2020 2020 2020 7830 3d73 656c  ..        x0=sel
-00031130: 662e 6765 745f 6f78 2829 0d0a 2020 2020  f.get_ox()..    
-00031140: 2020 2020 7930 3d73 656c 662e 6765 745f      y0=self.get_
-00031150: 6f79 2829 0d0a 2020 2020 2020 2020 7a30  oy()..        z0
-00031160: 3d73 656c 662e 6765 745f 6f7a 2829 0d0a  =self.get_oz()..
-00031170: 0d0a 2020 2020 2020 2020 236c 6f61 6420  ..        #load 
-00031180: 6772 6964 0d0a 2020 2020 2020 2020 6172  grid..        ar
-00031190: 7220 3d20 7365 6c66 2e6d 6173 6b2e 6173  r = self.mask.as
-000311a0: 7479 7065 2866 6c6f 6174 292e 636f 7079  type(float).copy
-000311b0: 2829 0d0a 2020 2020 2020 2020 6172 725b  ()..        arr[
-000311c0: 6172 723d 3d30 5d3d 6e70 2e6e 616e 0d0a  arr==0]=np.nan..
-000311d0: 0d0a 2020 2020 2020 2020 2367 656f 6e65  ..        #geone
-000311e0: 2069 6d61 6765 0d0a 2020 2020 2020 2020   image..        
-000311f0: 696d 3d67 656f 6e65 2e69 6d67 2e49 6d67  im=geone.img.Img
-00031200: 286e 782c 206e 792c 206e 7a2c 2073 782c  (nx, ny, nz, sx,
-00031210: 2073 792c 2073 7a2a 765f 6578 2c20 7830   sy, sz*v_ex, x0
-00031220: 2c20 7930 2c20 7a30 2c20 6e76 3d31 2c20  , y0, z0, nv=1, 
-00031230: 7661 6c3d 6172 722c 2076 6172 6e61 6d65  val=arr, varname
-00031240: 3d22 6772 6964 2229 0d0a 0d0a 2020 2020  ="grid")....    
-00031250: 2020 2020 2370 6c6f 740d 0a20 2020 2020      #plot..     
-00031260: 2020 2069 6d67 706c 7433 2e64 7261 7749     imgplt3.drawI
-00031270: 6d61 6765 3344 5f73 7572 6661 6365 2869  mage3D_surface(i
-00031280: 6d2c 2063 6174 6567 3d54 7275 652c 2063  m, categ=True, c
-00031290: 6174 6567 436f 6c3d 5b22 6c69 6768 7467  ategCol=["lightg
-000312a0: 7265 7922 5d2c 2073 686f 775f 6564 6765  rey"], show_edge
-000312b0: 733d 5472 7565 290d 0a0d 0a0d 0a20 2020  s=True)......   
-000312c0: 2064 6566 2070 6c6f 745f 6172 7228 7365   def plot_arr(se
-000312d0: 6c66 2c61 7272 2c76 6172 5f6e 616d 6520  lf,arr,var_name 
-000312e0: 3d22 5630 222c 765f 6578 3d31 2c20 706c  ="V0",v_ex=1, pl
-000312f0: 6f74 7465 723d 4e6f 6e65 2c20 736c 6963  otter=None, slic
-00031300: 6578 3d4e 6f6e 652c 2073 6c69 6365 793d  ex=None, slicey=
-00031310: 4e6f 6e65 2c20 736c 6963 657a 3d4e 6f6e  None, slicez=Non
-00031320: 652c 2066 696c 7465 7269 6e67 5f69 6e74  e, filtering_int
-00031330: 6572 7661 6c3d 4e6f 6e65 2c0d 0a20 2020  erval=None,..   
-00031340: 2020 2020 2020 2020 2020 2020 2020 636d                cm
-00031350: 696e 3d4e 6f6e 652c 2063 6d61 783d 4e6f  in=None, cmax=No
-00031360: 6e65 2c20 7363 616c 6172 5f62 6172 5f6b  ne, scalar_bar_k
-00031370: 7761 7267 733d 4e6f 6e65 2c20 2a2a 6b77  wargs=None, **kw
-00031380: 6172 6773 293a 0d0a 0d0a 2020 2020 2020  args):....      
-00031390: 2020 2222 220d 0a20 2020 2020 2020 2054    """..        T
-000313a0: 6869 7320 6675 6e63 7469 6f6e 2070 6c6f  his function plo
-000313b0: 7420 6120 3344 2061 7272 6179 2077 6974  t a 3D array wit
-000313c0: 6820 7468 6520 7361 6d65 2073 697a 6520  h the same size 
-000313d0: 6f66 2074 6865 2073 696d 756c 6174 696f  of the simulatio
-000313e0: 6e20 646f 6d61 696e 0d0a 0d0a 2020 2020  n domain....    
-000313f0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00031400: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00031410: 2d2d 0d0a 2020 2020 2020 2020 6172 723a  --..        arr:
-00031420: 2033 4420 6172 7261 790d 0a20 2020 2020   3D array..     
-00031430: 2020 2020 2020 2061 7272 6179 2074 6f20         array to 
-00031440: 706c 6f74 2e20 5369 7a65 206f 6620 7468  plot. Size of th
-00031450: 6520 7369 6d75 6c61 7469 6f6e 2064 6f6d  e simulation dom
-00031460: 6169 6e20 286e 782c 206e 792c 206e 7a29  ain (nx, ny, nz)
-00031470: 2020 200d 0a20 2020 2020 2020 2076 6172     ..        var
-00031480: 5f6e 616d 653a 2073 7472 0d0a 2020 2020  _name: str..    
-00031490: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-000314a0: 206e 616d 6573 2074 6f20 706c 6f74 2061   names to plot a
-000314b0: 6e64 2074 6f20 7368 6f77 2069 6e20 7468  nd to show in th
-000314c0: 6520 7079 7669 7374 6120 706c 6f74 0d0a  e pyvista plot..
-000314d0: 2020 2020 2020 2020 765f 6578 3a20 666c          v_ex: fl
-000314e0: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
-000314f0: 2076 6572 7469 6361 6c20 6578 6167 6765   vertical exagge
-00031500: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
-00031510: 706c 6f74 7465 723a 2070 7976 6973 7461  plotter: pyvista
-00031520: 2e50 6c6f 7474 6572 0d0a 2020 2020 2020  .Plotter..      
-00031530: 2020 2020 2020 7079 7669 7374 6120 706c        pyvista pl
-00031540: 6f74 7465 7220 746f 2070 6c6f 7420 6f6e  otter to plot on
-00031550: 0d0a 2020 2020 2020 2020 736c 6963 6578  ..        slicex
-00031560: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
-00031570: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
-00031580: 2020 2020 2020 2020 2020 2066 7261 6374             fract
-00031590: 696f 6e20 6f66 2074 6865 2078 2061 7869  ion of the x axi
-000315a0: 7320 746f 2070 6c6f 740d 0a20 2020 2020  s to plot..     
-000315b0: 2020 2073 6c69 6365 793a 2066 6c6f 6174     slicey: float
-000315c0: 206f 7220 7365 7175 656e 6365 206f 6620   or sequence of 
-000315d0: 666c 6f61 7473 0d0a 2020 2020 2020 2020  floats..        
-000315e0: 2020 2020 6672 6163 7469 6f6e 206f 6620      fraction of 
-000315f0: 7468 6520 7920 6178 6973 2074 6f20 706c  the y axis to pl
-00031600: 6f74 0d0a 2020 2020 2020 2020 736c 6963  ot..        slic
-00031610: 657a 3a20 666c 6f61 7420 6f72 2073 6571  ez: float or seq
-00031620: 7565 6e63 6520 6f66 2066 6c6f 6174 730d  uence of floats.
-00031630: 0a20 2020 2020 2020 2020 2020 2066 7261  .            fra
-00031640: 6374 696f 6e20 6f66 2074 6865 207a 2061  ction of the z a
-00031650: 7869 7320 746f 2070 6c6f 740d 0a20 2020  xis to plot..   
-00031660: 2020 2020 2066 696c 7465 7269 6e67 5f69       filtering_i
-00031670: 6e74 6572 7661 6c3a 206c 6973 7420 6f66  nterval: list of
-00031680: 2074 776f 2066 6c6f 6174 730d 0a20 2020   two floats..   
-00031690: 2020 2020 2020 2020 2069 6e74 6572 7661           interva
-000316a0: 6c20 6f66 2076 616c 7565 7320 746f 206b  l of values to k
-000316b0: 6565 700d 0a20 2020 2020 2020 2063 6d69  eep..        cmi
-000316c0: 6e3a 2066 6c6f 6174 0d0a 2020 2020 2020  n: float..      
-000316d0: 2020 2020 2020 6d69 6e69 6d75 6d20 7661        minimum va
-000316e0: 6c75 6520 666f 7220 7468 6520 636f 6c6f  lue for the colo
-000316f0: 7262 6172 0d0a 2020 2020 2020 2020 636d  rbar..        cm
-00031700: 6178 3a20 666c 6f61 740d 0a20 2020 2020  ax: float..     
-00031710: 2020 2020 2020 206d 6178 696d 756d 2076         maximum v
-00031720: 616c 7565 2066 6f72 2074 6865 2063 6f6c  alue for the col
-00031730: 6f72 6261 720d 0a20 2020 2020 2020 2073  orbar..        s
-00031740: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
-00031750: 3a20 6469 6374 0d0a 2020 2020 2020 2020  : dict..        
-00031760: 2020 2020 6469 6374 696f 6e61 7279 206f      dictionary o
-00031770: 6620 6172 6775 6d65 6e74 7320 746f 2070  f arguments to p
-00031780: 6173 7320 746f 2074 6865 2070 7976 6973  ass to the pyvis
-00031790: 7461 2073 6361 6c61 7220 6261 720d 0a20  ta scalar bar.. 
-000317a0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-000317b0: 2020 2020 2020 6e78 3d73 656c 662e 6765        nx=self.ge
-000317c0: 745f 6e78 2829 0d0a 2020 2020 2020 2020  t_nx()..        
-000317d0: 6e79 3d73 656c 662e 6765 745f 6e79 2829  ny=self.get_ny()
-000317e0: 0d0a 2020 2020 2020 2020 6e7a 3d73 656c  ..        nz=sel
-000317f0: 662e 6765 745f 6e7a 2829 0d0a 2020 2020  f.get_nz()..    
-00031800: 2020 2020 7378 3d73 656c 662e 6765 745f      sx=self.get_
-00031810: 7378 2829 0d0a 2020 2020 2020 2020 7379  sx()..        sy
-00031820: 3d73 656c 662e 6765 745f 7379 2829 0d0a  =self.get_sy()..
-00031830: 2020 2020 2020 2020 737a 3d73 656c 662e          sz=self.
-00031840: 6765 745f 737a 2829 0d0a 2020 2020 2020  get_sz()..      
-00031850: 2020 7830 3d73 656c 662e 6765 745f 6f78    x0=self.get_ox
-00031860: 2829 0d0a 2020 2020 2020 2020 7930 3d73  ()..        y0=s
-00031870: 656c 662e 6765 745f 6f79 2829 0d0a 2020  elf.get_oy()..  
-00031880: 2020 2020 2020 7a30 3d73 656c 662e 6765        z0=self.ge
-00031890: 745f 6f7a 2829 0d0a 0d0a 2020 2020 2020  t_oz()....      
-000318a0: 2020 6173 7365 7274 2061 7272 2e73 6861    assert arr.sha
-000318b0: 7065 203d 3d20 286e 7a2c 206e 792c 206e  pe == (nz, ny, n
-000318c0: 7829 2c20 2249 6e76 616c 6964 2073 6861  x), "Invalid sha
-000318d0: 7065 2066 6f72 2061 7272 6179 2c20 6d75  pe for array, mu
-000318e0: 7374 2062 6520 6571 7561 6c20 746f 207b  st be equal to {
-000318f0: 7d22 2e66 6f72 6d61 7428 6e7a 2c20 6e79  }".format(nz, ny
-00031900: 2c20 6e78 290d 0a0d 0a20 2020 2020 2020  , nx)....       
-00031910: 2061 7272 203d 2061 7272 2e61 7374 7970   arr = arr.astyp
-00031920: 6528 666c 6f61 7429 2e63 6f70 7928 290d  e(float).copy().
-00031930: 0a0d 0a20 2020 2020 2020 2069 6620 706c  ...        if pl
-00031940: 6f74 7465 7220 6973 204e 6f6e 653a 0d0a  otter is None:..
-00031950: 2020 2020 2020 2020 2020 2020 703d 7076              p=pv
-00031960: 2e50 6c6f 7474 6572 2829 0d0a 2020 2020  .Plotter()..    
-00031970: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00031980: 2020 2020 2020 2070 3d70 6c6f 7474 6572         p=plotter
-00031990: 0d0a 2020 2020 2020 2020 696d 3d67 656f  ..        im=geo
-000319a0: 6e65 2e69 6d67 2e49 6d67 286e 782c 206e  ne.img.Img(nx, n
-000319b0: 792c 206e 7a2c 2073 782c 2073 792c 2073  y, nz, sx, sy, s
-000319c0: 7a2a 765f 6578 2c20 7830 2c20 7930 2c20  z*v_ex, x0, y0, 
-000319d0: 7a30 2c20 6e76 3d31 2c20 7661 6c3d 6172  z0, nv=1, val=ar
-000319e0: 722c 2076 6172 6e61 6d65 3d76 6172 5f6e  r, varname=var_n
-000319f0: 616d 6529 0d0a 0d0a 2020 2020 2020 2020  ame)....        
-00031a00: 6966 2073 6c69 6365 7820 6973 206e 6f74  if slicex is not
-00031a10: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00031a20: 2020 2020 736c 6963 6578 3d6e 702e 6172      slicex=np.ar
-00031a30: 7261 7928 736c 6963 6578 290d 0a20 2020  ray(slicex)..   
-00031a40: 2020 2020 2020 2020 2073 6c69 6365 785b           slicex[
-00031a50: 736c 6963 6578 3c30 5d3d 300d 0a20 2020  slicex<0]=0..   
-00031a60: 2020 2020 2020 2020 2073 6c69 6365 785b           slicex[
-00031a70: 736c 6963 6578 3e31 5d3d 310d 0a20 2020  slicex>1]=1..   
-00031a80: 2020 2020 2020 2020 2063 783d 696d 2e6f           cx=im.o
-00031a90: 7820 2b20 736c 6963 6578 202a 2069 6d2e  x + slicex * im.
-00031aa0: 6e78 202a 2069 6d2e 7378 2020 2320 6365  nx * im.sx  # ce
-00031ab0: 6e74 6572 2061 6c6f 6e67 2078 0d0a 2020  nter along x..  
-00031ac0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00031ad0: 2020 2020 2020 2020 2063 783d 4e6f 6e65           cx=None
-00031ae0: 0d0a 2020 2020 2020 2020 6966 2073 6c69  ..        if sli
-00031af0: 6365 7920 6973 206e 6f74 204e 6f6e 653a  cey is not None:
-00031b00: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
-00031b10: 6963 6579 3d6e 702e 6172 7261 7928 736c  icey=np.array(sl
-00031b20: 6963 6579 290d 0a20 2020 2020 2020 2020  icey)..         
-00031b30: 2020 2073 6c69 6365 795b 736c 6963 6579     slicey[slicey
-00031b40: 3c30 5d3d 300d 0a20 2020 2020 2020 2020  <0]=0..         
-00031b50: 2020 2073 6c69 6365 795b 736c 6963 6579     slicey[slicey
-00031b60: 3e31 5d3d 310d 0a20 2020 2020 2020 2020  >1]=1..         
-00031b70: 2020 2063 793d 696d 2e6f 7920 2b20 736c     cy=im.oy + sl
-00031b80: 6963 6579 202a 2069 6d2e 6e79 202a 2069  icey * im.ny * i
-00031b90: 6d2e 7379 2020 2320 6365 6e74 6572 2061  m.sy  # center a
-00031ba0: 6c6f 6e67 2079 0d0a 2020 2020 2020 2020  long y..        
-00031bb0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00031bc0: 2020 2063 793d 4e6f 6e65 0d0a 2020 2020     cy=None..    
-00031bd0: 2020 2020 6966 2073 6c69 6365 7a20 6973      if slicez is
-00031be0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00031bf0: 2020 2020 2020 2020 736c 6963 657a 3d6e          slicez=n
-00031c00: 702e 6172 7261 7928 736c 6963 657a 290d  p.array(slicez).
-00031c10: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-00031c20: 6365 7a5b 736c 6963 657a 3c30 5d3d 300d  cez[slicez<0]=0.
-00031c30: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
-00031c40: 6365 7a5b 736c 6963 657a 3e31 5d3d 310d  cez[slicez>1]=1.
-00031c50: 0a20 2020 2020 2020 2020 2020 2063 7a3d  .            cz=
-00031c60: 696d 2e6f 7a20 2b20 736c 6963 657a 202a  im.oz + slicez *
-00031c70: 2069 6d2e 6e7a 202a 2069 6d2e 737a 2020   im.nz * im.sz  
-00031c80: 2320 6365 6e74 6572 2061 6c6f 6e67 207a  # center along z
-00031c90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00031ca0: 0a20 2020 2020 2020 2020 2020 2063 7a3d  .            cz=
-00031cb0: 4e6f 6e65 0d0a 0d0a 2020 2020 2020 2020  None....        
-00031cc0: 2320 6669 6c74 6572 2076 616c 7565 730d  # filter values.
-00031cd0: 0a20 2020 2020 2020 2069 6620 6669 6c74  .        if filt
-00031ce0: 6572 696e 675f 696e 7465 7276 616c 2069  ering_interval i
-00031cf0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
-00031d00: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00031d10: 7374 616e 6365 2866 696c 7465 7269 6e67  stance(filtering
-00031d20: 5f69 6e74 6572 7661 6c2c 206c 6973 7429  _interval, list)
-00031d30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00031d40: 2020 2069 6620 6c65 6e28 6669 6c74 6572     if len(filter
-00031d50: 696e 675f 696e 7465 7276 616c 2920 3d3d  ing_interval) ==
-00031d60: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
-00031d70: 2020 2020 2020 2020 2069 6620 6669 6c74           if filt
-00031d80: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
-00031d90: 5d20 3c20 6669 6c74 6572 696e 675f 696e  ] < filtering_in
-00031da0: 7465 7276 616c 5b31 5d3a 0d0a 2020 2020  terval[1]:..    
-00031db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031dc0: 2020 2020 6172 725b 6172 7220 3c20 6669      arr[arr < fi
-00031dd0: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
-00031de0: 5b30 5d5d 203d 206e 702e 6e61 6e0d 0a20  [0]] = np.nan.. 
-00031df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e00: 2020 2020 2020 2061 7272 5b61 7272 203e         arr[arr >
-00031e10: 2066 696c 7465 7269 6e67 5f69 6e74 6572   filtering_inter
-00031e20: 7661 6c5b 315d 5d20 3d20 6e70 2e6e 616e  val[1]] = np.nan
-00031e30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00031e40: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00031e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031e60: 2020 2020 2070 7269 6e74 2822 6669 6c74       print("filt
-00031e70: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
-00031e80: 5d20 6d75 7374 2062 6520 736d 616c 6c65  ] must be smalle
-00031e90: 7220 7468 616e 2066 696c 7465 7269 6e67  r than filtering
-00031ea0: 5f69 6e74 6572 7661 6c5b 315d 2229 0d0a  _interval[1]")..
-00031eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031ec0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00031ed0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00031ee0: 2822 6669 6c74 6572 696e 675f 696e 7465  ("filtering_inte
-00031ef0: 7276 616c 206d 7573 7420 6265 2061 206c  rval must be a l
-00031f00: 6973 7420 6f66 2074 776f 2076 616c 7565  ist of two value
-00031f10: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
-00031f20: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00031f30: 2020 2020 2020 2020 7072 696e 7428 2266          print("f
-00031f40: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
-00031f50: 6c20 6d75 7374 2062 6520 6120 6c69 7374  l must be a list
-00031f60: 206f 6620 7477 6f20 7661 6c75 6573 2229   of two values")
-00031f70: 0d0a 0d0a 2020 2020 2020 2020 6966 2073  ....        if s
-00031f80: 6c69 6365 7820 6973 206e 6f74 204e 6f6e  licex is not Non
-00031f90: 6520 6f72 2073 6c69 6365 7920 6973 206e  e or slicey is n
-00031fa0: 6f74 204e 6f6e 6520 6f72 2073 6c69 6365  ot None or slice
-00031fb0: 7a20 6973 206e 6f74 204e 6f6e 653a 0d0a  z is not None:..
-00031fc0: 2020 2020 2020 2020 2020 2020 696d 6770              imgp
-00031fd0: 6c74 332e 6472 6177 496d 6167 6533 445f  lt3.drawImage3D_
-00031fe0: 736c 6963 6528 696d 2c20 706c 6f74 7465  slice(im, plotte
-00031ff0: 723d 702c 2073 6c69 6365 5f6e 6f72 6d61  r=p, slice_norma
-00032000: 6c5f 783d 6378 2c20 736c 6963 655f 6e6f  l_x=cx, slice_no
-00032010: 726d 616c 5f79 3d63 792c 2073 6c69 6365  rmal_y=cy, slice
-00032020: 5f6e 6f72 6d61 6c5f 7a3d 637a 2c20 636d  _normal_z=cz, cm
-00032030: 696e 3d63 6d69 6e2c 2063 6d61 783d 636d  in=cmin, cmax=cm
-00032040: 6178 0d0a 2020 2020 2020 2020 2020 2020  ax..            
-00032050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032060: 2020 2020 2020 2020 2020 2c20 7363 616c            , scal
-00032070: 6172 5f62 6172 5f6b 7761 7267 733d 7363  ar_bar_kwargs=sc
-00032080: 616c 6172 5f62 6172 5f6b 7761 7267 732c  alar_bar_kwargs,
-00032090: 202a 2a6b 7761 7267 7329 0d0a 2020 2020   **kwargs)..    
-000320a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000320b0: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
-000320c0: 7261 7749 6d61 6765 3344 5f73 7572 6661  rawImage3D_surfa
-000320d0: 6365 2869 6d2c 2070 6c6f 7474 6572 3d70  ce(im, plotter=p
-000320e0: 2c20 636d 696e 3d63 6d69 6e2c 2063 6d61  , cmin=cmin, cma
-000320f0: 783d 636d 6178 2c0d 0a20 2020 2020 2020  x=cmax,..       
-00032100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032120: 2020 7363 616c 6172 5f62 6172 5f6b 7761    scalar_bar_kwa
-00032130: 7267 733d 7363 616c 6172 5f62 6172 5f6b  rgs=scalar_bar_k
-00032140: 7761 7267 732c 202a 2a6b 7761 7267 7329  wargs, **kwargs)
-00032150: 0d0a 0d0a 2020 2020 2020 2020 6966 2070  ....        if p
-00032160: 6c6f 7474 6572 2069 7320 4e6f 6e65 3a0d  lotter is None:.
-00032170: 0a20 2020 2020 2020 2020 2020 2070 2e61  .            p.a
-00032180: 6464 5f62 6f75 6e64 696e 675f 626f 7828  dd_bounding_box(
-00032190: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-000321a0: 2e73 686f 775f 6178 6573 2829 0d0a 2020  .show_axes()..  
-000321b0: 2020 2020 2020 2020 2020 702e 7368 6f77            p.show
-000321c0: 2829 0d0a 0d0a 0d0a 2020 2020 2363 726f  ()......    #cro
-000321d0: 7373 2073 6563 7469 6f6e 730d 0a20 2020  ss sections..   
-000321e0: 2064 6566 2064 7261 775f 6372 6f73 735f   def draw_cross_
-000321f0: 7365 6374 696f 6e28 7365 6c66 2c20 6261  section(self, ba
-00032200: 636b 6772 6f75 6e64 3d22 756e 6974 7322  ckground="units"
-00032210: 2c20 6975 3d30 2c20 6966 613d 3029 3a0d  , iu=0, ifa=0):.
-00032220: 0a0d 0a20 2020 2020 2020 2065 7874 656e  ...        exten
-00032230: 7420 203d 205b 7365 6c66 2e67 6574 5f6f  t  = [self.get_o
-00032240: 7828 292c 2073 656c 662e 6765 745f 7867  x(), self.get_xg
-00032250: 2829 5b2d 315d 2c20 7365 6c66 2e67 6574  ()[-1], self.get
-00032260: 5f6f 7928 292c 2073 656c 662e 6765 745f  _oy(), self.get_
-00032270: 7967 2829 5b2d 315d 5d0d 0a0d 0a20 2020  yg()[-1]]....   
-00032280: 2020 2020 2069 6620 6261 636b 6772 6f75       if backgrou
-00032290: 6e64 203d 3d20 2275 6e69 7473 223a 2020  nd == "units":  
-000322a0: 2320 6164 6420 6f70 7469 6f6e 2074 6f20  # add option to 
-000322b0: 7061 7373 2072 6173 7465 7273 0d0a 2020  pass rasters..  
-000322c0: 2020 2020 2020 2020 2020 6261 636b 5f6d            back_m
-000322d0: 6170 203d 2073 656c 662e 636f 6d70 7574  ap = self.comput
-000322e0: 655f 6765 6f6c 5f6d 6170 2830 2c20 636f  e_geol_map(0, co
-000322f0: 6c6f 7220 3d20 5472 7565 290d 0a20 2020  lor = True)..   
-00032300: 2020 2020 2020 2020 2070 6c74 2e69 6d73           plt.ims
-00032310: 686f 7728 6261 636b 5f6d 6170 2c20 6f72  how(back_map, or
-00032320: 6967 696e 3d22 6c6f 7765 7222 2c20 6578  igin="lower", ex
-00032330: 7465 6e74 3d65 7874 656e 7429 0d0a 0d0a  tent=extent)....
-00032340: 2020 2020 2020 2020 656c 7365 3a20 200d          else:  .
-00032350: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00032360: 730d 0a20 2020 2020 2020 200d 0a20 2020  s..        ..   
-00032370: 2020 2020 2070 5f6c 6973 7420 3d20 706c       p_list = pl
-00032380: 742e 6769 6e70 7574 286e 3d2d 312c 2074  t.ginput(n=-1, t
-00032390: 696d 656f 7574 3d30 290d 0a20 2020 2020  imeout=0)..     
-000323a0: 2020 2070 6c74 2e63 6c6f 7365 2829 0d0a     plt.close()..
-000323b0: 0d0a 2020 2020 2020 2020 2323 2064 7261  ..        ## dra
-000323c0: 7720 6372 6f73 732d 7365 6374 696f 6e20  w cross-section 
-000323d0: 706f 7369 7469 6f6e 0d0a 2020 2020 2020  position..      
-000323e0: 2020 706c 742e 696d 7368 6f77 2862 6163    plt.imshow(bac
-000323f0: 6b5f 6d61 702c 206f 7269 6769 6e3d 226c  k_map, origin="l
-00032400: 6f77 6572 222c 2065 7874 656e 743d 6578  ower", extent=ex
-00032410: 7465 6e74 290d 0a20 2020 2020 2020 2070  tent)..        p
-00032420: 6c74 2e70 6c6f 7428 5b69 5b30 5d20 666f  lt.plot([i[0] fo
-00032430: 7220 6920 696e 2070 5f6c 6973 745d 2c20  r i in p_list], 
-00032440: 5b69 5b31 5d20 666f 7220 6920 696e 2070  [i[1] for i in p
-00032450: 5f6c 6973 745d 2c20 633d 2272 6564 2229  _list], c="red")
-00032460: 0d0a 2020 2020 2020 2020 706c 742e 7368  ..        plt.sh
-00032470: 6f77 2829 0d0a 0d0a 2020 2020 2020 2020  ow()....        
-00032480: 7265 7475 726e 2070 5f6c 6973 740d 0a0d  return p_list...
-00032490: 0a0d 0a20 2020 2064 6566 2063 726f 7373  ...    def cross
-000324a0: 5f73 6563 7469 6f6e 2873 656c 662c 2061  _section(self, a
-000324b0: 7272 5f74 6f5f 706c 6f74 2c20 705f 6c69  rr_to_plot, p_li
-000324c0: 7374 2c20 6573 703d 4e6f 6e65 293a 0d0a  st, esp=None):..
-000324d0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000324e0: 2020 2020 2020 2052 6574 7572 6e20 6120         Return a 
-000324f0: 6372 6f73 7320 7365 6374 696f 6e20 616c  cross section al
-00032500: 6f6e 6720 7468 6520 706f 696e 7473 2070  ong the points p
-00032510: 6173 7320 696e 2070 5f6c 6973 740d 0a0d  ass in p_list...
-00032520: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00032530: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00032540: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00032550: 2061 7272 5f74 6f5f 706c 6f74 3a20 3344   arr_to_plot: 3D
-00032560: 206f 7220 3444 2061 7272 6179 206f 6620   or 4D array of 
-00032570: 6469 6d65 6e73 696f 6e20 6e7a 2c20 6e79  dimension nz, ny
-00032580: 2c20 6e78 282c 2034 290d 0a20 2020 2020  , nx(, 4)..     
-00032590: 2020 2020 2020 2061 7272 6179 206f 6620         array of 
-000325a0: 7768 6963 6820 7765 2077 616e 7420 6120  which we want a 
-000325b0: 6372 6f73 7320 7365 6374 696f 6e2e 0d0a  cross section...
-000325c0: 2020 2020 2020 2020 2020 2020 5468 6973              This
-000325d0: 2061 7272 6179 2077 696c 6c20 6265 2063   array will be c
-000325e0: 6f6e 7369 6465 7265 6420 6265 696e 6720  onsidered being 
-000325f0: 7061 7274 206f 6620 7468 6520 4172 6368  part of the Arch
-00032600: 5079 2073 696d 756c 6174 696f 6e20 646f  Py simulation do
-00032610: 6d61 696e 2e0d 0a20 2020 2020 2020 2070  main...        p
-00032620: 5f6c 6973 743a 2073 6571 7565 6e63 6520  _list: sequence 
-00032630: 6f66 2074 7570 6c65 0d0a 2020 2020 2020  of tuple..      
-00032640: 2020 2020 2020 6c69 7374 206f 7220 6172        list or ar
-00032650: 7261 7920 6f66 2074 7570 6c65 2063 6f6e  ray of tuple con
-00032660: 7461 696e 696e 6720 7820 616e 6420 7920  taining x and y 
-00032670: 636f 6f72 6469 6e61 7465 730d 0a20 2020  coordinates..   
-00032680: 2020 2020 2020 2020 2028 652e 672e 2070           (e.g. p
-00032690: 5f6c 6973 743d 5b28 3130 302c 2032 3030  _list=[(100, 200
-000326a0: 292c 2028 3330 302c 2032 3030 295d 202d  ), (300, 200)] -
-000326b0: 2d3e 2064 7261 7720 6120 6372 6f73 7320  -> draw a cross 
-000326c0: 7365 6374 696f 6e20 6265 7477 6565 6e20  section between 
-000326d0: 7468 6573 6520 7477 6f20 706f 696e 7473  these two points
-000326e0: 290d 0a20 2020 2020 2020 2065 7370 3a20  )..        esp: 
-000326f0: 666c 6f61 740d 0a20 2020 2020 2020 2020  float..         
-00032700: 2020 2073 7061 6369 6e67 2074 6f20 7573     spacing to us
-00032710: 6520 7768 656e 2073 616d 706c 696e 6720  e when sampling 
-00032720: 7468 6520 6172 7261 7920 616c 6f6e 6720  the array along 
-00032730: 7468 6520 6372 6f73 7320 7365 6374 696f  the cross sectio
-00032740: 6e0d 0a20 2020 2020 2020 2020 2020 200d  n..            .
-00032750: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00032760: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00032770: 2d0d 0a20 2020 2020 2020 2032 4420 6172  -..        2D ar
-00032780: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
-00032790: 2063 726f 7373 2073 6563 7469 6f6e 2072   cross section r
-000327a0: 6561 6479 2074 6f20 706c 6f74 0d0a 2020  eady to plot..  
-000327b0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000327c0: 2020 2020 206f 783d 7365 6c66 2e67 6574       ox=self.get
-000327d0: 5f6f 7828 290d 0a20 2020 2020 2020 206f  _ox()..        o
-000327e0: 793d 7365 6c66 2e67 6574 5f6f 7928 290d  y=self.get_oy().
-000327f0: 0a20 2020 2020 2020 2073 783d 7365 6c66  .        sx=self
-00032800: 2e67 6574 5f73 7828 290d 0a20 2020 2020  .get_sx()..     
-00032810: 2020 2073 793d 7365 6c66 2e67 6574 5f73     sy=self.get_s
-00032820: 7928 290d 0a0d 0a20 2020 2020 2020 2069  y()....        i
-00032830: 6620 6573 7020 6973 204e 6f6e 653a 0d0a  f esp is None:..
-00032840: 2020 2020 2020 2020 2020 2020 6573 703d              esp=
-00032850: 2873 656c 662e 6765 745f 7378 2829 2a2a  (self.get_sx()**
-00032860: 322b 7365 6c66 2e67 6574 5f73 7928 292a  2+self.get_sy()*
-00032870: 2a32 292a 2a30 2e35 0d0a 0d0a 2020 2020  *2)**0.5....    
-00032880: 2020 2020 6469 7374 5f74 6f74 3d30 0d0a      dist_tot=0..
-00032890: 2020 2020 2020 2020 666f 7220 6970 2069          for ip i
-000328a0: 6e20 7261 6e67 6528 6c65 6e28 705f 6c69  n range(len(p_li
-000328b0: 7374 292d 3129 3a20 2320 6c6f 6f70 206f  st)-1): # loop o
-000328c0: 7665 7220 706f 696e 7473 0d0a 2020 2020  ver points..    
-000328d0: 2020 2020 2020 2020 7031 3d6e 702e 6172          p1=np.ar
-000328e0: 7261 7928 705f 6c69 7374 5b69 705d 290d  ray(p_list[ip]).
-000328f0: 0a20 2020 2020 2020 2020 2020 2070 323d  .            p2=
-00032900: 6e70 2e61 7272 6179 2870 5f6c 6973 745b  np.array(p_list[
-00032910: 6970 2b31 5d29 0d0a 2020 2020 2020 2020  ip+1])..        
-00032920: 2020 2020 6431 2c20 6432 3d70 322d 7031      d1, d2=p2-p1
-00032930: 0d0a 2020 2020 2020 2020 2020 2020 6469  ..            di
-00032940: 7374 3d6e 702e 7371 7274 2864 312a 2a32  st=np.sqrt(d1**2
-00032950: 202b 2064 322a 2a32 290d 0a20 2020 2020   + d2**2)..     
-00032960: 2020 2020 2020 206c 616d 3d65 7370 2f64         lam=esp/d
-00032970: 6973 740d 0a0d 0a20 2020 2020 2020 2020  ist....         
-00032980: 2020 2078 5f64 2c20 795f 643d 7031 2020     x_d, y_d=p1  
-00032990: 2320 7374 6172 7469 6e67 2070 6f69 6e74  # starting point
-000329a0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000329b0: 663d 6172 725f 746f 5f70 6c6f 742e 636f  f=arr_to_plot.co
-000329c0: 7079 2829 0d0a 2020 2020 2020 2020 2020  py()..          
-000329d0: 2020 6e6f 5f63 6f6c 6f72 3d46 616c 7365    no_color=False
-000329e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000329f0: 206c 656e 2866 2e73 6861 7065 2920 3d3d   len(f.shape) ==
-00032a00: 2034 3a0d 0a20 2020 2020 2020 2020 2020   4:..           
-00032a10: 2020 2020 206e 6f5f 636f 6c6f 723d 4661       no_color=Fa
-00032a20: 6c73 650d 0a20 2020 2020 2020 2020 2020  lse..           
-00032a30: 2020 2020 2078 5f73 6563 5f69 3d6e 702e       x_sec_i=np.
-00032a40: 7a65 726f 7328 5b66 2e73 6861 7065 5b30  zeros([f.shape[0
-00032a50: 5d2c 2069 6e74 2864 6973 742f 6573 7029  ], int(dist/esp)
-00032a60: 2b31 2c20 345d 290d 0a20 2020 2020 2020  +1, 4])..       
-00032a70: 2020 2020 2020 2020 2069 6620 6970 203d           if ip =
-00032a80: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-00032a90: 2020 2020 2020 2020 2020 785f 7365 633d            x_sec=
-00032aa0: 6e70 2e7a 6572 6f73 285b 662e 7368 6170  np.zeros([f.shap
-00032ab0: 655b 305d 2c20 696e 7428 6469 7374 2f65  e[0], int(dist/e
-00032ac0: 7370 292b 312c 2034 5d29 0d0a 2020 2020  sp)+1, 4])..    
-00032ad0: 2020 2020 2020 2020 656c 6966 206c 656e          elif len
-00032ae0: 2866 2e73 6861 7065 2920 3d3d 2033 3a0d  (f.shape) == 3:.
-00032af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032b00: 206e 6f5f 636f 6c6f 723d 5472 7565 0d0a   no_color=True..
-00032b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b20: 785f 7365 635f 693d 6e70 2e7a 6572 6f73  x_sec_i=np.zeros
-00032b30: 285b 662e 7368 6170 655b 305d 2c69 6e74  ([f.shape[0],int
-00032b40: 2864 6973 742f 6573 7029 2b31 5d29 0d0a  (dist/esp)+1])..
-00032b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b60: 6966 2069 7020 3d3d 2030 3a0d 0a20 2020  if ip == 0:..   
-00032b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032b80: 2078 5f73 6563 3d6e 702e 7a65 726f 7328   x_sec=np.zeros(
-00032b90: 5b66 2e73 6861 7065 5b30 5d2c 696e 7428  [f.shape[0],int(
-00032ba0: 6469 7374 2f65 7370 292b 315d 290d 0a0d  dist/esp)+1])...
-00032bb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00032bc0: 6e6f 5f63 6f6c 6f72 3a0d 0a20 2020 2020  no_color:..     
-00032bd0: 2020 2020 2020 2020 2020 2069 3d30 0d0a             i=0..
-00032be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032bf0: 666f 7220 6f20 696e 206e 702e 6172 616e  for o in np.aran
-00032c00: 6765 2830 2c64 6973 742c 6573 7029 3a0d  ge(0,dist,esp):.
-00032c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032c20: 2020 2020 2078 5f64 202b 3d20 6431 2a6c       x_d += d1*l
-00032c30: 616d 0d0a 2020 2020 2020 2020 2020 2020  am..            
-00032c40: 2020 2020 2020 2020 795f 6420 2b3d 2064          y_d += d
-00032c50: 322a 6c61 6d0d 0a20 2020 2020 2020 2020  2*lam..         
-00032c60: 2020 2020 2020 2020 2020 2069 783d 696e             ix=in
-00032c70: 7428 2878 5f64 202d 206f 7829 2f73 7829  t((x_d - ox)/sx)
-00032c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032c90: 2020 2020 2020 6979 3d69 6e74 2828 795f        iy=int((y_
-00032ca0: 6420 2d20 6f79 292f 7379 290d 0a20 2020  d - oy)/sy)..   
-00032cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032cc0: 2066 703d 665b 3a2c 6979 2c69 785d 0d0a   fp=f[:,iy,ix]..
-00032cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ce0: 2020 2020 6966 2069 7020 3d3d 2030 3a0d      if ip == 0:.
-00032cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032d00: 2020 2020 2020 2020 2078 5f73 6563 5b3a           x_sec[:
-00032d10: 2c69 5d3d 6670 0d0a 2020 2020 2020 2020  ,i]=fp..        
-00032d20: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00032d30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00032d40: 2020 2020 2020 2020 2020 2078 5f73 6563             x_sec
-00032d50: 5f69 5b3a 2c69 5d3d 6670 0d0a 2020 2020  _i[:,i]=fp..    
-00032d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d70: 6920 2b3d 2031 0d0a 2020 2020 2020 2020  i += 1..        
-00032d80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00032d90: 2020 2020 2020 2020 2020 2069 3d30 0d0a             i=0..
-00032da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032db0: 666f 7220 6f20 696e 206e 702e 6172 616e  for o in np.aran
-00032dc0: 6765 2830 2c64 6973 742c 6573 7029 3a0d  ge(0,dist,esp):.
+0002ae60: 2020 2020 2020 2020 685f 6c65 763d 732e          h_lev=s.
+0002ae70: 6765 745f 685f 6c65 7665 6c28 2920 2023  get_h_level()  #
+0002ae80: 2068 6965 7261 7263 6869 6361 6c20 6c65   hierarchical le
+0002ae90: 7665 6c20 6f66 2075 6e69 740d 0a20 2020  vel of unit..   
+0002aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aeb0: 2020 2020 2020 2020 2069 6620 685f 6c65           if h_le
+0002aec0: 7620 3e20 685f 6c65 7665 6c3a 2020 2320  v > h_level:  # 
+0002aed0: 636f 6d70 6172 6520 756e 6974 206c 6576  compare unit lev
+0002aee0: 656c 2077 6974 6820 6c65 7665 6c20 746f  el with level to
+0002aef0: 2070 6c6f 740d 0a20 2020 2020 2020 2020   plot..         
+0002af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af10: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0002af20: 7261 6e67 6528 685f 6c65 7620 2d20 685f  range(h_lev - h_
+0002af30: 6c65 7665 6c29 3a0d 0a20 2020 2020 2020  level):..       
+0002af40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af50: 2020 2020 2020 2020 2020 2020 2073 3d73               s=s
+0002af60: 2e6d 756d 6d79 5f75 6e69 740d 0a20 2020  .mummy_unit..   
+0002af70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002af90: 7320 6973 204e 6f6e 653a 0d0a 2020 2020  s is None:..    
+0002afa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afc0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002afd0: 2822 4572 726f 723a 2070 6172 656e 7420  ("Error: parent 
+0002afe0: 756e 6974 2072 6574 7572 6e20 6973 204e  unit return is N
+0002aff0: 6f6e 652c 2068 6965 7261 7263 6879 2072  one, hierarchy r
+0002b000: 656c 6174 696f 6e73 2061 7265 2069 6e63  elations are inc
+0002b010: 6f6e 7369 7374 656e 7420 7769 7468 2050  onsistent with P
+0002b020: 696c 6520 616e 6420 7369 6d75 6c61 7469  ile and simulati
+0002b030: 6f6e 7322 290d 0a20 2020 2020 2020 2020  ons")..         
+0002b040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b050: 2020 2020 2020 2075 6e69 7473 5f64 6f6d         units_dom
+0002b060: 6169 6e73 5b75 6e69 7473 5f64 6f6d 6169  ains[units_domai
+0002b070: 6e73 203d 3d20 6964 785d 3d73 2e49 4420  ns == idx]=s.ID 
+0002b080: 2023 2063 6861 6e67 6520 4944 2076 616c   # change ID val
+0002b090: 7565 7320 746f 204d 756d 6d79 2049 440d  ues to Mummy ID.
+0002b0a0: 0a0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+0002b0b0: 2065 6c69 6620 6669 6c6c 203d 3d20 2263   elif fill == "c
+0002b0c0: 6f6c 6f72 223a 0d0a 2020 2020 2020 2020  olor":..        
+0002b0d0: 2020 2020 2020 2020 6e7a 2c20 6e79 2c20          nz, ny, 
+0002b0e0: 6e78 3d75 642e 7368 6170 650d 0a20 2020  nx=ud.shape..   
+0002b0f0: 2020 2020 2020 2020 2020 2020 2075 6e69               uni
+0002b100: 7473 5f64 6f6d 6169 6e73 3d6e 702e 7a65  ts_domains=np.ze
+0002b110: 726f 7328 5b6e 7a2c 206e 792c 206e 782c  ros([nz, ny, nx,
+0002b120: 2034 5d29 0d0a 2020 2020 2020 2020 2020   4])..          
+0002b130: 2020 2020 2020 666f 7220 756e 6974 2069        for unit i
+0002b140: 6e20 7365 6c66 2e67 6574 5f61 6c6c 5f75  n self.get_all_u
+0002b150: 6e69 7473 2829 3a0d 0a20 2020 2020 2020  nits():..       
+0002b160: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002b170: 756e 6974 2e66 5f6d 6574 686f 6420 213d  unit.f_method !=
+0002b180: 2022 5375 6270 696c 6522 3a0d 0a20 2020   "Subpile":..   
+0002b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b1a0: 2020 2020 206d 6173 6b3d 2875 6420 3d3d       mask=(ud ==
+0002b1b0: 2075 6e69 742e 4944 290d 0a20 2020 2020   unit.ID)..     
+0002b1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b1d0: 2020 2075 6e69 7473 5f64 6f6d 6169 6e73     units_domains
+0002b1e0: 5b6d 6173 6b2c 3a20 5d3d 6d61 7470 6c6f  [mask,: ]=matplo
+0002b1f0: 746c 6962 2e63 6f6c 6f72 732e 746f 5f72  tlib.colors.to_r
+0002b200: 6762 6128 756e 6974 2e63 290d 0a0d 0a20  gba(unit.c).... 
+0002b210: 2020 2020 2020 2072 6574 7572 6e20 756e         return un
+0002b220: 6974 735f 646f 6d61 696e 730d 0a0d 0a0d  its_domains.....
+0002b230: 0a20 2020 2064 6566 2070 6c6f 745f 756e  .    def plot_un
+0002b240: 6974 7328 7365 6c66 2c20 6975 3d30 2c20  its(self, iu=0, 
+0002b250: 765f 6578 3d31 2c20 706c 6f74 7465 723d  v_ex=1, plotter=
+0002b260: 4e6f 6e65 2c20 685f 6c65 7665 6c3d 2261  None, h_level="a
+0002b270: 6c6c 222c 2073 6c69 6365 783d 4e6f 6e65  ll", slicex=None
+0002b280: 2c20 736c 6963 6579 3d4e 6f6e 652c 2073  , slicey=None, s
+0002b290: 6c69 6365 7a3d 4e6f 6e65 2c0d 0a20 2020  licez=None,..   
+0002b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b2b0: 6578 636c 7564 6564 5661 6c3d 4e6f 6e65  excludedVal=None
+0002b2c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0002b2d0: 2020 2020 2020 2073 6361 6c61 725f 6261         scalar_ba
+0002b2e0: 725f 6b77 6172 6773 3d4e 6f6e 652c 2073  r_kwargs=None, s
+0002b2f0: 686f 775f 7363 616c 6172 5f62 6172 3d54  how_scalar_bar=T
+0002b300: 7275 652c 202a 2a6b 7761 7267 7329 3a0d  rue, **kwargs):.
+0002b310: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+0002b320: 2020 2020 2020 2020 706c 6f74 2075 6e69          plot uni
+0002b330: 7473 2064 6f6d 6169 6e20 666f 7220 6120  ts domain for a 
+0002b340: 7370 6563 6966 6963 2072 6561 6c69 7a61  specific realiza
+0002b350: 7469 6f6e 2069 750d 0a0d 0a20 2020 2020  tion iu....     
+0002b360: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0002b370: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002b380: 2d0d 0a20 2020 2020 2020 2069 753a 2069  -..        iu: i
+0002b390: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
+0002b3a0: 756e 6974 2069 6e64 6578 2074 6f20 706c  unit index to pl
+0002b3b0: 6f74 0d0a 2020 2020 2020 2020 765f 6578  ot..        v_ex
+0002b3c0: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+0002b3d0: 2020 2020 2076 6572 7469 6361 6c20 6578       vertical ex
+0002b3e0: 6167 6572 6174 696f 6e0d 0a20 2020 2020  ageration..     
+0002b3f0: 2020 2070 6c6f 7474 6572 3a20 7079 7669     plotter: pyvi
+0002b400: 7374 612e 506c 6f74 7465 720d 0a20 2020  sta.Plotter..   
+0002b410: 2020 2020 2020 2020 2070 7976 6973 7461           pyvista
+0002b420: 2e50 6c6f 7474 6572 206f 626a 6563 7420  .Plotter object 
+0002b430: 746f 2070 6c6f 7420 6f6e 0d0a 2020 2020  to plot on..    
+0002b440: 2020 2020 685f 6c65 7665 6c3a 2073 7472      h_level: str
+0002b450: 696e 6720 6f72 2069 6e74 0d0a 2020 2020  ing or int..    
+0002b460: 2020 2020 2020 2020 6869 6572 6172 6368          hierarch
+0002b470: 6963 616c 206c 6576 656c 2074 6f20 706c  ical level to pl
+0002b480: 6f74 2e0d 0a20 2020 2020 2020 2020 2020  ot...           
+0002b490: 2041 2076 616c 7565 206f 6620 3120 696e   A value of 1 in
+0002b4a0: 6469 6361 7465 7320 7468 6174 206f 6e6c  dicates that onl
+0002b4b0: 7920 756e 6974 206f 6620 7468 650d 0a20  y unit of the.. 
+0002b4c0: 2020 2020 2020 2020 2020 206d 6173 7465             maste
+0002b4d0: 7220 7069 6c65 2077 696c 6c20 6265 2070  r pile will be p
+0002b4e0: 6c6f 7474 6564 2e20 2261 6c6c 2220 746f  lotted. "all" to
+0002b4f0: 2070 6c6f 7420 616c 6c20 706f 7373 6962   plot all possib
+0002b500: 6c65 2075 6e69 7473 0d0a 2020 2020 2020  le units..      
+0002b510: 2020 736c 6963 6578 3a20 666c 6f61 7420    slicex: float 
+0002b520: 6f72 2073 6571 7565 6e63 6520 6f66 2066  or sequence of f
+0002b530: 6c6f 6174 730d 0a20 2020 2020 2020 2020  loats..         
+0002b540: 2020 2066 7261 6374 696f 6e20 6f66 2078     fraction of x
+0002b550: 2061 7869 7320 7768 6572 6520 746f 2073   axis where to s
+0002b560: 6c69 6365 0d0a 2020 2020 2020 2020 736c  lice..        sl
+0002b570: 6963 6579 3a20 666c 6f61 7420 6f72 2073  icey: float or s
+0002b580: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
+0002b590: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+0002b5a0: 7261 6374 696f 6e20 6f66 2079 2061 7869  raction of y axi
+0002b5b0: 7320 7768 6572 6520 746f 2073 6c69 6365  s where to slice
+0002b5c0: 0d0a 2020 2020 2020 2020 736c 6963 657a  ..        slicez
+0002b5d0: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
+0002b5e0: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
+0002b5f0: 2020 2020 2020 2020 2020 2066 7261 6374             fract
+0002b600: 696f 6e20 6f66 207a 2061 7869 7320 7768  ion of z axis wh
+0002b610: 6572 6520 746f 2073 6c69 6365 0d0a 2020  ere to slice..  
+0002b620: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+0002b630: 5f6b 7761 7267 733a 2064 6963 740d 0a20  _kwargs: dict.. 
+0002b640: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+0002b650: 7320 746f 2070 6173 7320 746f 2074 6865  s to pass to the
+0002b660: 2073 6361 6c61 7220 6261 720d 0a20 2020   scalar bar..   
+0002b670: 2020 2020 2073 686f 775f 7363 616c 6172       show_scalar
+0002b680: 5f62 6172 3a20 626f 6f6c 0d0a 2020 2020  _bar: bool..    
+0002b690: 2020 2020 2020 2020 7368 6f77 2073 6361          show sca
+0002b6a0: 6c61 7220 6261 7220 6f72 206e 6f74 200d  lar bar or not .
+0002b6b0: 0a20 2020 2020 2020 206b 7761 7267 733a  .        kwargs:
+0002b6c0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
+0002b6d0: 2020 6b77 6172 6773 2074 6f20 7061 7373    kwargs to pass
+0002b6e0: 2074 6f20 6765 6f6e 652e 696d 6770 6c6f   to geone.imgplo
+0002b6f0: 742e 6472 6177 496d 6167 6533 445f 736c  t.drawImage3D_sl
+0002b700: 6963 6520 6f72 2067 656f 6e65 2e69 6d67  ice or geone.img
+0002b710: 706c 6f74 2e64 7261 7749 6d61 6765 3344  plot.drawImage3D
+0002b720: 5f73 7572 6661 6365 2020 2020 2020 2020  _surface        
+0002b730: 200d 0a20 2020 2020 2020 2022 2222 0d0a   ..        """..
+0002b740: 0d0a 2020 2020 2020 2020 2365 6e73 7572  ..        #ensur
+0002b750: 6520 6869 6572 6172 6368 795f 7265 6c61  e hierarchy_rela
+0002b760: 7469 6f6e 7320 6861 7665 2062 6565 6e20  tions have been 
+0002b770: 7365 740d 0a20 2020 2020 2020 2073 656c  set..        sel
+0002b780: 662e 6869 6572 6172 6368 795f 7265 6c61  f.hierarchy_rela
+0002b790: 7469 6f6e 7328 7662 3d30 290d 0a0d 0a20  tions(vb=0).... 
+0002b7a0: 2020 2020 2020 2063 6f6c 6f72 733d 5b5d         colors=[]
+0002b7b0: 0d0a 2020 2020 2020 2020 643d 7b7d 0d0a  ..        d={}..
+0002b7c0: 2020 2020 2020 2020 6e78 3d73 656c 662e          nx=self.
+0002b7d0: 6765 745f 6e78 2829 0d0a 2020 2020 2020  get_nx()..      
+0002b7e0: 2020 6e79 3d73 656c 662e 6765 745f 6e79    ny=self.get_ny
+0002b7f0: 2829 0d0a 2020 2020 2020 2020 6e7a 3d73  ()..        nz=s
+0002b800: 656c 662e 6765 745f 6e7a 2829 0d0a 2020  elf.get_nz()..  
+0002b810: 2020 2020 2020 7378 3d73 656c 662e 6765        sx=self.ge
+0002b820: 745f 7378 2829 0d0a 2020 2020 2020 2020  t_sx()..        
+0002b830: 7379 3d73 656c 662e 6765 745f 7379 2829  sy=self.get_sy()
+0002b840: 0d0a 2020 2020 2020 2020 737a 3d73 656c  ..        sz=sel
+0002b850: 662e 6765 745f 737a 2829 0d0a 2020 2020  f.get_sz()..    
+0002b860: 2020 2020 7830 3d73 656c 662e 6765 745f      x0=self.get_
+0002b870: 6f78 2829 0d0a 2020 2020 2020 2020 7930  ox()..        y0
+0002b880: 3d73 656c 662e 6765 745f 6f79 2829 0d0a  =self.get_oy()..
+0002b890: 2020 2020 2020 2020 7a30 3d73 656c 662e          z0=self.
+0002b8a0: 6765 745f 6f7a 2829 0d0a 0d0a 2020 2020  get_oz()....    
+0002b8b0: 2020 2020 7374 7261 7469 735f 646f 6d61      stratis_doma
+0002b8c0: 696e 3d73 656c 662e 6765 745f 756e 6974  in=self.get_unit
+0002b8d0: 735f 646f 6d61 696e 735f 7265 616c 697a  s_domains_realiz
+0002b8e0: 6174 696f 6e73 2869 753d 6975 2c20 6669  ations(iu=iu, fi
+0002b8f0: 6c6c 3d22 4944 222c 2068 5f6c 6576 656c  ll="ID", h_level
+0002b900: 3d68 5f6c 6576 656c 292e 6173 7479 7065  =h_level).astype
+0002b910: 286e 702e 666c 6f61 7433 3229 0d0a 2020  (np.float32)..  
+0002b920: 2020 2020 2020 6c73 745f 4944 3d6e 702e        lst_ID=np.
+0002b930: 756e 6971 7565 2873 7472 6174 6973 5f64  unique(stratis_d
+0002b940: 6f6d 6169 6e29 0d0a 2020 2020 2020 2020  omain)..        
+0002b950: 6e65 775f 6c73 745f 4944 203d 205b 5d0d  new_lst_ID = [].
+0002b960: 0a20 2020 2020 2020 2069 6620 6578 636c  .        if excl
+0002b970: 7564 6564 5661 6c20 6973 204e 6f6e 653a  udedVal is None:
+0002b980: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+0002b990: 636c 7564 6564 5661 6c3d 5b5d 0d0a 2020  cludedVal=[]..  
+0002b9a0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0002b9b0: 6e63 6528 6578 636c 7564 6564 5661 6c2c  nce(excludedVal,
+0002b9c0: 2069 6e74 293a 0d0a 2020 2020 2020 2020   int):..        
+0002b9d0: 2020 2020 6578 636c 7564 6564 5661 6c3d      excludedVal=
+0002b9e0: 5b65 7863 6c75 6465 6456 616c 5d0d 0a0d  [excludedVal]...
+0002b9f0: 0a20 2020 2020 2020 2023 2320 6368 616e  .        ## chan
+0002ba00: 6765 2076 616c 7565 730d 0a20 2020 2020  ge values..     
+0002ba10: 2020 206e 6577 5f69 643d 310d 0a20 2020     new_id=1..   
+0002ba20: 2020 2020 2066 6f72 2069 2069 6e20 6c73       for i in ls
+0002ba30: 745f 4944 3a0d 0a20 2020 2020 2020 2020  t_ID:..         
+0002ba40: 2020 2069 6620 6920 213d 2030 3a0d 0a20     if i != 0:.. 
+0002ba50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002ba60: 6620 6920 6e6f 7420 696e 2065 7863 6c75  f i not in exclu
+0002ba70: 6465 6456 616c 3a0d 0a20 2020 2020 2020  dedVal:..       
+0002ba80: 2020 2020 2020 2020 2020 2020 2073 3d73               s=s
+0002ba90: 656c 662e 6765 745f 756e 6974 2849 443d  elf.get_unit(ID=
+0002baa0: 692c 2074 7970 653d 2249 4422 290d 0a20  i, type="ID").. 
+0002bab0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+0002bac0: 2020 2020 2073 7472 6174 6973 5f64 6f6d       stratis_dom
+0002bad0: 6169 6e5b 7374 7261 7469 735f 646f 6d61  ain[stratis_doma
+0002bae0: 696e 203d 3d20 695d 3d6e 6577 5f69 640d  in == i]=new_id.
+0002baf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002bb00: 2020 2020 2063 6f6c 6f72 732e 6170 7065       colors.appe
+0002bb10: 6e64 2873 2e63 290d 0a20 2020 2020 2020  nd(s.c)..       
+0002bb20: 2020 2020 2020 2020 2020 2020 2064 5b6e               d[n
+0002bb30: 6577 5f69 6420 2d20 302e 355d 3d73 2e6e  ew_id - 0.5]=s.n
+0002bb40: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
+0002bb50: 2020 2020 2020 2020 206e 6577 5f69 6420           new_id 
+0002bb60: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
+0002bb70: 2020 2020 2020 2020 2020 6e65 775f 6c73            new_ls
+0002bb80: 745f 4944 2e61 7070 656e 6428 6929 0d0a  t_ID.append(i)..
+0002bb90: 0d0a 2020 2020 2020 2020 2370 6c6f 740d  ..        #plot.
+0002bba0: 0a20 2020 2020 2020 2073 7472 6174 6973  .        stratis
+0002bbb0: 5f64 6f6d 6169 6e5b 7374 7261 7469 735f  _domain[stratis_
+0002bbc0: 646f 6d61 696e 3d3d 305d 3d6e 702e 6e61  domain==0]=np.na
+0002bbd0: 6e20 2023 2072 656d 6f76 6520 7768 6572  n  # remove wher
+0002bbe0: 6520 6e6f 2066 6f72 6d61 7469 6f6e 7320  e no formations 
+0002bbf0: 6172 6520 7072 6573 656e 740d 0a20 2020  are present..   
+0002bc00: 2020 2020 2069 6620 706c 6f74 7465 7220       if plotter 
+0002bc10: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+0002bc20: 2020 2020 2020 703d 7076 2e50 6c6f 7474        p=pv.Plott
+0002bc30: 6572 2829 0d0a 2020 2020 2020 2020 656c  er()..        el
+0002bc40: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0002bc50: 2070 3d70 6c6f 7474 6572 0d0a 0d0a 2020   p=plotter....  
+0002bc60: 2020 2020 2020 696d 3d67 656f 6e65 2e69        im=geone.i
+0002bc70: 6d67 2e49 6d67 286e 782c 206e 792c 206e  mg.Img(nx, ny, n
+0002bc80: 7a2c 2073 782c 2073 792c 2073 7a2a 765f  z, sx, sy, sz*v_
+0002bc90: 6578 2c20 7830 2c20 7930 2c20 7a30 2c20  ex, x0, y0, z0, 
+0002bca0: 6e76 3d31 2c20 7661 6c3d 7374 7261 7469  nv=1, val=strati
+0002bcb0: 735f 646f 6d61 696e 2c20 7661 726e 616d  s_domain, varnam
+0002bcc0: 653d 2255 6e69 7473 2229 0d0a 0d0a 2020  e="Units")....  
+0002bcd0: 2020 2020 2020 6966 2073 6c69 6365 7820        if slicex 
+0002bce0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0002bcf0: 2020 2020 2020 2020 2020 736c 6963 6578            slicex
+0002bd00: 3d6e 702e 6172 7261 7928 736c 6963 6578  =np.array(slicex
+0002bd10: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002bd20: 6c69 6365 785b 736c 6963 6578 3c30 5d3d  licex[slicex<0]=
+0002bd30: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
+0002bd40: 6c69 6365 785b 736c 6963 6578 3e31 5d3d  licex[slicex>1]=
+0002bd50: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
+0002bd60: 783d 696d 2e6f 7820 2b20 736c 6963 6578  x=im.ox + slicex
+0002bd70: 202a 2069 6d2e 6e78 202a 2069 6d2e 7378   * im.nx * im.sx
+0002bd80: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
+0002bd90: 2078 0d0a 2020 2020 2020 2020 656c 7365   x..        else
+0002bda0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0002bdb0: 783d 4e6f 6e65 0d0a 2020 2020 2020 2020  x=None..        
+0002bdc0: 6966 2073 6c69 6365 7920 6973 206e 6f74  if slicey is not
+0002bdd0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0002bde0: 2020 2020 736c 6963 6579 3d6e 702e 6172      slicey=np.ar
+0002bdf0: 7261 7928 736c 6963 6579 290d 0a20 2020  ray(slicey)..   
+0002be00: 2020 2020 2020 2020 2073 6c69 6365 795b           slicey[
+0002be10: 736c 6963 6579 3c30 5d3d 300d 0a20 2020  slicey<0]=0..   
+0002be20: 2020 2020 2020 2020 2073 6c69 6365 795b           slicey[
+0002be30: 736c 6963 6579 3e31 5d3d 310d 0a20 2020  slicey>1]=1..   
+0002be40: 2020 2020 2020 2020 2063 793d 696d 2e6f           cy=im.o
+0002be50: 7920 2b20 736c 6963 6579 202a 2069 6d2e  y + slicey * im.
+0002be60: 6e79 202a 2069 6d2e 7379 2020 2320 6365  ny * im.sy  # ce
+0002be70: 6e74 6572 2061 6c6f 6e67 2078 0d0a 2020  nter along x..  
+0002be80: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0002be90: 2020 2020 2020 2020 2063 793d 4e6f 6e65           cy=None
+0002bea0: 0d0a 2020 2020 2020 2020 6966 2073 6c69  ..        if sli
+0002beb0: 6365 7a20 6973 206e 6f74 204e 6f6e 653a  cez is not None:
+0002bec0: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
+0002bed0: 6963 657a 3d6e 702e 6172 7261 7928 736c  icez=np.array(sl
+0002bee0: 6963 657a 290d 0a20 2020 2020 2020 2020  icez)..         
+0002bef0: 2020 2073 6c69 6365 7a5b 736c 6963 657a     slicez[slicez
+0002bf00: 3c30 5d3d 300d 0a20 2020 2020 2020 2020  <0]=0..         
+0002bf10: 2020 2073 6c69 6365 7a5b 736c 6963 657a     slicez[slicez
+0002bf20: 3e31 5d3d 310d 0a20 2020 2020 2020 2020  >1]=1..         
+0002bf30: 2020 2063 7a3d 696d 2e6f 7a20 2b20 736c     cz=im.oz + sl
+0002bf40: 6963 657a 202a 2069 6d2e 6e7a 202a 2069  icez * im.nz * i
+0002bf50: 6d2e 737a 2020 2320 6365 6e74 6572 2061  m.sz  # center a
+0002bf60: 6c6f 6e67 2078 0d0a 2020 2020 2020 2020  long x..        
+0002bf70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0002bf80: 2020 2063 7a3d 4e6f 6e65 0d0a 0d0a 2020     cz=None....  
+0002bf90: 2020 2020 2020 6966 2073 6c69 6365 7820        if slicex 
+0002bfa0: 6973 206e 6f74 204e 6f6e 6520 6f72 2073  is not None or s
+0002bfb0: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
+0002bfc0: 6520 6f72 2073 6c69 6365 7a20 6973 206e  e or slicez is n
+0002bfd0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0002bfe0: 2020 2020 2020 696d 6770 6c74 332e 6472        imgplt3.dr
+0002bff0: 6177 496d 6167 6533 445f 736c 6963 6528  awImage3D_slice(
+0002c000: 696d 2c20 706c 6f74 7465 723d 702c 2073  im, plotter=p, s
+0002c010: 6c69 6365 5f6e 6f72 6d61 6c5f 783d 6378  lice_normal_x=cx
+0002c020: 2c20 736c 6963 655f 6e6f 726d 616c 5f79  , slice_normal_y
+0002c030: 3d63 792c 2073 6c69 6365 5f6e 6f72 6d61  =cy, slice_norma
+0002c040: 6c5f 7a3d 637a 2c0d 0a20 2020 2020 2020  l_z=cz,..       
+0002c050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c060: 2020 2020 2020 2020 2020 2020 2063 6174               cat
+0002c070: 6567 3d54 7275 652c 2063 6174 6567 5661  eg=True, categVa
+0002c080: 6c3d 6e65 775f 6c73 745f 4944 2c20 6361  l=new_lst_ID, ca
+0002c090: 7465 6743 6f6c 3d63 6f6c 6f72 732c 2073  tegCol=colors, s
+0002c0a0: 6361 6c61 725f 6261 725f 616e 6e6f 7461  calar_bar_annota
+0002c0b0: 7469 6f6e 733d 642c 0d0a 2020 2020 2020  tions=d,..      
+0002c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c0d0: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+0002c0e0: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+0002c0f0: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002c100: 732c 2073 686f 775f 7363 616c 6172 5f62  s, show_scalar_b
+0002c110: 6172 203d 2073 686f 775f 7363 616c 6172  ar = show_scalar
+0002c120: 5f62 6172 2c20 2a2a 6b77 6172 6773 290d  _bar, **kwargs).
+0002c130: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0002c140: 2020 2020 2020 2020 2020 2020 696d 6770              imgp
+0002c150: 6c74 332e 6472 6177 496d 6167 6533 445f  lt3.drawImage3D_
+0002c160: 7375 7266 6163 6528 696d 2c20 706c 6f74  surface(im, plot
+0002c170: 7465 723d 702c 2063 6174 6567 3d54 7275  ter=p, categ=Tru
+0002c180: 652c 2063 6174 6567 5661 6c3d 6e65 775f  e, categVal=new_
+0002c190: 6c73 745f 4944 2c20 6361 7465 6743 6f6c  lst_ID, categCol
+0002c1a0: 3d63 6f6c 6f72 732c 2073 6361 6c61 725f  =colors, scalar_
+0002c1b0: 6261 725f 616e 6e6f 7461 7469 6f6e 733d  bar_annotations=
+0002c1c0: 642c 0d0a 2020 2020 2020 2020 2020 2020  d,..            
+0002c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c1e0: 2020 2020 2020 2020 2020 2020 7363 616c              scal
+0002c1f0: 6172 5f62 6172 5f6b 7761 7267 733d 7363  ar_bar_kwargs=sc
+0002c200: 616c 6172 5f62 6172 5f6b 7761 7267 732c  alar_bar_kwargs,
+0002c210: 2073 686f 775f 7363 616c 6172 5f62 6172   show_scalar_bar
+0002c220: 203d 2073 686f 775f 7363 616c 6172 5f62   = show_scalar_b
+0002c230: 6172 2c20 2a2a 6b77 6172 6773 290d 0a0d  ar, **kwargs)...
+0002c240: 0a20 2020 2020 2020 2069 6620 706c 6f74  .        if plot
+0002c250: 7465 7220 6973 204e 6f6e 653a 0d0a 2020  ter is None:..  
+0002c260: 2020 2020 2020 2020 2020 702e 6164 645f            p.add_
+0002c270: 626f 756e 6469 6e67 5f62 6f78 2829 0d0a  bounding_box()..
+0002c280: 2020 2020 2020 2020 2020 2020 702e 7368              p.sh
+0002c290: 6f77 5f61 7865 7328 290d 0a20 2020 2020  ow_axes()..     
+0002c2a0: 2020 2020 2020 2070 2e73 686f 7728 290d         p.show().
+0002c2b0: 0a0d 0a0d 0a20 2020 2064 6566 2070 6c6f  .....    def plo
+0002c2c0: 745f 7072 6f62 6128 7365 6c66 2c20 6f62  t_proba(self, ob
+0002c2d0: 6a2c 2076 5f65 783d 312c 2070 6c6f 7474  j, v_ex=1, plott
+0002c2e0: 6572 3d4e 6f6e 652c 2066 696c 7465 7269  er=None, filteri
+0002c2f0: 6e67 5f69 6e74 6572 7661 6c3d 5b30 2e30  ng_interval=[0.0
+0002c300: 312c 2031 2e30 305d 2c0d 0a20 2020 2020  1, 1.00],..     
+0002c310: 2020 2020 2020 2020 2020 2020 2020 736c                sl
+0002c320: 6963 6578 3d4e 6f6e 652c 2073 6c69 6365  icex=None, slice
+0002c330: 793d 4e6f 6e65 2c20 736c 6963 657a 3d4e  y=None, slicez=N
+0002c340: 6f6e 652c 0d0a 2020 2020 2020 2020 2020  one,..          
+0002c350: 2020 2020 2020 2020 2073 6361 6c61 725f           scalar_
+0002c360: 6261 725f 6b77 6172 6773 3d4e 6f6e 652c  bar_kwargs=None,
+0002c370: 2065 7863 6c75 6465 6456 616c 3d4e 6f6e   excludedVal=Non
+0002c380: 652c 202a 2a6b 7761 7267 7329 3a0d 0a0d  e, **kwargs):...
+0002c390: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0002c3a0: 2020 2020 2020 506c 6f74 2074 6865 2070        Plot the p
+0002c3b0: 726f 6261 6269 6c69 7479 206f 6620 6f63  robability of oc
+0002c3c0: 6375 7265 6e63 6520 6f66 2061 2073 7065  curence of a spe
+0002c3d0: 6369 6669 6320 756e 6974 206f 7220 6661  cific unit or fa
+0002c3e0: 6369 6573 0d0a 2020 2020 2020 2020 2863  cies..        (c
+0002c3f0: 616e 2062 6520 7061 7373 6564 2062 7920  an be passed by 
+0002c400: 6120 6e61 6d65 206f 7220 7468 6520 6f62  a name or the ob
+0002c410: 6a65 6374 2064 6972 6563 746c 7929 0d0a  ject directly)..
+0002c420: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0002c430: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+0002c440: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0002c450: 2020 6f62 6a3a 203a 636c 6173 733a 6055    obj: :class:`U
+0002c460: 6e69 7460 206f 7220 3a63 6c61 7373 3a60  nit` or :class:`
+0002c470: 4661 6369 6573 6020 6f72 2073 7472 0d0a  Facies` or str..
+0002c480: 2020 2020 2020 2020 2020 2020 756e 6974              unit
+0002c490: 206f 7220 6661 6369 6573 206f 626a 6563   or facies objec
+0002c4a0: 7420 6f72 2073 7472 696e 6720 6e61 6d65  t or string name
+0002c4b0: 206f 6620 7468 6520 756e 6974 2f66 6163   of the unit/fac
+0002c4c0: 6965 730d 0a20 2020 2020 2020 2020 2020  ies..           
+0002c4d0: 2074 6f20 706c 6f74 2074 6865 2070 726f   to plot the pro
+0002c4e0: 6261 6269 6c69 7479 206f 6620 6f63 6375  bability of occu
+0002c4f0: 7265 6e63 650d 0a20 2020 2020 2020 2076  rence..        v
+0002c500: 5f65 783a 2066 6c6f 6174 0d0a 2020 2020  _ex: float..    
+0002c510: 2020 2020 2020 2020 7665 7274 6963 616c          vertical
+0002c520: 2065 7861 6765 7261 7469 6f6e 2c20 6465   exageration, de
+0002c530: 6661 756c 7420 6973 2031 0d0a 2020 2020  fault is 1..    
+0002c540: 2020 2020 706c 6f74 7465 723a 2070 7976      plotter: pyv
+0002c550: 6973 7461 2e50 6c6f 7474 6572 0d0a 2020  ista.Plotter..  
+0002c560: 2020 2020 2020 2020 2020 7079 7669 7374            pyvist
+0002c570: 612e 506c 6f74 7465 7220 6f62 6a65 6374  a.Plotter object
+0002c580: 2074 6f20 706c 6f74 206f 6e0d 0a20 2020   to plot on..   
+0002c590: 2020 2020 2073 6c69 6365 783a 2066 6c6f       slicex: flo
+0002c5a0: 6174 206f 7220 7365 7175 656e 6365 206f  at or sequence o
+0002c5b0: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
+0002c5c0: 2020 2020 2020 6672 6163 7469 6f6e 206f        fraction o
+0002c5d0: 6620 7820 6178 6973 2077 6865 7265 2074  f x axis where t
+0002c5e0: 6f20 736c 6963 650d 0a20 2020 2020 2020  o slice..       
+0002c5f0: 2073 6c69 6365 793a 2066 6c6f 6174 206f   slicey: float o
+0002c600: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
+0002c610: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
+0002c620: 2020 6672 6163 7469 6f6e 206f 6620 7920    fraction of y 
+0002c630: 6178 6973 2077 6865 7265 2074 6f20 736c  axis where to sl
+0002c640: 6963 650d 0a20 2020 2020 2020 2073 6c69  ice..        sli
+0002c650: 6365 7a3a 2066 6c6f 6174 206f 7220 7365  cez: float or se
+0002c660: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
+0002c670: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
+0002c680: 6163 7469 6f6e 206f 6620 7a20 6178 6973  action of z axis
+0002c690: 2077 6865 7265 2074 6f20 736c 6963 650d   where to slice.
+0002c6a0: 0a20 2020 2020 2020 2073 6361 6c61 725f  .        scalar_
+0002c6b0: 6261 725f 6b77 6172 6773 3a20 6469 6374  bar_kwargs: dict
+0002c6c0: 0d0a 2020 2020 2020 2020 2020 2020 6b77  ..            kw
+0002c6d0: 6172 6773 2074 6f20 7061 7373 2074 6f20  args to pass to 
+0002c6e0: 7468 6520 7363 616c 6172 2062 6172 0d0a  the scalar bar..
+0002c6f0: 2020 2020 2020 2020 6578 636c 7564 6564          excluded
+0002c700: 5661 6c3a 2066 6c6f 6174 206f 7220 7365  Val: float or se
+0002c710: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
+0002c720: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+0002c730: 6c75 6573 2074 6f20 6578 636c 7564 6520  lues to exclude 
+0002c740: 6672 6f6d 2074 6865 2070 6c6f 740d 0a20  from the plot.. 
+0002c750: 2020 2020 2020 206b 7761 7267 733a 6469         kwargs:di
+0002c760: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
+0002c770: 6b77 6172 6773 2074 6f20 7061 7373 2074  kwargs to pass t
+0002c780: 6f20 6765 6f6e 652e 696d 6770 6c6f 742e  o geone.imgplot.
+0002c790: 6472 6177 496d 6167 6533 445f 736c 6963  drawImage3D_slic
+0002c7a0: 6520 6f72 2067 656f 6e65 2e69 6d67 706c  e or geone.imgpl
+0002c7b0: 6f74 2e64 7261 7749 6d61 6765 3344 5f73  ot.drawImage3D_s
+0002c7c0: 7572 6661 6365 0d0a 2020 2020 2020 2020  urface..        
+0002c7d0: 2222 220d 0a0d 0a20 2020 2020 2020 206e  """....        n
+0002c7e0: 783d 7365 6c66 2e67 6574 5f6e 7828 290d  x=self.get_nx().
+0002c7f0: 0a20 2020 2020 2020 206e 793d 7365 6c66  .        ny=self
+0002c800: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
+0002c810: 2020 206e 7a3d 7365 6c66 2e67 6574 5f6e     nz=self.get_n
+0002c820: 7a28 290d 0a20 2020 2020 2020 2073 783d  z()..        sx=
+0002c830: 7365 6c66 2e67 6574 5f73 7828 290d 0a20  self.get_sx().. 
+0002c840: 2020 2020 2020 2073 793d 7365 6c66 2e67         sy=self.g
+0002c850: 6574 5f73 7928 290d 0a20 2020 2020 2020  et_sy()..       
+0002c860: 2073 7a3d 7365 6c66 2e67 6574 5f73 7a28   sz=self.get_sz(
+0002c870: 290d 0a20 2020 2020 2020 2078 303d 7365  )..        x0=se
+0002c880: 6c66 2e67 6574 5f6f 7828 290d 0a20 2020  lf.get_ox()..   
+0002c890: 2020 2020 2079 303d 7365 6c66 2e67 6574       y0=self.get
+0002c8a0: 5f6f 7928 290d 0a20 2020 2020 2020 207a  _oy()..        z
+0002c8b0: 303d 7365 6c66 2e67 6574 5f6f 7a28 290d  0=self.get_oz().
+0002c8c0: 0a0d 0a20 2020 2020 2020 2069 6620 6973  ...        if is
+0002c8d0: 696e 7374 616e 6365 286f 626a 2c20 7374  instance(obj, st
+0002c8e0: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
+0002c8f0: 2069 6620 7365 6c66 2e67 6574 5f75 6e69   if self.get_uni
+0002c900: 7428 6f62 6a2c 2076 623d 3029 2069 7320  t(obj, vb=0) is 
+0002c910: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0002c920: 2020 2020 2020 2020 2020 2075 3d73 656c             u=sel
+0002c930: 662e 6765 745f 756e 6974 286f 626a 290d  f.get_unit(obj).
+0002c940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c950: 2069 3d75 2e49 440d 0a20 2020 2020 2020   i=u.ID..       
+0002c960: 2020 2020 2020 2020 2068 6c3d 752e 6765           hl=u.ge
+0002c970: 745f 685f 6c65 7665 6c28 290d 0a20 2020  t_h_level()..   
+0002c980: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+0002c990: 3d22 756e 6974 220d 0a20 2020 2020 2020  ="unit"..       
+0002c9a0: 2020 2020 2065 6c69 6620 7365 6c66 2e67       elif self.g
+0002c9b0: 6574 5f66 6163 6965 735f 6f62 6a28 6f62  et_facies_obj(ob
+0002c9c0: 6a2c 2076 623d 3029 2069 7320 6e6f 7420  j, vb=0) is not 
+0002c9d0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002c9e0: 2020 2020 2020 2066 613d 7365 6c66 2e67         fa=self.g
+0002c9f0: 6574 5f66 6163 6965 735f 6f62 6a28 6f62  et_facies_obj(ob
+0002ca00: 6a29 0d0a 2020 2020 2020 2020 2020 2020  j)..            
+0002ca10: 2020 2020 693d 6661 2e49 440d 0a20 2020      i=fa.ID..   
+0002ca20: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+0002ca30: 3d22 6661 6369 6573 220d 0a20 2020 2020  ="facies"..     
+0002ca40: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+0002ca50: 6365 286f 626a 2c20 556e 6974 293a 0d0a  ce(obj, Unit):..
+0002ca60: 2020 2020 2020 2020 2020 2020 693d 6f62              i=ob
+0002ca70: 6a2e 4944 0d0a 2020 2020 2020 2020 2020  j.ID..          
+0002ca80: 2020 686c 3d6f 626a 2e67 6574 5f68 5f6c    hl=obj.get_h_l
+0002ca90: 6576 656c 2829 0d0a 2020 2020 2020 2020  evel()..        
+0002caa0: 2020 2020 7479 703d 2275 6e69 7422 0d0a      typ="unit"..
+0002cab0: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+0002cac0: 6e73 7461 6e63 6528 6f62 6a2c 2046 6163  nstance(obj, Fac
+0002cad0: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
+0002cae0: 2020 2069 3d6f 626a 2e49 440d 0a20 2020     i=obj.ID..   
+0002caf0: 2020 2020 2020 2020 2074 7970 3d22 6661           typ="fa
+0002cb00: 6369 6573 220d 0a20 2020 2020 2020 2065  cies"..        e
+0002cb10: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0002cb20: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0002cb30: 6f72 2028 2275 6e69 742f 6661 6369 6573  or ("unit/facies
+0002cb40: 206d 7573 7420 6265 2061 2073 7472 696e   must be a strin
+0002cb50: 6720 6e61 6d65 206f 6620 6120 756e 6974  g name of a unit
+0002cb60: 206f 7220 6120 756e 6974 206f 626a 6563   or a unit objec
+0002cb70: 7420 7468 6174 2069 7320 636f 6e74 6169  t that is contai
+0002cb80: 6e65 6420 696e 7369 6465 2074 6865 204d  ned inside the M
+0002cb90: 6173 7465 7220 5069 6c65 2229 0d0a 0d0a  aster Pile")....
+0002cba0: 2020 2020 2020 2020 6966 2074 7970 203d          if typ =
+0002cbb0: 3d20 2275 6e69 7422 3a0d 0a20 2020 2020  = "unit":..     
+0002cbc0: 2020 2020 2020 2061 7272 3d6e 702e 7a65         arr=np.ze
+0002cbd0: 726f 7328 5b73 656c 662e 6e7a 2c20 7365  ros([self.nz, se
+0002cbe0: 6c66 2e6e 792c 2073 656c 662e 6e78 5d29  lf.ny, self.nx])
+0002cbf0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0002cc00: 636f 6d70 7574 6520 7072 6f62 6162 696c  compute probabil
+0002cc10: 6974 6965 730d 0a20 2020 2020 2020 2020  ities..         
+0002cc20: 2020 2066 6f72 2069 7520 696e 2072 616e     for iu in ran
+0002cc30: 6765 2873 656c 662e 6e72 6561 6c5f 756e  ge(self.nreal_un
+0002cc40: 6974 7329 3a0d 0a20 2020 2020 2020 2020  its):..         
+0002cc50: 2020 2020 2020 2075 6e69 7473 3d73 656c         units=sel
+0002cc60: 662e 6765 745f 756e 6974 735f 646f 6d61  f.get_units_doma
+0002cc70: 696e 735f 7265 616c 697a 6174 696f 6e73  ins_realizations
+0002cc80: 2869 753d 6975 2c20 685f 6c65 7665 6c3d  (iu=iu, h_level=
+0002cc90: 686c 2c20 616c 6c5f 6461 7461 3d46 616c  hl, all_data=Fal
+0002cca0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+0002ccb0: 2020 2020 2061 7272 2b3d 2875 6e69 7473       arr+=(units
+0002ccc0: 203d 3d20 6929 0d0a 2020 2020 2020 2020   == i)..        
+0002ccd0: 2020 2020 6172 722f 3d73 656c 662e 6e72      arr/=self.nr
+0002cce0: 6561 6c5f 756e 6974 730d 0a0d 0a20 2020  eal_units....   
+0002ccf0: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
+0002cd00: 2022 6661 6369 6573 223a 0d0a 2020 2020   "facies":..    
+0002cd10: 2020 2020 2020 2020 6172 723d 6e70 2e7a          arr=np.z
+0002cd20: 6572 6f73 285b 7365 6c66 2e6e 7a2c 2073  eros([self.nz, s
+0002cd30: 656c 662e 6e79 2c20 7365 6c66 2e6e 785d  elf.ny, self.nx]
+0002cd40: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0002cd50: 2063 6f6d 7075 7465 2070 726f 6261 6269   compute probabi
+0002cd60: 6c69 7469 6573 0d0a 2020 2020 2020 2020  lities..        
+0002cd70: 2020 2020 666f 7220 6975 2069 6e20 7261      for iu in ra
+0002cd80: 6e67 6528 7365 6c66 2e6e 7265 616c 5f75  nge(self.nreal_u
+0002cd90: 6e69 7473 293a 0d0a 2020 2020 2020 2020  nits):..        
+0002cda0: 2020 2020 2020 2020 666f 7220 6966 6120          for ifa 
+0002cdb0: 696e 2072 616e 6765 2873 656c 662e 6e72  in range(self.nr
+0002cdc0: 6561 6c5f 6661 293a 0d0a 2020 2020 2020  eal_fa):..      
+0002cdd0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+0002cde0: 6369 6573 3d73 656c 662e 6765 745f 6661  cies=self.get_fa
+0002cdf0: 6369 6573 2869 753d 6975 2c20 6966 613d  cies(iu=iu, ifa=
+0002ce00: 6966 612c 2061 6c6c 5f64 6174 613d 4661  ifa, all_data=Fa
+0002ce10: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
+0002ce20: 2020 2020 2020 2020 2020 6172 722b 3d28            arr+=(
+0002ce30: 6661 6369 6573 203d 3d20 6929 0d0a 2020  facies == i)..  
+0002ce40: 2020 2020 2020 2020 2020 6172 722f 3d28            arr/=(
+0002ce50: 7365 6c66 2e6e 7265 616c 5f75 6e69 7473  self.nreal_units
+0002ce60: 2a73 656c 662e 6e72 6561 6c5f 6661 290d  *self.nreal_fa).
+0002ce70: 0a20 2020 2020 2020 2069 6d3d 6765 6f6e  .        im=geon
+0002ce80: 652e 696d 672e 496d 6728 6e78 2c20 6e79  e.img.Img(nx, ny
+0002ce90: 2c20 6e7a 2c20 7378 2c20 7379 2c20 737a  , nz, sx, sy, sz
+0002cea0: 2a76 5f65 782c 2078 302c 2079 302c 207a  *v_ex, x0, y0, z
+0002ceb0: 302c 206e 763d 312c 2076 616c 3d61 7272  0, nv=1, val=arr
+0002cec0: 2c20 7661 726e 616d 653d 2250 205b 2d5d  , varname="P [-]
+0002ced0: 2229 2023 6372 6561 7465 2069 6d67 206f  ") #create img o
+0002cee0: 626a 6563 740d 0a0d 0a20 2020 2020 2020  bject....       
+0002cef0: 2023 6372 6561 7465 2073 6c69 6365 730d   #create slices.
+0002cf00: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
+0002cf10: 6578 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ex is not None:.
+0002cf20: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+0002cf30: 6365 783d 6e70 2e61 7272 6179 2873 6c69  cex=np.array(sli
+0002cf40: 6365 7829 0d0a 2020 2020 2020 2020 2020  cex)..          
+0002cf50: 2020 736c 6963 6578 5b73 6c69 6365 783c    slicex[slicex<
+0002cf60: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
+0002cf70: 2020 736c 6963 6578 5b73 6c69 6365 783e    slicex[slicex>
+0002cf80: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
+0002cf90: 2020 6378 3d69 6d2e 6f78 202b 2073 6c69    cx=im.ox + sli
+0002cfa0: 6365 7820 2a20 696d 2e6e 7820 2a20 696d  cex * im.nx * im
+0002cfb0: 2e73 7820 2023 2063 656e 7465 7220 616c  .sx  # center al
+0002cfc0: 6f6e 6720 780d 0a20 2020 2020 2020 2065  ong x..        e
+0002cfd0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0002cfe0: 2020 6378 3d4e 6f6e 650d 0a20 2020 2020    cx=None..     
+0002cff0: 2020 2069 6620 736c 6963 6579 2069 7320     if slicey is 
+0002d000: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0002d010: 2020 2020 2020 2073 6c69 6365 793d 6e70         slicey=np
+0002d020: 2e61 7272 6179 2873 6c69 6365 7929 0d0a  .array(slicey)..
+0002d030: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002d040: 6579 5b73 6c69 6365 793c 305d 3d30 0d0a  ey[slicey<0]=0..
+0002d050: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+0002d060: 6579 5b73 6c69 6365 793e 315d 3d31 0d0a  ey[slicey>1]=1..
+0002d070: 2020 2020 2020 2020 2020 2020 6379 3d69              cy=i
+0002d080: 6d2e 6f79 202b 2073 6c69 6365 7920 2a20  m.oy + slicey * 
+0002d090: 696d 2e6e 7920 2a20 696d 2e73 7920 2023  im.ny * im.sy  #
+0002d0a0: 2063 656e 7465 7220 616c 6f6e 6720 790d   center along y.
+0002d0b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0002d0c0: 2020 2020 2020 2020 2020 2020 6379 3d4e              cy=N
+0002d0d0: 6f6e 650d 0a20 2020 2020 2020 2069 6620  one..        if 
+0002d0e0: 736c 6963 657a 2069 7320 6e6f 7420 4e6f  slicez is not No
+0002d0f0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002d100: 2073 6c69 6365 7a3d 6e70 2e61 7272 6179   slicez=np.array
+0002d110: 2873 6c69 6365 7a29 0d0a 2020 2020 2020  (slicez)..      
+0002d120: 2020 2020 2020 736c 6963 657a 5b73 6c69        slicez[sli
+0002d130: 6365 7a3c 305d 3d30 0d0a 2020 2020 2020  cez<0]=0..      
+0002d140: 2020 2020 2020 736c 6963 657a 5b73 6c69        slicez[sli
+0002d150: 6365 7a3e 315d 3d31 0d0a 2020 2020 2020  cez>1]=1..      
+0002d160: 2020 2020 2020 637a 3d69 6d2e 6f7a 202b        cz=im.oz +
+0002d170: 2073 6c69 6365 7a20 2a20 696d 2e6e 7a20   slicez * im.nz 
+0002d180: 2a20 696d 2e73 7a20 2023 2063 656e 7465  * im.sz  # cente
+0002d190: 7220 616c 6f6e 6720 7a0d 0a20 2020 2020  r along z..     
+0002d1a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0002d1b0: 2020 2020 2020 637a 3d4e 6f6e 650d 0a0d        cz=None...
+0002d1c0: 0a20 2020 2020 2020 2069 6620 6172 722e  .        if arr.
+0002d1d0: 616e 7928 293a 2023 6966 2076 616c 7565  any(): #if value
+0002d1e0: 7320 6172 6520 666f 756e 640d 0a20 2020  s are found..   
+0002d1f0: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0002d200: 2020 2020 2020 2023 2066 696c 7465 7220         # filter 
+0002d210: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
+0002d220: 2020 2020 6966 2066 696c 7465 7269 6e67      if filtering
+0002d230: 5f69 6e74 6572 7661 6c20 6973 206e 6f74  _interval is not
+0002d240: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0002d250: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002d260: 7461 6e63 6528 6669 6c74 6572 696e 675f  tance(filtering_
+0002d270: 696e 7465 7276 616c 2c20 6c69 7374 293a  interval, list):
+0002d280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d290: 2020 2020 2020 6966 206c 656e 2866 696c        if len(fil
+0002d2a0: 7465 7269 6e67 5f69 6e74 6572 7661 6c29  tering_interval)
+0002d2b0: 203d 3d20 323a 0d0a 2020 2020 2020 2020   == 2:..        
+0002d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2d0: 6966 2066 696c 7465 7269 6e67 5f69 6e74  if filtering_int
+0002d2e0: 6572 7661 6c5b 305d 203c 2066 696c 7465  erval[0] < filte
+0002d2f0: 7269 6e67 5f69 6e74 6572 7661 6c5b 315d  ring_interval[1]
+0002d300: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002d310: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002d320: 7272 5b61 7272 203c 2066 696c 7465 7269  rr[arr < filteri
+0002d330: 6e67 5f69 6e74 6572 7661 6c5b 305d 5d20  ng_interval[0]] 
+0002d340: 3d20 6e70 2e6e 616e 0d0a 2020 2020 2020  = np.nan..      
+0002d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d360: 2020 2020 2020 6172 725b 6172 7220 3e20        arr[arr > 
+0002d370: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+0002d380: 616c 5b31 5d5d 203d 206e 702e 6e61 6e0d  al[1]] = np.nan.
+0002d390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d3a0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0002d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d3c0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0002d3d0: 7428 2266 696c 7465 7269 6e67 5f69 6e74  t("filtering_int
+0002d3e0: 6572 7661 6c5b 305d 206d 7573 7420 6265  erval[0] must be
+0002d3f0: 2073 6d61 6c6c 6572 2074 6861 6e20 6669   smaller than fi
+0002d400: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
+0002d410: 5b31 5d22 290d 0a20 2020 2020 2020 2020  [1]")..         
+0002d420: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0002d430: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d440: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0002d450: 2266 696c 7465 7269 6e67 5f69 6e74 6572  "filtering_inter
+0002d460: 7661 6c20 6d75 7374 2062 6520 6120 6c69  val must be a li
+0002d470: 7374 206f 6620 7477 6f20 7661 6c75 6573  st of two values
+0002d480: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0002d490: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0002d4b0: 7269 6e74 2822 6669 6c74 6572 696e 675f  rint("filtering_
+0002d4c0: 696e 7465 7276 616c 206d 7573 7420 6265  interval must be
+0002d4d0: 2061 206c 6973 7420 6f66 2074 776f 2076   a list of two v
+0002d4e0: 616c 7565 7322 290d 0a0d 0a20 2020 2020  alues")....     
+0002d4f0: 2020 2020 2020 2069 6620 706c 6f74 7465         if plotte
+0002d500: 7220 6973 204e 6f6e 653a 0d0a 2020 2020  r is None:..    
+0002d510: 2020 2020 2020 2020 2020 2020 703d 7076              p=pv
+0002d520: 2e50 6c6f 7474 6572 2829 0d0a 2020 2020  .Plotter()..    
+0002d530: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002d540: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0002d550: 3d70 6c6f 7474 6572 0d0a 0d0a 2020 2020  =plotter....    
+0002d560: 2020 2020 2020 2020 6966 2073 6c69 6365          if slice
+0002d570: 7820 6973 206e 6f74 204e 6f6e 6520 6f72  x is not None or
+0002d580: 2073 6c69 6365 7920 6973 206e 6f74 204e   slicey is not N
+0002d590: 6f6e 6520 6f72 2073 6c69 6365 7a20 6973  one or slicez is
+0002d5a0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0002d5b0: 2020 2020 2020 2020 2020 2020 696d 6770              imgp
+0002d5c0: 6c74 332e 6472 6177 496d 6167 6533 445f  lt3.drawImage3D_
+0002d5d0: 736c 6963 6528 696d 2c20 706c 6f74 7465  slice(im, plotte
+0002d5e0: 723d 702c 2073 6c69 6365 5f6e 6f72 6d61  r=p, slice_norma
+0002d5f0: 6c5f 783d 6378 2c20 736c 6963 655f 6e6f  l_x=cx, slice_no
+0002d600: 726d 616c 5f79 3d63 792c 2073 6c69 6365  rmal_y=cy, slice
+0002d610: 5f6e 6f72 6d61 6c5f 7a3d 637a 2c20 7363  _normal_z=cz, sc
+0002d620: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+0002d630: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+0002d640: 732c 2065 7863 6c75 6465 6456 616c 3d65  s, excludedVal=e
+0002d650: 7863 6c75 6465 6456 616c 2c20 2a2a 6b77  xcludedVal, **kw
+0002d660: 6172 6773 290d 0a20 2020 2020 2020 2020  args)..         
+0002d670: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0002d680: 2020 2020 2020 2020 2020 696d 6770 6c74            imgplt
+0002d690: 332e 6472 6177 496d 6167 6533 445f 7375  3.drawImage3D_su
+0002d6a0: 7266 6163 6528 696d 2c20 706c 6f74 7465  rface(im, plotte
+0002d6b0: 723d 702c 2073 6361 6c61 725f 6261 725f  r=p, scalar_bar_
+0002d6c0: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
+0002d6d0: 725f 6b77 6172 6773 2c20 6578 636c 7564  r_kwargs, exclud
+0002d6e0: 6564 5661 6c3d 6578 636c 7564 6564 5661  edVal=excludedVa
+0002d6f0: 6c2c 2020 2a2a 6b77 6172 6773 290d 0a0d  l,  **kwargs)...
+0002d700: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002d710: 706c 6f74 7465 7220 6973 204e 6f6e 653a  plotter is None:
+0002d720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002d730: 2020 702e 6164 645f 626f 756e 6469 6e67    p.add_bounding
+0002d740: 5f62 6f78 2829 0d0a 2020 2020 2020 2020  _box()..        
+0002d750: 2020 2020 2020 2020 702e 7368 6f77 5f61          p.show_a
+0002d760: 7865 7328 290d 0a20 2020 2020 2020 2020  xes()..         
+0002d770: 2020 2020 2020 2070 2e73 686f 7728 290d         p.show().
+0002d780: 0a0d 0a20 2020 2020 2020 2065 6c73 653a  ...        else:
+0002d790: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0002d7a0: 696e 7428 224e 6f20 7661 6c75 6573 2066  int("No values f
+0002d7b0: 6f75 6e64 2066 6f72 2074 6869 7320 756e  ound for this un
+0002d7c0: 6974 2229 0d0a 0d0a 0d0a 2020 2020 6465  it")......    de
+0002d7d0: 6620 706c 6f74 5f66 6163 6965 7328 7365  f plot_facies(se
+0002d7e0: 6c66 2c20 6975 3d30 2c20 6966 613d 302c  lf, iu=0, ifa=0,
+0002d7f0: 2076 5f65 783d 312c 2069 6e73 6964 655f   v_ex=1, inside_
+0002d800: 756e 6974 733d 4e6f 6e65 2c20 6578 636c  units=None, excl
+0002d810: 7564 6564 5661 6c3d 4e6f 6e65 2c0d 0a20  udedVal=None,.. 
+0002d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d830: 2020 2070 6c6f 7474 6572 3d4e 6f6e 652c     plotter=None,
+0002d840: 2073 6c69 6365 783d 4e6f 6e65 2c20 736c   slicex=None, sl
+0002d850: 6963 6579 3d4e 6f6e 652c 2073 6c69 6365  icey=None, slice
+0002d860: 7a3d 4e6f 6e65 2c0d 0a20 2020 2020 2020  z=None,..       
+0002d870: 2020 2020 2020 2020 2020 2020 2073 6361               sca
+0002d880: 6c61 725f 6261 725f 6b77 6172 6773 3d4e  lar_bar_kwargs=N
+0002d890: 6f6e 652c 2073 686f 775f 7363 616c 6172  one, show_scalar
+0002d8a0: 5f62 6172 3d54 7275 652c 202a 2a6b 7761  _bar=True, **kwa
+0002d8b0: 7267 7329 3a0d 0a0d 0a20 2020 2020 2020  rgs):....       
+0002d8c0: 2022 2222 0d0a 2020 2020 2020 2020 506c   """..        Pl
+0002d8d0: 6f74 2074 6865 2066 6163 6965 7320 7265  ot the facies re
+0002d8e0: 616c 697a 6174 696f 6e73 206f 7665 7220  alizations over 
+0002d8f0: 7468 6520 646f 6d61 696e 2077 6974 6820  the domain with 
+0002d900: 7468 6520 636f 6c6f 7273 2061 7474 7269  the colors attri
+0002d910: 6275 7465 6420 746f 2066 6163 6965 730d  buted to facies.
+0002d920: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+0002d930: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+0002d940: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+0002d950: 2020 2069 753a 2069 6e74 0d0a 2020 2020     iu: int..    
+0002d960: 2020 2020 2020 2020 696e 6469 6365 206f          indice o
+0002d970: 6620 756e 6974 7320 7265 616c 697a 6174  f units realizat
+0002d980: 696f 6e0d 0a20 2020 2020 2020 2069 6661  ion..        ifa
+0002d990: 3a20 696e 740d 0a20 2020 2020 2020 2020  : int..         
+0002d9a0: 2020 2069 6e64 6963 6520 6f66 2066 6163     indice of fac
+0002d9b0: 6965 7320 7265 616c 7a69 6174 696f 6e0d  ies realziation.
+0002d9c0: 0a20 2020 2020 2020 2076 5f65 783a 2069  .        v_ex: i
+0002d9d0: 6e74 206f 7220 666c 6f61 740d 0a20 2020  nt or float..   
+0002d9e0: 2020 2020 2020 2020 2076 6572 7469 6361           vertica
+0002d9f0: 6c20 6578 6167 6572 6174 696f 6e0d 0a20  l exageration.. 
+0002da00: 2020 2020 2020 2069 6e73 6964 655f 756e         inside_un
+0002da10: 6974 733a 2061 7272 6179 2d6c 696b 6520  its: array-like 
+0002da20: 6f66 203a 636c 6173 733a 6055 6e69 7460  of :class:`Unit`
+0002da30: 206f 626a 6563 7473 0d0a 2020 2020 2020   objects..      
+0002da40: 2020 2020 2020 6c69 7374 206f 6620 756e        list of un
+0002da50: 6974 7320 696e 7369 6465 2077 6869 6368  its inside which
+0002da60: 2077 6520 7761 6e74 2074 6f20 6861 7665   we want to have
+0002da70: 2074 6865 2070 6c6f 742e 0d0a 2020 2020   the plot...    
+0002da80: 2020 2020 2020 2020 6966 204e 6f6e 6520          if None 
+0002da90: 2d2d 3e20 616c 6c0d 0a20 2020 2020 2020  --> all..       
+0002daa0: 2070 6c6f 7474 6572 3a20 7079 7669 7374   plotter: pyvist
+0002dab0: 6120 706c 6f74 7465 7220 6966 2077 616e  a plotter if wan
+0002dac0: 7465 640d 0a20 2020 2020 2020 2073 6c69  ted..        sli
+0002dad0: 6365 783a 2066 6c6f 6174 206f 7220 7365  cex: float or se
+0002dae0: 7175 656e 6365 206f 6620 666c 6f61 7473  quence of floats
+0002daf0: 0d0a 2020 2020 2020 2020 2020 2020 6672  ..            fr
+0002db00: 6163 7469 6f6e 206f 6620 7820 6178 6973  action of x axis
+0002db10: 2077 6865 7265 2074 6f20 736c 6963 650d   where to slice.
+0002db20: 0a20 2020 2020 2020 2073 6c69 6365 793a  .        slicey:
+0002db30: 2066 6c6f 6174 206f 7220 7365 7175 656e   float or sequen
+0002db40: 6365 206f 6620 666c 6f61 7473 0d0a 2020  ce of floats..  
+0002db50: 2020 2020 2020 2020 2020 6672 6163 7469            fracti
+0002db60: 6f6e 206f 6620 7920 6178 6973 2077 6865  on of y axis whe
+0002db70: 7265 2074 6f20 736c 6963 650d 0a20 2020  re to slice..   
+0002db80: 2020 2020 2073 6c69 6365 7a3a 2066 6c6f       slicez: flo
+0002db90: 6174 206f 7220 7365 7175 656e 6365 206f  at or sequence o
+0002dba0: 6620 666c 6f61 7473 0d0a 2020 2020 2020  f floats..      
+0002dbb0: 2020 2020 2020 6672 6163 7469 6f6e 206f        fraction o
+0002dbc0: 6620 7a20 6178 6973 2077 6865 7265 2074  f z axis where t
+0002dbd0: 6f20 736c 6963 650d 0a20 2020 2020 2020  o slice..       
+0002dbe0: 2073 6361 6c61 725f 6261 725f 6b77 6172   scalar_bar_kwar
+0002dbf0: 6773 3a20 6469 6374 0d0a 2020 2020 2020  gs: dict..      
+0002dc00: 2020 2020 2020 6b77 6172 6773 2066 6f72        kwargs for
+0002dc10: 2074 6865 2073 6361 6c61 7220 6261 720d   the scalar bar.
+0002dc20: 0a20 2020 2020 2020 2073 686f 775f 7363  .        show_sc
+0002dc30: 616c 6172 5f62 6172 3a20 626f 6f6c 0d0a  alar_bar: bool..
+0002dc40: 2020 2020 2020 2020 2020 2020 6966 2054              if T
+0002dc50: 7275 652c 2073 686f 7720 7468 6520 7363  rue, show the sc
+0002dc60: 616c 6172 2062 6172 0d0a 2020 2020 2020  alar bar..      
+0002dc70: 2020 6b77 6172 6773 3a64 6963 740d 0a20    kwargs:dict.. 
+0002dc80: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
+0002dc90: 7320 746f 2070 6173 7320 746f 2067 656f  s to pass to geo
+0002dca0: 6e65 2e69 6d67 706c 6f74 2e64 7261 7749  ne.imgplot.drawI
+0002dcb0: 6d61 6765 3344 5f73 6c69 6365 206f 7220  mage3D_slice or 
+0002dcc0: 6765 6f6e 652e 696d 6770 6c6f 742e 6472  geone.imgplot.dr
+0002dcd0: 6177 496d 6167 6533 445f 7375 7266 6163  awImage3D_surfac
+0002dce0: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
+0002dcf0: 0d0a 2020 2020 2020 2020 6661 5f64 6f6d  ..        fa_dom
+0002dd00: 6169 6e73 3d73 656c 662e 6765 745f 6661  ains=self.get_fa
+0002dd10: 6369 6573 2869 752c 2069 6661 2c20 616c  cies(iu, ifa, al
+0002dd20: 6c5f 6461 7461 3d46 616c 7365 292e 6173  l_data=False).as
+0002dd30: 7479 7065 286e 702e 666c 6f61 7433 3229  type(np.float32)
+0002dd40: 0d0a 0d0a 2020 2020 2020 2020 236b 6565  ....        #kee
+0002dd50: 7020 6661 6369 6573 2069 6e20 6f6e 6c79  p facies in only
+0002dd60: 2077 616e 7465 6420 756e 6974 730d 0a20   wanted units.. 
+0002dd70: 2020 2020 2020 2069 6620 696e 7369 6465         if inside
+0002dd80: 5f75 6e69 7473 2069 7320 6e6f 7420 4e6f  _units is not No
+0002dd90: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002dda0: 206d 6173 6b5f 616c 6c3d 6e70 2e7a 6572   mask_all=np.zer
+0002ddb0: 6f73 285b 7365 6c66 2e67 6574 5f6e 7a28  os([self.get_nz(
+0002ddc0: 292c 2073 656c 662e 6765 745f 6e79 2829  ), self.get_ny()
+0002ddd0: 2c20 7365 6c66 2e67 6574 5f6e 7828 295d  , self.get_nx()]
+0002dde0: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+0002ddf0: 6f72 2075 2069 6e20 696e 7369 6465 5f75  or u in inside_u
+0002de00: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
+0002de10: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0002de20: 616e 6365 2875 2c20 7374 7229 3a0d 0a20  ance(u, str):.. 
+0002de30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002de40: 2020 206d 6173 6b3d 7365 6c66 2e75 6e69     mask=self.uni
+0002de50: 745f 6d61 736b 2875 2c20 6975 3d20 6975  t_mask(u, iu= iu
+0002de60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002de70: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+0002de80: 6365 2875 2c20 556e 6974 2920 616e 6420  ce(u, Unit) and 
+0002de90: 7520 696e 2073 656c 662e 6765 745f 616c  u in self.get_al
+0002dea0: 6c5f 756e 6974 7328 293a 0d0a 2020 2020  l_units():..    
+0002deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dec0: 6d61 736b 3d73 656c 662e 756e 6974 5f6d  mask=self.unit_m
+0002ded0: 6173 6b28 752e 6e61 6d65 2c20 6975 3d20  ask(u.name, iu= 
+0002dee0: 6975 290d 0a20 2020 2020 2020 2020 2020  iu)..           
+0002def0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002df10: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002df20: 2028 2255 6e69 7420 7061 7373 6564 2069   ("Unit passed i
+0002df30: 6e20 696e 7369 6465 5f75 6e69 7473 206d  n inside_units m
+0002df40: 7573 7420 6265 2061 2075 6e69 7420 6e61  ust be a unit na
+0002df50: 6d65 206f 7220 6120 756e 6974 206f 626a  me or a unit obj
+0002df60: 6563 7420 636f 6e74 6169 6e65 6420 696e  ect contained in
+0002df70: 2074 6865 2041 7263 6854 6162 6c65 2229   the ArchTable")
+0002df80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002df90: 2020 6d61 736b 5f61 6c6c 5b6d 6173 6b20    mask_all[mask 
+0002dfa0: 3d3d 2031 5d3d 310d 0a0d 0a20 2020 2020  == 1]=1....     
+0002dfb0: 2020 2020 2020 2066 615f 646f 6d61 696e         fa_domain
+0002dfc0: 735b 6d61 736b 5f61 6c6c 2021 3d20 315d  s[mask_all != 1]
+0002dfd0: 3d30 0d0a 0d0a 2020 2020 2020 2020 643d  =0....        d=
+0002dfe0: 7b7d 0d0a 2020 2020 2020 2020 636f 6c6f  {}..        colo
+0002dff0: 7273 3d5b 5d0d 0a20 2020 2020 2020 206e  rs=[]..        n
+0002e000: 783d 7365 6c66 2e67 6574 5f6e 7828 290d  x=self.get_nx().
+0002e010: 0a20 2020 2020 2020 206e 793d 7365 6c66  .        ny=self
+0002e020: 2e67 6574 5f6e 7928 290d 0a20 2020 2020  .get_ny()..     
+0002e030: 2020 206e 7a3d 7365 6c66 2e67 6574 5f6e     nz=self.get_n
+0002e040: 7a28 290d 0a20 2020 2020 2020 2073 783d  z()..        sx=
+0002e050: 7365 6c66 2e67 6574 5f73 7828 290d 0a20  self.get_sx().. 
+0002e060: 2020 2020 2020 2073 793d 7365 6c66 2e67         sy=self.g
+0002e070: 6574 5f73 7928 290d 0a20 2020 2020 2020  et_sy()..       
+0002e080: 2073 7a3d 7365 6c66 2e67 6574 5f73 7a28   sz=self.get_sz(
+0002e090: 290d 0a20 2020 2020 2020 2078 303d 7365  )..        x0=se
+0002e0a0: 6c66 2e67 6574 5f6f 7828 290d 0a20 2020  lf.get_ox()..   
+0002e0b0: 2020 2020 2079 303d 7365 6c66 2e67 6574       y0=self.get
+0002e0c0: 5f6f 7928 290d 0a20 2020 2020 2020 207a  _oy()..        z
+0002e0d0: 303d 7365 6c66 2e67 6574 5f6f 7a28 290d  0=self.get_oz().
+0002e0e0: 0a20 2020 2020 2020 206c 7374 5f49 443d  .        lst_ID=
+0002e0f0: 6e70 2e75 6e69 7175 6528 6661 5f64 6f6d  np.unique(fa_dom
+0002e100: 6169 6e73 290d 0a20 2020 2020 2020 206e  ains)..        n
+0002e110: 6577 5f6c 7374 5f49 4420 3d20 5b5d 0d0a  ew_lst_ID = []..
+0002e120: 2020 2020 2020 2020 6966 2065 7863 6c75          if exclu
+0002e130: 6465 6456 616c 2069 7320 4e6f 6e65 3a0d  dedVal is None:.
+0002e140: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0002e150: 6c75 6465 6456 616c 3d5b 5d0d 0a20 2020  ludedVal=[]..   
+0002e160: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002e170: 6365 2865 7863 6c75 6465 6456 616c 2c20  ce(excludedVal, 
+0002e180: 696e 7429 3a0d 0a20 2020 2020 2020 2020  int):..         
+0002e190: 2020 2065 7863 6c75 6465 6456 616c 3d5b     excludedVal=[
+0002e1a0: 6578 636c 7564 6564 5661 6c5d 0d0a 0d0a  excludedVal]....
+0002e1b0: 2020 2020 2020 2020 2323 2063 7265 6174          ## creat
+0002e1c0: 6520 6120 6469 6374 696f 6e6e 6172 7920  e a dictionnary 
+0002e1d0: 746f 206d 6170 2074 6865 2066 6163 6965  to map the facie
+0002e1e0: 7320 4944 2074 6f20 7468 6520 6661 6369  s ID to the faci
+0002e1f0: 6573 206e 616d 650d 0a20 2020 2020 2020  es name..       
+0002e200: 206e 6577 5f69 643d 310d 0a20 2020 2020   new_id=1..     
+0002e210: 2020 2066 6f72 2069 2069 6e20 6c73 745f     for i in lst_
+0002e220: 4944 3a0d 0a20 2020 2020 2020 2020 2020  ID:..           
+0002e230: 2069 6620 6920 213d 2030 3a0d 0a20 2020   if i != 0:..   
+0002e240: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0002e250: 6920 6e6f 7420 696e 2065 7863 6c75 6465  i not in exclude
+0002e260: 6456 616c 3a0d 0a20 2020 2020 2020 2020  dVal:..         
+0002e270: 2020 2020 2020 2020 2020 2066 613d 7365             fa=se
+0002e280: 6c66 2e67 6574 5f66 6163 6965 735f 6f62  lf.get_facies_ob
+0002e290: 6a28 4944 3d69 2c20 7479 7065 3d22 4944  j(ID=i, type="ID
+0002e2a0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0002e2b0: 2020 2020 2020 2020 2320 6661 5f64 6f6d          # fa_dom
+0002e2c0: 6169 6e73 5b66 615f 646f 6d61 696e 7320  ains[fa_domains 
+0002e2d0: 3d3d 2066 612e 4944 5d3d 6e65 775f 6964  == fa.ID]=new_id
+0002e2e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002e2f0: 2020 2020 2020 636f 6c6f 7273 2e61 7070        colors.app
+0002e300: 656e 6428 6661 2e63 290d 0a20 2020 2020  end(fa.c)..     
+0002e310: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002e320: 5b6e 6577 5f69 6420 2b20 302e 355d 3d66  [new_id + 0.5]=f
+0002e330: 612e 6e61 6d65 0d0a 2020 2020 2020 2020  a.name..        
+0002e340: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+0002e350: 6964 202b 3d20 310d 0a20 2020 2020 2020  id += 1..       
+0002e360: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0002e370: 5f6c 7374 5f49 442e 6170 7065 6e64 2869  _lst_ID.append(i
+0002e380: 290d 0a0d 0a20 2020 2020 2020 2023 7265  )....        #re
+0002e390: 6d6f 7665 2030 206f 6363 7572 656e 6365  move 0 occurence
+0002e3a0: 2028 7768 6572 6520 6e6f 2066 6163 6965   (where no facie
+0002e3b0: 7320 6172 6520 7072 6573 656e 7429 0d0a  s are present)..
+0002e3c0: 2020 2020 2020 2020 6661 5f64 6f6d 6169          fa_domai
+0002e3d0: 6e73 5b66 615f 646f 6d61 696e 733d 3d30  ns[fa_domains==0
+0002e3e0: 5d3d 6e70 2e6e 616e 0d0a 0d0a 2020 2020  ]=np.nan....    
+0002e3f0: 2020 2020 6966 2070 6c6f 7474 6572 2069      if plotter i
+0002e400: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+0002e410: 2020 2020 2070 3d70 762e 506c 6f74 7465       p=pv.Plotte
+0002e420: 7228 290d 0a20 2020 2020 2020 2065 6c73  r()..        els
+0002e430: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002e440: 703d 706c 6f74 7465 720d 0a20 2020 2020  p=plotter..     
+0002e450: 2020 2069 6d3d 6765 6f6e 652e 696d 672e     im=geone.img.
+0002e460: 496d 6728 6e78 2c20 6e79 2c20 6e7a 2c20  Img(nx, ny, nz, 
+0002e470: 7378 2c20 7379 2c20 737a 2a76 5f65 782c  sx, sy, sz*v_ex,
+0002e480: 2078 302c 2079 302c 207a 302c 206e 763d   x0, y0, z0, nv=
+0002e490: 312c 2076 616c 3d66 615f 646f 6d61 696e  1, val=fa_domain
+0002e4a0: 732c 2076 6172 6e61 6d65 3d22 4c69 7468  s, varname="Lith
+0002e4b0: 6f6c 6f67 6965 7322 290d 0a0d 0a20 2020  ologies")....   
+0002e4c0: 2020 2020 2069 6620 736c 6963 6578 2069       if slicex i
+0002e4d0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0002e4e0: 2020 2020 2020 2020 2073 6c69 6365 783d           slicex=
+0002e4f0: 6e70 2e61 7272 6179 2873 6c69 6365 7829  np.array(slicex)
+0002e500: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
+0002e510: 6963 6578 5b73 6c69 6365 783c 305d 3d30  icex[slicex<0]=0
+0002e520: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
+0002e530: 6963 6578 5b73 6c69 6365 783e 315d 3d31  icex[slicex>1]=1
+0002e540: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
+0002e550: 3d69 6d2e 6f78 202b 2073 6c69 6365 7820  =im.ox + slicex 
+0002e560: 2a20 696d 2e6e 7820 2a20 696d 2e73 7820  * im.nx * im.sx 
+0002e570: 2023 2063 656e 7465 7220 616c 6f6e 6720   # center along 
+0002e580: 780d 0a20 2020 2020 2020 2065 6c73 653a  x..        else:
+0002e590: 0d0a 2020 2020 2020 2020 2020 2020 6378  ..            cx
+0002e5a0: 3d4e 6f6e 650d 0a20 2020 2020 2020 2069  =None..        i
+0002e5b0: 6620 736c 6963 6579 2069 7320 6e6f 7420  f slicey is not 
+0002e5c0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002e5d0: 2020 2073 6c69 6365 793d 6e70 2e61 7272     slicey=np.arr
+0002e5e0: 6179 2873 6c69 6365 7929 0d0a 2020 2020  ay(slicey)..    
+0002e5f0: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
+0002e600: 6c69 6365 793c 305d 3d30 0d0a 2020 2020  licey<0]=0..    
+0002e610: 2020 2020 2020 2020 736c 6963 6579 5b73          slicey[s
+0002e620: 6c69 6365 793e 315d 3d31 0d0a 2020 2020  licey>1]=1..    
+0002e630: 2020 2020 2020 2020 6379 3d69 6d2e 6f79          cy=im.oy
+0002e640: 202b 2073 6c69 6365 7920 2a20 696d 2e6e   + slicey * im.n
+0002e650: 7920 2a20 696d 2e73 7920 2023 2063 656e  y * im.sy  # cen
+0002e660: 7465 7220 616c 6f6e 6720 790d 0a20 2020  ter along y..   
+0002e670: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002e680: 2020 2020 2020 2020 6379 3d4e 6f6e 650d          cy=None.
+0002e690: 0a20 2020 2020 2020 2069 6620 736c 6963  .        if slic
+0002e6a0: 657a 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ez is not None:.
+0002e6b0: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+0002e6c0: 6365 7a3d 6e70 2e61 7272 6179 2873 6c69  cez=np.array(sli
+0002e6d0: 6365 7a29 0d0a 2020 2020 2020 2020 2020  cez)..          
+0002e6e0: 2020 736c 6963 657a 5b73 6c69 6365 7a3c    slicez[slicez<
+0002e6f0: 305d 3d30 0d0a 2020 2020 2020 2020 2020  0]=0..          
+0002e700: 2020 736c 6963 657a 5b73 6c69 6365 7a3e    slicez[slicez>
+0002e710: 315d 3d31 0d0a 2020 2020 2020 2020 2020  1]=1..          
+0002e720: 2020 637a 3d69 6d2e 6f7a 202b 2073 6c69    cz=im.oz + sli
+0002e730: 6365 7a20 2a20 696d 2e6e 7a20 2a20 696d  cez * im.nz * im
+0002e740: 2e73 7a20 2023 2063 656e 7465 7220 616c  .sz  # center al
+0002e750: 6f6e 6720 7a0d 0a20 2020 2020 2020 2065  ong z..        e
+0002e760: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0002e770: 2020 637a 3d4e 6f6e 650d 0a0d 0a0d 0a20    cz=None...... 
+0002e780: 2020 2020 2020 2069 6620 736c 6963 6578         if slicex
+0002e790: 2069 7320 6e6f 7420 4e6f 6e65 206f 7220   is not None or 
+0002e7a0: 736c 6963 6579 2069 7320 6e6f 7420 4e6f  slicey is not No
+0002e7b0: 6e65 206f 7220 736c 6963 657a 2069 7320  ne or slicez is 
+0002e7c0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0002e7d0: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
+0002e7e0: 7261 7749 6d61 6765 3344 5f73 6c69 6365  rawImage3D_slice
+0002e7f0: 2869 6d2c 2070 6c6f 7474 6572 3d70 2c20  (im, plotter=p, 
+0002e800: 736c 6963 655f 6e6f 726d 616c 5f78 3d63  slice_normal_x=c
+0002e810: 782c 2073 6c69 6365 5f6e 6f72 6d61 6c5f  x, slice_normal_
+0002e820: 793d 6379 2c20 736c 6963 655f 6e6f 726d  y=cy, slice_norm
+0002e830: 616c 5f7a 3d63 7a2c 0d0a 2020 2020 2020  al_z=cz,..      
+0002e840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e850: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+0002e860: 7465 673d 5472 7565 2c20 6361 7465 6756  teg=True, categV
+0002e870: 616c 3d6e 6577 5f6c 7374 5f49 442c 2065  al=new_lst_ID, e
+0002e880: 7863 6c75 6465 6456 616c 3d65 7863 6c75  xcludedVal=exclu
+0002e890: 6465 6456 616c 2c0d 0a20 2020 2020 2020  dedVal,..       
+0002e8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e8b0: 2020 2020 2020 2020 2020 2020 2063 6174               cat
+0002e8c0: 6567 436f 6c3d 636f 6c6f 7273 2c20 7363  egCol=colors, sc
+0002e8d0: 616c 6172 5f62 6172 5f61 6e6e 6f74 6174  alar_bar_annotat
+0002e8e0: 696f 6e73 3d64 2c0d 0a20 2020 2020 2020  ions=d,..       
+0002e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e900: 2020 2020 2020 2020 2020 2020 2073 6361               sca
+0002e910: 6c61 725f 6261 725f 6b77 6172 6773 3d73  lar_bar_kwargs=s
+0002e920: 6361 6c61 725f 6261 725f 6b77 6172 6773  calar_bar_kwargs
+0002e930: 2c20 7368 6f77 5f73 6361 6c61 725f 6261  , show_scalar_ba
+0002e940: 7220 3d20 7368 6f77 5f73 6361 6c61 725f  r = show_scalar_
+0002e950: 6261 722c 202a 2a6b 7761 7267 7329 0d0a  bar, **kwargs)..
+0002e960: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002e970: 2020 2020 2020 2020 2020 2069 6d67 706c             imgpl
+0002e980: 7433 2e64 7261 7749 6d61 6765 3344 5f73  t3.drawImage3D_s
+0002e990: 7572 6661 6365 2869 6d2c 2070 6c6f 7474  urface(im, plott
+0002e9a0: 6572 3d70 2c20 6361 7465 673d 5472 7565  er=p, categ=True
+0002e9b0: 2c20 6361 7465 6756 616c 3d6e 6577 5f6c  , categVal=new_l
+0002e9c0: 7374 5f49 442c 2065 7863 6c75 6465 6456  st_ID, excludedV
+0002e9d0: 616c 3d65 7863 6c75 6465 6456 616c 2c0d  al=excludedVal,.
+0002e9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea00: 2020 2020 2063 6174 6567 436f 6c3d 636f       categCol=co
+0002ea10: 6c6f 7273 2c20 7363 616c 6172 5f62 6172  lors, scalar_bar
+0002ea20: 5f61 6e6e 6f74 6174 696f 6e73 3d64 2c0d  _annotations=d,.
+0002ea30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea50: 2020 2020 2073 6361 6c61 725f 6261 725f       scalar_bar_
+0002ea60: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
+0002ea70: 725f 6b77 6172 6773 2c20 7368 6f77 5f73  r_kwargs, show_s
+0002ea80: 6361 6c61 725f 6261 7220 3d20 7368 6f77  calar_bar = show
+0002ea90: 5f73 6361 6c61 725f 6261 722c 202a 2a6b  _scalar_bar, **k
+0002eaa0: 7761 7267 7329 0d0a 0d0a 2020 2020 2020  wargs)....      
+0002eab0: 2020 6966 2070 6c6f 7474 6572 2069 7320    if plotter is 
+0002eac0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+0002ead0: 2020 2070 2e61 6464 5f62 6f75 6e64 696e     p.add_boundin
+0002eae0: 675f 626f 7828 290d 0a20 2020 2020 2020  g_box()..       
+0002eaf0: 2020 2020 2070 2e73 686f 775f 6178 6573       p.show_axes
+0002eb00: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0002eb10: 702e 7368 6f77 2829 0d0a 0d0a 0d0a 2020  p.show()......  
+0002eb20: 2020 6465 6620 706c 6f74 5f70 726f 7028    def plot_prop(
+0002eb30: 7365 6c66 2c20 7072 6f70 6572 7479 2c20  self, property, 
+0002eb40: 6975 3d30 2c20 6966 613d 302c 2069 703d  iu=0, ifa=0, ip=
+0002eb50: 302c 2076 5f65 783d 312c 2069 6e73 6964  0, v_ex=1, insid
+0002eb60: 655f 756e 6974 733d 4e6f 6e65 2c20 696e  e_units=None, in
+0002eb70: 7369 6465 5f66 6163 6965 733d 4e6f 6e65  side_facies=None
+0002eb80: 2c20 6669 6c74 6572 696e 675f 696e 7465  , filtering_inte
+0002eb90: 7276 616c 3d4e 6f6e 652c 0d0a 2020 2020  rval=None,..    
+0002eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ebb0: 706c 6f74 7465 723d 4e6f 6e65 2c20 736c  plotter=None, sl
+0002ebc0: 6963 6578 3d4e 6f6e 652c 2073 6c69 6365  icex=None, slice
+0002ebd0: 793d 4e6f 6e65 2c20 736c 6963 657a 3d4e  y=None, slicez=N
+0002ebe0: 6f6e 652c 2063 6d69 6e3d 4e6f 6e65 2c20  one, cmin=None, 
+0002ebf0: 636d 6178 3d4e 6f6e 652c 2073 6361 6c61  cmax=None, scala
+0002ec00: 725f 6261 725f 6b77 6172 6773 3d4e 6f6e  r_bar_kwargs=Non
+0002ec10: 652c 202a 2a6b 7761 7267 7329 3a0d 0a0d  e, **kwargs):...
+0002ec20: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0002ec30: 2020 2020 2020 506c 6f74 2074 6865 2066        Plot the f
+0002ec40: 6163 6965 7320 7265 616c 697a 6174 696f  acies realizatio
+0002ec50: 6e73 206f 7665 7220 7468 6520 646f 6d61  ns over the doma
+0002ec60: 696e 2077 6974 6820 7468 6520 636f 6c6f  in with the colo
+0002ec70: 7273 2061 7474 7269 6275 7465 6420 746f  rs attributed to
+0002ec80: 2066 6163 6965 730d 0a0d 0a20 2020 2020   facies....     
+0002ec90: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0002eca0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0002ecb0: 2d0d 0a20 2020 2020 2020 2069 753a 696e  -..        iu:in
+0002ecc0: 7420 0d0a 2020 2020 2020 2020 2020 2020  t ..            
+0002ecd0: 696e 6469 6365 206f 6620 756e 6974 7320  indice of units 
+0002ece0: 7265 616c 697a 6174 696f 6e0d 0a20 2020  realization..   
+0002ecf0: 2020 2020 2069 6661 3a69 6e74 0d0a 2020       ifa:int..  
+0002ed00: 2020 2020 2020 2020 2020 696e 6469 6365            indice
+0002ed10: 206f 6620 6661 6369 6573 2072 6561 6c69   of facies reali
+0002ed20: 7a61 7469 6f6e 0d0a 2020 2020 2020 2020  zation..        
+0002ed30: 6970 3a69 6e74 0d0a 2020 2020 2020 2020  ip:int..        
+0002ed40: 2020 2020 696e 6469 6365 206f 6620 7072      indice of pr
+0002ed50: 6f70 6572 7479 2072 6561 6c69 7a61 7469  operty realizati
+0002ed60: 6f6e 0d0a 2020 2020 2020 2020 765f 6578  on..        v_ex
+0002ed70: 3a69 6e74 206f 7220 666c 6f61 740d 0a20  :int or float.. 
+0002ed80: 2020 2020 2020 2020 2020 2076 6572 7469             verti
+0002ed90: 6361 6c20 6578 6167 6572 6174 696f 6e0d  cal exageration.
+0002eda0: 0a20 2020 2020 2020 2069 6e73 6964 655f  .        inside_
+0002edb0: 756e 6974 733a 6172 7261 792d 6c69 6b65  units:array-like
+0002edc0: 206f 6620 3a63 6c61 7373 3a60 556e 6974   of :class:`Unit
+0002edd0: 6020 6f62 6a65 6374 7320 6f72 2075 6e69  ` objects or uni
+0002ede0: 7420 6e61 6d65 7320 2873 7472 696e 6729  t names (string)
+0002edf0: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
+0002ee00: 7374 206f 6620 756e 6974 7320 696e 7369  st of units insi
+0002ee10: 6465 2077 6869 6368 2077 6520 7761 6e74  de which we want
+0002ee20: 2074 6f20 6861 7665 2074 6865 2070 6c6f   to have the plo
+0002ee30: 742e 2042 7920 6465 6661 756c 7420 616c  t. By default al
+0002ee40: 6c0d 0a20 2020 2020 2020 2069 6e73 6964  l..        insid
+0002ee50: 655f 6661 6369 6573 3a61 7272 6179 2d6c  e_facies:array-l
+0002ee60: 696b 6520 6f66 203a 636c 6173 733a 6046  ike of :class:`F
+0002ee70: 6163 6965 7360 206f 626a 6563 7473 206f  acies` objects o
+0002ee80: 7220 6661 6369 6573 206e 616d 6573 2028  r facies names (
+0002ee90: 7374 7269 6e67 290d 0a20 2020 2020 2020  string)..       
+0002eea0: 2020 2020 206c 6973 7420 6f66 2066 6163       list of fac
+0002eeb0: 6965 7320 696e 7369 6465 2077 6869 6368  ies inside which
+0002eec0: 2077 6520 7761 6e74 2074 6f20 6861 7665   we want to have
+0002eed0: 2074 6865 2070 6c6f 742e 2042 7920 6465   the plot. By de
+0002eee0: 6661 756c 7420 616c 6c0d 0a20 2020 2020  fault all..     
+0002eef0: 2020 2070 6c6f 7474 6572 3a70 7976 6973     plotter:pyvis
+0002ef00: 7461 2070 6c6f 7474 6572 2069 6620 7761  ta plotter if wa
+0002ef10: 6e74 6564 0d0a 2020 2020 2020 2020 736c  nted..        sl
+0002ef20: 6963 6578 2c20 736c 6963 6579 2c20 736c  icex, slicey, sl
+0002ef30: 6963 657a 3a20 666c 6f61 7420 6f72 2073  icez: float or s
+0002ef40: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
+0002ef50: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+0002ef60: 7261 6374 696f 6e20 696e 2078 2c20 7920  raction in x, y 
+0002ef70: 6f72 207a 2064 6972 6563 7469 6f6e 2077  or z direction w
+0002ef80: 6865 7265 2074 6865 2073 6c69 6365 2069  here the slice i
+0002ef90: 7320 646f 6e65 0d0a 2020 2020 2020 2020  s done..        
+0002efa0: 636d 696e 2c20 636d 6178 3a66 6c6f 6174  cmin, cmax:float
+0002efb0: 0d0a 2020 2020 2020 2020 2020 2020 6d69  ..            mi
+0002efc0: 6e20 616e 6420 6d61 7820 7661 6c75 6520  n and max value 
+0002efd0: 6f66 2074 6865 2063 6f6c 6f72 6261 720d  of the colorbar.
+0002efe0: 0a20 2020 2020 2020 2073 6361 6c61 725f  .        scalar_
+0002eff0: 6261 725f 6b77 6172 6773 3a64 6963 740d  bar_kwargs:dict.
+0002f000: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
+0002f010: 7267 7320 666f 7220 7468 6520 7363 616c  rgs for the scal
+0002f020: 6172 2062 6172 0d0a 2020 2020 2020 2020  ar bar..        
+0002f030: 6b77 6172 6773 3a64 6963 740d 0a20 2020  kwargs:dict..   
+0002f040: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
+0002f050: 746f 2070 6173 7320 746f 2067 656f 6e65  to pass to geone
+0002f060: 2e69 6d67 706c 6f74 2e64 7261 7749 6d61  .imgplot.drawIma
+0002f070: 6765 3344 5f73 6c69 6365 206f 7220 6765  ge3D_slice or ge
+0002f080: 6f6e 652e 696d 6770 6c6f 742e 6472 6177  one.imgplot.draw
+0002f090: 496d 6167 6533 445f 7375 7266 6163 650d  Image3D_surface.
+0002f0a0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0002f0b0: 2020 2020 2020 2020 7072 6f70 3d73 656c          prop=sel
+0002f0c0: 662e 6765 745f 7072 6f70 2870 726f 7065  f.get_prop(prope
+0002f0d0: 7274 792c 2069 752c 2069 6661 2c20 6970  rty, iu, ifa, ip
+0002f0e0: 2c20 616c 6c5f 6461 7461 3d46 616c 7365  , all_data=False
+0002f0f0: 290d 0a20 2020 2020 2020 2066 6163 6965  )..        facie
+0002f100: 733d 7365 6c66 2e67 6574 5f66 6163 6965  s=self.get_facie
+0002f110: 7328 6975 2c20 6966 612c 2061 6c6c 5f64  s(iu, ifa, all_d
+0002f120: 6174 613d 4661 6c73 6529 0d0a 0d0a 2020  ata=False)....  
+0002f130: 2020 2020 2020 236b 6565 7020 7661 6c75        #keep valu
+0002f140: 6573 2069 6e20 6f6e 6c79 2077 616e 7465  es in only wante
+0002f150: 6420 756e 6974 730d 0a20 2020 2020 2020  d units..       
+0002f160: 2069 6620 696e 7369 6465 5f75 6e69 7473   if inside_units
+0002f170: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+0002f180: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+0002f190: 616c 6c3d 6e70 2e7a 6572 6f73 285b 7365  all=np.zeros([se
+0002f1a0: 6c66 2e67 6574 5f6e 7a28 292c 2073 656c  lf.get_nz(), sel
+0002f1b0: 662e 6765 745f 6e79 2829 2c20 7365 6c66  f.get_ny(), self
+0002f1c0: 2e67 6574 5f6e 7828 295d 290d 0a20 2020  .get_nx()])..   
+0002f1d0: 2020 2020 2020 2020 2066 6f72 2075 2069           for u i
+0002f1e0: 6e20 696e 7369 6465 5f75 6e69 7473 3a0d  n inside_units:.
+0002f1f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f200: 2069 6620 6973 696e 7374 616e 6365 2875   if isinstance(u
+0002f210: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+0002f220: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+0002f230: 6b3d 7365 6c66 2e75 6e69 745f 6d61 736b  k=self.unit_mask
+0002f240: 2875 2c20 6975 3d69 7529 0d0a 2020 2020  (u, iu=iu)..    
+0002f250: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0002f260: 2069 7369 6e73 7461 6e63 6528 752c 2055   isinstance(u, U
+0002f270: 6e69 7429 2061 6e64 2075 2069 6e20 7365  nit) and u in se
+0002f280: 6c66 2e67 6574 5f61 6c6c 5f75 6e69 7473  lf.get_all_units
+0002f290: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+0002f2a0: 2020 2020 2020 2020 206d 6173 6b3d 7365           mask=se
+0002f2b0: 6c66 2e75 6e69 745f 6d61 736b 2875 2e6e  lf.unit_mask(u.n
+0002f2c0: 616d 652c 2069 753d 6975 290d 0a20 2020  ame, iu=iu)..   
+0002f2d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0002f2e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0002f2f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002f300: 6c75 6545 7272 6f72 2028 2255 6e69 7420  lueError ("Unit 
+0002f310: 7061 7373 6564 2069 6e20 696e 7369 6465  passed in inside
+0002f320: 5f75 6e69 7473 206d 7573 7420 6265 2061  _units must be a
+0002f330: 2075 6e69 7420 6e61 6d65 206f 7220 6120   unit name or a 
+0002f340: 756e 6974 206f 626a 6563 7420 636f 6e74  unit object cont
+0002f350: 6169 6e65 6420 696e 2074 6865 2041 7263  ained in the Arc
+0002f360: 6854 6162 6c65 2229 0d0a 2020 2020 2020  hTable")..      
+0002f370: 2020 2020 2020 2020 2020 6d61 736b 5f61            mask_a
+0002f380: 6c6c 5b6d 6173 6b20 3d3d 2031 5d3d 310d  ll[mask == 1]=1.
+0002f390: 0a0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
+0002f3a0: 726f 705b 6d61 736b 5f61 6c6c 2021 3d20  rop[mask_all != 
+0002f3b0: 315d 3d6e 702e 6e61 6e0d 0a0d 0a20 2020  1]=np.nan....   
+0002f3c0: 2020 2020 2023 6b65 6570 2076 616c 7565       #keep value
+0002f3d0: 7320 696e 206f 6e6c 7920 7761 6e74 6564  s in only wanted
+0002f3e0: 2066 6163 6965 730d 0a20 2020 2020 2020   facies..       
+0002f3f0: 2069 6620 696e 7369 6465 5f66 6163 6965   if inside_facie
+0002f400: 7320 6973 206e 6f74 204e 6f6e 653a 0d0a  s is not None:..
+0002f410: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
+0002f420: 5f61 6c6c 3d6e 702e 7a65 726f 7328 5b73  _all=np.zeros([s
+0002f430: 656c 662e 6765 745f 6e7a 2829 2c20 7365  elf.get_nz(), se
+0002f440: 6c66 2e67 6574 5f6e 7928 292c 2073 656c  lf.get_ny(), sel
+0002f450: 662e 6765 745f 6e78 2829 5d29 0d0a 2020  f.get_nx()])..  
+0002f460: 2020 2020 2020 2020 2020 666f 7220 6661            for fa
+0002f470: 2069 6e20 696e 7369 6465 5f66 6163 6965   in inside_facie
+0002f480: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0002f490: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0002f4a0: 6528 6661 2c20 7374 7229 3a0d 0a20 2020  e(fa, str):..   
+0002f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4c0: 206d 6173 6b3d 2866 6163 6965 7320 3d3d   mask=(facies ==
+0002f4d0: 2073 656c 662e 6765 745f 6661 6369 6573   self.get_facies
+0002f4e0: 5f6f 626a 2866 6129 2e49 4429 0d0a 2020  _obj(fa).ID)..  
+0002f4f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0002f500: 6966 2069 7369 6e73 7461 6e63 6528 6661  if isinstance(fa
+0002f510: 2c20 4661 6369 6573 2920 616e 6420 6661  , Facies) and fa
+0002f520: 2069 6e20 7365 6c66 2e67 6574 5f61 6c6c   in self.get_all
+0002f530: 5f66 6163 6965 7328 293a 0d0a 2020 2020  _facies():..    
+0002f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f550: 6d61 736b 3d28 6661 6369 6573 203d 3d20  mask=(facies == 
+0002f560: 6661 2e49 4429 0d0a 2020 2020 2020 2020  fa.ID)..        
+0002f570: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0002f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f590: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0002f5a0: 726f 7220 2822 556e 6974 2070 6173 7365  ror ("Unit passe
+0002f5b0: 6420 696e 2069 6e73 6964 655f 756e 6974  d in inside_unit
+0002f5c0: 7320 6d75 7374 2062 6520 6120 756e 6974  s must be a unit
+0002f5d0: 206e 616d 6520 6f72 2061 2075 6e69 7420   name or a unit 
+0002f5e0: 6f62 6a65 6374 2063 6f6e 7461 696e 6564  object contained
+0002f5f0: 2069 6e20 7468 6520 4172 6368 5461 626c   in the ArchTabl
+0002f600: 6522 290d 0a20 2020 2020 2020 2020 2020  e")..           
+0002f610: 2020 2020 206d 6173 6b5f 616c 6c5b 6d61       mask_all[ma
+0002f620: 736b 203d 3d20 315d 3d31 0d0a 0d0a 2020  sk == 1]=1....  
+0002f630: 2020 2020 2020 2020 2020 7072 6f70 5b6d            prop[m
+0002f640: 6173 6b5f 616c 6c20 213d 2031 5d3d 6e70  ask_all != 1]=np
+0002f650: 2e6e 616e 0d0a 0d0a 2020 2020 2020 2020  .nan....        
+0002f660: 6966 207e 7072 6f70 2e61 6e79 2829 3a0d  if ~prop.any():.
+0002f670: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0002f680: 7365 2056 616c 7565 4572 726f 7220 2822  se ValueError ("
+0002f690: 4572 726f 723a 204e 6f20 7661 6c75 6573  Error: No values
+0002f6a0: 2066 6f75 6e64 2229 0d0a 0d0a 2020 2020   found")....    
+0002f6b0: 2020 2020 6e78 3d73 656c 662e 6765 745f      nx=self.get_
+0002f6c0: 6e78 2829 0d0a 2020 2020 2020 2020 6e79  nx()..        ny
+0002f6d0: 3d73 656c 662e 6765 745f 6e79 2829 0d0a  =self.get_ny()..
+0002f6e0: 2020 2020 2020 2020 6e7a 3d73 656c 662e          nz=self.
+0002f6f0: 6765 745f 6e7a 2829 0d0a 2020 2020 2020  get_nz()..      
+0002f700: 2020 7378 3d73 656c 662e 6765 745f 7378    sx=self.get_sx
+0002f710: 2829 0d0a 2020 2020 2020 2020 7379 3d73  ()..        sy=s
+0002f720: 656c 662e 6765 745f 7379 2829 0d0a 2020  elf.get_sy()..  
+0002f730: 2020 2020 2020 737a 3d73 656c 662e 6765        sz=self.ge
+0002f740: 745f 737a 2829 0d0a 2020 2020 2020 2020  t_sz()..        
+0002f750: 7830 3d73 656c 662e 6765 745f 6f78 2829  x0=self.get_ox()
+0002f760: 0d0a 2020 2020 2020 2020 7930 3d73 656c  ..        y0=sel
+0002f770: 662e 6765 745f 6f79 2829 0d0a 2020 2020  f.get_oy()..    
+0002f780: 2020 2020 7a30 3d73 656c 662e 6765 745f      z0=self.get_
+0002f790: 6f7a 2829 0d0a 0d0a 2020 2020 2020 2020  oz()....        
+0002f7a0: 2320 6669 6c74 6572 2076 616c 7565 730d  # filter values.
+0002f7b0: 0a20 2020 2020 2020 2069 6620 6669 6c74  .        if filt
+0002f7c0: 6572 696e 675f 696e 7465 7276 616c 2069  ering_interval i
+0002f7d0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0002f7e0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0002f7f0: 7374 616e 6365 2866 696c 7465 7269 6e67  stance(filtering
+0002f800: 5f69 6e74 6572 7661 6c2c 206c 6973 7429  _interval, list)
+0002f810: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002f820: 2020 2069 6620 6c65 6e28 6669 6c74 6572     if len(filter
+0002f830: 696e 675f 696e 7465 7276 616c 2920 3d3d  ing_interval) ==
+0002f840: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
+0002f850: 2020 2020 2020 2020 2069 6620 6669 6c74           if filt
+0002f860: 6572 696e 675f 696e 7465 7276 616c 5b30  ering_interval[0
+0002f870: 5d20 3c20 6669 6c74 6572 696e 675f 696e  ] < filtering_in
+0002f880: 7465 7276 616c 5b31 5d3a 0d0a 2020 2020  terval[1]:..    
+0002f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8a0: 2020 2020 7072 6f70 5b70 726f 7020 3c20      prop[prop < 
+0002f8b0: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+0002f8c0: 616c 5b30 5d5d 203d 206e 702e 6e61 6e0d  al[0]] = np.nan.
+0002f8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f8e0: 2020 2020 2020 2020 2070 726f 705b 7072           prop[pr
+0002f8f0: 6f70 203e 2066 696c 7465 7269 6e67 5f69  op > filtering_i
+0002f900: 6e74 6572 7661 6c5b 315d 5d20 3d20 6e70  nterval[1]] = np
+0002f910: 2e6e 616e 0d0a 2020 2020 2020 2020 2020  .nan..          
+0002f920: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0002f930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f940: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0002f950: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+0002f960: 616c 5b30 5d20 6d75 7374 2062 6520 736d  al[0] must be sm
+0002f970: 616c 6c65 7220 7468 616e 2066 696c 7465  aller than filte
+0002f980: 7269 6e67 5f69 6e74 6572 7661 6c5b 315d  ring_interval[1]
+0002f990: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0002f9a0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0002f9b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0002f9c0: 7269 6e74 2822 6669 6c74 6572 696e 675f  rint("filtering_
+0002f9d0: 696e 7465 7276 616c 206d 7573 7420 6265  interval must be
+0002f9e0: 2061 206c 6973 7420 6f66 2074 776f 2076   a list of two v
+0002f9f0: 616c 7565 7322 290d 0a20 2020 2020 2020  alues")..       
+0002fa00: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0002fa10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0002fa20: 7428 2266 696c 7465 7269 6e67 5f69 6e74  t("filtering_int
+0002fa30: 6572 7661 6c20 6d75 7374 2062 6520 6120  erval must be a 
+0002fa40: 6c69 7374 206f 6620 7477 6f20 7661 6c75  list of two valu
+0002fa50: 6573 2229 0d0a 0d0a 2020 2020 2020 2020  es")....        
+0002fa60: 6966 2070 6c6f 7474 6572 2069 7320 4e6f  if plotter is No
+0002fa70: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002fa80: 2070 3d70 762e 506c 6f74 7465 7228 290d   p=pv.Plotter().
+0002fa90: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0002faa0: 2020 2020 2020 2020 2020 2020 703d 706c              p=pl
+0002fab0: 6f74 7465 720d 0a20 2020 2020 2020 2069  otter..        i
+0002fac0: 6d3d 6765 6f6e 652e 696d 672e 496d 6728  m=geone.img.Img(
+0002fad0: 6e78 2c20 6e79 2c20 6e7a 2c20 7378 2c20  nx, ny, nz, sx, 
+0002fae0: 7379 2c20 737a 2a76 5f65 782c 2078 302c  sy, sz*v_ex, x0,
+0002faf0: 2079 302c 207a 302c 206e 763d 312c 2076   y0, z0, nv=1, v
+0002fb00: 616c 3d70 726f 702c 2076 6172 6e61 6d65  al=prop, varname
+0002fb10: 3d70 726f 7065 7274 7929 0d0a 0d0a 2020  =property)....  
+0002fb20: 2020 2020 2020 6966 2073 6c69 6365 7820        if slicex 
+0002fb30: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+0002fb40: 2020 2020 2020 2020 2020 736c 6963 6578            slicex
+0002fb50: 3d6e 702e 6172 7261 7928 736c 6963 6578  =np.array(slicex
+0002fb60: 290d 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0002fb70: 6c69 6365 785b 736c 6963 6578 3c30 5d3d  licex[slicex<0]=
+0002fb80: 300d 0a20 2020 2020 2020 2020 2020 2073  0..            s
+0002fb90: 6c69 6365 785b 736c 6963 6578 3e31 5d3d  licex[slicex>1]=
+0002fba0: 310d 0a20 2020 2020 2020 2020 2020 2063  1..            c
+0002fbb0: 783d 696d 2e6f 7820 2b20 736c 6963 6578  x=im.ox + slicex
+0002fbc0: 202a 2069 6d2e 6e78 202a 2069 6d2e 7378   * im.nx * im.sx
+0002fbd0: 2020 2320 6365 6e74 6572 2061 6c6f 6e67    # center along
+0002fbe0: 2078 0d0a 2020 2020 2020 2020 656c 7365   x..        else
+0002fbf0: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0002fc00: 783d 4e6f 6e65 0d0a 2020 2020 2020 2020  x=None..        
+0002fc10: 6966 2073 6c69 6365 7920 6973 206e 6f74  if slicey is not
+0002fc20: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0002fc30: 2020 2020 736c 6963 6579 3d6e 702e 6172      slicey=np.ar
+0002fc40: 7261 7928 736c 6963 6579 290d 0a20 2020  ray(slicey)..   
+0002fc50: 2020 2020 2020 2020 2073 6c69 6365 795b           slicey[
+0002fc60: 736c 6963 6579 3c30 5d3d 300d 0a20 2020  slicey<0]=0..   
+0002fc70: 2020 2020 2020 2020 2073 6c69 6365 795b           slicey[
+0002fc80: 736c 6963 6579 3e31 5d3d 310d 0a20 2020  slicey>1]=1..   
+0002fc90: 2020 2020 2020 2020 2063 793d 696d 2e6f           cy=im.o
+0002fca0: 7920 2b20 736c 6963 6579 202a 2069 6d2e  y + slicey * im.
+0002fcb0: 6e79 202a 2069 6d2e 7379 2020 2320 6365  ny * im.sy  # ce
+0002fcc0: 6e74 6572 2061 6c6f 6e67 2079 0d0a 2020  nter along y..  
+0002fcd0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0002fce0: 2020 2020 2020 2020 2063 793d 4e6f 6e65           cy=None
+0002fcf0: 0d0a 2020 2020 2020 2020 6966 2073 6c69  ..        if sli
+0002fd00: 6365 7a20 6973 206e 6f74 204e 6f6e 653a  cez is not None:
+0002fd10: 0d0a 2020 2020 2020 2020 2020 2020 736c  ..            sl
+0002fd20: 6963 657a 3d6e 702e 6172 7261 7928 736c  icez=np.array(sl
+0002fd30: 6963 657a 290d 0a20 2020 2020 2020 2020  icez)..         
+0002fd40: 2020 2073 6c69 6365 7a5b 736c 6963 657a     slicez[slicez
+0002fd50: 3c30 5d3d 300d 0a20 2020 2020 2020 2020  <0]=0..         
+0002fd60: 2020 2073 6c69 6365 7a5b 736c 6963 657a     slicez[slicez
+0002fd70: 3e31 5d3d 310d 0a20 2020 2020 2020 2020  >1]=1..         
+0002fd80: 2020 2063 7a3d 696d 2e6f 7a20 2b20 736c     cz=im.oz + sl
+0002fd90: 6963 657a 202a 2069 6d2e 6e7a 202a 2069  icez * im.nz * i
+0002fda0: 6d2e 737a 2020 2320 6365 6e74 6572 2061  m.sz  # center a
+0002fdb0: 6c6f 6e67 207a 0d0a 2020 2020 2020 2020  long z..        
+0002fdc0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0002fdd0: 2020 2063 7a3d 4e6f 6e65 0d0a 0d0a 2020     cz=None....  
+0002fde0: 2020 2020 2020 6966 2073 6c69 6365 7820        if slicex 
+0002fdf0: 6973 206e 6f74 204e 6f6e 6520 6f72 2073  is not None or s
+0002fe00: 6c69 6365 7920 6973 206e 6f74 204e 6f6e  licey is not Non
+0002fe10: 6520 6f72 2073 6c69 6365 7a20 6973 206e  e or slicez is n
+0002fe20: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+0002fe30: 2020 2020 2020 696d 6770 6c74 332e 6472        imgplt3.dr
+0002fe40: 6177 496d 6167 6533 445f 736c 6963 6528  awImage3D_slice(
+0002fe50: 696d 2c20 706c 6f74 7465 723d 702c 2073  im, plotter=p, s
+0002fe60: 6c69 6365 5f6e 6f72 6d61 6c5f 783d 6378  lice_normal_x=cx
+0002fe70: 2c20 736c 6963 655f 6e6f 726d 616c 5f79  , slice_normal_y
+0002fe80: 3d63 792c 2073 6c69 6365 5f6e 6f72 6d61  =cy, slice_norma
+0002fe90: 6c5f 7a3d 637a 2c20 636d 696e 3d63 6d69  l_z=cz, cmin=cmi
+0002fea0: 6e2c 2063 6d61 783d 636d 6178 2c0d 0a20  n, cmax=cmax,.. 
+0002feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fed0: 2020 2020 7363 616c 6172 5f62 6172 5f6b      scalar_bar_k
+0002fee0: 7761 7267 733d 7363 616c 6172 5f62 6172  wargs=scalar_bar
+0002fef0: 5f6b 7761 7267 732c 202a 2a6b 7761 7267  _kwargs, **kwarg
+0002ff00: 7329 0d0a 2020 2020 2020 2020 656c 7365  s)..        else
+0002ff10: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+0002ff20: 6d67 706c 7433 2e64 7261 7749 6d61 6765  mgplt3.drawImage
+0002ff30: 3344 5f73 7572 6661 6365 2869 6d2c 2070  3D_surface(im, p
+0002ff40: 6c6f 7474 6572 3d70 2c20 636d 696e 3d63  lotter=p, cmin=c
+0002ff50: 6d69 6e2c 2063 6d61 783d 636d 6178 2c0d  min, cmax=cmax,.
+0002ff60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ff70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff80: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+0002ff90: 5f6b 7761 7267 733d 7363 616c 6172 5f62  _kwargs=scalar_b
+0002ffa0: 6172 5f6b 7761 7267 732c 202a 2a6b 7761  ar_kwargs, **kwa
+0002ffb0: 7267 7329 0d0a 0d0a 2020 2020 2020 2020  rgs)....        
+0002ffc0: 6966 2070 6c6f 7474 6572 2069 7320 4e6f  if plotter is No
+0002ffd0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+0002ffe0: 2070 2e61 6464 5f62 6f75 6e64 696e 675f   p.add_bounding_
+0002fff0: 626f 7828 290d 0a20 2020 2020 2020 2020  box()..         
+00030000: 2020 2070 2e73 686f 775f 6178 6573 2829     p.show_axes()
+00030010: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
+00030020: 7368 6f77 2829 0d0a 0d0a 0d0a 2020 2020  show()......    
+00030030: 6465 6620 706c 6f74 5f6d 6561 6e5f 7072  def plot_mean_pr
+00030040: 6f70 2873 656c 662c 2070 726f 7065 7274  op(self, propert
+00030050: 792c 2074 7970 653d 2261 7269 7468 6d65  y, type="arithme
+00030060: 7469 6322 2c20 765f 6578 3d31 2c20 696e  tic", v_ex=1, in
+00030070: 7369 6465 5f75 6e69 7473 3d4e 6f6e 652c  side_units=None,
+00030080: 2069 6e73 6964 655f 6661 6369 6573 3d4e   inside_facies=N
+00030090: 6f6e 652c 2066 696c 7465 7269 6e67 5f69  one, filtering_i
+000300a0: 6e74 6572 7661 6c3d 4e6f 6e65 2c0d 0a20  nterval=None,.. 
+000300b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300c0: 2020 2070 6c6f 7474 6572 3d4e 6f6e 652c     plotter=None,
+000300d0: 2073 6c69 6365 783d 4e6f 6e65 2c20 736c   slicex=None, sl
+000300e0: 6963 6579 3d4e 6f6e 652c 2073 6c69 6365  icey=None, slice
+000300f0: 7a3d 4e6f 6e65 2c20 636d 696e 3d4e 6f6e  z=None, cmin=Non
+00030100: 652c 2063 6d61 783d 4e6f 6e65 2c20 7363  e, cmax=None, sc
+00030110: 616c 6172 5f62 6172 5f6b 7761 7267 733d  alar_bar_kwargs=
+00030120: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 293a  None, **kwargs):
+00030130: 0d0a 0d0a 2020 2020 2020 2020 2354 4f20  ....        #TO 
+00030140: 444f 202d 2d3e 2074 6f20 6f70 7469 6d69  DO --> to optimi
+00030150: 7a65 0d0a 2020 2020 2020 2020 2222 220d  ze..        """.
+00030160: 0a20 2020 2020 2020 2046 756e 6374 696f  .        Functio
+00030170: 6e20 7468 6174 2070 6c6f 7473 2074 6865  n that plots the
+00030180: 2061 7269 7468 6d65 7469 6320 6d65 616e   arithmetic mean
+00030190: 206f 6620 6120 7072 6f70 6572 7479 2061   of a property a
+000301a0: 7420 6576 6572 7920 6365 6c6c 730d 0a20  t every cells.. 
+000301b0: 2020 2020 2020 206f 6620 7468 6520 7369         of the si
+000301c0: 6d75 6c61 7469 6f6e 2064 6f6d 6169 6e20  mulation domain 
+000301d0: 6769 7665 6e20 616c 6c20 7468 6520 7072  given all the pr
+000301e0: 6f70 6572 7479 2073 696d 756c 6174 696f  operty simulatio
+000301f0: 6e73 0d0a 0d0a 2020 2020 2020 2020 5061  ns....        Pa
+00030200: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00030210: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00030220: 2020 2020 2020 7072 6f70 6572 7479 3a20        property: 
+00030230: 7374 7269 6e67 0d0a 2020 2020 2020 2020  string..        
+00030240: 2020 2020 6e61 6d65 206f 6620 7468 6520      name of the 
+00030250: 7072 6f70 6572 7479 2074 6f20 706c 6f74  property to plot
+00030260: 0d0a 2020 2020 2020 2020 7479 7065 3a20  ..        type: 
+00030270: 7374 7269 6e67 0d0a 2020 2020 2020 2020  string..        
+00030280: 2020 2020 7479 7065 206f 6620 6d65 616e      type of mean
+00030290: 2074 6f20 706c 6f74 3a0d 0a20 2020 2020   to plot:..     
+000302a0: 2020 2020 2020 202d 2022 6172 6974 686d         - "arithm
+000302b0: 6574 6963 2220 666f 7220 6172 6974 686d  etic" for arithm
+000302c0: 6574 6963 206d 6561 6e0d 0a20 2020 2020  etic mean..     
+000302d0: 2020 2020 2020 202d 2022 7374 6422 2066         - "std" f
+000302e0: 6f72 2073 7461 6e64 6172 6420 6465 7669  or standard devi
+000302f0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
+00030300: 2020 202d 2022 6d65 6469 616e 2220 666f     - "median" fo
+00030310: 7220 6d65 6469 616e 2076 616c 7565 0d0a  r median value..
+00030320: 2020 2020 2020 2020 765f 6578 3a20 666c          v_ex: fl
+00030330: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
+00030340: 2076 6572 7469 6361 6c20 6578 6167 6765   vertical exagge
+00030350: 7261 7469 6f6e 0d0a 2020 2020 2020 2020  ration..        
+00030360: 696e 7369 6465 5f75 6e69 7473 3a20 6c69  inside_units: li
+00030370: 7374 206f 6620 7374 7269 6e67 206f 7220  st of string or 
+00030380: 3a63 6c61 7373 3a60 556e 6974 6020 6f62  :class:`Unit` ob
+00030390: 6a65 6374 730d 0a20 2020 2020 2020 2020  jects..         
+000303a0: 2020 206c 6973 7420 6f66 2075 6e69 7473     list of units
+000303b0: 2074 6f20 636f 6e73 6964 6572 2066 6f72   to consider for
+000303c0: 2074 6865 206d 6561 6e0d 0a20 2020 2020   the mean..     
+000303d0: 2020 2020 2020 2022 7374 6422 2066 6f72         "std" for
+000303e0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+000303f0: 696f 6e2c 2022 6d65 6469 616e 2220 666f  ion, "median" fo
+00030400: 7220 6d65 6469 616e 2076 616c 7565 0d0a  r median value..
+00030410: 2020 2020 2020 2020 696e 7369 6465 5f66          inside_f
+00030420: 6163 6965 733a 206c 6973 7420 6f66 2073  acies: list of s
+00030430: 7472 696e 6720 6f72 203a 636c 6173 733a  tring or :class:
+00030440: 6046 6163 6965 7360 206f 626a 6563 7473  `Facies` objects
+00030450: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
+00030460: 7374 206f 6620 6661 6369 6573 2074 6f20  st of facies to 
+00030470: 636f 6e73 6964 6572 2066 6f72 2074 6865  consider for the
+00030480: 206d 6561 6e0d 0a20 2020 2020 2020 2066   mean..        f
+00030490: 696c 7465 7269 6e67 5f69 6e74 6572 7661  iltering_interva
+000304a0: 6c3a 206c 6973 7420 6f66 2074 776f 2066  l: list of two f
+000304b0: 6c6f 6174 730d 0a20 2020 2020 2020 2020  loats..         
+000304c0: 2020 2069 6e74 6572 7661 6c20 6f66 2076     interval of v
+000304d0: 616c 7565 7320 746f 206b 6565 700d 0a20  alues to keep.. 
+000304e0: 2020 2020 2020 2070 6c6f 7474 6572 3a20         plotter: 
+000304f0: 7079 7669 7374 612e 506c 6f74 7465 720d  pyvista.Plotter.
+00030500: 0a20 2020 2020 2020 2020 2020 2070 7976  .            pyv
+00030510: 6973 7461 2070 6c6f 7474 6572 2074 6f20  ista plotter to 
+00030520: 706c 6f74 206f 6e0d 0a20 2020 2020 2020  plot on..       
+00030530: 2073 6c69 6365 783a 2066 6c6f 6174 206f   slicex: float o
+00030540: 7220 7365 7175 656e 6365 206f 6620 666c  r sequence of fl
+00030550: 6f61 7473 0d0a 2020 2020 2020 2020 2020  oats..          
+00030560: 2020 6672 6163 7469 6f6e 206f 6620 7468    fraction of th
+00030570: 6520 7820 6178 6973 2074 6f20 706c 6f74  e x axis to plot
+00030580: 0d0a 2020 2020 2020 2020 736c 6963 6579  ..        slicey
+00030590: 3a20 666c 6f61 7420 6f72 2073 6571 7565  : float or seque
+000305a0: 6e63 6520 6f66 2066 6c6f 6174 730d 0a20  nce of floats.. 
+000305b0: 2020 2020 2020 2020 2020 2066 7261 6374             fract
+000305c0: 696f 6e20 6f66 2074 6865 2079 2061 7869  ion of the y axi
+000305d0: 7320 746f 2070 6c6f 740d 0a20 2020 2020  s to plot..     
+000305e0: 2020 2073 6c69 6365 7a3a 2066 6c6f 6174     slicez: float
+000305f0: 206f 7220 7365 7175 656e 6365 206f 6620   or sequence of 
+00030600: 666c 6f61 7473 0d0a 2020 2020 2020 2020  floats..        
+00030610: 2020 2020 6672 6163 7469 6f6e 206f 6620      fraction of 
+00030620: 7468 6520 7a20 6178 6973 2074 6f20 706c  the z axis to pl
+00030630: 6f74 0d0a 2020 2020 2020 2020 636d 696e  ot..        cmin
+00030640: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+00030650: 2020 2020 206d 696e 696d 756d 2076 616c       minimum val
+00030660: 7565 2066 6f72 2074 6865 2063 6f6c 6f72  ue for the color
+00030670: 6261 720d 0a20 2020 2020 2020 2063 6d61  bar..        cma
+00030680: 783a 2066 6c6f 6174 0d0a 2020 2020 2020  x: float..      
+00030690: 2020 2020 2020 6d61 7869 6d75 6d20 7661        maximum va
+000306a0: 6c75 6520 666f 7220 7468 6520 636f 6c6f  lue for the colo
+000306b0: 7262 6172 0d0a 2020 2020 2020 2020 7363  rbar..        sc
+000306c0: 616c 6172 5f62 6172 5f6b 7761 7267 733a  alar_bar_kwargs:
+000306d0: 2064 6963 740d 0a20 2020 2020 2020 2020   dict..         
+000306e0: 2020 2064 6963 7469 6f6e 6172 7920 6f66     dictionary of
+000306f0: 2061 7267 756d 656e 7473 2074 6f20 7061   arguments to pa
+00030700: 7373 2074 6f20 7468 6520 7079 7669 7374  ss to the pyvist
+00030710: 6120 7363 616c 6172 2062 6172 0d0a 0d0a  a scalar bar....
+00030720: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+00030730: 2020 2020 2020 2023 6c6f 6164 2070 726f         #load pro
+00030740: 7065 7274 7920 6172 7261 7920 616e 6420  perty array and 
+00030750: 6661 6369 6573 2061 7272 6179 0d0a 2020  facies array..  
+00030760: 2020 2020 2020 7072 6f70 3d73 656c 662e        prop=self.
+00030770: 6765 745f 7072 6f70 2870 726f 7065 7274  get_prop(propert
+00030780: 7929 2020 2320 746f 206d 6f64 6966 790d  y)  # to modify.
+00030790: 0a20 2020 2020 2020 2070 726f 705f 7368  .        prop_sh
+000307a0: 6170 653d 7072 6f70 2e73 6861 7065 0d0a  ape=prop.shape..
+000307b0: 2020 2020 2020 2020 6661 6369 6573 3d73          facies=s
+000307c0: 656c 662e 6765 745f 6661 6369 6573 2829  elf.get_facies()
+000307d0: 0d0a 2020 2020 2020 2020 6661 6369 6573  ..        facies
+000307e0: 5f73 6861 7065 3d66 6163 6965 732e 7368  _shape=facies.sh
+000307f0: 6170 650d 0a0d 0a20 2020 2020 2020 2023  ape....        #
+00030800: 6b65 6570 2076 616c 7565 7320 696e 206f  keep values in o
+00030810: 6e6c 7920 7761 6e74 6564 2075 6e69 7473  nly wanted units
+00030820: 0d0a 2020 2020 2020 2020 6966 2069 6e73  ..        if ins
+00030830: 6964 655f 756e 6974 7320 6973 206e 6f74  ide_units is not
+00030840: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00030850: 2020 2020 6e72 6561 6c5f 756e 6974 733d      nreal_units=
+00030860: 7365 6c66 2e6e 7265 616c 5f75 6e69 7473  self.nreal_units
+00030870: 2020 2320 6e75 6d62 6572 206f 6620 756e    # number of un
+00030880: 6974 7320 7265 616c 0d0a 2020 2020 2020  its real..      
+00030890: 2020 2020 2020 6d61 736b 5f61 6c6c 3d6e        mask_all=n
+000308a0: 702e 7a65 726f 7328 7072 6f70 5f73 6861  p.zeros(prop_sha
+000308b0: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
+000308c0: 2066 6f72 2069 7520 696e 2072 616e 6765   for iu in range
+000308d0: 286e 7265 616c 5f75 6e69 7473 293a 0d0a  (nreal_units):..
+000308e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000308f0: 666f 7220 7520 696e 2069 6e73 6964 655f  for u in inside_
+00030900: 756e 6974 733a 0d0a 2020 2020 2020 2020  units:..        
+00030910: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00030920: 7369 6e73 7461 6e63 6528 752c 2073 7472  sinstance(u, str
+00030930: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00030940: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
+00030950: 3d73 656c 662e 756e 6974 5f6d 6173 6b28  =self.unit_mask(
+00030960: 752c 2069 753d 6975 290d 0a20 2020 2020  u, iu=iu)..     
+00030970: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00030980: 6c69 6620 6973 696e 7374 616e 6365 2875  lif isinstance(u
+00030990: 2c20 556e 6974 2920 616e 6420 7520 696e  , Unit) and u in
+000309a0: 2073 656c 662e 6765 745f 616c 6c5f 756e   self.get_all_un
+000309b0: 6974 7328 293a 0d0a 2020 2020 2020 2020  its():..        
+000309c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309d0: 6d61 736b 3d73 656c 662e 756e 6974 5f6d  mask=self.unit_m
+000309e0: 6173 6b28 752e 6e61 6d65 2c20 6975 3d69  ask(u.name, iu=i
+000309f0: 7529 0d0a 2020 2020 2020 2020 2020 2020  u)..            
+00030a00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00030a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a20: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00030a30: 7565 4572 726f 7220 2822 556e 6974 2070  ueError ("Unit p
+00030a40: 6173 7365 6420 696e 2069 6e73 6964 655f  assed in inside_
+00030a50: 756e 6974 7320 6d75 7374 2062 6520 6120  units must be a 
+00030a60: 756e 6974 206e 616d 6520 6f72 2061 2075  unit name or a u
+00030a70: 6e69 7420 6f62 6a65 6374 2063 6f6e 7461  nit object conta
+00030a80: 696e 6564 2069 6e20 7468 6520 4172 6368  ined in the Arch
+00030a90: 5461 626c 6522 290d 0a20 2020 2020 2020  Table")..       
+00030aa0: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+00030ab0: 6b5f 616c 6c5b 6975 2c3a 2c3a 2c6d 6173  k_all[iu,:,:,mas
+00030ac0: 6b20 3d3d 2031 5d3d 310d 0a0d 0a20 2020  k == 1]=1....   
+00030ad0: 2020 2020 2020 2020 2070 726f 705b 6d61           prop[ma
+00030ae0: 736b 5f61 6c6c 2021 3d20 315d 3d6e 702e  sk_all != 1]=np.
+00030af0: 6e61 6e0d 0a0d 0a20 2020 2020 2020 2023  nan....        #
+00030b00: 6b65 6570 2076 616c 7565 7320 696e 206f  keep values in o
+00030b10: 6e6c 7920 7761 6e74 6564 2066 6163 6965  nly wanted facie
+00030b20: 730d 0a20 2020 2020 2020 2069 6620 696e  s..        if in
+00030b30: 7369 6465 5f66 6163 6965 7320 6973 206e  side_facies is n
+00030b40: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+00030b50: 2020 2020 2020 6d61 736b 5f61 6c6c 3d6e        mask_all=n
+00030b60: 702e 7a65 726f 7328 7072 6f70 5f73 6861  p.zeros(prop_sha
+00030b70: 7065 290d 0a20 2020 2020 2020 2020 2020  pe)..           
+00030b80: 2066 6f72 2069 7520 696e 2072 616e 6765   for iu in range
+00030b90: 286e 7265 616c 5f75 6e69 7473 293a 0d0a  (nreal_units):..
+00030ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030bb0: 666f 7220 6966 6120 696e 2072 616e 6765  for ifa in range
+00030bc0: 2873 656c 662e 6e72 6561 6c5f 6661 293a  (self.nreal_fa):
+00030bd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030be0: 2020 2020 2020 666f 7220 6661 2069 6e20        for fa in 
+00030bf0: 696e 7369 6465 5f66 6163 6965 733a 0d0a  inside_facies:..
+00030c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030c10: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00030c20: 7461 6e63 6528 6661 2c20 7374 7229 3a0d  tance(fa, str):.
+00030c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030c40: 2020 2020 2020 2020 2020 2020 206d 6173               mas
+00030c50: 6b3d 2866 6163 6965 735b 6975 2c69 6661  k=(facies[iu,ifa
+00030c60: 5d20 3d3d 2073 656c 662e 6765 745f 6661  ] == self.get_fa
+00030c70: 6369 6573 5f6f 626a 2866 6129 2e49 4429  cies_obj(fa).ID)
+00030c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00030c90: 2020 2020 2020 2020 2020 656c 6966 2069            elif i
+00030ca0: 7369 6e73 7461 6e63 6528 6661 2c20 4661  sinstance(fa, Fa
+00030cb0: 6369 6573 2920 616e 6420 6661 2069 6e20  cies) and fa in 
+00030cc0: 7365 6c66 2e67 6574 5f61 6c6c 5f66 6163  self.get_all_fac
+00030cd0: 6965 7328 293a 0d0a 2020 2020 2020 2020  ies():..        
+00030ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030cf0: 2020 2020 6d61 736b 3d28 6661 6369 6573      mask=(facies
+00030d00: 5b69 752c 6966 615d 203d 3d20 6661 2e49  [iu,ifa] == fa.I
+00030d10: 4429 0d0a 2020 2020 2020 2020 2020 2020  D)..            
+00030d20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00030d30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00030d40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00030d50: 6169 7365 2056 616c 7565 4572 726f 7220  aise ValueError 
+00030d60: 2822 556e 6974 2070 6173 7365 6420 696e  ("Unit passed in
+00030d70: 2069 6e73 6964 655f 756e 6974 7320 6d75   inside_units mu
+00030d80: 7374 2062 6520 6120 756e 6974 206e 616d  st be a unit nam
+00030d90: 6520 6f72 2061 2075 6e69 7420 6f62 6a65  e or a unit obje
+00030da0: 6374 2063 6f6e 7461 696e 6564 2069 6e20  ct contained in 
+00030db0: 7468 6520 4172 6368 5461 626c 6522 290d  the ArchTable").
+00030dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030dd0: 2020 2020 2020 2020 206d 6173 6b5f 616c           mask_al
+00030de0: 6c5b 6975 2c69 6661 2c3a 2c6d 6173 6b20  l[iu,ifa,:,mask 
+00030df0: 3d3d 2031 5d3d 310d 0a0d 0a20 2020 2020  == 1]=1....     
+00030e00: 2020 2020 2020 2070 726f 705b 6d61 736b         prop[mask
+00030e10: 5f61 6c6c 2021 3d20 315d 3d6e 702e 6e61  _all != 1]=np.na
+00030e20: 6e0d 0a0d 0a20 2020 2020 2020 2069 6620  n....        if 
+00030e30: 7e70 726f 702e 616e 7928 293a 0d0a 2020  ~prop.any():..  
+00030e40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00030e50: 5661 6c75 6545 7272 6f72 2028 2245 7272  ValueError ("Err
+00030e60: 6f72 3a20 4e6f 2076 616c 7565 7320 666f  or: No values fo
+00030e70: 756e 6422 290d 0a0d 0a20 2020 2020 2020  und")....       
+00030e80: 2069 6620 7479 7065 203d 3d20 2261 7269   if type == "ari
+00030e90: 7468 6d65 7469 6322 3a0d 0a20 2020 2020  thmetic":..     
+00030ea0: 2020 2020 2020 2061 7272 3d6e 702e 6e61         arr=np.na
+00030eb0: 6e6d 6561 6e28 7072 6f70 2e72 6573 6861  nmean(prop.resha
+00030ec0: 7065 282d 312c 7365 6c66 2e67 6574 5f6e  pe(-1,self.get_n
+00030ed0: 7a28 292c 7365 6c66 2e67 6574 5f6e 7928  z(),self.get_ny(
+00030ee0: 292c 7365 6c66 2e67 6574 5f6e 7828 2929  ),self.get_nx())
+00030ef0: 2c61 7869 733d 3029 0d0a 0d0a 2020 2020  ,axis=0)....    
+00030f00: 2020 2020 656c 6966 2074 7970 6520 3d3d      elif type ==
+00030f10: 2022 7374 6422 3a0d 0a20 2020 2020 2020   "std":..       
+00030f20: 2020 2020 2061 7272 3d6e 702e 6e61 6e73       arr=np.nans
+00030f30: 7464 2870 726f 702e 7265 7368 6170 6528  td(prop.reshape(
+00030f40: 2d31 2c73 656c 662e 6765 745f 6e7a 2829  -1,self.get_nz()
+00030f50: 2c73 656c 662e 6765 745f 6e79 2829 2c73  ,self.get_ny(),s
+00030f60: 656c 662e 6765 745f 6e78 2829 292c 6178  elf.get_nx()),ax
+00030f70: 6973 3d30 290d 0a0d 0a20 2020 2020 2020  is=0)....       
+00030f80: 2065 6c69 6620 7479 7065 203d 3d20 226d   elif type == "m
+00030f90: 6564 6961 6e22 3a0d 0a20 2020 2020 2020  edian":..       
+00030fa0: 2020 2020 2061 7272 3d6e 702e 6e61 6e6d       arr=np.nanm
+00030fb0: 6564 6961 6e28 7072 6f70 2e72 6573 6861  edian(prop.resha
+00030fc0: 7065 282d 312c 7365 6c66 2e67 6574 5f6e  pe(-1,self.get_n
+00030fd0: 7a28 292c 7365 6c66 2e67 6574 5f6e 7928  z(),self.get_ny(
+00030fe0: 292c 7365 6c66 2e67 6574 5f6e 7828 2929  ),self.get_nx())
+00030ff0: 2c61 7869 733d 3029 0d0a 0d0a 2020 2020  ,axis=0)....    
+00031000: 2020 2020 7365 6c66 2e70 6c6f 745f 6172      self.plot_ar
+00031010: 7228 6172 722c 7072 6f70 6572 7479 2c76  r(arr,property,v
+00031020: 5f65 783d 765f 6578 2c20 706c 6f74 7465  _ex=v_ex, plotte
+00031030: 723d 706c 6f74 7465 722c 2073 6c69 6365  r=plotter, slice
+00031040: 783d 736c 6963 6578 2c20 736c 6963 6579  x=slicex, slicey
+00031050: 3d73 6c69 6365 792c 2073 6c69 6365 7a3d  =slicey, slicez=
+00031060: 736c 6963 657a 2c0d 0a20 2020 2020 2020  slicez,..       
+00031070: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00031080: 6d69 6e3d 636d 696e 2c20 636d 6178 3d63  min=cmin, cmax=c
+00031090: 6d61 782c 2073 6361 6c61 725f 6261 725f  max, scalar_bar_
+000310a0: 6b77 6172 6773 3d73 6361 6c61 725f 6261  kwargs=scalar_ba
+000310b0: 725f 6b77 6172 6773 2c20 2a2a 6b77 6172  r_kwargs, **kwar
+000310c0: 6773 290d 0a0d 0a20 2020 2064 6566 2070  gs)....    def p
+000310d0: 6c6f 745f 6772 6964 2873 656c 662c 2076  lot_grid(self, v
+000310e0: 5f65 783d 3129 3a0d 0a0d 0a20 2020 2020  _ex=1):....     
+000310f0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00031100: 4675 6e63 7469 6f6e 2074 6861 7420 706c  Function that pl
+00031110: 6f74 7320 7468 6520 6772 6964 206f 6620  ots the grid of 
+00031120: 7468 6520 7369 6d75 6c61 7469 6f6e 2064  the simulation d
+00031130: 6f6d 6169 6e0d 0a0d 0a20 2020 2020 2020  omain....       
+00031140: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00031150: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00031160: 0a20 2020 2020 2020 2076 5f65 783a 2066  .        v_ex: f
+00031170: 6c6f 6174 0d0a 2020 2020 2020 2020 2020  loat..          
+00031180: 2020 7665 7274 6963 616c 2065 7861 6767    vertical exagg
+00031190: 6572 6174 696f 6e0d 0a0d 0a20 2020 2020  eration....     
+000311a0: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
+000311b0: 2020 6e78 3d73 656c 662e 6765 745f 6e78    nx=self.get_nx
+000311c0: 2829 0d0a 2020 2020 2020 2020 6e79 3d73  ()..        ny=s
+000311d0: 656c 662e 6765 745f 6e79 2829 0d0a 2020  elf.get_ny()..  
+000311e0: 2020 2020 2020 6e7a 3d73 656c 662e 6765        nz=self.ge
+000311f0: 745f 6e7a 2829 0d0a 2020 2020 2020 2020  t_nz()..        
+00031200: 7378 3d73 656c 662e 6765 745f 7378 2829  sx=self.get_sx()
+00031210: 0d0a 2020 2020 2020 2020 7379 3d73 656c  ..        sy=sel
+00031220: 662e 6765 745f 7379 2829 0d0a 2020 2020  f.get_sy()..    
+00031230: 2020 2020 737a 3d73 656c 662e 6765 745f      sz=self.get_
+00031240: 737a 2829 0d0a 2020 2020 2020 2020 7830  sz()..        x0
+00031250: 3d73 656c 662e 6765 745f 6f78 2829 0d0a  =self.get_ox()..
+00031260: 2020 2020 2020 2020 7930 3d73 656c 662e          y0=self.
+00031270: 6765 745f 6f79 2829 0d0a 2020 2020 2020  get_oy()..      
+00031280: 2020 7a30 3d73 656c 662e 6765 745f 6f7a    z0=self.get_oz
+00031290: 2829 0d0a 0d0a 2020 2020 2020 2020 236c  ()....        #l
+000312a0: 6f61 6420 6772 6964 0d0a 2020 2020 2020  oad grid..      
+000312b0: 2020 6172 7220 3d20 7365 6c66 2e6d 6173    arr = self.mas
+000312c0: 6b2e 6173 7479 7065 2866 6c6f 6174 292e  k.astype(float).
+000312d0: 636f 7079 2829 0d0a 2020 2020 2020 2020  copy()..        
+000312e0: 6172 725b 6172 723d 3d30 5d3d 6e70 2e6e  arr[arr==0]=np.n
+000312f0: 616e 0d0a 0d0a 2020 2020 2020 2020 2367  an....        #g
+00031300: 656f 6e65 2069 6d61 6765 0d0a 2020 2020  eone image..    
+00031310: 2020 2020 696d 3d67 656f 6e65 2e69 6d67      im=geone.img
+00031320: 2e49 6d67 286e 782c 206e 792c 206e 7a2c  .Img(nx, ny, nz,
+00031330: 2073 782c 2073 792c 2073 7a2a 765f 6578   sx, sy, sz*v_ex
+00031340: 2c20 7830 2c20 7930 2c20 7a30 2c20 6e76  , x0, y0, z0, nv
+00031350: 3d31 2c20 7661 6c3d 6172 722c 2076 6172  =1, val=arr, var
+00031360: 6e61 6d65 3d22 6772 6964 2229 0d0a 0d0a  name="grid")....
+00031370: 2020 2020 2020 2020 2370 6c6f 740d 0a20          #plot.. 
+00031380: 2020 2020 2020 2069 6d67 706c 7433 2e64         imgplt3.d
+00031390: 7261 7749 6d61 6765 3344 5f73 7572 6661  rawImage3D_surfa
+000313a0: 6365 2869 6d2c 2063 6174 6567 3d54 7275  ce(im, categ=Tru
+000313b0: 652c 2063 6174 6567 436f 6c3d 5b22 6c69  e, categCol=["li
+000313c0: 6768 7467 7265 7922 5d2c 2073 686f 775f  ghtgrey"], show_
+000313d0: 6564 6765 733d 5472 7565 290d 0a0d 0a0d  edges=True).....
+000313e0: 0a20 2020 2064 6566 2070 6c6f 745f 6172  .    def plot_ar
+000313f0: 7228 7365 6c66 2c61 7272 2c76 6172 5f6e  r(self,arr,var_n
+00031400: 616d 6520 3d22 5630 222c 765f 6578 3d31  ame ="V0",v_ex=1
+00031410: 2c20 706c 6f74 7465 723d 4e6f 6e65 2c20  , plotter=None, 
+00031420: 736c 6963 6578 3d4e 6f6e 652c 2073 6c69  slicex=None, sli
+00031430: 6365 793d 4e6f 6e65 2c20 736c 6963 657a  cey=None, slicez
+00031440: 3d4e 6f6e 652c 2066 696c 7465 7269 6e67  =None, filtering
+00031450: 5f69 6e74 6572 7661 6c3d 4e6f 6e65 2c0d  _interval=None,.
+00031460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031470: 2020 636d 696e 3d4e 6f6e 652c 2063 6d61    cmin=None, cma
+00031480: 783d 4e6f 6e65 2c20 7363 616c 6172 5f62  x=None, scalar_b
+00031490: 6172 5f6b 7761 7267 733d 4e6f 6e65 2c20  ar_kwargs=None, 
+000314a0: 2a2a 6b77 6172 6773 293a 0d0a 0d0a 2020  **kwargs):....  
+000314b0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+000314c0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
+000314d0: 2070 6c6f 7420 6120 3344 2061 7272 6179   plot a 3D array
+000314e0: 2077 6974 6820 7468 6520 7361 6d65 2073   with the same s
+000314f0: 697a 6520 6f66 2074 6865 2073 696d 756c  ize of the simul
+00031500: 6174 696f 6e20 646f 6d61 696e 0d0a 0d0a  ation domain....
+00031510: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00031520: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00031530: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00031540: 6172 723a 2033 4420 6172 7261 790d 0a20  arr: 3D array.. 
+00031550: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00031560: 2074 6f20 706c 6f74 2e20 5369 7a65 206f   to plot. Size o
+00031570: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
+00031580: 2064 6f6d 6169 6e20 286e 782c 206e 792c   domain (nx, ny,
+00031590: 206e 7a29 2020 200d 0a20 2020 2020 2020   nz)   ..       
+000315a0: 2076 6172 5f6e 616d 653a 2073 7472 0d0a   var_name: str..
+000315b0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000315c0: 6162 6c65 206e 616d 6573 2074 6f20 706c  able names to pl
+000315d0: 6f74 2061 6e64 2074 6f20 7368 6f77 2069  ot and to show i
+000315e0: 6e20 7468 6520 7079 7669 7374 6120 706c  n the pyvista pl
+000315f0: 6f74 0d0a 2020 2020 2020 2020 765f 6578  ot..        v_ex
+00031600: 3a20 666c 6f61 740d 0a20 2020 2020 2020  : float..       
+00031610: 2020 2020 2076 6572 7469 6361 6c20 6578       vertical ex
+00031620: 6167 6765 7261 7469 6f6e 0d0a 2020 2020  aggeration..    
+00031630: 2020 2020 706c 6f74 7465 723a 2070 7976      plotter: pyv
+00031640: 6973 7461 2e50 6c6f 7474 6572 0d0a 2020  ista.Plotter..  
+00031650: 2020 2020 2020 2020 2020 7079 7669 7374            pyvist
+00031660: 6120 706c 6f74 7465 7220 746f 2070 6c6f  a plotter to plo
+00031670: 7420 6f6e 0d0a 2020 2020 2020 2020 736c  t on..        sl
+00031680: 6963 6578 3a20 666c 6f61 7420 6f72 2073  icex: float or s
+00031690: 6571 7565 6e63 6520 6f66 2066 6c6f 6174  equence of float
+000316a0: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
+000316b0: 7261 6374 696f 6e20 6f66 2074 6865 2078  raction of the x
+000316c0: 2061 7869 7320 746f 2070 6c6f 740d 0a20   axis to plot.. 
+000316d0: 2020 2020 2020 2073 6c69 6365 793a 2066         slicey: f
+000316e0: 6c6f 6174 206f 7220 7365 7175 656e 6365  loat or sequence
+000316f0: 206f 6620 666c 6f61 7473 0d0a 2020 2020   of floats..    
+00031700: 2020 2020 2020 2020 6672 6163 7469 6f6e          fraction
+00031710: 206f 6620 7468 6520 7920 6178 6973 2074   of the y axis t
+00031720: 6f20 706c 6f74 0d0a 2020 2020 2020 2020  o plot..        
+00031730: 736c 6963 657a 3a20 666c 6f61 7420 6f72  slicez: float or
+00031740: 2073 6571 7565 6e63 6520 6f66 2066 6c6f   sequence of flo
+00031750: 6174 730d 0a20 2020 2020 2020 2020 2020  ats..           
+00031760: 2066 7261 6374 696f 6e20 6f66 2074 6865   fraction of the
+00031770: 207a 2061 7869 7320 746f 2070 6c6f 740d   z axis to plot.
+00031780: 0a20 2020 2020 2020 2066 696c 7465 7269  .        filteri
+00031790: 6e67 5f69 6e74 6572 7661 6c3a 206c 6973  ng_interval: lis
+000317a0: 7420 6f66 2074 776f 2066 6c6f 6174 730d  t of two floats.
+000317b0: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+000317c0: 6572 7661 6c20 6f66 2076 616c 7565 7320  erval of values 
+000317d0: 746f 206b 6565 700d 0a20 2020 2020 2020  to keep..       
+000317e0: 2063 6d69 6e3a 2066 6c6f 6174 0d0a 2020   cmin: float..  
+000317f0: 2020 2020 2020 2020 2020 6d69 6e69 6d75            minimu
+00031800: 6d20 7661 6c75 6520 666f 7220 7468 6520  m value for the 
+00031810: 636f 6c6f 7262 6172 0d0a 2020 2020 2020  colorbar..      
+00031820: 2020 636d 6178 3a20 666c 6f61 740d 0a20    cmax: float.. 
+00031830: 2020 2020 2020 2020 2020 206d 6178 696d             maxim
+00031840: 756d 2076 616c 7565 2066 6f72 2074 6865  um value for the
+00031850: 2063 6f6c 6f72 6261 720d 0a20 2020 2020   colorbar..     
+00031860: 2020 2073 6361 6c61 725f 6261 725f 6b77     scalar_bar_kw
+00031870: 6172 6773 3a20 6469 6374 0d0a 2020 2020  args: dict..    
+00031880: 2020 2020 2020 2020 6469 6374 696f 6e61          dictiona
+00031890: 7279 206f 6620 6172 6775 6d65 6e74 7320  ry of arguments 
+000318a0: 746f 2070 6173 7320 746f 2074 6865 2070  to pass to the p
+000318b0: 7976 6973 7461 2073 6361 6c61 7220 6261  yvista scalar ba
+000318c0: 720d 0a20 2020 2020 2020 2022 2222 0d0a  r..        """..
+000318d0: 0d0a 2020 2020 2020 2020 6e78 3d73 656c  ..        nx=sel
+000318e0: 662e 6765 745f 6e78 2829 0d0a 2020 2020  f.get_nx()..    
+000318f0: 2020 2020 6e79 3d73 656c 662e 6765 745f      ny=self.get_
+00031900: 6e79 2829 0d0a 2020 2020 2020 2020 6e7a  ny()..        nz
+00031910: 3d73 656c 662e 6765 745f 6e7a 2829 0d0a  =self.get_nz()..
+00031920: 2020 2020 2020 2020 7378 3d73 656c 662e          sx=self.
+00031930: 6765 745f 7378 2829 0d0a 2020 2020 2020  get_sx()..      
+00031940: 2020 7379 3d73 656c 662e 6765 745f 7379    sy=self.get_sy
+00031950: 2829 0d0a 2020 2020 2020 2020 737a 3d73  ()..        sz=s
+00031960: 656c 662e 6765 745f 737a 2829 0d0a 2020  elf.get_sz()..  
+00031970: 2020 2020 2020 7830 3d73 656c 662e 6765        x0=self.ge
+00031980: 745f 6f78 2829 0d0a 2020 2020 2020 2020  t_ox()..        
+00031990: 7930 3d73 656c 662e 6765 745f 6f79 2829  y0=self.get_oy()
+000319a0: 0d0a 2020 2020 2020 2020 7a30 3d73 656c  ..        z0=sel
+000319b0: 662e 6765 745f 6f7a 2829 0d0a 0d0a 2020  f.get_oz()....  
+000319c0: 2020 2020 2020 6173 7365 7274 2061 7272        assert arr
+000319d0: 2e73 6861 7065 203d 3d20 286e 7a2c 206e  .shape == (nz, n
+000319e0: 792c 206e 7829 2c20 2249 6e76 616c 6964  y, nx), "Invalid
+000319f0: 2073 6861 7065 2066 6f72 2061 7272 6179   shape for array
+00031a00: 2c20 6d75 7374 2062 6520 6571 7561 6c20  , must be equal 
+00031a10: 746f 207b 7d22 2e66 6f72 6d61 7428 6e7a  to {}".format(nz
+00031a20: 2c20 6e79 2c20 6e78 290d 0a0d 0a20 2020  , ny, nx)....   
+00031a30: 2020 2020 2061 7272 203d 2061 7272 2e61       arr = arr.a
+00031a40: 7374 7970 6528 666c 6f61 7429 2e63 6f70  stype(float).cop
+00031a50: 7928 290d 0a0d 0a20 2020 2020 2020 2069  y()....        i
+00031a60: 6620 706c 6f74 7465 7220 6973 204e 6f6e  f plotter is Non
+00031a70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00031a80: 703d 7076 2e50 6c6f 7474 6572 2829 0d0a  p=pv.Plotter()..
+00031a90: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00031aa0: 2020 2020 2020 2020 2020 2070 3d70 6c6f             p=plo
+00031ab0: 7474 6572 0d0a 2020 2020 2020 2020 696d  tter..        im
+00031ac0: 3d67 656f 6e65 2e69 6d67 2e49 6d67 286e  =geone.img.Img(n
+00031ad0: 782c 206e 792c 206e 7a2c 2073 782c 2073  x, ny, nz, sx, s
+00031ae0: 792c 2073 7a2a 765f 6578 2c20 7830 2c20  y, sz*v_ex, x0, 
+00031af0: 7930 2c20 7a30 2c20 6e76 3d31 2c20 7661  y0, z0, nv=1, va
+00031b00: 6c3d 6172 722c 2076 6172 6e61 6d65 3d76  l=arr, varname=v
+00031b10: 6172 5f6e 616d 6529 0d0a 0d0a 2020 2020  ar_name)....    
+00031b20: 2020 2020 6966 2073 6c69 6365 7820 6973      if slicex is
+00031b30: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00031b40: 2020 2020 2020 2020 736c 6963 6578 3d6e          slicex=n
+00031b50: 702e 6172 7261 7928 736c 6963 6578 290d  p.array(slicex).
+00031b60: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+00031b70: 6365 785b 736c 6963 6578 3c30 5d3d 300d  cex[slicex<0]=0.
+00031b80: 0a20 2020 2020 2020 2020 2020 2073 6c69  .            sli
+00031b90: 6365 785b 736c 6963 6578 3e31 5d3d 310d  cex[slicex>1]=1.
+00031ba0: 0a20 2020 2020 2020 2020 2020 2063 783d  .            cx=
+00031bb0: 696d 2e6f 7820 2b20 736c 6963 6578 202a  im.ox + slicex *
+00031bc0: 2069 6d2e 6e78 202a 2069 6d2e 7378 2020   im.nx * im.sx  
+00031bd0: 2320 6365 6e74 6572 2061 6c6f 6e67 2078  # center along x
+00031be0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00031bf0: 0a20 2020 2020 2020 2020 2020 2063 783d  .            cx=
+00031c00: 4e6f 6e65 0d0a 2020 2020 2020 2020 6966  None..        if
+00031c10: 2073 6c69 6365 7920 6973 206e 6f74 204e   slicey is not N
+00031c20: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00031c30: 2020 736c 6963 6579 3d6e 702e 6172 7261    slicey=np.arra
+00031c40: 7928 736c 6963 6579 290d 0a20 2020 2020  y(slicey)..     
+00031c50: 2020 2020 2020 2073 6c69 6365 795b 736c         slicey[sl
+00031c60: 6963 6579 3c30 5d3d 300d 0a20 2020 2020  icey<0]=0..     
+00031c70: 2020 2020 2020 2073 6c69 6365 795b 736c         slicey[sl
+00031c80: 6963 6579 3e31 5d3d 310d 0a20 2020 2020  icey>1]=1..     
+00031c90: 2020 2020 2020 2063 793d 696d 2e6f 7920         cy=im.oy 
+00031ca0: 2b20 736c 6963 6579 202a 2069 6d2e 6e79  + slicey * im.ny
+00031cb0: 202a 2069 6d2e 7379 2020 2320 6365 6e74   * im.sy  # cent
+00031cc0: 6572 2061 6c6f 6e67 2079 0d0a 2020 2020  er along y..    
+00031cd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00031ce0: 2020 2020 2020 2063 793d 4e6f 6e65 0d0a         cy=None..
+00031cf0: 2020 2020 2020 2020 6966 2073 6c69 6365          if slice
+00031d00: 7a20 6973 206e 6f74 204e 6f6e 653a 0d0a  z is not None:..
+00031d10: 2020 2020 2020 2020 2020 2020 736c 6963              slic
+00031d20: 657a 3d6e 702e 6172 7261 7928 736c 6963  ez=np.array(slic
+00031d30: 657a 290d 0a20 2020 2020 2020 2020 2020  ez)..           
+00031d40: 2073 6c69 6365 7a5b 736c 6963 657a 3c30   slicez[slicez<0
+00031d50: 5d3d 300d 0a20 2020 2020 2020 2020 2020  ]=0..           
+00031d60: 2073 6c69 6365 7a5b 736c 6963 657a 3e31   slicez[slicez>1
+00031d70: 5d3d 310d 0a20 2020 2020 2020 2020 2020  ]=1..           
+00031d80: 2063 7a3d 696d 2e6f 7a20 2b20 736c 6963   cz=im.oz + slic
+00031d90: 657a 202a 2069 6d2e 6e7a 202a 2069 6d2e  ez * im.nz * im.
+00031da0: 737a 2020 2320 6365 6e74 6572 2061 6c6f  sz  # center alo
+00031db0: 6e67 207a 0d0a 2020 2020 2020 2020 656c  ng z..        el
+00031dc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00031dd0: 2063 7a3d 4e6f 6e65 0d0a 0d0a 2020 2020   cz=None....    
+00031de0: 2020 2020 2320 6669 6c74 6572 2076 616c      # filter val
+00031df0: 7565 730d 0a20 2020 2020 2020 2069 6620  ues..        if 
+00031e00: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+00031e10: 616c 2069 7320 6e6f 7420 4e6f 6e65 3a0d  al is not None:.
+00031e20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00031e30: 6973 696e 7374 616e 6365 2866 696c 7465  isinstance(filte
+00031e40: 7269 6e67 5f69 6e74 6572 7661 6c2c 206c  ring_interval, l
+00031e50: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
+00031e60: 2020 2020 2020 2069 6620 6c65 6e28 6669         if len(fi
+00031e70: 6c74 6572 696e 675f 696e 7465 7276 616c  ltering_interval
+00031e80: 2920 3d3d 2032 3a0d 0a20 2020 2020 2020  ) == 2:..       
+00031e90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00031ea0: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+00031eb0: 616c 5b30 5d20 3c20 6669 6c74 6572 696e  al[0] < filterin
+00031ec0: 675f 696e 7465 7276 616c 5b31 5d3a 0d0a  g_interval[1]:..
+00031ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ee0: 2020 2020 2020 2020 6172 725b 6172 7220          arr[arr 
+00031ef0: 3c20 6669 6c74 6572 696e 675f 696e 7465  < filtering_inte
+00031f00: 7276 616c 5b30 5d5d 203d 206e 702e 6e61  rval[0]] = np.na
+00031f10: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+00031f20: 2020 2020 2020 2020 2020 2061 7272 5b61             arr[a
+00031f30: 7272 203e 2066 696c 7465 7269 6e67 5f69  rr > filtering_i
+00031f40: 6e74 6572 7661 6c5b 315d 5d20 3d20 6e70  nterval[1]] = np
+00031f50: 2e6e 616e 0d0a 2020 2020 2020 2020 2020  .nan..          
+00031f60: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00031f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031f80: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00031f90: 6669 6c74 6572 696e 675f 696e 7465 7276  filtering_interv
+00031fa0: 616c 5b30 5d20 6d75 7374 2062 6520 736d  al[0] must be sm
+00031fb0: 616c 6c65 7220 7468 616e 2066 696c 7465  aller than filte
+00031fc0: 7269 6e67 5f69 6e74 6572 7661 6c5b 315d  ring_interval[1]
+00031fd0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00031fe0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00031ff0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00032000: 7269 6e74 2822 6669 6c74 6572 696e 675f  rint("filtering_
+00032010: 696e 7465 7276 616c 206d 7573 7420 6265  interval must be
+00032020: 2061 206c 6973 7420 6f66 2074 776f 2076   a list of two v
+00032030: 616c 7565 7322 290d 0a20 2020 2020 2020  alues")..       
+00032040: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00032050: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00032060: 7428 2266 696c 7465 7269 6e67 5f69 6e74  t("filtering_int
+00032070: 6572 7661 6c20 6d75 7374 2062 6520 6120  erval must be a 
+00032080: 6c69 7374 206f 6620 7477 6f20 7661 6c75  list of two valu
+00032090: 6573 2229 0d0a 0d0a 2020 2020 2020 2020  es")....        
+000320a0: 6966 2073 6c69 6365 7820 6973 206e 6f74  if slicex is not
+000320b0: 204e 6f6e 6520 6f72 2073 6c69 6365 7920   None or slicey 
+000320c0: 6973 206e 6f74 204e 6f6e 6520 6f72 2073  is not None or s
+000320d0: 6c69 6365 7a20 6973 206e 6f74 204e 6f6e  licez is not Non
+000320e0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000320f0: 696d 6770 6c74 332e 6472 6177 496d 6167  imgplt3.drawImag
+00032100: 6533 445f 736c 6963 6528 696d 2c20 706c  e3D_slice(im, pl
+00032110: 6f74 7465 723d 702c 2073 6c69 6365 5f6e  otter=p, slice_n
+00032120: 6f72 6d61 6c5f 783d 6378 2c20 736c 6963  ormal_x=cx, slic
+00032130: 655f 6e6f 726d 616c 5f79 3d63 792c 2073  e_normal_y=cy, s
+00032140: 6c69 6365 5f6e 6f72 6d61 6c5f 7a3d 637a  lice_normal_z=cz
+00032150: 2c20 636d 696e 3d63 6d69 6e2c 2063 6d61  , cmin=cmin, cma
+00032160: 783d 636d 6178 0d0a 2020 2020 2020 2020  x=cmax..        
+00032170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032180: 2020 2020 2020 2020 2020 2020 2020 2c20                , 
+00032190: 7363 616c 6172 5f62 6172 5f6b 7761 7267  scalar_bar_kwarg
+000321a0: 733d 7363 616c 6172 5f62 6172 5f6b 7761  s=scalar_bar_kwa
+000321b0: 7267 732c 202a 2a6b 7761 7267 7329 0d0a  rgs, **kwargs)..
+000321c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000321d0: 2020 2020 2020 2020 2020 2069 6d67 706c             imgpl
+000321e0: 7433 2e64 7261 7749 6d61 6765 3344 5f73  t3.drawImage3D_s
+000321f0: 7572 6661 6365 2869 6d2c 2070 6c6f 7474  urface(im, plott
+00032200: 6572 3d70 2c20 636d 696e 3d63 6d69 6e2c  er=p, cmin=cmin,
+00032210: 2063 6d61 783d 636d 6178 2c0d 0a20 2020   cmax=cmax,..   
+00032220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032240: 2020 2020 2020 7363 616c 6172 5f62 6172        scalar_bar
+00032250: 5f6b 7761 7267 733d 7363 616c 6172 5f62  _kwargs=scalar_b
+00032260: 6172 5f6b 7761 7267 732c 202a 2a6b 7761  ar_kwargs, **kwa
+00032270: 7267 7329 0d0a 0d0a 2020 2020 2020 2020  rgs)....        
+00032280: 6966 2070 6c6f 7474 6572 2069 7320 4e6f  if plotter is No
+00032290: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+000322a0: 2070 2e61 6464 5f62 6f75 6e64 696e 675f   p.add_bounding_
+000322b0: 626f 7828 290d 0a20 2020 2020 2020 2020  box()..         
+000322c0: 2020 2070 2e73 686f 775f 6178 6573 2829     p.show_axes()
+000322d0: 0d0a 2020 2020 2020 2020 2020 2020 702e  ..            p.
+000322e0: 7368 6f77 2829 0d0a 0d0a 0d0a 2020 2020  show()......    
+000322f0: 2363 726f 7373 2073 6563 7469 6f6e 730d  #cross sections.
+00032300: 0a20 2020 2064 6566 2064 7261 775f 6372  .    def draw_cr
+00032310: 6f73 735f 7365 6374 696f 6e28 7365 6c66  oss_section(self
+00032320: 2c20 6261 636b 6772 6f75 6e64 3d22 756e  , background="un
+00032330: 6974 7322 2c20 6975 3d30 2c20 6966 613d  its", iu=0, ifa=
+00032340: 3029 3a0d 0a0d 0a20 2020 2020 2020 2065  0):....        e
+00032350: 7874 656e 7420 203d 205b 7365 6c66 2e67  xtent  = [self.g
+00032360: 6574 5f6f 7828 292c 2073 656c 662e 6765  et_ox(), self.ge
+00032370: 745f 7867 2829 5b2d 315d 2c20 7365 6c66  t_xg()[-1], self
+00032380: 2e67 6574 5f6f 7928 292c 2073 656c 662e  .get_oy(), self.
+00032390: 6765 745f 7967 2829 5b2d 315d 5d0d 0a0d  get_yg()[-1]]...
+000323a0: 0a20 2020 2020 2020 2069 6620 6261 636b  .        if back
+000323b0: 6772 6f75 6e64 203d 3d20 2275 6e69 7473  ground == "units
+000323c0: 223a 2020 2320 6164 6420 6f70 7469 6f6e  ":  # add option
+000323d0: 2074 6f20 7061 7373 2072 6173 7465 7273   to pass rasters
+000323e0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+000323f0: 636b 5f6d 6170 203d 2073 656c 662e 636f  ck_map = self.co
+00032400: 6d70 7574 655f 6765 6f6c 5f6d 6170 2830  mpute_geol_map(0
+00032410: 2c20 636f 6c6f 7220 3d20 5472 7565 290d  , color = True).
+00032420: 0a20 2020 2020 2020 2020 2020 2070 6c74  .            plt
+00032430: 2e69 6d73 686f 7728 6261 636b 5f6d 6170  .imshow(back_map
+00032440: 2c20 6f72 6967 696e 3d22 6c6f 7765 7222  , origin="lower"
+00032450: 2c20 6578 7465 6e74 3d65 7874 656e 7429  , extent=extent)
+00032460: 0d0a 0d0a 2020 2020 2020 2020 656c 7365  ....        else
+00032470: 3a20 200d 0a20 2020 2020 2020 2020 2020  :  ..           
+00032480: 2070 6173 730d 0a20 2020 2020 2020 200d   pass..        .
+00032490: 0a20 2020 2020 2020 2070 5f6c 6973 7420  .        p_list 
+000324a0: 3d20 706c 742e 6769 6e70 7574 286e 3d2d  = plt.ginput(n=-
+000324b0: 312c 2074 696d 656f 7574 3d30 290d 0a20  1, timeout=0).. 
+000324c0: 2020 2020 2020 2070 6c74 2e63 6c6f 7365         plt.close
+000324d0: 2829 0d0a 0d0a 2020 2020 2020 2020 2323  ()....        ##
+000324e0: 2064 7261 7720 6372 6f73 732d 7365 6374   draw cross-sect
+000324f0: 696f 6e20 706f 7369 7469 6f6e 0d0a 2020  ion position..  
+00032500: 2020 2020 2020 706c 742e 696d 7368 6f77        plt.imshow
+00032510: 2862 6163 6b5f 6d61 702c 206f 7269 6769  (back_map, origi
+00032520: 6e3d 226c 6f77 6572 222c 2065 7874 656e  n="lower", exten
+00032530: 743d 6578 7465 6e74 290d 0a20 2020 2020  t=extent)..     
+00032540: 2020 2070 6c74 2e70 6c6f 7428 5b69 5b30     plt.plot([i[0
+00032550: 5d20 666f 7220 6920 696e 2070 5f6c 6973  ] for i in p_lis
+00032560: 745d 2c20 5b69 5b31 5d20 666f 7220 6920  t], [i[1] for i 
+00032570: 696e 2070 5f6c 6973 745d 2c20 633d 2272  in p_list], c="r
+00032580: 6564 2229 0d0a 2020 2020 2020 2020 706c  ed")..        pl
+00032590: 742e 7368 6f77 2829 0d0a 0d0a 2020 2020  t.show()....    
+000325a0: 2020 2020 7265 7475 726e 2070 5f6c 6973      return p_lis
+000325b0: 740d 0a0d 0a0d 0a20 2020 2064 6566 2063  t......    def c
+000325c0: 726f 7373 5f73 6563 7469 6f6e 2873 656c  ross_section(sel
+000325d0: 662c 2061 7272 5f74 6f5f 706c 6f74 2c20  f, arr_to_plot, 
+000325e0: 705f 6c69 7374 2c20 6573 703d 4e6f 6e65  p_list, esp=None
+000325f0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+00032600: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
+00032610: 6e20 6120 6372 6f73 7320 7365 6374 696f  n a cross sectio
+00032620: 6e20 616c 6f6e 6720 7468 6520 706f 696e  n along the poin
+00032630: 7473 2070 6173 7320 696e 2070 5f6c 6973  ts pass in p_lis
+00032640: 740d 0a0d 0a20 2020 2020 2020 2050 6172  t....        Par
+00032650: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00032660: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00032670: 2020 2020 2061 7272 5f74 6f5f 706c 6f74       arr_to_plot
+00032680: 3a20 3344 206f 7220 3444 2061 7272 6179  : 3D or 4D array
+00032690: 206f 6620 6469 6d65 6e73 696f 6e20 6e7a   of dimension nz
+000326a0: 2c20 6e79 2c20 6e78 282c 2034 290d 0a20  , ny, nx(, 4).. 
+000326b0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+000326c0: 206f 6620 7768 6963 6820 7765 2077 616e   of which we wan
+000326d0: 7420 6120 6372 6f73 7320 7365 6374 696f  t a cross sectio
+000326e0: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
+000326f0: 5468 6973 2061 7272 6179 2077 696c 6c20  This array will 
+00032700: 6265 2063 6f6e 7369 6465 7265 6420 6265  be considered be
+00032710: 696e 6720 7061 7274 206f 6620 7468 6520  ing part of the 
+00032720: 4172 6368 5079 2073 696d 756c 6174 696f  ArchPy simulatio
+00032730: 6e20 646f 6d61 696e 2e0d 0a20 2020 2020  n domain...     
+00032740: 2020 2070 5f6c 6973 743a 2073 6571 7565     p_list: seque
+00032750: 6e63 6520 6f66 2074 7570 6c65 0d0a 2020  nce of tuple..  
+00032760: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
+00032770: 7220 6172 7261 7920 6f66 2074 7570 6c65  r array of tuple
+00032780: 2063 6f6e 7461 696e 696e 6720 7820 616e   containing x an
+00032790: 6420 7920 636f 6f72 6469 6e61 7465 730d  d y coordinates.
+000327a0: 0a20 2020 2020 2020 2020 2020 2028 652e  .            (e.
+000327b0: 672e 2070 5f6c 6973 743d 5b28 3130 302c  g. p_list=[(100,
+000327c0: 2032 3030 292c 2028 3330 302c 2032 3030   200), (300, 200
+000327d0: 295d 202d 2d3e 2064 7261 7720 6120 6372  )] --> draw a cr
+000327e0: 6f73 7320 7365 6374 696f 6e20 6265 7477  oss section betw
+000327f0: 6565 6e20 7468 6573 6520 7477 6f20 706f  een these two po
+00032800: 696e 7473 290d 0a20 2020 2020 2020 2065  ints)..        e
+00032810: 7370 3a20 666c 6f61 740d 0a20 2020 2020  sp: float..     
+00032820: 2020 2020 2020 2073 7061 6369 6e67 2074         spacing t
+00032830: 6f20 7573 6520 7768 656e 2073 616d 706c  o use when sampl
+00032840: 696e 6720 7468 6520 6172 7261 7920 616c  ing the array al
+00032850: 6f6e 6720 7468 6520 6372 6f73 7320 7365  ong the cross se
+00032860: 6374 696f 6e0d 0a20 2020 2020 2020 2020  ction..         
+00032870: 2020 200d 0a20 2020 2020 2020 2052 6574     ..        Ret
+00032880: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+00032890: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2032  -----..        2
+000328a0: 4420 6172 7261 790d 0a20 2020 2020 2020  D array..       
+000328b0: 2020 2020 2063 726f 7373 2073 6563 7469       cross secti
+000328c0: 6f6e 2072 6561 6479 2074 6f20 706c 6f74  on ready to plot
+000328d0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+000328e0: 0a20 2020 2020 2020 206f 783d 7365 6c66  .        ox=self
+000328f0: 2e67 6574 5f6f 7828 290d 0a20 2020 2020  .get_ox()..     
+00032900: 2020 206f 793d 7365 6c66 2e67 6574 5f6f     oy=self.get_o
+00032910: 7928 290d 0a20 2020 2020 2020 2073 783d  y()..        sx=
+00032920: 7365 6c66 2e67 6574 5f73 7828 290d 0a20  self.get_sx().. 
+00032930: 2020 2020 2020 2073 793d 7365 6c66 2e67         sy=self.g
+00032940: 6574 5f73 7928 290d 0a0d 0a20 2020 2020  et_sy()....     
+00032950: 2020 2069 6620 6573 7020 6973 204e 6f6e     if esp is Non
+00032960: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00032970: 6573 703d 2873 656c 662e 6765 745f 7378  esp=(self.get_sx
+00032980: 2829 2a2a 322b 7365 6c66 2e67 6574 5f73  ()**2+self.get_s
+00032990: 7928 292a 2a32 292a 2a30 2e35 0d0a 0d0a  y()**2)**0.5....
+000329a0: 2020 2020 2020 2020 6469 7374 5f74 6f74          dist_tot
+000329b0: 3d30 0d0a 2020 2020 2020 2020 666f 7220  =0..        for 
+000329c0: 6970 2069 6e20 7261 6e67 6528 6c65 6e28  ip in range(len(
+000329d0: 705f 6c69 7374 292d 3129 3a20 2320 6c6f  p_list)-1): # lo
+000329e0: 6f70 206f 7665 7220 706f 696e 7473 0d0a  op over points..
+000329f0: 2020 2020 2020 2020 2020 2020 7031 3d6e              p1=n
+00032a00: 702e 6172 7261 7928 705f 6c69 7374 5b69  p.array(p_list[i
+00032a10: 705d 290d 0a20 2020 2020 2020 2020 2020  p])..           
+00032a20: 2070 323d 6e70 2e61 7272 6179 2870 5f6c   p2=np.array(p_l
+00032a30: 6973 745b 6970 2b31 5d29 0d0a 2020 2020  ist[ip+1])..    
+00032a40: 2020 2020 2020 2020 6431 2c20 6432 3d70          d1, d2=p
+00032a50: 322d 7031 0d0a 2020 2020 2020 2020 2020  2-p1..          
+00032a60: 2020 6469 7374 3d6e 702e 7371 7274 2864    dist=np.sqrt(d
+00032a70: 312a 2a32 202b 2064 322a 2a32 290d 0a20  1**2 + d2**2).. 
+00032a80: 2020 2020 2020 2020 2020 206c 616d 3d65             lam=e
+00032a90: 7370 2f64 6973 740d 0a0d 0a20 2020 2020  sp/dist....     
+00032aa0: 2020 2020 2020 2078 5f64 2c20 795f 643d         x_d, y_d=
+00032ab0: 7031 2020 2320 7374 6172 7469 6e67 2070  p1  # starting p
+00032ac0: 6f69 6e74 0d0a 0d0a 2020 2020 2020 2020  oint....        
+00032ad0: 2020 2020 663d 6172 725f 746f 5f70 6c6f      f=arr_to_plo
+00032ae0: 742e 636f 7079 2829 0d0a 2020 2020 2020  t.copy()..      
+00032af0: 2020 2020 2020 6e6f 5f63 6f6c 6f72 3d46        no_color=F
+00032b00: 616c 7365 0d0a 2020 2020 2020 2020 2020  alse..          
+00032b10: 2020 6966 206c 656e 2866 2e73 6861 7065    if len(f.shape
+00032b20: 2920 3d3d 2034 3a0d 0a20 2020 2020 2020  ) == 4:..       
+00032b30: 2020 2020 2020 2020 206e 6f5f 636f 6c6f           no_colo
+00032b40: 723d 4661 6c73 650d 0a20 2020 2020 2020  r=False..       
+00032b50: 2020 2020 2020 2020 2078 5f73 6563 5f69           x_sec_i
+00032b60: 3d6e 702e 7a65 726f 7328 5b66 2e73 6861  =np.zeros([f.sha
+00032b70: 7065 5b30 5d2c 2069 6e74 2864 6973 742f  pe[0], int(dist/
+00032b80: 6573 7029 2b31 2c20 345d 290d 0a20 2020  esp)+1, 4])..   
+00032b90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00032ba0: 6970 203d 3d20 303a 0d0a 2020 2020 2020  ip == 0:..      
+00032bb0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+00032bc0: 7365 633d 6e70 2e7a 6572 6f73 285b 662e  sec=np.zeros([f.
+00032bd0: 7368 6170 655b 305d 2c20 696e 7428 6469  shape[0], int(di
+00032be0: 7374 2f65 7370 292b 312c 2034 5d29 0d0a  st/esp)+1, 4])..
+00032bf0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00032c00: 206c 656e 2866 2e73 6861 7065 2920 3d3d   len(f.shape) ==
+00032c10: 2033 3a0d 0a20 2020 2020 2020 2020 2020   3:..           
+00032c20: 2020 2020 206e 6f5f 636f 6c6f 723d 5472       no_color=Tr
+00032c30: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
+00032c40: 2020 2020 785f 7365 635f 693d 6e70 2e7a      x_sec_i=np.z
+00032c50: 6572 6f73 285b 662e 7368 6170 655b 305d  eros([f.shape[0]
+00032c60: 2c69 6e74 2864 6973 742f 6573 7029 2b31  ,int(dist/esp)+1
+00032c70: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00032c80: 2020 2020 6966 2069 7020 3d3d 2030 3a0d      if ip == 0:.
+00032c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032ca0: 2020 2020 2078 5f73 6563 3d6e 702e 7a65       x_sec=np.ze
+00032cb0: 726f 7328 5b66 2e73 6861 7065 5b30 5d2c  ros([f.shape[0],
+00032cc0: 696e 7428 6469 7374 2f65 7370 292b 315d  int(dist/esp)+1]
+00032cd0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00032ce0: 2069 6620 6e6f 5f63 6f6c 6f72 3a0d 0a20   if no_color:.. 
+00032cf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032d00: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
+00032d10: 2020 2020 666f 7220 6f20 696e 206e 702e      for o in np.
+00032d20: 6172 616e 6765 2830 2c64 6973 742c 6573  arange(0,dist,es
+00032d30: 7029 3a0d 0a20 2020 2020 2020 2020 2020  p):..           
+00032d40: 2020 2020 2020 2020 2078 5f64 202b 3d20           x_d += 
+00032d50: 6431 2a6c 616d 0d0a 2020 2020 2020 2020  d1*lam..        
+00032d60: 2020 2020 2020 2020 2020 2020 795f 6420              y_d 
+00032d70: 2b3d 2064 322a 6c61 6d0d 0a20 2020 2020  += d2*lam..     
+00032d80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032d90: 783d 696e 7428 2878 5f64 202d 206f 7829  x=int((x_d - ox)
+00032da0: 2f73 7829 0d0a 2020 2020 2020 2020 2020  /sx)..          
+00032db0: 2020 2020 2020 2020 2020 6979 3d69 6e74            iy=int
+00032dc0: 2828 795f 6420 2d20 6f79 292f 7379 290d  ((y_d - oy)/sy).
 00032dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032de0: 2020 2020 2078 5f64 202b 3d20 6431 2a6c       x_d += d1*l
-00032df0: 616d 0d0a 2020 2020 2020 2020 2020 2020  am..            
-00032e00: 2020 2020 2020 2020 795f 6420 2b3d 2064          y_d += d
-00032e10: 322a 6c61 6d0d 0a20 2020 2020 2020 2020  2*lam..         
-00032e20: 2020 2020 2020 2020 2020 2069 783d 696e             ix=in
-00032e30: 7428 2878 5f64 202d 206f 7829 2f73 7829  t((x_d - ox)/sx)
-00032e40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032e50: 2020 2020 2020 6979 3d69 6e74 2828 795f        iy=int((y_
-00032e60: 6420 2d20 6f79 292f 7379 290d 0a20 2020  d - oy)/sy)..   
-00032e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032e80: 2066 703d 665b 3a2c 6979 2c69 785d 0d0a   fp=f[:,iy,ix]..
-00032e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032ea0: 2020 2020 6966 2069 7020 3d3d 2030 3a0d      if ip == 0:.
-00032eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032ec0: 2020 2020 2020 2020 2078 5f73 6563 5b3a           x_sec[:
-00032ed0: 2c69 2c3a 205d 3d66 700d 0a20 2020 2020  ,i,: ]=fp..     
-00032ee0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00032ef0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00032f00: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-00032f10: 7365 635f 695b 3a2c 692c 3a20 5d3d 6670  sec_i[:,i,: ]=fp
-00032f20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00032f30: 2020 2020 2020 6920 2b3d 2031 0d0a 0d0a        i += 1....
-00032f40: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00032f50: 5f74 6f74 202b 3d20 6469 7374 0d0a 2020  _tot += dist..  
-00032f60: 2020 2020 2020 2020 2020 2361 7070 656e            #appen
-00032f70: 6420 7873 6563 7469 6f6e 730d 0a20 2020  d xsections..   
-00032f80: 2020 2020 2020 2020 2069 6620 6970 203e           if ip >
-00032f90: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-00032fa0: 2020 2020 2078 5f73 6563 3d6e 702e 636f       x_sec=np.co
-00032fb0: 6e63 6174 656e 6174 6528 2878 5f73 6563  ncatenate((x_sec
-00032fc0: 2c20 785f 7365 635f 6929 2c20 6178 6973  , x_sec_i), axis
-00032fd0: 3d31 290d 0a0d 0a20 2020 2020 2020 2072  =1)....        r
-00032fe0: 6574 7572 6e20 785f 7365 632c 2064 6973  eturn x_sec, dis
-00032ff0: 745f 746f 740d 0a0d 0a0d 0a0d 0a20 2020  t_tot........   
-00033000: 2023 2323 2042 5547 2054 4f20 434f 5252   ### BUG TO CORR
-00033010: 4543 540d 0a20 2020 2022 2222 0d0a 2020  ECT..    """..  
-00033020: 2020 426f 7265 686f 6c65 7320 6170 7065    Boreholes appe
-00033030: 6172 206d 756c 7469 706c 6520 7469 6d65  ar multiple time
-00033040: 7320 6f6e 2074 6865 2063 726f 7373 2d73  s on the cross-s
-00033050: 6563 7469 6f6e 2c20 6861 7665 2074 6f20  ection, have to 
-00033060: 7468 696e 6b20 6162 6f75 7420 7468 6174  think about that
-00033070: 0d0a 2020 2020 2222 220d 0a20 2020 2064  ..    """..    d
-00033080: 6566 2070 6c6f 745f 6372 6f73 735f 7365  ef plot_cross_se
-00033090: 6374 696f 6e28 7365 6c66 2c20 705f 6c69  ction(self, p_li
-000330a0: 7374 2c20 7479 703d 2275 6e69 7473 222c  st, typ="units",
-000330b0: 2061 7272 3d4e 6f6e 652c 2069 753d 302c   arr=None, iu=0,
-000330c0: 2069 6661 3d30 2c20 6970 3d30 2c0d 0a20   ifa=0, ip=0,.. 
-000330d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000330e0: 2020 2020 2020 2020 2020 7072 6f70 6572            proper
-000330f0: 7479 3d4e 6f6e 652c 2065 7370 3d4e 6f6e  ty=None, esp=Non
-00033100: 652c 2061 783d 4e6f 6e65 2c20 636f 6c6f  e, ax=None, colo
-00033110: 7262 6172 3d46 616c 7365 2c0d 0a20 2020  rbar=False,..   
-00033120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033130: 2020 2020 2020 2020 7261 7469 6f5f 6173          ratio_as
-00033140: 7065 6374 3d32 2c20 693d 302c 0d0a 2020  pect=2, i=0,..  
-00033150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033160: 2020 2020 2020 2020 2064 6973 745f 6d61           dist_ma
-00033170: 7820 3d20 3130 302c 2077 6964 7468 3d2e  x = 100, width=.
-00033180: 352c 0d0a 2020 2020 2020 2020 2020 2020  5,..            
-00033190: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000331a0: 6d61 783d 4e6f 6e65 2c20 766d 696e 3d4e  max=None, vmin=N
-000331b0: 6f6e 6529 3a0d 0a0d 0a20 2020 2020 2020  one):....       
-000331c0: 2022 2222 0d0a 2020 2020 2020 2020 506c   """..        Pl
-000331d0: 6f74 2061 2063 726f 7373 2073 6563 7469  ot a cross secti
-000331e0: 6f6e 2061 6c6f 6e67 2074 6865 2070 6f69  on along the poi
-000331f0: 6e74 7320 6769 7665 6e20 696e 0d0a 2020  nts given in..  
-00033200: 2020 2020 2020 705f 6c69 7374 2077 6974        p_list wit
-00033210: 6820 6120 7370 6163 696e 6720 6465 6669  h a spacing defi
-00033220: 6e65 6420 2865 7370 290d 0a0d 0a20 2020  ned (esp)....   
-00033230: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00033240: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00033250: 2d2d 2d0d 0a20 2020 2020 2020 2070 5f6c  ---..        p_l
-00033260: 6973 7420 3a20 6c69 7374 206f 7220 6172  ist : list or ar
-00033270: 7261 7920 6f66 2074 7570 6c65 2063 6f6e  ray of tuple con
-00033280: 7461 696e 696e 670d 0a20 2020 2020 2020  taining..       
-00033290: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
-000332a0: 2063 6f6f 7264 696e 6174 6573 0d0a 2020   coordinates..  
-000332b0: 2020 2020 2020 2020 2020 2020 2020 2865                (e
-000332c0: 2e67 2e20 705f 6c69 7374 3d5b 2831 3030  .g. p_list=[(100
-000332d0: 2c20 3230 3029 2c20 2833 3030 2c20 3230  , 200), (300, 20
-000332e0: 3029 5d0d 0a20 2020 2020 2020 2020 2020  0)]..           
-000332f0: 2020 2020 202d 2d3e 2064 7261 7720 6120       --> draw a 
-00033300: 6372 6f73 7320 7365 6374 696f 6e20 6265  cross section be
-00033310: 7477 6565 6e20 7468 6573 6520 7477 6f20  tween these two 
-00033320: 706f 696e 7473 290d 0a20 2020 2020 2020  points)..       
-00033330: 2074 7970 3a20 7374 7269 6e67 0d0a 2020   typ: string..  
-00033340: 2020 2020 2020 2020 2020 756e 6974 732c            units,
-00033350: 2066 6163 6965 7320 6f72 2061 2070 726f   facies or a pro
-00033360: 7065 7274 7920 6e61 6d65 0d0a 2020 2020  perty name..    
-00033370: 2020 2020 6975 3a20 696e 740d 0a20 2020      iu: int..   
-00033380: 2020 2020 2020 2020 2075 6e69 7473 2069           units i
-00033390: 6e64 6578 2072 6561 6c69 7a61 7469 6f6e  ndex realization
-000333a0: 0d0a 2020 2020 2020 2020 6966 613a 2069  ..        ifa: i
-000333b0: 6e74 0d0a 2020 2020 2020 2020 2020 2020  nt..            
-000333c0: 6661 6369 6573 2069 6e64 6578 2072 6561  facies index rea
-000333d0: 6c69 7a61 7469 6f6e 0d0a 2020 2020 2020  lization..      
-000333e0: 2020 6970 3a20 696e 740d 0a20 2020 2020    ip: int..     
-000333f0: 2020 2020 2020 2070 726f 7065 7274 7920         property 
-00033400: 696e 6465 7820 7265 616c 697a 6174 696f  index realizatio
-00033410: 6e0d 0a20 2020 2020 2020 2070 726f 7065  n..        prope
-00033420: 7274 793a 2073 7472 0d0a 2020 2020 2020  rty: str..      
-00033430: 2020 2020 2020 7072 6f70 6572 7479 206e        property n
-00033440: 616d 6520 7468 6174 2068 6176 6520 6265  ame that have be
-00033450: 656e 2063 6f6d 7075 7465 640d 0a20 2020  en computed..   
-00033460: 2020 2020 2065 7370 3a20 666c 6f61 740d       esp: float.
-00033470: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
-00033480: 6369 6e67 2074 6f20 7573 6520 7768 656e  cing to use when
-00033490: 2073 616d 706c 696e 6720 7468 6520 6172   sampling the ar
-000334a0: 7261 7920 616c 6f6e 6720 7468 6520 6372  ray along the cr
-000334b0: 6f73 7320 7365 6374 696f 6e0d 0a20 2020  oss section..   
-000334c0: 2020 2020 2061 783a 206d 6174 706c 6f74       ax: matplot
-000334d0: 6c69 6220 6178 6573 206f 6e20 7768 6963  lib axes on whic
-000334e0: 6820 746f 2070 6c6f 740d 0a20 2020 2020  h to plot..     
-000334f0: 2020 2072 6174 696f 5f61 7370 6563 743a     ratio_aspect:
-00033500: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
-00033510: 2020 2020 7261 7469 6f20 6265 7477 6565      ratio betwee
-00033520: 6e20 7920 616e 6420 7820 6178 6973 2074  n y and x axis t
-00033530: 6f20 6164 6a75 7374 2076 6572 7469 6361  o adjust vertica
-00033540: 6c20 6578 6167 6765 7261 7469 6f6e 0d0a  l exaggeration..
-00033550: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
-00033560: 2020 2020 2020 2069 6620 6178 2069 7320         if ax is 
-00033570: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00033580: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
-00033590: 2e73 7562 706c 6f74 7328 6669 6773 697a  .subplots(figsiz
-000335a0: 653d 2831 302c 2031 3029 290d 0a0d 0a20  e=(10, 10)).... 
-000335b0: 2020 2020 2020 2064 6566 2070 6c6f 745f         def plot_
-000335c0: 6268 2862 682c 2078 3d4e 6f6e 652c 2077  bh(bh, x=None, w
-000335d0: 6964 7468 3d77 6964 7468 2c20 7479 703d  idth=width, typ=
-000335e0: 2275 6e69 7473 2229 3a0d 0a0d 0a20 2020  "units"):....   
-000335f0: 2020 2020 2020 2020 2069 6620 7479 7020           if typ 
-00033600: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
-00033610: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00033620: 6268 2e6c 6f67 5f73 7472 6174 6920 6973  bh.log_strati is
-00033630: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-00033640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033650: 6966 2078 2069 7320 4e6f 6e65 3a0d 0a20  if x is None:.. 
-00033660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033670: 2020 2020 2020 2069 7820 3d20 6268 2e78         ix = bh.x
-00033680: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00033690: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000336a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000336b0: 2020 2020 2069 7820 3d20 780d 0a0d 0a20       ix = x.... 
-000336c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000336d0: 2020 2069 203d 202d 310d 0a20 2020 2020     i = -1..     
-000336e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000336f0: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00033700: 6e28 6268 2e6c 6f67 5f73 7472 6174 6929  n(bh.log_strati)
-00033710: 2d31 293a 0d0a 2020 2020 2020 2020 2020  -1):..          
-00033720: 2020 2020 2020 2020 2020 2020 2020 7320                s 
-00033730: 3d20 6268 2e6c 6f67 5f73 7472 6174 695b  = bh.log_strati[
-00033740: 695d 5b31 5d0d 0a20 2020 2020 2020 2020  i][1]..         
-00033750: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00033760: 6e69 7420 3d20 6268 2e6c 6f67 5f73 7472  nit = bh.log_str
-00033770: 6174 695b 695d 5b30 5d0d 0a0d 0a20 2020  ati[i][0]....   
-00033780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033790: 2020 2020 2069 6620 6920 3c20 6c65 6e28       if i < len(
-000337a0: 6268 2e6c 6f67 5f73 7472 6174 6929 3a0d  bh.log_strati):.
-000337b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000337c0: 2020 2020 2020 2020 2020 2020 2073 3220               s2 
-000337d0: 3d20 6268 2e6c 6f67 5f73 7472 6174 695b  = bh.log_strati[
-000337e0: 692b 315d 5b31 5d0d 0a0d 0a20 2020 2020  i+1][1]....     
-000337f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033800: 2020 2069 6620 756e 6974 2069 7320 6e6f     if unit is no
-00033810: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00033820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033830: 2020 2020 2061 782e 6261 7228 6978 2c20       ax.bar(ix, 
-00033840: 7320 2d20 7332 2c20 626f 7474 6f6d 3d73  s - s2, bottom=s
-00033850: 322c 2063 6f6c 6f72 3d75 6e69 742e 632c  2, color=unit.c,
-00033860: 2061 6c70 6861 3d31 2c20 6564 6765 636f   alpha=1, edgeco
-00033870: 6c6f 7220 3d20 2762 6c61 636b 272c 2077  lor = 'black', w
-00033880: 6964 7468 3d77 6964 7468 290d 0a0d 0a20  idth=width).... 
-00033890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338a0: 2020 2073 203d 2062 682e 6c6f 675f 7374     s = bh.log_st
-000338b0: 7261 7469 5b69 2b31 5d5b 315d 0d0a 2020  rati[i+1][1]..  
-000338c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000338d0: 2020 756e 6974 203d 2062 682e 6c6f 675f    unit = bh.log_
-000338e0: 7374 7261 7469 5b69 2b31 5d5b 305d 0d0a  strati[i+1][0]..
-000338f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033900: 2020 2020 7332 203d 2062 682e 7a20 2d20      s2 = bh.z - 
-00033910: 6268 2e64 6570 7468 0d0a 2020 2020 2020  bh.depth..      
-00033920: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00033930: 2075 6e69 7420 6973 206e 6f74 204e 6f6e   unit is not Non
-00033940: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00033950: 2020 2020 2020 2020 2020 2020 6178 2e62              ax.b
-00033960: 6172 2869 782c 2073 202d 2073 322c 2062  ar(ix, s - s2, b
-00033970: 6f74 746f 6d3d 7332 2c20 636f 6c6f 723d  ottom=s2, color=
-00033980: 756e 6974 2e63 2c20 616c 7068 613d 312c  unit.c, alpha=1,
-00033990: 2065 6467 6563 6f6c 6f72 203d 2027 626c   edgecolor = 'bl
-000339a0: 6163 6b27 2c20 7769 6474 683d 7769 6474  ack', width=widt
-000339b0: 6829 0d0a 0d0a 2020 2020 2020 2020 6966  h)....        if
-000339c0: 2074 7970 203d 3d20 2275 6e69 7473 223a   typ == "units":
-000339d0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-000339e0: 723d 7365 6c66 2e67 6574 5f75 6e69 7473  r=self.get_units
-000339f0: 5f64 6f6d 6169 6e73 5f72 6561 6c69 7a61  _domains_realiza
-00033a00: 7469 6f6e 7328 6975 3d69 752c 2066 696c  tions(iu=iu, fil
-00033a10: 6c3d 2263 6f6c 6f72 222c 2061 6c6c 5f64  l="color", all_d
-00033a20: 6174 613d 4661 6c73 6529 0d0a 0d0a 2020  ata=False)....  
-00033a30: 2020 2020 2020 656c 6966 2074 7970 203d        elif typ =
-00033a40: 3d20 2770 726f 6261 5f75 6e69 7473 273a  = 'proba_units':
-00033a50: 0d0a 2020 2020 2020 2020 2020 2020 756e  ..            un
-00033a60: 6974 733d 7365 6c66 2e67 6574 5f75 6e69  its=self.get_uni
-00033a70: 7473 5f64 6f6d 6169 6e73 5f72 6561 6c69  ts_domains_reali
-00033a80: 7a61 7469 6f6e 7328 290d 0a20 2020 2020  zations()..     
-00033a90: 2020 2020 2020 206e 7265 616c 3d75 6e69         nreal=uni
-00033aa0: 7473 2e73 6861 7065 5b30 5d0d 0a20 2020  ts.shape[0]..   
-00033ab0: 2020 2020 2020 2020 2061 7272 3d28 756e           arr=(un
-00033ac0: 6974 7320 3d3d 2069 292e 7375 6d28 3029  its == i).sum(0)
-00033ad0: 2f6e 7265 616c 0d0a 2020 2020 2020 2020  /nreal..        
-00033ae0: 2020 2020 6465 6c28 756e 6974 7329 0d0a      del(units)..
-00033af0: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
-00033b00: 7970 203d 3d20 2770 726f 6261 5f66 6163  yp == 'proba_fac
-00033b10: 6965 7327 3a0d 0a20 2020 2020 2020 2020  ies':..         
-00033b20: 2020 2066 6163 6965 733d 7365 6c66 2e67     facies=self.g
-00033b30: 6574 5f66 6163 6965 7328 290d 0a20 2020  et_facies()..   
-00033b40: 2020 2020 2020 2020 206e 7265 616c 3d66           nreal=f
-00033b50: 6163 6965 732e 7368 6170 655b 305d 202a  acies.shape[0] *
-00033b60: 2066 6163 6965 732e 7368 6170 655b 315d   facies.shape[1]
-00033b70: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-00033b80: 723d 2866 6163 6965 7320 3d3d 2069 292e  r=(facies == i).
-00033b90: 7375 6d28 3029 2e73 756d 2830 2920 2f6e  sum(0).sum(0) /n
-00033ba0: 7265 616c 0d0a 2020 2020 2020 2020 2020  real..          
-00033bb0: 2020 6465 6c28 6661 6369 6573 290d 0a20    del(facies).. 
-00033bc0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-00033bd0: 2020 2020 2065 6c69 6620 7479 7020 3d3d       elif typ ==
-00033be0: 2266 6163 6965 7322 3a0d 0a20 2020 2020  "facies":..     
-00033bf0: 2020 2020 2020 2061 7272 3d73 656c 662e         arr=self.
-00033c00: 6765 745f 6661 6369 6573 2869 752c 2069  get_facies(iu, i
-00033c10: 6661 2c20 616c 6c5f 6461 7461 3d46 616c  fa, all_data=Fal
-00033c20: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-00033c30: 2023 6368 616e 6765 2076 616c 7565 7320   #change values 
-00033c40: 746f 2068 6176 6520 636f 6c6f 7273 2064  to have colors d
-00033c50: 6972 6563 746c 790d 0a20 2020 2020 2020  irectly..       
-00033c60: 2020 2020 206e 6577 5f61 7272 3d6e 702e       new_arr=np.
-00033c70: 7a65 726f 7328 5b61 7272 2e73 6861 7065  zeros([arr.shape
-00033c80: 5b30 5d2c 2061 7272 2e73 6861 7065 5b31  [0], arr.shape[1
-00033c90: 5d2c 2061 7272 2e73 6861 7065 5b32 5d2c  ], arr.shape[2],
-00033ca0: 2034 5d29 0d0a 2020 2020 2020 2020 2020   4])..          
-00033cb0: 2020 6c69 7374 5f66 613d 6e70 2e75 6e69    list_fa=np.uni
-00033cc0: 7175 6528 6172 7229 0d0a 2020 2020 2020  que(arr)..      
-00033cd0: 2020 2020 2020 666f 7220 4944 6661 2069        for IDfa i
-00033ce0: 6e20 6c69 7374 5f66 613a 0d0a 2020 2020  n list_fa:..    
-00033cf0: 2020 2020 2020 2020 2020 2020 6966 2049              if I
-00033d00: 4466 6120 213d 2030 3a0d 0a20 2020 2020  Dfa != 0:..     
-00033d10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00033d20: 613d 7365 6c66 2e67 6574 5f66 6163 6965  a=self.get_facie
-00033d30: 735f 6f62 6a28 4944 3d49 4466 612c 2074  s_obj(ID=IDfa, t
-00033d40: 7970 653d 2249 4422 2920 2023 2067 6574  ype="ID")  # get
-00033d50: 2066 6163 6965 7320 6f62 6a65 6374 0d0a   facies object..
-00033d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033d70: 2020 2020 6d61 736b 3d28 6172 7220 3d3d      mask=(arr ==
-00033d80: 2049 4466 6129 0d0a 2020 2020 2020 2020   IDfa)..        
-00033d90: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00033da0: 6172 725b 6d61 736b 2c3a 205d 3d63 6f6c  arr[mask,: ]=col
-00033db0: 6f72 732e 746f 5f72 6762 6128 6661 2e63  ors.to_rgba(fa.c
-00033dc0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
-00033dd0: 7272 3d6e 6577 5f61 7272 0d0a 0d0a 2020  rr=new_arr....  
-00033de0: 2020 2020 2020 656c 6966 2074 7970 203d        elif typ =
-00033df0: 3d22 7072 6f70 223a 0d0a 2020 2020 2020  ="prop":..      
-00033e00: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-00033e10: 6e73 7461 6e63 6528 7072 6f70 6572 7479  nstance(property
-00033e20: 2c20 7374 7229 2c20 2270 726f 7065 7274  , str), "propert
-00033e30: 7920 7368 6f75 6c64 2062 6520 6769 7665  y should be give
-00033e40: 6e20 696e 2061 2070 726f 7065 7274 7920  n in a property 
-00033e50: 6e61 6d65 202d 2d3e 2073 7472 696e 6722  name --> string"
-00033e60: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-00033e70: 723d 7365 6c66 2e67 6574 5f70 726f 7028  r=self.get_prop(
-00033e80: 7072 6f70 6572 7479 2c20 6975 2c20 6966  property, iu, if
-00033e90: 612c 2069 702c 2061 6c6c 5f64 6174 613d  a, ip, all_data=
-00033ea0: 4661 6c73 6529 0d0a 0d0a 2020 2020 2020  False)....      
-00033eb0: 2020 656c 6966 2074 7970 203d 3d22 656e    elif typ =="en
-00033ec0: 7472 6f70 795f 756e 6974 7322 3a0d 0a20  tropy_units":.. 
-00033ed0: 2020 2020 2020 2020 2020 2075 6e69 7473             units
-00033ee0: 3d73 656c 662e 6765 745f 756e 6974 735f  =self.get_units_
-00033ef0: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
-00033f00: 696f 6e73 2829 0d0a 2020 2020 2020 2020  ions()..        
-00033f10: 2020 2020 5345 3d6e 702e 7a65 726f 7328      SE=np.zeros(
-00033f20: 7365 6c66 2e6d 6173 6b2e 7368 6170 6529  self.mask.shape)
-00033f30: 2020 2320 7368 616e 6e6f 6e20 656e 7472    # shannon entr
-00033f40: 6f70 790d 0a20 2020 2020 2020 2020 2020  opy..           
-00033f50: 2062 3d6c 656e 2873 656c 662e 6765 745f   b=len(self.get_
-00033f60: 616c 6c5f 756e 6974 7328 2929 0d0a 2020  all_units())..  
-00033f70: 2020 2020 2020 2020 2020 6e72 6561 6c3d            nreal=
-00033f80: 756e 6974 732e 7368 6170 655b 305d 0d0a  units.shape[0]..
-00033f90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00033fa0: 756e 6974 2069 6e20 7365 6c66 2e67 6574  unit in self.get
-00033fb0: 5f61 6c6c 5f75 6e69 7473 2829 3a0d 0a20  _all_units():.. 
-00033fc0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00033fd0: 2070 7269 6e74 2875 6e69 7429 0d0a 2020   print(unit)..  
-00033fe0: 2020 2020 2020 2020 2020 2020 2020 5069                Pi
-00033ff0: 3d28 756e 6974 733d 3d75 6e69 742e 4944  =(units==unit.ID
-00034000: 292e 7375 6d28 3029 2f6e 7265 616c 0d0a  ).sum(0)/nreal..
-00034010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034020: 7069 5f6d 6173 6b3d 2873 656c 662e 6d61  pi_mask=(self.ma
-00034030: 736b 2920 2620 2850 6921 3d30 290d 0a20  sk) & (Pi!=0).. 
-00034040: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-00034050: 455b 7069 5f6d 6173 6b5d 202b 3d20 5069  E[pi_mask] += Pi
-00034060: 5b70 695f 6d61 736b 5d2a 286e 702e 6c6f  [pi_mask]*(np.lo
-00034070: 6728 5069 5b70 695f 6d61 736b 5d29 2f6e  g(Pi[pi_mask])/n
-00034080: 702e 6c6f 6728 6229 290d 0a20 2020 2020  p.log(b))..     
-00034090: 2020 2020 2020 2020 2020 2061 7272 3d2d             arr=-
-000340a0: 5345 0d0a 2020 2020 2020 2020 2020 2020  SE..            
-000340b0: 6172 725b 7e73 656c 662e 6d61 736b 5d3d  arr[~self.mask]=
-000340c0: 6e70 2e6e 616e 0d0a 2020 2020 2020 2020  np.nan..        
-000340d0: 2020 2020 6465 6c28 756e 6974 7329 0d0a      del(units)..
-000340e0: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
-000340f0: 7970 203d 3d20 2265 6e74 726f 7079 5f66  yp == "entropy_f
-00034100: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-00034110: 2020 2020 2066 6163 6965 735f 646f 6d61       facies_doma
-00034120: 696e 733d 7365 6c66 2e67 6574 5f66 6163  ins=self.get_fac
-00034130: 6965 7328 292e 7265 7368 6170 6528 2d31  ies().reshape(-1
-00034140: 2c20 7365 6c66 2e6e 7a2c 2073 656c 662e  , self.nz, self.
-00034150: 6e79 2c20 7365 6c66 2e6e 7829 0d0a 2020  ny, self.nx)..  
-00034160: 2020 2020 2020 2020 2020 5345 3d6e 702e            SE=np.
-00034170: 7a65 726f 7328 7365 6c66 2e6d 6173 6b2e  zeros(self.mask.
-00034180: 7368 6170 6529 2020 2320 7368 616e 6e6f  shape)  # shanno
-00034190: 6e20 656e 7472 6f70 790d 0a20 2020 2020  n entropy..     
-000341a0: 2020 2020 2020 2062 3d6c 656e 2873 656c         b=len(sel
-000341b0: 662e 6765 745f 616c 6c5f 6661 6369 6573  f.get_all_facies
-000341c0: 2829 290d 0a20 2020 2020 2020 2020 2020  ())..           
-000341d0: 206e 7265 616c 3d66 6163 6965 735f 646f   nreal=facies_do
-000341e0: 6d61 696e 732e 7368 6170 655b 305d 0d0a  mains.shape[0]..
-000341f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00034200: 6661 6369 6573 2069 6e20 7365 6c66 2e67  facies in self.g
-00034210: 6574 5f61 6c6c 5f66 6163 6965 7328 293a  et_all_facies():
-00034220: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00034230: 2020 5069 3d28 6661 6369 6573 5f64 6f6d    Pi=(facies_dom
-00034240: 6169 6e73 3d3d 6661 6369 6573 2e49 4429  ains==facies.ID)
-00034250: 2e73 756d 2830 292f 6e72 6561 6c0d 0a20  .sum(0)/nreal.. 
-00034260: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00034270: 695f 6d61 736b 3d28 7365 6c66 2e6d 6173  i_mask=(self.mas
-00034280: 6b29 2026 2028 5069 213d 3029 0d0a 2020  k) & (Pi!=0)..  
-00034290: 2020 2020 2020 2020 2020 2020 2020 5345                SE
-000342a0: 5b70 695f 6d61 736b 5d20 2b3d 2050 695b  [pi_mask] += Pi[
-000342b0: 7069 5f6d 6173 6b5d 2a28 6e70 2e6c 6f67  pi_mask]*(np.log
-000342c0: 2850 695b 7069 5f6d 6173 6b5d 292f 6e70  (Pi[pi_mask])/np
-000342d0: 2e6c 6f67 2862 2929 0d0a 2020 2020 2020  .log(b))..      
-000342e0: 2020 2020 2020 2020 2020 6172 723d 2d53            arr=-S
-000342f0: 450d 0a20 2020 2020 2020 2020 2020 2061  E..            a
-00034300: 7272 5b7e 7365 6c66 2e6d 6173 6b5d 3d6e  rr[~self.mask]=n
-00034310: 702e 6e61 6e0d 0a20 2020 2020 2020 2020  p.nan..         
-00034320: 2020 2064 656c 2866 6163 6965 735f 646f     del(facies_do
-00034330: 6d61 696e 7329 0d0a 0d0a 2020 2020 2020  mains)....      
-00034340: 2020 656c 6966 2074 7970 203d 3d22 6172    elif typ =="ar
-00034350: 7222 3a0d 0a20 2020 2020 2020 2020 2020  r":..           
-00034360: 2070 6173 730d 0a20 2020 2020 2020 2065   pass..        e
-00034370: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00034380: 2020 6173 7365 7274 2027 5479 7020 756e    assert 'Typ un
-00034390: 6b6e 6f77 6e27 0d0a 2020 2020 2020 2020  known'..        
-000343a0: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
-000343b0: 2020 2020 2020 2365 7874 7261 6374 2063        #extract c
-000343c0: 726f 7373 2073 6563 7469 6f6e 0d0a 2020  ross section..  
-000343d0: 2020 2020 2020 7873 6563 2c20 6469 7374        xsec, dist
-000343e0: 3d73 656c 662e 6372 6f73 735f 7365 6374  =self.cross_sect
-000343f0: 696f 6e28 6172 722c 2070 5f6c 6973 742c  ion(arr, p_list,
-00034400: 2065 7370 3d65 7370 290d 0a0d 0a20 2020   esp=esp)....   
-00034410: 2020 2020 2065 7874 656e 743d 5b30 2c20       extent=[0, 
-00034420: 6469 7374 2c20 7365 6c66 2e67 6574 5f6f  dist, self.get_o
-00034430: 7a28 292c 2073 656c 662e 6765 745f 7a67  z(), self.get_zg
-00034440: 2829 5b2d 315d 5d0d 0a20 2020 2020 2020  ()[-1]]..       
-00034450: 2061 3d61 782e 696d 7368 6f77 2878 7365   a=ax.imshow(xse
-00034460: 632c 206f 7269 6769 6e3d 226c 6f77 6572  c, origin="lower
-00034470: 222c 2065 7874 656e 743d 6578 7465 6e74  ", extent=extent
-00034480: 2c20 696e 7465 7270 6f6c 6174 696f 6e3d  , interpolation=
-00034490: 226e 6f6e 6522 2c20 766d 6178 3d76 6d61  "none", vmax=vma
-000344a0: 782c 2076 6d69 6e3d 766d 696e 290d 0a20  x, vmin=vmin).. 
-000344b0: 2020 2020 2020 2069 6620 636f 6c6f 7262         if colorb
-000344c0: 6172 3a0d 0a20 2020 2020 2020 2020 2020  ar:..           
-000344d0: 2070 6c74 2e63 6f6c 6f72 6261 7228 612c   plt.colorbar(a,
-000344e0: 2061 783d 6178 2c20 6f72 6965 6e74 6174   ax=ax, orientat
-000344f0: 696f 6e3d 2768 6f72 697a 6f6e 7461 6c27  ion='horizontal'
-00034500: 290d 0a20 2020 2020 2020 2061 782e 7365  )..        ax.se
-00034510: 745f 6173 7065 6374 2861 6273 2828 6578  t_aspect(abs((ex
-00034520: 7465 6e74 5b31 5d2d 6578 7465 6e74 5b30  tent[1]-extent[0
-00034530: 5d29 2f28 6578 7465 6e74 5b33 5d2d 6578  ])/(extent[3]-ex
-00034540: 7465 6e74 5b32 5d29 292f 7261 7469 6f5f  tent[2]))/ratio_
-00034550: 6173 7065 6374 290d 0a0d 0a20 2020 2020  aspect)....     
-00034560: 2020 2064 656c 2861 7272 290d 0a0d 0a20     del(arr).... 
-00034570: 2020 2020 2020 2023 6765 7420 626f 7265         #get bore
-00034580: 686f 6c65 730d 0a20 2020 2020 2020 2064  holes..        d
-00034590: 6973 745f 746f 7420 3d20 300d 0a20 2020  ist_tot = 0..   
-000345a0: 2020 2020 2066 6f72 2069 7020 696e 2072       for ip in r
-000345b0: 616e 6765 286c 656e 2870 5f6c 6973 7429  ange(len(p_list)
-000345c0: 2d31 293a 0d0a 0d0a 2020 2020 2020 2020  -1):....        
-000345d0: 2020 2020 7031 203d 2070 5f6c 6973 745b      p1 = p_list[
-000345e0: 6970 5d0d 0a20 2020 2020 2020 2020 2020  ip]..           
-000345f0: 2070 3220 3d20 705f 6c69 7374 5b69 702b   p2 = p_list[ip+
-00034600: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00034610: 786d 696e 203d 206d 696e 2870 315b 305d  xmin = min(p1[0]
-00034620: 2c20 7032 5b30 5d29 0d0a 2020 2020 2020  , p2[0])..      
-00034630: 2020 2020 2020 786d 6178 203d 206d 6178        xmax = max
-00034640: 2870 315b 305d 2c20 7032 5b30 5d29 0d0a  (p1[0], p2[0])..
-00034650: 2020 2020 2020 2020 2020 2020 4c78 203d              Lx =
-00034660: 2078 6d61 7820 2d20 786d 696e 0d0a 2020   xmax - xmin..  
-00034670: 2020 2020 2020 2020 2020 786d 696e 202d            xmin -
-00034680: 3d20 6d61 7828 302e 322a 4c78 2c20 6469  = max(0.2*Lx, di
-00034690: 7374 5f6d 6178 2f32 290d 0a20 2020 2020  st_max/2)..     
-000346a0: 2020 2020 2020 2078 6d61 7820 2b3d 206d         xmax += m
-000346b0: 6178 2830 2e32 2a4c 782c 2064 6973 745f  ax(0.2*Lx, dist_
-000346c0: 6d61 782f 3229 0d0a 0d0a 2020 2020 2020  max/2)....      
-000346d0: 2020 2020 2020 796d 696e 203d 206d 696e        ymin = min
-000346e0: 2870 315b 315d 2c20 7032 5b31 5d29 0d0a  (p1[1], p2[1])..
-000346f0: 2020 2020 2020 2020 2020 2020 796d 6178              ymax
-00034700: 203d 206d 6178 2870 315b 315d 2c20 7032   = max(p1[1], p2
-00034710: 5b31 5d29 0d0a 2020 2020 2020 2020 2020  [1])..          
-00034720: 2020 4c79 203d 2079 6d61 7820 2d20 796d    Ly = ymax - ym
-00034730: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
-00034740: 796d 696e 202d 3d20 6d61 7828 302e 322a  ymin -= max(0.2*
-00034750: 4c79 2c20 6469 7374 5f6d 6178 2f32 290d  Ly, dist_max/2).
-00034760: 0a20 2020 2020 2020 2020 2020 2079 6d61  .            yma
-00034770: 7820 2b3d 206d 6178 2830 2e32 2a4c 792c  x += max(0.2*Ly,
-00034780: 2064 6973 745f 6d61 782f 3229 0d0a 0d0a   dist_max/2)....
-00034790: 2020 2020 2020 2020 2020 2020 2320 7365              # se
-000347a0: 6c65 6374 2062 6820 696e 7369 6465 2070  lect bh inside p
-000347b0: 3120 616e 6420 7032 0d0a 2020 2020 2020  1 and p2..      
-000347c0: 2020 2020 2020 7365 6c5f 6268 7320 3d20        sel_bhs = 
-000347d0: 5b62 6820 666f 7220 6268 2069 6e20 7365  [bh for bh in se
-000347e0: 6c66 2e6c 6973 745f 6268 7320 6966 2062  lf.list_bhs if b
-000347f0: 682e 7820 3e20 786d 696e 2061 6e64 2062  h.x > xmin and b
-00034800: 682e 7820 3c20 786d 6178 2061 6e64 2062  h.x < xmax and b
-00034810: 682e 7920 3e20 796d 696e 2061 6e64 2062  h.y > ymin and b
-00034820: 682e 7920 3c20 796d 6178 5d0d 0a0d 0a20  h.y < ymax].... 
-00034830: 2020 2020 2020 2020 2020 2023 2063 6f6d             # com
-00034840: 7075 7465 2064 6973 7420 6f66 2073 656c  pute dist of sel
-00034850: 5f62 6873 2074 6f20 6c69 6e65 0d0a 0d0a  _bhs to line....
-00034860: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
-00034870: 6f6a 2062 6873 0d0a 2020 2020 2020 2020  oj bhs..        
-00034880: 2020 2020 666f 7220 6268 2069 6e20 7365      for bh in se
-00034890: 6c5f 6268 733a 0d0a 2020 2020 2020 2020  l_bhs:..        
-000348a0: 2020 2020 2020 2020 6120 3d20 7032 5b30          a = p2[0
-000348b0: 5d20 2d20 7031 5b30 5d0d 0a20 2020 2020  ] - p1[0]..     
-000348c0: 2020 2020 2020 2020 2020 2062 203d 2070             b = p
-000348d0: 325b 315d 202d 2070 315b 315d 0d0a 2020  2[1] - p1[1]..  
-000348e0: 2020 2020 2020 2020 2020 2020 2020 785f                x_
-000348f0: 7072 6f6a 203d 2028 612a 2a32 202a 2062  proj = (a**2 * b
-00034900: 682e 7820 2b20 622a 2a32 202a 2070 325b  h.x + b**2 * p2[
-00034910: 305d 202b 2061 202a 2062 202a 2028 6268  0] + a * b * (bh
-00034920: 2e79 202d 2070 325b 315d 2929 202f 2028  .y - p2[1])) / (
-00034930: 612a 2a32 202b 2062 2a2a 3229 0d0a 2020  a**2 + b**2)..  
-00034940: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-00034950: 7072 6f6a 203d 2028 6220 2a20 785f 7072  proj = (b * x_pr
-00034960: 6f6a 202d 2062 202a 2070 325b 305d 202b  oj - b * p2[0] +
-00034970: 2061 202a 2070 325b 315d 2920 2f20 610d   a * p2[1]) / a.
-00034980: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00034990: 2020 2064 6973 745f 6c69 6e65 203d 2028     dist_line = (
-000349a0: 2862 682e 7820 2d20 785f 7072 6f6a 2920  (bh.x - x_proj) 
-000349b0: 2a2a 2032 202b 2028 6268 2e79 202d 2079  ** 2 + (bh.y - y
-000349c0: 5f70 726f 6a29 202a 2a20 3229 2a2a 302e  _proj) ** 2)**0.
-000349d0: 350d 0a0d 0a20 2020 2020 2020 2020 2020  5....           
-000349e0: 2020 2020 2069 6620 6469 7374 5f6c 696e       if dist_lin
-000349f0: 6520 3c20 6469 7374 5f6d 6178 3a0d 0a20  e < dist_max:.. 
-00034a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a10: 2020 2064 6973 7420 3d20 2828 785f 7072     dist = ((x_pr
-00034a20: 6f6a 202d 2070 315b 305d 2920 2a2a 2032  oj - p1[0]) ** 2
-00034a30: 202b 2028 795f 7072 6f6a 202d 2070 315b   + (y_proj - p1[
-00034a40: 315d 2920 2a2a 2032 292a 2a30 2e35 0d0a  1]) ** 2)**0.5..
-00034a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034a60: 2020 2020 6469 7374 5f74 6f5f 706c 6f74      dist_to_plot
-00034a70: 203d 2064 6973 745f 746f 7420 2b20 6469   = dist_tot + di
-00034a80: 7374 2020 2320 6469 7374 616e 6365 2077  st  # distance w
-00034a90: 6865 7265 2074 6f20 706c 6f74 2074 6865  here to plot the
-00034aa0: 2062 680d 0a0d 0a20 2020 2020 2020 2020   bh....         
-00034ab0: 2020 2020 2020 2020 2020 2023 2070 6c6f             # plo
-00034ac0: 7420 6268 0d0a 2020 2020 2020 2020 2020  t bh..          
-00034ad0: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
-00034ae0: 203d 3d20 2275 6e69 7473 223a 0d0a 2020   == "units":..  
-00034af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034b00: 2020 2020 2020 706c 6f74 5f62 6828 6268        plot_bh(bh
-00034b10: 2c20 6469 7374 5f74 6f5f 706c 6f74 290d  , dist_to_plot).
-00034b20: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00034b30: 2069 6e63 7265 6d65 6e74 2074 6f74 616c   increment total
-00034b40: 2064 6973 7461 6e63 650d 0a20 2020 2020   distance..     
-00034b50: 2020 2020 2020 2064 6973 745f 706f 696e         dist_poin
-00034b60: 7473 203d 2028 2870 325b 305d 202d 2070  ts = ((p2[0] - p
-00034b70: 315b 305d 2920 2a2a 2032 202b 2028 7032  1[0]) ** 2 + (p2
-00034b80: 5b31 5d20 2d20 7031 5b31 5d29 202a 2a20  [1] - p1[1]) ** 
-00034b90: 3229 2a2a 302e 350d 0a20 2020 2020 2020  2)**0.5..       
-00034ba0: 2020 2020 2064 6973 745f 746f 7420 2b3d       dist_tot +=
-00034bb0: 2064 6973 745f 706f 696e 7473 0d0a 0d0a   dist_points....
-00034bc0: 0d0a 2020 2020 6465 6620 706c 6f74 5f6c  ..    def plot_l
-00034bd0: 696e 6573 2873 656c 662c 206c 6973 745f  ines(self, list_
-00034be0: 6c69 6e65 732c 206e 616d 6573 3d4e 6f6e  lines, names=Non
-00034bf0: 652c 2061 783d 4e6f 6e65 2c20 6c65 6765  e, ax=None, lege
-00034c00: 6e64 3d54 7275 6529 3a0d 0a0d 0a20 2020  nd=True):....   
-00034c10: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00034c20: 2020 506c 6f74 2063 726f 7373 2d73 6563    Plot cross-sec
-00034c30: 7469 6f6e 7320 6c69 6e65 7320 6769 7665  tions lines give
-00034c40: 6e20 696e 2020 7468 650d 0a20 2020 2020  n in  the..     
-00034c50: 2020 2022 6c69 7374 5f6c 696e 6573 2220     "list_lines" 
-00034c60: 6172 6775 6d65 6e74 206f 6e20 6120 3244  argument on a 2D
-00034c70: 2074 6f70 2076 6965 7720 6f66 2074 6865   top view of the
-00034c80: 2064 6f6d 6169 6e0d 0a0d 0a20 2020 2020   domain....     
-00034c90: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-00034ca0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00034cb0: 2d0d 0a20 2020 2020 2020 206c 6973 745f  -..        list_
-00034cc0: 6c69 6e65 733a 2073 6571 656e 6365 206f  lines: seqence o
-00034cd0: 6620 706f 696e 7473 0d0a 2020 2020 2020  f points..      
-00034ce0: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
-00034cf0: 6620 706f 696e 7473 2064 6566 696e 696e  f points definin
-00034d00: 6720 7468 6520 6372 6f73 732d 7365 6374  g the cross-sect
-00034d10: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-00034d20: 2020 2020 206c 696e 6573 2e20 4561 6368       lines. Each
-00034d30: 2070 6f69 6e74 2069 7320 6120 6c69 7374   point is a list
-00034d40: 206f 6620 3220 666c 6f61 7473 205b 782c   of 2 floats [x,
-00034d50: 2079 5d0d 0a20 2020 2020 2020 206e 616d   y]..        nam
-00034d60: 6573 3a20 7365 7175 656e 6365 206f 6620  es: sequence of 
-00034d70: 7374 7269 6e67 0d0a 2020 2020 2020 2020  string..        
-00034d80: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
-00034d90: 6e61 6d65 7320 746f 2067 6976 6520 746f  names to give to
-00034da0: 2074 6865 2063 726f 7373 2d73 6563 7469   the cross-secti
-00034db0: 6f6e 206c 696e 6573 0d0a 2020 2020 2020  on lines..      
-00034dc0: 2020 6178 3a20 6d61 7470 6c6f 746c 6962    ax: matplotlib
-00034dd0: 2061 7869 730d 0a20 2020 2020 2020 2020   axis..         
-00034de0: 2020 2020 2020 2061 7869 7320 6f6e 2077         axis on w
-00034df0: 6869 6368 2074 6f20 706c 6f74 2074 6865  hich to plot the
-00034e00: 2063 726f 7373 2d73 6563 7469 6f6e 0d0a   cross-section..
-00034e10: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
-00034e20: 626f 6f6c 0d0a 2020 2020 2020 2020 2020  bool..          
-00034e30: 2020 2020 2020 6966 2054 7275 652c 2070        if True, p
-00034e40: 6c6f 7420 6120 6c65 6765 6e64 0d0a 2020  lot a legend..  
-00034e50: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00034e60: 2020 2020 2069 6620 6178 2069 7320 4e6f       if ax is No
-00034e70: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00034e80: 2066 6967 2c20 6178 3d70 6c74 2e73 7562   fig, ax=plt.sub
-00034e90: 706c 6f74 7328 290d 0a0d 0a20 2020 2020  plots()....     
-00034ea0: 2020 206f 783d 7365 6c66 2e6f 780d 0a20     ox=self.ox.. 
-00034eb0: 2020 2020 2020 206f 793d 7365 6c66 2e6f         oy=self.o
-00034ec0: 790d 0a20 2020 2020 2020 2078 313d 7365  y..        x1=se
-00034ed0: 6c66 2e78 675b 2d31 5d0d 0a20 2020 2020  lf.xg[-1]..     
-00034ee0: 2020 2079 313d 7365 6c66 2e79 675b 2d31     y1=self.yg[-1
-00034ef0: 5d0d 0a20 2020 2020 2020 2061 782e 706c  ]..        ax.pl
-00034f00: 6f74 2828 6f78 2c20 6f78 2c20 7831 2c20  ot((ox, ox, x1, 
-00034f10: 7831 2c20 6f78 292c 286f 792c 2079 312c  x1, ox),(oy, y1,
-00034f20: 2079 312c 206f 792c 206f 7929 2c20 633d   y1, oy, oy), c=
-00034f30: 226b 2229 2023 706c 6f74 2064 6f6d 6169  "k") #plot domai
-00034f40: 6e0d 0a20 2020 2020 2020 2061 782e 7365  n..        ax.se
-00034f50: 745f 6173 7065 6374 2822 6571 7561 6c22  t_aspect("equal"
-00034f60: 290d 0a0d 0a20 2020 2020 2020 2069 3d31  )....        i=1
-00034f70: 0d0a 2020 2020 2020 2020 666f 7220 6c69  ..        for li
-00034f80: 6e65 2069 6e20 6c69 7374 5f6c 696e 6573  ne in list_lines
-00034f90: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00034fa0: 6620 6e61 6d65 7320 6973 204e 6f6e 653a  f names is None:
-00034fb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00034fc0: 2020 6c61 6265 6c3d 2263 726f 7373 2022    label="cross "
-00034fd0: 202b 2073 7472 2869 290d 0a20 2020 2020   + str(i)..     
-00034fe0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00034ff0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00035000: 6265 6c3d 6e61 6d65 735b 692d 315d 0d0a  bel=names[i-1]..
-00035010: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00035020: 3d6e 702e 6172 7261 7928 6c69 6e65 290d  =np.array(line).
-00035030: 0a20 2020 2020 2020 2020 2020 2061 782e  .            ax.
-00035040: 706c 6f74 286c 696e 655b 3a2c 305d 2c20  plot(line[:,0], 
-00035050: 6c69 6e65 5b3a 2c31 5d2c 206c 6162 656c  line[:,1], label
-00035060: 3d6c 6162 656c 290d 0a20 2020 2020 2020  =label)..       
-00035070: 2020 2020 2069 202b 3d20 310d 0a0d 0a20       i += 1.... 
-00035080: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
-00035090: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
-000350a0: 782e 6c65 6765 6e64 2829 0d0a 0d0a 0d0a  x.legend()......
-000350b0: 2320 434c 4153 5345 5320 5049 4c45 202b  # CLASSES PILE +
-000350c0: 2055 4e49 5420 2b20 5355 5246 4143 450d   UNIT + SURFACE.
-000350d0: 0a63 6c61 7373 2050 696c 6528 293a 0d0a  .class Pile():..
-000350e0: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
-000350f0: 6869 7320 636c 6173 7320 6973 2061 206d  his class is a m
-00035100: 616a 6f72 206f 626a 6563 7420 7468 6520  ajor object the 
-00035110: 5374 7261 7469 6772 6170 6869 6320 5069  Stratigraphic Pi
-00035120: 6c65 2028 5350 292e 0d0a 2020 2020 4974  le (SP)...    It
-00035130: 2063 6f6e 7461 696e 7320 616c 6c20 7468   contains all th
-00035140: 6520 756e 6974 7320 6f62 6a65 6374 730d  e units objects.
-00035150: 0a20 2020 2061 6e64 2061 6c6c 6f77 2074  .    and allow t
-00035160: 6f20 6b6e 6f77 2074 6865 2073 7472 6174  o know the strat
-00035170: 6967 7261 7068 6963 616c 2072 656c 6174  igraphical relat
-00035180: 696f 6e73 2062 6574 7765 656e 2074 6865  ions between the
-00035190: 2075 6e69 7473 2e0d 0a20 2020 204f 6e65   units...    One
-000351a0: 2050 696c 6520 6f62 6a65 6374 206d 7573   Pile object mus
-000351b0: 7420 6265 2064 6566 696e 6564 2066 6f72  t be defined for
-000351c0: 2065 6163 6820 7375 6270 696c 6520 2b20   each subpile + 
-000351d0: 3120 226d 6173 7465 7222 2070 696c 652e  1 "master" pile.
-000351e0: 0d0a 0d0a 2020 2020 5061 7261 6d65 7465  ....    Paramete
-000351f0: 7273 0d0a 2020 2020 2d2d 2d2d 2d2d 2d2d  rs..    --------
-00035200: 2d2d 0d0a 2020 2020 6e61 6d65 3a20 7374  --..    name: st
-00035210: 720d 0a20 2020 2020 2020 206e 616d 6520  r..        name 
-00035220: 6f66 2074 6865 2070 696c 650d 0a20 2020  of the pile..   
-00035230: 206e 6174 7572 653a 2073 7472 0d0a 2020   nature: str..  
-00035240: 2020 2020 2020 756e 6974 7320 7479 7065        units type
-00035250: 206f 6620 696e 7465 7270 6f6c 6174 696f   of interpolatio
-00035260: 6e2c 2063 616e 2062 6520 2273 7572 6661  n, can be "surfa
-00035270: 6365 7322 206f 7220 2233 645f 6361 7465  ces" or "3d_cate
-00035280: 676f 7269 6361 6c22 0d0a 2020 2020 2020  gorical"..      
-00035290: 2020 6966 2022 7375 7266 6163 6573 2220    if "surfaces" 
-000352a0: 6973 2063 686f 7365 6e20 2864 6566 6175  is chosen (defau
-000352b0: 6c74 292c 2032 4420 7375 7266 6163 6573  lt), 2D surfaces
-000352c0: 2069 6e74 6572 706f 6c61 7469 6f6e 7320   interpolations 
-000352d0: 6f66 0d0a 2020 2020 2020 2020 7468 6520  of..        the 
-000352e0: 7375 7266 6163 6573 2061 7265 2070 6572  surfaces are per
-000352f0: 666f 726d 6564 2e20 5468 6520 7375 7266  formed. The surf
-00035300: 6163 6573 2061 7265 2074 6865 6e20 7573  aces are then us
-00035310: 6564 2074 6f20 6465 6c69 6d69 7420 756e  ed to delimit un
-00035320: 6974 2064 6f6d 6169 6e73 2e0d 0a20 2020  it domains...   
-00035330: 2020 2020 2069 6620 2233 645f 6361 7465       if "3d_cate
-00035340: 676f 7269 6361 6c22 2c20 6120 6661 6369  gorical", a faci
-00035350: 6573 206d 6574 686f 6420 6973 2075 7365  es method is use
-00035360: 6420 746f 2073 696d 756c 6174 6520 706f  d to simulate po
-00035370: 7369 7469 6f6e 206f 6620 7468 6520 756e  sition of the un
-00035380: 6974 732e 0d0a 2020 2020 2020 2020 5468  its...        Th
-00035390: 6520 6176 6169 6c61 626c 6520 6d65 7468  e available meth
-000353a0: 6f64 7320 6172 6520 7468 6520 7361 6d65  ods are the same
-000353b0: 2074 6f20 7369 6d75 6c61 7465 2074 6865   to simulate the
-000353c0: 2066 6163 6965 732e 0d0a 2020 2020 7665   facies...    ve
-000353d0: 7262 6f73 653a 2069 6e74 0d0a 2020 2020  rbose: int..    
-000353e0: 2020 2020 6c65 7665 6c20 6f66 2076 6572      level of ver
-000353f0: 626f 7369 7479 0d0a 2020 2020 7365 6564  bosity..    seed
-00035400: 3a20 696e 740d 0a20 2020 2020 2020 2073  : int..        s
-00035410: 6565 6420 666f 7220 7261 6e64 6f6d 206e  eed for random n
-00035420: 756d 6265 7220 6765 6e65 7261 7469 6f6e  umber generation
-00035430: 0d0a 2020 2020 2222 220d 0a0d 0a20 2020  ..    """....   
-00035440: 2064 6566 205f 5f69 6e69 745f 5f28 7365   def __init__(se
-00035450: 6c66 2c20 6e61 6d65 2c20 6e61 7475 7265  lf, name, nature
-00035460: 3d22 7375 7266 6163 6573 222c 2076 6572  ="surfaces", ver
-00035470: 626f 7365 3d31 2c20 7365 6564 3d31 293a  bose=1, seed=1):
-00035480: 0d0a 0d0a 2020 2020 2020 2020 6173 7365  ....        asse
-00035490: 7274 2069 7369 6e73 7461 6e63 6528 6e61  rt isinstance(na
-000354a0: 6d65 2c20 7374 7229 2c20 2241 206e 616d  me, str), "A nam
-000354b0: 6520 7368 6f75 6c64 2062 6520 7072 6f76  e should be prov
-000354c0: 6964 6564 2061 6e64 206d 7573 7420 6265  ided and must be
-000354d0: 2061 2073 7472 696e 6722 0d0a 2020 2020   a string"..    
-000354e0: 2020 2020 7365 6c66 2e6c 6973 745f 756e      self.list_un
-000354f0: 6974 733d 5b5d 0d0a 2020 2020 2020 2020  its=[]..        
-00035500: 7365 6c66 2e6e 616d 653d 6e61 6d65 0d0a  self.name=name..
-00035510: 2020 2020 2020 2020 7365 6c66 2e76 6572          self.ver
-00035520: 626f 7365 3d76 6572 626f 7365 0d0a 2020  bose=verbose..  
-00035530: 2020 2020 2020 7365 6c66 2e73 6565 643d        self.seed=
-00035540: 7365 6564 0d0a 2020 2020 2020 2020 7365  seed..        se
-00035550: 6c66 2e6e 6174 7572 6520 3d20 6e61 7475  lf.nature = natu
-00035560: 7265 0d0a 0d0a 0d0a 2020 2020 6465 6620  re......    def 
-00035570: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0d  __repr__(self):.
-00035580: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00035590: 7365 6c66 2e6e 616d 650d 0a0d 0a20 2020  self.name....   
-000355a0: 2064 6566 2061 6464 5f75 6e69 7428 7365   def add_unit(se
-000355b0: 6c66 2c20 756e 6974 293a 0d0a 2020 2020  lf, unit):..    
-000355c0: 2020 2020 0d0a 2020 2020 2020 2020 2222      ..        ""
-000355d0: 220d 0a20 2020 2020 2020 2041 6464 2061  "..        Add a
-000355e0: 2075 6e69 7420 746f 2074 6865 2070 696c   unit to the pil
-000355f0: 650d 0a0d 0a20 2020 2020 2020 2050 6172  e....        Par
-00035600: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00035610: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00035620: 2020 2020 2075 6e69 743a 2055 6e69 7420       unit: Unit 
-00035630: 6f62 6a65 6374 206f 7220 6c69 7374 206f  object or list o
-00035640: 6620 556e 6974 206f 626a 6563 7473 0d0a  f Unit objects..
-00035650: 2020 2020 2020 2020 2020 2020 756e 6974              unit
-00035660: 2873 2920 746f 2061 6464 2074 6f20 7468  (s) to add to th
-00035670: 6520 7069 6c65 0d0a 2020 2020 2020 2020  e pile..        
-00035680: 2222 220d 0a0d 0a20 2020 2020 2020 2074  """....        t
-00035690: 7279 3a20 2369 7465 7261 626c 650d 0a20  ry: #iterable.. 
-000356a0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-000356b0: 2069 6e20 756e 6974 3a0d 0a20 2020 2020   in unit:..     
-000356c0: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
-000356d0: 7369 6e73 7461 6e63 6528 692c 2055 6e69  sinstance(i, Uni
-000356e0: 7429 2920 616e 6420 2869 206e 6f74 2069  t)) and (i not i
-000356f0: 6e20 7365 6c66 2e6c 6973 745f 756e 6974  n self.list_unit
-00035700: 7329 3a0d 0a20 2020 2020 2020 2020 2020  s):..           
-00035710: 2020 2020 2020 2020 2069 2e76 6572 626f           i.verbo
-00035720: 7365 203d 2073 656c 662e 7665 7262 6f73  se = self.verbos
-00035730: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00035740: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
-00035750: 5f75 6e69 7473 2e61 7070 656e 6428 6929  _units.append(i)
-00035760: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035770: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00035780: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00035790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000357a0: 7072 696e 7428 2253 7472 6174 6967 7261  print("Stratigra
-000357b0: 7068 6963 2075 6e69 7420 7b7d 2061 6464  phic unit {} add
-000357c0: 6564 222e 666f 726d 6174 2869 2e6e 616d  ed".format(i.nam
-000357d0: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
-000357e0: 2020 2020 2065 6c69 6620 2869 7369 6e73       elif (isins
-000357f0: 7461 6e63 6528 692c 2055 6e69 7429 293a  tance(i, Unit)):
-00035800: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035810: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-00035820: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00035830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035840: 7072 696e 7428 226f 626a 6563 7420 6973  print("object is
-00035850: 2061 6c72 6561 6479 2069 6e20 7468 6520   already in the 
-00035860: 6c69 7374 2229 0d0a 2020 2020 2020 2020  list")..        
-00035870: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00035880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035890: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
-000358a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000358b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000358c0: 6e74 2822 6f62 6a65 6374 2069 736e 2774  nt("object isn't
-000358d0: 2061 2075 6e69 7420 6f62 6a65 6374 2229   a unit object")
-000358e0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-000358f0: 3a20 2320 756e 6974 206e 6f74 2069 6e20  : # unit not in 
-00035900: 6120 6c69 7374 0d0a 2020 2020 2020 2020  a list..        
-00035910: 2020 2020 6966 2028 6973 696e 7374 616e      if (isinstan
-00035920: 6365 2875 6e69 742c 2055 6e69 7429 2920  ce(unit, Unit)) 
-00035930: 616e 6420 2875 6e69 7420 6e6f 7420 696e  and (unit not in
-00035940: 2073 656c 662e 6c69 7374 5f75 6e69 7473   self.list_units
-00035950: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00035960: 2020 2020 7365 6c66 2e6c 6973 745f 756e      self.list_un
-00035970: 6974 732e 6170 7065 6e64 2875 6e69 7429  its.append(unit)
-00035980: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00035990: 2020 756e 6974 2e76 6572 626f 7365 203d    unit.verbose =
-000359a0: 2073 656c 662e 7665 7262 6f73 650d 0a20   self.verbose.. 
-000359b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000359c0: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-000359d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000359e0: 2020 2020 2070 7269 6e74 2822 5374 7261       print("Stra
-000359f0: 7469 6772 6170 6869 6320 756e 6974 207b  tigraphic unit {
-00035a00: 7d20 6164 6465 6422 2e66 6f72 6d61 7428  } added".format(
-00035a10: 756e 6974 2e6e 616d 6529 290d 0a20 2020  unit.name))..   
-00035a20: 2020 2020 2020 2020 2065 6c69 6620 2869           elif (i
-00035a30: 7369 6e73 7461 6e63 6528 756e 6974 2c20  sinstance(unit, 
-00035a40: 556e 6974 2929 3a0d 0a20 2020 2020 2020  Unit)):..       
-00035a50: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00035a60: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-00035a70: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00035a80: 7269 6e74 2822 6f62 6a65 6374 2069 7320  rint("object is 
-00035a90: 616c 7265 6164 7920 696e 2074 6865 206c  already in the l
-00035aa0: 6973 7422 290d 0a20 2020 2020 2020 2020  ist")..         
-00035ab0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00035ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035ad0: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
-00035ae0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00035af0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00035b00: 7428 226f 626a 6563 7420 6973 6e27 7420  t("object isn't 
-00035b10: 6120 756e 6974 206f 626a 6563 7422 290d  a unit object").
-00035b20: 0a0d 0a20 2020 2064 6566 2072 656d 6f76  ...    def remov
-00035b30: 655f 756e 6974 2873 656c 662c 2075 6e69  e_unit(self, uni
-00035b40: 745f 746f 5f72 656d 293a 0d0a 0d0a 2020  t_to_rem):....  
-00035b50: 2020 2020 2020 2222 2252 656d 6f76 6520        """Remove 
-00035b60: 7468 6520 6769 7665 6e20 756e 6974 206f  the given unit o
-00035b70: 626a 6563 7420 6672 6f6d 2050 696c 6520  bject from Pile 
-00035b80: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-00035b90: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00035ba0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00035bb0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00035bc0: 2020 756e 6974 5f74 6f5f 7265 6d3a 203a    unit_to_rem: :
-00035bd0: 636c 6173 733a 6055 6e69 7460 206f 626a  class:`Unit` obj
-00035be0: 6563 740d 0a20 2020 2020 2020 2020 2020  ect..           
-00035bf0: 2075 6e69 7420 746f 2072 656d 6f76 6520   unit to remove 
-00035c00: 6672 6f6d 2074 6865 2070 696c 650d 0a20  from the pile.. 
-00035c10: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00035c20: 2020 2020 2020 6966 206c 656e 2873 656c        if len(sel
-00035c30: 662e 6c69 7374 5f75 6e69 7473 2920 3e20  f.list_units) > 
-00035c40: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-00035c50: 6966 2075 6e69 745f 746f 5f72 656d 2069  if unit_to_rem i
-00035c60: 6e20 7365 6c66 2e6c 6973 745f 756e 6974  n self.list_unit
-00035c70: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00035c80: 2020 2020 7365 6c66 2e6c 6973 745f 756e      self.list_un
-00035c90: 6974 732e 7265 6d6f 7665 2875 6e69 745f  its.remove(unit_
-00035ca0: 746f 5f72 656d 290d 0a20 2020 2020 2020  to_rem)..       
-00035cb0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00035cc0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-00035cd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00035ce0: 7269 6e74 2822 556e 6974 207b 7d20 7265  rint("Unit {} re
-00035cf0: 6d6f 7665 6420 6672 6f6d 2050 696c 6520  moved from Pile 
-00035d00: 7b7d 222e 666f 726d 6174 2875 6e69 745f  {}".format(unit_
-00035d10: 746f 5f72 656d 2e6e 616d 652c 2073 656c  to_rem.name, sel
-00035d20: 662e 6e61 6d65 2929 0d0a 0d0a 2020 2020  f.name))....    
-00035d30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00035d40: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-00035d50: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-00035d60: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00035d70: 6e6f 2075 6e69 7473 2066 6f75 6e64 2069  no units found i
-00035d80: 6e20 7069 6c65 207b 7d22 2e66 6f72 6d61  n pile {}".forma
-00035d90: 7428 7365 6c66 2e6e 616d 6529 290d 0a0d  t(self.name))...
-00035da0: 0a20 2020 2064 6566 2067 6574 5f70 696c  .    def get_pil
-00035db0: 655f 7265 6628 7365 6c66 293a 0d0a 0d0a  e_ref(self):....
-00035dc0: 2020 2020 2020 2020 6c20 3d20 5b5d 0d0a          l = []..
-00035dd0: 2020 2020 2020 2020 666f 7220 756e 2069          for un i
-00035de0: 6e20 7365 6c66 2e6c 6973 745f 756e 6974  n self.list_unit
-00035df0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00035e00: 6966 2075 6e2e 6d5f 756e 6974 5f6e 616d  if un.m_unit_nam
-00035e10: 6520 6973 206e 6f74 204e 6f6e 653a 0d0a  e is not None:..
-00035e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035e30: 6c2e 6170 7065 6e64 2875 6e2e 6d5f 756e  l.append(un.m_un
-00035e40: 6974 5f6e 616d 6529 0d0a 2020 2020 2020  it_name)..      
-00035e50: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00035e60: 2020 2020 2020 2020 2020 2020 206c 2e61               l.a
-00035e70: 7070 656e 6428 756e 2e6e 616d 6529 0d0a  ppend(un.name)..
-00035e80: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00035e90: 206c 0d0a 0d0a 2020 2020 6465 6620 6f72   l....    def or
-00035ea0: 6465 725f 756e 6974 7328 7365 6c66 2c20  der_units(self, 
-00035eb0: 7662 3d31 293a 0d0a 0d0a 2020 2020 2020  vb=1):....      
-00035ec0: 2020 2222 220d 0a20 2020 2020 2020 204f    """..        O
-00035ed0: 7264 6572 206c 6973 745f 6c69 7468 7320  rder list_liths 
-00035ee0: 6163 636f 7264 696e 6720 7468 6520 6f72  according the or
-00035ef0: 6465 7220 6174 7472 6962 7574 6573 206f  der attributes o
-00035f00: 6620 6561 6368 206c 6974 686f 6c6f 6769  f each lithologi
-00035f10: 6573 0d0a 0d0a 2020 2020 2020 2020 5061  es....        Pa
-00035f20: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00035f30: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00035f40: 2020 2020 2020 7662 3a20 696e 740d 0a20        vb: int.. 
-00035f50: 2020 2020 2020 2020 2020 206c 6576 656c             level
-00035f60: 206f 6620 7665 7262 6f73 6974 792c 2030   of verbosity, 0
-00035f70: 2066 6f72 206e 6f20 7072 696e 742c 2031   for no print, 1
-00035f80: 2066 6f72 2070 7269 6e74 0d0a 2020 2020   for print..    
-00035f90: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-00035fa0: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
-00035fb0: 2020 2020 2020 2070 7269 6e74 2822 5069         print("Pi
-00035fc0: 6c65 207b 7d3a 206f 7264 6572 696e 6720  le {}: ordering 
-00035fd0: 756e 6974 7322 2e66 6f72 6d61 7428 7365  units".format(se
-00035fe0: 6c66 2e6e 616d 6529 290d 0a0d 0a20 2020  lf.name))....   
-00035ff0: 2020 2020 2073 656c 662e 6c69 7374 5f75       self.list_u
-00036000: 6e69 7473 2e73 6f72 7428 6b65 793d 6c61  nits.sort(key=la
-00036010: 6d62 6461 2078 3a20 782e 6f72 6465 7229  mbda x: x.order)
-00036020: 0d0a 2020 2020 2020 2020 6966 2076 623a  ..        if vb:
-00036030: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00036040: 696e 7428 2253 7472 6174 6967 7261 7068  int("Stratigraph
-00036050: 6963 2075 6e69 7473 2068 6176 6520 6265  ic units have be
-00036060: 656e 2073 6f72 7465 6420 6163 636f 7264  en sorted accord
-00036070: 696e 6720 746f 206f 7264 6572 2229 0d0a  ing to order")..
-00036080: 0d0a 2020 2020 2020 2020 693d 300d 0a20  ..        i=0.. 
-00036090: 2020 2020 2020 2066 6c61 673d 300d 0a20         flag=0.. 
-000360a0: 2020 2020 2020 2023 2063 6865 636b 206f         # check o
-000360b0: 7264 6572 7320 6f66 2075 6e69 740d 0a20  rders of unit.. 
-000360c0: 2020 2020 2020 2066 6f72 2073 2069 6e20         for s in 
-000360d0: 7365 6c66 2e6c 6973 745f 756e 6974 733a  self.list_units:
-000360e0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000360f0: 2069 203d 3d20 303a 0d0a 2020 2020 2020   i == 0:..      
-00036100: 2020 2020 2020 2020 2020 735f 6265 663d            s_bef=
-00036110: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00036120: 2020 2069 6620 735f 6265 662e 6f72 6465     if s_bef.orde
-00036130: 7220 213d 2031 3a0d 0a20 2020 2020 2020  r != 1:..       
-00036140: 2020 2020 2020 2020 2020 2020 2066 6c61               fla
-00036150: 673d 310d 0a20 2020 2020 2020 2020 2020  g=1..           
-00036160: 2020 2020 2020 2020 2069 6620 7662 3a0d           if vb:.
-00036170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036180: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00036190: 6669 7273 7420 756e 6974 206f 7264 6572  first unit order
-000361a0: 2069 7320 6e6f 7420 6571 7561 6c20 746f   is not equal to
-000361b0: 2031 2229 0d0a 0d0a 2020 2020 2020 2020   1")....        
-000361c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-000361d0: 2020 2020 2020 2020 2020 2069 6620 732e             if s.
-000361e0: 6f72 6465 7220 3d3d 2073 5f62 6566 2e6f  order == s_bef.o
-000361f0: 7264 6572 3a0d 0a20 2020 2020 2020 2020  rder:..         
-00036200: 2020 2020 2020 2020 2020 2066 6c61 673d             flag=
-00036210: 310d 0a20 2020 2020 2020 2020 2020 2020  1..             
-00036220: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
-00036230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036240: 2020 2020 2020 2070 7269 6e74 2822 756e         print("un
-00036250: 6974 7320 7b7d 2061 6e64 207b 7d20 6861  its {} and {} ha
-00036260: 7665 2074 6865 2073 616d 6520 6f72 6465  ve the same orde
-00036270: 7222 2e66 6f72 6d61 7428 732e 6e61 6d65  r".format(s.name
-00036280: 2c20 735f 6265 662e 6e61 6d65 2929 0d0a  , s_bef.name))..
-00036290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000362a0: 2020 656c 6966 2073 2e6f 7264 6572 2021    elif s.order !
-000362b0: 3d20 735f 6265 662e 6f72 6465 7220 2b20  = s_bef.order + 
-000362c0: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-000362d0: 2020 2020 2020 2020 666c 6167 3d31 0d0a          flag=1..
-000362e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000362f0: 2020 2020 6966 2076 623a 0d0a 2020 2020      if vb:..    
-00036300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036310: 2020 2020 7072 696e 7428 2244 6973 6372      print("Discr
-00036320: 6570 656e 6379 2069 6e20 7468 6520 6f72  epency in the or
-00036330: 6465 7273 2066 6f72 2075 6e69 7473 207b  ders for units {
-00036340: 7d20 616e 6420 7b7d 222e 666f 726d 6174  } and {}".format
-00036350: 2873 2e6e 616d 652c 2073 5f62 6566 2e6e  (s.name, s_bef.n
-00036360: 616d 6529 290d 0a0d 0a20 2020 2020 2020  ame))....       
-00036370: 2020 2020 2020 2020 2073 5f62 6566 3d73           s_bef=s
-00036380: 0d0a 2020 2020 2020 2020 2020 2020 6920  ..            i 
-00036390: 2b3d 2031 0d0a 0d0a 2020 2020 2020 2020  += 1....        
-000363a0: 6966 2066 6c61 673a 0d0a 2020 2020 2020  if flag:..      
-000363b0: 2020 2020 2020 6966 2076 623a 0d0a 2020        if vb:..  
-000363c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000363d0: 696e 7428 2243 6861 6e67 696e 6720 6f72  int("Changing or
-000363e0: 6465 7273 2066 6f72 2074 6861 7420 7468  ders for that th
-000363f0: 6579 2072 616e 6765 2066 726f 6d20 3120  ey range from 1 
-00036400: 746f 206e 2229 0d0a 2020 2020 2020 2020  to n")..        
-00036410: 2020 2020 2320 6368 6563 6b20 6f72 6465      # check orde
-00036420: 7220 7261 6e67 696e 6720 6672 6f6d 2031  r ranging from 1
-00036430: 2074 6f20 6e0d 0a20 2020 2020 2020 2020   to n..         
-00036440: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-00036450: 6528 6c65 6e28 7365 6c66 2e6c 6973 745f  e(len(self.list_
-00036460: 756e 6974 7329 293a 0d0a 2020 2020 2020  units)):..      
-00036470: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00036480: 662e 6c69 7374 5f75 6e69 7473 5b69 5d2e  f.list_units[i].
-00036490: 6f72 6465 7220 213d 2069 2b31 3a0d 0a20  order != i+1:.. 
-000364a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000364b0: 2020 2073 656c 662e 6c69 7374 5f75 6e69     self.list_uni
-000364c0: 7473 5b69 5d2e 6f72 6465 723d 692b 310d  ts[i].order=i+1.
-000364d0: 0a0d 0a20 2020 2064 6566 2063 6f6d 7075  ...    def compu
-000364e0: 7465 5f73 7572 6628 7365 6c66 2c20 4172  te_surf(self, Ar
-000364f0: 6368 5461 626c 652c 206e 7265 616c 3d31  chTable, nreal=1
-00036500: 2c20 666c 5f74 6f70 3d46 616c 7365 2c20  , fl_top=False, 
-00036510: 7375 6270 696c 653d 4661 6c73 652c 2074  subpile=False, t
-00036520: 6f70 733d 4e6f 6e65 2c20 626f 7473 3d4e  ops=None, bots=N
-00036530: 6f6e 652c 2076 623d 3129 3a0d 0a0d 0a20  one, vb=1):.... 
-00036540: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00036550: 2020 2020 436f 6d70 7574 6520 7468 6520      Compute the 
-00036560: 656c 6576 6174 696f 6e20 6f66 2074 6865  elevation of the
-00036570: 2073 7572 6661 6365 7320 756e 6974 7320   surfaces units 
-00036580: 2831 7374 2068 6965 7261 7263 6869 6320  (1st hierarchic 
-00036590: 6f72 6465 7229 0d0a 2020 2020 2020 2020  order)..        
-000365a0: 636f 6e74 6169 6e65 6420 696e 2074 6865  contained in the
-000365b0: 2050 696c 6520 6f62 6a65 6374 2e0d 0a0d   Pile object....
-000365c0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000365d0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-000365e0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-000365f0: 2041 7263 6854 6162 6c65 3a20 3a63 6c61   ArchTable: :cla
-00036600: 7373 3a60 4172 6368 5f74 6162 6c65 6020  ss:`Arch_table` 
-00036610: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-00036620: 2020 2020 4172 6368 5461 626c 6520 6f62      ArchTable ob
-00036630: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
-00036640: 7468 6520 6172 6368 6974 6563 7475 7265  the architecture
-00036650: 206f 6620 7468 6520 7069 6c65 0d0a 2020   of the pile..  
-00036660: 2020 2020 2020 6e72 6561 6c3a 2069 6e74        nreal: int
-00036670: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
-00036680: 6d62 6572 206f 6620 7265 616c 697a 6174  mber of realizat
-00036690: 696f 6e0d 0a20 2020 2020 2020 2066 6c5f  ion..        fl_
-000366a0: 746f 703a 2062 6f6f 6c0d 0a20 2020 2020  top: bool..     
-000366b0: 2020 2020 2020 2074 6f20 6e6f 7420 696e         to not in
-000366c0: 7465 7270 6f6c 6174 6520 6669 7273 7420  terpolate first 
-000366d0: 6c61 7965 7220 616e 6420 6173 7369 676e  layer and assign
-000366e0: 2069 743d 746f 700d 0a20 2020 2020 2020   it=top..       
-000366f0: 2073 7562 7069 6c65 3a20 626f 6f6c 0d0a   subpile: bool..
-00036700: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00036710: 6865 2070 696c 6520 6973 2061 2073 7562  he pile is a sub
-00036720: 7069 6c65 0d0a 2020 2020 2020 2020 746f  pile..        to
-00036730: 7073 2c20 626f 7473 3a20 7365 7175 656e  ps, bots: sequen
-00036740: 6365 206f 6620 3244 2061 7272 6179 7320  ce of 2D arrays 
-00036750: 6f66 2073 697a 6520 286e 792c 206e 7829  of size (ny, nx)
-00036760: 0d0a 2020 2020 2020 2020 2020 2020 6f66  ..            of
-00036770: 2074 6f70 2f62 6f74 2066 6f72 2073 7562   top/bot for sub
-00036780: 7069 6c65 2073 7572 6661 6365 0d0a 2020  pile surface..  
-00036790: 2020 2020 2020 7662 3a20 696e 740d 0a20        vb: int.. 
-000367a0: 2020 2020 2020 2020 2020 206c 6576 656c             level
-000367b0: 206f 6620 7665 7262 6f73 6974 792c 2030   of verbosity, 0
-000367c0: 2066 6f72 206e 6f20 7072 696e 742c 2031   for no print, 1
-000367d0: 2066 6f72 2070 7269 6e74 0d0a 0d0a 2020   for print....  
-000367e0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-000367f0: 2020 2020 2064 6566 2061 6464 5f73 746f       def add_sto
-00036800: 5f63 6f6e 7461 6374 2873 2c20 782c 2079  _contact(s, x, y
-00036810: 2c20 7a2c 2074 7970 653d 2265 7175 616c  , z, type="equal
-00036820: 6974 7922 2c20 7a32 3d4e 6f6e 6529 3a20  ity", z2=None): 
-00036830: 2366 756e 6374 696f 6e20 746f 2061 6464  #function to add
-00036840: 2061 2073 746f 6368 6173 7469 6320 6864   a stochastic hd
-00036850: 2070 6f69 6e74 2074 6f20 6120 7375 7266   point to a surf
-00036860: 6163 650d 0a20 2020 2020 2020 2020 2020  ace..           
-00036870: 2023 2077 6172 6e69 6e67 206e 6f20 6368   # warning no ch
-00036880: 6563 6b20 7468 6174 2070 6f69 6e74 2069  eck that point i
-00036890: 7320 696e 7369 6465 2064 6f6d 6169 6e0d  s inside domain.
-000368a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000368b0: 7479 7065 203d 3d20 2265 7175 616c 6974  type == "equalit
-000368c0: 7922 3a0d 0a20 2020 2020 2020 2020 2020  y":..           
-000368d0: 2020 2020 2073 2e73 7572 6661 6365 2e73       s.surface.s
-000368e0: 746f 5f78 2e61 7070 656e 6428 7829 0d0a  to_x.append(x)..
-000368f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036900: 732e 7375 7266 6163 652e 7374 6f5f 792e  s.surface.sto_y.
-00036910: 6170 7065 6e64 2879 290d 0a20 2020 2020  append(y)..     
-00036920: 2020 2020 2020 2020 2020 2073 2e73 7572             s.sur
-00036930: 6661 6365 2e73 746f 5f7a 2e61 7070 656e  face.sto_z.appen
-00036940: 6428 7a29 0d0a 2020 2020 2020 2020 2020  d(z)..          
-00036950: 2020 656c 6966 2074 7970 6520 3d3d 2022    elif type == "
-00036960: 696e 6571 5f69 6e66 223a 0d0a 2020 2020  ineq_inf":..    
-00036970: 2020 2020 2020 2020 2020 2020 732e 7375              s.su
-00036980: 7266 6163 652e 7374 6f5f 696e 6571 2e61  rface.sto_ineq.a
-00036990: 7070 656e 6428 5b78 2c20 792c 2030 2c20  ppend([x, y, 0, 
-000369a0: 7a2c 206e 702e 6e61 6e5d 290d 0a20 2020  z, np.nan])..   
-000369b0: 2020 2020 2020 2020 2065 6c69 6620 7479           elif ty
-000369c0: 7065 203d 3d20 2269 6e65 715f 7375 7022  pe == "ineq_sup"
-000369d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000369e0: 2020 2073 2e73 7572 6661 6365 2e73 746f     s.surface.sto
-000369f0: 5f69 6e65 712e 6170 7065 6e64 285b 782c  _ineq.append([x,
-00036a00: 2079 2c20 302c 206e 702e 6e61 6e2c 207a   y, 0, np.nan, z
-00036a10: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00036a20: 656c 6966 2074 7970 6520 3d3d 2022 646f  elif type == "do
-00036a30: 7562 6c65 5f69 6e65 7122 3a0d 0a20 2020  uble_ineq":..   
-00036a40: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
-00036a50: 7572 6661 6365 2e73 746f 5f69 6e65 712e  urface.sto_ineq.
-00036a60: 6170 7065 6e64 285b 782c 2079 2c20 302c  append([x, y, 0,
-00036a70: 207a 2c20 7a32 5d29 2020 2320 696e 6665   z, z2])  # infe
-00036a80: 7269 6f72 2061 6e64 2075 7070 6572 2069  rior and upper i
-00036a90: 6e65 710d 0a0d 0a0d 0a20 2020 2020 2020  neq......       
-00036aa0: 2069 6620 4172 6368 5461 626c 652e 6368   if ArchTable.ch
-00036ab0: 6563 6b5f 7069 6c65 735f 6e61 6d65 2829  eck_piles_name()
-00036ac0: 203d 3d20 303a 2023 2063 6865 636b 2063   == 0: # check c
-00036ad0: 6f6e 7369 7374 656e 6379 2069 6e20 756e  onsistency in un
-00036ae0: 6974 0d0a 2020 2020 2020 2020 2020 2020  it..            
-00036af0: 7265 7475 726e 204e 6f6e 650d 0a0d 0a20  return None.... 
-00036b00: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
-00036b10: 2e6e 7265 616c 5f75 6e69 7473 3d6e 7265  .nreal_units=nre
-00036b20: 616c 2020 2320 7374 6f72 6520 6e75 6d62  al  # store numb
-00036b30: 6572 206f 6620 7265 616c 697a 6174 696f  er of realizatio
-00036b40: 6e73 0d0a 0d0a 2020 2020 2020 2020 2373  ns....        #s
-00036b50: 696d 756c 6174 696f 6e20 6772 6964 0d0a  imulation grid..
-00036b60: 2020 2020 2020 2020 7867 3d41 7263 6854          xg=ArchT
-00036b70: 6162 6c65 2e67 6574 5f78 6763 2829 0d0a  able.get_xgc()..
-00036b80: 2020 2020 2020 2020 6e78 3d78 672e 7368          nx=xg.sh
-00036b90: 6170 655b 305d 0d0a 2020 2020 2020 2020  ape[0]..        
-00036ba0: 7967 3d41 7263 6854 6162 6c65 2e67 6574  yg=ArchTable.get
-00036bb0: 5f79 6763 2829 0d0a 2020 2020 2020 2020  _ygc()..        
-00036bc0: 6e79 3d79 672e 7368 6170 655b 305d 0d0a  ny=yg.shape[0]..
-00036bd0: 2020 2020 2020 2020 7a67 3d41 7263 6854          zg=ArchT
-00036be0: 6162 6c65 2e67 6574 5f7a 6728 290d 0a20  able.get_zg().. 
-00036bf0: 2020 2020 2020 206e 7a3d 7a67 2e73 6861         nz=zg.sha
-00036c00: 7065 5b30 5d20 2d20 310d 0a20 2020 2020  pe[0] - 1..     
-00036c10: 2020 2069 6620 7e73 7562 7069 6c65 3a0d     if ~subpile:.
-00036c20: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-00036c30: 3d41 7263 6854 6162 6c65 2e74 6f70 0d0a  =ArchTable.top..
-00036c40: 2020 2020 2020 2020 2020 2020 626f 743d              bot=
-00036c50: 4172 6368 5461 626c 652e 626f 740d 0a20  ArchTable.bot.. 
-00036c60: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
-00036c70: 5461 626c 652e 6d61 736b 2020 2320 7369  Table.mask  # si
-00036c80: 6d75 6c61 7469 6f6e 206d 6173 6b0d 0a20  mulation mask.. 
-00036c90: 2020 2020 2020 206d 6173 6b32 4420 3d20         mask2D = 
-00036ca0: 4172 6368 5461 626c 652e 6d61 736b 3264  ArchTable.mask2d
-00036cb0: 2020 2320 6d61 736b 2032 440d 0a20 2020    # mask 2D..   
-00036cc0: 2020 2020 206e 6c61 793d 6c65 6e28 7365       nlay=len(se
-00036cd0: 6c66 2e6c 6973 745f 756e 6974 7329 0d0a  lf.list_units)..
-00036ce0: 0d0a 2020 2020 2020 2020 6966 2076 623a  ..        if vb:
-00036cf0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00036d00: 696e 7428 2223 2323 2323 2323 2323 2320  int("########## 
-00036d10: 5049 4c45 207b 7d20 2323 2323 2323 2323  PILE {} ########
-00036d20: 2323 222e 666f 726d 6174 2873 656c 662e  ##".format(self.
-00036d30: 6e61 6d65 2929 0d0a 2020 2020 2020 2020  name))..        
-00036d40: 236d 616b 6520 7375 7265 2074 6f20 6861  #make sure to ha
-00036d50: 7665 206f 7264 6572 6564 206c 6974 686f  ve ordered litho
-00036d60: 6c6f 6769 6573 0d0a 2020 2020 2020 2020  logies..        
-00036d70: 7365 6c66 2e6f 7264 6572 5f75 6e69 7473  self.order_units
-00036d80: 2876 623d 7662 290d 0a0d 0a20 2020 2020  (vb=vb)....     
-00036d90: 2020 2023 2323 2069 6e69 7469 616c 697a     ### initializ
-00036da0: 6520 7375 7266 6163 6573 2062 7920 7365  e surfaces by se
-00036db0: 7474 696e 6720 746f 2030 0d0a 0d0a 2020  tting to 0....  
-00036dc0: 2020 2020 2020 7375 7266 733d 6e70 2e7a        surfs=np.z
-00036dd0: 6572 6f73 285b 6e72 6561 6c2c 206e 6c61  eros([nreal, nla
-00036de0: 792c 206e 792c 206e 785d 2c20 6474 7970  y, ny, nx], dtyp
-00036df0: 653d 6e70 2e66 6c6f 6174 3332 290d 0a20  e=np.float32).. 
-00036e00: 2020 2020 2020 2073 7572 6673 5f62 6f74         surfs_bot
-00036e10: 3d6e 702e 7a65 726f 7328 5b6e 7265 616c  =np.zeros([nreal
-00036e20: 2c20 6e6c 6179 2c20 6e79 2c20 6e78 5d2c  , nlay, ny, nx],
-00036e30: 2064 7479 7065 3d6e 702e 666c 6f61 7433   dtype=np.float3
-00036e40: 3229 0d0a 2020 2020 2020 2020 6f72 675f  2)..        org_
-00036e50: 7375 7266 733d 6e70 2e7a 6572 6f73 285b  surfs=np.zeros([
-00036e60: 6e72 6561 6c2c 206e 6c61 792c 206e 792c  nreal, nlay, ny,
-00036e70: 206e 785d 2c20 6474 7970 653d 6e70 2e66   nx], dtype=np.f
-00036e80: 6c6f 6174 3332 290d 0a20 2020 2020 2020  loat32)..       
-00036e90: 2072 6561 6c5f 646f 6d61 696e 733d 6e70   real_domains=np
-00036ea0: 2e7a 6572 6f73 285b 6e72 6561 6c2c 206e  .zeros([nreal, n
-00036eb0: 6c61 792c 206e 7a2c 206e 792c 206e 785d  lay, nz, ny, nx]
-00036ec0: 2c20 6474 7970 653d 6e70 2e69 6e74 3829  , dtype=np.int8)
-00036ed0: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
-00036ee0: 6972 6561 6c20 696e 2072 616e 6765 286e  ireal in range(n
-00036ef0: 7265 616c 293a 2023 206c 6f6f 7020 6f76  real): # loop ov
-00036f00: 6572 2072 6561 6c0d 0a0d 0a20 2020 2020  er real....     
-00036f10: 2020 2020 2020 2023 2065 7261 7365 2073         # erase s
-00036f20: 746f 6368 6173 7469 6320 6461 7461 0d0a  tochastic data..
-00036f30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00036f40: 7320 696e 2073 656c 662e 6c69 7374 5f75  s in self.list_u
-00036f50: 6e69 7473 3a0d 0a20 2020 2020 2020 2020  nits:..         
-00036f60: 2020 2020 2020 2073 2e73 7572 6661 6365         s.surface
-00036f70: 2e73 746f 5f78 203d 205b 5d0d 0a20 2020  .sto_x = []..   
-00036f80: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
-00036f90: 7572 6661 6365 2e73 746f 5f79 203d 205b  urface.sto_y = [
-00036fa0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00036fb0: 2020 2073 2e73 7572 6661 6365 2e73 746f     s.surface.sto
-00036fc0: 5f7a 203d 205b 5d0d 0a20 2020 2020 2020  _z = []..       
-00036fd0: 2020 2020 2020 2020 2073 2e73 7572 6661           s.surfa
-00036fe0: 6365 2e73 746f 5f69 6e65 7120 3d20 5b5d  ce.sto_ineq = []
-00036ff0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00037000: 2320 636f 6d70 7574 6520 7374 6f20 6461  # compute sto da
-00037010: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
-00037020: 666f 7220 6720 696e 2041 7263 6854 6162  for g in ArchTab
-00037030: 6c65 2e73 746f 5f68 643a 0d0a 2020 2020  le.sto_hd:..    
-00037040: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-00037050: 6420 3d20 675b 305d 0d0a 2020 2020 2020  d = g[0]..      
-00037060: 2020 2020 2020 2020 2020 782c 792c 7a20            x,y,z 
-00037070: 3d20 636f 6f72 640d 0a20 2020 2020 2020  = coord..       
-00037080: 2020 2020 2020 2020 2068 6420 3d20 675b           hd = g[
-00037090: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-000370a0: 2020 2020 7020 3d20 675b 325d 0d0a 2020      p = g[2]..  
-000370b0: 2020 2020 2020 2020 2020 2020 2020 6920                i 
-000370c0: 3d20 6e70 2e72 616e 646f 6d2e 6368 6f69  = np.random.choi
-000370d0: 6365 2872 616e 6765 286c 656e 2870 2929  ce(range(len(p))
-000370e0: 2c20 703d 7029 0d0a 2020 2020 2020 2020  , p=p)..        
-000370f0: 2020 2020 2020 2020 666f 7220 732c 2074          for s, t
-00037100: 7970 2069 6e20 6e70 2e61 7272 6179 2868  yp in np.array(h
-00037110: 645b 695d 293a 0d0a 2020 2020 2020 2020  d[i]):..        
-00037120: 2020 2020 2020 2020 2020 2020 6164 645f              add_
-00037130: 7374 6f5f 636f 6e74 6163 7428 732c 2078  sto_contact(s, x
-00037140: 2c20 792c 207a 2c20 7479 7029 0d0a 0d0a  , y, z, typ)....
-00037150: 2020 2020 2020 2020 2020 2020 2374 6f70              #top
-00037160: 2f62 6f74 0d0a 2020 2020 2020 2020 2020  /bot..          
-00037170: 2020 6966 2073 7562 7069 6c65 3a0d 0a20    if subpile:.. 
-00037180: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00037190: 6f70 3d74 6f70 735b 6972 6561 6c5d 0d0a  op=tops[ireal]..
-000371a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371b0: 626f 743d 626f 7473 5b69 7265 616c 5d0d  bot=bots[ireal].
-000371c0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-000371d0: 2063 6f75 6e74 6572 2066 6f72 2063 7572   counter for cur
-000371e0: 7265 6e74 2073 696d 756c 6174 6564 2073  rent simulated s
-000371f0: 7572 6661 6365 0d0a 2020 2020 2020 2020  urface..        
-00037200: 2020 2020 693d 2d31 0d0a 0d0a 2020 2020      i=-1....    
-00037210: 2020 2020 2020 2020 666f 7220 6c69 7468          for lith
-00037220: 6f20 696e 2073 656c 662e 6c69 7374 5f75  o in self.list_u
-00037230: 6e69 7473 5b3a 3a20 2d31 5d3a 0d0a 2020  nits[:: -1]:..  
-00037240: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00037250: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
-00037260: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00037270: 225c 6e23 2323 2320 434f 4d50 5554 494e  "\n#### COMPUTIN
-00037280: 4720 5355 5246 4143 4520 4f46 2055 4e49  G SURFACE OF UNI
-00037290: 5420 7b7d 222e 666f 726d 6174 286c 6974  T {}".format(lit
-000372a0: 686f 2e6e 616d 6529 290d 0a20 2020 2020  ho.name))..     
-000372b0: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
-000372c0: 3120 2023 2069 6e64 6578 2066 6f72 2073  1  # index for s
-000372d0: 696d 756c 6174 6564 2073 7572 6661 6365  imulated surface
-000372e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000372f0: 2020 7374 6172 743d 7469 6d65 2e74 696d    start=time.tim
-00037300: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
-00037310: 2020 2020 2069 6620 2866 6c5f 746f 7029       if (fl_top)
-00037320: 2061 6e64 2028 6920 3d3d 206e 6c61 792d   and (i == nlay-
-00037330: 3129 3a20 2320 6669 7273 7420 6c61 7965  1): # first laye
-00037340: 7220 6173 7369 676e 2074 6f20 746f 700d  r assign to top.
-00037350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037360: 2020 2020 2073 313d 746f 700d 0a20 2020       s1=top..   
-00037370: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00037380: 6620 286c 6974 686f 2e73 7572 6661 6365  f (litho.surface
-00037390: 2e69 6e74 5f6d 6574 686f 6420 696e 205b  .int_method in [
-000373a0: 226b 7269 6769 6e67 222c 2022 6c69 6e65  "kriging", "line
-000373b0: 6172 222c 2022 6375 6269 6322 2c20 226e  ar", "cubic", "n
-000373c0: 6561 7265 7374 225d 2920 616e 6420 2869  earest"]) and (i
-000373d0: 7265 616c 203e 2030 293a 2023 2064 6574  real > 0): # det
-000373e0: 6572 6d69 6e69 7374 206d 6574 686f 640d  erminist method.
-000373f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037400: 2020 2020 2073 313d 6f72 675f 7375 7266       s1=org_surf
-00037410: 735b 302c 2028 6e6c 6179 2d31 292d 695d  s[0, (nlay-1)-i]
-00037420: 2e63 6f70 7928 290d 0a20 2020 2020 2020  .copy()..       
-00037430: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037440: 7662 3a0d 0a20 2020 2020 2020 2020 2020  vb:..           
-00037450: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00037460: 6e74 2822 7b7d 3a20 6465 7465 726d 696e  nt("{}: determin
-00037470: 6973 7420 696e 7465 7270 6f6c 6174 696f  ist interpolatio
-00037480: 6e20 6d65 7468 6f64 2c20 7265 7573 6520  n method, reuse 
-00037490: 7468 6520 6669 7273 7420 7375 7266 6163  the first surfac
-000374a0: 6522 2e66 6f72 6d61 7428 6c69 7468 6f2e  e".format(litho.
-000374b0: 6e61 6d65 2929 0d0a 2020 2020 2020 2020  name))..        
-000374c0: 2020 2020 2020 2020 656c 7365 3a0d 0a0d          else:...
-000374d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000374e0: 2020 2020 2023 2063 6861 6e67 6520 6d65       # change me
-000374f0: 616e 2069 6620 7468 6963 6b6e 6573 7320  an if thickness 
-00037500: 6d6f 6465 2069 7320 6163 7469 7661 7465  mode is activate
-00037510: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
-00037520: 2020 2020 2020 2069 6620 2274 6869 636b         if "thick
-00037530: 6e65 7373 2220 696e 206c 6974 686f 2e73  ness" in litho.s
-00037540: 7572 6661 6365 2e64 6963 5f73 7572 662e  urface.dic_surf.
-00037550: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
-00037560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037570: 2069 6620 6c69 7468 6f2e 7375 7266 6163   if litho.surfac
-00037580: 652e 6469 635f 7375 7266 5b22 7468 6963  e.dic_surf["thic
-00037590: 6b6e 6573 7322 5d20 6973 206e 6f74 204e  kness"] is not N
-000375a0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-000375b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375c0: 2020 6966 2069 203d 3d20 303a 0d0a 2020    if i == 0:..  
-000375d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375e0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-000375f0: 7468 6f2e 7375 7266 6163 652e 6469 635f  tho.surface.dic_
-00037600: 7375 7266 5b22 6d65 616e 225d 203d 2041  surf["mean"] = A
-00037610: 7263 6854 6162 6c65 2e62 6f74 202b 206c  rchTable.bot + l
-00037620: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
-00037630: 5f73 7572 665b 2274 6869 636b 6e65 7373  _surf["thickness
-00037640: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-00037650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037660: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00037670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037680: 2020 2020 2020 206c 6974 686f 2e73 7572         litho.sur
-00037690: 6661 6365 2e64 6963 5f73 7572 665b 226d  face.dic_surf["m
-000376a0: 6561 6e22 5d20 3d20 7331 202b 206c 6974  ean"] = s1 + lit
-000376b0: 686f 2e73 7572 6661 6365 2e64 6963 5f73  ho.surface.dic_s
-000376c0: 7572 665b 2274 6869 636b 6e65 7373 225d  urf["thickness"]
-000376d0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-000376e0: 2020 2020 2020 2020 7331 3d69 6e74 6572          s1=inter
-000376f0: 7032 4428 6c69 7468 6f2e 7375 7266 6163  p2D(litho.surfac
-00037700: 652c 2041 7263 6854 6162 6c65 2e67 6574  e, ArchTable.get
-00037710: 5f78 6728 292c 2041 7263 6854 6162 6c65  _xg(), ArchTable
-00037720: 2e67 6574 5f79 6728 292c 2041 7263 6854  .get_yg(), ArchT
-00037730: 6162 6c65 2e78 7532 442c 0d0a 2020 2020  able.xu2D,..    
-00037740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037750: 2020 2020 2020 2020 2020 2020 2073 6565               see
-00037760: 643d 4172 6368 5461 626c 652e 7365 6564  d=ArchTable.seed
-00037770: 202b 206c 6974 686f 2e49 4420 2a20 3165   + litho.ID * 1e
-00037780: 3320 2b20 6972 6561 6c2c 2076 6572 626f  3 + ireal, verbo
-00037790: 7365 3d41 7263 6854 6162 6c65 2e76 6572  se=ArchTable.ver
-000377a0: 626f 7365 2c20 6e63 7075 3d41 7263 6854  bose, ncpu=ArchT
-000377b0: 6162 6c65 2e6e 6370 752c 206d 6173 6b32  able.ncpu, mask2
-000377c0: 443d 6d61 736b 3244 2c0d 0a20 2020 2020  D=mask2D,..     
-000377d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000377e0: 2020 2020 2020 2020 2020 2020 2a2a 6c69              **li
-000377f0: 7468 6f2e 7375 7266 6163 652e 6469 635f  tho.surface.dic_
-00037800: 7375 7266 2920 2320 7369 6d75 6c61 7469  surf) # simulati
-00037810: 6f6e 0d0a 0d0a 2020 2020 2020 2020 2020  on....          
-00037820: 2020 2020 2020 2020 2020 2320 7265 6d6f            # remo
-00037830: 7665 206d 6561 6e0d 0a20 2020 2020 2020  ve mean..       
-00037840: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037850: 2274 6869 636b 6e65 7373 2220 696e 206c  "thickness" in l
-00037860: 6974 686f 2e73 7572 6661 6365 2e64 6963  itho.surface.dic
-00037870: 5f73 7572 662e 6b65 7973 2829 3a0d 0a20  _surf.keys():.. 
-00037880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037890: 2020 2020 2020 2069 6620 6c69 7468 6f2e         if litho.
-000378a0: 7375 7266 6163 652e 6469 635f 7375 7266  surface.dic_surf
-000378b0: 5b22 7468 6963 6b6e 6573 7322 5d20 6973  ["thickness"] is
-000378c0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-000378d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000378e0: 2020 2020 2020 2020 6c69 7468 6f2e 7375          litho.su
-000378f0: 7266 6163 652e 6469 635f 7375 7266 5b22  rface.dic_surf["
-00037900: 6d65 616e 225d 203d 204e 6f6e 650d 0a0d  mean"] = None...
-00037910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037920: 2065 6e64 3d74 696d 652e 7469 6d65 2829   end=time.time()
-00037930: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037940: 2020 6966 2076 623a 0d0a 2020 2020 2020    if vb:..      
-00037950: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00037960: 696e 7428 227b 7d3a 2074 696d 6520 656c  int("{}: time el
-00037970: 6170 7365 6420 666f 7220 636f 6d70 7574  apsed for comput
-00037980: 696e 6720 7375 7266 6163 6520 7b7d 2073  ing surface {} s
-00037990: 222e 666f 726d 6174 286c 6974 686f 2e6e  ".format(litho.n
-000379a0: 616d 652c 2028 656e 6420 2d20 7374 6172  ame, (end - star
-000379b0: 7429 2929 0d0a 0d0a 2020 2020 2020 2020  t)))....        
-000379c0: 2020 2020 2020 2020 2323 2069 6620 6e61          ## if na
-000379d0: 6e20 696e 7369 6465 2074 6865 2064 6f6d  n inside the dom
-000379e0: 6169 6e20 286e 6f6e 2073 696d 756c 6174  ain (non simulat
-000379f0: 6564 2061 7265 6129 202d 2d3e 2073 6574  ed area) --> set
-00037a00: 2076 616c 7565 7320 6672 6f6d 2073 7572   values from sur
-00037a10: 6661 6365 2062 656c 6f77 0d0a 2020 2020  face below..    
-00037a20: 2020 2020 2020 2020 2020 2020 6d61 736b              mask
-00037a30: 5f6e 616e 203d 206e 702e 7a65 726f 7328  _nan = np.zeros(
-00037a40: 5b6e 792c 206e 785d 2c20 6474 7970 653d  [ny, nx], dtype=
-00037a50: 626f 6f6c 290d 0a20 2020 2020 2020 2020  bool)..         
-00037a60: 2020 2020 2020 206d 6173 6b5f 6e61 6e5b         mask_nan[
-00037a70: 6d61 736b 3244 5d20 3d20 6e70 2e69 736e  mask2D] = np.isn
-00037a80: 616e 2873 315b 6d61 736b 3244 5d29 0d0a  an(s1[mask2D])..
-00037a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037aa0: 6966 206d 6173 6b5f 6e61 6e2e 616e 7928  if mask_nan.any(
-00037ab0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00037ac0: 2020 2020 2020 2020 6966 2069 203e 2030          if i > 0
-00037ad0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00037ae0: 2020 2020 2020 2020 2020 2073 315b 6d61             s1[ma
-00037af0: 736b 5f6e 616e 5d20 3d20 6f72 675f 7375  sk_nan] = org_su
-00037b00: 7266 735b 6972 6561 6c2c 2028 6e6c 6179  rfs[ireal, (nlay
-00037b10: 2d31 292d 692b 315d 5b6d 6173 6b5f 6e61  -1)-i+1][mask_na
-00037b20: 6e5d 0d0a 2020 2020 2020 2020 2020 2020  n]..            
-00037b30: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00032de0: 2020 2020 2066 703d 665b 3a2c 6979 2c69       fp=f[:,iy,i
+00032df0: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+00032e00: 2020 2020 2020 2020 6966 2069 7020 3d3d          if ip ==
+00032e10: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+00032e20: 2020 2020 2020 2020 2020 2020 2078 5f73               x_s
+00032e30: 6563 5b3a 2c69 5d3d 6670 0d0a 2020 2020  ec[:,i]=fp..    
+00032e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032e50: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00032e60: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00032e70: 5f73 6563 5f69 5b3a 2c69 5d3d 6670 0d0a  _sec_i[:,i]=fp..
+00032e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032e90: 2020 2020 6920 2b3d 2031 0d0a 2020 2020      i += 1..    
+00032ea0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00032eb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032ec0: 3d30 0d0a 2020 2020 2020 2020 2020 2020  =0..            
+00032ed0: 2020 2020 666f 7220 6f20 696e 206e 702e      for o in np.
+00032ee0: 6172 616e 6765 2830 2c64 6973 742c 6573  arange(0,dist,es
+00032ef0: 7029 3a0d 0a20 2020 2020 2020 2020 2020  p):..           
+00032f00: 2020 2020 2020 2020 2078 5f64 202b 3d20           x_d += 
+00032f10: 6431 2a6c 616d 0d0a 2020 2020 2020 2020  d1*lam..        
+00032f20: 2020 2020 2020 2020 2020 2020 795f 6420              y_d 
+00032f30: 2b3d 2064 322a 6c61 6d0d 0a20 2020 2020  += d2*lam..     
+00032f40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00032f50: 783d 696e 7428 2878 5f64 202d 206f 7829  x=int((x_d - ox)
+00032f60: 2f73 7829 0d0a 2020 2020 2020 2020 2020  /sx)..          
+00032f70: 2020 2020 2020 2020 2020 6979 3d69 6e74            iy=int
+00032f80: 2828 795f 6420 2d20 6f79 292f 7379 290d  ((y_d - oy)/sy).
+00032f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032fa0: 2020 2020 2066 703d 665b 3a2c 6979 2c69       fp=f[:,iy,i
+00032fb0: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
+00032fc0: 2020 2020 2020 2020 6966 2069 7020 3d3d          if ip ==
+00032fd0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+00032fe0: 2020 2020 2020 2020 2020 2020 2078 5f73               x_s
+00032ff0: 6563 5b3a 2c69 2c3a 205d 3d66 700d 0a20  ec[:,i,: ]=fp.. 
+00033000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033010: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00033020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033030: 2020 785f 7365 635f 695b 3a2c 692c 3a20    x_sec_i[:,i,: 
+00033040: 5d3d 6670 0d0a 2020 2020 2020 2020 2020  ]=fp..          
+00033050: 2020 2020 2020 2020 2020 6920 2b3d 2031            i += 1
+00033060: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00033070: 6469 7374 5f74 6f74 202b 3d20 6469 7374  dist_tot += dist
+00033080: 0d0a 2020 2020 2020 2020 2020 2020 2361  ..            #a
+00033090: 7070 656e 6420 7873 6563 7469 6f6e 730d  ppend xsections.
+000330a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000330b0: 6970 203e 2030 3a0d 0a20 2020 2020 2020  ip > 0:..       
+000330c0: 2020 2020 2020 2020 2078 5f73 6563 3d6e           x_sec=n
+000330d0: 702e 636f 6e63 6174 656e 6174 6528 2878  p.concatenate((x
+000330e0: 5f73 6563 2c20 785f 7365 635f 6929 2c20  _sec, x_sec_i), 
+000330f0: 6178 6973 3d31 290d 0a0d 0a20 2020 2020  axis=1)....     
+00033100: 2020 2072 6574 7572 6e20 785f 7365 632c     return x_sec,
+00033110: 2064 6973 745f 746f 740d 0a0d 0a0d 0a0d   dist_tot.......
+00033120: 0a20 2020 2023 2323 2042 5547 2054 4f20  .    ### BUG TO 
+00033130: 434f 5252 4543 540d 0a20 2020 2022 2222  CORRECT..    """
+00033140: 0d0a 2020 2020 426f 7265 686f 6c65 7320  ..    Boreholes 
+00033150: 6170 7065 6172 206d 756c 7469 706c 6520  appear multiple 
+00033160: 7469 6d65 7320 6f6e 2074 6865 2063 726f  times on the cro
+00033170: 7373 2d73 6563 7469 6f6e 2c20 6861 7665  ss-section, have
+00033180: 2074 6f20 7468 696e 6b20 6162 6f75 7420   to think about 
+00033190: 7468 6174 0d0a 2020 2020 2222 220d 0a20  that..    """.. 
+000331a0: 2020 2064 6566 2070 6c6f 745f 6372 6f73     def plot_cros
+000331b0: 735f 7365 6374 696f 6e28 7365 6c66 2c20  s_section(self, 
+000331c0: 705f 6c69 7374 2c20 7479 703d 2275 6e69  p_list, typ="uni
+000331d0: 7473 222c 2061 7272 3d4e 6f6e 652c 2069  ts", arr=None, i
+000331e0: 753d 302c 2069 6661 3d30 2c20 6970 3d30  u=0, ifa=0, ip=0
+000331f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00033200: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00033210: 6f70 6572 7479 3d4e 6f6e 652c 2065 7370  operty=None, esp
+00033220: 3d4e 6f6e 652c 2061 783d 4e6f 6e65 2c20  =None, ax=None, 
+00033230: 636f 6c6f 7262 6172 3d46 616c 7365 2c0d  colorbar=False,.
+00033240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033250: 2020 2020 2020 2020 2020 2020 7261 7469              rati
+00033260: 6f5f 6173 7065 6374 3d32 2c20 693d 302c  o_aspect=2, i=0,
+00033270: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00033280: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+00033290: 745f 6d61 7820 3d20 3130 302c 2077 6964  t_max = 100, wid
+000332a0: 7468 3d2e 352c 0d0a 2020 2020 2020 2020  th=.5,..        
+000332b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000332c0: 2020 2076 6d61 783d 4e6f 6e65 2c20 766d     vmax=None, vm
+000332d0: 696e 3d4e 6f6e 6529 3a0d 0a0d 0a20 2020  in=None):....   
+000332e0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+000332f0: 2020 506c 6f74 2061 2063 726f 7373 2073    Plot a cross s
+00033300: 6563 7469 6f6e 2061 6c6f 6e67 2074 6865  ection along the
+00033310: 2070 6f69 6e74 7320 6769 7665 6e20 696e   points given in
+00033320: 0d0a 2020 2020 2020 2020 705f 6c69 7374  ..        p_list
+00033330: 2077 6974 6820 6120 7370 6163 696e 6720   with a spacing 
+00033340: 6465 6669 6e65 6420 2865 7370 290d 0a0d  defined (esp)...
+00033350: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00033360: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00033370: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00033380: 2070 5f6c 6973 7420 3a20 6c69 7374 206f   p_list : list o
+00033390: 7220 6172 7261 7920 6f66 2074 7570 6c65  r array of tuple
+000333a0: 2063 6f6e 7461 696e 696e 670d 0a20 2020   containing..   
+000333b0: 2020 2020 2020 2020 2020 2020 2078 2061               x a
+000333c0: 6e64 2079 2063 6f6f 7264 696e 6174 6573  nd y coordinates
+000333d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000333e0: 2020 2865 2e67 2e20 705f 6c69 7374 3d5b    (e.g. p_list=[
+000333f0: 2831 3030 2c20 3230 3029 2c20 2833 3030  (100, 200), (300
+00033400: 2c20 3230 3029 5d0d 0a20 2020 2020 2020  , 200)]..       
+00033410: 2020 2020 2020 2020 202d 2d3e 2064 7261           --> dra
+00033420: 7720 6120 6372 6f73 7320 7365 6374 696f  w a cross sectio
+00033430: 6e20 6265 7477 6565 6e20 7468 6573 6520  n between these 
+00033440: 7477 6f20 706f 696e 7473 290d 0a20 2020  two points)..   
+00033450: 2020 2020 2074 7970 3a20 7374 7269 6e67       typ: string
+00033460: 0d0a 2020 2020 2020 2020 2020 2020 756e  ..            un
+00033470: 6974 732c 2066 6163 6965 7320 6f72 2061  its, facies or a
+00033480: 2070 726f 7065 7274 7920 6e61 6d65 0d0a   property name..
+00033490: 2020 2020 2020 2020 6975 3a20 696e 740d          iu: int.
+000334a0: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
+000334b0: 7473 2069 6e64 6578 2072 6561 6c69 7a61  ts index realiza
+000334c0: 7469 6f6e 0d0a 2020 2020 2020 2020 6966  tion..        if
+000334d0: 613a 2069 6e74 0d0a 2020 2020 2020 2020  a: int..        
+000334e0: 2020 2020 6661 6369 6573 2069 6e64 6578      facies index
+000334f0: 2072 6561 6c69 7a61 7469 6f6e 0d0a 2020   realization..  
+00033500: 2020 2020 2020 6970 3a20 696e 740d 0a20        ip: int.. 
+00033510: 2020 2020 2020 2020 2020 2070 726f 7065             prope
+00033520: 7274 7920 696e 6465 7820 7265 616c 697a  rty index realiz
+00033530: 6174 696f 6e0d 0a20 2020 2020 2020 2070  ation..        p
+00033540: 726f 7065 7274 793a 2073 7472 0d0a 2020  roperty: str..  
+00033550: 2020 2020 2020 2020 2020 7072 6f70 6572            proper
+00033560: 7479 206e 616d 6520 7468 6174 2068 6176  ty name that hav
+00033570: 6520 6265 656e 2063 6f6d 7075 7465 640d  e been computed.
+00033580: 0a20 2020 2020 2020 2065 7370 3a20 666c  .        esp: fl
+00033590: 6f61 740d 0a20 2020 2020 2020 2020 2020  oat..           
+000335a0: 2073 7061 6369 6e67 2074 6f20 7573 6520   spacing to use 
+000335b0: 7768 656e 2073 616d 706c 696e 6720 7468  when sampling th
+000335c0: 6520 6172 7261 7920 616c 6f6e 6720 7468  e array along th
+000335d0: 6520 6372 6f73 7320 7365 6374 696f 6e0d  e cross section.
+000335e0: 0a20 2020 2020 2020 2061 783a 206d 6174  .        ax: mat
+000335f0: 706c 6f74 6c69 6220 6178 6573 206f 6e20  plotlib axes on 
+00033600: 7768 6963 6820 746f 2070 6c6f 740d 0a20  which to plot.. 
+00033610: 2020 2020 2020 2072 6174 696f 5f61 7370         ratio_asp
+00033620: 6563 743a 2066 6c6f 6174 0d0a 2020 2020  ect: float..    
+00033630: 2020 2020 2020 2020 7261 7469 6f20 6265          ratio be
+00033640: 7477 6565 6e20 7920 616e 6420 7820 6178  tween y and x ax
+00033650: 6973 2074 6f20 6164 6a75 7374 2076 6572  is to adjust ver
+00033660: 7469 6361 6c20 6578 6167 6765 7261 7469  tical exaggerati
+00033670: 6f6e 0d0a 2020 2020 2020 2020 2222 220d  on..        """.
+00033680: 0a0d 0a20 2020 2020 2020 2069 6620 6178  ...        if ax
+00033690: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+000336a0: 2020 2020 2020 2066 6967 2c20 6178 203d         fig, ax =
+000336b0: 2070 6c74 2e73 7562 706c 6f74 7328 6669   plt.subplots(fi
+000336c0: 6773 697a 653d 2831 302c 2031 3029 290d  gsize=(10, 10)).
+000336d0: 0a0d 0a20 2020 2020 2020 2064 6566 2070  ...        def p
+000336e0: 6c6f 745f 6268 2862 682c 2078 3d4e 6f6e  lot_bh(bh, x=Non
+000336f0: 652c 2077 6964 7468 3d77 6964 7468 2c20  e, width=width, 
+00033700: 7479 703d 2275 6e69 7473 2229 3a0d 0a0d  typ="units"):...
+00033710: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00033720: 7479 7020 3d3d 2022 756e 6974 7322 3a0d  typ == "units":.
+00033730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00033740: 2069 6620 6268 2e6c 6f67 5f73 7472 6174   if bh.log_strat
+00033750: 6920 6973 206e 6f74 204e 6f6e 653a 0d0a  i is not None:..
+00033760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033770: 2020 2020 6966 2078 2069 7320 4e6f 6e65      if x is None
+00033780: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00033790: 2020 2020 2020 2020 2020 2069 7820 3d20             ix = 
+000337a0: 6268 2e78 0d0a 2020 2020 2020 2020 2020  bh.x..          
+000337b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000337c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000337d0: 2020 2020 2020 2020 2069 7820 3d20 780d           ix = x.
+000337e0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000337f0: 2020 2020 2020 2069 203d 202d 310d 0a20         i = -1.. 
+00033800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033810: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00033820: 6528 6c65 6e28 6268 2e6c 6f67 5f73 7472  e(len(bh.log_str
+00033830: 6174 6929 2d31 293a 0d0a 2020 2020 2020  ati)-1):..      
+00033840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033850: 2020 7320 3d20 6268 2e6c 6f67 5f73 7472    s = bh.log_str
+00033860: 6174 695b 695d 5b31 5d0d 0a20 2020 2020  ati[i][1]..     
+00033870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033880: 2020 2075 6e69 7420 3d20 6268 2e6c 6f67     unit = bh.log
+00033890: 5f73 7472 6174 695b 695d 5b30 5d0d 0a0d  _strati[i][0]...
+000338a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000338b0: 2020 2020 2020 2020 2069 6620 6920 3c20           if i < 
+000338c0: 6c65 6e28 6268 2e6c 6f67 5f73 7472 6174  len(bh.log_strat
+000338d0: 6929 3a0d 0a20 2020 2020 2020 2020 2020  i):..           
+000338e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000338f0: 2073 3220 3d20 6268 2e6c 6f67 5f73 7472   s2 = bh.log_str
+00033900: 6174 695b 692b 315d 5b31 5d0d 0a0d 0a20  ati[i+1][1].... 
+00033910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033920: 2020 2020 2020 2069 6620 756e 6974 2069         if unit i
+00033930: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+00033940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033950: 2020 2020 2020 2020 2061 782e 6261 7228           ax.bar(
+00033960: 6978 2c20 7320 2d20 7332 2c20 626f 7474  ix, s - s2, bott
+00033970: 6f6d 3d73 322c 2063 6f6c 6f72 3d75 6e69  om=s2, color=uni
+00033980: 742e 632c 2061 6c70 6861 3d31 2c20 6564  t.c, alpha=1, ed
+00033990: 6765 636f 6c6f 7220 3d20 2762 6c61 636b  gecolor = 'black
+000339a0: 272c 2077 6964 7468 3d77 6964 7468 290d  ', width=width).
+000339b0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000339c0: 2020 2020 2020 2073 203d 2062 682e 6c6f         s = bh.lo
+000339d0: 675f 7374 7261 7469 5b69 2b31 5d5b 315d  g_strati[i+1][1]
+000339e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000339f0: 2020 2020 2020 756e 6974 203d 2062 682e        unit = bh.
+00033a00: 6c6f 675f 7374 7261 7469 5b69 2b31 5d5b  log_strati[i+1][
+00033a10: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00033a20: 2020 2020 2020 2020 7332 203d 2062 682e          s2 = bh.
+00033a30: 7a20 2d20 6268 2e64 6570 7468 0d0a 2020  z - bh.depth..  
+00033a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a50: 2020 6966 2075 6e69 7420 6973 206e 6f74    if unit is not
+00033a60: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00033a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033a80: 6178 2e62 6172 2869 782c 2073 202d 2073  ax.bar(ix, s - s
+00033a90: 322c 2062 6f74 746f 6d3d 7332 2c20 636f  2, bottom=s2, co
+00033aa0: 6c6f 723d 756e 6974 2e63 2c20 616c 7068  lor=unit.c, alph
+00033ab0: 613d 312c 2065 6467 6563 6f6c 6f72 203d  a=1, edgecolor =
+00033ac0: 2027 626c 6163 6b27 2c20 7769 6474 683d   'black', width=
+00033ad0: 7769 6474 6829 0d0a 0d0a 2020 2020 2020  width)....      
+00033ae0: 2020 6966 2074 7970 203d 3d20 2275 6e69    if typ == "uni
+00033af0: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
+00033b00: 2020 6172 723d 7365 6c66 2e67 6574 5f75    arr=self.get_u
+00033b10: 6e69 7473 5f64 6f6d 6169 6e73 5f72 6561  nits_domains_rea
+00033b20: 6c69 7a61 7469 6f6e 7328 6975 3d69 752c  lizations(iu=iu,
+00033b30: 2066 696c 6c3d 2263 6f6c 6f72 222c 2061   fill="color", a
+00033b40: 6c6c 5f64 6174 613d 4661 6c73 6529 0d0a  ll_data=False)..
+00033b50: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
+00033b60: 7970 203d 3d20 2770 726f 6261 5f75 6e69  yp == 'proba_uni
+00033b70: 7473 273a 0d0a 2020 2020 2020 2020 2020  ts':..          
+00033b80: 2020 756e 6974 733d 7365 6c66 2e67 6574    units=self.get
+00033b90: 5f75 6e69 7473 5f64 6f6d 6169 6e73 5f72  _units_domains_r
+00033ba0: 6561 6c69 7a61 7469 6f6e 7328 290d 0a20  ealizations().. 
+00033bb0: 2020 2020 2020 2020 2020 206e 7265 616c             nreal
+00033bc0: 3d75 6e69 7473 2e73 6861 7065 5b30 5d0d  =units.shape[0].
+00033bd0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+00033be0: 3d28 756e 6974 7320 3d3d 2069 292e 7375  =(units == i).su
+00033bf0: 6d28 3029 2f6e 7265 616c 0d0a 2020 2020  m(0)/nreal..    
+00033c00: 2020 2020 2020 2020 6465 6c28 756e 6974          del(unit
+00033c10: 7329 0d0a 0d0a 2020 2020 2020 2020 656c  s)....        el
+00033c20: 6966 2074 7970 203d 3d20 2770 726f 6261  if typ == 'proba
+00033c30: 5f66 6163 6965 7327 3a0d 0a20 2020 2020  _facies':..     
+00033c40: 2020 2020 2020 2066 6163 6965 733d 7365         facies=se
+00033c50: 6c66 2e67 6574 5f66 6163 6965 7328 290d  lf.get_facies().
+00033c60: 0a20 2020 2020 2020 2020 2020 206e 7265  .            nre
+00033c70: 616c 3d66 6163 6965 732e 7368 6170 655b  al=facies.shape[
+00033c80: 305d 202a 2066 6163 6965 732e 7368 6170  0] * facies.shap
+00033c90: 655b 315d 0d0a 2020 2020 2020 2020 2020  e[1]..          
+00033ca0: 2020 6172 723d 2866 6163 6965 7320 3d3d    arr=(facies ==
+00033cb0: 2069 292e 7375 6d28 3029 2e73 756d 2830   i).sum(0).sum(0
+00033cc0: 2920 2f6e 7265 616c 0d0a 2020 2020 2020  ) /nreal..      
+00033cd0: 2020 2020 2020 6465 6c28 6661 6369 6573        del(facies
+00033ce0: 290d 0a20 2020 2020 2020 2020 2020 200d  )..            .
+00033cf0: 0a20 2020 2020 2020 2065 6c69 6620 7479  .        elif ty
+00033d00: 7020 3d3d 2266 6163 6965 7322 3a0d 0a20  p =="facies":.. 
+00033d10: 2020 2020 2020 2020 2020 2061 7272 3d73             arr=s
+00033d20: 656c 662e 6765 745f 6661 6369 6573 2869  elf.get_facies(i
+00033d30: 752c 2069 6661 2c20 616c 6c5f 6461 7461  u, ifa, all_data
+00033d40: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
+00033d50: 2020 2020 2023 6368 616e 6765 2076 616c       #change val
+00033d60: 7565 7320 746f 2068 6176 6520 636f 6c6f  ues to have colo
+00033d70: 7273 2064 6972 6563 746c 790d 0a20 2020  rs directly..   
+00033d80: 2020 2020 2020 2020 206e 6577 5f61 7272           new_arr
+00033d90: 3d6e 702e 7a65 726f 7328 5b61 7272 2e73  =np.zeros([arr.s
+00033da0: 6861 7065 5b30 5d2c 2061 7272 2e73 6861  hape[0], arr.sha
+00033db0: 7065 5b31 5d2c 2061 7272 2e73 6861 7065  pe[1], arr.shape
+00033dc0: 5b32 5d2c 2034 5d29 0d0a 2020 2020 2020  [2], 4])..      
+00033dd0: 2020 2020 2020 6c69 7374 5f66 613d 6e70        list_fa=np
+00033de0: 2e75 6e69 7175 6528 6172 7229 0d0a 2020  .unique(arr)..  
+00033df0: 2020 2020 2020 2020 2020 666f 7220 4944            for ID
+00033e00: 6661 2069 6e20 6c69 7374 5f66 613a 0d0a  fa in list_fa:..
+00033e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e20: 6966 2049 4466 6120 213d 2030 3a0d 0a20  if IDfa != 0:.. 
+00033e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033e40: 2020 2066 613d 7365 6c66 2e67 6574 5f66     fa=self.get_f
+00033e50: 6163 6965 735f 6f62 6a28 4944 3d49 4466  acies_obj(ID=IDf
+00033e60: 612c 2074 7970 653d 2249 4422 2920 2023  a, type="ID")  #
+00033e70: 2067 6574 2066 6163 6965 7320 6f62 6a65   get facies obje
+00033e80: 6374 0d0a 2020 2020 2020 2020 2020 2020  ct..            
+00033e90: 2020 2020 2020 2020 6d61 736b 3d28 6172          mask=(ar
+00033ea0: 7220 3d3d 2049 4466 6129 0d0a 2020 2020  r == IDfa)..    
+00033eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033ec0: 6e65 775f 6172 725b 6d61 736b 2c3a 205d  new_arr[mask,: ]
+00033ed0: 3d63 6f6c 6f72 732e 746f 5f72 6762 6128  =colors.to_rgba(
+00033ee0: 6661 2e63 290d 0a20 2020 2020 2020 2020  fa.c)..         
+00033ef0: 2020 2061 7272 3d6e 6577 5f61 7272 0d0a     arr=new_arr..
+00033f00: 0d0a 2020 2020 2020 2020 656c 6966 2074  ..        elif t
+00033f10: 7970 203d 3d22 7072 6f70 223a 0d0a 2020  yp =="prop":..  
+00033f20: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00033f30: 2069 7369 6e73 7461 6e63 6528 7072 6f70   isinstance(prop
+00033f40: 6572 7479 2c20 7374 7229 2c20 2270 726f  erty, str), "pro
+00033f50: 7065 7274 7920 7368 6f75 6c64 2062 6520  perty should be 
+00033f60: 6769 7665 6e20 696e 2061 2070 726f 7065  given in a prope
+00033f70: 7274 7920 6e61 6d65 202d 2d3e 2073 7472  rty name --> str
+00033f80: 696e 6722 0d0a 2020 2020 2020 2020 2020  ing"..          
+00033f90: 2020 6172 723d 7365 6c66 2e67 6574 5f70    arr=self.get_p
+00033fa0: 726f 7028 7072 6f70 6572 7479 2c20 6975  rop(property, iu
+00033fb0: 2c20 6966 612c 2069 702c 2061 6c6c 5f64  , ifa, ip, all_d
+00033fc0: 6174 613d 4661 6c73 6529 0d0a 0d0a 2020  ata=False)....  
+00033fd0: 2020 2020 2020 656c 6966 2074 7970 203d        elif typ =
+00033fe0: 3d22 656e 7472 6f70 795f 756e 6974 7322  ="entropy_units"
+00033ff0: 3a0d 0a20 2020 2020 2020 2020 2020 2075  :..            u
+00034000: 6e69 7473 3d73 656c 662e 6765 745f 756e  nits=self.get_un
+00034010: 6974 735f 646f 6d61 696e 735f 7265 616c  its_domains_real
+00034020: 697a 6174 696f 6e73 2829 0d0a 2020 2020  izations()..    
+00034030: 2020 2020 2020 2020 5345 3d6e 702e 7a65          SE=np.ze
+00034040: 726f 7328 7365 6c66 2e6d 6173 6b2e 7368  ros(self.mask.sh
+00034050: 6170 6529 2020 2320 7368 616e 6e6f 6e20  ape)  # shannon 
+00034060: 656e 7472 6f70 790d 0a20 2020 2020 2020  entropy..       
+00034070: 2020 2020 2062 3d6c 656e 2873 656c 662e       b=len(self.
+00034080: 6765 745f 616c 6c5f 756e 6974 7328 2929  get_all_units())
+00034090: 0d0a 2020 2020 2020 2020 2020 2020 6e72  ..            nr
+000340a0: 6561 6c3d 756e 6974 732e 7368 6170 655b  eal=units.shape[
+000340b0: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+000340c0: 666f 7220 756e 6974 2069 6e20 7365 6c66  for unit in self
+000340d0: 2e67 6574 5f61 6c6c 5f75 6e69 7473 2829  .get_all_units()
+000340e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000340f0: 2020 2023 2070 7269 6e74 2875 6e69 7429     # print(unit)
+00034100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00034110: 2020 5069 3d28 756e 6974 733d 3d75 6e69    Pi=(units==uni
+00034120: 742e 4944 292e 7375 6d28 3029 2f6e 7265  t.ID).sum(0)/nre
+00034130: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+00034140: 2020 2020 7069 5f6d 6173 6b3d 2873 656c      pi_mask=(sel
+00034150: 662e 6d61 736b 2920 2620 2850 6921 3d30  f.mask) & (Pi!=0
+00034160: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00034170: 2020 2053 455b 7069 5f6d 6173 6b5d 202b     SE[pi_mask] +
+00034180: 3d20 5069 5b70 695f 6d61 736b 5d2a 286e  = Pi[pi_mask]*(n
+00034190: 702e 6c6f 6728 5069 5b70 695f 6d61 736b  p.log(Pi[pi_mask
+000341a0: 5d29 2f6e 702e 6c6f 6728 6229 290d 0a20  ])/np.log(b)).. 
+000341b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000341c0: 7272 3d2d 5345 0d0a 2020 2020 2020 2020  rr=-SE..        
+000341d0: 2020 2020 6172 725b 7e73 656c 662e 6d61      arr[~self.ma
+000341e0: 736b 5d3d 6e70 2e6e 616e 0d0a 2020 2020  sk]=np.nan..    
+000341f0: 2020 2020 2020 2020 6465 6c28 756e 6974          del(unit
+00034200: 7329 0d0a 0d0a 2020 2020 2020 2020 656c  s)....        el
+00034210: 6966 2074 7970 203d 3d20 2265 6e74 726f  if typ == "entro
+00034220: 7079 5f66 6163 6965 7322 3a0d 0a20 2020  py_facies":..   
+00034230: 2020 2020 2020 2020 2066 6163 6965 735f           facies_
+00034240: 646f 6d61 696e 733d 7365 6c66 2e67 6574  domains=self.get
+00034250: 5f66 6163 6965 7328 292e 7265 7368 6170  _facies().reshap
+00034260: 6528 2d31 2c20 7365 6c66 2e6e 7a2c 2073  e(-1, self.nz, s
+00034270: 656c 662e 6e79 2c20 7365 6c66 2e6e 7829  elf.ny, self.nx)
+00034280: 0d0a 2020 2020 2020 2020 2020 2020 5345  ..            SE
+00034290: 3d6e 702e 7a65 726f 7328 7365 6c66 2e6d  =np.zeros(self.m
+000342a0: 6173 6b2e 7368 6170 6529 2020 2320 7368  ask.shape)  # sh
+000342b0: 616e 6e6f 6e20 656e 7472 6f70 790d 0a20  annon entropy.. 
+000342c0: 2020 2020 2020 2020 2020 2062 3d6c 656e             b=len
+000342d0: 2873 656c 662e 6765 745f 616c 6c5f 6661  (self.get_all_fa
+000342e0: 6369 6573 2829 290d 0a20 2020 2020 2020  cies())..       
+000342f0: 2020 2020 206e 7265 616c 3d66 6163 6965       nreal=facie
+00034300: 735f 646f 6d61 696e 732e 7368 6170 655b  s_domains.shape[
+00034310: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00034320: 666f 7220 6661 6369 6573 2069 6e20 7365  for facies in se
+00034330: 6c66 2e67 6574 5f61 6c6c 5f66 6163 6965  lf.get_all_facie
+00034340: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
+00034350: 2020 2020 2020 5069 3d28 6661 6369 6573        Pi=(facies
+00034360: 5f64 6f6d 6169 6e73 3d3d 6661 6369 6573  _domains==facies
+00034370: 2e49 4429 2e73 756d 2830 292f 6e72 6561  .ID).sum(0)/nrea
+00034380: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+00034390: 2020 2070 695f 6d61 736b 3d28 7365 6c66     pi_mask=(self
+000343a0: 2e6d 6173 6b29 2026 2028 5069 213d 3029  .mask) & (Pi!=0)
+000343b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000343c0: 2020 5345 5b70 695f 6d61 736b 5d20 2b3d    SE[pi_mask] +=
+000343d0: 2050 695b 7069 5f6d 6173 6b5d 2a28 6e70   Pi[pi_mask]*(np
+000343e0: 2e6c 6f67 2850 695b 7069 5f6d 6173 6b5d  .log(Pi[pi_mask]
+000343f0: 292f 6e70 2e6c 6f67 2862 2929 0d0a 2020  )/np.log(b))..  
+00034400: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00034410: 723d 2d53 450d 0a20 2020 2020 2020 2020  r=-SE..         
+00034420: 2020 2061 7272 5b7e 7365 6c66 2e6d 6173     arr[~self.mas
+00034430: 6b5d 3d6e 702e 6e61 6e0d 0a20 2020 2020  k]=np.nan..     
+00034440: 2020 2020 2020 2064 656c 2866 6163 6965         del(facie
+00034450: 735f 646f 6d61 696e 7329 0d0a 0d0a 2020  s_domains)....  
+00034460: 2020 2020 2020 656c 6966 2074 7970 203d        elif typ =
+00034470: 3d22 6172 7222 3a0d 0a20 2020 2020 2020  ="arr":..       
+00034480: 2020 2020 2070 6173 730d 0a20 2020 2020       pass..     
+00034490: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000344a0: 2020 2020 2020 6173 7365 7274 2027 5479        assert 'Ty
+000344b0: 7020 756e 6b6e 6f77 6e27 0d0a 2020 2020  p unknown'..    
+000344c0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
+000344d0: 0d0a 2020 2020 2020 2020 2365 7874 7261  ..        #extra
+000344e0: 6374 2063 726f 7373 2073 6563 7469 6f6e  ct cross section
+000344f0: 0d0a 2020 2020 2020 2020 7873 6563 2c20  ..        xsec, 
+00034500: 6469 7374 3d73 656c 662e 6372 6f73 735f  dist=self.cross_
+00034510: 7365 6374 696f 6e28 6172 722c 2070 5f6c  section(arr, p_l
+00034520: 6973 742c 2065 7370 3d65 7370 290d 0a0d  ist, esp=esp)...
+00034530: 0a20 2020 2020 2020 2065 7874 656e 743d  .        extent=
+00034540: 5b30 2c20 6469 7374 2c20 7365 6c66 2e67  [0, dist, self.g
+00034550: 6574 5f6f 7a28 292c 2073 656c 662e 6765  et_oz(), self.ge
+00034560: 745f 7a67 2829 5b2d 315d 5d0d 0a20 2020  t_zg()[-1]]..   
+00034570: 2020 2020 2061 3d61 782e 696d 7368 6f77       a=ax.imshow
+00034580: 2878 7365 632c 206f 7269 6769 6e3d 226c  (xsec, origin="l
+00034590: 6f77 6572 222c 2065 7874 656e 743d 6578  ower", extent=ex
+000345a0: 7465 6e74 2c20 696e 7465 7270 6f6c 6174  tent, interpolat
+000345b0: 696f 6e3d 226e 6f6e 6522 2c20 766d 6178  ion="none", vmax
+000345c0: 3d76 6d61 782c 2076 6d69 6e3d 766d 696e  =vmax, vmin=vmin
+000345d0: 290d 0a20 2020 2020 2020 2069 6620 636f  )..        if co
+000345e0: 6c6f 7262 6172 3a0d 0a20 2020 2020 2020  lorbar:..       
+000345f0: 2020 2020 2070 6c74 2e63 6f6c 6f72 6261       plt.colorba
+00034600: 7228 612c 2061 783d 6178 2c20 6f72 6965  r(a, ax=ax, orie
+00034610: 6e74 6174 696f 6e3d 2768 6f72 697a 6f6e  ntation='horizon
+00034620: 7461 6c27 290d 0a20 2020 2020 2020 2061  tal')..        a
+00034630: 782e 7365 745f 6173 7065 6374 2861 6273  x.set_aspect(abs
+00034640: 2828 6578 7465 6e74 5b31 5d2d 6578 7465  ((extent[1]-exte
+00034650: 6e74 5b30 5d29 2f28 6578 7465 6e74 5b33  nt[0])/(extent[3
+00034660: 5d2d 6578 7465 6e74 5b32 5d29 292f 7261  ]-extent[2]))/ra
+00034670: 7469 6f5f 6173 7065 6374 290d 0a0d 0a20  tio_aspect).... 
+00034680: 2020 2020 2020 2064 656c 2861 7272 290d         del(arr).
+00034690: 0a0d 0a20 2020 2020 2020 2023 6765 7420  ...        #get 
+000346a0: 626f 7265 686f 6c65 730d 0a20 2020 2020  boreholes..     
+000346b0: 2020 2064 6973 745f 746f 7420 3d20 300d     dist_tot = 0.
+000346c0: 0a20 2020 2020 2020 2066 6f72 2069 7020  .        for ip 
+000346d0: 696e 2072 616e 6765 286c 656e 2870 5f6c  in range(len(p_l
+000346e0: 6973 7429 2d31 293a 0d0a 0d0a 2020 2020  ist)-1):....    
+000346f0: 2020 2020 2020 2020 7031 203d 2070 5f6c          p1 = p_l
+00034700: 6973 745b 6970 5d0d 0a20 2020 2020 2020  ist[ip]..       
+00034710: 2020 2020 2070 3220 3d20 705f 6c69 7374       p2 = p_list
+00034720: 5b69 702b 315d 0d0a 2020 2020 2020 2020  [ip+1]..        
+00034730: 2020 2020 786d 696e 203d 206d 696e 2870      xmin = min(p
+00034740: 315b 305d 2c20 7032 5b30 5d29 0d0a 2020  1[0], p2[0])..  
+00034750: 2020 2020 2020 2020 2020 786d 6178 203d            xmax =
+00034760: 206d 6178 2870 315b 305d 2c20 7032 5b30   max(p1[0], p2[0
+00034770: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00034780: 4c78 203d 2078 6d61 7820 2d20 786d 696e  Lx = xmax - xmin
+00034790: 0d0a 2020 2020 2020 2020 2020 2020 786d  ..            xm
+000347a0: 696e 202d 3d20 6d61 7828 302e 322a 4c78  in -= max(0.2*Lx
+000347b0: 2c20 6469 7374 5f6d 6178 2f32 290d 0a20  , dist_max/2).. 
+000347c0: 2020 2020 2020 2020 2020 2078 6d61 7820             xmax 
+000347d0: 2b3d 206d 6178 2830 2e32 2a4c 782c 2064  += max(0.2*Lx, d
+000347e0: 6973 745f 6d61 782f 3229 0d0a 0d0a 2020  ist_max/2)....  
+000347f0: 2020 2020 2020 2020 2020 796d 696e 203d            ymin =
+00034800: 206d 696e 2870 315b 315d 2c20 7032 5b31   min(p1[1], p2[1
+00034810: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00034820: 796d 6178 203d 206d 6178 2870 315b 315d  ymax = max(p1[1]
+00034830: 2c20 7032 5b31 5d29 0d0a 2020 2020 2020  , p2[1])..      
+00034840: 2020 2020 2020 4c79 203d 2079 6d61 7820        Ly = ymax 
+00034850: 2d20 796d 696e 0d0a 2020 2020 2020 2020  - ymin..        
+00034860: 2020 2020 796d 696e 202d 3d20 6d61 7828      ymin -= max(
+00034870: 302e 322a 4c79 2c20 6469 7374 5f6d 6178  0.2*Ly, dist_max
+00034880: 2f32 290d 0a20 2020 2020 2020 2020 2020  /2)..           
+00034890: 2079 6d61 7820 2b3d 206d 6178 2830 2e32   ymax += max(0.2
+000348a0: 2a4c 792c 2064 6973 745f 6d61 782f 3229  *Ly, dist_max/2)
+000348b0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000348c0: 2320 7365 6c65 6374 2062 6820 696e 7369  # select bh insi
+000348d0: 6465 2070 3120 616e 6420 7032 0d0a 2020  de p1 and p2..  
+000348e0: 2020 2020 2020 2020 2020 7365 6c5f 6268            sel_bh
+000348f0: 7320 3d20 5b62 6820 666f 7220 6268 2069  s = [bh for bh i
+00034900: 6e20 7365 6c66 2e6c 6973 745f 6268 7320  n self.list_bhs 
+00034910: 6966 2062 682e 7820 3e20 786d 696e 2061  if bh.x > xmin a
+00034920: 6e64 2062 682e 7820 3c20 786d 6178 2061  nd bh.x < xmax a
+00034930: 6e64 2062 682e 7920 3e20 796d 696e 2061  nd bh.y > ymin a
+00034940: 6e64 2062 682e 7920 3c20 796d 6178 5d0d  nd bh.y < ymax].
+00034950: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00034960: 2063 6f6d 7075 7465 2064 6973 7420 6f66   compute dist of
+00034970: 2073 656c 5f62 6873 2074 6f20 6c69 6e65   sel_bhs to line
+00034980: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00034990: 2320 7072 6f6a 2062 6873 0d0a 2020 2020  # proj bhs..    
+000349a0: 2020 2020 2020 2020 666f 7220 6268 2069          for bh i
+000349b0: 6e20 7365 6c5f 6268 733a 0d0a 2020 2020  n sel_bhs:..    
+000349c0: 2020 2020 2020 2020 2020 2020 6120 3d20              a = 
+000349d0: 7032 5b30 5d20 2d20 7031 5b30 5d0d 0a20  p2[0] - p1[0].. 
+000349e0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000349f0: 203d 2070 325b 315d 202d 2070 315b 315d   = p2[1] - p1[1]
+00034a00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00034a10: 2020 785f 7072 6f6a 203d 2028 612a 2a32    x_proj = (a**2
+00034a20: 202a 2062 682e 7820 2b20 622a 2a32 202a   * bh.x + b**2 *
+00034a30: 2070 325b 305d 202b 2061 202a 2062 202a   p2[0] + a * b *
+00034a40: 2028 6268 2e79 202d 2070 325b 315d 2929   (bh.y - p2[1]))
+00034a50: 202f 2028 612a 2a32 202b 2062 2a2a 3229   / (a**2 + b**2)
+00034a60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00034a70: 2020 795f 7072 6f6a 203d 2028 6220 2a20    y_proj = (b * 
+00034a80: 785f 7072 6f6a 202d 2062 202a 2070 325b  x_proj - b * p2[
+00034a90: 305d 202b 2061 202a 2070 325b 315d 2920  0] + a * p2[1]) 
+00034aa0: 2f20 610d 0a0d 0a20 2020 2020 2020 2020  / a....         
+00034ab0: 2020 2020 2020 2064 6973 745f 6c69 6e65         dist_line
+00034ac0: 203d 2028 2862 682e 7820 2d20 785f 7072   = ((bh.x - x_pr
+00034ad0: 6f6a 2920 2a2a 2032 202b 2028 6268 2e79  oj) ** 2 + (bh.y
+00034ae0: 202d 2079 5f70 726f 6a29 202a 2a20 3229   - y_proj) ** 2)
+00034af0: 2a2a 302e 350d 0a0d 0a20 2020 2020 2020  **0.5....       
+00034b00: 2020 2020 2020 2020 2069 6620 6469 7374           if dist
+00034b10: 5f6c 696e 6520 3c20 6469 7374 5f6d 6178  _line < dist_max
+00034b20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00034b30: 2020 2020 2020 2064 6973 7420 3d20 2828         dist = ((
+00034b40: 785f 7072 6f6a 202d 2070 315b 305d 2920  x_proj - p1[0]) 
+00034b50: 2a2a 2032 202b 2028 795f 7072 6f6a 202d  ** 2 + (y_proj -
+00034b60: 2070 315b 315d 2920 2a2a 2032 292a 2a30   p1[1]) ** 2)**0
+00034b70: 2e35 0d0a 2020 2020 2020 2020 2020 2020  .5..            
+00034b80: 2020 2020 2020 2020 6469 7374 5f74 6f5f          dist_to_
+00034b90: 706c 6f74 203d 2064 6973 745f 746f 7420  plot = dist_tot 
+00034ba0: 2b20 6469 7374 2020 2320 6469 7374 616e  + dist  # distan
+00034bb0: 6365 2077 6865 7265 2074 6f20 706c 6f74  ce where to plot
+00034bc0: 2074 6865 2062 680d 0a0d 0a20 2020 2020   the bh....     
+00034bd0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00034be0: 2070 6c6f 7420 6268 0d0a 2020 2020 2020   plot bh..      
+00034bf0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00034c00: 2074 7970 203d 3d20 2275 6e69 7473 223a   typ == "units":
+00034c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00034c20: 2020 2020 2020 2020 2020 706c 6f74 5f62            plot_b
+00034c30: 6828 6268 2c20 6469 7374 5f74 6f5f 706c  h(bh, dist_to_pl
+00034c40: 6f74 290d 0a0d 0a20 2020 2020 2020 2020  ot)....         
+00034c50: 2020 2023 2069 6e63 7265 6d65 6e74 2074     # increment t
+00034c60: 6f74 616c 2064 6973 7461 6e63 650d 0a20  otal distance.. 
+00034c70: 2020 2020 2020 2020 2020 2064 6973 745f             dist_
+00034c80: 706f 696e 7473 203d 2028 2870 325b 305d  points = ((p2[0]
+00034c90: 202d 2070 315b 305d 2920 2a2a 2032 202b   - p1[0]) ** 2 +
+00034ca0: 2028 7032 5b31 5d20 2d20 7031 5b31 5d29   (p2[1] - p1[1])
+00034cb0: 202a 2a20 3229 2a2a 302e 350d 0a20 2020   ** 2)**0.5..   
+00034cc0: 2020 2020 2020 2020 2064 6973 745f 746f           dist_to
+00034cd0: 7420 2b3d 2064 6973 745f 706f 696e 7473  t += dist_points
+00034ce0: 0d0a 0d0a 0d0a 2020 2020 6465 6620 706c  ......    def pl
+00034cf0: 6f74 5f6c 696e 6573 2873 656c 662c 206c  ot_lines(self, l
+00034d00: 6973 745f 6c69 6e65 732c 206e 616d 6573  ist_lines, names
+00034d10: 3d4e 6f6e 652c 2061 783d 4e6f 6e65 2c20  =None, ax=None, 
+00034d20: 6c65 6765 6e64 3d54 7275 6529 3a0d 0a0d  legend=True):...
+00034d30: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00034d40: 2020 2020 2020 506c 6f74 2063 726f 7373        Plot cross
+00034d50: 2d73 6563 7469 6f6e 7320 6c69 6e65 7320  -sections lines 
+00034d60: 6769 7665 6e20 696e 2020 7468 650d 0a20  given in  the.. 
+00034d70: 2020 2020 2020 2022 6c69 7374 5f6c 696e         "list_lin
+00034d80: 6573 2220 6172 6775 6d65 6e74 206f 6e20  es" argument on 
+00034d90: 6120 3244 2074 6f70 2076 6965 7720 6f66  a 2D top view of
+00034da0: 2074 6865 2064 6f6d 6169 6e0d 0a0d 0a20   the domain.... 
+00034db0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00034dc0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00034dd0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206c  -----..        l
+00034de0: 6973 745f 6c69 6e65 733a 2073 6571 656e  ist_lines: seqen
+00034df0: 6365 206f 6620 706f 696e 7473 0d0a 2020  ce of points..  
+00034e00: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00034e10: 7374 206f 6620 706f 696e 7473 2064 6566  st of points def
+00034e20: 696e 696e 6720 7468 6520 6372 6f73 732d  ining the cross-
+00034e30: 7365 6374 696f 6e0d 0a20 2020 2020 2020  section..       
+00034e40: 2020 2020 2020 2020 206c 696e 6573 2e20           lines. 
+00034e50: 4561 6368 2070 6f69 6e74 2069 7320 6120  Each point is a 
+00034e60: 6c69 7374 206f 6620 3220 666c 6f61 7473  list of 2 floats
+00034e70: 205b 782c 2079 5d0d 0a20 2020 2020 2020   [x, y]..       
+00034e80: 206e 616d 6573 3a20 7365 7175 656e 6365   names: sequence
+00034e90: 206f 6620 7374 7269 6e67 0d0a 2020 2020   of string..    
+00034ea0: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+00034eb0: 206f 6620 6e61 6d65 7320 746f 2067 6976   of names to giv
+00034ec0: 6520 746f 2074 6865 2063 726f 7373 2d73  e to the cross-s
+00034ed0: 6563 7469 6f6e 206c 696e 6573 0d0a 2020  ection lines..  
+00034ee0: 2020 2020 2020 6178 3a20 6d61 7470 6c6f        ax: matplo
+00034ef0: 746c 6962 2061 7869 730d 0a20 2020 2020  tlib axis..     
+00034f00: 2020 2020 2020 2020 2020 2061 7869 7320             axis 
+00034f10: 6f6e 2077 6869 6368 2074 6f20 706c 6f74  on which to plot
+00034f20: 2074 6865 2063 726f 7373 2d73 6563 7469   the cross-secti
+00034f30: 6f6e 0d0a 2020 2020 2020 2020 6c65 6765  on..        lege
+00034f40: 6e64 3a20 626f 6f6c 0d0a 2020 2020 2020  nd: bool..      
+00034f50: 2020 2020 2020 2020 2020 6966 2054 7275            if Tru
+00034f60: 652c 2070 6c6f 7420 6120 6c65 6765 6e64  e, plot a legend
+00034f70: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00034f80: 0a20 2020 2020 2020 2069 6620 6178 2069  .        if ax i
+00034f90: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00034fa0: 2020 2020 2066 6967 2c20 6178 3d70 6c74       fig, ax=plt
+00034fb0: 2e73 7562 706c 6f74 7328 290d 0a0d 0a20  .subplots().... 
+00034fc0: 2020 2020 2020 206f 783d 7365 6c66 2e6f         ox=self.o
+00034fd0: 780d 0a20 2020 2020 2020 206f 793d 7365  x..        oy=se
+00034fe0: 6c66 2e6f 790d 0a20 2020 2020 2020 2078  lf.oy..        x
+00034ff0: 313d 7365 6c66 2e78 675b 2d31 5d0d 0a20  1=self.xg[-1].. 
+00035000: 2020 2020 2020 2079 313d 7365 6c66 2e79         y1=self.y
+00035010: 675b 2d31 5d0d 0a20 2020 2020 2020 2061  g[-1]..        a
+00035020: 782e 706c 6f74 2828 6f78 2c20 6f78 2c20  x.plot((ox, ox, 
+00035030: 7831 2c20 7831 2c20 6f78 292c 286f 792c  x1, x1, ox),(oy,
+00035040: 2079 312c 2079 312c 206f 792c 206f 7929   y1, y1, oy, oy)
+00035050: 2c20 633d 226b 2229 2023 706c 6f74 2064  , c="k") #plot d
+00035060: 6f6d 6169 6e0d 0a20 2020 2020 2020 2061  omain..        a
+00035070: 782e 7365 745f 6173 7065 6374 2822 6571  x.set_aspect("eq
+00035080: 7561 6c22 290d 0a0d 0a20 2020 2020 2020  ual")....       
+00035090: 2069 3d31 0d0a 2020 2020 2020 2020 666f   i=1..        fo
+000350a0: 7220 6c69 6e65 2069 6e20 6c69 7374 5f6c  r line in list_l
+000350b0: 696e 6573 3a0d 0a20 2020 2020 2020 2020  ines:..         
+000350c0: 2020 2069 6620 6e61 6d65 7320 6973 204e     if names is N
+000350d0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+000350e0: 2020 2020 2020 6c61 6265 6c3d 2263 726f        label="cro
+000350f0: 7373 2022 202b 2073 7472 2869 290d 0a20  ss " + str(i).. 
+00035100: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00035110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00035120: 2020 6c61 6265 6c3d 6e61 6d65 735b 692d    label=names[i-
+00035130: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+00035140: 6c69 6e65 3d6e 702e 6172 7261 7928 6c69  line=np.array(li
+00035150: 6e65 290d 0a20 2020 2020 2020 2020 2020  ne)..           
+00035160: 2061 782e 706c 6f74 286c 696e 655b 3a2c   ax.plot(line[:,
+00035170: 305d 2c20 6c69 6e65 5b3a 2c31 5d2c 206c  0], line[:,1], l
+00035180: 6162 656c 3d6c 6162 656c 290d 0a20 2020  abel=label)..   
+00035190: 2020 2020 2020 2020 2069 202b 3d20 310d           i += 1.
+000351a0: 0a0d 0a20 2020 2020 2020 2069 6620 6c65  ...        if le
+000351b0: 6765 6e64 3a0d 0a20 2020 2020 2020 2020  gend:..         
+000351c0: 2020 2061 782e 6c65 6765 6e64 2829 0d0a     ax.legend()..
+000351d0: 0d0a 0d0a 2320 434c 4153 5345 5320 5049  ....# CLASSES PI
+000351e0: 4c45 202b 2055 4e49 5420 2b20 5355 5246  LE + UNIT + SURF
+000351f0: 4143 450d 0a63 6c61 7373 2050 696c 6528  ACE..class Pile(
+00035200: 293a 0d0a 0d0a 2020 2020 2222 220d 0a20  ):....    """.. 
+00035210: 2020 2054 6869 7320 636c 6173 7320 6973     This class is
+00035220: 2061 206d 616a 6f72 206f 626a 6563 7420   a major object 
+00035230: 7468 6520 5374 7261 7469 6772 6170 6869  the Stratigraphi
+00035240: 6320 5069 6c65 2028 5350 292e 0d0a 2020  c Pile (SP)...  
+00035250: 2020 4974 2063 6f6e 7461 696e 7320 616c    It contains al
+00035260: 6c20 7468 6520 756e 6974 7320 6f62 6a65  l the units obje
+00035270: 6374 730d 0a20 2020 2061 6e64 2061 6c6c  cts..    and all
+00035280: 6f77 2074 6f20 6b6e 6f77 2074 6865 2073  ow to know the s
+00035290: 7472 6174 6967 7261 7068 6963 616c 2072  tratigraphical r
+000352a0: 656c 6174 696f 6e73 2062 6574 7765 656e  elations between
+000352b0: 2074 6865 2075 6e69 7473 2e0d 0a20 2020   the units...   
+000352c0: 204f 6e65 2050 696c 6520 6f62 6a65 6374   One Pile object
+000352d0: 206d 7573 7420 6265 2064 6566 696e 6564   must be defined
+000352e0: 2066 6f72 2065 6163 6820 7375 6270 696c   for each subpil
+000352f0: 6520 2b20 3120 226d 6173 7465 7222 2070  e + 1 "master" p
+00035300: 696c 652e 0d0a 0d0a 2020 2020 5061 7261  ile.....    Para
+00035310: 6d65 7465 7273 0d0a 2020 2020 2d2d 2d2d  meters..    ----
+00035320: 2d2d 2d2d 2d2d 0d0a 2020 2020 6e61 6d65  ------..    name
+00035330: 3a20 7374 720d 0a20 2020 2020 2020 206e  : str..        n
+00035340: 616d 6520 6f66 2074 6865 2070 696c 650d  ame of the pile.
+00035350: 0a20 2020 206e 6174 7572 653a 2073 7472  .    nature: str
+00035360: 0d0a 2020 2020 2020 2020 756e 6974 7320  ..        units 
+00035370: 7479 7065 206f 6620 696e 7465 7270 6f6c  type of interpol
+00035380: 6174 696f 6e2c 2063 616e 2062 6520 2273  ation, can be "s
+00035390: 7572 6661 6365 7322 206f 7220 2233 645f  urfaces" or "3d_
+000353a0: 6361 7465 676f 7269 6361 6c22 0d0a 2020  categorical"..  
+000353b0: 2020 2020 2020 6966 2022 7375 7266 6163        if "surfac
+000353c0: 6573 2220 6973 2063 686f 7365 6e20 2864  es" is chosen (d
+000353d0: 6566 6175 6c74 292c 2032 4420 7375 7266  efault), 2D surf
+000353e0: 6163 6573 2069 6e74 6572 706f 6c61 7469  aces interpolati
+000353f0: 6f6e 7320 6f66 0d0a 2020 2020 2020 2020  ons of..        
+00035400: 7468 6520 7375 7266 6163 6573 2061 7265  the surfaces are
+00035410: 2070 6572 666f 726d 6564 2e20 5468 6520   performed. The 
+00035420: 7375 7266 6163 6573 2061 7265 2074 6865  surfaces are the
+00035430: 6e20 7573 6564 2074 6f20 6465 6c69 6d69  n used to delimi
+00035440: 7420 756e 6974 2064 6f6d 6169 6e73 2e0d  t unit domains..
+00035450: 0a20 2020 2020 2020 2069 6620 2233 645f  .        if "3d_
+00035460: 6361 7465 676f 7269 6361 6c22 2c20 6120  categorical", a 
+00035470: 6661 6369 6573 206d 6574 686f 6420 6973  facies method is
+00035480: 2075 7365 6420 746f 2073 696d 756c 6174   used to simulat
+00035490: 6520 706f 7369 7469 6f6e 206f 6620 7468  e position of th
+000354a0: 6520 756e 6974 732e 0d0a 2020 2020 2020  e units...      
+000354b0: 2020 5468 6520 6176 6169 6c61 626c 6520    The available 
+000354c0: 6d65 7468 6f64 7320 6172 6520 7468 6520  methods are the 
+000354d0: 7361 6d65 2074 6f20 7369 6d75 6c61 7465  same to simulate
+000354e0: 2074 6865 2066 6163 6965 732e 0d0a 2020   the facies...  
+000354f0: 2020 7665 7262 6f73 653a 2069 6e74 0d0a    verbose: int..
+00035500: 2020 2020 2020 2020 6c65 7665 6c20 6f66          level of
+00035510: 2076 6572 626f 7369 7479 0d0a 2020 2020   verbosity..    
+00035520: 7365 6564 3a20 696e 740d 0a20 2020 2020  seed: int..     
+00035530: 2020 2073 6565 6420 666f 7220 7261 6e64     seed for rand
+00035540: 6f6d 206e 756d 6265 7220 6765 6e65 7261  om number genera
+00035550: 7469 6f6e 0d0a 2020 2020 2222 220d 0a0d  tion..    """...
+00035560: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+00035570: 5f28 7365 6c66 2c20 6e61 6d65 2c20 6e61  _(self, name, na
+00035580: 7475 7265 3d22 7375 7266 6163 6573 222c  ture="surfaces",
+00035590: 2076 6572 626f 7365 3d31 2c20 7365 6564   verbose=1, seed
+000355a0: 3d31 293a 0d0a 0d0a 2020 2020 2020 2020  =1):....        
+000355b0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+000355c0: 6528 6e61 6d65 2c20 7374 7229 2c20 2241  e(name, str), "A
+000355d0: 206e 616d 6520 7368 6f75 6c64 2062 6520   name should be 
+000355e0: 7072 6f76 6964 6564 2061 6e64 206d 7573  provided and mus
+000355f0: 7420 6265 2061 2073 7472 696e 6722 0d0a  t be a string"..
+00035600: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+00035610: 745f 756e 6974 733d 5b5d 0d0a 2020 2020  t_units=[]..    
+00035620: 2020 2020 7365 6c66 2e6e 616d 653d 6e61      self.name=na
+00035630: 6d65 0d0a 2020 2020 2020 2020 7365 6c66  me..        self
+00035640: 2e76 6572 626f 7365 3d76 6572 626f 7365  .verbose=verbose
+00035650: 0d0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+00035660: 6565 643d 7365 6564 0d0a 2020 2020 2020  eed=seed..      
+00035670: 2020 7365 6c66 2e6e 6174 7572 6520 3d20    self.nature = 
+00035680: 6e61 7475 7265 0d0a 0d0a 0d0a 2020 2020  nature......    
+00035690: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
+000356a0: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
+000356b0: 7572 6e20 7365 6c66 2e6e 616d 650d 0a0d  urn self.name...
+000356c0: 0a20 2020 2064 6566 2061 6464 5f75 6e69  .    def add_uni
+000356d0: 7428 7365 6c66 2c20 756e 6974 293a 0d0a  t(self, unit):..
+000356e0: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
+000356f0: 2020 2222 220d 0a20 2020 2020 2020 2041    """..        A
+00035700: 6464 2061 2075 6e69 7420 746f 2074 6865  dd a unit to the
+00035710: 2070 696c 650d 0a0d 0a20 2020 2020 2020   pile....       
+00035720: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00035730: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00035740: 0a20 2020 2020 2020 2075 6e69 743a 2055  .        unit: U
+00035750: 6e69 7420 6f62 6a65 6374 206f 7220 6c69  nit object or li
+00035760: 7374 206f 6620 556e 6974 206f 626a 6563  st of Unit objec
+00035770: 7473 0d0a 2020 2020 2020 2020 2020 2020  ts..            
+00035780: 756e 6974 2873 2920 746f 2061 6464 2074  unit(s) to add t
+00035790: 6f20 7468 6520 7069 6c65 0d0a 2020 2020  o the pile..    
+000357a0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+000357b0: 2020 2074 7279 3a20 2369 7465 7261 626c     try: #iterabl
+000357c0: 650d 0a20 2020 2020 2020 2020 2020 2066  e..            f
+000357d0: 6f72 2069 2069 6e20 756e 6974 3a0d 0a20  or i in unit:.. 
+000357e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000357f0: 6620 2869 7369 6e73 7461 6e63 6528 692c  f (isinstance(i,
+00035800: 2055 6e69 7429 2920 616e 6420 2869 206e   Unit)) and (i n
+00035810: 6f74 2069 6e20 7365 6c66 2e6c 6973 745f  ot in self.list_
+00035820: 756e 6974 7329 3a0d 0a20 2020 2020 2020  units):..       
+00035830: 2020 2020 2020 2020 2020 2020 2069 2e76               i.v
+00035840: 6572 626f 7365 203d 2073 656c 662e 7665  erbose = self.ve
+00035850: 7262 6f73 650d 0a20 2020 2020 2020 2020  rbose..         
+00035860: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00035870: 6c69 7374 5f75 6e69 7473 2e61 7070 656e  list_units.appen
+00035880: 6428 6929 0d0a 2020 2020 2020 2020 2020  d(i)..          
+00035890: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000358a0: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+000358b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000358c0: 2020 2020 7072 696e 7428 2253 7472 6174      print("Strat
+000358d0: 6967 7261 7068 6963 2075 6e69 7420 7b7d  igraphic unit {}
+000358e0: 2061 6464 6564 222e 666f 726d 6174 2869   added".format(i
+000358f0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+00035900: 2020 2020 2020 2020 2065 6c69 6620 2869           elif (i
+00035910: 7369 6e73 7461 6e63 6528 692c 2055 6e69  sinstance(i, Uni
+00035920: 7429 293a 0d0a 2020 2020 2020 2020 2020  t)):..          
+00035930: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00035940: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+00035950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035960: 2020 2020 7072 696e 7428 226f 626a 6563      print("objec
+00035970: 7420 6973 2061 6c72 6561 6479 2069 6e20  t is already in 
+00035980: 7468 6520 6c69 7374 2229 0d0a 2020 2020  the list")..    
+00035990: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000359a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000359b0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
+000359c0: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
+000359d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000359e0: 2070 7269 6e74 2822 6f62 6a65 6374 2069   print("object i
+000359f0: 736e 2774 2061 2075 6e69 7420 6f62 6a65  sn't a unit obje
+00035a00: 6374 2229 0d0a 2020 2020 2020 2020 6578  ct")..        ex
+00035a10: 6365 7074 3a20 2320 756e 6974 206e 6f74  cept: # unit not
+00035a20: 2069 6e20 6120 6c69 7374 0d0a 2020 2020   in a list..    
+00035a30: 2020 2020 2020 2020 6966 2028 6973 696e          if (isin
+00035a40: 7374 616e 6365 2875 6e69 742c 2055 6e69  stance(unit, Uni
+00035a50: 7429 2920 616e 6420 2875 6e69 7420 6e6f  t)) and (unit no
+00035a60: 7420 696e 2073 656c 662e 6c69 7374 5f75  t in self.list_u
+00035a70: 6e69 7473 293a 0d0a 2020 2020 2020 2020  nits):..        
+00035a80: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+00035a90: 745f 756e 6974 732e 6170 7065 6e64 2875  t_units.append(u
+00035aa0: 6e69 7429 0d0a 2020 2020 2020 2020 2020  nit)..          
+00035ab0: 2020 2020 2020 756e 6974 2e76 6572 626f        unit.verbo
+00035ac0: 7365 203d 2073 656c 662e 7665 7262 6f73  se = self.verbos
+00035ad0: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00035ae0: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+00035af0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00035b00: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00035b10: 5374 7261 7469 6772 6170 6869 6320 756e  Stratigraphic un
+00035b20: 6974 207b 7d20 6164 6465 6422 2e66 6f72  it {} added".for
+00035b30: 6d61 7428 756e 6974 2e6e 616d 6529 290d  mat(unit.name)).
+00035b40: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00035b50: 6620 2869 7369 6e73 7461 6e63 6528 756e  f (isinstance(un
+00035b60: 6974 2c20 556e 6974 2929 3a0d 0a20 2020  it, Unit)):..   
+00035b70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00035b80: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+00035b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ba0: 2020 2070 7269 6e74 2822 6f62 6a65 6374     print("object
+00035bb0: 2069 7320 616c 7265 6164 7920 696e 2074   is already in t
+00035bc0: 6865 206c 6973 7422 290d 0a20 2020 2020  he list")..     
+00035bd0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00035be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00035bf0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
+00035c00: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
+00035c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035c20: 7072 696e 7428 226f 626a 6563 7420 6973  print("object is
+00035c30: 6e27 7420 6120 756e 6974 206f 626a 6563  n't a unit objec
+00035c40: 7422 290d 0a0d 0a20 2020 2064 6566 2072  t")....    def r
+00035c50: 656d 6f76 655f 756e 6974 2873 656c 662c  emove_unit(self,
+00035c60: 2075 6e69 745f 746f 5f72 656d 293a 0d0a   unit_to_rem):..
+00035c70: 0d0a 2020 2020 2020 2020 2222 2252 656d  ..        """Rem
+00035c80: 6f76 6520 7468 6520 6769 7665 6e20 756e  ove the given un
+00035c90: 6974 206f 626a 6563 7420 6672 6f6d 2050  it object from P
+00035ca0: 696c 6520 6f62 6a65 6374 0d0a 2020 2020  ile object..    
+00035cb0: 2020 2020 0d0a 2020 2020 2020 2020 5061      ..        Pa
+00035cc0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00035cd0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00035ce0: 2020 2020 2020 756e 6974 5f74 6f5f 7265        unit_to_re
+00035cf0: 6d3a 203a 636c 6173 733a 6055 6e69 7460  m: :class:`Unit`
+00035d00: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
+00035d10: 2020 2020 2075 6e69 7420 746f 2072 656d       unit to rem
+00035d20: 6f76 6520 6672 6f6d 2074 6865 2070 696c  ove from the pil
+00035d30: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
+00035d40: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00035d50: 2873 656c 662e 6c69 7374 5f75 6e69 7473  (self.list_units
+00035d60: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
+00035d70: 2020 2020 6966 2075 6e69 745f 746f 5f72      if unit_to_r
+00035d80: 656d 2069 6e20 7365 6c66 2e6c 6973 745f  em in self.list_
+00035d90: 756e 6974 733a 0d0a 2020 2020 2020 2020  units:..        
+00035da0: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+00035db0: 745f 756e 6974 732e 7265 6d6f 7665 2875  t_units.remove(u
+00035dc0: 6e69 745f 746f 5f72 656d 290d 0a20 2020  nit_to_rem)..   
+00035dd0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00035de0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+00035df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035e00: 2020 2070 7269 6e74 2822 556e 6974 207b     print("Unit {
+00035e10: 7d20 7265 6d6f 7665 6420 6672 6f6d 2050  } removed from P
+00035e20: 696c 6520 7b7d 222e 666f 726d 6174 2875  ile {}".format(u
+00035e30: 6e69 745f 746f 5f72 656d 2e6e 616d 652c  nit_to_rem.name,
+00035e40: 2073 656c 662e 6e61 6d65 2929 0d0a 0d0a   self.name))....
+00035e50: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00035e60: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00035e70: 6c66 2e76 6572 626f 7365 3a0d 0a20 2020  lf.verbose:..   
+00035e80: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+00035e90: 6e74 2822 6e6f 2075 6e69 7473 2066 6f75  nt("no units fou
+00035ea0: 6e64 2069 6e20 7069 6c65 207b 7d22 2e66  nd in pile {}".f
+00035eb0: 6f72 6d61 7428 7365 6c66 2e6e 616d 6529  ormat(self.name)
+00035ec0: 290d 0a0d 0a20 2020 2064 6566 2067 6574  )....    def get
+00035ed0: 5f70 696c 655f 7265 6628 7365 6c66 293a  _pile_ref(self):
+00035ee0: 0d0a 0d0a 2020 2020 2020 2020 6c20 3d20  ....        l = 
+00035ef0: 5b5d 0d0a 2020 2020 2020 2020 666f 7220  []..        for 
+00035f00: 756e 2069 6e20 7365 6c66 2e6c 6973 745f  un in self.list_
+00035f10: 756e 6974 733a 0d0a 2020 2020 2020 2020  units:..        
+00035f20: 2020 2020 6966 2075 6e2e 6d5f 756e 6974      if un.m_unit
+00035f30: 5f6e 616d 6520 6973 206e 6f74 204e 6f6e  _name is not Non
+00035f40: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00035f50: 2020 2020 6c2e 6170 7065 6e64 2875 6e2e      l.append(un.
+00035f60: 6d5f 756e 6974 5f6e 616d 6529 0d0a 2020  m_unit_name)..  
+00035f70: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00035f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035f90: 206c 2e61 7070 656e 6428 756e 2e6e 616d   l.append(un.nam
+00035fa0: 6529 0d0a 0d0a 2020 2020 2020 2020 7265  e)....        re
+00035fb0: 7475 726e 206c 0d0a 0d0a 2020 2020 6465  turn l....    de
+00035fc0: 6620 6f72 6465 725f 756e 6974 7328 7365  f order_units(se
+00035fd0: 6c66 2c20 7662 3d31 293a 0d0a 0d0a 2020  lf, vb=1):....  
+00035fe0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00035ff0: 2020 204f 7264 6572 206c 6973 745f 6c69     Order list_li
+00036000: 7468 7320 6163 636f 7264 696e 6720 7468  ths according th
+00036010: 6520 6f72 6465 7220 6174 7472 6962 7574  e order attribut
+00036020: 6573 206f 6620 6561 6368 206c 6974 686f  es of each litho
+00036030: 6c6f 6769 6573 0d0a 0d0a 2020 2020 2020  logies....      
+00036040: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00036050: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00036060: 0d0a 2020 2020 2020 2020 7662 3a20 696e  ..        vb: in
+00036070: 740d 0a20 2020 2020 2020 2020 2020 206c  t..            l
+00036080: 6576 656c 206f 6620 7665 7262 6f73 6974  evel of verbosit
+00036090: 792c 2030 2066 6f72 206e 6f20 7072 696e  y, 0 for no prin
+000360a0: 742c 2031 2066 6f72 2070 7269 6e74 0d0a  t, 1 for print..
+000360b0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+000360c0: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
+000360d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000360e0: 2822 5069 6c65 207b 7d3a 206f 7264 6572  ("Pile {}: order
+000360f0: 696e 6720 756e 6974 7322 2e66 6f72 6d61  ing units".forma
+00036100: 7428 7365 6c66 2e6e 616d 6529 290d 0a0d  t(self.name))...
+00036110: 0a20 2020 2020 2020 2073 656c 662e 6c69  .        self.li
+00036120: 7374 5f75 6e69 7473 2e73 6f72 7428 6b65  st_units.sort(ke
+00036130: 793d 6c61 6d62 6461 2078 3a20 782e 6f72  y=lambda x: x.or
+00036140: 6465 7229 0d0a 2020 2020 2020 2020 6966  der)..        if
+00036150: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
+00036160: 2020 7072 696e 7428 2253 7472 6174 6967    print("Stratig
+00036170: 7261 7068 6963 2075 6e69 7473 2068 6176  raphic units hav
+00036180: 6520 6265 656e 2073 6f72 7465 6420 6163  e been sorted ac
+00036190: 636f 7264 696e 6720 746f 206f 7264 6572  cording to order
+000361a0: 2229 0d0a 0d0a 2020 2020 2020 2020 693d  ")....        i=
+000361b0: 300d 0a20 2020 2020 2020 2066 6c61 673d  0..        flag=
+000361c0: 300d 0a20 2020 2020 2020 2023 2063 6865  0..        # che
+000361d0: 636b 206f 7264 6572 7320 6f66 2075 6e69  ck orders of uni
+000361e0: 740d 0a20 2020 2020 2020 2066 6f72 2073  t..        for s
+000361f0: 2069 6e20 7365 6c66 2e6c 6973 745f 756e   in self.list_un
+00036200: 6974 733a 0d0a 2020 2020 2020 2020 2020  its:..          
+00036210: 2020 6966 2069 203d 3d20 303a 0d0a 2020    if i == 0:..  
+00036220: 2020 2020 2020 2020 2020 2020 2020 735f                s_
+00036230: 6265 663d 730d 0a20 2020 2020 2020 2020  bef=s..         
+00036240: 2020 2020 2020 2069 6620 735f 6265 662e         if s_bef.
+00036250: 6f72 6465 7220 213d 2031 3a0d 0a20 2020  order != 1:..   
+00036260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036270: 2066 6c61 673d 310d 0a20 2020 2020 2020   flag=1..       
+00036280: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00036290: 7662 3a0d 0a20 2020 2020 2020 2020 2020  vb:..           
+000362a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000362b0: 6e74 2822 6669 7273 7420 756e 6974 206f  nt("first unit o
+000362c0: 7264 6572 2069 7320 6e6f 7420 6571 7561  rder is not equa
+000362d0: 6c20 746f 2031 2229 0d0a 0d0a 2020 2020  l to 1")....    
+000362e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000362f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00036300: 6620 732e 6f72 6465 7220 3d3d 2073 5f62  f s.order == s_b
+00036310: 6566 2e6f 7264 6572 3a0d 0a20 2020 2020  ef.order:..     
+00036320: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00036330: 6c61 673d 310d 0a20 2020 2020 2020 2020  lag=1..         
+00036340: 2020 2020 2020 2020 2020 2069 6620 7662             if vb
+00036350: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00036360: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00036370: 2822 756e 6974 7320 7b7d 2061 6e64 207b  ("units {} and {
+00036380: 7d20 6861 7665 2074 6865 2073 616d 6520  } have the same 
+00036390: 6f72 6465 7222 2e66 6f72 6d61 7428 732e  order".format(s.
+000363a0: 6e61 6d65 2c20 735f 6265 662e 6e61 6d65  name, s_bef.name
+000363b0: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
+000363c0: 2020 2020 2020 656c 6966 2073 2e6f 7264        elif s.ord
+000363d0: 6572 2021 3d20 735f 6265 662e 6f72 6465  er != s_bef.orde
+000363e0: 7220 2b20 313a 0d0a 2020 2020 2020 2020  r + 1:..        
+000363f0: 2020 2020 2020 2020 2020 2020 666c 6167              flag
+00036400: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
+00036410: 2020 2020 2020 2020 6966 2076 623a 0d0a          if vb:..
+00036420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036430: 2020 2020 2020 2020 7072 696e 7428 2244          print("D
+00036440: 6973 6372 6570 656e 6379 2069 6e20 7468  iscrepency in th
+00036450: 6520 6f72 6465 7273 2066 6f72 2075 6e69  e orders for uni
+00036460: 7473 207b 7d20 616e 6420 7b7d 222e 666f  ts {} and {}".fo
+00036470: 726d 6174 2873 2e6e 616d 652c 2073 5f62  rmat(s.name, s_b
+00036480: 6566 2e6e 616d 6529 290d 0a0d 0a20 2020  ef.name))....   
+00036490: 2020 2020 2020 2020 2020 2020 2073 5f62               s_b
+000364a0: 6566 3d73 0d0a 2020 2020 2020 2020 2020  ef=s..          
+000364b0: 2020 6920 2b3d 2031 0d0a 0d0a 2020 2020    i += 1....    
+000364c0: 2020 2020 6966 2066 6c61 673a 0d0a 2020      if flag:..  
+000364d0: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
+000364e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000364f0: 2020 7072 696e 7428 2243 6861 6e67 696e    print("Changin
+00036500: 6720 6f72 6465 7273 2066 6f72 2074 6861  g orders for tha
+00036510: 7420 7468 6579 2072 616e 6765 2066 726f  t they range fro
+00036520: 6d20 3120 746f 206e 2229 0d0a 2020 2020  m 1 to n")..    
+00036530: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+00036540: 6f72 6465 7220 7261 6e67 696e 6720 6672  order ranging fr
+00036550: 6f6d 2031 2074 6f20 6e0d 0a20 2020 2020  om 1 to n..     
+00036560: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00036570: 7261 6e67 6528 6c65 6e28 7365 6c66 2e6c  range(len(self.l
+00036580: 6973 745f 756e 6974 7329 293a 0d0a 2020  ist_units)):..  
+00036590: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000365a0: 2073 656c 662e 6c69 7374 5f75 6e69 7473   self.list_units
+000365b0: 5b69 5d2e 6f72 6465 7220 213d 2069 2b31  [i].order != i+1
+000365c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000365d0: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
+000365e0: 5f75 6e69 7473 5b69 5d2e 6f72 6465 723d  _units[i].order=
+000365f0: 692b 310d 0a0d 0a20 2020 2064 6566 2063  i+1....    def c
+00036600: 6f6d 7075 7465 5f73 7572 6628 7365 6c66  ompute_surf(self
+00036610: 2c20 4172 6368 5461 626c 652c 206e 7265  , ArchTable, nre
+00036620: 616c 3d31 2c20 666c 5f74 6f70 3d46 616c  al=1, fl_top=Fal
+00036630: 7365 2c20 7375 6270 696c 653d 4661 6c73  se, subpile=Fals
+00036640: 652c 2074 6f70 733d 4e6f 6e65 2c20 626f  e, tops=None, bo
+00036650: 7473 3d4e 6f6e 652c 2076 623d 3129 3a0d  ts=None, vb=1):.
+00036660: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00036670: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00036680: 7468 6520 656c 6576 6174 696f 6e20 6f66  the elevation of
+00036690: 2074 6865 2073 7572 6661 6365 7320 756e   the surfaces un
+000366a0: 6974 7320 2831 7374 2068 6965 7261 7263  its (1st hierarc
+000366b0: 6869 6320 6f72 6465 7229 0d0a 2020 2020  hic order)..    
+000366c0: 2020 2020 636f 6e74 6169 6e65 6420 696e      contained in
+000366d0: 2074 6865 2050 696c 6520 6f62 6a65 6374   the Pile object
+000366e0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+000366f0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+00036700: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+00036710: 2020 2020 2041 7263 6854 6162 6c65 3a20       ArchTable: 
+00036720: 3a63 6c61 7373 3a60 4172 6368 5f74 6162  :class:`Arch_tab
+00036730: 6c65 6020 6f62 6a65 6374 0d0a 2020 2020  le` object..    
+00036740: 2020 2020 2020 2020 4172 6368 5461 626c          ArchTabl
+00036750: 6520 6f62 6a65 6374 2063 6f6e 7461 696e  e object contain
+00036760: 696e 6720 7468 6520 6172 6368 6974 6563  ing the architec
+00036770: 7475 7265 206f 6620 7468 6520 7069 6c65  ture of the pile
+00036780: 0d0a 2020 2020 2020 2020 6e72 6561 6c3a  ..        nreal:
+00036790: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
+000367a0: 2020 6e75 6d62 6572 206f 6620 7265 616c    number of real
+000367b0: 697a 6174 696f 6e0d 0a20 2020 2020 2020  ization..       
+000367c0: 2066 6c5f 746f 703a 2062 6f6f 6c0d 0a20   fl_top: bool.. 
+000367d0: 2020 2020 2020 2020 2020 2074 6f20 6e6f             to no
+000367e0: 7420 696e 7465 7270 6f6c 6174 6520 6669  t interpolate fi
+000367f0: 7273 7420 6c61 7965 7220 616e 6420 6173  rst layer and as
+00036800: 7369 676e 2069 743d 746f 700d 0a20 2020  sign it=top..   
+00036810: 2020 2020 2073 7562 7069 6c65 3a20 626f       subpile: bo
+00036820: 6f6c 0d0a 2020 2020 2020 2020 2020 2020  ol..            
+00036830: 6966 2074 6865 2070 696c 6520 6973 2061  if the pile is a
+00036840: 2073 7562 7069 6c65 0d0a 2020 2020 2020   subpile..      
+00036850: 2020 746f 7073 2c20 626f 7473 3a20 7365    tops, bots: se
+00036860: 7175 656e 6365 206f 6620 3244 2061 7272  quence of 2D arr
+00036870: 6179 7320 6f66 2073 697a 6520 286e 792c  ays of size (ny,
+00036880: 206e 7829 0d0a 2020 2020 2020 2020 2020   nx)..          
+00036890: 2020 6f66 2074 6f70 2f62 6f74 2066 6f72    of top/bot for
+000368a0: 2073 7562 7069 6c65 2073 7572 6661 6365   subpile surface
+000368b0: 0d0a 2020 2020 2020 2020 7662 3a20 696e  ..        vb: in
+000368c0: 740d 0a20 2020 2020 2020 2020 2020 206c  t..            l
+000368d0: 6576 656c 206f 6620 7665 7262 6f73 6974  evel of verbosit
+000368e0: 792c 2030 2066 6f72 206e 6f20 7072 696e  y, 0 for no prin
+000368f0: 742c 2031 2066 6f72 2070 7269 6e74 0d0a  t, 1 for print..
+00036900: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+00036910: 0a20 2020 2020 2020 2064 6566 2061 6464  .        def add
+00036920: 5f73 746f 5f63 6f6e 7461 6374 2873 2c20  _sto_contact(s, 
+00036930: 782c 2079 2c20 7a2c 2074 7970 653d 2265  x, y, z, type="e
+00036940: 7175 616c 6974 7922 2c20 7a32 3d4e 6f6e  quality", z2=Non
+00036950: 6529 3a20 2366 756e 6374 696f 6e20 746f  e): #function to
+00036960: 2061 6464 2061 2073 746f 6368 6173 7469   add a stochasti
+00036970: 6320 6864 2070 6f69 6e74 2074 6f20 6120  c hd point to a 
+00036980: 7375 7266 6163 650d 0a20 2020 2020 2020  surface..       
+00036990: 2020 2020 2023 2077 6172 6e69 6e67 206e       # warning n
+000369a0: 6f20 6368 6563 6b20 7468 6174 2070 6f69  o check that poi
+000369b0: 6e74 2069 7320 696e 7369 6465 2064 6f6d  nt is inside dom
+000369c0: 6169 6e0d 0a20 2020 2020 2020 2020 2020  ain..           
+000369d0: 2069 6620 7479 7065 203d 3d20 2265 7175   if type == "equ
+000369e0: 616c 6974 7922 3a0d 0a20 2020 2020 2020  ality":..       
+000369f0: 2020 2020 2020 2020 2073 2e73 7572 6661           s.surfa
+00036a00: 6365 2e73 746f 5f78 2e61 7070 656e 6428  ce.sto_x.append(
+00036a10: 7829 0d0a 2020 2020 2020 2020 2020 2020  x)..            
+00036a20: 2020 2020 732e 7375 7266 6163 652e 7374      s.surface.st
+00036a30: 6f5f 792e 6170 7065 6e64 2879 290d 0a20  o_y.append(y).. 
+00036a40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00036a50: 2e73 7572 6661 6365 2e73 746f 5f7a 2e61  .surface.sto_z.a
+00036a60: 7070 656e 6428 7a29 0d0a 2020 2020 2020  ppend(z)..      
+00036a70: 2020 2020 2020 656c 6966 2074 7970 6520        elif type 
+00036a80: 3d3d 2022 696e 6571 5f69 6e66 223a 0d0a  == "ineq_inf":..
+00036a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036aa0: 732e 7375 7266 6163 652e 7374 6f5f 696e  s.surface.sto_in
+00036ab0: 6571 2e61 7070 656e 6428 5b78 2c20 792c  eq.append([x, y,
+00036ac0: 2030 2c20 7a2c 206e 702e 6e61 6e5d 290d   0, z, np.nan]).
+00036ad0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00036ae0: 6620 7479 7065 203d 3d20 2269 6e65 715f  f type == "ineq_
+00036af0: 7375 7022 3a0d 0a20 2020 2020 2020 2020  sup":..         
+00036b00: 2020 2020 2020 2073 2e73 7572 6661 6365         s.surface
+00036b10: 2e73 746f 5f69 6e65 712e 6170 7065 6e64  .sto_ineq.append
+00036b20: 285b 782c 2079 2c20 302c 206e 702e 6e61  ([x, y, 0, np.na
+00036b30: 6e2c 207a 5d29 0d0a 2020 2020 2020 2020  n, z])..        
+00036b40: 2020 2020 656c 6966 2074 7970 6520 3d3d      elif type ==
+00036b50: 2022 646f 7562 6c65 5f69 6e65 7122 3a0d   "double_ineq":.
+00036b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036b70: 2073 2e73 7572 6661 6365 2e73 746f 5f69   s.surface.sto_i
+00036b80: 6e65 712e 6170 7065 6e64 285b 782c 2079  neq.append([x, y
+00036b90: 2c20 302c 207a 2c20 7a32 5d29 2020 2320  , 0, z, z2])  # 
+00036ba0: 696e 6665 7269 6f72 2061 6e64 2075 7070  inferior and upp
+00036bb0: 6572 2069 6e65 710d 0a0d 0a0d 0a20 2020  er ineq......   
+00036bc0: 2020 2020 2069 6620 4172 6368 5461 626c       if ArchTabl
+00036bd0: 652e 6368 6563 6b5f 7069 6c65 735f 6e61  e.check_piles_na
+00036be0: 6d65 2829 203d 3d20 303a 2023 2063 6865  me() == 0: # che
+00036bf0: 636b 2063 6f6e 7369 7374 656e 6379 2069  ck consistency i
+00036c00: 6e20 756e 6974 0d0a 2020 2020 2020 2020  n unit..        
+00036c10: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
+00036c20: 0a0d 0a20 2020 2020 2020 2041 7263 6854  ...        ArchT
+00036c30: 6162 6c65 2e6e 7265 616c 5f75 6e69 7473  able.nreal_units
+00036c40: 3d6e 7265 616c 2020 2320 7374 6f72 6520  =nreal  # store 
+00036c50: 6e75 6d62 6572 206f 6620 7265 616c 697a  number of realiz
+00036c60: 6174 696f 6e73 0d0a 0d0a 2020 2020 2020  ations....      
+00036c70: 2020 2373 696d 756c 6174 696f 6e20 6772    #simulation gr
+00036c80: 6964 0d0a 2020 2020 2020 2020 7867 3d41  id..        xg=A
+00036c90: 7263 6854 6162 6c65 2e67 6574 5f78 6763  rchTable.get_xgc
+00036ca0: 2829 0d0a 2020 2020 2020 2020 6e78 3d78  ()..        nx=x
+00036cb0: 672e 7368 6170 655b 305d 0d0a 2020 2020  g.shape[0]..    
+00036cc0: 2020 2020 7967 3d41 7263 6854 6162 6c65      yg=ArchTable
+00036cd0: 2e67 6574 5f79 6763 2829 0d0a 2020 2020  .get_ygc()..    
+00036ce0: 2020 2020 6e79 3d79 672e 7368 6170 655b      ny=yg.shape[
+00036cf0: 305d 0d0a 2020 2020 2020 2020 7a67 3d41  0]..        zg=A
+00036d00: 7263 6854 6162 6c65 2e67 6574 5f7a 6728  rchTable.get_zg(
+00036d10: 290d 0a20 2020 2020 2020 206e 7a3d 7a67  )..        nz=zg
+00036d20: 2e73 6861 7065 5b30 5d20 2d20 310d 0a20  .shape[0] - 1.. 
+00036d30: 2020 2020 2020 2069 6620 7e73 7562 7069         if ~subpi
+00036d40: 6c65 3a0d 0a20 2020 2020 2020 2020 2020  le:..           
+00036d50: 2074 6f70 3d41 7263 6854 6162 6c65 2e74   top=ArchTable.t
+00036d60: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
+00036d70: 626f 743d 4172 6368 5461 626c 652e 626f  bot=ArchTable.bo
+00036d80: 740d 0a20 2020 2020 2020 206d 6173 6b3d  t..        mask=
+00036d90: 4172 6368 5461 626c 652e 6d61 736b 2020  ArchTable.mask  
+00036da0: 2320 7369 6d75 6c61 7469 6f6e 206d 6173  # simulation mas
+00036db0: 6b0d 0a20 2020 2020 2020 206d 6173 6b32  k..        mask2
+00036dc0: 4420 3d20 4172 6368 5461 626c 652e 6d61  D = ArchTable.ma
+00036dd0: 736b 3264 2020 2320 6d61 736b 2032 440d  sk2d  # mask 2D.
+00036de0: 0a20 2020 2020 2020 206e 6c61 793d 6c65  .        nlay=le
+00036df0: 6e28 7365 6c66 2e6c 6973 745f 756e 6974  n(self.list_unit
+00036e00: 7329 0d0a 0d0a 2020 2020 2020 2020 6966  s)....        if
+00036e10: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
+00036e20: 2020 7072 696e 7428 2223 2323 2323 2323    print("#######
+00036e30: 2323 2320 5049 4c45 207b 7d20 2323 2323  ### PILE {} ####
+00036e40: 2323 2323 2323 222e 666f 726d 6174 2873  ######".format(s
+00036e50: 656c 662e 6e61 6d65 2929 0d0a 2020 2020  elf.name))..    
+00036e60: 2020 2020 236d 616b 6520 7375 7265 2074      #make sure t
+00036e70: 6f20 6861 7665 206f 7264 6572 6564 206c  o have ordered l
+00036e80: 6974 686f 6c6f 6769 6573 0d0a 2020 2020  ithologies..    
+00036e90: 2020 2020 7365 6c66 2e6f 7264 6572 5f75      self.order_u
+00036ea0: 6e69 7473 2876 623d 7662 290d 0a0d 0a20  nits(vb=vb).... 
+00036eb0: 2020 2020 2020 2023 2323 2069 6e69 7469         ### initi
+00036ec0: 616c 697a 6520 7375 7266 6163 6573 2062  alize surfaces b
+00036ed0: 7920 7365 7474 696e 6720 746f 2030 0d0a  y setting to 0..
+00036ee0: 0d0a 2020 2020 2020 2020 7375 7266 733d  ..        surfs=
+00036ef0: 6e70 2e7a 6572 6f73 285b 6e72 6561 6c2c  np.zeros([nreal,
+00036f00: 206e 6c61 792c 206e 792c 206e 785d 2c20   nlay, ny, nx], 
+00036f10: 6474 7970 653d 6e70 2e66 6c6f 6174 3332  dtype=np.float32
+00036f20: 290d 0a20 2020 2020 2020 2073 7572 6673  )..        surfs
+00036f30: 5f62 6f74 3d6e 702e 7a65 726f 7328 5b6e  _bot=np.zeros([n
+00036f40: 7265 616c 2c20 6e6c 6179 2c20 6e79 2c20  real, nlay, ny, 
+00036f50: 6e78 5d2c 2064 7479 7065 3d6e 702e 666c  nx], dtype=np.fl
+00036f60: 6f61 7433 3229 0d0a 2020 2020 2020 2020  oat32)..        
+00036f70: 6f72 675f 7375 7266 733d 6e70 2e7a 6572  org_surfs=np.zer
+00036f80: 6f73 285b 6e72 6561 6c2c 206e 6c61 792c  os([nreal, nlay,
+00036f90: 206e 792c 206e 785d 2c20 6474 7970 653d   ny, nx], dtype=
+00036fa0: 6e70 2e66 6c6f 6174 3332 290d 0a20 2020  np.float32)..   
+00036fb0: 2020 2020 2072 6561 6c5f 646f 6d61 696e       real_domain
+00036fc0: 733d 6e70 2e7a 6572 6f73 285b 6e72 6561  s=np.zeros([nrea
+00036fd0: 6c2c 206e 6c61 792c 206e 7a2c 206e 792c  l, nlay, nz, ny,
+00036fe0: 206e 785d 2c20 6474 7970 653d 6e70 2e69   nx], dtype=np.i
+00036ff0: 6e74 3829 0d0a 0d0a 2020 2020 2020 2020  nt8)....        
+00037000: 666f 7220 6972 6561 6c20 696e 2072 616e  for ireal in ran
+00037010: 6765 286e 7265 616c 293a 2023 206c 6f6f  ge(nreal): # loo
+00037020: 7020 6f76 6572 2072 6561 6c0d 0a0d 0a20  p over real.... 
+00037030: 2020 2020 2020 2020 2020 2023 2065 7261             # era
+00037040: 7365 2073 746f 6368 6173 7469 6320 6461  se stochastic da
+00037050: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
+00037060: 666f 7220 7320 696e 2073 656c 662e 6c69  for s in self.li
+00037070: 7374 5f75 6e69 7473 3a0d 0a20 2020 2020  st_units:..     
+00037080: 2020 2020 2020 2020 2020 2073 2e73 7572             s.sur
+00037090: 6661 6365 2e73 746f 5f78 203d 205b 5d0d  face.sto_x = [].
+000370a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000370b0: 2073 2e73 7572 6661 6365 2e73 746f 5f79   s.surface.sto_y
+000370c0: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
+000370d0: 2020 2020 2020 2073 2e73 7572 6661 6365         s.surface
+000370e0: 2e73 746f 5f7a 203d 205b 5d0d 0a20 2020  .sto_z = []..   
+000370f0: 2020 2020 2020 2020 2020 2020 2073 2e73               s.s
+00037100: 7572 6661 6365 2e73 746f 5f69 6e65 7120  urface.sto_ineq 
+00037110: 3d20 5b5d 0d0a 0d0a 2020 2020 2020 2020  = []....        
+00037120: 2020 2020 2320 636f 6d70 7574 6520 7374      # compute st
+00037130: 6f20 6461 7461 0d0a 2020 2020 2020 2020  o data..        
+00037140: 2020 2020 666f 7220 6720 696e 2041 7263      for g in Arc
+00037150: 6854 6162 6c65 2e73 746f 5f68 643a 0d0a  hTable.sto_hd:..
+00037160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037170: 636f 6f72 6420 3d20 675b 305d 0d0a 2020  coord = g[0]..  
+00037180: 2020 2020 2020 2020 2020 2020 2020 782c                x,
+00037190: 792c 7a20 3d20 636f 6f72 640d 0a20 2020  y,z = coord..   
+000371a0: 2020 2020 2020 2020 2020 2020 2068 6420               hd 
+000371b0: 3d20 675b 315d 0d0a 2020 2020 2020 2020  = g[1]..        
+000371c0: 2020 2020 2020 2020 7020 3d20 675b 325d          p = g[2]
+000371d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000371e0: 2020 6920 3d20 6e70 2e72 616e 646f 6d2e    i = np.random.
+000371f0: 6368 6f69 6365 2872 616e 6765 286c 656e  choice(range(len
+00037200: 2870 2929 2c20 703d 7029 0d0a 2020 2020  (p)), p=p)..    
+00037210: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00037220: 732c 2074 7970 2069 6e20 6e70 2e61 7272  s, typ in np.arr
+00037230: 6179 2868 645b 695d 293a 0d0a 2020 2020  ay(hd[i]):..    
+00037240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037250: 6164 645f 7374 6f5f 636f 6e74 6163 7428  add_sto_contact(
+00037260: 732c 2078 2c20 792c 207a 2c20 7479 7029  s, x, y, z, typ)
+00037270: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00037280: 2374 6f70 2f62 6f74 0d0a 2020 2020 2020  #top/bot..      
+00037290: 2020 2020 2020 6966 2073 7562 7069 6c65        if subpile
+000372a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000372b0: 2020 2074 6f70 3d74 6f70 735b 6972 6561     top=tops[irea
+000372c0: 6c5d 0d0a 2020 2020 2020 2020 2020 2020  l]..            
+000372d0: 2020 2020 626f 743d 626f 7473 5b69 7265      bot=bots[ire
+000372e0: 616c 5d0d 0a0d 0a20 2020 2020 2020 2020  al]....         
+000372f0: 2020 2023 2063 6f75 6e74 6572 2066 6f72     # counter for
+00037300: 2063 7572 7265 6e74 2073 696d 756c 6174   current simulat
+00037310: 6564 2073 7572 6661 6365 0d0a 2020 2020  ed surface..    
+00037320: 2020 2020 2020 2020 693d 2d31 0d0a 0d0a          i=-1....
+00037330: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00037340: 6c69 7468 6f20 696e 2073 656c 662e 6c69  litho in self.li
+00037350: 7374 5f75 6e69 7473 5b3a 3a20 2d31 5d3a  st_units[:: -1]:
+00037360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037370: 2020 6966 2076 623a 0d0a 2020 2020 2020    if vb:..      
+00037380: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00037390: 696e 7428 225c 6e23 2323 2320 434f 4d50  int("\n#### COMP
+000373a0: 5554 494e 4720 5355 5246 4143 4520 4f46  UTING SURFACE OF
+000373b0: 2055 4e49 5420 7b7d 222e 666f 726d 6174   UNIT {}".format
+000373c0: 286c 6974 686f 2e6e 616d 6529 290d 0a20  (litho.name)).. 
+000373d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000373e0: 202b 3d20 3120 2023 2069 6e64 6578 2066   += 1  # index f
+000373f0: 6f72 2073 696d 756c 6174 6564 2073 7572  or simulated sur
+00037400: 6661 6365 0d0a 2020 2020 2020 2020 2020  face..          
+00037410: 2020 2020 2020 7374 6172 743d 7469 6d65        start=time
+00037420: 2e74 696d 6528 290d 0a20 2020 2020 2020  .time()..       
+00037430: 2020 2020 2020 2020 2069 6620 2866 6c5f           if (fl_
+00037440: 746f 7029 2061 6e64 2028 6920 3d3d 206e  top) and (i == n
+00037450: 6c61 792d 3129 3a20 2320 6669 7273 7420  lay-1): # first 
+00037460: 6c61 7965 7220 6173 7369 676e 2074 6f20  layer assign to 
+00037470: 746f 700d 0a20 2020 2020 2020 2020 2020  top..           
+00037480: 2020 2020 2020 2020 2073 313d 746f 700d           s1=top.
+00037490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000374a0: 2065 6c69 6620 286c 6974 686f 2e73 7572   elif (litho.sur
+000374b0: 6661 6365 2e69 6e74 5f6d 6574 686f 6420  face.int_method 
+000374c0: 696e 205b 226b 7269 6769 6e67 222c 2022  in ["kriging", "
+000374d0: 6c69 6e65 6172 222c 2022 6375 6269 6322  linear", "cubic"
+000374e0: 2c20 226e 6561 7265 7374 225d 2920 616e  , "nearest"]) an
+000374f0: 6420 2869 7265 616c 203e 2030 293a 2023  d (ireal > 0): #
+00037500: 2064 6574 6572 6d69 6e69 7374 206d 6574   determinist met
+00037510: 686f 640d 0a20 2020 2020 2020 2020 2020  hod..           
+00037520: 2020 2020 2020 2020 2073 313d 6f72 675f           s1=org_
+00037530: 7375 7266 735b 302c 2028 6e6c 6179 2d31  surfs[0, (nlay-1
+00037540: 292d 695d 2e63 6f70 7928 290d 0a20 2020  )-i].copy()..   
+00037550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037560: 2069 6620 7662 3a0d 0a20 2020 2020 2020   if vb:..       
+00037570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037580: 2070 7269 6e74 2822 7b7d 3a20 6465 7465   print("{}: dete
+00037590: 726d 696e 6973 7420 696e 7465 7270 6f6c  rminist interpol
+000375a0: 6174 696f 6e20 6d65 7468 6f64 2c20 7265  ation method, re
+000375b0: 7573 6520 7468 6520 6669 7273 7420 7375  use the first su
+000375c0: 7266 6163 6522 2e66 6f72 6d61 7428 6c69  rface".format(li
+000375d0: 7468 6f2e 6e61 6d65 2929 0d0a 2020 2020  tho.name))..    
+000375e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000375f0: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00037600: 2020 2020 2020 2020 2023 2063 6861 6e67           # chang
+00037610: 6520 6d65 616e 2069 6620 7468 6963 6b6e  e mean if thickn
+00037620: 6573 7320 6d6f 6465 2069 7320 6163 7469  ess mode is acti
+00037630: 7661 7465 640d 0a20 2020 2020 2020 2020  vated..         
+00037640: 2020 2020 2020 2020 2020 2069 6620 2274             if "t
+00037650: 6869 636b 6e65 7373 2220 696e 206c 6974  hickness" in lit
+00037660: 686f 2e73 7572 6661 6365 2e64 6963 5f73  ho.surface.dic_s
+00037670: 7572 662e 6b65 7973 2829 3a0d 0a20 2020  urf.keys():..   
+00037680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037690: 2020 2020 2069 6620 6c69 7468 6f2e 7375       if litho.su
+000376a0: 7266 6163 652e 6469 635f 7375 7266 5b22  rface.dic_surf["
+000376b0: 7468 6963 6b6e 6573 7322 5d20 6973 206e  thickness"] is n
+000376c0: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+000376d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000376e0: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
+000376f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037710: 2020 6c69 7468 6f2e 7375 7266 6163 652e    litho.surface.
+00037720: 6469 635f 7375 7266 5b22 6d65 616e 225d  dic_surf["mean"]
+00037730: 203d 2041 7263 6854 6162 6c65 2e62 6f74   = ArchTable.bot
+00037740: 202b 206c 6974 686f 2e73 7572 6661 6365   + litho.surface
+00037750: 2e64 6963 5f73 7572 665b 2274 6869 636b  .dic_surf["thick
+00037760: 6e65 7373 225d 0d0a 2020 2020 2020 2020  ness"]..        
+00037770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037780: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00037790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377a0: 2020 2020 2020 2020 2020 206c 6974 686f             litho
+000377b0: 2e73 7572 6661 6365 2e64 6963 5f73 7572  .surface.dic_sur
+000377c0: 665b 226d 6561 6e22 5d20 3d20 7331 202b  f["mean"] = s1 +
+000377d0: 206c 6974 686f 2e73 7572 6661 6365 2e64   litho.surface.d
+000377e0: 6963 5f73 7572 665b 2274 6869 636b 6e65  ic_surf["thickne
+000377f0: 7373 225d 0d0a 0d0a 2020 2020 2020 2020  ss"]....        
+00037800: 2020 2020 2020 2020 2020 2020 7331 3d69              s1=i
+00037810: 6e74 6572 7032 4428 6c69 7468 6f2e 7375  nterp2D(litho.su
+00037820: 7266 6163 652c 2041 7263 6854 6162 6c65  rface, ArchTable
+00037830: 2e67 6574 5f78 6728 292c 2041 7263 6854  .get_xg(), ArchT
+00037840: 6162 6c65 2e67 6574 5f79 6728 292c 2041  able.get_yg(), A
+00037850: 7263 6854 6162 6c65 2e78 7532 442c 0d0a  rchTable.xu2D,..
+00037860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037880: 2073 6565 643d 4172 6368 5461 626c 652e   seed=ArchTable.
+00037890: 7365 6564 202b 206c 6974 686f 2e49 4420  seed + litho.ID 
+000378a0: 2a20 3165 3320 2b20 6972 6561 6c2c 2076  * 1e3 + ireal, v
+000378b0: 6572 626f 7365 3d41 7263 6854 6162 6c65  erbose=ArchTable
+000378c0: 2e76 6572 626f 7365 2c20 6e63 7075 3d41  .verbose, ncpu=A
+000378d0: 7263 6854 6162 6c65 2e6e 6370 752c 206d  rchTable.ncpu, m
+000378e0: 6173 6b32 443d 6d61 736b 3244 2c0d 0a20  ask2D=mask2D,.. 
+000378f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037910: 2a2a 6c69 7468 6f2e 7375 7266 6163 652e  **litho.surface.
+00037920: 6469 635f 7375 7266 2920 2320 7369 6d75  dic_surf) # simu
+00037930: 6c61 7469 6f6e 0d0a 0d0a 2020 2020 2020  lation....      
+00037940: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00037950: 7265 6d6f 7665 206d 6561 6e0d 0a20 2020  remove mean..   
+00037960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037970: 2069 6620 2274 6869 636b 6e65 7373 2220   if "thickness" 
+00037980: 696e 206c 6974 686f 2e73 7572 6661 6365  in litho.surface
+00037990: 2e64 6963 5f73 7572 662e 6b65 7973 2829  .dic_surf.keys()
+000379a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000379b0: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
+000379c0: 7468 6f2e 7375 7266 6163 652e 6469 635f  tho.surface.dic_
+000379d0: 7375 7266 5b22 7468 6963 6b6e 6573 7322  surf["thickness"
+000379e0: 5d20 6973 206e 6f74 204e 6f6e 653a 0d0a  ] is not None:..
+000379f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a00: 2020 2020 2020 2020 2020 2020 6c69 7468              lith
+00037a10: 6f2e 7375 7266 6163 652e 6469 635f 7375  o.surface.dic_su
+00037a20: 7266 5b22 6d65 616e 225d 203d 204e 6f6e  rf["mean"] = Non
+00037a30: 650d 0a0d 0a20 2020 2020 2020 2020 2020  e....           
+00037a40: 2020 2020 2065 6e64 3d74 696d 652e 7469       end=time.ti
+00037a50: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
+00037a60: 2020 2020 2020 6966 2076 623a 0d0a 2020        if vb:..  
+00037a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a80: 2020 7072 696e 7428 227b 7d3a 2074 696d    print("{}: tim
+00037a90: 6520 656c 6170 7365 6420 666f 7220 636f  e elapsed for co
+00037aa0: 6d70 7574 696e 6720 7375 7266 6163 6520  mputing surface 
+00037ab0: 7b7d 2073 222e 666f 726d 6174 286c 6974  {} s".format(lit
+00037ac0: 686f 2e6e 616d 652c 2028 656e 6420 2d20  ho.name, (end - 
+00037ad0: 7374 6172 7429 2929 0d0a 0d0a 2020 2020  start)))....    
+00037ae0: 2020 2020 2020 2020 2020 2020 2323 2069              ## i
+00037af0: 6620 6e61 6e20 696e 7369 6465 2074 6865  f nan inside the
+00037b00: 2064 6f6d 6169 6e20 286e 6f6e 2073 696d   domain (non sim
+00037b10: 756c 6174 6564 2061 7265 6129 202d 2d3e  ulated area) -->
+00037b20: 2073 6574 2076 616c 7565 7320 6672 6f6d   set values from
+00037b30: 2073 7572 6661 6365 2062 656c 6f77 0d0a   surface below..
 00037b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b50: 2020 2020 2020 2073 315b 6d61 736b 5f6e         s1[mask_n
-00037b60: 616e 5d20 3d20 626f 745b 6d61 736b 5f6e  an] = bot[mask_n
-00037b70: 616e 5d0d 0a0d 0a20 2020 2020 2020 2020  an]....         
-00037b80: 2020 2020 2020 206f 7267 5f73 7572 6673         org_surfs
-00037b90: 5b69 7265 616c 2c20 286e 6c61 792d 3129  [ireal, (nlay-1)
-00037ba0: 2d69 5d3d 7331 2e63 6f70 7928 290d 0a0d  -i]=s1.copy()...
-00037bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037bc0: 2023 2061 6461 7074 2061 6c74 6974 7564   # adapt altitud
-00037bd0: 6520 6966 2061 626f 7665 2f62 656c 6f77  e if above/below
-00037be0: 2074 6f70 2f62 6f74 0d0a 2020 2020 2020   top/bot..      
-00037bf0: 2020 2020 2020 2020 2020 7331 5b73 313e            s1[s1>
-00037c00: 746f 705d 3d74 6f70 5b73 313e 746f 705d  top]=top[s1>top]
-00037c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037c20: 2020 7331 5b73 313c 626f 745d 3d62 6f74    s1[s1<bot]=bot
-00037c30: 5b73 313c 626f 745d 0d0a 0d0a 2020 2020  [s1<bot]....    
-00037c40: 2020 2020 2020 2020 2020 2020 2373 7472              #str
-00037c50: 6174 6920 636f 6e73 6973 7465 6e63 7920  ati consistency 
-00037c60: 616e 6420 6572 6f73 696f 6e20 7275 6c65  and erosion rule
-00037c70: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-00037c80: 2020 2069 6620 6920 3e20 303a 0d0a 2020     if i > 0:..  
-00037c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ca0: 2020 666f 7220 6f20 696e 2072 616e 6765    for o in range
-00037cb0: 2869 293a 2023 2069 6e64 6578 2066 6f72  (i): # index for
-00037cc0: 2063 6865 636b 696e 6720 616c 7265 6164   checking alread
-00037cd0: 7920 7369 6d75 6c61 7465 6420 7375 7266  y simulated surf
-00037ce0: 6163 6573 0d0a 2020 2020 2020 2020 2020  aces..          
-00037cf0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-00037d00: 7468 6f32 3d73 656c 662e 6c69 7374 5f75  tho2=self.list_u
-00037d10: 6e69 7473 5b3a 3a20 2d31 5d5b 6f5d 0d0a  nits[:: -1][o]..
-00037d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d30: 2020 2020 2020 2020 7332 3d73 7572 6673          s2=surfs
-00037d40: 5b69 7265 616c 2c20 286e 6c61 792d 3129  [ireal, (nlay-1)
-00037d50: 2d6f 5d20 2369 6478 2066 726f 6d20 6e6c  -o] #idx from nl
-00037d60: 6179 2d31 2074 6f20 6e6c 6179 2d69 2d31  ay-1 to nlay-i-1
-00037d70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037d80: 2020 2020 2020 2020 2020 6966 206c 6974            if lit
-00037d90: 686f 2021 3d20 6c69 7468 6f32 3a0d 0a20  ho != litho2:.. 
-00037da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037db0: 2020 2020 2020 2020 2020 2069 6620 286c             if (l
-00037dc0: 6974 686f 2e6f 7264 6572 203c 206c 6974  itho.order < lit
-00037dd0: 686f 322e 6f72 6465 7229 2026 2028 6c69  ho2.order) & (li
-00037de0: 7468 6f2e 7375 7266 6163 652e 636f 6e74  tho.surface.cont
-00037df0: 6163 7420 3d3d 2022 6f6e 6c61 7022 293a  act == "onlap"):
-00037e00: 2023 2073 6920 636f 7563 6865 2073 696d   # si couche sim
-00037e10: 756c c3a9 6520 7375 7020 6574 206f 6e6c  ul..e sup et onl
-00037e20: 6170 0d0a 2020 2020 2020 2020 2020 2020  ap..            
-00037e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e40: 2020 2020 7331 5b73 3120 3c20 7332 5d3d      s1[s1 < s2]=
-00037e50: 7332 5b73 3120 3c20 7332 5d0d 0a20 2020  s2[s1 < s2]..   
-00037e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e70: 2020 2020 2020 2020 2065 6c69 6620 286c           elif (l
-00037e80: 6974 686f 2e6f 7264 6572 203c 206c 6974  itho.order < lit
-00037e90: 686f 322e 6f72 6465 7229 2026 2028 6c69  ho2.order) & (li
-00037ea0: 7468 6f2e 7375 7266 6163 652e 636f 6e74  tho.surface.cont
-00037eb0: 6163 7420 3d3d 2022 6572 6f64 6522 293a  act == "erode"):
-00037ec0: 2023 2073 6920 636f 7563 6865 2073 696d   # si couche sim
-00037ed0: 756c c3a9 6520 c3a9 726f 6465 2075 6e65  ul..e ..rode une
-00037ee0: 2061 6e63 6965 6e6e 650d 0a20 2020 2020   ancienne..     
-00037ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f00: 2020 2020 2020 2020 2020 2073 325b 7332             s2[s2
-00037f10: 203e 2073 315d 3d73 315b 7332 203e 2073   > s1]=s1[s2 > s
-00037f20: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00037f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f40: 2020 2020 6966 206f 203d 3d20 692d 3120      if o == i-1 
-00037f50: 616e 6420 6c69 7468 6f2e 636f 6e74 6163  and litho.contac
-00037f60: 7420 3d3d 2022 6572 6f64 6522 3a20 2320  t == "erode": # 
-00037f70: 6966 2069 6e64 6578 2022 6f22 2069 7320  if index "o" is 
-00037f80: 756e 6465 726c 7969 6e67 206c 6179 6572  underlying layer
-00037f90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037fb0: 2020 2020 2020 7331 5b73 3120 3e20 7332        s1[s1 > s2
-00037fc0: 5d3d 7332 5b73 3120 3e20 7332 5d20 2320  ]=s2[s1 > s2] # 
-00037fd0: 7072 6576 656e 7420 6572 6f73 696f 6e20  prevent erosion 
-00037fe0: 6c61 7965 7273 2068 6176 696e 6720 766f  layers having vo
-00037ff0: 6c75 6d65 0d0a 0d0a 2020 2020 2020 2020  lume....        
-00038000: 2020 2020 2020 2020 7375 7266 735b 6972          surfs[ir
-00038010: 6561 6c2c 2028 6e6c 6179 2d31 292d 695d  eal, (nlay-1)-i]
-00038020: 3d73 3120 2023 6164 6420 7375 7266 6163  =s1  #add surfac
-00038030: 650d 0a0d 0a20 2020 2020 2020 2020 2020  e....           
-00038040: 2023 636f 6d70 7574 6520 646f 6d61 696e   #compute domain
-00038050: 730d 0a20 2020 2020 2020 2020 2020 2073  s..            s
-00038060: 7461 7274 3d74 696d 652e 7469 6d65 2829  tart=time.time()
-00038070: 0d0a 2020 2020 2020 2020 2020 2020 7375  ..            su
-00038080: 7266 735f 6972 3d73 7572 6673 5b69 7265  rfs_ir=surfs[ire
-00038090: 616c 5d0d 0a0d 0a20 2020 2020 2020 2020  al]....         
-000380a0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-000380b0: 6528 7375 7266 735f 6972 2e73 6861 7065  e(surfs_ir.shape
-000380c0: 5b30 5d29 3a0d 0a20 2020 2020 2020 2020  [0]):..         
-000380d0: 2020 2020 2020 2069 6620 6920 3c20 7375         if i < su
-000380e0: 7266 735f 6972 2e73 6861 7065 5b30 5d2d  rfs_ir.shape[0]-
-000380f0: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00038100: 2020 2020 2020 2020 735f 626f 743d 7375          s_bot=su
-00038110: 7266 735f 6972 5b69 2b31 5d20 2320 626f  rfs_ir[i+1] # bo
-00038120: 7474 6f6d 0d0a 2020 2020 2020 2020 2020  ttom..          
-00038130: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00038140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038150: 2073 5f62 6f74 3d62 6f74 0d0a 2020 2020   s_bot=bot..    
-00038160: 2020 2020 2020 2020 2020 2020 735f 746f              s_to
-00038170: 703d 7375 7266 735f 6972 5b69 5d20 2320  p=surfs_ir[i] # 
-00038180: 746f 700d 0a20 2020 2020 2020 2020 2020  top..           
-00038190: 2020 2020 2061 3d41 7263 6854 6162 6c65       a=ArchTable
-000381a0: 2e63 6f6d 7075 7465 5f64 6f6d 6169 6e28  .compute_domain(
-000381b0: 735f 746f 702c 2073 5f62 6f74 290d 0a20  s_top, s_bot).. 
-000381c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000381d0: 6561 6c5f 646f 6d61 696e 735b 6972 6561  eal_domains[irea
-000381e0: 6c2c 2069 5d3d 612a 6d61 736b 2a73 656c  l, i]=a*mask*sel
-000381f0: 662e 6c69 7374 5f75 6e69 7473 5b69 5d2e  f.list_units[i].
-00038200: 4944 0d0a 2020 2020 2020 2020 2020 2020  ID..            
-00038210: 2020 2020 7375 7266 735f 626f 745b 6972      surfs_bot[ir
-00038220: 6561 6c2c 2069 5d3d 735f 626f 740d 0a0d  eal, i]=s_bot...
-00038230: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-00038240: 3d74 696d 652e 7469 6d65 2829 0d0a 2020  =time.time()..  
-00038250: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
-00038260: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00038270: 2020 7072 696e 7428 225c 6e54 696d 6520    print("\nTime 
-00038280: 656c 6170 7365 6420 666f 7220 6765 7474  elapsed for gett
-00038290: 696e 6720 646f 6d61 696e 7320 7b7d 2073  ing domains {} s
-000382a0: 222e 666f 726d 6174 2828 656e 6420 2d20  ".format((end - 
-000382b0: 7374 6172 7429 2929 0d0a 0d0a 2020 2020  start)))....    
-000382c0: 2020 2020 236f 6e6c 7920 3120 6269 6720      #only 1 big 
-000382d0: 6172 7261 790d 0a20 2020 2020 2020 2061  array..        a
-000382e0: 3d6e 702e 7375 6d28 7265 616c 5f64 6f6d  =np.sum(real_dom
-000382f0: 6169 6e73 2c20 6178 6973 3d31 290d 0a20  ains, axis=1).. 
-00038300: 2020 2020 2020 2041 7263 6854 6162 6c65         ArchTable
-00038310: 2e47 656f 6c2e 756e 6974 735f 646f 6d61  .Geol.units_doma
-00038320: 696e 735b 6120 213d 2030 5d3d 615b 6120  ins[a != 0]=a[a 
-00038330: 213d 2030 5d0d 0a20 2020 2020 2020 2041  != 0]..        A
-00038340: 7263 6854 6162 6c65 2e47 656f 6c2e 7375  rchTable.Geol.su
-00038350: 7266 6163 6573 5f62 795f 7069 6c65 735b  rfaces_by_piles[
-00038360: 7365 6c66 2e6e 616d 655d 3d73 7572 6673  self.name]=surfs
-00038370: 0d0a 2020 2020 2020 2020 4172 6368 5461  ..        ArchTa
-00038380: 626c 652e 4765 6f6c 2e73 7572 6661 6365  ble.Geol.surface
-00038390: 735f 626f 745f 6279 5f70 696c 6573 5b73  s_bot_by_piles[s
-000383a0: 656c 662e 6e61 6d65 5d3d 7375 7266 735f  elf.name]=surfs_
-000383b0: 626f 740d 0a20 2020 2020 2020 2041 7263  bot..        Arc
-000383c0: 6854 6162 6c65 2e47 656f 6c2e 6f72 675f  hTable.Geol.org_
-000383d0: 7375 7266 6163 6573 5f62 795f 7069 6c65  surfaces_by_pile
-000383e0: 735b 7365 6c66 2e6e 616d 655d 3d6f 7267  s[self.name]=org
-000383f0: 5f73 7572 6673 0d0a 0d0a 2020 2020 2020  _surfs....      
-00038400: 2020 6966 2076 623a 0d0a 2020 2020 2020    if vb:..      
-00038410: 2020 2020 2020 7072 696e 7428 2223 2323        print("###
-00038420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00038430: 2323 2323 2323 235c 6e22 290d 0a0d 0a20  #######\n").... 
-00038440: 2020 2064 6566 2064 6566 696e 655f 646f     def define_do
-00038450: 6d61 696e 7328 7365 6c66 2c20 4172 6368  mains(self, Arch
-00038460: 5461 626c 652c 2073 7572 6661 6365 732c  Table, surfaces,
-00038470: 2074 6f70 733d 4e6f 6e65 2c20 626f 7473   tops=None, bots
-00038480: 3d4e 6f6e 652c 2073 7562 7069 6c65 3d46  =None, subpile=F
-00038490: 616c 7365 2c20 7662 3d30 2c20 666c 5f74  alse, vb=0, fl_t
-000384a0: 6f70 3d54 7275 6529 3a0d 0a0d 0a20 2020  op=True):....   
-000384b0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000384c0: 2020 4465 6669 6e65 2075 6e69 7473 2064    Define units d
-000384d0: 6f6d 6169 6e73 2066 726f 6d20 7072 6563  omains from prec
-000384e0: 6f6d 7075 7465 6420 7375 7266 6163 6573  omputed surfaces
-000384f0: 2e0d 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00038500: 6d65 7468 6f64 2069 7320 7573 6564 2077  method is used w
-00038510: 6865 6e20 7468 6520 7375 7266 6163 6573  hen the surfaces
-00038520: 2061 7265 2070 7265 636f 6d70 7574 6564   are precomputed
-00038530: 2028 652e 672e 2066 726f 6d20 6120 7072   (e.g. from a pr
-00038540: 6576 696f 7573 2073 696d 756c 6174 696f  evious simulatio
-00038550: 6e29 200d 0a20 2020 2020 2020 2069 6e20  n) ..        in 
-00038560: 706c 6163 6520 746f 2074 6865 2063 6f6d  place to the com
-00038570: 7075 7465 5f73 7572 6661 6365 7320 6d65  pute_surfaces me
-00038580: 7468 6f64 2e0d 0a0d 0a20 2020 2020 2020  thod.....       
-00038590: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-000385a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-000385b0: 0a20 2020 2020 2020 2041 7263 6854 6162  .        ArchTab
-000385c0: 6c65 203a 203a 636c 6173 733a 6041 7263  le : :class:`Arc
-000385d0: 685f 7461 626c 6560 0d0a 2020 2020 2020  h_table`..      
-000385e0: 2020 2020 2020 4172 6368 5461 626c 6520        ArchTable 
-000385f0: 6f62 6a65 6374 0d0a 2020 2020 2020 2020  object..        
-00038600: 7375 7266 6163 6573 203a 2061 7272 6179  surfaces : array
-00038610: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-00038620: 7261 7920 6f66 2073 7572 6661 6365 7320  ray of surfaces 
-00038630: 286e 7265 616c 2c20 6e6c 6179 2c20 6e79  (nreal, nlay, ny
-00038640: 2c20 6e78 290d 0a20 2020 2020 2020 2074  , nx)..        t
-00038650: 6f70 7320 3a20 6172 7261 790d 0a20 2020  ops : array..   
-00038660: 2020 2020 2020 2020 2061 7272 6179 206f           array o
-00038670: 6620 746f 7020 656c 6576 6174 696f 6e73  f top elevations
-00038680: 2028 6e79 2c20 6e78 290d 0a20 2020 2020   (ny, nx)..     
-00038690: 2020 2062 6f74 7320 3a20 6172 7261 790d     bots : array.
-000386a0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000386b0: 6179 206f 6620 626f 7474 6f6d 2065 6c65  ay of bottom ele
-000386c0: 7661 7469 6f6e 7320 286e 792c 206e 7829  vations (ny, nx)
-000386d0: 0d0a 2020 2020 2020 2020 7375 6270 696c  ..        subpil
-000386e0: 6520 3a20 626f 6f6c 0d0a 2020 2020 2020  e : bool..      
-000386f0: 2020 2020 2020 6966 2074 6865 2070 696c        if the pil
-00038700: 6520 6973 2061 2073 7562 7069 6c65 2c20  e is a subpile, 
-00038710: 692e 652e 2069 6620 5472 7565 2c20 7468  i.e. if True, th
-00038720: 6520 746f 7020 616e 6420 626f 7474 6f6d  e top and bottom
-00038730: 206f 6620 7468 6520 7069 6c65 2061 7265   of the pile are
-00038740: 206e 6f74 2075 7365 640d 0a20 2020 2020   not used..     
-00038750: 2020 2076 6220 3a20 696e 740d 0a20 2020     vb : int..   
-00038760: 2020 2020 2020 2020 2076 6572 626f 7369           verbosi
-00038770: 7479 206c 6576 656c 2c20 3020 6973 2073  ty level, 0 is s
-00038780: 696c 656e 742c 2031 2069 7320 7665 7262  ilent, 1 is verb
-00038790: 6f73 650d 0a20 2020 2020 2020 2066 6c5f  ose..        fl_
-000387a0: 746f 7020 3a20 626f 6f6c 0d0a 2020 2020  top : bool..    
-000387b0: 2020 2020 2020 2020 6966 2054 7275 652c          if True,
-000387c0: 2074 6865 2074 6f70 206f 6620 7468 6520   the top of the 
-000387d0: 7069 6c65 2069 7320 7573 6564 2074 6f20  pile is used to 
-000387e0: 6465 6669 6e65 2074 6865 2074 6f70 206f  define the top o
-000387f0: 6620 7468 6520 6669 7273 7420 756e 6974  f the first unit
-00038800: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-00038810: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00038820: 7375 7266 6163 6573 2e73 6861 7065 5b31  surfaces.shape[1
-00038830: 5d20 3d3d 206c 656e 2873 656c 662e 6c69  ] == len(self.li
-00038840: 7374 5f75 6e69 7473 292c 2022 7468 6520  st_units), "the 
-00038850: 6e75 6d62 6572 206f 6620 7375 7266 6163  number of surfac
-00038860: 6573 207b 7d20 7072 6f76 6964 6564 2069  es {} provided i
-00038870: 7320 6e6f 7420 6571 7561 6c20 746f 2074  s not equal to t
-00038880: 6865 206e 756d 6265 7220 6f66 2075 6e69  he number of uni
-00038890: 7473 207b 7d22 2e66 6f72 6d61 7428 7375  ts {}".format(su
-000388a0: 7266 6163 6573 2e73 6861 7065 5b31 5d2c  rfaces.shape[1],
-000388b0: 206c 656e 2873 656c 662e 6c69 7374 5f75   len(self.list_u
-000388c0: 6e69 7473 2929 0d0a 0d0a 2020 2020 2020  nits))....      
-000388d0: 2020 2320 6e72 6561 6c0d 0a20 2020 2020    # nreal..     
-000388e0: 2020 206e 7265 616c 3d73 7572 6661 6365     nreal=surface
-000388f0: 732e 7368 6170 655b 305d 0d0a 0d0a 2020  s.shape[0]....  
-00038900: 2020 2020 2020 4172 6368 5461 626c 652e        ArchTable.
-00038910: 6e72 6561 6c5f 756e 6974 733d 6e72 6561  nreal_units=nrea
-00038920: 6c20 2023 2073 746f 7265 206e 756d 6265  l  # store numbe
-00038930: 7220 6f66 2072 6561 6c69 7a61 7469 6f6e  r of realization
-00038940: 730d 0a0d 0a20 2020 2020 2020 2023 7369  s....        #si
-00038950: 6d75 6c61 7469 6f6e 2067 7269 640d 0a20  mulation grid.. 
-00038960: 2020 2020 2020 2078 673d 4172 6368 5461         xg=ArchTa
-00038970: 626c 652e 6765 745f 7867 6328 290d 0a20  ble.get_xgc().. 
-00038980: 2020 2020 2020 206e 783d 7867 2e73 6861         nx=xg.sha
-00038990: 7065 5b30 5d0d 0a20 2020 2020 2020 2079  pe[0]..        y
-000389a0: 673d 4172 6368 5461 626c 652e 6765 745f  g=ArchTable.get_
-000389b0: 7967 6328 290d 0a20 2020 2020 2020 206e  ygc()..        n
-000389c0: 793d 7967 2e73 6861 7065 5b30 5d0d 0a20  y=yg.shape[0].. 
-000389d0: 2020 2020 2020 207a 673d 4172 6368 5461         zg=ArchTa
-000389e0: 626c 652e 6765 745f 7a67 2829 0d0a 2020  ble.get_zg()..  
-000389f0: 2020 2020 2020 6e7a 3d7a 672e 7368 6170        nz=zg.shap
-00038a00: 655b 305d 202d 2031 0d0a 2020 2020 2020  e[0] - 1..      
-00038a10: 2020 6966 207e 7375 6270 696c 653a 0d0a    if ~subpile:..
-00038a20: 2020 2020 2020 2020 2020 2020 746f 703d              top=
-00038a30: 4172 6368 5461 626c 652e 746f 700d 0a20  ArchTable.top.. 
-00038a40: 2020 2020 2020 2020 2020 2062 6f74 3d41             bot=A
-00038a50: 7263 6854 6162 6c65 2e62 6f74 0d0a 2020  rchTable.bot..  
-00038a60: 2020 2020 2020 6d61 736b 3d41 7263 6854        mask=ArchT
-00038a70: 6162 6c65 2e6d 6173 6b0d 0a20 2020 2020  able.mask..     
-00038a80: 2020 206e 6c61 793d 6c65 6e28 7365 6c66     nlay=len(self
-00038a90: 2e6c 6973 745f 756e 6974 7329 0d0a 0d0a  .list_units)....
-00038aa0: 2020 2020 2020 2020 236d 616b 6520 7375          #make su
-00038ab0: 7265 2074 6f20 6861 7665 206f 7264 6572  re to have order
-00038ac0: 6564 206c 6974 686f 6c6f 6769 6573 0d0a  ed lithologies..
-00038ad0: 2020 2020 2020 2020 7365 6c66 2e6f 7264          self.ord
-00038ae0: 6572 5f75 6e69 7473 2876 623d 7662 290d  er_units(vb=vb).
-00038af0: 0a0d 0a20 2020 2020 2020 2023 2323 2069  ...        ### i
-00038b00: 6e69 7469 616c 697a 6520 7375 7266 6163  nitialize surfac
-00038b10: 6573 2062 7920 7365 7474 696e 6720 746f  es by setting to
-00038b20: 2030 0d0a 0d0a 2020 2020 2020 2020 7375   0....        su
-00038b30: 7266 733d 6e70 2e7a 6572 6f73 285b 6e72  rfs=np.zeros([nr
-00038b40: 6561 6c2c 206e 6c61 792c 206e 792c 206e  eal, nlay, ny, n
-00038b50: 785d 290d 0a20 2020 2020 2020 2073 7572  x])..        sur
-00038b60: 6673 5f62 6f74 3d6e 702e 7a65 726f 7328  fs_bot=np.zeros(
-00038b70: 5b6e 7265 616c 2c20 6e6c 6179 2c20 6e79  [nreal, nlay, ny
-00038b80: 2c20 6e78 5d29 0d0a 2020 2020 2020 2020  , nx])..        
-00038b90: 6f72 675f 7375 7266 733d 7375 7266 6163  org_surfs=surfac
-00038ba0: 6573 0d0a 2020 2020 2020 2020 7265 616c  es..        real
-00038bb0: 5f64 6f6d 6169 6e73 3d6e 702e 7a65 726f  _domains=np.zero
-00038bc0: 7328 5b6e 7265 616c 2c20 6e6c 6179 2c20  s([nreal, nlay, 
-00038bd0: 6e7a 2c20 6e79 2c20 6e78 5d29 0d0a 0d0a  nz, ny, nx])....
-00038be0: 2020 2020 2020 2020 666f 7220 6972 6561          for irea
-00038bf0: 6c20 696e 2072 616e 6765 286e 7265 616c  l in range(nreal
-00038c00: 293a 2023 206c 6f6f 7020 6f76 6572 2072  ): # loop over r
-00038c10: 6561 6c0d 0a0d 0a20 2020 2020 2020 2020  eal....         
-00038c20: 2020 2023 746f 702f 626f 740d 0a20 2020     #top/bot..   
-00038c30: 2020 2020 2020 2020 2069 6620 7375 6270           if subp
-00038c40: 696c 653a 0d0a 2020 2020 2020 2020 2020  ile:..          
-00038c50: 2020 2020 2020 746f 703d 746f 7073 5b69        top=tops[i
-00038c60: 7265 616c 5d0d 0a20 2020 2020 2020 2020  real]..         
-00038c70: 2020 2020 2020 2062 6f74 3d62 6f74 735b         bot=bots[
-00038c80: 6972 6561 6c5d 0d0a 0d0a 2020 2020 2020  ireal]....      
-00038c90: 2020 2020 2020 2320 636f 756e 7465 7220        # counter 
-00038ca0: 666f 7220 6375 7272 656e 7420 7369 6d75  for current simu
-00038cb0: 6c61 7465 6420 7375 7266 6163 650d 0a20  lated surface.. 
-00038cc0: 2020 2020 2020 2020 2020 2069 3d2d 310d             i=-1.
-00038cd0: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
-00038ce0: 6f72 206c 6974 686f 2069 6e20 7365 6c66  or litho in self
-00038cf0: 2e6c 6973 745f 756e 6974 735b 3a3a 202d  .list_units[:: -
-00038d00: 315d 3a0d 0a0d 0a20 2020 2020 2020 2020  1]:....         
-00038d10: 2020 2020 2020 2069 202b 3d20 3120 2023         i += 1  #
-00038d20: 2069 6e64 6578 2066 6f72 2073 696d 756c   index for simul
-00038d30: 6174 6564 2073 7572 6661 6365 0d0a 2020  ated surface..  
-00038d40: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00038d50: 6172 743d 7469 6d65 2e74 696d 6528 290d  art=time.time().
-00038d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038d70: 2069 6620 2866 6c5f 746f 7029 2061 6e64   if (fl_top) and
-00038d80: 2028 6920 3d3d 206e 6c61 792d 3129 3a20   (i == nlay-1): 
-00038d90: 2320 6669 7273 7420 6c61 7965 7220 6173  # first layer as
-00038da0: 7369 676e 2074 6f20 746f 700d 0a20 2020  sign to top..   
-00038db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038dc0: 2073 313d 746f 700d 0a20 2020 2020 2020   s1=top..       
-00038dd0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00038de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038df0: 2020 2020 7331 3d6f 7267 5f73 7572 6673      s1=org_surfs
-00038e00: 5b69 7265 616c 2c20 286e 6c61 792d 3129  [ireal, (nlay-1)
-00038e10: 2d69 5d2e 636f 7079 2829 0d0a 0d0a 2020  -i].copy()....  
-00038e20: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00038e30: 6164 6170 7420 616c 7469 7475 6465 2069  adapt altitude i
-00038e40: 6620 6162 6f76 652f 6265 6c6f 7720 746f  f above/below to
-00038e50: 702f 626f 740d 0a20 2020 2020 2020 2020  p/bot..         
-00038e60: 2020 2020 2020 2073 315b 7331 3e74 6f70         s1[s1>top
-00038e70: 5d3d 746f 705b 7331 3e74 6f70 5d0d 0a20  ]=top[s1>top].. 
-00038e80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00038e90: 315b 7331 3c62 6f74 5d3d 626f 745b 7331  1[s1<bot]=bot[s1
-00038ea0: 3c62 6f74 5d0d 0a0d 0a20 2020 2020 2020  <bot]....       
-00038eb0: 2020 2020 2020 2020 2023 2073 7472 6174           # strat
-00038ec0: 6920 636f 6e73 6973 7465 6e63 7920 616e  i consistency an
-00038ed0: 6420 6572 6f73 696f 6e20 7275 6c65 730d  d erosion rules.
-00038ee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038ef0: 2069 6620 6920 3e20 303a 0d0a 2020 2020   if i > 0:..    
-00038f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f10: 666f 7220 6f20 696e 2072 616e 6765 2869  for o in range(i
-00038f20: 293a 2023 2069 6e64 6578 2066 6f72 2063  ): # index for c
-00038f30: 6865 636b 696e 6720 616c 7265 6164 7920  hecking already 
-00038f40: 7369 6d75 6c61 7465 6420 7375 7266 6163  simulated surfac
-00038f50: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-00038f60: 2020 2020 2020 2020 2020 2020 6c69 7468              lith
-00038f70: 6f32 3d73 656c 662e 6c69 7374 5f75 6e69  o2=self.list_uni
-00038f80: 7473 5b3a 3a20 2d31 5d5b 6f5d 0d0a 2020  ts[:: -1][o]..  
-00038f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fa0: 2020 2020 2020 7332 3d73 7572 6673 5b69        s2=surfs[i
-00038fb0: 7265 616c 2c20 286e 6c61 792d 3129 2d6f  real, (nlay-1)-o
-00038fc0: 5d20 2369 6478 2066 726f 6d20 6e6c 6179  ] #idx from nlay
-00038fd0: 2d31 2074 6f20 6e6c 6179 2d69 2d31 0d0a  -1 to nlay-i-1..
-00038fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ff0: 2020 2020 2020 2020 6966 206c 6974 686f          if litho
-00039000: 2021 3d20 6c69 7468 6f32 3a0d 0a20 2020   != litho2:..   
-00039010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039020: 2020 2020 2020 2020 2069 6620 286c 6974           if (lit
-00039030: 686f 2e6f 7264 6572 203c 206c 6974 686f  ho.order < litho
-00039040: 322e 6f72 6465 7229 2026 2028 6c69 7468  2.order) & (lith
-00039050: 6f2e 7375 7266 6163 652e 636f 6e74 6163  o.surface.contac
-00039060: 7420 3d3d 2022 6f6e 6c61 7022 293a 2023  t == "onlap"): #
-00039070: 2073 6920 636f 7563 6865 2073 696d 756c   si couche simul
-00039080: c3a9 6520 7375 7020 6574 206f 6e6c 6170  ..e sup et onlap
-00039090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000390a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390b0: 2020 7331 5b73 3120 3c20 7332 5d3d 7332    s1[s1 < s2]=s2
-000390c0: 5b73 3120 3c20 7332 5d0d 0a20 2020 2020  [s1 < s2]..     
-000390d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390e0: 2020 2020 2020 2065 6c69 6620 286c 6974         elif (lit
-000390f0: 686f 2e6f 7264 6572 203c 206c 6974 686f  ho.order < litho
-00039100: 322e 6f72 6465 7229 2026 2028 6c69 7468  2.order) & (lith
-00039110: 6f2e 7375 7266 6163 652e 636f 6e74 6163  o.surface.contac
-00039120: 7420 3d3d 2022 6572 6f64 6522 293a 2023  t == "erode"): #
-00039130: 2073 6920 636f 7563 6865 2073 696d 756c   si couche simul
-00039140: c3a9 6520 c3a9 726f 6465 2075 6e65 2061  ..e ..rode une a
-00039150: 6e63 6965 6e6e 650d 0a20 2020 2020 2020  ncienne..       
-00039160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039170: 2020 2020 2020 2020 2073 325b 7332 203e           s2[s2 >
-00039180: 2073 315d 3d73 315b 7332 203e 2073 315d   s1]=s1[s2 > s1]
-00039190: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000391a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000391b0: 2020 6966 206f 203d 3d20 692d 3120 616e    if o == i-1 an
-000391c0: 6420 6c69 7468 6f2e 636f 6e74 6163 7420  d litho.contact 
-000391d0: 3d3d 2022 6572 6f64 6522 3a20 2320 6966  == "erode": # if
-000391e0: 2069 6e64 6578 2022 6f22 2069 7320 756e   index "o" is un
-000391f0: 6465 726c 7969 6e67 206c 6179 6572 0d0a  derlying layer..
-00039200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039220: 2020 2020 7331 5b73 3120 3e20 7332 5d3d      s1[s1 > s2]=
-00039230: 7332 5b73 3120 3e20 7332 5d20 2320 7072  s2[s1 > s2] # pr
-00039240: 6576 656e 7420 6572 6f73 696f 6e20 6c61  event erosion la
-00039250: 7965 7273 2068 6176 696e 6720 766f 6c75  yers having volu
-00039260: 6d65 0d0a 0d0a 2020 2020 2020 2020 2020  me....          
-00039270: 2020 2020 2020 7375 7266 735b 6972 6561        surfs[irea
-00039280: 6c2c 2028 6e6c 6179 2d31 292d 695d 3d73  l, (nlay-1)-i]=s
-00039290: 3120 2023 6164 6420 7375 7266 6163 650d  1  #add surface.
-000392a0: 0a0d 0a20 2020 2020 2020 2020 2020 2023  ...            #
-000392b0: 636f 6d70 7574 6520 646f 6d61 696e 730d  compute domains.
-000392c0: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
-000392d0: 7572 6673 5f69 723d 7375 7266 735b 6972  urfs_ir=surfs[ir
-000392e0: 6561 6c5d 0d0a 0d0a 2020 2020 2020 2020  eal]....        
-000392f0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00039300: 6765 2873 7572 6673 5f69 722e 7368 6170  ge(surfs_ir.shap
-00039310: 655b 305d 293a 0d0a 2020 2020 2020 2020  e[0]):..        
-00039320: 2020 2020 2020 2020 6966 2069 203c 2073          if i < s
-00039330: 7572 6673 5f69 722e 7368 6170 655b 305d  urfs_ir.shape[0]
-00039340: 2d31 3a0d 0a20 2020 2020 2020 2020 2020  -1:..           
-00039350: 2020 2020 2020 2020 2073 5f62 6f74 3d73           s_bot=s
-00039360: 7572 6673 5f69 725b 692b 315d 2023 2062  urfs_ir[i+1] # b
-00039370: 6f74 746f 6d0d 0a20 2020 2020 2020 2020  ottom..         
-00039380: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00039390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000393a0: 2020 735f 626f 743d 626f 740d 0a20 2020    s_bot=bot..   
-000393b0: 2020 2020 2020 2020 2020 2020 2073 5f74               s_t
-000393c0: 6f70 3d73 7572 6673 5f69 725b 695d 2023  op=surfs_ir[i] #
-000393d0: 2074 6f70 0d0a 2020 2020 2020 2020 2020   top..          
-000393e0: 2020 2020 2020 613d 4172 6368 5461 626c        a=ArchTabl
-000393f0: 652e 636f 6d70 7574 655f 646f 6d61 696e  e.compute_domain
-00039400: 2873 5f74 6f70 2c20 735f 626f 7429 0d0a  (s_top, s_bot)..
-00039410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039420: 7265 616c 5f64 6f6d 6169 6e73 5b69 7265  real_domains[ire
-00039430: 616c 2c20 695d 3d61 2a6d 6173 6b2a 7365  al, i]=a*mask*se
-00039440: 6c66 2e6c 6973 745f 756e 6974 735b 695d  lf.list_units[i]
-00039450: 2e49 440d 0a20 2020 2020 2020 2020 2020  .ID..           
-00039460: 2020 2020 2073 7572 6673 5f62 6f74 5b69       surfs_bot[i
-00039470: 7265 616c 2c20 695d 3d73 5f62 6f74 0d0a  real, i]=s_bot..
-00039480: 0d0a 0d0a 2020 2020 2020 2020 236f 6e6c  ....        #onl
-00039490: 7920 3120 6269 6720 6172 7261 790d 0a20  y 1 big array.. 
-000394a0: 2020 2020 2020 2061 3d6e 702e 7375 6d28         a=np.sum(
-000394b0: 7265 616c 5f64 6f6d 6169 6e73 2c20 6178  real_domains, ax
-000394c0: 6973 3d31 290d 0a20 2020 2020 2020 2041  is=1)..        A
-000394d0: 7263 6854 6162 6c65 2e47 656f 6c2e 756e  rchTable.Geol.un
-000394e0: 6974 735f 646f 6d61 696e 735b 6120 213d  its_domains[a !=
-000394f0: 2030 5d3d 615b 6120 213d 2030 5d0d 0a20   0]=a[a != 0].. 
-00039500: 2020 2020 2020 2064 656c 2872 6561 6c5f         del(real_
-00039510: 646f 6d61 696e 7329 0d0a 2020 2020 2020  domains)..      
-00039520: 2020 4172 6368 5461 626c 652e 4765 6f6c    ArchTable.Geol
-00039530: 2e73 7572 6661 6365 735f 6279 5f70 696c  .surfaces_by_pil
-00039540: 6573 5b73 656c 662e 6e61 6d65 5d3d 7375  es[self.name]=su
-00039550: 7266 730d 0a20 2020 2020 2020 2041 7263  rfs..        Arc
-00039560: 6854 6162 6c65 2e47 656f 6c2e 7375 7266  hTable.Geol.surf
-00039570: 6163 6573 5f62 6f74 5f62 795f 7069 6c65  aces_bot_by_pile
-00039580: 735b 7365 6c66 2e6e 616d 655d 3d73 7572  s[self.name]=sur
-00039590: 6673 5f62 6f74 0d0a 2020 2020 2020 2020  fs_bot..        
-000395a0: 4172 6368 5461 626c 652e 4765 6f6c 2e6f  ArchTable.Geol.o
-000395b0: 7267 5f73 7572 6661 6365 735f 6279 5f70  rg_surfaces_by_p
-000395c0: 696c 6573 5b73 656c 662e 6e61 6d65 5d3d  iles[self.name]=
-000395d0: 6f72 675f 7375 7266 730d 0a0d 0a20 2020  org_surfs....   
-000395e0: 2020 2020 2069 6620 7662 3a0d 0a20 2020       if vb:..   
-000395f0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00039600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00039610: 2323 2323 2323 2323 2323 5c6e 2229 0d0a  ##########\n")..
-00039620: 0d0a 0d0a 636c 6173 7320 556e 6974 2829  ....class Unit()
-00039630: 3a0d 0a0d 0a20 2020 2022 2222 0d0a 2020  :....    """..  
-00039640: 2020 5468 6973 2063 6c61 7373 2064 6566    This class def
-00039650: 696e 6573 2055 6e69 7420 6f62 6a65 6374  ines Unit object
-00039660: 732c 2077 6869 6368 2061 7265 2074 6865  s, which are the
-00039670: 2062 7569 6c64 696e 6720 626c 6f63 6b73   building blocks
-00039680: 206f 6620 7468 6520 5069 6c65 2063 6c61   of the Pile cla
-00039690: 7373 2e0d 0a0d 0a20 2020 2050 6172 616d  ss.....    Param
-000396a0: 6574 6572 730d 0a20 2020 202d 2d2d 2d2d  eters..    -----
-000396b0: 2d2d 2d2d 2d0d 0a20 2020 206e 616d 6520  -----..    name 
-000396c0: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
-000396d0: 2020 6e61 6d65 206f 6620 7468 6520 756e    name of the un
-000396e0: 6974 2074 6861 7420 7769 6c6c 2062 6520  it that will be 
-000396f0: 7573 6564 2061 7320 616e 2069 6465 6e74  used as an ident
-00039700: 6966 6965 720d 0a20 2020 206f 7264 6572  ifier..    order
-00039710: 203a 2069 6e74 0d0a 2020 2020 2020 2020   : int..        
-00039720: 6f72 6465 7220 6f66 2074 6865 2075 6e69  order of the uni
-00039730: 7420 696e 2074 6865 2070 696c 6520 2831  t in the pile (1
-00039740: 2028 746f 7029 2074 6f20 6e20 2862 6f74   (top) to n (bot
-00039750: 746f 6d29 2c20 7768 6572 6520 6e20 6973  tom), where n is
-00039760: 2074 6865 2074 6f74 616c 206e 756d 6265   the total numbe
-00039770: 7220 6f66 2075 6e69 7473 290d 0a20 2020  r of units)..   
-00039780: 2063 6f6c 6f72 203a 2073 7472 696e 670d   color : string.
-00039790: 0a20 2020 2020 2020 2063 6f6c 6f72 2074  .        color t
-000397a0: 6f20 7573 6520 666f 7220 706c 6f74 7469  o use for plotti
-000397b0: 6e67 2061 6e64 2072 6570 7265 7365 6e74  ng and represent
-000397c0: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
-000397d0: 5468 6520 636f 6c6f 7220 6361 6e20 6265  The color can be
-000397e0: 2061 6e79 2063 6f6c 6f72 2074 6861 7420   any color that 
-000397f0: 6973 2061 6363 6570 7465 6420 6279 206d  is accepted by m
-00039800: 6174 706c 6f74 6c69 620d 0a20 2020 2073  atplotlib..    s
-00039810: 7572 6661 6365 203a 203a 636c 6173 733a  urface : :class:
-00039820: 6053 7572 6661 6365 6020 6f62 6a65 6374  `Surface` object
-00039830: 0d0a 2020 2020 2020 2020 7375 7266 6163  ..        surfac
-00039840: 6520 6f62 6a65 6374 2074 6861 7420 6465  e object that de
-00039850: 6669 6e65 7320 7468 6520 7375 7266 6163  fines the surfac
-00039860: 6520 6f66 2074 6865 2075 6e69 740d 0a20  e of the unit.. 
-00039870: 2020 2049 4420 3a20 696e 740d 0a20 2020     ID : int..   
-00039880: 2020 2020 2049 4420 6f66 2074 6865 2075       ID of the u
-00039890: 6e69 742c 2069 6620 4e6f 6e65 2c20 7468  nit, if None, th
-000398a0: 6520 4944 2077 696c 6c20 6265 2073 6574  e ID will be set
-000398b0: 2074 6f20 7468 6520 6f72 6465 7220 6f66   to the order of
-000398c0: 2074 6865 2075 6e69 740d 0a20 2020 206d   the unit..    m
-000398d0: 5f75 6e69 745f 6e61 6d65 203a 2073 7472  _unit_name : str
-000398e0: 696e 670d 0a20 2020 2020 2020 2069 6465  ing..        ide
-000398f0: 6e74 6966 6965 7220 6e61 6d65 2069 6620  ntifier name if 
-00039900: 7468 6520 756e 6974 2069 7320 6120 6d75  the unit is a mu
-00039910: 6c74 6970 6c65 2075 6e69 7420 2863 616e  ltiple unit (can
-00039920: 2061 7070 6561 7220 7365 7665 7261 6c20   appear several 
-00039930: 7469 6d65 7320 696e 2074 6865 2070 696c  times in the pil
-00039940: 6529 0d0a 2020 2020 2020 2020 4e6f 7420  e)..        Not 
-00039950: 7965 7420 696d 706c 656d 656e 7465 640d  yet implemented.
-00039960: 0a20 2020 2064 6963 5f66 6163 6965 7320  .    dic_facies 
-00039970: 3a20 6469 6374 0d0a 2020 2020 2020 2020  : dict..        
-00039980: 6469 6374 696f 6e61 7279 2074 6861 7420  dictionary that 
-00039990: 6465 6669 6e65 7320 7468 6520 6661 6369  defines the faci
-000399a0: 6573 206f 6620 7468 6520 756e 6974 2e20  es of the unit. 
-000399b0: 5468 6520 6d61 6e64 6174 6f72 7920 6b65  The mandatory ke
-000399c0: 7973 2066 6f72 2074 6865 2064 6963 7469  ys for the dicti
-000399d0: 6f6e 6172 7920 6172 653a 0d0a 0d0a 2020  onary are:....  
-000399e0: 2020 2020 2020 2d20 665f 6d65 7468 6f64        - f_method
-000399f0: 203a 2073 7472 696e 672c 2076 616c 6162   : string, valab
-00039a00: 6c65 206d 6574 686f 6420 6172 653a 200d  le method are: .
-00039a10: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
-00039a20: 2022 686f 6d6f 6765 6e6f 7573 2220 3a20   "homogenous" : 
-00039a30: 686f 6d6f 6765 6e6f 7573 2066 6163 6965  homogenous facie
-00039a40: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
-00039a50: 2022 5375 6250 696c 6522 203a 2066 6163   "SubPile" : fac
-00039a60: 6965 7320 6172 6520 7369 6d75 6c61 7465  ies are simulate
-00039a70: 6420 7769 7468 2061 2073 7562 7069 6c65  d with a subpile
-00039a80: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00039a90: 2253 4953 2220 3a20 6661 6369 6573 2061  "SIS" : facies a
-00039aa0: 7265 2073 696d 756c 6174 6564 2077 6974  re simulated wit
-00039ab0: 6820 7374 6f63 6861 7374 6963 2069 6e64  h stochastic ind
-00039ac0: 6963 6174 6f72 2073 696d 756c 6174 696f  icator simulatio
-00039ad0: 6e0d 0a20 2020 2020 2020 2020 2020 202d  n..            -
-00039ae0: 2022 4d50 5322 203a 2066 6163 6965 7320   "MPS" : facies 
-00039af0: 6172 6520 7369 6d75 6c61 7465 6420 7769  are simulated wi
-00039b00: 7468 204d 756c 7469 706c 6520 706f 696e  th Multiple poin
-00039b10: 7473 2073 7461 7469 7374 6963 730d 0a20  ts statistics.. 
-00039b20: 2020 2020 2020 2020 2020 202d 2022 5450             - "TP
-00039b30: 4773 223a 2066 6163 6965 7320 6172 6520  Gs": facies are 
-00039b40: 7369 6d75 6c61 7465 6420 7769 7468 2054  simulated with T
-00039b50: 7275 6e63 6174 6564 2070 6c75 7269 2d47  runcated pluri-G
-00039b60: 6175 7373 6961 6e20 6d65 7468 6f64 0d0a  aussian method..
-00039b70: 2020 2020 2020 2020 2d20 665f 636f 766d          - f_covm
-00039b80: 6f64 656c 203a 2033 4420 6765 6f6e 6520  odel : 3D geone 
-00039b90: 636f 7661 7269 616e 6365 206d 6f64 656c  covariance model
-00039ba0: 206f 626a 6563 7420 6f72 206c 6973 7420   object or list 
-00039bb0: 6f66 2033 4420 6765 6f6e 6520 636f 7661  of 3D geone cova
-00039bc0: 7269 616e 6365 206d 6f64 656c 206f 626a  riance model obj
-00039bd0: 6563 7473 206f 6e6c 7920 7573 6564 2077  ects only used w
-00039be0: 6974 6820 2253 4953 2220 6d65 7468 6f64  ith "SIS" method
-00039bf0: 0d0a 2020 2020 2020 2020 2d20 5449 203a  ..        - TI :
-00039c00: 2067 656f 6e65 2e69 6d61 6765 2c20 5472   geone.image, Tr
-00039c10: 6169 6e69 6e67 2069 6d61 6765 2066 6f72  aining image for
-00039c20: 2022 4d50 5322 206d 6574 686f 640d 0a20   "MPS" method.. 
-00039c30: 2020 2020 2020 202d 2053 7562 5069 6c65         - SubPile
-00039c40: 203a 203a 636c 6173 733a 6050 696c 6560   : :class:`Pile`
-00039c50: 206f 626a 6563 742c 2073 7562 7069 6c65   object, subpile
-00039c60: 2066 6f72 2022 5375 6250 696c 6522 206d   for "SubPile" m
-00039c70: 6574 686f 640d 0a20 2020 200d 0a20 2020  ethod..    ..   
-00039c80: 2020 2020 2046 6163 6965 7320 6b65 7977       Facies keyw
-00039c90: 6f72 6420 6172 6775 6d65 6e74 7320 746f  ord arguments to
-00039ca0: 2070 6173 7320 746f 2074 6865 2066 6163   pass to the fac
-00039cb0: 6965 7320 6d65 7468 6f64 7320 2874 6865  ies methods (the
-00039cc0: 7365 2073 686f 756c 6420 6265 2070 6173  se should be pas
-00039cd0: 7320 7468 726f 7567 6820 6469 635f 6661  s through dic_fa
-00039ce0: 6369 6573 2021 293a 0d0a 2020 2020 2020  cies !):..      
-00039cf0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00039d00: 2d20 2253 4953 2220 3a0d 0a20 2020 2020  - "SIS" :..     
-00039d10: 2020 2020 2020 2020 2020 202d 2022 6e65             - "ne
-00039d20: 6967 6822 203a 2069 6e74 2c20 6e75 6d62  igh" : int, numb
-00039d30: 6572 206f 6620 6e65 6967 6862 6f72 7320  er of neighbors 
-00039d40: 746f 2075 7365 2066 6f72 2074 6865 2053  to use for the S
-00039d50: 4953 0d0a 2020 2020 2020 2020 2020 2020  IS..            
-00039d60: 2020 2020 2d20 7220 3a20 666c 6f61 742c      - r : float,
-00039d70: 2072 6164 6975 7320 6f66 2074 6865 206e   radius of the n
-00039d80: 6569 6768 626f 7268 6f6f 6420 746f 2075  eighborhood to u
-00039d90: 7365 2066 6f72 2074 6865 2053 4953 0d0a  se for the SIS..
-00039da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039db0: 2d20 7072 6f62 6162 696c 6974 7920 3a20  - probability : 
-00039dc0: 6c69 7374 206f 6620 666c 6f61 742c 2070  list of float, p
-00039dd0: 726f 706f 7274 696f 6e20 6f66 2065 6163  roportion of eac
-00039de0: 6820 6661 6369 6573 2074 6f20 7573 6520  h facies to use 
-00039df0: 666f 7220 7468 6520 5349 530d 0a20 2020  for the SIS..   
-00039e00: 2020 2020 2020 2020 202d 2054 4920 2020           - TI   
-00039e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e20: 203a 2067 656f 6e65 2069 6d67 2c20 5472   : geone img, Tr
-00039e30: 6169 6e69 6e67 2069 6d61 6765 2873 2920  aining image(s) 
-00039e40: 746f 2075 7365 0d0a 2020 2020 2020 2020  to use..        
-00039e50: 2020 2020 2020 2020 2d20 6d70 7320 2263          - mps "c
-00039e60: 6c61 7373 6963 2220 7061 7261 6d65 7465  lassic" paramete
-00039e70: 7273 2028 6d61 7873 6361 6e2c 2074 6872  rs (maxscan, thr
-00039e80: 6573 682c 206e 6569 6720 286e 756d 6265  esh, neig (numbe
-00039e90: 7220 6f66 206e 6569 6768 626f 7572 7329  r of neighbours)
-00039ea0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00039eb0: 2020 202d 206e 706f 7374 2020 2020 2020     - npost      
-00039ec0: 2020 2020 2020 2020 2020 203a 206e 756d             : num
-00039ed0: 6265 7220 6f66 2070 6174 6820 706f 7374  ber of path post
-00039ee0: 7072 6f63 6573 7369 6e67 2c20 6465 6661  processing, defa
-00039ef0: 756c 7420 310d 0a20 2020 2020 2020 2020  ult 1..         
-00039f00: 2020 2020 2020 202d 2072 6164 6975 734d         - radiusM
-00039f10: 6f64 6520 2020 2020 2020 2020 2020 203a  ode            :
-00039f20: 2072 6164 6975 7320 6d6f 6465 2074 6f20   radius mode to 
-00039f30: 7573 6520 2863 6865 636b 2064 6565 7373  use (check deess
-00039f40: 6520 6d61 6e75 616c 290d 0a20 2020 2020  e manual)..     
-00039f50: 2020 2020 2020 2020 2020 202d 2061 6e69             - ani
-00039f60: 736f 7472 6f70 7952 6174 696f 4d6f 6465  sotropyRatioMode
-00039f70: 2020 203a 2041 6e69 736f 7472 6f70 7920     : Anisotropy 
-00039f80: 7261 7469 6f20 746f 2075 7365 2069 6e20  ratio to use in 
-00039f90: 7265 6173 6561 7263 6820 6f66 206e 6569  reasearch of nei
-00039fa0: 6768 626f 7572 7320 2863 6865 636b 2064  ghbours (check d
-00039fb0: 6565 7373 6520 6d61 6e75 616c 290d 0a20  eesse manual).. 
-00039fc0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-00039fd0: 2072 782c 2072 792c 2072 7a20 2020 2020   rx, ry, rz     
-00039fe0: 2020 2020 2020 203a 2072 6164 6975 7320         : radius 
-00039ff0: 696e 2078 2c20 7920 616e 6420 7a20 6469  in x, y and z di
-0003a000: 7265 6374 696f 6e0d 0a20 2020 2020 2020  rection..       
-0003a010: 2020 2020 2020 2020 202d 2061 6e67 6c65           - angle
-0003a020: 312c 2061 6e67 6c65 322c 2061 6e67 6c65  1, angle2, angle
-0003a030: 333a 2065 6c6c 6970 736f 6964 206f 6620  3: ellipsoid of 
-0003a040: 7265 7365 6172 6368 2072 6f74 6174 696f  research rotatio
-0003a050: 6e20 616e 676c 6573 0d0a 2020 2020 2020  n angles..      
-0003a060: 2020 2020 2020 2020 2020 2d20 6178 2c20            - ax, 
-0003a070: 6179 2c20 617a 2020 2020 2020 2020 2020  ay, az          
-0003a080: 2020 3a20 616e 6973 6f74 726f 7079 2072    : anisotropy r
-0003a090: 6174 696f 2066 6f72 2072 6573 6561 7263  atio for researc
-0003a0a0: 6820 656c 6c69 7073 6f69 640d 0a20 2020  h ellipsoid..   
-0003a0b0: 2020 2020 2020 2020 2020 2020 202d 2072               - r
-0003a0c0: 6f74 5f75 7361 6765 2020 2020 2020 2020  ot_usage        
-0003a0d0: 2020 2020 203a 2030 2c20 3120 6f72 2032       : 0, 1 or 2
-0003a0e0: 2028 6368 6563 6b20 6465 6573 7365 206d   (check deesse m
-0003a0f0: 616e 7561 6c29 0d0a 2020 2020 2020 2020  anual)..        
-0003a100: 2020 2020 2020 2020 2d20 726f 7441 7a69          - rotAzi
-0003a110: 4c6f 632c 2072 6f74 4469 704c 6f63 2c20  Loc, rotDipLoc, 
-0003a120: 3a20 6c6f 6361 6c20 726f 7461 7469 6f6e  : local rotation
-0003a130: 2c20 5472 7565 206f 7220 4661 6c73 6520  , True or False 
-0003a140: 3f0d 0a20 2020 2020 2020 2020 2020 2020  ?..             
-0003a150: 2020 2020 2072 6f74 506c 756e 6765 4c6f       rotPlungeLo
-0003a160: 630d 0a20 2020 2020 2020 2020 2020 2020  c..             
-0003a170: 2020 202d 2072 6f74 417a 692c 2072 6f74     - rotAzi, rot
-0003a180: 4469 702c 2020 2020 2020 203a 2067 6c6f  Dip,       : glo
-0003a190: 6261 6c20 726f 7461 7469 6f6e 2061 6e67  bal rotation ang
-0003a1a0: 6c65 733a 2076 616c 7565 732c 206d 696e  les: values, min
-0003a1b0: 2d6d 6178 2c20 6d61 7073 2c20 7365 6520  -max, maps, see 
-0003a1c0: 6465 6573 7365 5f69 6e70 7574 2064 6f63  deesse_input doc
-0003a1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003a1e0: 2020 2020 726f 7450 6c75 6e67 6520 2020      rotPlunge   
-0003a1f0: 2020 2020 2020 2020 2020 2020 200d 0a20               .. 
-0003a200: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0003a210: 2078 722c 2079 722c 207a 7220 2020 2020   xr, yr, zr     
-0003a220: 2020 2020 2020 203a 2072 6174 696f 2066         : ratio f
-0003a230: 6f72 2067 656f 6d20 7472 616e 7366 6f72  or geom transfor
-0003a240: 6d61 7469 6f6e 0d0a 2020 2020 2020 2020  mation..        
-0003a250: 2020 2020 2020 2020 2d20 786c 6f63 2c20          - xloc, 
-0003a260: 796c 6f63 2c20 7a6c 6f63 2020 2020 2020  yloc, zloc      
-0003a270: 3a20 6c6f 6361 6c20 6f72 206e 6f74 2074  : local or not t
-0003a280: 7261 6e73 666f 726d 6174 696f 6e0d 0a20  ransformation.. 
-0003a290: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0003a2a0: 2068 6f6d 6f5f 7573 6167 6520 2020 2020   homo_usage     
-0003a2b0: 2020 2020 2020 203a 2068 6f6d 6f74 6865         : homothe
-0003a2c0: 7479 2075 7361 6765 0d0a 2020 2020 2020  ty usage..      
-0003a2d0: 2020 2020 2020 2020 2020 2d20 7072 6f62            - prob
-0003a2e0: 6155 7361 6765 2020 2020 2020 2020 2020  aUsage          
-0003a2f0: 2020 3a20 7072 6f62 6162 696c 6974 7920    : probability 
-0003a300: 636f 6e73 7472 6169 6e74 2075 7361 6765  constraint usage
-0003a310: 2c20 3020 666f 7220 6e6f 2070 726f 6261  , 0 for no proba
-0003a320: 2063 6f6e 7374 7261 696e 742c 2031 2066   constraint, 1 f
-0003a330: 6f72 2067 6c6f 6261 6c20 7072 6f70 6f72  or global propor
-0003a340: 7469 6f6e 2064 6566 696e 6564 2069 6e20  tion defined in 
-0003a350: 676c 6f62 616c 5064 662c 2032 2066 6f72  globalPdf, 2 for
-0003a360: 206c 6f63 616c 2070 726f 706f 7274 696f   local proportio
-0003a370: 6e20 6465 6669 6e65 6420 696e 206c 6f63  n defined in loc
-0003a380: 616c 5064 660d 0a20 2020 2020 2020 2020  alPdf..         
-0003a390: 2020 2020 2020 202d 2067 6c6f 6261 6c50         - globalP
-0003a3a0: 6466 2020 2020 2020 2020 2020 2020 203a  df             :
-0003a3b0: 2061 7272 6179 2d6c 696b 6520 6f66 2066   array-like of f
-0003a3c0: 6c6f 6174 206f 6620 6c65 6e67 7468 2065  loat of length e
-0003a3d0: 7175 616c 2074 6f20 7468 6520 6e75 6d62  qual to the numb
-0003a3e0: 6572 206f 6620 636c 6173 732c 2070 726f  er of class, pro
-0003a3f0: 706f 7274 696f 6e20 666f 7220 6561 6368  portion for each
-0003a400: 2063 6c61 7373 0d0a 2020 2020 2020 2020   class..        
-0003a410: 2020 2020 2020 2020 2d20 6c6f 6361 6c50          - localP
-0003a420: 6466 2020 2020 2020 2020 2020 2020 2020  df              
-0003a430: 3a20 286e 636c 6173 732c 206e 7a2c 206e  : (nclass, nz, n
-0003a440: 792c 206e 7829 2061 7272 6179 206f 6620  y, nx) array of 
-0003a450: 666c 6f61 7473 2070 726f 6261 6269 6c69  floats probabili
-0003a460: 7479 2066 6f72 2065 6163 6820 636c 6173  ty for each clas
-0003a470: 732c 206c 6f63 616c 5064 665b 695d 2069  s, localPdf[i] i
-0003a480: 7320 7468 6520 226d 6170 2064 6566 696e  s the "map defin
-0003a490: 6564 206f 6e20 7468 6520 7369 6d75 6c61  ed on the simula
-0003a4a0: 7469 6f6e 2067 7269 640d 0a20 2020 2020  tion grid..     
-0003a4b0: 2020 2020 2020 2020 2020 202d 206c 6f63             - loc
-0003a4c0: 616c 5064 6652 6164 6975 7320 2020 2020  alPdfRadius     
-0003a4d0: 2020 203a 2073 7570 706f 7274 2072 6164     : support rad
-0003a4e0: 6975 7320 666f 7220 6c6f 6361 6c20 7064  ius for local pd
-0003a4f0: 662c 2064 6566 6175 6c74 2069 7320 320d  f, default is 2.
-0003a500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a510: 202d 2064 6561 6374 6976 6174 696f 6e44   - deactivationD
-0003a520: 6973 7461 6e63 6520 203a 2066 6c6f 6174  istance  : float
-0003a530: 2c20 6469 7374 616e 6365 2061 7420 7768  , distance at wh
-0003a540: 6963 6820 6c6f 6361 6c50 6466 2061 7265  ich localPdf are
-0003a550: 2064 6561 6374 6976 6174 6564 2028 7365   deactivated (se
-0003a560: 6520 4465 6573 7365 2064 6f63 290d 0a20  e Deesse doc).. 
-0003a570: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-0003a580: 2063 6f6e 7374 616e 7454 6872 6573 686f   constantThresho
-0003a590: 6c64 2020 2020 203a 2066 6c6f 6174 2c20  ld     : float, 
-0003a5a0: 7468 7265 7368 6f6c 6420 7661 6c75 6520  threshold value 
-0003a5b0: 666f 7220 7064 6627 7320 636f 6d70 6172  for pdf's compar
-0003a5c0: 6973 6f6e 0d0a 2020 2020 2020 2020 2020  ison..          
-0003a5d0: 2020 2020 2020 2d20 6461 7461 496d 6167        - dataImag
-0003a5e0: 6520 2020 2020 2020 2020 2020 2020 3a20  e             : 
-0003a5f0: 6765 6f6e 6520 696d 6720 7573 6564 2061  geone img used a
-0003a600: 7320 6461 7461 2c20 7365 6520 6465 6573  s data, see dees
-0003a610: 7365 2f67 656f 6e65 2064 6f63 756d 656e  se/geone documen
-0003a620: 7461 7469 6f6e 0d0a 2020 2020 2020 2020  tation..        
-0003a630: 2020 2020 2020 2020 2d20 6f75 7470 7574          - output
-0003a640: 5661 7246 6c61 6720 2020 2020 2020 2020  VarFlag         
-0003a650: 3a20 626f 6f6c 206f 7220 6c69 7374 206f  : bool or list o
-0003a660: 6620 626f 6f6c 206f 6620 7369 7a65 206e  f bool of size n
-0003a670: 762c 2074 6f20 6f75 7470 7574 206f 7220  v, to output or 
-0003a680: 6e6f 7420 7468 6520 7661 7269 6162 6c65  not the variable
-0003a690: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0003a6a0: 2020 202d 2064 6973 7461 6e63 6554 7970     - distanceTyp
-0003a6b0: 6520 2020 2020 2020 2020 203a 2073 7472  e          : str
-0003a6c0: 696e 6720 6f72 206c 6973 7420 6f66 2073  ing or list of s
-0003a6d0: 7472 696e 6773 2c20 2263 6174 6567 6f72  trings, "categor
-0003a6e0: 6963 616c 2220 6f72 2022 636f 6e74 696e  ical" or "contin
-0003a6f0: 756f 7573 220d 0a0d 0a20 2020 2020 2020  uous"....       
-0003a700: 2020 2020 202d 2054 5047 733a 0d0a 2020       - TPGs:..  
-0003a710: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-0003a720: 666c 6167 3a20 6469 6374 696f 6e61 7279  flag: dictionary
-0003a730: 206f 6620 6c69 6d69 7473 206f 6620 6375   of limits of cu
-0003a740: 626f 6964 7320 646f 6d61 696e 7320 696e  boids domains in
-0003a750: 2047 6175 7373 6961 6e20 7370 6163 652c   Gaussian space,
-0003a760: 2063 6865 636b 202e 2e2e 2066 6f72 2074   check ... for t
-0003a770: 6865 2072 6967 6874 2066 6f72 6d61 742e  he right format.
-0003a780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003a790: 2020 2d20 496b 5f63 6d3a 2069 6e64 6963    - Ik_cm: indic
-0003a7a0: 6174 6f72 2063 6f76 6d6f 6465 6c73 0d0a  ator covmodels..
-0003a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a7c0: 2d20 475f 636d 3a20 6c69 7374 206f 6620  - G_cm: list of 
-0003a7d0: 4761 7573 7369 616e 2063 6f76 6d6f 6465  Gaussian covmode
-0003a7e0: 6c73 2066 6f72 2074 6865 2074 776f 2067  ls for the two g
-0003a7f0: 6175 7373 6961 6e20 6669 656c 6473 2c20  aussian fields, 
-0003a800: 6361 6e20 6265 2069 6e66 6572 6564 2066  can be infered f
-0003a810: 726f 6d20 496b 5f63 6d0d 0a20 2020 2020  rom Ik_cm..     
-0003a820: 2020 2020 2020 2020 2020 202d 2076 6172             - var
-0003a830: 696f 7573 2070 6172 616d 6574 6572 733a  ious parameters:
-0003a840: 2028 6475 2c20 6476 202d 2d3e 2070 7265   (du, dv --> pre
-0003a850: 6369 7369 6f6e 206f 6620 696e 7465 6772  cision of integr
-0003a860: 616c 7320 666f 7220 475f 636d 2069 6e66  als for G_cm inf
-0003a870: 6572 656e 6365 292c 0d0a 2020 2020 2020  erence),..      
-0003a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8a0: 2864 696d 3a20 6469 6d65 6e73 696f 6e20  (dim: dimension 
-0003a8b0: 7761 6e74 6564 2066 6f72 2047 5f63 6d20  wanted for G_cm 
-0003a8c0: 696e 6665 7265 6e63 652c 0d0a 2020 2020  inference,..    
-0003a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a8f0: 2020 2863 5f72 6567 3a20 7265 6775 6c61    (c_reg: regula
-0003a900: 7269 7361 7469 6f6e 2074 6572 6d20 666f  risation term fo
-0003a910: 7220 475f 636d 2069 6e66 6572 656e 6365  r G_cm inference
-0003a920: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
-0003a930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a940: 2020 2020 2020 2020 2020 286e 3a20 6e75            (n: nu
-0003a950: 6d62 6572 206f 6620 636f 6e74 726f 6c20  mber of control 
-0003a960: 706f 696e 7473 2066 6f72 2047 5f63 6d20  points for G_cm 
-0003a970: 696e 6665 7265 6e63 6529 290d 0a0d 0a20  inference)).... 
-0003a980: 2020 2022 2222 0d0a 0d0a 2020 2020 6465     """....    de
-0003a990: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-0003a9a0: 206e 616d 652c 206f 7264 6572 2c20 636f   name, order, co
-0003a9b0: 6c6f 722c 2073 7572 6661 6365 3d4e 6f6e  lor, surface=Non
-0003a9c0: 652c 2049 443d 4e6f 6e65 2c20 6d5f 756e  e, ID=None, m_un
-0003a9d0: 6974 5f6e 616d 653d 4e6f 6e65 2c0d 0a20  it_name=None,.. 
-0003a9e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0003a9f0: 6963 5f66 6163 6965 733d 7b22 665f 6d65  ic_facies={"f_me
-0003aa00: 7468 6f64 223a 2022 686f 6d6f 6765 6e6f  thod": "homogeno
-0003aa10: 7573 222c 2022 665f 636f 766d 6f64 656c  us", "f_covmodel
-0003aa20: 223a 204e 6f6e 652c 2022 5449 223a 204e  ": None, "TI": N
-0003aa30: 6f6e 652c 2022 5375 6250 696c 6522 3a20  one, "SubPile": 
-0003aa40: 4e6f 6e65 2c20 2246 6c61 6722 3a20 4e6f  None, "Flag": No
-0003aa50: 6e65 2c20 2247 5f63 6d22 3a20 4e6f 6e65  ne, "G_cm": None
-0003aa60: 7d2c 0d0a 2020 2020 2020 2020 2020 2020  },..            
-0003aa70: 2020 2020 636f 6e74 6163 743d 226f 6e6c      contact="onl
-0003aa80: 6170 222c 2076 6572 626f 7365 3d31 293a  ap", verbose=1):
-0003aa90: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-0003aaa0: 6173 7365 7274 2049 4420 213d 2030 2c20  assert ID != 0, 
-0003aab0: 2249 4420 6361 6e6e 6f74 2062 6520 3022  "ID cannot be 0"
-0003aac0: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-0003aad0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-0003aae0: 652c 2022 4120 6e61 6d65 206d 7573 7420  e, "A name must 
-0003aaf0: 6265 2070 726f 7669 6465 6422 0d0a 2020  be provided"..  
-0003ab00: 2020 2020 2020 6173 7365 7274 2069 7369        assert isi
-0003ab10: 6e73 7461 6e63 6528 2073 7572 6661 6365  nstance( surface
-0003ab20: 2c20 5375 7266 6163 6529 2c20 2241 2073  , Surface), "A s
-0003ab30: 7572 6661 6365 206f 626a 6563 7420 6d75  urface object mu
-0003ab40: 7374 2062 6520 7072 6f76 6964 6564 2066  st be provided f
-0003ab50: 6f72 2065 6163 6820 756e 6974 220d 0a0d  or each unit"...
-0003ab60: 0a20 2020 2020 2020 2073 656c 662e 6e61  .        self.na
-0003ab70: 6d65 3d6e 616d 650d 0a20 2020 2020 2020  me=name..       
-0003ab80: 2073 656c 662e 6f72 6465 723d 6f72 6465   self.order=orde
-0003ab90: 720d 0a20 2020 2020 2020 2073 656c 662e  r..        self.
-0003aba0: 636f 6e74 6163 743d 636f 6e74 6163 740d  contact=contact.
-0003abb0: 0a20 2020 2020 2020 2073 656c 662e 633d  .        self.c=
-0003abc0: 636f 6c6f 720d 0a20 2020 2020 2020 2073  color..        s
-0003abd0: 656c 662e 6d5f 756e 6974 5f6e 616d 653d  elf.m_unit_name=
-0003abe0: 6d5f 756e 6974 5f6e 616d 650d 0a0d 0a20  m_unit_name.... 
-0003abf0: 2020 2020 2020 2069 6620 4944 2069 7320         if ID is 
-0003ac00: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0003ac10: 2020 2073 656c 662e 4944 3d6f 7264 6572     self.ID=order
-0003ac20: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0003ac30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003ac40: 662e 4944 3d49 440d 0a20 2020 2020 2020  f.ID=ID..       
-0003ac50: 2073 656c 662e 5375 6250 696c 653d 4e6f   self.SubPile=No
-0003ac60: 6e65 0d0a 2020 2020 2020 2020 7365 6c66  ne..        self
-0003ac70: 2e76 6572 626f 7365 3d76 6572 626f 7365  .verbose=verbose
-0003ac80: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
-0003ac90: 6973 745f 6661 6369 6573 3d5b 5d0d 0a20  ist_facies=[].. 
-0003aca0: 2020 2020 2020 2073 656c 662e 6262 5f75         self.bb_u
-0003acb0: 6e69 7473 203d 205b 5d0d 0a20 2020 2020  nits = []..     
-0003acc0: 2020 2073 656c 662e 7820 3d20 5b5d 2020     self.x = []  
-0003acd0: 2320 6461 7461 2063 6f6f 7264 696e 6174  # data coordinat
-0003ace0: 6573 2066 6f72 2063 6174 6567 6f72 6963  es for categoric
-0003acf0: 616c 2073 696d 756c 6174 696f 6e73 0d0a  al simulations..
-0003ad00: 2020 2020 2020 2020 7365 6c66 2e79 203d          self.y =
-0003ad10: 205b 5d20 2023 2064 6174 6120 636f 6f72   []  # data coor
-0003ad20: 6469 6e61 7465 7320 666f 7220 6361 7465  dinates for cate
-0003ad30: 676f 7269 6361 6c20 7369 6d75 6c61 7469  gorical simulati
-0003ad40: 6f6e 730d 0a20 2020 2020 2020 2073 656c  ons..        sel
-0003ad50: 662e 7a20 3d20 5b5d 2020 2320 6461 7461  f.z = []  # data
-0003ad60: 2063 6f6f 7264 696e 6174 6573 2066 6f72   coordinates for
-0003ad70: 2063 6174 6567 6f72 6963 616c 2073 696d   categorical sim
-0003ad80: 756c 6174 696f 6e73 0d0a 2020 2020 2020  ulations..      
-0003ad90: 2020 7365 6c66 2e6d 756d 6d79 5f75 6e69    self.mummy_uni
-0003ada0: 743d 4e6f 6e65 0d0a 2020 2020 2020 2020  t=None..        
-0003adb0: 7365 6c66 2e73 6574 5f64 6963 5f66 6163  self.set_dic_fac
-0003adc0: 6965 7328 6469 635f 6661 6369 6573 2920  ies(dic_facies) 
-0003add0: 2373 6574 2064 6963 2066 6163 6965 7320  #set dic facies 
-0003ade0: 746f 2075 6e69 740d 0a0d 0a20 2020 2020  to unit....     
-0003adf0: 2020 2069 6620 7375 7266 6163 6520 6973     if surface is
-0003ae00: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0003ae10: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
-0003ae20: 5f53 7572 6661 6365 2873 7572 6661 6365  _Surface(surface
-0003ae30: 290d 0a0d 0a0d 0a20 2020 2064 6566 2073  )......    def s
-0003ae40: 6574 5f64 6963 5f66 6163 6965 7328 7365  et_dic_facies(se
-0003ae50: 6c66 2c20 6469 635f 6661 6369 6573 293a  lf, dic_facies):
-0003ae60: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0003ae70: 0a20 2020 2020 2020 2053 6574 2061 2064  .        Set a d
-0003ae80: 6963 7469 6f6e 6172 7920 6661 6369 6573  ictionary facies
-0003ae90: 2074 6f20 556e 6974 206f 626a 6563 740d   to Unit object.
-0003aea0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003aeb0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003aec0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0003aed0: 2020 2064 6963 5f66 6163 6965 7320 3a20     dic_facies : 
-0003aee0: 6469 6374 0d0a 2020 2020 2020 2020 2020  dict..          
-0003aef0: 2020 6469 6374 696f 6e6e 6172 7920 636f    dictionnary co
-0003af00: 6e74 6169 6e69 6e67 2074 6865 2070 6172  ntaining the par
-0003af10: 616d 6574 6572 7320 746f 2070 6173 7320  ameters to pass 
-0003af20: 6174 2074 6865 2066 6163 6965 7320 6d65  at the facies me
-0003af30: 7468 6f64 730d 0a20 2020 2020 2020 2022  thods..        "
-0003af40: 2222 0d0a 0d0a 2020 2020 2020 2020 6173  ""....        as
-0003af50: 7365 7274 2064 6963 5f66 6163 6965 735b  sert dic_facies[
-0003af60: 2266 5f6d 6574 686f 6422 5d20 696e 2028  "f_method"] in (
-0003af70: 224d 5053 222c 2022 5349 5322 2c20 2268  "MPS", "SIS", "h
-0003af80: 6f6d 6f67 656e 6f75 7322 2c20 2254 5047  omogenous", "TPG
-0003af90: 7322 2c20 2253 7562 5069 6c65 2229 2c20  s", "SubPile"), 
-0003afa0: 2746 696c 6c69 6e67 206d 6574 686f 6420  'Filling method 
-0003afb0: 756e 6b6e 6f77 6e2c 2076 616c 6964 7320  unknown, valids 
-0003afc0: 6172 6520 224d 5053 222c 2022 5349 5322  are "MPS", "SIS"
-0003afd0: 2c20 2268 6f6d 6f67 656e 6f75 7322 2c20  , "homogenous", 
-0003afe0: 2254 5047 7322 2c20 2253 7562 5069 6c65  "TPGs", "SubPile
-0003aff0: 270d 0a0d 0a20 2020 2020 2020 2073 656c  '....        sel
-0003b000: 662e 665f 6d65 7468 6f64 3d64 6963 5f66  f.f_method=dic_f
-0003b010: 6163 6965 735b 2266 5f6d 6574 686f 6422  acies["f_method"
-0003b020: 5d0d 0a20 2020 2020 2020 2023 2063 6865  ]..        # che
-0003b030: 636b 2069 6d70 6f72 7461 6e74 2069 6e70  ck important inp
-0003b040: 7574 2066 6f72 2066 6163 6965 7320 6d65  ut for facies me
-0003b050: 7468 6f64 730d 0a20 2020 2020 2020 2023  thods..        #
-0003b060: 4d50 530d 0a20 2020 2020 2020 2069 6620  MPS..        if 
-0003b070: 7365 6c66 2e66 5f6d 6574 686f 6420 3d3d  self.f_method ==
-0003b080: 2022 4d50 5322 3a0d 0a20 2020 2020 2020   "MPS":..       
-0003b090: 2020 2020 2069 6620 2254 4922 206e 6f74       if "TI" not
-0003b0a0: 2069 6e20 6469 635f 6661 6369 6573 2e6b   in dic_facies.k
-0003b0b0: 6579 7328 293a 0d0a 2020 2020 2020 2020  eys():..        
-0003b0c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0003b0d0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
-0003b0e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0003b0f0: 696e 7428 2257 4152 4e49 4e47 204e 4f20  int("WARNING NO 
-0003b100: 5449 2050 4153 5345 4420 464f 5220 4d50  TI PASSED FOR MP
-0003b110: 5320 5349 4d55 4c41 5449 4f4e 2229 0d0a  S SIMULATION")..
-0003b120: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003b130: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003b140: 2020 2073 656c 662e 7365 745f 665f 5449     self.set_f_TI
-0003b150: 2864 6963 5f66 6163 6965 735b 2254 4922  (dic_facies["TI"
-0003b160: 5d29 0d0a 0d0a 2020 2020 2020 2020 2353  ])....        #S
-0003b170: 7562 7069 6c65 0d0a 2020 2020 2020 2020  ubpile..        
-0003b180: 656c 6966 2073 656c 662e 665f 6d65 7468  elif self.f_meth
-0003b190: 6f64 203d 3d20 2253 7562 5069 6c65 223a  od == "SubPile":
-0003b1a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003b1b0: 2022 5375 6250 696c 6522 206e 6f74 2069   "SubPile" not i
-0003b1c0: 6e20 6469 635f 6661 6369 6573 2e6b 6579  n dic_facies.key
-0003b1d0: 7328 293a 0d0a 2020 2020 2020 2020 2020  s():..          
-0003b1e0: 2020 2020 2020 6966 2073 656c 662e 7665        if self.ve
-0003b1f0: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-0003b200: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0003b210: 7428 224e 6f20 5375 6250 696c 6520 7061  t("No SubPile pa
-0003b220: 7373 6564 2066 6f72 2053 7562 5069 6c65  ssed for SubPile
-0003b230: 2066 696c 6c69 6e67 2c20 636f 6e73 6964   filling, consid
-0003b240: 6572 2061 6464 696e 6720 6f6e 6520 7769  er adding one wi
-0003b250: 7468 2073 6574 5f53 7562 5069 6c65 2829  th set_SubPile()
-0003b260: 2062 6566 6f72 6520 7072 6f63 6565 6469   before proceedi
-0003b270: 6e67 2229 0d0a 2020 2020 2020 2020 2020  ng")..          
-0003b280: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0003b290: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
-0003b2a0: 745f 5375 6250 696c 6528 6469 635f 6661  t_SubPile(dic_fa
-0003b2b0: 6369 6573 5b22 5375 6250 696c 6522 5d29  cies["SubPile"])
-0003b2c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003b2d0: 6966 2022 756e 6974 735f 6669 6c6c 5f6d  if "units_fill_m
-0003b2e0: 6574 686f 6422 2069 6e20 6469 635f 6661  ethod" in dic_fa
-0003b2f0: 6369 6573 2e6b 6579 7328 293a 0d0a 2020  cies.keys():..  
-0003b300: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003b310: 2064 6963 5f66 6163 6965 735b 2275 6e69   dic_facies["uni
-0003b320: 7473 5f66 696c 6c5f 6d65 7468 6f64 225d  ts_fill_method"]
-0003b330: 203d 3d20 2253 4953 223a 0d0a 2020 2020   == "SIS":..    
-0003b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b350: 7365 6c66 2e73 6574 5f66 5f63 6f76 6d6f  self.set_f_covmo
-0003b360: 6465 6c73 2864 6963 5f66 6163 6965 735b  dels(dic_facies[
-0003b370: 2266 5f63 6f76 6d6f 6465 6c22 5d29 0d0a  "f_covmodel"])..
-0003b380: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b390: 2020 656c 6966 2064 6963 5f66 6163 6965    elif dic_facie
-0003b3a0: 735b 2275 6e69 7473 5f66 696c 6c5f 6d65  s["units_fill_me
-0003b3b0: 7468 6f64 225d 203d 3d20 224d 5053 223a  thod"] == "MPS":
-0003b3c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b3d0: 2020 2020 2020 6966 2022 5449 2220 6e6f        if "TI" no
-0003b3e0: 7420 696e 2064 6963 5f66 6163 6965 732e  t in dic_facies.
-0003b3f0: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
-0003b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b410: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0003b420: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003b430: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0003b440: 7269 6e74 2822 5741 524e 494e 4720 4e4f  rint("WARNING NO
-0003b450: 2054 4920 5041 5353 4544 2046 4f52 204d   TI PASSED FOR M
-0003b460: 5053 2053 494d 554c 4154 494f 4e22 290d  PS SIMULATION").
-0003b470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b480: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003b490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b4a0: 2020 2020 7365 6c66 2e73 6574 5f66 5f54      self.set_f_T
-0003b4b0: 4928 6469 635f 6661 6369 6573 5b22 5449  I(dic_facies["TI
-0003b4c0: 225d 290d 0a0d 0a20 2020 2020 2020 2020  "])....         
-0003b4d0: 2020 2020 2020 2065 6c69 6620 6469 635f         elif dic_
-0003b4e0: 6661 6369 6573 5b22 756e 6974 735f 6669  facies["units_fi
-0003b4f0: 6c6c 5f6d 6574 686f 6422 5d20 3d3d 2022  ll_method"] == "
-0003b500: 5450 4773 223a 0d0a 2020 2020 2020 2020  TPGs":..        
-0003b510: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-0003b520: 466c 6167 2220 696e 2064 6963 5f66 6163  Flag" in dic_fac
-0003b530: 6965 732e 6b65 7973 2829 3a0d 0a20 2020  ies.keys():..   
-0003b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b550: 2020 2020 2073 656c 662e 666c 6167 203d       self.flag =
-0003b560: 2064 6963 5f66 6163 6965 735b 2246 6c61   dic_facies["Fla
-0003b570: 6722 5d0d 0a20 2020 2020 2020 2020 2020  g"]..           
-0003b580: 2020 2020 2020 2020 2069 6620 2247 5f63           if "G_c
-0003b590: 6d22 2069 6e20 6469 635f 6661 6369 6573  m" in dic_facies
-0003b5a0: 2e6b 6579 7328 293a 0d0a 2020 2020 2020  .keys():..      
+00037b50: 6d61 736b 5f6e 616e 203d 206e 702e 7a65  mask_nan = np.ze
+00037b60: 726f 7328 5b6e 792c 206e 785d 2c20 6474  ros([ny, nx], dt
+00037b70: 7970 653d 626f 6f6c 290d 0a20 2020 2020  ype=bool)..     
+00037b80: 2020 2020 2020 2020 2020 206d 6173 6b5f             mask_
+00037b90: 6e61 6e5b 6d61 736b 3244 5d20 3d20 6e70  nan[mask2D] = np
+00037ba0: 2e69 736e 616e 2873 315b 6d61 736b 3244  .isnan(s1[mask2D
+00037bb0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00037bc0: 2020 2020 6966 206d 6173 6b5f 6e61 6e2e      if mask_nan.
+00037bd0: 616e 7928 293a 0d0a 2020 2020 2020 2020  any():..        
+00037be0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00037bf0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
+00037c00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00037c10: 315b 6d61 736b 5f6e 616e 5d20 3d20 6f72  1[mask_nan] = or
+00037c20: 675f 7375 7266 735b 6972 6561 6c2c 2028  g_surfs[ireal, (
+00037c30: 6e6c 6179 2d31 292d 692b 315d 5b6d 6173  nlay-1)-i+1][mas
+00037c40: 6b5f 6e61 6e5d 0d0a 2020 2020 2020 2020  k_nan]..        
+00037c50: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00037c60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00037c70: 2020 2020 2020 2020 2020 2073 315b 6d61             s1[ma
+00037c80: 736b 5f6e 616e 5d20 3d20 626f 745b 6d61  sk_nan] = bot[ma
+00037c90: 736b 5f6e 616e 5d0d 0a0d 0a20 2020 2020  sk_nan]....     
+00037ca0: 2020 2020 2020 2020 2020 206f 7267 5f73             org_s
+00037cb0: 7572 6673 5b69 7265 616c 2c20 286e 6c61  urfs[ireal, (nla
+00037cc0: 792d 3129 2d69 5d3d 7331 2e63 6f70 7928  y-1)-i]=s1.copy(
+00037cd0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00037ce0: 2020 2020 2023 2061 6461 7074 2061 6c74       # adapt alt
+00037cf0: 6974 7564 6520 6966 2061 626f 7665 2f62  itude if above/b
+00037d00: 656c 6f77 2074 6f70 2f62 6f74 0d0a 2020  elow top/bot..  
+00037d10: 2020 2020 2020 2020 2020 2020 2020 7331                s1
+00037d20: 5b73 313e 746f 705d 3d74 6f70 5b73 313e  [s1>top]=top[s1>
+00037d30: 746f 705d 0d0a 2020 2020 2020 2020 2020  top]..          
+00037d40: 2020 2020 2020 7331 5b73 313c 626f 745d        s1[s1<bot]
+00037d50: 3d62 6f74 5b73 313c 626f 745d 0d0a 0d0a  =bot[s1<bot]....
+00037d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d70: 2373 7472 6174 6920 636f 6e73 6973 7465  #strati consiste
+00037d80: 6e63 7920 616e 6420 6572 6f73 696f 6e20  ncy and erosion 
+00037d90: 7275 6c65 730d 0a20 2020 2020 2020 2020  rules..         
+00037da0: 2020 2020 2020 2069 6620 6920 3e20 303a         if i > 0:
+00037db0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037dc0: 2020 2020 2020 666f 7220 6f20 696e 2072        for o in r
+00037dd0: 616e 6765 2869 293a 2023 2069 6e64 6578  ange(i): # index
+00037de0: 2066 6f72 2063 6865 636b 696e 6720 616c   for checking al
+00037df0: 7265 6164 7920 7369 6d75 6c61 7465 6420  ready simulated 
+00037e00: 7375 7266 6163 6573 0d0a 2020 2020 2020  surfaces..      
+00037e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e20: 2020 6c69 7468 6f32 3d73 656c 662e 6c69    litho2=self.li
+00037e30: 7374 5f75 6e69 7473 5b3a 3a20 2d31 5d5b  st_units[:: -1][
+00037e40: 6f5d 0d0a 2020 2020 2020 2020 2020 2020  o]..            
+00037e50: 2020 2020 2020 2020 2020 2020 7332 3d73              s2=s
+00037e60: 7572 6673 5b69 7265 616c 2c20 286e 6c61  urfs[ireal, (nla
+00037e70: 792d 3129 2d6f 5d20 2369 6478 2066 726f  y-1)-o] #idx fro
+00037e80: 6d20 6e6c 6179 2d31 2074 6f20 6e6c 6179  m nlay-1 to nlay
+00037e90: 2d69 2d31 0d0a 2020 2020 2020 2020 2020  -i-1..          
+00037ea0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00037eb0: 206c 6974 686f 2021 3d20 6c69 7468 6f32   litho != litho2
+00037ec0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00037ed0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00037ee0: 6620 286c 6974 686f 2e6f 7264 6572 203c  f (litho.order <
+00037ef0: 206c 6974 686f 322e 6f72 6465 7229 2026   litho2.order) &
+00037f00: 2028 6c69 7468 6f2e 7375 7266 6163 652e   (litho.surface.
+00037f10: 636f 6e74 6163 7420 3d3d 2022 6f6e 6c61  contact == "onla
+00037f20: 7022 293a 2023 2073 6920 636f 7563 6865  p"): # si couche
+00037f30: 2073 696d 756c c3a9 6520 7375 7020 6574   simul..e sup et
+00037f40: 206f 6e6c 6170 0d0a 2020 2020 2020 2020   onlap..        
+00037f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037f60: 2020 2020 2020 2020 7331 5b73 3120 3c20          s1[s1 < 
+00037f70: 7332 5d3d 7332 5b73 3120 3c20 7332 5d0d  s2]=s2[s1 < s2].
+00037f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037f90: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00037fa0: 6620 286c 6974 686f 2e6f 7264 6572 203c  f (litho.order <
+00037fb0: 206c 6974 686f 322e 6f72 6465 7229 2026   litho2.order) &
+00037fc0: 2028 6c69 7468 6f2e 7375 7266 6163 652e   (litho.surface.
+00037fd0: 636f 6e74 6163 7420 3d3d 2022 6572 6f64  contact == "erod
+00037fe0: 6522 293a 2023 2073 6920 636f 7563 6865  e"): # si couche
+00037ff0: 2073 696d 756c c3a9 6520 c3a9 726f 6465   simul..e ..rode
+00038000: 2075 6e65 2061 6e63 6965 6e6e 650d 0a20   une ancienne.. 
+00038010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038020: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00038030: 325b 7332 203e 2073 315d 3d73 315b 7332  2[s2 > s1]=s1[s2
+00038040: 203e 2073 315d 0d0a 2020 2020 2020 2020   > s1]..        
+00038050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038060: 2020 2020 2020 2020 6966 206f 203d 3d20          if o == 
+00038070: 692d 3120 616e 6420 6c69 7468 6f2e 636f  i-1 and litho.co
+00038080: 6e74 6163 7420 3d3d 2022 6572 6f64 6522  ntact == "erode"
+00038090: 3a20 2320 6966 2069 6e64 6578 2022 6f22  : # if index "o"
+000380a0: 2069 7320 756e 6465 726c 7969 6e67 206c   is underlying l
+000380b0: 6179 6572 0d0a 2020 2020 2020 2020 2020  ayer..          
+000380c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000380d0: 2020 2020 2020 2020 2020 7331 5b73 3120            s1[s1 
+000380e0: 3e20 7332 5d3d 7332 5b73 3120 3e20 7332  > s2]=s2[s1 > s2
+000380f0: 5d20 2320 7072 6576 656e 7420 6572 6f73  ] # prevent eros
+00038100: 696f 6e20 6c61 7965 7273 2068 6176 696e  ion layers havin
+00038110: 6720 766f 6c75 6d65 0d0a 0d0a 2020 2020  g volume....    
+00038120: 2020 2020 2020 2020 2020 2020 7375 7266              surf
+00038130: 735b 6972 6561 6c2c 2028 6e6c 6179 2d31  s[ireal, (nlay-1
+00038140: 292d 695d 3d73 3120 2023 6164 6420 7375  )-i]=s1  #add su
+00038150: 7266 6163 650d 0a0d 0a20 2020 2020 2020  rface....       
+00038160: 2020 2020 2023 636f 6d70 7574 6520 646f       #compute do
+00038170: 6d61 696e 730d 0a20 2020 2020 2020 2020  mains..         
+00038180: 2020 2073 7461 7274 3d74 696d 652e 7469     start=time.ti
+00038190: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
+000381a0: 2020 7375 7266 735f 6972 3d73 7572 6673    surfs_ir=surfs
+000381b0: 5b69 7265 616c 5d0d 0a0d 0a20 2020 2020  [ireal]....     
+000381c0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+000381d0: 7261 6e67 6528 7375 7266 735f 6972 2e73  range(surfs_ir.s
+000381e0: 6861 7065 5b30 5d29 3a0d 0a20 2020 2020  hape[0]):..     
+000381f0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+00038200: 3c20 7375 7266 735f 6972 2e73 6861 7065  < surfs_ir.shape
+00038210: 5b30 5d2d 313a 0d0a 2020 2020 2020 2020  [0]-1:..        
+00038220: 2020 2020 2020 2020 2020 2020 735f 626f              s_bo
+00038230: 743d 7375 7266 735f 6972 5b69 2b31 5d20  t=surfs_ir[i+1] 
+00038240: 2320 626f 7474 6f6d 0d0a 2020 2020 2020  # bottom..      
+00038250: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00038260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038270: 2020 2020 2073 5f62 6f74 3d62 6f74 0d0a       s_bot=bot..
+00038280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038290: 735f 746f 703d 7375 7266 735f 6972 5b69  s_top=surfs_ir[i
+000382a0: 5d20 2320 746f 700d 0a20 2020 2020 2020  ] # top..       
+000382b0: 2020 2020 2020 2020 2061 3d41 7263 6854           a=ArchT
+000382c0: 6162 6c65 2e63 6f6d 7075 7465 5f64 6f6d  able.compute_dom
+000382d0: 6169 6e28 735f 746f 702c 2073 5f62 6f74  ain(s_top, s_bot
+000382e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000382f0: 2020 2072 6561 6c5f 646f 6d61 696e 735b     real_domains[
+00038300: 6972 6561 6c2c 2069 5d3d 612a 6d61 736b  ireal, i]=a*mask
+00038310: 2a73 656c 662e 6c69 7374 5f75 6e69 7473  *self.list_units
+00038320: 5b69 5d2e 4944 0d0a 2020 2020 2020 2020  [i].ID..        
+00038330: 2020 2020 2020 2020 7375 7266 735f 626f          surfs_bo
+00038340: 745b 6972 6561 6c2c 2069 5d3d 735f 626f  t[ireal, i]=s_bo
+00038350: 740d 0a0d 0a20 2020 2020 2020 2020 2020  t....           
+00038360: 2065 6e64 3d74 696d 652e 7469 6d65 2829   end=time.time()
+00038370: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00038380: 2076 623a 0d0a 2020 2020 2020 2020 2020   vb:..          
+00038390: 2020 2020 2020 7072 696e 7428 225c 6e54        print("\nT
+000383a0: 696d 6520 656c 6170 7365 6420 666f 7220  ime elapsed for 
+000383b0: 6765 7474 696e 6720 646f 6d61 696e 7320  getting domains 
+000383c0: 7b7d 2073 222e 666f 726d 6174 2828 656e  {} s".format((en
+000383d0: 6420 2d20 7374 6172 7429 2929 0d0a 0d0a  d - start)))....
+000383e0: 2020 2020 2020 2020 236f 6e6c 7920 3120          #only 1 
+000383f0: 6269 6720 6172 7261 790d 0a20 2020 2020  big array..     
+00038400: 2020 2061 3d6e 702e 7375 6d28 7265 616c     a=np.sum(real
+00038410: 5f64 6f6d 6169 6e73 2c20 6178 6973 3d31  _domains, axis=1
+00038420: 290d 0a20 2020 2020 2020 2041 7263 6854  )..        ArchT
+00038430: 6162 6c65 2e47 656f 6c2e 756e 6974 735f  able.Geol.units_
+00038440: 646f 6d61 696e 735b 6120 213d 2030 5d3d  domains[a != 0]=
+00038450: 615b 6120 213d 2030 5d0d 0a20 2020 2020  a[a != 0]..     
+00038460: 2020 2041 7263 6854 6162 6c65 2e47 656f     ArchTable.Geo
+00038470: 6c2e 7375 7266 6163 6573 5f62 795f 7069  l.surfaces_by_pi
+00038480: 6c65 735b 7365 6c66 2e6e 616d 655d 3d73  les[self.name]=s
+00038490: 7572 6673 0d0a 2020 2020 2020 2020 4172  urfs..        Ar
+000384a0: 6368 5461 626c 652e 4765 6f6c 2e73 7572  chTable.Geol.sur
+000384b0: 6661 6365 735f 626f 745f 6279 5f70 696c  faces_bot_by_pil
+000384c0: 6573 5b73 656c 662e 6e61 6d65 5d3d 7375  es[self.name]=su
+000384d0: 7266 735f 626f 740d 0a20 2020 2020 2020  rfs_bot..       
+000384e0: 2041 7263 6854 6162 6c65 2e47 656f 6c2e   ArchTable.Geol.
+000384f0: 6f72 675f 7375 7266 6163 6573 5f62 795f  org_surfaces_by_
+00038500: 7069 6c65 735b 7365 6c66 2e6e 616d 655d  piles[self.name]
+00038510: 3d6f 7267 5f73 7572 6673 0d0a 0d0a 2020  =org_surfs....  
+00038520: 2020 2020 2020 6966 2076 623a 0d0a 2020        if vb:..  
+00038530: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00038540: 2223 2323 2323 2323 2323 2323 2323 2323  "###############
+00038550: 2323 2323 2323 2323 2323 235c 6e22 290d  ###########\n").
+00038560: 0a0d 0a20 2020 2064 6566 2064 6566 696e  ...    def defin
+00038570: 655f 646f 6d61 696e 7328 7365 6c66 2c20  e_domains(self, 
+00038580: 4172 6368 5461 626c 652c 2073 7572 6661  ArchTable, surfa
+00038590: 6365 732c 2074 6f70 733d 4e6f 6e65 2c20  ces, tops=None, 
+000385a0: 626f 7473 3d4e 6f6e 652c 2073 7562 7069  bots=None, subpi
+000385b0: 6c65 3d46 616c 7365 2c20 7662 3d30 2c20  le=False, vb=0, 
+000385c0: 666c 5f74 6f70 3d54 7275 6529 3a0d 0a0d  fl_top=True):...
+000385d0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+000385e0: 2020 2020 2020 4465 6669 6e65 2075 6e69        Define uni
+000385f0: 7473 2064 6f6d 6169 6e73 2066 726f 6d20  ts domains from 
+00038600: 7072 6563 6f6d 7075 7465 6420 7375 7266  precomputed surf
+00038610: 6163 6573 2e0d 0a20 2020 2020 2020 2054  aces...        T
+00038620: 6869 7320 6d65 7468 6f64 2069 7320 7573  his method is us
+00038630: 6564 2077 6865 6e20 7468 6520 7375 7266  ed when the surf
+00038640: 6163 6573 2061 7265 2070 7265 636f 6d70  aces are precomp
+00038650: 7574 6564 2028 652e 672e 2066 726f 6d20  uted (e.g. from 
+00038660: 6120 7072 6576 696f 7573 2073 696d 756c  a previous simul
+00038670: 6174 696f 6e29 200d 0a20 2020 2020 2020  ation) ..       
+00038680: 2069 6e20 706c 6163 6520 746f 2074 6865   in place to the
+00038690: 2063 6f6d 7075 7465 5f73 7572 6661 6365   compute_surface
+000386a0: 7320 6d65 7468 6f64 2e0d 0a0d 0a20 2020  s method.....   
+000386b0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+000386c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000386d0: 2d2d 2d0d 0a20 2020 2020 2020 2041 7263  ---..        Arc
+000386e0: 6854 6162 6c65 203a 203a 636c 6173 733a  hTable : :class:
+000386f0: 6041 7263 685f 7461 626c 6560 0d0a 2020  `Arch_table`..  
+00038700: 2020 2020 2020 2020 2020 4172 6368 5461            ArchTa
+00038710: 626c 6520 6f62 6a65 6374 0d0a 2020 2020  ble object..    
+00038720: 2020 2020 7375 7266 6163 6573 203a 2061      surfaces : a
+00038730: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+00038740: 2020 6172 7261 7920 6f66 2073 7572 6661    array of surfa
+00038750: 6365 7320 286e 7265 616c 2c20 6e6c 6179  ces (nreal, nlay
+00038760: 2c20 6e79 2c20 6e78 290d 0a20 2020 2020  , ny, nx)..     
+00038770: 2020 2074 6f70 7320 3a20 6172 7261 790d     tops : array.
+00038780: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+00038790: 6179 206f 6620 746f 7020 656c 6576 6174  ay of top elevat
+000387a0: 696f 6e73 2028 6e79 2c20 6e78 290d 0a20  ions (ny, nx).. 
+000387b0: 2020 2020 2020 2062 6f74 7320 3a20 6172         bots : ar
+000387c0: 7261 790d 0a20 2020 2020 2020 2020 2020  ray..           
+000387d0: 2061 7272 6179 206f 6620 626f 7474 6f6d   array of bottom
+000387e0: 2065 6c65 7661 7469 6f6e 7320 286e 792c   elevations (ny,
+000387f0: 206e 7829 0d0a 2020 2020 2020 2020 7375   nx)..        su
+00038800: 6270 696c 6520 3a20 626f 6f6c 0d0a 2020  bpile : bool..  
+00038810: 2020 2020 2020 2020 2020 6966 2074 6865            if the
+00038820: 2070 696c 6520 6973 2061 2073 7562 7069   pile is a subpi
+00038830: 6c65 2c20 692e 652e 2069 6620 5472 7565  le, i.e. if True
+00038840: 2c20 7468 6520 746f 7020 616e 6420 626f  , the top and bo
+00038850: 7474 6f6d 206f 6620 7468 6520 7069 6c65  ttom of the pile
+00038860: 2061 7265 206e 6f74 2075 7365 640d 0a20   are not used.. 
+00038870: 2020 2020 2020 2076 6220 3a20 696e 740d         vb : int.
+00038880: 0a20 2020 2020 2020 2020 2020 2076 6572  .            ver
+00038890: 626f 7369 7479 206c 6576 656c 2c20 3020  bosity level, 0 
+000388a0: 6973 2073 696c 656e 742c 2031 2069 7320  is silent, 1 is 
+000388b0: 7665 7262 6f73 650d 0a20 2020 2020 2020  verbose..       
+000388c0: 2066 6c5f 746f 7020 3a20 626f 6f6c 0d0a   fl_top : bool..
+000388d0: 2020 2020 2020 2020 2020 2020 6966 2054              if T
+000388e0: 7275 652c 2074 6865 2074 6f70 206f 6620  rue, the top of 
+000388f0: 7468 6520 7069 6c65 2069 7320 7573 6564  the pile is used
+00038900: 2074 6f20 6465 6669 6e65 2074 6865 2074   to define the t
+00038910: 6f70 206f 6620 7468 6520 6669 7273 7420  op of the first 
+00038920: 756e 6974 0d0a 2020 2020 2020 2020 2222  unit..        ""
+00038930: 220d 0a0d 0a20 2020 2020 2020 2061 7373  "....        ass
+00038940: 6572 7420 7375 7266 6163 6573 2e73 6861  ert surfaces.sha
+00038950: 7065 5b31 5d20 3d3d 206c 656e 2873 656c  pe[1] == len(sel
+00038960: 662e 6c69 7374 5f75 6e69 7473 292c 2022  f.list_units), "
+00038970: 7468 6520 6e75 6d62 6572 206f 6620 7375  the number of su
+00038980: 7266 6163 6573 207b 7d20 7072 6f76 6964  rfaces {} provid
+00038990: 6564 2069 7320 6e6f 7420 6571 7561 6c20  ed is not equal 
+000389a0: 746f 2074 6865 206e 756d 6265 7220 6f66  to the number of
+000389b0: 2075 6e69 7473 207b 7d22 2e66 6f72 6d61   units {}".forma
+000389c0: 7428 7375 7266 6163 6573 2e73 6861 7065  t(surfaces.shape
+000389d0: 5b31 5d2c 206c 656e 2873 656c 662e 6c69  [1], len(self.li
+000389e0: 7374 5f75 6e69 7473 2929 0d0a 0d0a 2020  st_units))....  
+000389f0: 2020 2020 2020 2320 6e72 6561 6c0d 0a20        # nreal.. 
+00038a00: 2020 2020 2020 206e 7265 616c 3d73 7572         nreal=sur
+00038a10: 6661 6365 732e 7368 6170 655b 305d 0d0a  faces.shape[0]..
+00038a20: 0d0a 2020 2020 2020 2020 4172 6368 5461  ..        ArchTa
+00038a30: 626c 652e 6e72 6561 6c5f 756e 6974 733d  ble.nreal_units=
+00038a40: 6e72 6561 6c20 2023 2073 746f 7265 206e  nreal  # store n
+00038a50: 756d 6265 7220 6f66 2072 6561 6c69 7a61  umber of realiza
+00038a60: 7469 6f6e 730d 0a0d 0a20 2020 2020 2020  tions....       
+00038a70: 2023 7369 6d75 6c61 7469 6f6e 2067 7269   #simulation gri
+00038a80: 640d 0a20 2020 2020 2020 2078 673d 4172  d..        xg=Ar
+00038a90: 6368 5461 626c 652e 6765 745f 7867 6328  chTable.get_xgc(
+00038aa0: 290d 0a20 2020 2020 2020 206e 783d 7867  )..        nx=xg
+00038ab0: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
+00038ac0: 2020 2079 673d 4172 6368 5461 626c 652e     yg=ArchTable.
+00038ad0: 6765 745f 7967 6328 290d 0a20 2020 2020  get_ygc()..     
+00038ae0: 2020 206e 793d 7967 2e73 6861 7065 5b30     ny=yg.shape[0
+00038af0: 5d0d 0a20 2020 2020 2020 207a 673d 4172  ]..        zg=Ar
+00038b00: 6368 5461 626c 652e 6765 745f 7a67 2829  chTable.get_zg()
+00038b10: 0d0a 2020 2020 2020 2020 6e7a 3d7a 672e  ..        nz=zg.
+00038b20: 7368 6170 655b 305d 202d 2031 0d0a 2020  shape[0] - 1..  
+00038b30: 2020 2020 2020 6966 207e 7375 6270 696c        if ~subpil
+00038b40: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00038b50: 746f 703d 4172 6368 5461 626c 652e 746f  top=ArchTable.to
+00038b60: 700d 0a20 2020 2020 2020 2020 2020 2062  p..            b
+00038b70: 6f74 3d41 7263 6854 6162 6c65 2e62 6f74  ot=ArchTable.bot
+00038b80: 0d0a 2020 2020 2020 2020 6d61 736b 3d41  ..        mask=A
+00038b90: 7263 6854 6162 6c65 2e6d 6173 6b0d 0a20  rchTable.mask.. 
+00038ba0: 2020 2020 2020 206e 6c61 793d 6c65 6e28         nlay=len(
+00038bb0: 7365 6c66 2e6c 6973 745f 756e 6974 7329  self.list_units)
+00038bc0: 0d0a 0d0a 2020 2020 2020 2020 236d 616b  ....        #mak
+00038bd0: 6520 7375 7265 2074 6f20 6861 7665 206f  e sure to have o
+00038be0: 7264 6572 6564 206c 6974 686f 6c6f 6769  rdered lithologi
+00038bf0: 6573 0d0a 2020 2020 2020 2020 7365 6c66  es..        self
+00038c00: 2e6f 7264 6572 5f75 6e69 7473 2876 623d  .order_units(vb=
+00038c10: 7662 290d 0a0d 0a20 2020 2020 2020 2023  vb)....        #
+00038c20: 2323 2069 6e69 7469 616c 697a 6520 7375  ## initialize su
+00038c30: 7266 6163 6573 2062 7920 7365 7474 696e  rfaces by settin
+00038c40: 6720 746f 2030 0d0a 0d0a 2020 2020 2020  g to 0....      
+00038c50: 2020 7375 7266 733d 6e70 2e7a 6572 6f73    surfs=np.zeros
+00038c60: 285b 6e72 6561 6c2c 206e 6c61 792c 206e  ([nreal, nlay, n
+00038c70: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
+00038c80: 2073 7572 6673 5f62 6f74 3d6e 702e 7a65   surfs_bot=np.ze
+00038c90: 726f 7328 5b6e 7265 616c 2c20 6e6c 6179  ros([nreal, nlay
+00038ca0: 2c20 6e79 2c20 6e78 5d29 0d0a 2020 2020  , ny, nx])..    
+00038cb0: 2020 2020 6f72 675f 7375 7266 733d 7375      org_surfs=su
+00038cc0: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
+00038cd0: 7265 616c 5f64 6f6d 6169 6e73 3d6e 702e  real_domains=np.
+00038ce0: 7a65 726f 7328 5b6e 7265 616c 2c20 6e6c  zeros([nreal, nl
+00038cf0: 6179 2c20 6e7a 2c20 6e79 2c20 6e78 5d29  ay, nz, ny, nx])
+00038d00: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
+00038d10: 6972 6561 6c20 696e 2072 616e 6765 286e  ireal in range(n
+00038d20: 7265 616c 293a 2023 206c 6f6f 7020 6f76  real): # loop ov
+00038d30: 6572 2072 6561 6c0d 0a0d 0a20 2020 2020  er real....     
+00038d40: 2020 2020 2020 2023 746f 702f 626f 740d         #top/bot.
+00038d50: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00038d60: 7375 6270 696c 653a 0d0a 2020 2020 2020  subpile:..      
+00038d70: 2020 2020 2020 2020 2020 746f 703d 746f            top=to
+00038d80: 7073 5b69 7265 616c 5d0d 0a20 2020 2020  ps[ireal]..     
+00038d90: 2020 2020 2020 2020 2020 2062 6f74 3d62             bot=b
+00038da0: 6f74 735b 6972 6561 6c5d 0d0a 0d0a 2020  ots[ireal]....  
+00038db0: 2020 2020 2020 2020 2020 2320 636f 756e            # coun
+00038dc0: 7465 7220 666f 7220 6375 7272 656e 7420  ter for current 
+00038dd0: 7369 6d75 6c61 7465 6420 7375 7266 6163  simulated surfac
+00038de0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
+00038df0: 3d2d 310d 0a0d 0a20 2020 2020 2020 2020  =-1....         
+00038e00: 2020 2066 6f72 206c 6974 686f 2069 6e20     for litho in 
+00038e10: 7365 6c66 2e6c 6973 745f 756e 6974 735b  self.list_units[
+00038e20: 3a3a 202d 315d 3a0d 0a0d 0a20 2020 2020  :: -1]:....     
+00038e30: 2020 2020 2020 2020 2020 2069 202b 3d20             i += 
+00038e40: 3120 2023 2069 6e64 6578 2066 6f72 2073  1  # index for s
+00038e50: 696d 756c 6174 6564 2073 7572 6661 6365  imulated surface
+00038e60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00038e70: 2020 7374 6172 743d 7469 6d65 2e74 696d    start=time.tim
+00038e80: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00038e90: 2020 2020 2069 6620 2866 6c5f 746f 7029       if (fl_top)
+00038ea0: 2061 6e64 2028 6920 3d3d 206e 6c61 792d   and (i == nlay-
+00038eb0: 3129 3a20 2320 6669 7273 7420 6c61 7965  1): # first laye
+00038ec0: 7220 6173 7369 676e 2074 6f20 746f 700d  r assign to top.
+00038ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038ee0: 2020 2020 2073 313d 746f 700d 0a20 2020       s1=top..   
+00038ef0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00038f00: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00038f10: 2020 2020 2020 2020 7331 3d6f 7267 5f73          s1=org_s
+00038f20: 7572 6673 5b69 7265 616c 2c20 286e 6c61  urfs[ireal, (nla
+00038f30: 792d 3129 2d69 5d2e 636f 7079 2829 0d0a  y-1)-i].copy()..
+00038f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00038f50: 2020 2320 6164 6170 7420 616c 7469 7475    # adapt altitu
+00038f60: 6465 2069 6620 6162 6f76 652f 6265 6c6f  de if above/belo
+00038f70: 7720 746f 702f 626f 740d 0a20 2020 2020  w top/bot..     
+00038f80: 2020 2020 2020 2020 2020 2073 315b 7331             s1[s1
+00038f90: 3e74 6f70 5d3d 746f 705b 7331 3e74 6f70  >top]=top[s1>top
+00038fa0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00038fb0: 2020 2073 315b 7331 3c62 6f74 5d3d 626f     s1[s1<bot]=bo
+00038fc0: 745b 7331 3c62 6f74 5d0d 0a0d 0a20 2020  t[s1<bot]....   
+00038fd0: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+00038fe0: 7472 6174 6920 636f 6e73 6973 7465 6e63  trati consistenc
+00038ff0: 7920 616e 6420 6572 6f73 696f 6e20 7275  y and erosion ru
+00039000: 6c65 730d 0a20 2020 2020 2020 2020 2020  les..           
+00039010: 2020 2020 2069 6620 6920 3e20 303a 0d0a       if i > 0:..
+00039020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039030: 2020 2020 666f 7220 6f20 696e 2072 616e      for o in ran
+00039040: 6765 2869 293a 2023 2069 6e64 6578 2066  ge(i): # index f
+00039050: 6f72 2063 6865 636b 696e 6720 616c 7265  or checking alre
+00039060: 6164 7920 7369 6d75 6c61 7465 6420 7375  ady simulated su
+00039070: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
+00039080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039090: 6c69 7468 6f32 3d73 656c 662e 6c69 7374  litho2=self.list
+000390a0: 5f75 6e69 7473 5b3a 3a20 2d31 5d5b 6f5d  _units[:: -1][o]
+000390b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000390c0: 2020 2020 2020 2020 2020 7332 3d73 7572            s2=sur
+000390d0: 6673 5b69 7265 616c 2c20 286e 6c61 792d  fs[ireal, (nlay-
+000390e0: 3129 2d6f 5d20 2369 6478 2066 726f 6d20  1)-o] #idx from 
+000390f0: 6e6c 6179 2d31 2074 6f20 6e6c 6179 2d69  nlay-1 to nlay-i
+00039100: 2d31 0d0a 2020 2020 2020 2020 2020 2020  -1..            
+00039110: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00039120: 6974 686f 2021 3d20 6c69 7468 6f32 3a0d  itho != litho2:.
+00039130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039140: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00039150: 286c 6974 686f 2e6f 7264 6572 203c 206c  (litho.order < l
+00039160: 6974 686f 322e 6f72 6465 7229 2026 2028  itho2.order) & (
+00039170: 6c69 7468 6f2e 7375 7266 6163 652e 636f  litho.surface.co
+00039180: 6e74 6163 7420 3d3d 2022 6f6e 6c61 7022  ntact == "onlap"
+00039190: 293a 2023 2073 6920 636f 7563 6865 2073  ): # si couche s
+000391a0: 696d 756c c3a9 6520 7375 7020 6574 206f  imul..e sup et o
+000391b0: 6e6c 6170 0d0a 2020 2020 2020 2020 2020  nlap..          
+000391c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000391d0: 2020 2020 2020 7331 5b73 3120 3c20 7332        s1[s1 < s2
+000391e0: 5d3d 7332 5b73 3120 3c20 7332 5d0d 0a20  ]=s2[s1 < s2].. 
+000391f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039200: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00039210: 286c 6974 686f 2e6f 7264 6572 203c 206c  (litho.order < l
+00039220: 6974 686f 322e 6f72 6465 7229 2026 2028  itho2.order) & (
+00039230: 6c69 7468 6f2e 7375 7266 6163 652e 636f  litho.surface.co
+00039240: 6e74 6163 7420 3d3d 2022 6572 6f64 6522  ntact == "erode"
+00039250: 293a 2023 2073 6920 636f 7563 6865 2073  ): # si couche s
+00039260: 696d 756c c3a9 6520 c3a9 726f 6465 2075  imul..e ..rode u
+00039270: 6e65 2061 6e63 6965 6e6e 650d 0a20 2020  ne ancienne..   
+00039280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039290: 2020 2020 2020 2020 2020 2020 2073 325b               s2[
+000392a0: 7332 203e 2073 315d 3d73 315b 7332 203e  s2 > s1]=s1[s2 >
+000392b0: 2073 315d 0d0a 2020 2020 2020 2020 2020   s1]..          
+000392c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000392d0: 2020 2020 2020 6966 206f 203d 3d20 692d        if o == i-
+000392e0: 3120 616e 6420 6c69 7468 6f2e 636f 6e74  1 and litho.cont
+000392f0: 6163 7420 3d3d 2022 6572 6f64 6522 3a20  act == "erode": 
+00039300: 2320 6966 2069 6e64 6578 2022 6f22 2069  # if index "o" i
+00039310: 7320 756e 6465 726c 7969 6e67 206c 6179  s underlying lay
+00039320: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
+00039330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039340: 2020 2020 2020 2020 7331 5b73 3120 3e20          s1[s1 > 
+00039350: 7332 5d3d 7332 5b73 3120 3e20 7332 5d20  s2]=s2[s1 > s2] 
+00039360: 2320 7072 6576 656e 7420 6572 6f73 696f  # prevent erosio
+00039370: 6e20 6c61 7965 7273 2068 6176 696e 6720  n layers having 
+00039380: 766f 6c75 6d65 0d0a 0d0a 2020 2020 2020  volume....      
+00039390: 2020 2020 2020 2020 2020 7375 7266 735b            surfs[
+000393a0: 6972 6561 6c2c 2028 6e6c 6179 2d31 292d  ireal, (nlay-1)-
+000393b0: 695d 3d73 3120 2023 6164 6420 7375 7266  i]=s1  #add surf
+000393c0: 6163 650d 0a0d 0a20 2020 2020 2020 2020  ace....         
+000393d0: 2020 2023 636f 6d70 7574 6520 646f 6d61     #compute doma
+000393e0: 696e 730d 0a0d 0a20 2020 2020 2020 2020  ins....         
+000393f0: 2020 2073 7572 6673 5f69 723d 7375 7266     surfs_ir=surf
+00039400: 735b 6972 6561 6c5d 0d0a 0d0a 2020 2020  s[ireal]....    
+00039410: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00039420: 2072 616e 6765 2873 7572 6673 5f69 722e   range(surfs_ir.
+00039430: 7368 6170 655b 305d 293a 0d0a 2020 2020  shape[0]):..    
+00039440: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00039450: 203c 2073 7572 6673 5f69 722e 7368 6170   < surfs_ir.shap
+00039460: 655b 305d 2d31 3a0d 0a20 2020 2020 2020  e[0]-1:..       
+00039470: 2020 2020 2020 2020 2020 2020 2073 5f62               s_b
+00039480: 6f74 3d73 7572 6673 5f69 725b 692b 315d  ot=surfs_ir[i+1]
+00039490: 2023 2062 6f74 746f 6d0d 0a20 2020 2020   # bottom..     
+000394a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000394b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000394c0: 2020 2020 2020 735f 626f 743d 626f 740d        s_bot=bot.
+000394d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000394e0: 2073 5f74 6f70 3d73 7572 6673 5f69 725b   s_top=surfs_ir[
+000394f0: 695d 2023 2074 6f70 0d0a 2020 2020 2020  i] # top..      
+00039500: 2020 2020 2020 2020 2020 613d 4172 6368            a=Arch
+00039510: 5461 626c 652e 636f 6d70 7574 655f 646f  Table.compute_do
+00039520: 6d61 696e 2873 5f74 6f70 2c20 735f 626f  main(s_top, s_bo
+00039530: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00039540: 2020 2020 7265 616c 5f64 6f6d 6169 6e73      real_domains
+00039550: 5b69 7265 616c 2c20 695d 3d61 2a6d 6173  [ireal, i]=a*mas
+00039560: 6b2a 7365 6c66 2e6c 6973 745f 756e 6974  k*self.list_unit
+00039570: 735b 695d 2e49 440d 0a20 2020 2020 2020  s[i].ID..       
+00039580: 2020 2020 2020 2020 2073 7572 6673 5f62           surfs_b
+00039590: 6f74 5b69 7265 616c 2c20 695d 3d73 5f62  ot[ireal, i]=s_b
+000395a0: 6f74 0d0a 0d0a 0d0a 2020 2020 2020 2020  ot......        
+000395b0: 236f 6e6c 7920 3120 6269 6720 6172 7261  #only 1 big arra
+000395c0: 790d 0a20 2020 2020 2020 2061 3d6e 702e  y..        a=np.
+000395d0: 7375 6d28 7265 616c 5f64 6f6d 6169 6e73  sum(real_domains
+000395e0: 2c20 6178 6973 3d31 290d 0a20 2020 2020  , axis=1)..     
+000395f0: 2020 2041 7263 6854 6162 6c65 2e47 656f     ArchTable.Geo
+00039600: 6c2e 756e 6974 735f 646f 6d61 696e 735b  l.units_domains[
+00039610: 6120 213d 2030 5d3d 615b 6120 213d 2030  a != 0]=a[a != 0
+00039620: 5d0d 0a20 2020 2020 2020 2064 656c 2872  ]..        del(r
+00039630: 6561 6c5f 646f 6d61 696e 7329 0d0a 2020  eal_domains)..  
+00039640: 2020 2020 2020 4172 6368 5461 626c 652e        ArchTable.
+00039650: 4765 6f6c 2e73 7572 6661 6365 735f 6279  Geol.surfaces_by
+00039660: 5f70 696c 6573 5b73 656c 662e 6e61 6d65  _piles[self.name
+00039670: 5d3d 7375 7266 730d 0a20 2020 2020 2020  ]=surfs..       
+00039680: 2041 7263 6854 6162 6c65 2e47 656f 6c2e   ArchTable.Geol.
+00039690: 7375 7266 6163 6573 5f62 6f74 5f62 795f  surfaces_bot_by_
+000396a0: 7069 6c65 735b 7365 6c66 2e6e 616d 655d  piles[self.name]
+000396b0: 3d73 7572 6673 5f62 6f74 0d0a 2020 2020  =surfs_bot..    
+000396c0: 2020 2020 4172 6368 5461 626c 652e 4765      ArchTable.Ge
+000396d0: 6f6c 2e6f 7267 5f73 7572 6661 6365 735f  ol.org_surfaces_
+000396e0: 6279 5f70 696c 6573 5b73 656c 662e 6e61  by_piles[self.na
+000396f0: 6d65 5d3d 6f72 675f 7375 7266 730d 0a0d  me]=org_surfs...
+00039700: 0a20 2020 2020 2020 2069 6620 7662 3a0d  .        if vb:.
+00039710: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00039720: 6e74 2822 2323 2323 2323 2323 2323 2323  nt("############
+00039730: 2323 2323 2323 2323 2323 2323 2323 5c6e  ##############\n
+00039740: 2229 0d0a 0d0a 0d0a 636c 6173 7320 556e  ")......class Un
+00039750: 6974 2829 3a0d 0a0d 0a20 2020 2022 2222  it():....    """
+00039760: 0d0a 2020 2020 5468 6973 2063 6c61 7373  ..    This class
+00039770: 2064 6566 696e 6573 2055 6e69 7420 6f62   defines Unit ob
+00039780: 6a65 6374 732c 2077 6869 6368 2061 7265  jects, which are
+00039790: 2074 6865 2062 7569 6c64 696e 6720 626c   the building bl
+000397a0: 6f63 6b73 206f 6620 7468 6520 5069 6c65  ocks of the Pile
+000397b0: 2063 6c61 7373 2e0d 0a0d 0a20 2020 2050   class.....    P
+000397c0: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
+000397d0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e  ---------..    n
+000397e0: 616d 6520 3a20 7374 7269 6e67 0d0a 2020  ame : string..  
+000397f0: 2020 2020 2020 6e61 6d65 206f 6620 7468        name of th
+00039800: 6520 756e 6974 2074 6861 7420 7769 6c6c  e unit that will
+00039810: 2062 6520 7573 6564 2061 7320 616e 2069   be used as an i
+00039820: 6465 6e74 6966 6965 720d 0a20 2020 206f  dentifier..    o
+00039830: 7264 6572 203a 2069 6e74 0d0a 2020 2020  rder : int..    
+00039840: 2020 2020 6f72 6465 7220 6f66 2074 6865      order of the
+00039850: 2075 6e69 7420 696e 2074 6865 2070 696c   unit in the pil
+00039860: 6520 2831 2028 746f 7029 2074 6f20 6e20  e (1 (top) to n 
+00039870: 2862 6f74 746f 6d29 2c20 7768 6572 6520  (bottom), where 
+00039880: 6e20 6973 2074 6865 2074 6f74 616c 206e  n is the total n
+00039890: 756d 6265 7220 6f66 2075 6e69 7473 290d  umber of units).
+000398a0: 0a20 2020 2063 6f6c 6f72 203a 2073 7472  .    color : str
+000398b0: 696e 670d 0a20 2020 2020 2020 2063 6f6c  ing..        col
+000398c0: 6f72 2074 6f20 7573 6520 666f 7220 706c  or to use for pl
+000398d0: 6f74 7469 6e67 2061 6e64 2072 6570 7265  otting and repre
+000398e0: 7365 6e74 6174 696f 6e2e 0d0a 2020 2020  sentation...    
+000398f0: 2020 2020 5468 6520 636f 6c6f 7220 6361      The color ca
+00039900: 6e20 6265 2061 6e79 2063 6f6c 6f72 2074  n be any color t
+00039910: 6861 7420 6973 2061 6363 6570 7465 6420  hat is accepted 
+00039920: 6279 206d 6174 706c 6f74 6c69 620d 0a20  by matplotlib.. 
+00039930: 2020 2073 7572 6661 6365 203a 203a 636c     surface : :cl
+00039940: 6173 733a 6053 7572 6661 6365 6020 6f62  ass:`Surface` ob
+00039950: 6a65 6374 0d0a 2020 2020 2020 2020 7375  ject..        su
+00039960: 7266 6163 6520 6f62 6a65 6374 2074 6861  rface object tha
+00039970: 7420 6465 6669 6e65 7320 7468 6520 7375  t defines the su
+00039980: 7266 6163 6520 6f66 2074 6865 2075 6e69  rface of the uni
+00039990: 740d 0a20 2020 2049 4420 3a20 696e 740d  t..    ID : int.
+000399a0: 0a20 2020 2020 2020 2049 4420 6f66 2074  .        ID of t
+000399b0: 6865 2075 6e69 742c 2069 6620 4e6f 6e65  he unit, if None
+000399c0: 2c20 7468 6520 4944 2077 696c 6c20 6265  , the ID will be
+000399d0: 2073 6574 2074 6f20 7468 6520 6f72 6465   set to the orde
+000399e0: 7220 6f66 2074 6865 2075 6e69 740d 0a20  r of the unit.. 
+000399f0: 2020 206d 5f75 6e69 745f 6e61 6d65 203a     m_unit_name :
+00039a00: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
+00039a10: 2069 6465 6e74 6966 6965 7220 6e61 6d65   identifier name
+00039a20: 2069 6620 7468 6520 756e 6974 2069 7320   if the unit is 
+00039a30: 6120 6d75 6c74 6970 6c65 2075 6e69 7420  a multiple unit 
+00039a40: 2863 616e 2061 7070 6561 7220 7365 7665  (can appear seve
+00039a50: 7261 6c20 7469 6d65 7320 696e 2074 6865  ral times in the
+00039a60: 2070 696c 6529 0d0a 2020 2020 2020 2020   pile)..        
+00039a70: 4e6f 7420 7965 7420 696d 706c 656d 656e  Not yet implemen
+00039a80: 7465 640d 0a20 2020 2064 6963 5f66 6163  ted..    dic_fac
+00039a90: 6965 7320 3a20 6469 6374 0d0a 2020 2020  ies : dict..    
+00039aa0: 2020 2020 6469 6374 696f 6e61 7279 2074      dictionary t
+00039ab0: 6861 7420 6465 6669 6e65 7320 7468 6520  hat defines the 
+00039ac0: 6661 6369 6573 206f 6620 7468 6520 756e  facies of the un
+00039ad0: 6974 2e20 5468 6520 6d61 6e64 6174 6f72  it. The mandator
+00039ae0: 7920 6b65 7973 2066 6f72 2074 6865 2064  y keys for the d
+00039af0: 6963 7469 6f6e 6172 7920 6172 653a 0d0a  ictionary are:..
+00039b00: 0d0a 2020 2020 2020 2020 2d20 665f 6d65  ..        - f_me
+00039b10: 7468 6f64 203a 2073 7472 696e 672c 2076  thod : string, v
+00039b20: 616c 6162 6c65 206d 6574 686f 6420 6172  alable method ar
+00039b30: 653a 200d 0a0d 0a20 2020 2020 2020 2020  e: ....         
+00039b40: 2020 202d 2022 686f 6d6f 6765 6e6f 7573     - "homogenous
+00039b50: 2220 3a20 686f 6d6f 6765 6e6f 7573 2066  " : homogenous f
+00039b60: 6163 6965 730d 0a20 2020 2020 2020 2020  acies..         
+00039b70: 2020 202d 2022 5375 6250 696c 6522 203a     - "SubPile" :
+00039b80: 2066 6163 6965 7320 6172 6520 7369 6d75   facies are simu
+00039b90: 6c61 7465 6420 7769 7468 2061 2073 7562  lated with a sub
+00039ba0: 7069 6c65 0d0a 2020 2020 2020 2020 2020  pile..          
+00039bb0: 2020 2d20 2253 4953 2220 3a20 6661 6369    - "SIS" : faci
+00039bc0: 6573 2061 7265 2073 696d 756c 6174 6564  es are simulated
+00039bd0: 2077 6974 6820 7374 6f63 6861 7374 6963   with stochastic
+00039be0: 2069 6e64 6963 6174 6f72 2073 696d 756c   indicator simul
+00039bf0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
+00039c00: 2020 202d 2022 4d50 5322 203a 2066 6163     - "MPS" : fac
+00039c10: 6965 7320 6172 6520 7369 6d75 6c61 7465  ies are simulate
+00039c20: 6420 7769 7468 204d 756c 7469 706c 6520  d with Multiple 
+00039c30: 706f 696e 7473 2073 7461 7469 7374 6963  points statistic
+00039c40: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
+00039c50: 2022 5450 4773 223a 2066 6163 6965 7320   "TPGs": facies 
+00039c60: 6172 6520 7369 6d75 6c61 7465 6420 7769  are simulated wi
+00039c70: 7468 2054 7275 6e63 6174 6564 2070 6c75  th Truncated plu
+00039c80: 7269 2d47 6175 7373 6961 6e20 6d65 7468  ri-Gaussian meth
+00039c90: 6f64 0d0a 2020 2020 2020 2020 2d20 665f  od..        - f_
+00039ca0: 636f 766d 6f64 656c 203a 2033 4420 6765  covmodel : 3D ge
+00039cb0: 6f6e 6520 636f 7661 7269 616e 6365 206d  one covariance m
+00039cc0: 6f64 656c 206f 626a 6563 7420 6f72 206c  odel object or l
+00039cd0: 6973 7420 6f66 2033 4420 6765 6f6e 6520  ist of 3D geone 
+00039ce0: 636f 7661 7269 616e 6365 206d 6f64 656c  covariance model
+00039cf0: 206f 626a 6563 7473 206f 6e6c 7920 7573   objects only us
+00039d00: 6564 2077 6974 6820 2253 4953 2220 6d65  ed with "SIS" me
+00039d10: 7468 6f64 0d0a 2020 2020 2020 2020 2d20  thod..        - 
+00039d20: 5449 203a 2067 656f 6e65 2e69 6d61 6765  TI : geone.image
+00039d30: 2c20 5472 6169 6e69 6e67 2069 6d61 6765  , Training image
+00039d40: 2066 6f72 2022 4d50 5322 206d 6574 686f   for "MPS" metho
+00039d50: 640d 0a20 2020 2020 2020 202d 2053 7562  d..        - Sub
+00039d60: 5069 6c65 203a 203a 636c 6173 733a 6050  Pile : :class:`P
+00039d70: 696c 6560 206f 626a 6563 742c 2073 7562  ile` object, sub
+00039d80: 7069 6c65 2066 6f72 2022 5375 6250 696c  pile for "SubPil
+00039d90: 6522 206d 6574 686f 640d 0a20 2020 200d  e" method..    .
+00039da0: 0a20 2020 2020 2020 2046 6163 6965 7320  .        Facies 
+00039db0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+00039dc0: 7320 746f 2070 6173 7320 746f 2074 6865  s to pass to the
+00039dd0: 2066 6163 6965 7320 6d65 7468 6f64 7320   facies methods 
+00039de0: 2874 6865 7365 2073 686f 756c 6420 6265  (these should be
+00039df0: 2070 6173 7320 7468 726f 7567 6820 6469   pass through di
+00039e00: 635f 6661 6369 6573 2021 293a 0d0a 2020  c_facies !):..  
+00039e10: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+00039e20: 2020 2020 2d20 2253 4953 2220 3a0d 0a20      - "SIS" :.. 
+00039e30: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+00039e40: 2022 6e65 6967 6822 203a 2069 6e74 2c20   "neigh" : int, 
+00039e50: 6e75 6d62 6572 206f 6620 6e65 6967 6862  number of neighb
+00039e60: 6f72 7320 746f 2075 7365 2066 6f72 2074  ors to use for t
+00039e70: 6865 2053 4953 0d0a 2020 2020 2020 2020  he SIS..        
+00039e80: 2020 2020 2020 2020 2d20 7220 3a20 666c          - r : fl
+00039e90: 6f61 742c 2072 6164 6975 7320 6f66 2074  oat, radius of t
+00039ea0: 6865 206e 6569 6768 626f 7268 6f6f 6420  he neighborhood 
+00039eb0: 746f 2075 7365 2066 6f72 2074 6865 2053  to use for the S
+00039ec0: 4953 0d0a 2020 2020 2020 2020 2020 2020  IS..            
+00039ed0: 2020 2020 2d20 7072 6f62 6162 696c 6974      - probabilit
+00039ee0: 7920 3a20 6c69 7374 206f 6620 666c 6f61  y : list of floa
+00039ef0: 742c 2070 726f 706f 7274 696f 6e20 6f66  t, proportion of
+00039f00: 2065 6163 6820 6661 6369 6573 2074 6f20   each facies to 
+00039f10: 7573 6520 666f 7220 7468 6520 5349 530d  use for the SIS.
+00039f20: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+00039f30: 4920 2020 2020 2020 2020 2020 2020 2020  I               
+00039f40: 2020 2020 203a 2067 656f 6e65 2069 6d67       : geone img
+00039f50: 2c20 5472 6169 6e69 6e67 2069 6d61 6765  , Training image
+00039f60: 2873 2920 746f 2075 7365 0d0a 2020 2020  (s) to use..    
+00039f70: 2020 2020 2020 2020 2020 2020 2d20 6d70              - mp
+00039f80: 7320 2263 6c61 7373 6963 2220 7061 7261  s "classic" para
+00039f90: 6d65 7465 7273 2028 6d61 7873 6361 6e2c  meters (maxscan,
+00039fa0: 2074 6872 6573 682c 206e 6569 6720 286e   thresh, neig (n
+00039fb0: 756d 6265 7220 6f66 206e 6569 6768 626f  umber of neighbo
+00039fc0: 7572 7329 290d 0a20 2020 2020 2020 2020  urs))..         
+00039fd0: 2020 2020 2020 202d 206e 706f 7374 2020         - npost  
+00039fe0: 2020 2020 2020 2020 2020 2020 2020 203a                 :
+00039ff0: 206e 756d 6265 7220 6f66 2070 6174 6820   number of path 
+0003a000: 706f 7374 7072 6f63 6573 7369 6e67 2c20  postprocessing, 
+0003a010: 6465 6661 756c 7420 310d 0a20 2020 2020  default 1..     
+0003a020: 2020 2020 2020 2020 2020 202d 2072 6164             - rad
+0003a030: 6975 734d 6f64 6520 2020 2020 2020 2020  iusMode         
+0003a040: 2020 203a 2072 6164 6975 7320 6d6f 6465     : radius mode
+0003a050: 2074 6f20 7573 6520 2863 6865 636b 2064   to use (check d
+0003a060: 6565 7373 6520 6d61 6e75 616c 290d 0a20  eesse manual).. 
+0003a070: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0003a080: 2061 6e69 736f 7472 6f70 7952 6174 696f   anisotropyRatio
+0003a090: 4d6f 6465 2020 203a 2041 6e69 736f 7472  Mode   : Anisotr
+0003a0a0: 6f70 7920 7261 7469 6f20 746f 2075 7365  opy ratio to use
+0003a0b0: 2069 6e20 7265 6173 6561 7263 6820 6f66   in reasearch of
+0003a0c0: 206e 6569 6768 626f 7572 7320 2863 6865   neighbours (che
+0003a0d0: 636b 2064 6565 7373 6520 6d61 6e75 616c  ck deesse manual
+0003a0e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003a0f0: 2020 202d 2072 782c 2072 792c 2072 7a20     - rx, ry, rz 
+0003a100: 2020 2020 2020 2020 2020 203a 2072 6164             : rad
+0003a110: 6975 7320 696e 2078 2c20 7920 616e 6420  ius in x, y and 
+0003a120: 7a20 6469 7265 6374 696f 6e0d 0a20 2020  z direction..   
+0003a130: 2020 2020 2020 2020 2020 2020 202d 2061               - a
+0003a140: 6e67 6c65 312c 2061 6e67 6c65 322c 2061  ngle1, angle2, a
+0003a150: 6e67 6c65 333a 2065 6c6c 6970 736f 6964  ngle3: ellipsoid
+0003a160: 206f 6620 7265 7365 6172 6368 2072 6f74   of research rot
+0003a170: 6174 696f 6e20 616e 676c 6573 0d0a 2020  ation angles..  
+0003a180: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+0003a190: 6178 2c20 6179 2c20 617a 2020 2020 2020  ax, ay, az      
+0003a1a0: 2020 2020 2020 3a20 616e 6973 6f74 726f        : anisotro
+0003a1b0: 7079 2072 6174 696f 2066 6f72 2072 6573  py ratio for res
+0003a1c0: 6561 7263 6820 656c 6c69 7073 6f69 640d  earch ellipsoid.
+0003a1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a1e0: 202d 2072 6f74 5f75 7361 6765 2020 2020   - rot_usage    
+0003a1f0: 2020 2020 2020 2020 203a 2030 2c20 3120           : 0, 1 
+0003a200: 6f72 2032 2028 6368 6563 6b20 6465 6573  or 2 (check dees
+0003a210: 7365 206d 616e 7561 6c29 0d0a 2020 2020  se manual)..    
+0003a220: 2020 2020 2020 2020 2020 2020 2d20 726f              - ro
+0003a230: 7441 7a69 4c6f 632c 2072 6f74 4469 704c  tAziLoc, rotDipL
+0003a240: 6f63 2c20 3a20 6c6f 6361 6c20 726f 7461  oc, : local rota
+0003a250: 7469 6f6e 2c20 5472 7565 206f 7220 4661  tion, True or Fa
+0003a260: 6c73 6520 3f0d 0a20 2020 2020 2020 2020  lse ?..         
+0003a270: 2020 2020 2020 2020 2072 6f74 506c 756e           rotPlun
+0003a280: 6765 4c6f 630d 0a20 2020 2020 2020 2020  geLoc..         
+0003a290: 2020 2020 2020 202d 2072 6f74 417a 692c         - rotAzi,
+0003a2a0: 2072 6f74 4469 702c 2020 2020 2020 203a   rotDip,       :
+0003a2b0: 2067 6c6f 6261 6c20 726f 7461 7469 6f6e   global rotation
+0003a2c0: 2061 6e67 6c65 733a 2076 616c 7565 732c   angles: values,
+0003a2d0: 206d 696e 2d6d 6178 2c20 6d61 7073 2c20   min-max, maps, 
+0003a2e0: 7365 6520 6465 6573 7365 5f69 6e70 7574  see deesse_input
+0003a2f0: 2064 6f63 0d0a 2020 2020 2020 2020 2020   doc..          
+0003a300: 2020 2020 2020 2020 726f 7450 6c75 6e67          rotPlung
+0003a310: 6520 2020 2020 2020 2020 2020 2020 2020  e               
+0003a320: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+0003a330: 2020 202d 2078 722c 2079 722c 207a 7220     - xr, yr, zr 
+0003a340: 2020 2020 2020 2020 2020 203a 2072 6174             : rat
+0003a350: 696f 2066 6f72 2067 656f 6d20 7472 616e  io for geom tran
+0003a360: 7366 6f72 6d61 7469 6f6e 0d0a 2020 2020  sformation..    
+0003a370: 2020 2020 2020 2020 2020 2020 2d20 786c              - xl
+0003a380: 6f63 2c20 796c 6f63 2c20 7a6c 6f63 2020  oc, yloc, zloc  
+0003a390: 2020 2020 3a20 6c6f 6361 6c20 6f72 206e      : local or n
+0003a3a0: 6f74 2074 7261 6e73 666f 726d 6174 696f  ot transformatio
+0003a3b0: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
+0003a3c0: 2020 202d 2068 6f6d 6f5f 7573 6167 6520     - homo_usage 
+0003a3d0: 2020 2020 2020 2020 2020 203a 2068 6f6d             : hom
+0003a3e0: 6f74 6865 7479 2075 7361 6765 0d0a 2020  othety usage..  
+0003a3f0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+0003a400: 7072 6f62 6155 7361 6765 2020 2020 2020  probaUsage      
+0003a410: 2020 2020 2020 3a20 7072 6f62 6162 696c        : probabil
+0003a420: 6974 7920 636f 6e73 7472 6169 6e74 2075  ity constraint u
+0003a430: 7361 6765 2c20 3020 666f 7220 6e6f 2070  sage, 0 for no p
+0003a440: 726f 6261 2063 6f6e 7374 7261 696e 742c  roba constraint,
+0003a450: 2031 2066 6f72 2067 6c6f 6261 6c20 7072   1 for global pr
+0003a460: 6f70 6f72 7469 6f6e 2064 6566 696e 6564  oportion defined
+0003a470: 2069 6e20 676c 6f62 616c 5064 662c 2032   in globalPdf, 2
+0003a480: 2066 6f72 206c 6f63 616c 2070 726f 706f   for local propo
+0003a490: 7274 696f 6e20 6465 6669 6e65 6420 696e  rtion defined in
+0003a4a0: 206c 6f63 616c 5064 660d 0a20 2020 2020   localPdf..     
+0003a4b0: 2020 2020 2020 2020 2020 202d 2067 6c6f             - glo
+0003a4c0: 6261 6c50 6466 2020 2020 2020 2020 2020  balPdf          
+0003a4d0: 2020 203a 2061 7272 6179 2d6c 696b 6520     : array-like 
+0003a4e0: 6f66 2066 6c6f 6174 206f 6620 6c65 6e67  of float of leng
+0003a4f0: 7468 2065 7175 616c 2074 6f20 7468 6520  th equal to the 
+0003a500: 6e75 6d62 6572 206f 6620 636c 6173 732c  number of class,
+0003a510: 2070 726f 706f 7274 696f 6e20 666f 7220   proportion for 
+0003a520: 6561 6368 2063 6c61 7373 0d0a 2020 2020  each class..    
+0003a530: 2020 2020 2020 2020 2020 2020 2d20 6c6f              - lo
+0003a540: 6361 6c50 6466 2020 2020 2020 2020 2020  calPdf          
+0003a550: 2020 2020 3a20 286e 636c 6173 732c 206e      : (nclass, n
+0003a560: 7a2c 206e 792c 206e 7829 2061 7272 6179  z, ny, nx) array
+0003a570: 206f 6620 666c 6f61 7473 2070 726f 6261   of floats proba
+0003a580: 6269 6c69 7479 2066 6f72 2065 6163 6820  bility for each 
+0003a590: 636c 6173 732c 206c 6f63 616c 5064 665b  class, localPdf[
+0003a5a0: 695d 2069 7320 7468 6520 226d 6170 2064  i] is the "map d
+0003a5b0: 6566 696e 6564 206f 6e20 7468 6520 7369  efined on the si
+0003a5c0: 6d75 6c61 7469 6f6e 2067 7269 640d 0a20  mulation grid.. 
+0003a5d0: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0003a5e0: 206c 6f63 616c 5064 6652 6164 6975 7320   localPdfRadius 
+0003a5f0: 2020 2020 2020 203a 2073 7570 706f 7274         : support
+0003a600: 2072 6164 6975 7320 666f 7220 6c6f 6361   radius for loca
+0003a610: 6c20 7064 662c 2064 6566 6175 6c74 2069  l pdf, default i
+0003a620: 7320 320d 0a20 2020 2020 2020 2020 2020  s 2..           
+0003a630: 2020 2020 202d 2064 6561 6374 6976 6174       - deactivat
+0003a640: 696f 6e44 6973 7461 6e63 6520 203a 2066  ionDistance  : f
+0003a650: 6c6f 6174 2c20 6469 7374 616e 6365 2061  loat, distance a
+0003a660: 7420 7768 6963 6820 6c6f 6361 6c50 6466  t which localPdf
+0003a670: 2061 7265 2064 6561 6374 6976 6174 6564   are deactivated
+0003a680: 2028 7365 6520 4465 6573 7365 2064 6f63   (see Deesse doc
+0003a690: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003a6a0: 2020 202d 2063 6f6e 7374 616e 7454 6872     - constantThr
+0003a6b0: 6573 686f 6c64 2020 2020 203a 2066 6c6f  eshold     : flo
+0003a6c0: 6174 2c20 7468 7265 7368 6f6c 6420 7661  at, threshold va
+0003a6d0: 6c75 6520 666f 7220 7064 6627 7320 636f  lue for pdf's co
+0003a6e0: 6d70 6172 6973 6f6e 0d0a 2020 2020 2020  mparison..      
+0003a6f0: 2020 2020 2020 2020 2020 2d20 6461 7461            - data
+0003a700: 496d 6167 6520 2020 2020 2020 2020 2020  Image           
+0003a710: 2020 3a20 6765 6f6e 6520 696d 6720 7573    : geone img us
+0003a720: 6564 2061 7320 6461 7461 2c20 7365 6520  ed as data, see 
+0003a730: 6465 6573 7365 2f67 656f 6e65 2064 6f63  deesse/geone doc
+0003a740: 756d 656e 7461 7469 6f6e 0d0a 2020 2020  umentation..    
+0003a750: 2020 2020 2020 2020 2020 2020 2d20 6f75              - ou
+0003a760: 7470 7574 5661 7246 6c61 6720 2020 2020  tputVarFlag     
+0003a770: 2020 2020 3a20 626f 6f6c 206f 7220 6c69      : bool or li
+0003a780: 7374 206f 6620 626f 6f6c 206f 6620 7369  st of bool of si
+0003a790: 7a65 206e 762c 2074 6f20 6f75 7470 7574  ze nv, to output
+0003a7a0: 206f 7220 6e6f 7420 7468 6520 7661 7269   or not the vari
+0003a7b0: 6162 6c65 730d 0a20 2020 2020 2020 2020  ables..         
+0003a7c0: 2020 2020 2020 202d 2064 6973 7461 6e63         - distanc
+0003a7d0: 6554 7970 6520 2020 2020 2020 2020 203a  eType          :
+0003a7e0: 2073 7472 696e 6720 6f72 206c 6973 7420   string or list 
+0003a7f0: 6f66 2073 7472 696e 6773 2c20 2263 6174  of strings, "cat
+0003a800: 6567 6f72 6963 616c 2220 6f72 2022 636f  egorical" or "co
+0003a810: 6e74 696e 756f 7573 220d 0a0d 0a20 2020  ntinuous"....   
+0003a820: 2020 2020 2020 2020 202d 2054 5047 733a           - TPGs:
+0003a830: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003a840: 2020 2d20 666c 6167 3a20 6469 6374 696f    - flag: dictio
+0003a850: 6e61 7279 206f 6620 6c69 6d69 7473 206f  nary of limits o
+0003a860: 6620 6375 626f 6964 7320 646f 6d61 696e  f cuboids domain
+0003a870: 7320 696e 2047 6175 7373 6961 6e20 7370  s in Gaussian sp
+0003a880: 6163 652c 2063 6865 636b 202e 2e2e 2066  ace, check ... f
+0003a890: 6f72 2074 6865 2072 6967 6874 2066 6f72  or the right for
+0003a8a0: 6d61 742e 0d0a 2020 2020 2020 2020 2020  mat...          
+0003a8b0: 2020 2020 2020 2d20 496b 5f63 6d3a 2069        - Ik_cm: i
+0003a8c0: 6e64 6963 6174 6f72 2063 6f76 6d6f 6465  ndicator covmode
+0003a8d0: 6c73 0d0a 2020 2020 2020 2020 2020 2020  ls..            
+0003a8e0: 2020 2020 2d20 475f 636d 3a20 6c69 7374      - G_cm: list
+0003a8f0: 206f 6620 4761 7573 7369 616e 2063 6f76   of Gaussian cov
+0003a900: 6d6f 6465 6c73 2066 6f72 2074 6865 2074  models for the t
+0003a910: 776f 2067 6175 7373 6961 6e20 6669 656c  wo gaussian fiel
+0003a920: 6473 2c20 6361 6e20 6265 2069 6e66 6572  ds, can be infer
+0003a930: 6564 2066 726f 6d20 496b 5f63 6d0d 0a20  ed from Ik_cm.. 
+0003a940: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+0003a950: 2076 6172 696f 7573 2070 6172 616d 6574   various paramet
+0003a960: 6572 733a 2028 6475 2c20 6476 202d 2d3e  ers: (du, dv -->
+0003a970: 2070 7265 6369 7369 6f6e 206f 6620 696e   precision of in
+0003a980: 7465 6772 616c 7320 666f 7220 475f 636d  tegrals for G_cm
+0003a990: 2069 6e66 6572 656e 6365 292c 0d0a 2020   inference),..  
+0003a9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a9c0: 2020 2020 2864 696d 3a20 6469 6d65 6e73      (dim: dimens
+0003a9d0: 696f 6e20 7761 6e74 6564 2066 6f72 2047  ion wanted for G
+0003a9e0: 5f63 6d20 696e 6665 7265 6e63 652c 0d0a  _cm inference,..
+0003a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa10: 2020 2020 2020 2863 5f72 6567 3a20 7265        (c_reg: re
+0003aa20: 6775 6c61 7269 7361 7469 6f6e 2074 6572  gularisation ter
+0003aa30: 6d20 666f 7220 475f 636d 2069 6e66 6572  m for G_cm infer
+0003aa40: 656e 6365 292c 0d0a 2020 2020 2020 2020  ence),..        
+0003aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aa60: 2020 2020 2020 2020 2020 2020 2020 286e                (n
+0003aa70: 3a20 6e75 6d62 6572 206f 6620 636f 6e74  : number of cont
+0003aa80: 726f 6c20 706f 696e 7473 2066 6f72 2047  rol points for G
+0003aa90: 5f63 6d20 696e 6665 7265 6e63 6529 290d  _cm inference)).
+0003aaa0: 0a0d 0a20 2020 2022 2222 0d0a 0d0a 2020  ...    """....  
+0003aab0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+0003aac0: 656c 662c 206e 616d 652c 206f 7264 6572  elf, name, order
+0003aad0: 2c20 636f 6c6f 722c 2073 7572 6661 6365  , color, surface
+0003aae0: 3d4e 6f6e 652c 2049 443d 4e6f 6e65 2c20  =None, ID=None, 
+0003aaf0: 6d5f 756e 6974 5f6e 616d 653d 4e6f 6e65  m_unit_name=None
+0003ab00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003ab10: 2020 2064 6963 5f66 6163 6965 733d 7b22     dic_facies={"
+0003ab20: 665f 6d65 7468 6f64 223a 2022 686f 6d6f  f_method": "homo
+0003ab30: 6765 6e6f 7573 222c 2022 665f 636f 766d  genous", "f_covm
+0003ab40: 6f64 656c 223a 204e 6f6e 652c 2022 5449  odel": None, "TI
+0003ab50: 223a 204e 6f6e 652c 2022 5375 6250 696c  ": None, "SubPil
+0003ab60: 6522 3a20 4e6f 6e65 2c20 2246 6c61 6722  e": None, "Flag"
+0003ab70: 3a20 4e6f 6e65 2c20 2247 5f63 6d22 3a20  : None, "G_cm": 
+0003ab80: 4e6f 6e65 7d2c 0d0a 2020 2020 2020 2020  None},..        
+0003ab90: 2020 2020 2020 2020 636f 6e74 6163 743d          contact=
+0003aba0: 226f 6e6c 6170 222c 2076 6572 626f 7365  "onlap", verbose
+0003abb0: 3d31 293a 0d0a 2020 2020 0d0a 2020 2020  =1):..    ..    
+0003abc0: 2020 2020 6173 7365 7274 2049 4420 213d      assert ID !=
+0003abd0: 2030 2c20 2249 4420 6361 6e6e 6f74 2062   0, "ID cannot b
+0003abe0: 6520 3022 0d0a 2020 2020 2020 2020 6173  e 0"..        as
+0003abf0: 7365 7274 206e 616d 6520 6973 206e 6f74  sert name is not
+0003ac00: 204e 6f6e 652c 2022 4120 6e61 6d65 206d   None, "A name m
+0003ac10: 7573 7420 6265 2070 726f 7669 6465 6422  ust be provided"
+0003ac20: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+0003ac30: 2069 7369 6e73 7461 6e63 6528 2073 7572   isinstance( sur
+0003ac40: 6661 6365 2c20 5375 7266 6163 6529 2c20  face, Surface), 
+0003ac50: 2241 2073 7572 6661 6365 206f 626a 6563  "A surface objec
+0003ac60: 7420 6d75 7374 2062 6520 7072 6f76 6964  t must be provid
+0003ac70: 6564 2066 6f72 2065 6163 6820 756e 6974  ed for each unit
+0003ac80: 220d 0a0d 0a20 2020 2020 2020 2073 656c  "....        sel
+0003ac90: 662e 6e61 6d65 3d6e 616d 650d 0a20 2020  f.name=name..   
+0003aca0: 2020 2020 2073 656c 662e 6f72 6465 723d       self.order=
+0003acb0: 6f72 6465 720d 0a20 2020 2020 2020 2073  order..        s
+0003acc0: 656c 662e 636f 6e74 6163 743d 636f 6e74  elf.contact=cont
+0003acd0: 6163 740d 0a20 2020 2020 2020 2073 656c  act..        sel
+0003ace0: 662e 633d 636f 6c6f 720d 0a20 2020 2020  f.c=color..     
+0003acf0: 2020 2073 656c 662e 6d5f 756e 6974 5f6e     self.m_unit_n
+0003ad00: 616d 653d 6d5f 756e 6974 5f6e 616d 650d  ame=m_unit_name.
+0003ad10: 0a0d 0a20 2020 2020 2020 2069 6620 4944  ...        if ID
+0003ad20: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0003ad30: 2020 2020 2020 2073 656c 662e 4944 3d6f         self.ID=o
+0003ad40: 7264 6572 0d0a 2020 2020 2020 2020 656c  rder..        el
+0003ad50: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003ad60: 2073 656c 662e 4944 3d49 440d 0a20 2020   self.ID=ID..   
+0003ad70: 2020 2020 2073 656c 662e 5375 6250 696c       self.SubPil
+0003ad80: 653d 4e6f 6e65 0d0a 2020 2020 2020 2020  e=None..        
+0003ad90: 7365 6c66 2e76 6572 626f 7365 3d76 6572  self.verbose=ver
+0003ada0: 626f 7365 0d0a 2020 2020 2020 2020 7365  bose..        se
+0003adb0: 6c66 2e6c 6973 745f 6661 6369 6573 3d5b  lf.list_facies=[
+0003adc0: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+0003add0: 6262 5f75 6e69 7473 203d 205b 5d0d 0a20  bb_units = [].. 
+0003ade0: 2020 2020 2020 2073 656c 662e 7820 3d20         self.x = 
+0003adf0: 5b5d 2020 2320 6461 7461 2063 6f6f 7264  []  # data coord
+0003ae00: 696e 6174 6573 2066 6f72 2063 6174 6567  inates for categ
+0003ae10: 6f72 6963 616c 2073 696d 756c 6174 696f  orical simulatio
+0003ae20: 6e73 0d0a 2020 2020 2020 2020 7365 6c66  ns..        self
+0003ae30: 2e79 203d 205b 5d20 2023 2064 6174 6120  .y = []  # data 
+0003ae40: 636f 6f72 6469 6e61 7465 7320 666f 7220  coordinates for 
+0003ae50: 6361 7465 676f 7269 6361 6c20 7369 6d75  categorical simu
+0003ae60: 6c61 7469 6f6e 730d 0a20 2020 2020 2020  lations..       
+0003ae70: 2073 656c 662e 7a20 3d20 5b5d 2020 2320   self.z = []  # 
+0003ae80: 6461 7461 2063 6f6f 7264 696e 6174 6573  data coordinates
+0003ae90: 2066 6f72 2063 6174 6567 6f72 6963 616c   for categorical
+0003aea0: 2073 696d 756c 6174 696f 6e73 0d0a 2020   simulations..  
+0003aeb0: 2020 2020 2020 7365 6c66 2e6d 756d 6d79        self.mummy
+0003aec0: 5f75 6e69 743d 4e6f 6e65 0d0a 2020 2020  _unit=None..    
+0003aed0: 2020 2020 7365 6c66 2e73 6574 5f64 6963      self.set_dic
+0003aee0: 5f66 6163 6965 7328 6469 635f 6661 6369  _facies(dic_faci
+0003aef0: 6573 2920 2373 6574 2064 6963 2066 6163  es) #set dic fac
+0003af00: 6965 7320 746f 2075 6e69 740d 0a0d 0a20  ies to unit.... 
+0003af10: 2020 2020 2020 2069 6620 7375 7266 6163         if surfac
+0003af20: 6520 6973 206e 6f74 204e 6f6e 653a 0d0a  e is not None:..
+0003af30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003af40: 2e73 6574 5f53 7572 6661 6365 2873 7572  .set_Surface(sur
+0003af50: 6661 6365 290d 0a0d 0a0d 0a20 2020 2064  face)......    d
+0003af60: 6566 2073 6574 5f64 6963 5f66 6163 6965  ef set_dic_facie
+0003af70: 7328 7365 6c66 2c20 6469 635f 6661 6369  s(self, dic_faci
+0003af80: 6573 293a 0d0a 0d0a 2020 2020 2020 2020  es):....        
+0003af90: 2222 220d 0a20 2020 2020 2020 2053 6574  """..        Set
+0003afa0: 2061 2064 6963 7469 6f6e 6172 7920 6661   a dictionary fa
+0003afb0: 6369 6573 2074 6f20 556e 6974 206f 626a  cies to Unit obj
+0003afc0: 6563 740d 0a0d 0a20 2020 2020 2020 2050  ect....        P
+0003afd0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0003afe0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0003aff0: 2020 2020 2020 2064 6963 5f66 6163 6965         dic_facie
+0003b000: 7320 3a20 6469 6374 0d0a 2020 2020 2020  s : dict..      
+0003b010: 2020 2020 2020 6469 6374 696f 6e6e 6172        dictionnar
+0003b020: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+0003b030: 2070 6172 616d 6574 6572 7320 746f 2070   parameters to p
+0003b040: 6173 7320 6174 2074 6865 2066 6163 6965  ass at the facie
+0003b050: 7320 6d65 7468 6f64 730d 0a20 2020 2020  s methods..     
+0003b060: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
+0003b070: 2020 6173 7365 7274 2064 6963 5f66 6163    assert dic_fac
+0003b080: 6965 735b 2266 5f6d 6574 686f 6422 5d20  ies["f_method"] 
+0003b090: 696e 2028 224d 5053 222c 2022 5349 5322  in ("MPS", "SIS"
+0003b0a0: 2c20 2268 6f6d 6f67 656e 6f75 7322 2c20  , "homogenous", 
+0003b0b0: 2254 5047 7322 2c20 2253 7562 5069 6c65  "TPGs", "SubPile
+0003b0c0: 2229 2c20 2746 696c 6c69 6e67 206d 6574  "), 'Filling met
+0003b0d0: 686f 6420 756e 6b6e 6f77 6e2c 2076 616c  hod unknown, val
+0003b0e0: 6964 7320 6172 6520 224d 5053 222c 2022  ids are "MPS", "
+0003b0f0: 5349 5322 2c20 2268 6f6d 6f67 656e 6f75  SIS", "homogenou
+0003b100: 7322 2c20 2254 5047 7322 2c20 2253 7562  s", "TPGs", "Sub
+0003b110: 5069 6c65 270d 0a0d 0a20 2020 2020 2020  Pile'....       
+0003b120: 2073 656c 662e 665f 6d65 7468 6f64 3d64   self.f_method=d
+0003b130: 6963 5f66 6163 6965 735b 2266 5f6d 6574  ic_facies["f_met
+0003b140: 686f 6422 5d0d 0a20 2020 2020 2020 2023  hod"]..        #
+0003b150: 2063 6865 636b 2069 6d70 6f72 7461 6e74   check important
+0003b160: 2069 6e70 7574 2066 6f72 2066 6163 6965   input for facie
+0003b170: 7320 6d65 7468 6f64 730d 0a20 2020 2020  s methods..     
+0003b180: 2020 2023 4d50 530d 0a20 2020 2020 2020     #MPS..       
+0003b190: 2069 6620 7365 6c66 2e66 5f6d 6574 686f   if self.f_metho
+0003b1a0: 6420 3d3d 2022 4d50 5322 3a0d 0a20 2020  d == "MPS":..   
+0003b1b0: 2020 2020 2020 2020 2069 6620 2254 4922           if "TI"
+0003b1c0: 206e 6f74 2069 6e20 6469 635f 6661 6369   not in dic_faci
+0003b1d0: 6573 2e6b 6579 7328 293a 0d0a 2020 2020  es.keys():..    
+0003b1e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0003b1f0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
+0003b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b210: 2020 7072 696e 7428 2257 4152 4e49 4e47    print("WARNING
+0003b220: 204e 4f20 5449 2050 4153 5345 4420 464f   NO TI PASSED FO
+0003b230: 5220 4d50 5320 5349 4d55 4c41 5449 4f4e  R MPS SIMULATION
+0003b240: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+0003b250: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0003b260: 2020 2020 2020 2073 656c 662e 7365 745f         self.set_
+0003b270: 665f 5449 2864 6963 5f66 6163 6965 735b  f_TI(dic_facies[
+0003b280: 2254 4922 5d29 0d0a 0d0a 2020 2020 2020  "TI"])....      
+0003b290: 2020 2353 7562 7069 6c65 0d0a 2020 2020    #Subpile..    
+0003b2a0: 2020 2020 656c 6966 2073 656c 662e 665f      elif self.f_
+0003b2b0: 6d65 7468 6f64 203d 3d20 2253 7562 5069  method == "SubPi
+0003b2c0: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
+0003b2d0: 2020 6966 2022 5375 6250 696c 6522 206e    if "SubPile" n
+0003b2e0: 6f74 2069 6e20 6469 635f 6661 6369 6573  ot in dic_facies
+0003b2f0: 2e6b 6579 7328 293a 0d0a 2020 2020 2020  .keys():..      
+0003b300: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003b310: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
+0003b320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b330: 7072 696e 7428 224e 6f20 5375 6250 696c  print("No SubPil
+0003b340: 6520 7061 7373 6564 2066 6f72 2053 7562  e passed for Sub
+0003b350: 5069 6c65 2066 696c 6c69 6e67 2c20 636f  Pile filling, co
+0003b360: 6e73 6964 6572 2061 6464 696e 6720 6f6e  nsider adding on
+0003b370: 6520 7769 7468 2073 6574 5f53 7562 5069  e with set_SubPi
+0003b380: 6c65 2829 2062 6566 6f72 6520 7072 6f63  le() before proc
+0003b390: 6565 6469 6e67 2229 0d0a 2020 2020 2020  eeding")..      
+0003b3a0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0003b3b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003b3c0: 662e 7365 745f 5375 6250 696c 6528 6469  f.set_SubPile(di
+0003b3d0: 635f 6661 6369 6573 5b22 5375 6250 696c  c_facies["SubPil
+0003b3e0: 6522 5d29 0d0a 0d0a 2020 2020 2020 2020  e"])....        
+0003b3f0: 2020 2020 6966 2022 756e 6974 735f 6669      if "units_fi
+0003b400: 6c6c 5f6d 6574 686f 6422 2069 6e20 6469  ll_method" in di
+0003b410: 635f 6661 6369 6573 2e6b 6579 7328 293a  c_facies.keys():
+0003b420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003b430: 2020 6966 2064 6963 5f66 6163 6965 735b    if dic_facies[
+0003b440: 2275 6e69 7473 5f66 696c 6c5f 6d65 7468  "units_fill_meth
+0003b450: 6f64 225d 203d 3d20 2253 4953 223a 0d0a  od"] == "SIS":..
+0003b460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b470: 2020 2020 7365 6c66 2e73 6574 5f66 5f63      self.set_f_c
+0003b480: 6f76 6d6f 6465 6c73 2864 6963 5f66 6163  ovmodels(dic_fac
+0003b490: 6965 735b 2266 5f63 6f76 6d6f 6465 6c22  ies["f_covmodel"
+0003b4a0: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
+0003b4b0: 2020 2020 2020 656c 6966 2064 6963 5f66        elif dic_f
+0003b4c0: 6163 6965 735b 2275 6e69 7473 5f66 696c  acies["units_fil
+0003b4d0: 6c5f 6d65 7468 6f64 225d 203d 3d20 224d  l_method"] == "M
+0003b4e0: 5053 223a 0d0a 2020 2020 2020 2020 2020  PS":..          
+0003b4f0: 2020 2020 2020 2020 2020 6966 2022 5449            if "TI
+0003b500: 2220 6e6f 7420 696e 2064 6963 5f66 6163  " not in dic_fac
+0003b510: 6965 732e 6b65 7973 2829 3a0d 0a20 2020  ies.keys():..   
+0003b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b530: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0003b540: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+0003b550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b560: 2020 2070 7269 6e74 2822 5741 524e 494e     print("WARNIN
+0003b570: 4720 4e4f 2054 4920 5041 5353 4544 2046  G NO TI PASSED F
+0003b580: 4f52 204d 5053 2053 494d 554c 4154 494f  OR MPS SIMULATIO
+0003b590: 4e22 290d 0a20 2020 2020 2020 2020 2020  N")..           
+0003b5a0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
 0003b5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b5c0: 2020 7365 6c66 2e47 5f63 6d20 3d20 6469    self.G_cm = di
-0003b5d0: 635f 6661 6369 6573 5b22 475f 636d 225d  c_facies["G_cm"]
-0003b5e0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003b5f0: 2320 544f 2043 4f4d 504c 4554 450d 0a0d  # TO COMPLETE...
-0003b600: 0a20 2020 2020 2020 2023 5472 756e 6361  .        #Trunca
-0003b610: 7465 6420 506c 7572 6967 6175 7373 6961  ted Plurigaussia
-0003b620: 6e73 2043 5245 4154 4520 4348 4543 4b20  ns CREATE CHECK 
-0003b630: 4655 4e43 5449 4f4e 5320 544f 2044 4f0d  FUNCTIONS TO DO.
-0003b640: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-0003b650: 6c66 2e66 5f6d 6574 686f 6420 3d3d 2022  lf.f_method == "
-0003b660: 5450 4773 223a 0d0a 2020 2020 2020 2020  TPGs":..        
-0003b670: 2020 2020 2361 7373 6572 740d 0a20 2020      #assert..   
-0003b680: 2020 2020 2020 2020 2073 656c 662e 666c           self.fl
-0003b690: 6167 3d64 6963 5f66 6163 6965 735b 2246  ag=dic_facies["F
-0003b6a0: 6c61 6722 5d0d 0a20 2020 2020 2020 2020  lag"]..         
-0003b6b0: 2020 2073 656c 662e 475f 636d 3d64 6963     self.G_cm=dic
-0003b6c0: 5f66 6163 6965 735b 2247 5f63 6d22 5d0d  _facies["G_cm"].
-0003b6d0: 0a0d 0a20 2020 2020 2020 2023 2053 4953  ...        # SIS
-0003b6e0: 0d0a 2020 2020 2020 2020 656c 6966 2073  ..        elif s
-0003b6f0: 656c 662e 665f 6d65 7468 6f64 203d 3d20  elf.f_method == 
-0003b700: 2253 4953 223a 0d0a 2020 2020 2020 2020  "SIS":..        
-0003b710: 2020 2020 6966 2022 665f 636f 766d 6f64      if "f_covmod
-0003b720: 656c 2220 6e6f 7420 696e 2064 6963 5f66  el" not in dic_f
-0003b730: 6163 6965 732e 6b65 7973 2829 3a0d 0a20  acies.keys():.. 
-0003b740: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003b750: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-0003b760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b770: 2020 2020 2070 7269 6e74 2822 556e 6974       print("Unit
-0003b780: 207b 7d3a 2057 4152 4e49 4e47 204e 4f20   {}: WARNING NO 
-0003b790: 434f 564d 4f44 454c 5320 5041 5353 4544  COVMODELS PASSED
-0003b7a0: 2046 4f52 2053 4953 2053 494d 554c 4154   FOR SIS SIMULAT
-0003b7b0: 494f 4e22 2e66 6f72 6d61 7428 7365 6c66  ION".format(self
-0003b7c0: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-0003b7d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003b7e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003b7f0: 2e73 6574 5f66 5f63 6f76 6d6f 6465 6c73  .set_f_covmodels
-0003b800: 2864 6963 5f66 6163 6965 735b 2266 5f63  (dic_facies["f_c
-0003b810: 6f76 6d6f 6465 6c22 5d29 0d0a 0d0a 2020  ovmodel"])....  
-0003b820: 2020 2020 2020 7365 6c66 2e64 6963 5f66        self.dic_f
-0003b830: 6163 6965 733d 6469 635f 6661 6369 6573  acies=dic_facies
-0003b840: 0d0a 0d0a 0d0a 2020 2020 2323 206d 6167  ......    ## mag
-0003b850: 6963 2066 756e 0d0a 2020 2020 6465 6620  ic fun..    def 
-0003b860: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0d  __repr__(self):.
-0003b870: 0a20 2020 2020 2020 2073 3d73 656c 662e  .        s=self.
-0003b880: 6e61 6d65 0d0a 2020 2020 2020 2020 7265  name..        re
-0003b890: 7475 726e 2073 0d0a 0d0a 2020 2020 6465  turn s....    de
-0003b8a0: 6620 5f5f 6361 6c6c 5f5f 2873 656c 6629  f __call__(self)
-0003b8b0: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
-0003b8c0: 6e20 7072 696e 7428 2255 6e69 7420 7b7d  n print("Unit {}
-0003b8d0: 222e 666f 726d 6174 2873 656c 662e 6e61  ".format(self.na
-0003b8e0: 6d65 2929 0d0a 0d0a 2020 2020 6465 6620  me))....    def 
-0003b8f0: 5f5f 6571 5f5f 2873 656c 662c 206f 7468  __eq__(self, oth
-0003b900: 6572 293a 0d0a 2020 2020 2020 2020 2222  er):..        ""
-0003b910: 220d 0a20 2020 2020 2020 2066 6f72 2063  "..        for c
-0003b920: 6f6d 7061 7269 736f 6e0d 0a20 2020 2020  omparison..     
-0003b930: 2020 2022 2222 0d0a 0d0a 2020 2020 2020     """....      
-0003b940: 2020 6966 206f 7468 6572 2069 7320 6e6f    if other is no
-0003b950: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0003b960: 2020 2020 2069 6620 2873 656c 662e 6e61       if (self.na
-0003b970: 6d65 203d 3d20 6f74 6865 722e 6e61 6d65  me == other.name
-0003b980: 2920 2620 2873 656c 662e 6f72 6465 7220  ) & (self.order 
-0003b990: 3d3d 206f 7468 6572 2e6f 7264 6572 293a  == other.order):
-0003b9a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b9b0: 2020 7265 7475 726e 2054 7275 650d 0a20    return True.. 
-0003b9c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0003b9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003b9e0: 2020 7265 7475 726e 2046 616c 7365 0d0a    return False..
-0003b9f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0003ba00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0003ba10: 6e20 4661 6c73 650d 0a0d 0a20 2020 2064  n False....    d
-0003ba20: 6566 205f 5f69 745f 5f28 7365 6c66 2c20  ef __it__(self, 
-0003ba30: 6f74 6865 7229 3a20 2320 696e 6571 7561  other): # inequa
-0003ba40: 6c69 7479 2063 6f6d 7061 7269 736f 6e0d  lity comparison.
-0003ba50: 0a20 2020 2020 2020 2069 6620 2873 656c  .        if (sel
-0003ba60: 662e 6f72 6465 7220 3c20 6f74 6865 722e  f.order < other.
-0003ba70: 6f72 6465 7229 3a0d 0a20 2020 2020 2020  order):..       
-0003ba80: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-0003ba90: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0003baa0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0003bab0: 7572 6e20 4661 6c73 650d 0a0d 0a20 2020  urn False....   
-0003bac0: 2064 6566 205f 5f67 745f 5f28 7365 6c66   def __gt__(self
-0003bad0: 2c20 6f74 6865 7229 3a20 2320 696e 6571  , other): # ineq
-0003bae0: 7561 6c69 7479 2063 6f6d 7061 7269 736f  uality compariso
-0003baf0: 6e0d 0a20 2020 2020 2020 2069 6620 2873  n..        if (s
-0003bb00: 656c 662e 6f72 6465 7220 3e20 6f74 6865  elf.order > othe
-0003bb10: 722e 6f72 6465 7229 3a0d 0a20 2020 2020  r.order):..     
-0003bb20: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-0003bb30: 7565 0d0a 2020 2020 2020 2020 656c 7365  ue..        else
-0003bb40: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0003bb50: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
-0003bb60: 2020 2064 6566 205f 5f73 7472 5f5f 2873     def __str__(s
-0003bb70: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
-0003bb80: 6574 7572 6e20 7365 6c66 2e6e 616d 650d  eturn self.name.
-0003bb90: 0a0d 0a20 2020 2023 636f 7079 2066 756e  ...    #copy fun
-0003bba0: 0d0a 2020 2020 6465 6620 636f 7079 2873  ..    def copy(s
-0003bbb0: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
-0003bbc0: 6574 7572 6e20 636f 7079 2e64 6565 7063  eturn copy.deepc
-0003bbd0: 6f70 7928 7365 6c66 290d 0a0d 0a20 2020  opy(self)....   
-0003bbe0: 2064 6566 2073 6574 5f53 7562 5069 6c65   def set_SubPile
-0003bbf0: 2873 656c 662c 2053 7562 5069 6c65 293a  (self, SubPile):
-0003bc00: 0d0a 0d0a 2020 2020 2020 2020 2222 220d  ....        """.
-0003bc10: 0a20 2020 2020 2020 2043 6861 6e67 6520  .        Change 
-0003bc20: 6f72 2064 6566 696e 6520 6120 7375 6270  or define a subp
-0003bc30: 696c 6520 666f 7220 6669 6c6c 696e 670d  ile for filling.
-0003bc40: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003bc50: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003bc60: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-0003bc70: 2020 2053 7562 5069 6c65 203a 203a 636c     SubPile : :cl
-0003bc80: 6173 733a 6050 696c 6560 206f 626a 6563  ass:`Pile` objec
-0003bc90: 7409 0d0a 2020 2020 2020 2020 2222 220d  t...        """.
-0003bca0: 0a0d 0a20 2020 2020 2020 2069 6620 6973  ...        if is
-0003bcb0: 696e 7374 616e 6365 2853 7562 5069 6c65  instance(SubPile
-0003bcc0: 2c20 5069 6c65 293a 0d0a 2020 2020 2020  , Pile):..      
-0003bcd0: 2020 2020 2020 6966 2073 656c 662e 665f        if self.f_
-0003bce0: 6d65 7468 6f64 203d 3d20 2253 7562 5069  method == "SubPi
-0003bcf0: 6c65 223a 0d0a 2020 2020 2020 2020 2020  le":..          
-0003bd00: 2020 2020 2020 7365 6c66 2e53 7562 5069        self.SubPi
-0003bd10: 6c65 3d53 7562 5069 6c65 0d0a 2020 2020  le=SubPile..    
-0003bd20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0003bd30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003bd40: 6620 7365 6c66 2e76 6572 626f 7365 3a0d  f self.verbose:.
-0003bd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bd60: 2020 2020 2070 7269 6e74 2822 5265 616c       print("Real
-0003bd70: 6c79 203f 2046 696c 6c69 6e67 206d 6574  ly ? Filling met
-0003bd80: 686f 6420 6973 206e 6f74 2053 7562 5069  hod is not SubPi
-0003bd90: 6c65 2229 0d0a 2020 2020 2020 2020 656c  le")..        el
-0003bda0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0003bdb0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0003bdc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003bdd0: 2020 2070 7269 6e74 2822 5468 6520 5375     print("The Su
-0003bde0: 6250 696c 6520 6f62 6a65 6374 2069 7320  bPile object is 
-0003bdf0: 6e6f 7420 616e 2041 7263 685f 7461 626c  not an Arch_tabl
-0003be00: 6520 6f62 6a65 6374 2229 0d0a 0d0a 2020  e object")....  
-0003be10: 2020 6465 6620 7365 745f 665f 5449 2873    def set_f_TI(s
-0003be20: 656c 662c 2054 4929 3a0d 0a0d 0a20 2020  elf, TI):....   
-0003be30: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-0003be40: 2020 4368 616e 6765 2074 7261 696e 696e    Change trainin
-0003be50: 6720 696d 6167 6520 666f 7220 6120 7374  g image for a st
-0003be60: 7261 7469 2075 6e69 740d 0a0d 0a20 2020  rati unit....   
-0003be70: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0003be80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0003be90: 2d2d 2d0d 0a20 2020 2020 2020 2054 493a  ---..        TI:
-0003bea0: 2067 656f 6e65 2e69 6d61 6765 0d0a 2020   geone.image..  
-0003beb0: 2020 2020 2020 2020 2020 5472 6169 6e69            Traini
-0003bec0: 6e67 2069 6d61 6765 2074 6f20 7573 6520  ng image to use 
-0003bed0: 7769 7468 2074 6865 204d 5053 0d0a 2020  with the MPS..  
-0003bee0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-0003bef0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0003bf00: 6365 2854 492c 2067 656f 6e65 2e69 6d67  ce(TI, geone.img
-0003bf10: 2e49 6d67 293a 0d0a 2020 2020 2020 2020  .Img):..        
-0003bf20: 2020 2020 7365 6c66 2e66 5f54 493d 5449      self.f_TI=TI
-0003bf30: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003bf40: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
-0003bf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf60: 7072 696e 7428 2255 6e69 7420 7b7d 3a20  print("Unit {}: 
-0003bf70: 5449 2061 6464 6564 222e 666f 726d 6174  TI added".format
-0003bf80: 2873 656c 662e 6e61 6d65 2929 0d0a 2020  (self.name))..  
-0003bf90: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0003bfa0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-0003bfb0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
-0003bfc0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003bfd0: 2822 5449 204e 4f54 2041 2047 454f 4e45  ("TI NOT A GEONE
-0003bfe0: 2049 4d41 4745 2229 0d0a 0d0a 2020 2020   IMAGE")....    
-0003bff0: 6465 6620 7365 745f 5375 7266 6163 6528  def set_Surface(
-0003c000: 7365 6c66 2c20 7375 7266 6163 6529 3a0d  self, surface):.
-0003c010: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0003c020: 2020 2020 2020 2020 4368 616e 6765 206f          Change o
-0003c030: 7220 6164 6420 6120 746f 7020 7375 7266  r add a top surf
-0003c040: 6163 6520 666f 7220 556e 6974 206f 626a  ace for Unit obj
-0003c050: 6563 742e 0d0a 2020 2020 2020 2020 5468  ect...        Th
-0003c060: 6973 2077 696c 6c20 6465 6669 6e65 2068  is will define h
-0003c070: 6f77 2074 6865 2074 6f70 206f 6620 7468  ow the top of th
-0003c080: 6520 666f 726d 6174 696f 6e20 7769 6c6c  e formation will
-0003c090: 2062 6520 6d6f 6465 6c6c 6564 2e0d 0a0d   be modelled....
-0003c0a0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0003c0b0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0003c0c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0003c0d0: 2073 7572 6661 6365 3a20 3a63 6c61 7373   surface: :class
-0003c0e0: 3a60 5375 7266 6163 6560 206f 626a 6563  :`Surface` objec
-0003c0f0: 740d 0a20 2020 2020 2020 2020 2020 2053  t..            S
-0003c100: 7572 6661 6365 206f 626a 6563 7420 746f  urface object to
-0003c110: 2075 7365 2066 6f72 2074 6865 2073 696d   use for the sim
-0003c120: 756c 6174 696f 6e20 6f66 2074 6865 2074  ulation of the t
-0003c130: 6f70 206f 6620 7468 6520 666f 726d 6174  op of the format
-0003c140: 696f 6e0d 0a20 2020 2020 2020 2022 2222  ion..        """
-0003c150: 0d0a 0d0a 2020 2020 2020 2020 6966 2069  ....        if i
-0003c160: 7369 6e73 7461 6e63 6528 7375 7266 6163  sinstance(surfac
-0003c170: 652c 2053 7572 6661 6365 293a 0d0a 2020  e, Surface):..  
-0003c180: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0003c190: 7572 6661 6365 3d73 7572 6661 6365 0d0a  urface=surface..
-0003c1a0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0003c1b0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-0003c1c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0003c1d0: 696e 7428 2255 6e69 7420 7b7d 3a20 5375  int("Unit {}: Su
-0003c1e0: 7266 6163 6520 6164 6465 6420 666f 7220  rface added for 
-0003c1f0: 696e 7465 7270 6f6c 6174 696f 6e22 2e66  interpolation".f
-0003c200: 6f72 6d61 7428 7365 6c66 2e6e 616d 6529  ormat(self.name)
-0003c210: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-0003c220: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0003c230: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-0003c240: 5375 7266 6163 6520 6f62 6a65 6374 206d  Surface object m
-0003c250: 7573 7420 6265 2061 6e20 6f62 6a65 6374  ust be an object
-0003c260: 206f 6620 7468 6520 636c 6173 7320 5375   of the class Su
-0003c270: 7266 6163 6520 6672 6f6d 2041 7263 6850  rface from ArchP
-0003c280: 7922 290d 0a0d 0a20 2020 2064 6566 2073  y")....    def s
-0003c290: 6574 5f66 5f63 6f76 6d6f 6465 6c73 2873  et_f_covmodels(s
-0003c2a0: 656c 662c 2066 5f63 6f76 6d6f 6465 6c29  elf, f_covmodel)
-0003c2b0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0003c2c0: 0d0a 2020 2020 2020 2020 5265 6d6f 7665  ..        Remove
-0003c2d0: 2065 7869 7374 696e 6720 6661 6369 6573   existing facies
-0003c2e0: 2063 6f76 6d6f 6465 6c73 2061 6e64 206f   covmodels and o
-0003c2f0: 6e65 206f 7220 6d6f 7265 0d0a 2020 2020  ne or more..    
-0003c300: 2020 2020 6465 7065 6e64 696e 6720 6f66      depending of
-0003c310: 2077 6861 7420 6973 2070 6173 7365 6420   what is passed 
-0003c320: 2861 7272 6179 206c 696b 6520 6f72 206f  (array like or o
-0003c330: 6e6c 7920 6f6e 6520 6f62 6a65 6374 290d  nly one object).
-0003c340: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003c350: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-0003c360: 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a20 2020  ---------....   
-0003c370: 2020 2020 2066 5f63 6f76 6d6f 6465 6c3a       f_covmodel:
-0003c380: 2067 656f 6e65 2e63 6f76 4d6f 6465 6c20   geone.covModel 
-0003c390: 6f62 6a65 6374 200d 0a20 2020 2020 2020  object ..       
-0003c3a0: 2020 2020 2074 6861 7420 7769 6c6c 2062       that will b
-0003c3b0: 6520 7573 6564 2066 6f72 2074 6865 2069  e used for the i
-0003c3c0: 6e74 6572 706f 6c61 7469 6f6e 206f 6620  nterpolation of 
-0003c3d0: 7468 6520 6661 6369 6573 2069 6620 6d65  the facies if me
-0003c3e0: 7468 6f64 2069 7320 5349 532e 0d0a 2020  thod is SIS...  
-0003c3f0: 2020 2020 2020 2020 2020 4361 6e20 6265            Can be
-0003c400: 2061 206c 6973 7420 6f72 206f 6e6c 7920   a list or only 
-0003c410: 6f6e 6520 6f62 6a65 6374 2e0d 0a20 2020  one object...   
-0003c420: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
-0003c430: 2020 2020 7365 6c66 2e6c 6973 745f 665f      self.list_f_
-0003c440: 636f 766d 6f64 656c 3d5b 5d0d 0a20 2020  covmodel=[]..   
-0003c450: 2020 2020 2063 6f76 6d6f 6465 6c73 5f63       covmodels_c
-0003c460: 6c61 7373 3d28 6765 6f6e 652e 636f 764d  lass=(geone.covM
-0003c470: 6f64 656c 2e43 6f76 4d6f 6465 6c33 4429  odel.CovModel3D)
-0003c480: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-0003c490: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003c4a0: 636f 766d 6f64 656c 2069 6e20 665f 636f  covmodel in f_co
-0003c4b0: 766d 6f64 656c 3a0d 0a20 2020 2020 2020  vmodel:..       
-0003c4c0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0003c4d0: 7374 616e 6365 2863 6f76 6d6f 6465 6c2c  stance(covmodel,
-0003c4e0: 2063 6f76 6d6f 6465 6c73 5f63 6c61 7373   covmodels_class
-0003c4f0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0003c500: 2020 2020 2020 2020 663d 310d 0a20 2020          f=1..   
-0003c510: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0003c520: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0003c530: 2020 2020 2020 2020 663d 300d 0a20 2020          f=0..   
-0003c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c550: 2062 7265 616b 0d0a 2020 2020 2020 2020   break..        
-0003c560: 2020 2020 6966 2066 3a0d 0a20 2020 2020      if f:..     
-0003c570: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003c580: 6c69 7374 5f66 5f63 6f76 6d6f 6465 6c3d  list_f_covmodel=
-0003c590: 665f 636f 766d 6f64 656c 0d0a 0d0a 2020  f_covmodel....  
-0003c5a0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0003c5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c5c0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0003c5d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003c5e0: 2020 2020 2020 2070 7269 6e74 2822 6174         print("at
-0003c5f0: 206c 6561 7374 206f 6e65 2063 6f76 6d6f   least one covmo
-0003c600: 6465 6c20 6973 206e 6f74 2061 2033 4420  del is not a 3D 
-0003c610: 636f 766d 6f64 656c 2067 656f 6e65 2c20  covmodel geone, 
-0003c620: 6e6f 7468 696e 6720 6861 7320 6368 616e  nothing has chan
-0003c630: 6765 6422 290d 0a0d 0a20 2020 2020 2020  ged")....       
-0003c640: 2065 7863 6570 743a 2023 206f 6e6c 7920   except: # only 
-0003c650: 6f6e 6520 6f62 6a65 6374 2070 6173 7365  one object passe
-0003c660: 640d 0a20 2020 2020 2020 2020 2020 2069  d..            i
-0003c670: 6620 6973 696e 7374 616e 6365 2866 5f63  f isinstance(f_c
-0003c680: 6f76 6d6f 6465 6c2c 2063 6f76 6d6f 6465  ovmodel, covmode
-0003c690: 6c73 5f63 6c61 7373 293a 0d0a 2020 2020  ls_class):..    
-0003c6a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003c6b0: 2e6c 6973 745f 665f 636f 766d 6f64 656c  .list_f_covmodel
-0003c6c0: 2e61 7070 656e 6428 665f 636f 766d 6f64  .append(f_covmod
-0003c6d0: 656c 290d 0a20 2020 2020 2020 2020 2020  el)..           
+0003b5c0: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+0003b5d0: 5f66 5f54 4928 6469 635f 6661 6369 6573  _f_TI(dic_facies
+0003b5e0: 5b22 5449 225d 290d 0a0d 0a20 2020 2020  ["TI"])....     
+0003b5f0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0003b600: 6469 635f 6661 6369 6573 5b22 756e 6974  dic_facies["unit
+0003b610: 735f 6669 6c6c 5f6d 6574 686f 6422 5d20  s_fill_method"] 
+0003b620: 3d3d 2022 5450 4773 223a 0d0a 2020 2020  == "TPGs":..    
+0003b630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b640: 6966 2022 466c 6167 2220 696e 2064 6963  if "Flag" in dic
+0003b650: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
+0003b660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b670: 2020 2020 2020 2020 2073 656c 662e 666c           self.fl
+0003b680: 6167 203d 2064 6963 5f66 6163 6965 735b  ag = dic_facies[
+0003b690: 2246 6c61 6722 5d0d 0a20 2020 2020 2020  "Flag"]..       
+0003b6a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003b6b0: 2247 5f63 6d22 2069 6e20 6469 635f 6661  "G_cm" in dic_fa
+0003b6c0: 6369 6573 2e6b 6579 7328 293a 0d0a 2020  cies.keys():..  
+0003b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b6e0: 2020 2020 2020 7365 6c66 2e47 5f63 6d20        self.G_cm 
+0003b6f0: 3d20 6469 635f 6661 6369 6573 5b22 475f  = dic_facies["G_
+0003b700: 636d 225d 0d0a 0d0a 2020 2020 2020 2020  cm"]....        
+0003b710: 2020 2020 2320 544f 2043 4f4d 504c 4554      # TO COMPLET
+0003b720: 450d 0a0d 0a20 2020 2020 2020 2023 5472  E....        #Tr
+0003b730: 756e 6361 7465 6420 506c 7572 6967 6175  uncated Plurigau
+0003b740: 7373 6961 6e73 2043 5245 4154 4520 4348  ssians CREATE CH
+0003b750: 4543 4b20 4655 4e43 5449 4f4e 5320 544f  ECK FUNCTIONS TO
+0003b760: 2044 4f0d 0a20 2020 2020 2020 2065 6c69   DO..        eli
+0003b770: 6620 7365 6c66 2e66 5f6d 6574 686f 6420  f self.f_method 
+0003b780: 3d3d 2022 5450 4773 223a 0d0a 2020 2020  == "TPGs":..    
+0003b790: 2020 2020 2020 2020 2361 7373 6572 740d          #assert.
+0003b7a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003b7b0: 662e 666c 6167 3d64 6963 5f66 6163 6965  f.flag=dic_facie
+0003b7c0: 735b 2246 6c61 6722 5d0d 0a20 2020 2020  s["Flag"]..     
+0003b7d0: 2020 2020 2020 2073 656c 662e 475f 636d         self.G_cm
+0003b7e0: 3d64 6963 5f66 6163 6965 735b 2247 5f63  =dic_facies["G_c
+0003b7f0: 6d22 5d0d 0a0d 0a20 2020 2020 2020 2023  m"]....        #
+0003b800: 2053 4953 0d0a 2020 2020 2020 2020 656c   SIS..        el
+0003b810: 6966 2073 656c 662e 665f 6d65 7468 6f64  if self.f_method
+0003b820: 203d 3d20 2253 4953 223a 0d0a 2020 2020   == "SIS":..    
+0003b830: 2020 2020 2020 2020 6966 2022 665f 636f          if "f_co
+0003b840: 766d 6f64 656c 2220 6e6f 7420 696e 2064  vmodel" not in d
+0003b850: 6963 5f66 6163 6965 732e 6b65 7973 2829  ic_facies.keys()
+0003b860: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003b870: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0003b880: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003b890: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0003b8a0: 556e 6974 207b 7d3a 2057 4152 4e49 4e47  Unit {}: WARNING
+0003b8b0: 204e 4f20 434f 564d 4f44 454c 5320 5041   NO COVMODELS PA
+0003b8c0: 5353 4544 2046 4f52 2053 4953 2053 494d  SSED FOR SIS SIM
+0003b8d0: 554c 4154 494f 4e22 2e66 6f72 6d61 7428  ULATION".format(
+0003b8e0: 7365 6c66 2e6e 616d 6529 290d 0a20 2020  self.name))..   
+0003b8f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0003b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003b910: 7365 6c66 2e73 6574 5f66 5f63 6f76 6d6f  self.set_f_covmo
+0003b920: 6465 6c73 2864 6963 5f66 6163 6965 735b  dels(dic_facies[
+0003b930: 2266 5f63 6f76 6d6f 6465 6c22 5d29 0d0a  "f_covmodel"])..
+0003b940: 0d0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
+0003b950: 6963 5f66 6163 6965 733d 6469 635f 6661  ic_facies=dic_fa
+0003b960: 6369 6573 0d0a 0d0a 0d0a 2020 2020 2323  cies......    ##
+0003b970: 206d 6167 6963 2066 756e 0d0a 2020 2020   magic fun..    
+0003b980: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
+0003b990: 6629 3a0d 0a20 2020 2020 2020 2073 3d73  f):..        s=s
+0003b9a0: 656c 662e 6e61 6d65 0d0a 2020 2020 2020  elf.name..      
+0003b9b0: 2020 7265 7475 726e 2073 0d0a 0d0a 2020    return s....  
+0003b9c0: 2020 6465 6620 5f5f 6361 6c6c 5f5f 2873    def __call__(s
+0003b9d0: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
+0003b9e0: 6574 7572 6e20 7072 696e 7428 2255 6e69  eturn print("Uni
+0003b9f0: 7420 7b7d 222e 666f 726d 6174 2873 656c  t {}".format(sel
+0003ba00: 662e 6e61 6d65 2929 0d0a 0d0a 2020 2020  f.name))....    
+0003ba10: 6465 6620 5f5f 6571 5f5f 2873 656c 662c  def __eq__(self,
+0003ba20: 206f 7468 6572 293a 0d0a 2020 2020 2020   other):..      
+0003ba30: 2020 2222 220d 0a20 2020 2020 2020 2066    """..        f
+0003ba40: 6f72 2063 6f6d 7061 7269 736f 6e0d 0a20  or comparison.. 
+0003ba50: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+0003ba60: 2020 2020 2020 6966 206f 7468 6572 2069        if other i
+0003ba70: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0003ba80: 2020 2020 2020 2020 2069 6620 2873 656c           if (sel
+0003ba90: 662e 6e61 6d65 203d 3d20 6f74 6865 722e  f.name == other.
+0003baa0: 6e61 6d65 2920 2620 2873 656c 662e 6f72  name) & (self.or
+0003bab0: 6465 7220 3d3d 206f 7468 6572 2e6f 7264  der == other.ord
+0003bac0: 6572 293a 0d0a 2020 2020 2020 2020 2020  er):..          
+0003bad0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+0003bae0: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
+0003baf0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003bb00: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0003bb10: 7365 0d0a 2020 2020 2020 2020 656c 7365  se..        else
+0003bb20: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0003bb30: 6574 7572 6e20 4661 6c73 650d 0a0d 0a20  eturn False.... 
+0003bb40: 2020 2064 6566 205f 5f69 745f 5f28 7365     def __it__(se
+0003bb50: 6c66 2c20 6f74 6865 7229 3a20 2320 696e  lf, other): # in
+0003bb60: 6571 7561 6c69 7479 2063 6f6d 7061 7269  equality compari
+0003bb70: 736f 6e0d 0a20 2020 2020 2020 2069 6620  son..        if 
+0003bb80: 2873 656c 662e 6f72 6465 7220 3c20 6f74  (self.order < ot
+0003bb90: 6865 722e 6f72 6465 7229 3a0d 0a20 2020  her.order):..   
+0003bba0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003bbb0: 5472 7565 0d0a 2020 2020 2020 2020 656c  True..        el
+0003bbc0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003bbd0: 2072 6574 7572 6e20 4661 6c73 650d 0a0d   return False...
+0003bbe0: 0a20 2020 2064 6566 205f 5f67 745f 5f28  .    def __gt__(
+0003bbf0: 7365 6c66 2c20 6f74 6865 7229 3a20 2320  self, other): # 
+0003bc00: 696e 6571 7561 6c69 7479 2063 6f6d 7061  inequality compa
+0003bc10: 7269 736f 6e0d 0a20 2020 2020 2020 2069  rison..        i
+0003bc20: 6620 2873 656c 662e 6f72 6465 7220 3e20  f (self.order > 
+0003bc30: 6f74 6865 722e 6f72 6465 7229 3a0d 0a20  other.order):.. 
+0003bc40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0003bc50: 6e20 5472 7565 0d0a 2020 2020 2020 2020  n True..        
+0003bc60: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0003bc70: 2020 2072 6574 7572 6e20 4661 6c73 650d     return False.
+0003bc80: 0a0d 0a20 2020 2064 6566 205f 5f73 7472  ...    def __str
+0003bc90: 5f5f 2873 656c 6629 3a0d 0a20 2020 2020  __(self):..     
+0003bca0: 2020 2072 6574 7572 6e20 7365 6c66 2e6e     return self.n
+0003bcb0: 616d 650d 0a0d 0a20 2020 2023 636f 7079  ame....    #copy
+0003bcc0: 2066 756e 0d0a 2020 2020 6465 6620 636f   fun..    def co
+0003bcd0: 7079 2873 656c 6629 3a0d 0a20 2020 2020  py(self):..     
+0003bce0: 2020 2072 6574 7572 6e20 636f 7079 2e64     return copy.d
+0003bcf0: 6565 7063 6f70 7928 7365 6c66 290d 0a0d  eepcopy(self)...
+0003bd00: 0a20 2020 2064 6566 2073 6574 5f53 7562  .    def set_Sub
+0003bd10: 5069 6c65 2873 656c 662c 2053 7562 5069  Pile(self, SubPi
+0003bd20: 6c65 293a 0d0a 0d0a 2020 2020 2020 2020  le):....        
+0003bd30: 2222 220d 0a20 2020 2020 2020 2043 6861  """..        Cha
+0003bd40: 6e67 6520 6f72 2064 6566 696e 6520 6120  nge or define a 
+0003bd50: 7375 6270 696c 6520 666f 7220 6669 6c6c  subpile for fill
+0003bd60: 696e 670d 0a0d 0a20 2020 2020 2020 2050  ing....        P
+0003bd70: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0003bd80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0003bd90: 2020 2020 2020 2053 7562 5069 6c65 203a         SubPile :
+0003bda0: 203a 636c 6173 733a 6050 696c 6560 206f   :class:`Pile` o
+0003bdb0: 626a 6563 7409 0d0a 2020 2020 2020 2020  bject...        
+0003bdc0: 2222 220d 0a0d 0a20 2020 2020 2020 2069  """....        i
+0003bdd0: 6620 6973 696e 7374 616e 6365 2853 7562  f isinstance(Sub
+0003bde0: 5069 6c65 2c20 5069 6c65 293a 0d0a 2020  Pile, Pile):..  
+0003bdf0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0003be00: 662e 665f 6d65 7468 6f64 203d 3d20 2253  f.f_method == "S
+0003be10: 7562 5069 6c65 223a 0d0a 2020 2020 2020  ubPile":..      
+0003be20: 2020 2020 2020 2020 2020 7365 6c66 2e53            self.S
+0003be30: 7562 5069 6c65 3d53 7562 5069 6c65 0d0a  ubPile=SubPile..
+0003be40: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003be50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003be60: 2020 2069 6620 7365 6c66 2e76 6572 626f     if self.verbo
+0003be70: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003be80: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+0003be90: 5265 616c 6c79 203f 2046 696c 6c69 6e67  Really ? Filling
+0003bea0: 206d 6574 686f 6420 6973 206e 6f74 2053   method is not S
+0003beb0: 7562 5069 6c65 2229 0d0a 2020 2020 2020  ubPile")..      
+0003bec0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0003bed0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0003bee0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+0003bef0: 2020 2020 2020 2070 7269 6e74 2822 5468         print("Th
+0003bf00: 6520 5375 6250 696c 6520 6f62 6a65 6374  e SubPile object
+0003bf10: 2069 7320 6e6f 7420 616e 2041 7263 685f   is not an Arch_
+0003bf20: 7461 626c 6520 6f62 6a65 6374 2229 0d0a  table object")..
+0003bf30: 0d0a 2020 2020 6465 6620 7365 745f 665f  ..    def set_f_
+0003bf40: 5449 2873 656c 662c 2054 4929 3a0d 0a0d  TI(self, TI):...
+0003bf50: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0003bf60: 2020 2020 2020 4368 616e 6765 2074 7261        Change tra
+0003bf70: 696e 696e 6720 696d 6167 6520 666f 7220  ining image for 
+0003bf80: 6120 7374 7261 7469 2075 6e69 740d 0a0d  a strati unit...
+0003bf90: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0003bfa0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0003bfb0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0003bfc0: 2054 493a 2067 656f 6e65 2e69 6d61 6765   TI: geone.image
+0003bfd0: 0d0a 2020 2020 2020 2020 2020 2020 5472  ..            Tr
+0003bfe0: 6169 6e69 6e67 2069 6d61 6765 2074 6f20  aining image to 
+0003bff0: 7573 6520 7769 7468 2074 6865 204d 5053  use with the MPS
+0003c000: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+0003c010: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+0003c020: 7374 616e 6365 2854 492c 2067 656f 6e65  stance(TI, geone
+0003c030: 2e69 6d67 2e49 6d67 293a 0d0a 2020 2020  .img.Img):..    
+0003c040: 2020 2020 2020 2020 7365 6c66 2e66 5f54          self.f_T
+0003c050: 493d 5449 0d0a 2020 2020 2020 2020 2020  I=TI..          
+0003c060: 2020 6966 2073 656c 662e 7665 7262 6f73    if self.verbos
+0003c070: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0003c080: 2020 2020 7072 696e 7428 2255 6e69 7420      print("Unit 
+0003c090: 7b7d 3a20 5449 2061 6464 6564 222e 666f  {}: TI added".fo
+0003c0a0: 726d 6174 2873 656c 662e 6e61 6d65 2929  rmat(self.name))
+0003c0b0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0003c0c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003c0d0: 7365 6c66 2e76 6572 626f 7365 3a0d 0a20  self.verbose:.. 
+0003c0e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003c0f0: 7269 6e74 2822 5449 204e 4f54 2041 2047  rint("TI NOT A G
+0003c100: 454f 4e45 2049 4d41 4745 2229 0d0a 0d0a  EONE IMAGE")....
+0003c110: 2020 2020 6465 6620 7365 745f 5375 7266      def set_Surf
+0003c120: 6163 6528 7365 6c66 2c20 7375 7266 6163  ace(self, surfac
+0003c130: 6529 3a0d 0a0d 0a20 2020 2020 2020 2022  e):....        "
+0003c140: 2222 0d0a 2020 2020 2020 2020 4368 616e  ""..        Chan
+0003c150: 6765 206f 7220 6164 6420 6120 746f 7020  ge or add a top 
+0003c160: 7375 7266 6163 6520 666f 7220 556e 6974  surface for Unit
+0003c170: 206f 626a 6563 742e 0d0a 2020 2020 2020   object...      
+0003c180: 2020 5468 6973 2077 696c 6c20 6465 6669    This will defi
+0003c190: 6e65 2068 6f77 2074 6865 2074 6f70 206f  ne how the top o
+0003c1a0: 6620 7468 6520 666f 726d 6174 696f 6e20  f the formation 
+0003c1b0: 7769 6c6c 2062 6520 6d6f 6465 6c6c 6564  will be modelled
+0003c1c0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0003c1d0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0003c1e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0003c1f0: 2020 2020 2073 7572 6661 6365 3a20 3a63       surface: :c
+0003c200: 6c61 7373 3a60 5375 7266 6163 6560 206f  lass:`Surface` o
+0003c210: 626a 6563 740d 0a20 2020 2020 2020 2020  bject..         
+0003c220: 2020 2053 7572 6661 6365 206f 626a 6563     Surface objec
+0003c230: 7420 746f 2075 7365 2066 6f72 2074 6865  t to use for the
+0003c240: 2073 696d 756c 6174 696f 6e20 6f66 2074   simulation of t
+0003c250: 6865 2074 6f70 206f 6620 7468 6520 666f  he top of the fo
+0003c260: 726d 6174 696f 6e0d 0a20 2020 2020 2020  rmation..       
+0003c270: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+0003c280: 6966 2069 7369 6e73 7461 6e63 6528 7375  if isinstance(su
+0003c290: 7266 6163 652c 2053 7572 6661 6365 293a  rface, Surface):
+0003c2a0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0003c2b0: 6c66 2e73 7572 6661 6365 3d73 7572 6661  lf.surface=surfa
+0003c2c0: 6365 0d0a 2020 2020 2020 2020 2020 2020  ce..            
+0003c2d0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0003c2e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c2f0: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
+0003c300: 3a20 5375 7266 6163 6520 6164 6465 6420  : Surface added 
+0003c310: 666f 7220 696e 7465 7270 6f6c 6174 696f  for interpolatio
+0003c320: 6e22 2e66 6f72 6d61 7428 7365 6c66 2e6e  n".format(self.n
+0003c330: 616d 6529 290d 0a20 2020 2020 2020 2065  ame))..        e
+0003c340: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003c350: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0003c360: 6f72 2822 5375 7266 6163 6520 6f62 6a65  or("Surface obje
+0003c370: 6374 206d 7573 7420 6265 2061 6e20 6f62  ct must be an ob
+0003c380: 6a65 6374 206f 6620 7468 6520 636c 6173  ject of the clas
+0003c390: 7320 5375 7266 6163 6520 6672 6f6d 2041  s Surface from A
+0003c3a0: 7263 6850 7922 290d 0a0d 0a20 2020 2064  rchPy")....    d
+0003c3b0: 6566 2073 6574 5f66 5f63 6f76 6d6f 6465  ef set_f_covmode
+0003c3c0: 6c73 2873 656c 662c 2066 5f63 6f76 6d6f  ls(self, f_covmo
+0003c3d0: 6465 6c29 3a0d 0a0d 0a20 2020 2020 2020  del):....       
+0003c3e0: 2022 2222 0d0a 2020 2020 2020 2020 5265   """..        Re
+0003c3f0: 6d6f 7665 2065 7869 7374 696e 6720 6661  move existing fa
+0003c400: 6369 6573 2063 6f76 6d6f 6465 6c73 2061  cies covmodels a
+0003c410: 6e64 206f 6e65 206f 7220 6d6f 7265 0d0a  nd one or more..
+0003c420: 2020 2020 2020 2020 6465 7065 6e64 696e          dependin
+0003c430: 6720 6f66 2077 6861 7420 6973 2070 6173  g of what is pas
+0003c440: 7365 6420 2861 7272 6179 206c 696b 6520  sed (array like 
+0003c450: 6f72 206f 6e6c 7920 6f6e 6520 6f62 6a65  or only one obje
+0003c460: 6374 290d 0a0d 0a20 2020 2020 2020 2050  ct)....        P
+0003c470: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0003c480: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d     ----------...
+0003c490: 0a20 2020 2020 2020 2066 5f63 6f76 6d6f  .        f_covmo
+0003c4a0: 6465 6c3a 2067 656f 6e65 2e63 6f76 4d6f  del: geone.covMo
+0003c4b0: 6465 6c20 6f62 6a65 6374 200d 0a20 2020  del object ..   
+0003c4c0: 2020 2020 2020 2020 2074 6861 7420 7769           that wi
+0003c4d0: 6c6c 2062 6520 7573 6564 2066 6f72 2074  ll be used for t
+0003c4e0: 6865 2069 6e74 6572 706f 6c61 7469 6f6e  he interpolation
+0003c4f0: 206f 6620 7468 6520 6661 6369 6573 2069   of the facies i
+0003c500: 6620 6d65 7468 6f64 2069 7320 5349 532e  f method is SIS.
+0003c510: 0d0a 2020 2020 2020 2020 2020 2020 4361  ..            Ca
+0003c520: 6e20 6265 2061 206c 6973 7420 6f72 206f  n be a list or o
+0003c530: 6e6c 7920 6f6e 6520 6f62 6a65 6374 2e0d  nly one object..
+0003c540: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
+0003c550: 2020 2020 2020 2020 7365 6c66 2e6c 6973          self.lis
+0003c560: 745f 665f 636f 766d 6f64 656c 3d5b 5d0d  t_f_covmodel=[].
+0003c570: 0a20 2020 2020 2020 2063 6f76 6d6f 6465  .        covmode
+0003c580: 6c73 5f63 6c61 7373 3d28 6765 6f6e 652e  ls_class=(geone.
+0003c590: 636f 764d 6f64 656c 2e43 6f76 4d6f 6465  covModel.CovMode
+0003c5a0: 6c33 4429 0d0a 2020 2020 2020 2020 7472  l3D)..        tr
+0003c5b0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+0003c5c0: 666f 7220 636f 766d 6f64 656c 2069 6e20  for covmodel in 
+0003c5d0: 665f 636f 766d 6f64 656c 3a0d 0a20 2020  f_covmodel:..   
+0003c5e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003c5f0: 6973 696e 7374 616e 6365 2863 6f76 6d6f  isinstance(covmo
+0003c600: 6465 6c2c 2063 6f76 6d6f 6465 6c73 5f63  del, covmodels_c
+0003c610: 6c61 7373 293a 0d0a 2020 2020 2020 2020  lass):..        
+0003c620: 2020 2020 2020 2020 2020 2020 663d 310d              f=1.
+0003c630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c640: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0003c650: 2020 2020 2020 2020 2020 2020 663d 300d              f=0.
+0003c660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c670: 2020 2020 2062 7265 616b 0d0a 2020 2020       break..    
+0003c680: 2020 2020 2020 2020 6966 2066 3a0d 0a20          if f:.. 
+0003c690: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003c6a0: 656c 662e 6c69 7374 5f66 5f63 6f76 6d6f  elf.list_f_covmo
+0003c6b0: 6465 6c3d 665f 636f 766d 6f64 656c 0d0a  del=f_covmodel..
+0003c6c0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003c6d0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
 0003c6e0: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
 0003c6f0: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
 0003c700: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003c710: 2822 556e 6974 207b 7d3a 2063 6f76 6d6f  ("Unit {}: covmo
-0003c720: 6465 6c20 666f 7220 5349 5320 6164 6465  del for SIS adde
-0003c730: 6422 2e66 6f72 6d61 7428 7365 6c66 2e6e  d".format(self.n
-0003c740: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-0003c750: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0003c760: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-0003c770: 662e 7665 7262 6f73 653a 0d0a 2020 2020  f.verbose:..    
-0003c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c790: 7072 696e 7428 2255 6e69 7420 7b7d 3a20  print("Unit {}: 
-0003c7a0: 636f 766d 6f64 656c 206e 6f74 2061 2067  covmodel not a g
-0003c7b0: 656f 6e65 2033 4420 636f 766d 6f64 656c  eone 3D covmodel
-0003c7c0: 222e 666f 726d 6174 2873 656c 662e 6e61  ".format(self.na
-0003c7d0: 6d65 2929 0d0a 0d0a 2020 2020 6465 6620  me))....    def 
-0003c7e0: 6765 745f 685f 6c65 7665 6c28 7365 6c66  get_h_level(self
-0003c7f0: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
-0003c800: 220d 0a20 2020 2020 2020 2052 6574 7572  "..        Retur
-0003c810: 6e20 6869 6572 6172 6368 6963 616c 206c  n hierarchical l
-0003c820: 6576 656c 206f 6620 7468 6520 756e 6974  evel of the unit
-0003c830: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-0003c840: 0a20 2020 2020 2020 2064 6566 2066 756e  .        def fun
-0003c850: 6328 756e 6974 2c20 685f 6c65 7629 3a0d  c(unit, h_lev):.
-0003c860: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003c870: 756e 6974 2e6d 756d 6d79 5f75 6e69 7420  unit.mummy_unit 
-0003c880: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0003c890: 2020 2020 2020 2020 2020 2020 2020 685f                h_
-0003c8a0: 6c65 7620 2b3d 2031 0d0a 2020 2020 2020  lev += 1..      
-0003c8b0: 2020 2020 2020 2020 2020 685f 6c65 763d            h_lev=
-0003c8c0: 6675 6e63 2875 6e69 742e 6d75 6d6d 795f  func(unit.mummy_
-0003c8d0: 756e 6974 2c20 685f 6c65 7629 0d0a 0d0a  unit, h_lev)....
-0003c8e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003c8f0: 726e 2068 5f6c 6576 0d0a 2020 2020 2020  rn h_lev..      
-0003c900: 2020 685f 6c65 763d 310d 0a20 2020 2020    h_lev=1..     
-0003c910: 2020 2068 5f6c 6576 3d66 756e 6328 7365     h_lev=func(se
-0003c920: 6c66 2c20 685f 6c65 7629 0d0a 2020 2020  lf, h_lev)..    
-0003c930: 2020 2020 7265 7475 726e 2068 5f6c 6576      return h_lev
-0003c940: 0d0a 0d0a 2020 2020 6465 6620 676f 6573  ....    def goes
-0003c950: 5f75 705f 756e 7469 6c28 7365 6c66 2c20  _up_until(self, 
-0003c960: 756e 6974 5f74 6172 6765 7429 3a0d 0a20  unit_target):.. 
-0003c970: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003c980: 2022 2222 0d0a 2020 2020 2020 2020 436c   """..        Cl
-0003c990: 696d 6220 7468 6520 6869 6572 6172 6368  imb the hierarch
-0003c9a0: 6963 616c 2074 7265 6520 6f66 2073 656c  ical tree of sel
-0003c9b0: 6620 756e 6974 2075 6e74 696c 2066 696e  f unit until fin
-0003c9c0: 6469 6e67 2061 2073 7065 6369 6669 6320  ding a specific 
-0003c9d0: 756e 6974 2061 6e64 2072 6574 7572 6e20  unit and return 
-0003c9e0: 6974 0d0a 0d0a 2020 2020 2020 2020 5061  it....        Pa
-0003c9f0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0003ca00: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0003ca10: 2020 2020 2020 756e 6974 5f74 6172 6765        unit_targe
-0003ca20: 743a 203a 636c 6173 733a 6055 6e69 7460  t: :class:`Unit`
-0003ca30: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-0003ca40: 2020 2020 2055 6e69 7420 6f62 6a65 6374       Unit object
-0003ca50: 2074 6f20 6669 6e64 2069 6e20 7468 6520   to find in the 
-0003ca60: 6869 6572 6172 6368 6963 616c 2074 7265  hierarchical tre
-0003ca70: 650d 0a0d 0a20 2020 2020 2020 2052 6574  e....        Ret
-0003ca80: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-0003ca90: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2075  -----..        u
-0003caa0: 6e69 743a 203a 636c 6173 733a 6055 6e69  nit: :class:`Uni
-0003cab0: 7460 206f 626a 6563 7420 6f72 204e 6f6e  t` object or Non
-0003cac0: 650d 0a20 2020 2020 2020 2020 2020 2055  e..            U
-0003cad0: 6e69 7420 6f62 6a65 6374 2066 6f75 6e64  nit object found
-0003cae0: 2069 6e20 7468 6520 6869 6572 6172 6368   in the hierarch
-0003caf0: 6963 616c 2074 7265 650d 0a20 2020 2020  ical tree..     
-0003cb00: 2020 2020 2020 2069 6620 6e6f 7420 666f         if not fo
-0003cb10: 756e 642c 2072 6574 7572 6e20 4e6f 6e65  und, return None
-0003cb20: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-0003cb30: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003cb40: 2075 6e69 7420 3d20 7365 6c66 0d0a 2020   unit = self..  
-0003cb50: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0003cb60: 616e 6765 2873 656c 662e 6765 745f 685f  ange(self.get_h_
-0003cb70: 6c65 7665 6c28 2929 3a0d 0a20 2020 2020  level()):..     
-0003cb80: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-0003cb90: 2020 2020 2069 6620 756e 6974 2021 3d20       if unit != 
-0003cba0: 756e 6974 5f74 6172 6765 743a 0d0a 2020  unit_target:..  
-0003cbb0: 2020 2020 2020 2020 2020 2020 2020 756e                un
-0003cbc0: 6974 203d 2075 6e69 742e 6d75 6d6d 795f  it = unit.mummy_
-0003cbd0: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
-0003cbe0: 2020 2020 2020 6966 2075 6e69 7420 6973        if unit is
-0003cbf0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0003cc00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003cc10: 726e 204e 6f6e 650d 0a20 2020 2020 2020  rn None..       
-0003cc20: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003cc30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0003cc40: 726e 2075 6e69 740d 0a20 2020 2020 2020  rn unit..       
-0003cc50: 2020 2020 200d 0a20 2020 2020 2020 2072       ..        r
-0003cc60: 6574 7572 6e20 756e 6974 0d0a 0d0a 2020  eturn unit....  
-0003cc70: 2020 6465 6620 6765 745f 6269 675f 6d75    def get_big_mu
-0003cc80: 6d6d 795f 756e 6974 2873 656c 6629 3a0d  mmy_unit(self):.
-0003cc90: 0a0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0003cca0: 2020 2020 2020 2020 5265 7475 726e 206c          Return l
-0003ccb0: 6f77 6573 7420 756e 6974 2028 6d61 696e  owest unit (main
-0003ccc0: 2075 6e69 7429 2069 6e20 6869 6572 6172   unit) in hierar
-0003ccd0: 6368 6963 616c 206f 7264 6572 0d0a 2020  chical order..  
-0003cce0: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-0003ccf0: 2020 2020 2075 6e69 7420 3d20 7365 6c66       unit = self
-0003cd00: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-0003cd10: 696e 2072 616e 6765 2873 656c 662e 6765  in range(self.ge
-0003cd20: 745f 685f 6c65 7665 6c28 2929 3a0d 0a0d  t_h_level()):...
-0003cd30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003cd40: 756e 6974 2e6d 756d 6d79 5f75 6e69 7420  unit.mummy_unit 
-0003cd50: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-0003cd60: 2020 2020 2020 2020 2020 2020 2020 756e                un
-0003cd70: 6974 203d 2075 6e69 742e 6d75 6d6d 795f  it = unit.mummy_
-0003cd80: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
-0003cd90: 2020 0d0a 2020 2020 2020 2020 7265 7475    ..        retu
-0003cda0: 726e 2075 6e69 740d 0a0d 0a20 2020 2064  rn unit....    d
-0003cdb0: 6566 2067 6574 5f62 6162 795f 756e 6974  ef get_baby_unit
-0003cdc0: 7328 7365 6c66 2c20 7265 636f 6d70 7574  s(self, recomput
-0003cdd0: 653d 4661 6c73 652c 2076 623d 3129 3a0d  e=False, vb=1):.
-0003cde0: 0a0d 0a0d 0a20 2020 2020 2020 2022 2222  .....        """
-0003cdf0: 0d0a 2020 2020 2020 2020 4d65 7468 6f64  ..        Method
-0003ce00: 2074 6f20 7265 7475 726e 2061 6c6c 2075   to return all u
-0003ce10: 6e69 7473 2074 6861 7420 6172 6520 756e  nits that are un
-0003ce20: 6465 7220 7468 6520 6375 7272 656e 7420  der the current 
-0003ce30: 756e 6974 2069 6e20 7468 6520 6869 6572  unit in the hier
-0003ce40: 6172 6368 790d 0a0d 0a20 2020 2020 2020  archy....       
-0003ce50: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-0003ce60: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
-0003ce70: 0a20 2020 2020 2020 2072 6563 6f6d 7075  .        recompu
-0003ce80: 7465 3a20 626f 6f6c 0d0a 2020 2020 2020  te: bool..      
-0003ce90: 2020 2020 2020 4966 2054 7275 652c 2072        If True, r
-0003cea0: 6563 6f6d 7075 7465 2074 6865 206c 6973  ecompute the lis
-0003ceb0: 7420 6f66 2075 6e69 7473 2069 6620 7468  t of units if th
-0003cec0: 6572 6520 6861 6420 6265 656e 206d 6f64  ere had been mod
-0003ced0: 6966 6963 6174 696f 6e73 2069 6e20 7468  ifications in th
-0003cee0: 6520 6869 6572 6172 6368 790d 0a20 2020  e hierarchy..   
-0003cef0: 2020 2020 2076 623a 2069 6e74 0d0a 2020       vb: int..  
-0003cf00: 2020 2020 2020 2020 2020 7665 7262 6f73            verbos
-0003cf10: 6974 7920 6c65 7665 6c2c 2030 2066 6f72  ity level, 0 for
-0003cf20: 206e 6f20 7072 696e 742c 2031 2066 6f72   no print, 1 for
-0003cf30: 2070 7269 6e74 0d0a 0d0a 2020 2020 2020   print....      
-0003cf40: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-0003cf50: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-0003cf60: 2020 2020 6c69 7374 0d0a 2020 2020 2020      list..      
-0003cf70: 2020 6c69 7374 206f 6620 6368 696c 6473    list of childs
-0003cf80: 203a 636c 6173 733a 6055 6e69 7460 206f   :class:`Unit` o
-0003cf90: 626a 6563 7473 206f 6620 7468 6520 6375  bjects of the cu
-0003cfa0: 7272 656e 7420 756e 6974 0d0a 2020 2020  rrent unit..    
-0003cfb0: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
-0003cfc0: 2020 200d 0a20 2020 2020 2020 2069 6620     ..        if 
-0003cfd0: 7365 6c66 2e53 7562 5069 6c65 2069 7320  self.SubPile is 
-0003cfe0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-0003cff0: 2020 2069 6620 7662 3a0d 0a20 2020 2020     if vb:..     
-0003d000: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0003d010: 2822 556e 6974 2068 6173 206e 6f20 6869  ("Unit has no hi
-0003d020: 6572 6172 6368 7922 290d 0a20 2020 2020  erarchy")..     
-0003d030: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
-0003d040: 0d0a 0d0a 2020 2020 2020 2020 6966 2072  ....        if r
-0003d050: 6563 6f6d 7075 7465 3a0d 0a20 2020 2020  ecompute:..     
-0003d060: 2020 2020 2020 2073 656c 662e 6262 5f75         self.bb_u
-0003d070: 6e69 7473 203d 205b 5d0d 0a0d 0a20 2020  nits = []....   
-0003d080: 2020 2020 2020 2020 2064 6566 2066 756e           def fun
-0003d090: 2875 6e69 7429 3a0d 0a0d 0a20 2020 2020  (unit):....     
-0003d0a0: 2020 2020 2020 2020 2020 2069 6620 756e             if un
-0003d0b0: 6974 2e53 7562 5069 6c65 2069 7320 6e6f  it.SubPile is no
-0003d0c0: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-0003d0d0: 2020 2020 2020 2020 2020 2020 206c 3d75               l=u
-0003d0e0: 6e69 742e 5375 6250 696c 652e 6c69 7374  nit.SubPile.list
-0003d0f0: 5f75 6e69 7473 0d0a 2020 2020 2020 2020  _units..        
-0003d100: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003d110: 2e62 625f 756e 6974 7320 2b3d 206c 0d0a  .bb_units += l..
-0003d120: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d130: 2020 2020 2020 666f 7220 756e 6974 2069        for unit i
-0003d140: 6e20 6c3a 0d0a 2020 2020 2020 2020 2020  n l:..          
-0003d150: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-0003d160: 6e28 756e 6974 290d 0a0d 0a20 2020 2020  n(unit)....     
-0003d170: 2020 2020 2020 2066 756e 2873 656c 6629         fun(self)
-0003d180: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0003d190: 2073 656c 662e 6262 5f75 6e69 7473 0d0a   self.bb_units..
-0003d1a0: 0d0a 2020 2020 6465 6620 6164 645f 6661  ..    def add_fa
-0003d1b0: 6369 6573 2873 656c 662c 2066 6163 6965  cies(self, facie
-0003d1c0: 7329 3a0d 0a0d 0a20 2020 2020 2020 2022  s):....        "
-0003d1d0: 2222 0d0a 2020 2020 2020 2020 4164 6420  ""..        Add 
-0003d1e0: 6661 6369 6573 206f 626a 6563 7420 746f  facies object to
-0003d1f0: 2073 7472 6174 690d 0a0d 0a20 2020 2020   strati....     
-0003d200: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0003d210: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003d220: 2d0d 0a20 2020 2020 2020 2066 6163 6965  -..        facie
-0003d230: 733a 203a 636c 6173 733a 6046 6163 6965  s: :class:`Facie
-0003d240: 7360 206f 626a 6563 7420 6f72 206c 6973  s` object or lis
-0003d250: 7420 6f66 2074 6865 6d0d 0a20 2020 2020  t of them..     
-0003d260: 2020 2020 2020 2046 6163 6965 7320 6f62         Facies ob
-0003d270: 6a65 6374 2074 6f20 6d6f 6465 6c20 696e  ject to model in
-0003d280: 7369 6465 2074 6865 2075 6e69 740d 0a20  side the unit.. 
-0003d290: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-0003d2a0: 2020 2020 2020 6966 2074 7970 6528 6661        if type(fa
-0003d2b0: 6369 6573 2920 3d3d 206c 6973 743a 0d0a  cies) == list:..
-0003d2c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003d2d0: 6920 696e 2066 6163 6965 733a 0d0a 2020  i in facies:..  
-0003d2e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003d2f0: 2028 6973 696e 7374 616e 6365 2869 2c20   (isinstance(i, 
-0003d300: 4661 6369 6573 2929 2061 6e64 2028 6920  Facies)) and (i 
-0003d310: 6e6f 7420 696e 2073 656c 662e 6c69 7374  not in self.list
-0003d320: 5f66 6163 6965 7329 3a20 2320 6368 6563  _facies): # chec
-0003d330: 6b20 4661 6369 6573 206f 626a 6563 7420  k Facies object 
-0003d340: 6265 6c6f 6e67 2074 6f20 4661 6369 6573  belong to Facies
-0003d350: 2063 6c61 7373 0d0a 2020 2020 2020 2020   class..        
-0003d360: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003d370: 2e6c 6973 745f 6661 6369 6573 2e61 7070  .list_facies.app
-0003d380: 656e 6428 6929 0d0a 2020 2020 2020 2020  end(i)..        
-0003d390: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0003d3a0: 656c 662e 7665 7262 6f73 653a 0d0a 2020  elf.verbose:..  
-0003d3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3c0: 2020 2020 2020 7072 696e 7428 2246 6163        print("Fac
-0003d3d0: 6965 7320 7b7d 2061 6464 6564 2074 6f20  ies {} added to 
-0003d3e0: 756e 6974 207b 7d22 2e66 6f72 6d61 7428  unit {}".format(
-0003d3f0: 692e 6e61 6d65 2c20 7365 6c66 2e6e 616d  i.name, self.nam
-0003d400: 6529 290d 0a20 2020 2020 2020 2020 2020  e))..           
-0003d410: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003d420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d430: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0003d440: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003d450: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0003d460: 226f 626a 6563 7420 6973 6e27 7420 6120  "object isn't a 
-0003d470: 4661 6369 6573 206f 626a 6563 7420 6f72  Facies object or
-0003d480: 2046 6163 6965 7320 6f62 6a65 6374 2068   Facies object h
-0003d490: 6173 2061 6c72 6561 6479 2062 6565 6e20  as already been 
-0003d4a0: 6164 6465 6422 290d 0a20 2020 2020 2020  added")..       
-0003d4b0: 2065 6c73 653a 2023 2066 6163 6965 7320   else: # facies 
-0003d4c0: 6e6f 7420 696e 2061 206c 6973 740d 0a20  not in a list.. 
-0003d4d0: 2020 2020 2020 2020 2020 2069 6620 2869             if (i
-0003d4e0: 7369 6e73 7461 6e63 6528 6661 6369 6573  sinstance(facies
-0003d4f0: 2c20 4661 6369 6573 2929 2020 616e 6420  , Facies))  and 
-0003d500: 2866 6163 6965 7320 6e6f 7420 696e 2073  (facies not in s
-0003d510: 656c 662e 6c69 7374 5f66 6163 6965 7329  elf.list_facies)
-0003d520: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003d530: 2020 2073 656c 662e 6c69 7374 5f66 6163     self.list_fac
-0003d540: 6965 732e 6170 7065 6e64 2866 6163 6965  ies.append(facie
-0003d550: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-0003d560: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
-0003d570: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
-0003d580: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0003d590: 2246 6163 6965 7320 7b7d 2061 6464 6564  "Facies {} added
-0003d5a0: 2074 6f20 756e 6974 207b 7d22 2e66 6f72   to unit {}".for
-0003d5b0: 6d61 7428 6661 6369 6573 2e6e 616d 652c  mat(facies.name,
-0003d5c0: 2073 656c 662e 6e61 6d65 2929 0d0a 2020   self.name))..  
-0003d5d0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0003d5e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d5f0: 2069 6620 7365 6c66 2e76 6572 626f 7365   if self.verbose
-0003d600: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003d610: 2020 2020 2020 2070 7269 6e74 2822 6f62         print("ob
-0003d620: 6a65 6374 2069 736e 2774 2061 2046 6163  ject isn't a Fac
-0003d630: 6965 7320 6f62 6a65 6374 206f 7220 4661  ies object or Fa
-0003d640: 6369 6573 206f 626a 6563 7420 6861 7320  cies object has 
-0003d650: 616c 7265 6164 7920 6265 656e 2061 6464  already been add
-0003d660: 6564 2229 0d0a 0d0a 2020 2020 2020 2020  ed")....        
-0003d670: 7265 7475 726e 0d0a 0d0a 2020 2020 6465  return....    de
-0003d680: 6620 7265 6d5f 6661 6369 6573 2873 656c  f rem_facies(sel
-0003d690: 662c 2066 6163 6965 733d 4e6f 6e65 2c20  f, facies=None, 
-0003d6a0: 616c 6c5f 6661 6369 6573 3d54 7275 6529  all_facies=True)
-0003d6b0: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-0003d6c0: 0d0a 2020 2020 2020 2020 546f 2072 656d  ..        To rem
-0003d6d0: 6f76 6520 6661 6369 6573 2066 726f 6d20  ove facies from 
-0003d6e0: 756e 6974 2c20 6279 2064 6566 6175 6c74  unit, by default
-0003d6f0: 2061 6c6c 2066 6163 6965 7320 6172 6520   all facies are 
-0003d700: 7265 6d6f 7665 640d 0a0d 0a20 2020 2020  removed....     
-0003d710: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0003d720: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0003d730: 2d0d 0a20 2020 2020 2020 2066 6163 6965  -..        facie
-0003d740: 733a 203a 636c 6173 733a 6046 6163 6965  s: :class:`Facie
-0003d750: 7360 206f 626a 6563 7420 6f72 206c 6973  s` object or lis
-0003d760: 7420 6f66 2074 6865 6d0d 0a20 2020 2020  t of them..     
-0003d770: 2020 2020 2020 2046 6163 6965 7320 6f62         Facies ob
-0003d780: 6a65 6374 2074 6f20 7265 6d6f 7665 2066  ject to remove f
-0003d790: 726f 6d20 7468 6520 756e 6974 0d0a 2020  rom the unit..  
-0003d7a0: 2020 2020 2020 616c 6c5f 6661 6369 6573        all_facies
-0003d7b0: 3a20 626f 6f6c 0d0a 2020 2020 2020 2020  : bool..        
-0003d7c0: 2020 2020 4966 2054 7275 652c 2061 6c6c      If True, all
-0003d7d0: 2066 6163 6965 7320 6172 6520 7265 6d6f   facies are remo
-0003d7e0: 7665 640d 0a20 2020 2020 2020 2022 2222  ved..        """
-0003d7f0: 0d0a 2020 2020 0d0a 2020 2020 2020 2020  ..    ..        
-0003d800: 6966 2061 6c6c 5f66 6163 6965 733a 0d0a  if all_facies:..
-0003d810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003d820: 2e6c 6973 745f 6661 6369 6573 3d5b 5d0d  .list_facies=[].
-0003d830: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0003d840: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003d850: 2e6c 6973 745f 6661 6369 6573 2e72 656d  .list_facies.rem
-0003d860: 6f76 6528 6661 6369 6573 290d 0a0d 0a20  ove(facies).... 
-0003d870: 2020 2064 6566 2063 6f6d 7075 7465 5f66     def compute_f
-0003d880: 6163 6965 7328 7365 6c66 2c20 4172 6368  acies(self, Arch
-0003d890: 5461 626c 652c 206e 7265 616c 3d31 2c20  Table, nreal=1, 
-0003d8a0: 6d6f 6465 3d22 6661 6369 6573 222c 2076  mode="facies", v
-0003d8b0: 6572 626f 7365 3d30 293a 0d0a 0d0a 2020  erbose=0):....  
-0003d8c0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0003d8d0: 2020 2043 6f6d 7075 7465 2066 6163 6965     Compute facie
-0003d8e0: 7320 646f 6d61 696e 2066 6f72 2074 6865  s domain for the
-0003d8f0: 2073 7065 6369 6669 6320 756e 6974 0d0a   specific unit..
-0003d900: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0003d910: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0003d920: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0003d930: 2020 4172 6368 5461 626c 653a 203a 636c    ArchTable: :cl
-0003d940: 6173 733a 6041 7263 685f 7461 626c 6560  ass:`Arch_table`
-0003d950: 206f 626a 6563 740d 0a20 2020 2020 2020   object..       
-0003d960: 2020 2020 2041 7263 6854 6162 6c65 2063       ArchTable c
-0003d970: 6f6e 7461 696e 696e 6720 756e 6974 732c  ontaining units,
-0003d980: 2073 7572 6661 6365 2c0d 0a20 2020 2020   surface,..     
-0003d990: 2020 2020 2020 2066 6163 6965 7320 616e         facies an
-0003d9a0: 6420 6174 206c 6561 7374 2061 2050 696c  d at least a Pil
-0003d9b0: 6520 2873 6565 2065 7861 6d70 6c65 206f  e (see example o
-0003d9c0: 6e20 7468 6520 6769 7468 7562 290d 0a20  n the github).. 
-0003d9d0: 2020 2020 2020 206e 7265 616c 2020 203a         nreal   :
-0003d9e0: 2069 6e74 0d0a 2020 2020 2020 2020 2020   int..          
-0003d9f0: 2020 6e75 6d62 6572 206f 6620 7265 616c    number of real
-0003da00: 697a 6174 696f 6e20 2870 6572 2075 6e69  ization (per uni
-0003da10: 7420 7265 616c 697a 6174 696f 6e73 2920  t realizations) 
-0003da20: 746f 206d 616b 650d 0a20 2020 2020 2020  to make..       
-0003da30: 206d 6f64 653a 2073 7472 0d0a 2020 2020   mode: str..    
-0003da40: 2020 2020 2020 2020 2266 6163 6965 7322          "facies"
-0003da50: 206f 7220 2273 7472 6174 6922 0d0a 2020   or "strati"..  
-0003da60: 2020 2020 2020 7665 7262 6f73 6520 3a20        verbose : 
-0003da70: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
-0003da80: 2076 6572 626f 7369 7479 206c 6576 656c   verbosity level
-0003da90: 2c20 3020 666f 7220 6e6f 2070 7269 6e74  , 0 for no print
-0003daa0: 2c20 3120 666f 7220 7072 696e 740d 0a20  , 1 for print.. 
-0003dab0: 2020 2020 2020 2022 2222 0d0a 200d 0a0d         """.. ...
-0003dac0: 0a20 2020 2020 2020 2078 673d 4172 6368  .        xg=Arch
-0003dad0: 5461 626c 652e 6765 745f 7867 2829 0d0a  Table.get_xg()..
-0003dae0: 2020 2020 2020 2020 7967 3d41 7263 6854          yg=ArchT
-0003daf0: 6162 6c65 2e67 6574 5f79 6728 290d 0a20  able.get_yg().. 
-0003db00: 2020 2020 2020 207a 673d 4172 6368 5461         zg=ArchTa
-0003db10: 626c 652e 6765 745f 7a67 2829 0d0a 0d0a  ble.get_zg()....
-0003db20: 2020 2020 2020 2020 7365 6564 3d41 7263          seed=Arc
-0003db30: 6854 6162 6c65 2e73 6565 640d 0a20 2020  hTable.seed..   
-0003db40: 2020 2020 206e 702e 7261 6e64 6f6d 2e73       np.random.s
-0003db50: 6565 6428 7365 6564 290d 0a0d 0a20 2020  eed(seed)....   
-0003db60: 2020 2020 2023 2320 6772 6964 2070 6172       ## grid par
-0003db70: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0003db80: 206e 783d 6c65 6e28 7867 292d 310d 0a20   nx=len(xg)-1.. 
-0003db90: 2020 2020 2020 206e 793d 6c65 6e28 7967         ny=len(yg
-0003dba0: 292d 310d 0a20 2020 2020 2020 206e 7a3d  )-1..        nz=
-0003dbb0: 6c65 6e28 7a67 292d 310d 0a20 2020 2020  len(zg)-1..     
-0003dbc0: 2020 2064 696d 656e 7369 6f6e 733d 286e     dimensions=(n
-0003dbd0: 782c 206e 792c 206e 7a29 0d0a 2020 2020  x, ny, nz)..    
-0003dbe0: 2020 2020 6f78 3d6e 702e 6d69 6e28 7867      ox=np.min(xg
-0003dbf0: 5b30 5d29 0d0a 2020 2020 2020 2020 6f79  [0])..        oy
-0003dc00: 3d6e 702e 6d69 6e28 7967 5b30 5d29 0d0a  =np.min(yg[0])..
-0003dc10: 2020 2020 2020 2020 6f7a 3d6e 702e 6d69          oz=np.mi
-0003dc20: 6e28 7a67 5b30 5d29 0d0a 2020 2020 2020  n(zg[0])..      
-0003dc30: 2020 6f72 6967 696e 3d28 6f78 2c20 6f79    origin=(ox, oy
-0003dc40: 2c20 6f7a 290d 0a20 2020 2020 2020 2073  , oz)..        s
-0003dc50: 783d 6e70 2e64 6966 6628 7867 295b 305d  x=np.diff(xg)[0]
-0003dc60: 0d0a 2020 2020 2020 2020 7379 3d6e 702e  ..        sy=np.
-0003dc70: 6469 6666 2879 6729 5b30 5d0d 0a20 2020  diff(yg)[0]..   
-0003dc80: 2020 2020 2073 7a3d 6e70 2e64 6966 6628       sz=np.diff(
-0003dc90: 7a67 295b 305d 0d0a 2020 2020 2020 2020  zg)[0]..        
-0003dca0: 7370 6163 696e 673d 2873 782c 2073 792c  spacing=(sx, sy,
-0003dcb0: 2073 7a29 0d0a 0d0a 2020 2020 2020 2020   sz)....        
-0003dcc0: 6e72 6561 6c5f 756e 6974 7320 3d20 4172  nreal_units = Ar
-0003dcd0: 6368 5461 626c 652e 6e72 6561 6c5f 756e  chTable.nreal_un
-0003dce0: 6974 730d 0a0d 0a20 2020 2020 2020 2066  its....        f
-0003dcf0: 6163 6965 735f 646f 6d61 696e 733d 6e70  acies_domains=np
-0003dd00: 2e7a 6572 6f73 285b 6e72 6561 6c5f 756e  .zeros([nreal_un
-0003dd10: 6974 732c 206e 7265 616c 2c20 6e7a 2c20  its, nreal, nz, 
-0003dd20: 6e79 2c20 6e78 5d2c 2064 7479 7065 3d6e  ny, nx], dtype=n
-0003dd30: 702e 696e 7438 290d 0a0d 0a20 2020 2020  p.int8)....     
-0003dd40: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
-0003dd50: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-0003dd60: 2020 2020 206d 6574 686f 643d 7365 6c66       method=self
-0003dd70: 2e66 5f6d 6574 686f 6420 2023 206d 6574  .f_method  # met
-0003dd80: 686f 6420 6f66 2073 696d 756c 6174 696f  hod of simulatio
-0003dd90: 6e0d 0a20 2020 2020 2020 2065 6c69 6620  n..        elif 
-0003dda0: 6d6f 6465 203d 3d20 2275 6e69 7473 223a  mode == "units":
-0003ddb0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003ddc0: 2022 756e 6974 735f 6669 6c6c 5f6d 6574   "units_fill_met
-0003ddd0: 686f 6422 2069 6e20 7365 6c66 2e64 6963  hod" in self.dic
-0003dde0: 5f66 6163 6965 732e 6b65 7973 2829 3a0d  _facies.keys():.
-0003ddf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003de00: 206d 6574 686f 6420 3d20 7365 6c66 2e64   method = self.d
-0003de10: 6963 5f66 6163 6965 735b 2275 6e69 7473  ic_facies["units
-0003de20: 5f66 696c 6c5f 6d65 7468 6f64 225d 0d0a  _fill_method"]..
-0003de30: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003de40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003de50: 2020 206d 6574 686f 6420 3d20 2268 6f6d     method = "hom
-0003de60: 6f67 656e 6f75 7322 0d0a 0d0a 2020 2020  ogenous"....    
-0003de70: 2020 2020 6b77 6172 6773 3d73 656c 662e      kwargs=self.
-0003de80: 6469 635f 6661 6369 6573 2020 2320 7265  dic_facies  # re
-0003de90: 7472 6965 7665 206b 6579 776f 7264 2061  trieve keyword a
-0003dea0: 7267 756d 656e 7473 0d0a 0d0a 2020 2020  rguments....    
-0003deb0: 2020 2020 2364 6566 6175 6c74 206b 7761      #default kwa
-0003dec0: 7267 7320 666f 7220 5349 530d 0a20 2020  rgs for SIS..   
-0003ded0: 2020 2020 206b 7761 7267 735f 6465 665f       kwargs_def_
-0003dee0: 5349 533d 7b22 6e65 6967 223a 2031 302c  SIS={"neig": 10,
-0003def0: 2022 7222 3a20 312c 2022 7072 6f62 6162   "r": 1, "probab
-0003df00: 696c 6974 7922 3a20 4e6f 6e65 2c22 5349  ility": None,"SI
-0003df10: 535f 6f72 6965 6e74 6174 696f 6e22 3a20  S_orientation": 
-0003df20: 4661 6c73 652c 2261 7a69 6d75 7468 223a  False,"azimuth":
-0003df30: 2030 2c22 6469 7022 3a20 302c 2270 6c75   0,"dip": 0,"plu
-0003df40: 6e67 6522 3a20 307d 0d0a 0d0a 2020 2020  nge": 0}....    
-0003df50: 2020 2020 6b77 6172 6773 5f64 6566 5f4d      kwargs_def_M
-0003df60: 5053 3d7b 2276 6172 6e61 6d65 223a 2263  PS={"varname":"c
-0003df70: 6f64 6522 2c20 226e 7622 3a31 2c20 2264  ode", "nv":1, "d
-0003df80: 6174 6149 6d61 6765 223a 4e6f 6e65 2c20  ataImage":None, 
-0003df90: 2264 6973 7461 6e63 6554 7970 6522 3a5b  "distanceType":[
-0003dfa0: 2263 6174 6567 6f72 6963 616c 225d 2c20  "categorical"], 
-0003dfb0: 226f 7574 7075 7456 6172 466c 6167 223a  "outputVarFlag":
-0003dfc0: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2020  None,..         
-0003dfd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dfe0: 2278 7222 3a20 312c 2022 7972 223a 2031  "xr": 1, "yr": 1
-0003dff0: 2c20 227a 7222 3a20 312c 2022 6d61 7873  , "zr": 1, "maxs
-0003e000: 6361 6e22 3a20 302e 3235 2c20 226e 6569  can": 0.25, "nei
-0003e010: 6722 3a20 3234 2c20 2274 6872 6573 6822  g": 24, "thresh"
-0003e020: 3a20 302e 3035 2c20 2278 6c6f 6322 3a20  : 0.05, "xloc": 
-0003e030: 4661 6c73 652c 2022 796c 6f63 223a 2046  False, "yloc": F
-0003e040: 616c 7365 2c20 227a 6c6f 6322 3a20 4661  alse, "zloc": Fa
-0003e050: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0003e060: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003e070: 686f 6d6f 5f75 7361 6765 223a 2031 2c20  homo_usage": 1, 
-0003e080: 2272 6f74 5f75 7361 6765 223a 2031 2c20  "rot_usage": 1, 
-0003e090: 2272 6f74 417a 694c 6f63 223a 2046 616c  "rotAziLoc": Fal
-0003e0a0: 7365 2c20 2272 6f74 417a 6922 3a20 302c  se, "rotAzi": 0,
-0003e0b0: 2022 726f 7444 6970 4c6f 6322 3a20 4661   "rotDipLoc": Fa
-0003e0c0: 6c73 652c 2022 726f 7444 6970 223a 2030  lse, "rotDip": 0
-0003e0d0: 2c20 2272 6f74 506c 756e 6765 4c6f 6322  , "rotPlungeLoc"
-0003e0e0: 3a20 4661 6c73 652c 2022 726f 7450 6c75  : False, "rotPlu
-0003e0f0: 6e67 6522 3a20 302c 0d0a 2020 2020 2020  nge": 0,..      
-0003e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e110: 2020 2022 617a 695f 746f 7022 3a22 6772     "azi_top":"gr
-0003e120: 6164 6965 6e74 222c 2022 617a 695f 626f  adient", "azi_bo
-0003e130: 7422 3a22 6772 6164 6965 6e74 222c 2022  t":"gradient", "
-0003e140: 6469 705f 746f 7022 3a22 6772 6164 6965  dip_top":"gradie
-0003e150: 6e74 222c 2022 6469 705f 626f 7422 3a22  nt", "dip_bot":"
-0003e160: 6772 6164 6965 6e74 222c 0d0a 2020 2020  gradient",..    
-0003e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e180: 2020 2020 2022 7261 6469 7573 4d6f 6465       "radiusMode
-0003e190: 223a 2022 6c61 7267 655f 6465 6661 756c  ": "large_defaul
-0003e1a0: 7422 2c20 2272 7822 3a20 6e78 2a73 782c  t", "rx": nx*sx,
-0003e1b0: 2022 7279 223a 206e 792a 7379 2c20 2272   "ry": ny*sy, "r
-0003e1c0: 7a22 3a20 6e7a 2a73 7a2c 2022 616e 6973  z": nz*sz, "anis
-0003e1d0: 6f74 726f 7079 5261 7469 6f4d 6f64 6522  otropyRatioMode"
-0003e1e0: 3a20 226f 6e65 222c 2022 6178 223a 2031  : "one", "ax": 1
-0003e1f0: 2c20 2261 7922 3a20 312c 2022 617a 223a  , "ay": 1, "az":
-0003e200: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
-0003e210: 2020 2020 2020 2020 2020 2020 2020 2261                "a
-0003e220: 6e67 6c65 3122 3a20 302c 2022 616e 676c  ngle1": 0, "angl
-0003e230: 6532 223a 2030 2c20 2261 6e67 6c65 3322  e2": 0, "angle3"
-0003e240: 3a20 302c 0d0a 2020 2020 2020 2020 2020  : 0,..          
-0003e250: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003e260: 676c 6f62 616c 5064 6622 3a20 4e6f 6e65  globalPdf": None
-0003e270: 2c20 226c 6f63 616c 5064 6622 3a20 4e6f  , "localPdf": No
-0003e280: 6e65 2c20 2270 726f 6261 5573 6167 6522  ne, "probaUsage"
-0003e290: 3a20 302c 2022 6c6f 6361 6c50 6466 5261  : 0, "localPdfRa
-0003e2a0: 6469 7573 223a 2031 322e 2c20 2264 6561  dius": 12., "dea
-0003e2b0: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
-0003e2c0: 6522 3a20 342e 2c20 2263 6f6e 7374 616e  e": 4., "constan
-0003e2d0: 7454 6872 6573 686f 6c64 223a 2031 652d  tThreshold": 1e-
-0003e2e0: 332c 2022 6e70 6f73 7422 3a31 7d0d 0a0d  3, "npost":1}...
-0003e2f0: 0a20 2020 2020 2020 206b 7761 7267 735f  .        kwargs_
-0003e300: 6465 665f 5450 4773 3d7b 226e 6569 6722  def_TPGs={"neig"
-0003e310: 3a20 3230 2c20 226e 6974 223a 2031 3030  : 20, "nit": 100
-0003e320: 2c20 2267 7266 5f6d 6574 686f 6422 3a20  , "grf_method": 
-0003e330: 2266 6674 227d 0d0a 0d0a 2020 2020 2020  "fft"}....      
-0003e340: 2020 6d65 7468 6f64 733d 5b22 5349 5322    methods=["SIS"
-0003e350: 2c20 224d 5053 222c 2022 5450 4773 222c  , "MPS", "TPGs",
-0003e360: 2022 5375 6250 696c 6522 5d0d 0a20 2020   "SubPile"]..   
-0003e370: 2020 2020 206b 7761 7267 735f 6465 663d       kwargs_def=
-0003e380: 5b6b 7761 7267 735f 6465 665f 5349 532c  [kwargs_def_SIS,
-0003e390: 206b 7761 7267 735f 6465 665f 4d50 532c   kwargs_def_MPS,
-0003e3a0: 206b 7761 7267 735f 6465 665f 5450 4773   kwargs_def_TPGs
-0003e3b0: 5d0d 0a0d 0a20 2020 2020 2020 2066 6f72  ]....        for
-0003e3c0: 2066 5f6d 6574 686f 642c 206b 7720 696e   f_method, kw in
-0003e3d0: 207a 6970 286d 6574 686f 6473 2c20 6b77   zip(methods, kw
-0003e3e0: 6172 6773 5f64 6566 293a 0d0a 2020 2020  args_def):..    
-0003e3f0: 2020 2020 2020 2020 6966 206d 6574 686f          if metho
-0003e400: 6420 3d3d 2066 5f6d 6574 686f 643a 0d0a  d == f_method:..
-0003e410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e420: 6966 206c 656e 286b 7761 7267 7329 203d  if len(kwargs) =
-0003e430: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
-0003e440: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
-0003e450: 3d6b 770d 0a20 2020 2020 2020 2020 2020  =kw..           
-0003e460: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0003e470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e480: 666f 7220 6b2c 2076 2069 6e20 6b77 2e69  for k, v in kw.i
-0003e490: 7465 6d73 2829 3a0d 0a20 2020 2020 2020  tems():..       
-0003e4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e4b0: 2069 6620 6b20 6e6f 7420 696e 206b 7761   if k not in kwa
-0003e4c0: 7267 732e 6b65 7973 2829 3a0d 0a20 2020  rgs.keys():..   
-0003e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e4e0: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
-0003e4f0: 6b5d 3d76 0d0a 0d0a 2020 2020 2020 2020  k]=v....        
-0003e500: 2320 6c69 7374 206f 626a 6563 7473 0d0a  # list objects..
-0003e510: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
-0003e520: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
-0003e530: 2020 2020 2020 2020 2020 6c69 7374 5f6f            list_o
-0003e540: 626a 203d 2073 656c 662e 6c69 7374 5f66  bj = self.list_f
-0003e550: 6163 6965 730d 0a20 2020 2020 2020 2065  acies..        e
-0003e560: 6c69 6620 6d6f 6465 203d 3d20 2275 6e69  lif mode == "uni
-0003e570: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
-0003e580: 2020 6c69 7374 5f6f 626a 203d 2073 656c    list_obj = sel
-0003e590: 662e 5375 6250 696c 652e 6c69 7374 5f75  f.SubPile.list_u
-0003e5a0: 6e69 7473 0d0a 0d0a 2020 2020 2020 2020  nits....        
-0003e5b0: 2363 6865 636b 2069 6620 6f6e 6c79 2031  #check if only 1
-0003e5c0: 2066 6163 6965 7320 2d2d 3e20 686f 6d6f   facies --> homo
-0003e5d0: 6765 6e6f 7573 0d0a 2020 2020 2020 2020  genous..        
-0003e5e0: 6966 206c 656e 286c 6973 745f 6f62 6a29  if len(list_obj)
-0003e5f0: 203c 2032 2061 6e64 206d 6574 686f 6420   < 2 and method 
-0003e600: 213d 2022 686f 6d6f 6765 6e6f 7573 223a  != "homogenous":
-0003e610: 0d0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
-0003e620: 7468 6f64 203d 2268 6f6d 6f67 656e 6f75  thod ="homogenou
-0003e630: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
-0003e640: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
-0003e650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003e660: 2020 7072 696e 7428 2255 6e69 7420 7b7d    print("Unit {}
-0003e670: 2068 6173 206f 6e6c 7920 6f6e 6520 6661   has only one fa
-0003e680: 6369 6573 2c20 6661 6369 6573 206d 6574  cies, facies met
-0003e690: 686f 6420 7365 7473 2074 6f20 686f 6d6f  hod sets to homo
-0003e6a0: 6765 6e6f 7573 222e 666f 726d 6174 2873  genous".format(s
-0003e6b0: 656c 662e 6e61 6d65 2929 0d0a 0d0a 2020  elf.name))....  
-0003e6c0: 2020 2020 2020 2323 2320 5369 6d75 6c61        ### Simula
-0003e6d0: 7469 6f6e 7320 2323 230d 0a20 2020 2020  tions ###..     
-0003e6e0: 2020 2069 6620 6d65 7468 6f64 2021 3d20     if method != 
-0003e6f0: 2253 7562 5069 6c65 2220 6f72 206d 6f64  "SubPile" or mod
-0003e700: 6520 3d3d 2022 756e 6974 7322 3a0d 0a20  e == "units":.. 
-0003e710: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0003e720: 7520 696e 2072 616e 6765 286e 7265 616c  u in range(nreal
-0003e730: 5f75 6e69 7473 293a 2023 206c 6f6f 7020  _units): # loop 
-0003e740: 6f76 6572 2065 7869 7374 696e 6720 7375  over existing su
-0003e750: 7266 6163 6573 0d0a 2020 2020 2020 2020  rfaces..        
-0003e760: 2020 2020 2020 2020 6966 2041 7263 6854          if ArchT
-0003e770: 6162 6c65 2e76 6572 626f 7365 3a0d 0a20  able.verbose:.. 
-0003e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e790: 2020 2070 7269 6e74 2822 2323 2320 556e     print("### Un
-0003e7a0: 6974 207b 7d20 2d20 7265 616c 697a 6174  it {} - realizat
-0003e7b0: 696f 6e20 7b7d 2023 2323 222e 666f 726d  ion {} ###".form
-0003e7c0: 6174 2873 656c 662e 6e61 6d65 2c20 6975  at(self.name, iu
-0003e7d0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-0003e7e0: 2020 2020 6966 2073 656c 662e 636f 6e74      if self.cont
-0003e7f0: 6163 7420 3d3d 2022 6f6e 6c61 7022 3a0d  act == "onlap":.
-0003e800: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0003e810: 2020 2020 2020 206d 6173 6b3d 4172 6368         mask=Arch
-0003e820: 5461 626c 652e 6765 745f 756e 6974 735f  Table.get_units_
-0003e830: 646f 6d61 696e 735f 7265 616c 697a 6174  domains_realizat
-0003e840: 696f 6e73 2869 7529 203d 3d20 7365 6c66  ions(iu) == self
-0003e850: 2e49 440d 0a0d 0a20 2020 2020 2020 2020  .ID....         
-0003e860: 2020 2020 2020 2020 2020 2023 2320 484f             ## HO
-0003e870: 4d4f 4745 4e4f 5553 2023 230d 0a20 2020  MOGENOUS ##..   
-0003e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e890: 2069 6620 6d65 7468 6f64 2e6c 6f77 6572   if method.lower
-0003e8a0: 2829 203d 3d20 2268 6f6d 6f67 656e 6f75  () == "homogenou
-0003e8b0: 7322 3a0d 0a0d 0a20 2020 2020 2020 2020  s":....         
-0003e8c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003e8d0: 6620 6c65 6e28 6c69 7374 5f6f 626a 2920  f len(list_obj) 
-0003e8e0: 3e20 313a 2023 206d 6f72 6520 7468 616e  > 1: # more than
-0003e8f0: 206f 6e65 0d0a 2020 2020 2020 2020 2020   one..          
-0003e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e910: 2020 6966 2041 7263 6854 6162 6c65 2e76    if ArchTable.v
-0003e920: 6572 626f 7365 3a0d 0a20 2020 2020 2020  erbose:..       
-0003e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e940: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-0003e950: 5741 524e 494e 4720 2121 204d 6f72 6520  WARNING !! More 
-0003e960: 7468 616e 206f 6e65 2066 6163 6965 7320  than one facies 
-0003e970: 6861 7320 6265 656e 2070 6173 7365 6420  has been passed 
-0003e980: 746f 2068 6f6d 6f67 656e 6f75 7320 756e  to homogenous un
-0003e990: 6974 207b 7d5c 6e46 6972 7374 2069 6e20  it {}\nFirst in 
-0003e9a0: 7468 6520 6c69 7374 2069 7320 7461 6b65  the list is take
-0003e9b0: 6e22 2e66 6f72 6d61 7428 7365 6c66 2e6e  n".format(self.n
-0003e9c0: 616d 6529 290d 0a20 2020 2020 2020 2020  ame))..         
-0003e9d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003e9e0: 6c69 6620 6c65 6e28 6c69 7374 5f6f 626a  lif len(list_obj
-0003e9f0: 2920 3c20 313a 2023 206e 6f20 6661 6369  ) < 1: # no faci
-0003ea00: 6573 2061 6464 6564 0d0a 2020 2020 2020  es added..      
-0003ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ea20: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0003ea30: 6545 7272 6f72 2028 224e 6f20 6661 6369  eError ("No faci
-0003ea40: 6573 2070 6173 7365 6420 746f 2068 6f6d  es passed to hom
-0003ea50: 6f67 656e 6f75 7320 756e 6974 207b 7d22  ogenous unit {}"
-0003ea60: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
-0003ea70: 6529 290d 0a0d 0a20 2020 2020 2020 2020  e))....         
-0003ea80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003ea90: 2320 7365 7475 7020 6120 3344 2061 7272  # setup a 3D arr
-0003eaa0: 6179 206f 6620 7468 6520 7369 6d75 6c61  ay of the simula
-0003eab0: 7469 6f6e 2067 7269 6420 7369 7a65 2061  tion grid size a
-0003eac0: 6e64 2061 7373 6967 6e20 6f6e 6520 6661  nd assign one fa
-0003ead0: 6369 6573 2074 6f20 7468 6520 756e 6974  cies to the unit
-0003eae0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-0003eaf0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003eb00: 6965 733d 6c69 7374 5f6f 626a 5b30 5d0d  ies=list_obj[0].
-0003eb10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003eb20: 2020 2020 2020 2020 2066 6f72 2069 7265           for ire
-0003eb30: 616c 2069 6e20 7261 6e67 6528 6e72 6561  al in range(nrea
-0003eb40: 6c29 3a0d 0a20 2020 2020 2020 2020 2020  l):..           
-0003eb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eb60: 2066 6163 6965 735f 646f 6d61 696e 735b   facies_domains[
-0003eb70: 6975 2c20 6972 6561 6c5d 5b6d 6173 6b5d  iu, ireal][mask]
-0003eb80: 3d66 6163 6965 732e 4944 0d0a 0d0a 2020  =facies.ID....  
-0003eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eba0: 2020 2323 2053 4953 2023 230d 0a20 2020    ## SIS ##..   
-0003ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ebc0: 2065 6c69 6620 6d65 7468 6f64 2e75 7070   elif method.upp
-0003ebd0: 6572 2829 203d 3d20 2253 4953 223a 0d0a  er() == "SIS":..
-0003ebe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ebf0: 2020 2020 2020 2020 2323 2073 6574 7570          ## setup
-0003ec00: 2053 4953 2023 230d 0a0d 0a20 2020 2020   SIS ##....     
+0003c710: 2822 6174 206c 6561 7374 206f 6e65 2063  ("at least one c
+0003c720: 6f76 6d6f 6465 6c20 6973 206e 6f74 2061  ovmodel is not a
+0003c730: 2033 4420 636f 766d 6f64 656c 2067 656f   3D covmodel geo
+0003c740: 6e65 2c20 6e6f 7468 696e 6720 6861 7320  ne, nothing has 
+0003c750: 6368 616e 6765 6422 290d 0a0d 0a20 2020  changed")....   
+0003c760: 2020 2020 2065 7863 6570 743a 2023 206f       except: # o
+0003c770: 6e6c 7920 6f6e 6520 6f62 6a65 6374 2070  nly one object p
+0003c780: 6173 7365 640d 0a20 2020 2020 2020 2020  assed..         
+0003c790: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0003c7a0: 2866 5f63 6f76 6d6f 6465 6c2c 2063 6f76  (f_covmodel, cov
+0003c7b0: 6d6f 6465 6c73 5f63 6c61 7373 293a 0d0a  models_class):..
+0003c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c7d0: 7365 6c66 2e6c 6973 745f 665f 636f 766d  self.list_f_covm
+0003c7e0: 6f64 656c 2e61 7070 656e 6428 665f 636f  odel.append(f_co
+0003c7f0: 766d 6f64 656c 290d 0a20 2020 2020 2020  vmodel)..       
+0003c800: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+0003c810: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+0003c820: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003c830: 7269 6e74 2822 556e 6974 207b 7d3a 2063  rint("Unit {}: c
+0003c840: 6f76 6d6f 6465 6c20 666f 7220 5349 5320  ovmodel for SIS 
+0003c850: 6164 6465 6422 2e66 6f72 6d61 7428 7365  added".format(se
+0003c860: 6c66 2e6e 616d 6529 290d 0a20 2020 2020  lf.name))..     
+0003c870: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003c880: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003c890: 2073 656c 662e 7665 7262 6f73 653a 0d0a   self.verbose:..
+0003c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c8b0: 2020 2020 7072 696e 7428 2255 6e69 7420      print("Unit 
+0003c8c0: 7b7d 3a20 636f 766d 6f64 656c 206e 6f74  {}: covmodel not
+0003c8d0: 2061 2067 656f 6e65 2033 4420 636f 766d   a geone 3D covm
+0003c8e0: 6f64 656c 222e 666f 726d 6174 2873 656c  odel".format(sel
+0003c8f0: 662e 6e61 6d65 2929 0d0a 0d0a 2020 2020  f.name))....    
+0003c900: 6465 6620 6765 745f 685f 6c65 7665 6c28  def get_h_level(
+0003c910: 7365 6c66 293a 0d0a 0d0a 2020 2020 2020  self):....      
+0003c920: 2020 2222 220d 0a20 2020 2020 2020 2052    """..        R
+0003c930: 6574 7572 6e20 6869 6572 6172 6368 6963  eturn hierarchic
+0003c940: 616c 206c 6576 656c 206f 6620 7468 6520  al level of the 
+0003c950: 756e 6974 0d0a 2020 2020 2020 2020 2222  unit..        ""
+0003c960: 220d 0a0d 0a20 2020 2020 2020 2064 6566  "....        def
+0003c970: 2066 756e 6328 756e 6974 2c20 685f 6c65   func(unit, h_le
+0003c980: 7629 3a0d 0a20 2020 2020 2020 2020 2020  v):..           
+0003c990: 2069 6620 756e 6974 2e6d 756d 6d79 5f75   if unit.mummy_u
+0003c9a0: 6e69 7420 6973 206e 6f74 204e 6f6e 653a  nit is not None:
+0003c9b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003c9c0: 2020 685f 6c65 7620 2b3d 2031 0d0a 2020    h_lev += 1..  
+0003c9d0: 2020 2020 2020 2020 2020 2020 2020 685f                h_
+0003c9e0: 6c65 763d 6675 6e63 2875 6e69 742e 6d75  lev=func(unit.mu
+0003c9f0: 6d6d 795f 756e 6974 2c20 685f 6c65 7629  mmy_unit, h_lev)
+0003ca00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003ca10: 7265 7475 726e 2068 5f6c 6576 0d0a 2020  return h_lev..  
+0003ca20: 2020 2020 2020 685f 6c65 763d 310d 0a20        h_lev=1.. 
+0003ca30: 2020 2020 2020 2068 5f6c 6576 3d66 756e         h_lev=fun
+0003ca40: 6328 7365 6c66 2c20 685f 6c65 7629 0d0a  c(self, h_lev)..
+0003ca50: 2020 2020 2020 2020 7265 7475 726e 2068          return h
+0003ca60: 5f6c 6576 0d0a 0d0a 2020 2020 6465 6620  _lev....    def 
+0003ca70: 676f 6573 5f75 705f 756e 7469 6c28 7365  goes_up_until(se
+0003ca80: 6c66 2c20 756e 6974 5f74 6172 6765 7429  lf, unit_target)
+0003ca90: 3a0d 0a20 2020 2020 2020 200d 0a20 2020  :..        ..   
+0003caa0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0003cab0: 2020 436c 696d 6220 7468 6520 6869 6572    Climb the hier
+0003cac0: 6172 6368 6963 616c 2074 7265 6520 6f66  archical tree of
+0003cad0: 2073 656c 6620 756e 6974 2075 6e74 696c   self unit until
+0003cae0: 2066 696e 6469 6e67 2061 2073 7065 6369   finding a speci
+0003caf0: 6669 6320 756e 6974 2061 6e64 2072 6574  fic unit and ret
+0003cb00: 7572 6e20 6974 0d0a 0d0a 2020 2020 2020  urn it....      
+0003cb10: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0003cb20: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0003cb30: 0d0a 2020 2020 2020 2020 756e 6974 5f74  ..        unit_t
+0003cb40: 6172 6765 743a 203a 636c 6173 733a 6055  arget: :class:`U
+0003cb50: 6e69 7460 206f 626a 6563 740d 0a20 2020  nit` object..   
+0003cb60: 2020 2020 2020 2020 2055 6e69 7420 6f62           Unit ob
+0003cb70: 6a65 6374 2074 6f20 6669 6e64 2069 6e20  ject to find in 
+0003cb80: 7468 6520 6869 6572 6172 6368 6963 616c  the hierarchical
+0003cb90: 2074 7265 650d 0a0d 0a20 2020 2020 2020   tree....       
+0003cba0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0003cbb0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0003cbc0: 2020 2075 6e69 743a 203a 636c 6173 733a     unit: :class:
+0003cbd0: 6055 6e69 7460 206f 626a 6563 7420 6f72  `Unit` object or
+0003cbe0: 204e 6f6e 650d 0a20 2020 2020 2020 2020   None..         
+0003cbf0: 2020 2055 6e69 7420 6f62 6a65 6374 2066     Unit object f
+0003cc00: 6f75 6e64 2069 6e20 7468 6520 6869 6572  ound in the hier
+0003cc10: 6172 6368 6963 616c 2074 7265 650d 0a20  archical tree.. 
+0003cc20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0003cc30: 7420 666f 756e 642c 2072 6574 7572 6e20  t found, return 
+0003cc40: 4e6f 6e65 0d0a 2020 2020 2020 2020 2222  None..        ""
+0003cc50: 220d 0a20 2020 2020 2020 200d 0a20 2020  "..        ..   
+0003cc60: 2020 2020 2075 6e69 7420 3d20 7365 6c66       unit = self
+0003cc70: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+0003cc80: 696e 2072 616e 6765 2873 656c 662e 6765  in range(self.ge
+0003cc90: 745f 685f 6c65 7665 6c28 2929 3a0d 0a20  t_h_level()):.. 
+0003cca0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
+0003ccb0: 2020 2020 2020 2020 2069 6620 756e 6974           if unit
+0003ccc0: 2021 3d20 756e 6974 5f74 6172 6765 743a   != unit_target:
+0003ccd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003cce0: 2020 756e 6974 203d 2075 6e69 742e 6d75    unit = unit.mu
+0003ccf0: 6d6d 795f 756e 6974 0d0a 2020 2020 2020  mmy_unit..      
+0003cd00: 2020 2020 2020 2020 2020 6966 2075 6e69            if uni
+0003cd10: 7420 6973 204e 6f6e 653a 0d0a 2020 2020  t is None:..    
+0003cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd30: 7265 7475 726e 204e 6f6e 650d 0a20 2020  return None..   
+0003cd40: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0003cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cd60: 7265 7475 726e 2075 6e69 740d 0a20 2020  return unit..   
+0003cd70: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
+0003cd80: 2020 2072 6574 7572 6e20 756e 6974 0d0a     return unit..
+0003cd90: 0d0a 2020 2020 6465 6620 6765 745f 6269  ..    def get_bi
+0003cda0: 675f 6d75 6d6d 795f 756e 6974 2873 656c  g_mummy_unit(sel
+0003cdb0: 6629 3a0d 0a0d 0a20 2020 2020 2020 2022  f):....        "
+0003cdc0: 2222 0d0a 2020 2020 2020 2020 5265 7475  ""..        Retu
+0003cdd0: 726e 206c 6f77 6573 7420 756e 6974 2028  rn lowest unit (
+0003cde0: 6d61 696e 2075 6e69 7429 2069 6e20 6869  main unit) in hi
+0003cdf0: 6572 6172 6368 6963 616c 206f 7264 6572  erarchical order
+0003ce00: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
+0003ce10: 0a20 2020 2020 2020 2075 6e69 7420 3d20  .        unit = 
+0003ce20: 7365 6c66 0d0a 2020 2020 2020 2020 666f  self..        fo
+0003ce30: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
+0003ce40: 662e 6765 745f 685f 6c65 7665 6c28 2929  f.get_h_level())
+0003ce50: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+0003ce60: 2069 6620 756e 6974 2e6d 756d 6d79 5f75   if unit.mummy_u
+0003ce70: 6e69 7420 6973 206e 6f74 204e 6f6e 653a  nit is not None:
+0003ce80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ce90: 2020 756e 6974 203d 2075 6e69 742e 6d75    unit = unit.mu
+0003cea0: 6d6d 795f 756e 6974 0d0a 2020 2020 2020  mmy_unit..      
+0003ceb0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
+0003cec0: 7265 7475 726e 2075 6e69 740d 0a0d 0a20  return unit.... 
+0003ced0: 2020 2064 6566 2067 6574 5f62 6162 795f     def get_baby_
+0003cee0: 756e 6974 7328 7365 6c66 2c20 7265 636f  units(self, reco
+0003cef0: 6d70 7574 653d 4661 6c73 652c 2076 623d  mpute=False, vb=
+0003cf00: 3129 3a0d 0a0d 0a0d 0a20 2020 2020 2020  1):......       
+0003cf10: 2022 2222 0d0a 2020 2020 2020 2020 4d65   """..        Me
+0003cf20: 7468 6f64 2074 6f20 7265 7475 726e 2061  thod to return a
+0003cf30: 6c6c 2075 6e69 7473 2074 6861 7420 6172  ll units that ar
+0003cf40: 6520 756e 6465 7220 7468 6520 6375 7272  e under the curr
+0003cf50: 656e 7420 756e 6974 2069 6e20 7468 6520  ent unit in the 
+0003cf60: 6869 6572 6172 6368 790d 0a0d 0a20 2020  hierarchy....   
+0003cf70: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+0003cf80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003cf90: 2d2d 2d0d 0a20 2020 2020 2020 2072 6563  ---..        rec
+0003cfa0: 6f6d 7075 7465 3a20 626f 6f6c 0d0a 2020  ompute: bool..  
+0003cfb0: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
+0003cfc0: 652c 2072 6563 6f6d 7075 7465 2074 6865  e, recompute the
+0003cfd0: 206c 6973 7420 6f66 2075 6e69 7473 2069   list of units i
+0003cfe0: 6620 7468 6572 6520 6861 6420 6265 656e  f there had been
+0003cff0: 206d 6f64 6966 6963 6174 696f 6e73 2069   modifications i
+0003d000: 6e20 7468 6520 6869 6572 6172 6368 790d  n the hierarchy.
+0003d010: 0a20 2020 2020 2020 2076 623a 2069 6e74  .        vb: int
+0003d020: 0d0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+0003d030: 7262 6f73 6974 7920 6c65 7665 6c2c 2030  rbosity level, 0
+0003d040: 2066 6f72 206e 6f20 7072 696e 742c 2031   for no print, 1
+0003d050: 2066 6f72 2070 7269 6e74 0d0a 0d0a 2020   for print....  
+0003d060: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0003d070: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0003d080: 2020 2020 2020 2020 6c69 7374 0d0a 2020          list..  
+0003d090: 2020 2020 2020 6c69 7374 206f 6620 6368        list of ch
+0003d0a0: 696c 6473 203a 636c 6173 733a 6055 6e69  ilds :class:`Uni
+0003d0b0: 7460 206f 626a 6563 7473 206f 6620 7468  t` objects of th
+0003d0c0: 6520 6375 7272 656e 7420 756e 6974 0d0a  e current unit..
+0003d0d0: 2020 2020 2020 2020 2222 220d 0a0d 0a20          """.... 
+0003d0e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
+0003d0f0: 2069 6620 7365 6c66 2e53 7562 5069 6c65   if self.SubPile
+0003d100: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
+0003d110: 2020 2020 2020 2069 6620 7662 3a0d 0a20         if vb:.. 
+0003d120: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003d130: 7269 6e74 2822 556e 6974 2068 6173 206e  rint("Unit has n
+0003d140: 6f20 6869 6572 6172 6368 7922 290d 0a20  o hierarchy").. 
+0003d150: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0003d160: 6e20 5b5d 0d0a 0d0a 2020 2020 2020 2020  n []....        
+0003d170: 6966 2072 6563 6f6d 7075 7465 3a0d 0a20  if recompute:.. 
+0003d180: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003d190: 6262 5f75 6e69 7473 203d 205b 5d0d 0a0d  bb_units = []...
+0003d1a0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
+0003d1b0: 2066 756e 2875 6e69 7429 3a0d 0a0d 0a20   fun(unit):.... 
+0003d1c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003d1d0: 6620 756e 6974 2e53 7562 5069 6c65 2069  f unit.SubPile i
+0003d1e0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0003d1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d200: 206c 3d75 6e69 742e 5375 6250 696c 652e   l=unit.SubPile.
+0003d210: 6c69 7374 5f75 6e69 7473 0d0a 2020 2020  list_units..    
+0003d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d230: 7365 6c66 2e62 625f 756e 6974 7320 2b3d  self.bb_units +=
+0003d240: 206c 0d0a 0d0a 2020 2020 2020 2020 2020   l....          
+0003d250: 2020 2020 2020 2020 2020 666f 7220 756e            for un
+0003d260: 6974 2069 6e20 6c3a 0d0a 2020 2020 2020  it in l:..      
+0003d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d280: 2020 6675 6e28 756e 6974 290d 0a0d 0a20    fun(unit).... 
+0003d290: 2020 2020 2020 2020 2020 2066 756e 2873             fun(s
+0003d2a0: 656c 6629 0d0a 2020 2020 2020 2020 7265  elf)..        re
+0003d2b0: 7475 726e 2073 656c 662e 6262 5f75 6e69  turn self.bb_uni
+0003d2c0: 7473 0d0a 0d0a 2020 2020 6465 6620 6164  ts....    def ad
+0003d2d0: 645f 6661 6369 6573 2873 656c 662c 2066  d_facies(self, f
+0003d2e0: 6163 6965 7329 3a0d 0a0d 0a20 2020 2020  acies):....     
+0003d2f0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0003d300: 4164 6420 6661 6369 6573 206f 626a 6563  Add facies objec
+0003d310: 7420 746f 2073 7472 6174 690d 0a0d 0a20  t to strati.... 
+0003d320: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003d330: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003d340: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
+0003d350: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
+0003d360: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
+0003d370: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
+0003d380: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
+0003d390: 7320 6f62 6a65 6374 2074 6f20 6d6f 6465  s object to mode
+0003d3a0: 6c20 696e 7369 6465 2074 6865 2075 6e69  l inside the uni
+0003d3b0: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+0003d3c0: 0d0a 2020 2020 2020 2020 6966 2074 7970  ..        if typ
+0003d3d0: 6528 6661 6369 6573 2920 3d3d 206c 6973  e(facies) == lis
+0003d3e0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+0003d3f0: 666f 7220 6920 696e 2066 6163 6965 733a  for i in facies:
+0003d400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003d410: 2020 6966 2028 6973 696e 7374 616e 6365    if (isinstance
+0003d420: 2869 2c20 4661 6369 6573 2929 2061 6e64  (i, Facies)) and
+0003d430: 2028 6920 6e6f 7420 696e 2073 656c 662e   (i not in self.
+0003d440: 6c69 7374 5f66 6163 6965 7329 3a20 2320  list_facies): # 
+0003d450: 6368 6563 6b20 4661 6369 6573 206f 626a  check Facies obj
+0003d460: 6563 7420 6265 6c6f 6e67 2074 6f20 4661  ect belong to Fa
+0003d470: 6369 6573 2063 6c61 7373 0d0a 2020 2020  cies class..    
+0003d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d490: 7365 6c66 2e6c 6973 745f 6661 6369 6573  self.list_facies
+0003d4a0: 2e61 7070 656e 6428 6929 0d0a 2020 2020  .append(i)..    
+0003d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d4c0: 6966 2073 656c 662e 7665 7262 6f73 653a  if self.verbose:
+0003d4d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003d4e0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0003d4f0: 2246 6163 6965 7320 7b7d 2061 6464 6564  "Facies {} added
+0003d500: 2074 6f20 756e 6974 207b 7d22 2e66 6f72   to unit {}".for
+0003d510: 6d61 7428 692e 6e61 6d65 2c20 7365 6c66  mat(i.name, self
+0003d520: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
+0003d530: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0003d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d550: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+0003d560: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+0003d570: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003d580: 696e 7428 226f 626a 6563 7420 6973 6e27  int("object isn'
+0003d590: 7420 6120 4661 6369 6573 206f 626a 6563  t a Facies objec
+0003d5a0: 7420 6f72 2046 6163 6965 7320 6f62 6a65  t or Facies obje
+0003d5b0: 6374 2068 6173 2061 6c72 6561 6479 2062  ct has already b
+0003d5c0: 6565 6e20 6164 6465 6422 290d 0a20 2020  een added")..   
+0003d5d0: 2020 2020 2065 6c73 653a 2023 2066 6163       else: # fac
+0003d5e0: 6965 7320 6e6f 7420 696e 2061 206c 6973  ies not in a lis
+0003d5f0: 740d 0a20 2020 2020 2020 2020 2020 2069  t..            i
+0003d600: 6620 2869 7369 6e73 7461 6e63 6528 6661  f (isinstance(fa
+0003d610: 6369 6573 2c20 4661 6369 6573 2929 2020  cies, Facies))  
+0003d620: 616e 6420 2866 6163 6965 7320 6e6f 7420  and (facies not 
+0003d630: 696e 2073 656c 662e 6c69 7374 5f66 6163  in self.list_fac
+0003d640: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
+0003d650: 2020 2020 2020 2073 656c 662e 6c69 7374         self.list
+0003d660: 5f66 6163 6965 732e 6170 7065 6e64 2866  _facies.append(f
+0003d670: 6163 6965 7329 0d0a 2020 2020 2020 2020  acies)..        
+0003d680: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003d690: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+0003d6a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0003d6b0: 696e 7428 2246 6163 6965 7320 7b7d 2061  int("Facies {} a
+0003d6c0: 6464 6564 2074 6f20 756e 6974 207b 7d22  dded to unit {}"
+0003d6d0: 2e66 6f72 6d61 7428 6661 6369 6573 2e6e  .format(facies.n
+0003d6e0: 616d 652c 2073 656c 662e 6e61 6d65 2929  ame, self.name))
+0003d6f0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003d700: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0003d710: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+0003d720: 626f 7365 3a0d 0a20 2020 2020 2020 2020  bose:..         
+0003d730: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0003d740: 2822 6f62 6a65 6374 2069 736e 2774 2061  ("object isn't a
+0003d750: 2046 6163 6965 7320 6f62 6a65 6374 206f   Facies object o
+0003d760: 7220 4661 6369 6573 206f 626a 6563 7420  r Facies object 
+0003d770: 6861 7320 616c 7265 6164 7920 6265 656e  has already been
+0003d780: 2061 6464 6564 2229 0d0a 0d0a 2020 2020   added")....    
+0003d790: 2020 2020 7265 7475 726e 0d0a 0d0a 2020      return....  
+0003d7a0: 2020 6465 6620 7265 6d5f 6661 6369 6573    def rem_facies
+0003d7b0: 2873 656c 662c 2066 6163 6965 733d 4e6f  (self, facies=No
+0003d7c0: 6e65 2c20 616c 6c5f 6661 6369 6573 3d54  ne, all_facies=T
+0003d7d0: 7275 6529 3a0d 0a0d 0a20 2020 2020 2020  rue):....       
+0003d7e0: 2022 2222 0d0a 2020 2020 2020 2020 546f   """..        To
+0003d7f0: 2072 656d 6f76 6520 6661 6369 6573 2066   remove facies f
+0003d800: 726f 6d20 756e 6974 2c20 6279 2064 6566  rom unit, by def
+0003d810: 6175 6c74 2061 6c6c 2066 6163 6965 7320  ault all facies 
+0003d820: 6172 6520 7265 6d6f 7665 640d 0a0d 0a20  are removed.... 
+0003d830: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003d840: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0003d850: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2066  -----..        f
+0003d860: 6163 6965 733a 203a 636c 6173 733a 6046  acies: :class:`F
+0003d870: 6163 6965 7360 206f 626a 6563 7420 6f72  acies` object or
+0003d880: 206c 6973 7420 6f66 2074 6865 6d0d 0a20   list of them.. 
+0003d890: 2020 2020 2020 2020 2020 2046 6163 6965             Facie
+0003d8a0: 7320 6f62 6a65 6374 2074 6f20 7265 6d6f  s object to remo
+0003d8b0: 7665 2066 726f 6d20 7468 6520 756e 6974  ve from the unit
+0003d8c0: 0d0a 2020 2020 2020 2020 616c 6c5f 6661  ..        all_fa
+0003d8d0: 6369 6573 3a20 626f 6f6c 0d0a 2020 2020  cies: bool..    
+0003d8e0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+0003d8f0: 2061 6c6c 2066 6163 6965 7320 6172 6520   all facies are 
+0003d900: 7265 6d6f 7665 640d 0a20 2020 2020 2020  removed..       
+0003d910: 2022 2222 0d0a 2020 2020 0d0a 2020 2020   """..    ..    
+0003d920: 2020 2020 6966 2061 6c6c 5f66 6163 6965      if all_facie
+0003d930: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+0003d940: 7365 6c66 2e6c 6973 745f 6661 6369 6573  self.list_facies
+0003d950: 3d5b 5d0d 0a20 2020 2020 2020 2065 6c73  =[]..        els
+0003d960: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0003d970: 7365 6c66 2e6c 6973 745f 6661 6369 6573  self.list_facies
+0003d980: 2e72 656d 6f76 6528 6661 6369 6573 290d  .remove(facies).
+0003d990: 0a0d 0a20 2020 2064 6566 2063 6f6d 7075  ...    def compu
+0003d9a0: 7465 5f66 6163 6965 7328 7365 6c66 2c20  te_facies(self, 
+0003d9b0: 4172 6368 5461 626c 652c 206e 7265 616c  ArchTable, nreal
+0003d9c0: 3d31 2c20 6d6f 6465 3d22 6661 6369 6573  =1, mode="facies
+0003d9d0: 222c 2076 6572 626f 7365 3d30 293a 0d0a  ", verbose=0):..
+0003d9e0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0003d9f0: 2020 2020 2020 2043 6f6d 7075 7465 2066         Compute f
+0003da00: 6163 6965 7320 646f 6d61 696e 2066 6f72  acies domain for
+0003da10: 2074 6865 2073 7065 6369 6669 6320 756e   the specific un
+0003da20: 6974 0d0a 0d0a 2020 2020 2020 2020 5061  it....        Pa
+0003da30: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0003da40: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0003da50: 2020 2020 2020 4172 6368 5461 626c 653a        ArchTable:
+0003da60: 203a 636c 6173 733a 6041 7263 685f 7461   :class:`Arch_ta
+0003da70: 626c 6560 206f 626a 6563 740d 0a20 2020  ble` object..   
+0003da80: 2020 2020 2020 2020 2041 7263 6854 6162           ArchTab
+0003da90: 6c65 2063 6f6e 7461 696e 696e 6720 756e  le containing un
+0003daa0: 6974 732c 2073 7572 6661 6365 2c0d 0a20  its, surface,.. 
+0003dab0: 2020 2020 2020 2020 2020 2066 6163 6965             facie
+0003dac0: 7320 616e 6420 6174 206c 6561 7374 2061  s and at least a
+0003dad0: 2050 696c 6520 2873 6565 2065 7861 6d70   Pile (see examp
+0003dae0: 6c65 206f 6e20 7468 6520 6769 7468 7562  le on the github
+0003daf0: 290d 0a20 2020 2020 2020 206e 7265 616c  )..        nreal
+0003db00: 2020 203a 2069 6e74 0d0a 2020 2020 2020     : int..      
+0003db10: 2020 2020 2020 6e75 6d62 6572 206f 6620        number of 
+0003db20: 7265 616c 697a 6174 696f 6e20 2870 6572  realization (per
+0003db30: 2075 6e69 7420 7265 616c 697a 6174 696f   unit realizatio
+0003db40: 6e73 2920 746f 206d 616b 650d 0a20 2020  ns) to make..   
+0003db50: 2020 2020 206d 6f64 653a 2073 7472 0d0a       mode: str..
+0003db60: 2020 2020 2020 2020 2020 2020 2266 6163              "fac
+0003db70: 6965 7322 206f 7220 2273 7472 6174 6922  ies" or "strati"
+0003db80: 0d0a 2020 2020 2020 2020 7665 7262 6f73  ..        verbos
+0003db90: 6520 3a20 696e 740d 0a20 2020 2020 2020  e : int..       
+0003dba0: 2020 2020 2076 6572 626f 7369 7479 206c       verbosity l
+0003dbb0: 6576 656c 2c20 3020 666f 7220 6e6f 2070  evel, 0 for no p
+0003dbc0: 7269 6e74 2c20 3120 666f 7220 7072 696e  rint, 1 for prin
+0003dbd0: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+0003dbe0: 200d 0a0d 0a20 2020 2020 2020 2078 673d   ....        xg=
+0003dbf0: 4172 6368 5461 626c 652e 6765 745f 7867  ArchTable.get_xg
+0003dc00: 2829 0d0a 2020 2020 2020 2020 7967 3d41  ()..        yg=A
+0003dc10: 7263 6854 6162 6c65 2e67 6574 5f79 6728  rchTable.get_yg(
+0003dc20: 290d 0a20 2020 2020 2020 207a 673d 4172  )..        zg=Ar
+0003dc30: 6368 5461 626c 652e 6765 745f 7a67 2829  chTable.get_zg()
+0003dc40: 0d0a 0d0a 2020 2020 2020 2020 7365 6564  ....        seed
+0003dc50: 3d41 7263 6854 6162 6c65 2e73 6565 640d  =ArchTable.seed.
+0003dc60: 0a20 2020 2020 2020 206e 702e 7261 6e64  .        np.rand
+0003dc70: 6f6d 2e73 6565 6428 7365 6564 290d 0a0d  om.seed(seed)...
+0003dc80: 0a20 2020 2020 2020 2023 2320 6772 6964  .        ## grid
+0003dc90: 2070 6172 616d 6574 6572 730d 0a20 2020   parameters..   
+0003dca0: 2020 2020 206e 783d 6c65 6e28 7867 292d       nx=len(xg)-
+0003dcb0: 310d 0a20 2020 2020 2020 206e 793d 6c65  1..        ny=le
+0003dcc0: 6e28 7967 292d 310d 0a20 2020 2020 2020  n(yg)-1..       
+0003dcd0: 206e 7a3d 6c65 6e28 7a67 292d 310d 0a20   nz=len(zg)-1.. 
+0003dce0: 2020 2020 2020 2064 696d 656e 7369 6f6e         dimension
+0003dcf0: 733d 286e 782c 206e 792c 206e 7a29 0d0a  s=(nx, ny, nz)..
+0003dd00: 2020 2020 2020 2020 6f78 3d6e 702e 6d69          ox=np.mi
+0003dd10: 6e28 7867 5b30 5d29 0d0a 2020 2020 2020  n(xg[0])..      
+0003dd20: 2020 6f79 3d6e 702e 6d69 6e28 7967 5b30    oy=np.min(yg[0
+0003dd30: 5d29 0d0a 2020 2020 2020 2020 6f7a 3d6e  ])..        oz=n
+0003dd40: 702e 6d69 6e28 7a67 5b30 5d29 0d0a 2020  p.min(zg[0])..  
+0003dd50: 2020 2020 2020 6f72 6967 696e 3d28 6f78        origin=(ox
+0003dd60: 2c20 6f79 2c20 6f7a 290d 0a20 2020 2020  , oy, oz)..     
+0003dd70: 2020 2073 783d 6e70 2e64 6966 6628 7867     sx=np.diff(xg
+0003dd80: 295b 305d 0d0a 2020 2020 2020 2020 7379  )[0]..        sy
+0003dd90: 3d6e 702e 6469 6666 2879 6729 5b30 5d0d  =np.diff(yg)[0].
+0003dda0: 0a20 2020 2020 2020 2073 7a3d 6e70 2e64  .        sz=np.d
+0003ddb0: 6966 6628 7a67 295b 305d 0d0a 2020 2020  iff(zg)[0]..    
+0003ddc0: 2020 2020 7370 6163 696e 673d 2873 782c      spacing=(sx,
+0003ddd0: 2073 792c 2073 7a29 0d0a 0d0a 2020 2020   sy, sz)....    
+0003dde0: 2020 2020 6e72 6561 6c5f 756e 6974 7320      nreal_units 
+0003ddf0: 3d20 4172 6368 5461 626c 652e 6e72 6561  = ArchTable.nrea
+0003de00: 6c5f 756e 6974 730d 0a0d 0a20 2020 2020  l_units....     
+0003de10: 2020 2066 6163 6965 735f 646f 6d61 696e     facies_domain
+0003de20: 733d 6e70 2e7a 6572 6f73 285b 6e72 6561  s=np.zeros([nrea
+0003de30: 6c5f 756e 6974 732c 206e 7265 616c 2c20  l_units, nreal, 
+0003de40: 6e7a 2c20 6e79 2c20 6e78 5d2c 2064 7479  nz, ny, nx], dty
+0003de50: 7065 3d6e 702e 696e 7438 290d 0a0d 0a20  pe=np.int8).... 
+0003de60: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
+0003de70: 3d20 2266 6163 6965 7322 3a0d 0a20 2020  = "facies":..   
+0003de80: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+0003de90: 7365 6c66 2e66 5f6d 6574 686f 6420 2023  self.f_method  #
+0003dea0: 206d 6574 686f 6420 6f66 2073 696d 756c   method of simul
+0003deb0: 6174 696f 6e0d 0a20 2020 2020 2020 2065  ation..        e
+0003dec0: 6c69 6620 6d6f 6465 203d 3d20 2275 6e69  lif mode == "uni
+0003ded0: 7473 223a 0d0a 2020 2020 2020 2020 2020  ts":..          
+0003dee0: 2020 6966 2022 756e 6974 735f 6669 6c6c    if "units_fill
+0003def0: 5f6d 6574 686f 6422 2069 6e20 7365 6c66  _method" in self
+0003df00: 2e64 6963 5f66 6163 6965 732e 6b65 7973  .dic_facies.keys
+0003df10: 2829 3a0d 0a20 2020 2020 2020 2020 2020  ():..           
+0003df20: 2020 2020 206d 6574 686f 6420 3d20 7365       method = se
+0003df30: 6c66 2e64 6963 5f66 6163 6965 735b 2275  lf.dic_facies["u
+0003df40: 6e69 7473 5f66 696c 6c5f 6d65 7468 6f64  nits_fill_method
+0003df50: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
+0003df60: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0003df70: 2020 2020 2020 206d 6574 686f 6420 3d20         method = 
+0003df80: 2268 6f6d 6f67 656e 6f75 7322 0d0a 0d0a  "homogenous"....
+0003df90: 2020 2020 2020 2020 6b77 6172 6773 3d73          kwargs=s
+0003dfa0: 656c 662e 6469 635f 6661 6369 6573 2020  elf.dic_facies  
+0003dfb0: 2320 7265 7472 6965 7665 206b 6579 776f  # retrieve keywo
+0003dfc0: 7264 2061 7267 756d 656e 7473 0d0a 0d0a  rd arguments....
+0003dfd0: 2020 2020 2020 2020 2364 6566 6175 6c74          #default
+0003dfe0: 206b 7761 7267 7320 666f 7220 5349 530d   kwargs for SIS.
+0003dff0: 0a20 2020 2020 2020 206b 7761 7267 735f  .        kwargs_
+0003e000: 6465 665f 5349 533d 7b22 6e65 6967 223a  def_SIS={"neig":
+0003e010: 2031 302c 2022 7222 3a20 312c 2022 7072   10, "r": 1, "pr
+0003e020: 6f62 6162 696c 6974 7922 3a20 4e6f 6e65  obability": None
+0003e030: 2c22 5349 535f 6f72 6965 6e74 6174 696f  ,"SIS_orientatio
+0003e040: 6e22 3a20 4661 6c73 652c 2261 7a69 6d75  n": False,"azimu
+0003e050: 7468 223a 2030 2c22 6469 7022 3a20 302c  th": 0,"dip": 0,
+0003e060: 2270 6c75 6e67 6522 3a20 307d 0d0a 0d0a  "plunge": 0}....
+0003e070: 2020 2020 2020 2020 6b77 6172 6773 5f64          kwargs_d
+0003e080: 6566 5f4d 5053 3d7b 2276 6172 6e61 6d65  ef_MPS={"varname
+0003e090: 223a 2263 6f64 6522 2c20 226e 7622 3a31  ":"code", "nv":1
+0003e0a0: 2c20 2264 6174 6149 6d61 6765 223a 4e6f  , "dataImage":No
+0003e0b0: 6e65 2c20 2264 6973 7461 6e63 6554 7970  ne, "distanceTyp
+0003e0c0: 6522 3a5b 2263 6174 6567 6f72 6963 616c  e":["categorical
+0003e0d0: 225d 2c20 226f 7574 7075 7456 6172 466c  "], "outputVarFl
+0003e0e0: 6167 223a 4e6f 6e65 2c0d 0a20 2020 2020  ag":None,..     
+0003e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e100: 2020 2020 2278 7222 3a20 312c 2022 7972      "xr": 1, "yr
+0003e110: 223a 2031 2c20 227a 7222 3a20 312c 2022  ": 1, "zr": 1, "
+0003e120: 6d61 7873 6361 6e22 3a20 302e 3235 2c20  maxscan": 0.25, 
+0003e130: 226e 6569 6722 3a20 3234 2c20 2274 6872  "neig": 24, "thr
+0003e140: 6573 6822 3a20 302e 3035 2c20 2278 6c6f  esh": 0.05, "xlo
+0003e150: 6322 3a20 4661 6c73 652c 2022 796c 6f63  c": False, "yloc
+0003e160: 223a 2046 616c 7365 2c20 227a 6c6f 6322  ": False, "zloc"
+0003e170: 3a20 4661 6c73 652c 0d0a 2020 2020 2020  : False,..      
+0003e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e190: 2020 2022 686f 6d6f 5f75 7361 6765 223a     "homo_usage":
+0003e1a0: 2031 2c20 2272 6f74 5f75 7361 6765 223a   1, "rot_usage":
+0003e1b0: 2031 2c20 2272 6f74 417a 694c 6f63 223a   1, "rotAziLoc":
+0003e1c0: 2046 616c 7365 2c20 2272 6f74 417a 6922   False, "rotAzi"
+0003e1d0: 3a20 302c 2022 726f 7444 6970 4c6f 6322  : 0, "rotDipLoc"
+0003e1e0: 3a20 4661 6c73 652c 2022 726f 7444 6970  : False, "rotDip
+0003e1f0: 223a 2030 2c20 2272 6f74 506c 756e 6765  ": 0, "rotPlunge
+0003e200: 4c6f 6322 3a20 4661 6c73 652c 2022 726f  Loc": False, "ro
+0003e210: 7450 6c75 6e67 6522 3a20 302c 0d0a 2020  tPlunge": 0,..  
+0003e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e230: 2020 2020 2020 2022 617a 695f 746f 7022         "azi_top"
+0003e240: 3a22 6772 6164 6965 6e74 222c 2022 617a  :"gradient", "az
+0003e250: 695f 626f 7422 3a22 6772 6164 6965 6e74  i_bot":"gradient
+0003e260: 222c 2022 6469 705f 746f 7022 3a22 6772  ", "dip_top":"gr
+0003e270: 6164 6965 6e74 222c 2022 6469 705f 626f  adient", "dip_bo
+0003e280: 7422 3a22 6772 6164 6965 6e74 222c 0d0a  t":"gradient",..
+0003e290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2a0: 2020 2020 2020 2020 2022 7261 6469 7573           "radius
+0003e2b0: 4d6f 6465 223a 2022 6c61 7267 655f 6465  Mode": "large_de
+0003e2c0: 6661 756c 7422 2c20 2272 7822 3a20 6e78  fault", "rx": nx
+0003e2d0: 2a73 782c 2022 7279 223a 206e 792a 7379  *sx, "ry": ny*sy
+0003e2e0: 2c20 2272 7a22 3a20 6e7a 2a73 7a2c 2022  , "rz": nz*sz, "
+0003e2f0: 616e 6973 6f74 726f 7079 5261 7469 6f4d  anisotropyRatioM
+0003e300: 6f64 6522 3a20 226f 6e65 222c 2022 6178  ode": "one", "ax
+0003e310: 223a 2031 2c20 2261 7922 3a20 312c 2022  ": 1, "ay": 1, "
+0003e320: 617a 223a 2031 2c0d 0a20 2020 2020 2020  az": 1,..       
+0003e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e340: 2020 2261 6e67 6c65 3122 3a20 302c 2022    "angle1": 0, "
+0003e350: 616e 676c 6532 223a 2030 2c20 2261 6e67  angle2": 0, "ang
+0003e360: 6c65 3322 3a20 302c 0d0a 2020 2020 2020  le3": 0,..      
+0003e370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e380: 2020 2022 676c 6f62 616c 5064 6622 3a20     "globalPdf": 
+0003e390: 4e6f 6e65 2c20 226c 6f63 616c 5064 6622  None, "localPdf"
+0003e3a0: 3a20 4e6f 6e65 2c20 2270 726f 6261 5573  : None, "probaUs
+0003e3b0: 6167 6522 3a20 302c 2022 6c6f 6361 6c50  age": 0, "localP
+0003e3c0: 6466 5261 6469 7573 223a 2031 322e 2c20  dfRadius": 12., 
+0003e3d0: 2264 6561 6374 6976 6174 696f 6e44 6973  "deactivationDis
+0003e3e0: 7461 6e63 6522 3a20 342e 2c20 2263 6f6e  tance": 4., "con
+0003e3f0: 7374 616e 7454 6872 6573 686f 6c64 223a  stantThreshold":
+0003e400: 2031 652d 332c 2022 6e70 6f73 7422 3a31   1e-3, "npost":1
+0003e410: 7d0d 0a0d 0a20 2020 2020 2020 206b 7761  }....        kwa
+0003e420: 7267 735f 6465 665f 5450 4773 3d7b 226e  rgs_def_TPGs={"n
+0003e430: 6569 6722 3a20 3230 2c20 226e 6974 223a  eig": 20, "nit":
+0003e440: 2031 3030 2c20 2267 7266 5f6d 6574 686f   100, "grf_metho
+0003e450: 6422 3a20 2266 6674 227d 0d0a 0d0a 2020  d": "fft"}....  
+0003e460: 2020 2020 2020 6d65 7468 6f64 733d 5b22        methods=["
+0003e470: 5349 5322 2c20 224d 5053 222c 2022 5450  SIS", "MPS", "TP
+0003e480: 4773 222c 2022 5375 6250 696c 6522 5d0d  Gs", "SubPile"].
+0003e490: 0a20 2020 2020 2020 206b 7761 7267 735f  .        kwargs_
+0003e4a0: 6465 663d 5b6b 7761 7267 735f 6465 665f  def=[kwargs_def_
+0003e4b0: 5349 532c 206b 7761 7267 735f 6465 665f  SIS, kwargs_def_
+0003e4c0: 4d50 532c 206b 7761 7267 735f 6465 665f  MPS, kwargs_def_
+0003e4d0: 5450 4773 5d0d 0a0d 0a20 2020 2020 2020  TPGs]....       
+0003e4e0: 2066 6f72 2066 5f6d 6574 686f 642c 206b   for f_method, k
+0003e4f0: 7720 696e 207a 6970 286d 6574 686f 6473  w in zip(methods
+0003e500: 2c20 6b77 6172 6773 5f64 6566 293a 0d0a  , kwargs_def):..
+0003e510: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+0003e520: 6574 686f 6420 3d3d 2066 5f6d 6574 686f  ethod == f_metho
+0003e530: 643a 0d0a 2020 2020 2020 2020 2020 2020  d:..            
+0003e540: 2020 2020 6966 206c 656e 286b 7761 7267      if len(kwarg
+0003e550: 7329 203d 3d20 303a 0d0a 2020 2020 2020  s) == 0:..      
+0003e560: 2020 2020 2020 2020 2020 2020 2020 6b77                kw
+0003e570: 6172 6773 3d6b 770d 0a20 2020 2020 2020  args=kw..       
+0003e580: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0003e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e5a0: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
+0003e5b0: 6b77 2e69 7465 6d73 2829 3a0d 0a20 2020  kw.items():..   
+0003e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e5d0: 2020 2020 2069 6620 6b20 6e6f 7420 696e       if k not in
+0003e5e0: 206b 7761 7267 732e 6b65 7973 2829 3a0d   kwargs.keys():.
+0003e5f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e600: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+0003e610: 7267 735b 6b5d 3d76 0d0a 0d0a 2020 2020  rgs[k]=v....    
+0003e620: 2020 2020 2320 6c69 7374 206f 626a 6563      # list objec
+0003e630: 7473 0d0a 2020 2020 2020 2020 6966 206d  ts..        if m
+0003e640: 6f64 6520 3d3d 2022 6661 6369 6573 223a  ode == "facies":
+0003e650: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
+0003e660: 7374 5f6f 626a 203d 2073 656c 662e 6c69  st_obj = self.li
+0003e670: 7374 5f66 6163 6965 730d 0a20 2020 2020  st_facies..     
+0003e680: 2020 2065 6c69 6620 6d6f 6465 203d 3d20     elif mode == 
+0003e690: 2275 6e69 7473 223a 0d0a 2020 2020 2020  "units":..      
+0003e6a0: 2020 2020 2020 6c69 7374 5f6f 626a 203d        list_obj =
+0003e6b0: 2073 656c 662e 5375 6250 696c 652e 6c69   self.SubPile.li
+0003e6c0: 7374 5f75 6e69 7473 0d0a 0d0a 2020 2020  st_units....    
+0003e6d0: 2020 2020 2363 6865 636b 2069 6620 6f6e      #check if on
+0003e6e0: 6c79 2031 2066 6163 6965 7320 2d2d 3e20  ly 1 facies --> 
+0003e6f0: 686f 6d6f 6765 6e6f 7573 0d0a 2020 2020  homogenous..    
+0003e700: 2020 2020 6966 206c 656e 286c 6973 745f      if len(list_
+0003e710: 6f62 6a29 203c 2032 2061 6e64 206d 6574  obj) < 2 and met
+0003e720: 686f 6420 213d 2022 686f 6d6f 6765 6e6f  hod != "homogeno
+0003e730: 7573 223a 0d0a 2020 2020 2020 2020 2020  us":..          
+0003e740: 2020 6d65 7468 6f64 203d 2268 6f6d 6f67    method ="homog
+0003e750: 656e 6f75 7322 0d0a 2020 2020 2020 2020  enous"..        
+0003e760: 2020 2020 6966 2073 656c 662e 7665 7262      if self.verb
+0003e770: 6f73 653a 0d0a 2020 2020 2020 2020 2020  ose:..          
+0003e780: 2020 2020 2020 7072 696e 7428 2255 6e69        print("Uni
+0003e790: 7420 7b7d 2068 6173 206f 6e6c 7920 6f6e  t {} has only on
+0003e7a0: 6520 6661 6369 6573 2c20 6661 6369 6573  e facies, facies
+0003e7b0: 206d 6574 686f 6420 7365 7473 2074 6f20   method sets to 
+0003e7c0: 686f 6d6f 6765 6e6f 7573 222e 666f 726d  homogenous".form
+0003e7d0: 6174 2873 656c 662e 6e61 6d65 2929 0d0a  at(self.name))..
+0003e7e0: 0d0a 2020 2020 2020 2020 2323 2320 5369  ..        ### Si
+0003e7f0: 6d75 6c61 7469 6f6e 7320 2323 230d 0a20  mulations ###.. 
+0003e800: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0003e810: 2021 3d20 2253 7562 5069 6c65 2220 6f72   != "SubPile" or
+0003e820: 206d 6f64 6520 3d3d 2022 756e 6974 7322   mode == "units"
+0003e830: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+0003e840: 6f72 2069 7520 696e 2072 616e 6765 286e  or iu in range(n
+0003e850: 7265 616c 5f75 6e69 7473 293a 2023 206c  real_units): # l
+0003e860: 6f6f 7020 6f76 6572 2065 7869 7374 696e  oop over existin
+0003e870: 6720 7375 7266 6163 6573 0d0a 2020 2020  g surfaces..    
+0003e880: 2020 2020 2020 2020 2020 2020 6966 2041              if A
+0003e890: 7263 6854 6162 6c65 2e76 6572 626f 7365  rchTable.verbose
+0003e8a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003e8b0: 2020 2020 2020 2070 7269 6e74 2822 2323         print("##
+0003e8c0: 2320 556e 6974 207b 7d20 2d20 7265 616c  # Unit {} - real
+0003e8d0: 697a 6174 696f 6e20 7b7d 2023 2323 222e  ization {} ###".
+0003e8e0: 666f 726d 6174 2873 656c 662e 6e61 6d65  format(self.name
+0003e8f0: 2c20 6975 2929 0d0a 2020 2020 2020 2020  , iu))..        
+0003e900: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0003e910: 636f 6e74 6163 7420 3d3d 2022 6f6e 6c61  contact == "onla
+0003e920: 7022 3a0d 0a0d 0a20 2020 2020 2020 2020  p":....         
+0003e930: 2020 2020 2020 2020 2020 206d 6173 6b3d             mask=
+0003e940: 4172 6368 5461 626c 652e 6765 745f 756e  ArchTable.get_un
+0003e950: 6974 735f 646f 6d61 696e 735f 7265 616c  its_domains_real
+0003e960: 697a 6174 696f 6e73 2869 7529 203d 3d20  izations(iu) == 
+0003e970: 7365 6c66 2e49 440d 0a0d 0a20 2020 2020  self.ID....     
+0003e980: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0003e990: 2320 484f 4d4f 4745 4e4f 5553 2023 230d  # HOMOGENOUS ##.
+0003e9a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e9b0: 2020 2020 2069 6620 6d65 7468 6f64 2e6c       if method.l
+0003e9c0: 6f77 6572 2829 203d 3d20 2268 6f6d 6f67  ower() == "homog
+0003e9d0: 656e 6f75 7322 3a0d 0a0d 0a20 2020 2020  enous":....     
+0003e9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9f0: 2020 2069 6620 6c65 6e28 6c69 7374 5f6f     if len(list_o
+0003ea00: 626a 2920 3e20 313a 2023 206d 6f72 6520  bj) > 1: # more 
+0003ea10: 7468 616e 206f 6e65 0d0a 2020 2020 2020  than one..      
+0003ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea30: 2020 2020 2020 6966 2041 7263 6854 6162        if ArchTab
+0003ea40: 6c65 2e76 6572 626f 7365 3a0d 0a20 2020  le.verbose:..   
+0003ea50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea60: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0003ea70: 6e74 2822 5741 524e 494e 4720 2121 204d  nt("WARNING !! M
+0003ea80: 6f72 6520 7468 616e 206f 6e65 2066 6163  ore than one fac
+0003ea90: 6965 7320 6861 7320 6265 656e 2070 6173  ies has been pas
+0003eaa0: 7365 6420 746f 2068 6f6d 6f67 656e 6f75  sed to homogenou
+0003eab0: 7320 756e 6974 207b 7d5c 6e46 6972 7374  s unit {}\nFirst
+0003eac0: 2069 6e20 7468 6520 6c69 7374 2069 7320   in the list is 
+0003ead0: 7461 6b65 6e22 2e66 6f72 6d61 7428 7365  taken".format(se
+0003eae0: 6c66 2e6e 616d 6529 290d 0a20 2020 2020  lf.name))..     
+0003eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb00: 2020 2065 6c69 6620 6c65 6e28 6c69 7374     elif len(list
+0003eb10: 5f6f 626a 2920 3c20 313a 2023 206e 6f20  _obj) < 1: # no 
+0003eb20: 6661 6369 6573 2061 6464 6564 0d0a 2020  facies added..  
+0003eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0003eb50: 5661 6c75 6545 7272 6f72 2028 224e 6f20  ValueError ("No 
+0003eb60: 6661 6369 6573 2070 6173 7365 6420 746f  facies passed to
+0003eb70: 2068 6f6d 6f67 656e 6f75 7320 756e 6974   homogenous unit
+0003eb80: 207b 7d22 2e66 6f72 6d61 7428 7365 6c66   {}".format(self
+0003eb90: 2e6e 616d 6529 290d 0a0d 0a20 2020 2020  .name))....     
+0003eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ebb0: 2020 2023 2320 7365 7475 7020 6120 3344     ## setup a 3D
+0003ebc0: 2061 7272 6179 206f 6620 7468 6520 7369   array of the si
+0003ebd0: 6d75 6c61 7469 6f6e 2067 7269 6420 7369  mulation grid si
+0003ebe0: 7a65 2061 6e64 2061 7373 6967 6e20 6f6e  ze and assign on
+0003ebf0: 6520 6661 6369 6573 2074 6f20 7468 6520  e facies to the 
+0003ec00: 756e 6974 2323 230d 0a20 2020 2020 2020  unit###..       
 0003ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec20: 2020 2069 6620 6d6f 6465 203d 3d20 2266     if mode == "f
-0003ec30: 6163 6965 7322 3a0d 0a20 2020 2020 2020  acies":..       
-0003ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec50: 2020 2020 2068 642c 2066 6163 6965 7320       hd, facies 
-0003ec60: 3d20 4172 6368 5461 626c 652e 6864 5f66  = ArchTable.hd_f
-0003ec70: 615f 696e 5f75 6e69 7428 7365 6c66 2c20  a_in_unit(self, 
-0003ec80: 6975 3d69 7529 0d0a 2020 2020 2020 2020  iu=iu)..        
-0003ec90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eca0: 656c 6966 206d 6f64 6520 3d3d 2022 756e  elif mode == "un
-0003ecb0: 6974 7322 3a0d 0a20 2020 2020 2020 2020  its":..         
-0003ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ecd0: 2020 2068 642c 2066 6163 6965 7320 3d20     hd, facies = 
-0003ece0: 4172 6368 5461 626c 652e 6864 5f75 6e5f  ArchTable.hd_un_
-0003ecf0: 696e 5f75 6e69 7428 7365 6c66 2c20 6975  in_unit(self, iu
-0003ed00: 3d69 7529 0d0a 0d0a 2020 2020 2020 2020  =iu)....        
-0003ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed20: 6361 745f 7661 6c75 6573 3d5b 692e 4944  cat_values=[i.ID
-0003ed30: 2066 6f72 2069 2069 6e20 6c69 7374 5f6f   for i in list_o
-0003ed40: 626a 5d20 2023 2049 4420 7661 6c75 6573  bj]  # ID values
-0003ed50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ed60: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
-0003ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed80: 2020 2020 6864 3d6e 702e 6172 7261 7928      hd=np.array(
-0003ed90: 6864 290d 0a20 2020 2020 2020 2020 2020  hd)..           
-0003eda0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003edb0: 6965 733d 6e70 2e61 7272 6179 2866 6163  ies=np.array(fac
-0003edc0: 6965 7329 0d0a 2020 2020 2020 2020 2020  ies)..          
-0003edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ede0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-0003edf0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-0003ee00: 6f72 6965 6e74 6174 696f 6e20 6d61 7020  orientation map 
-0003ee10: 2323 2320 202d 3e20 746f 206d 6f64 6966  ###  -> to modif
-0003ee20: 7920 2121 2121 0d0a 2020 2020 2020 2020  y !!!!..        
+0003ec20: 2066 6163 6965 733d 6c69 7374 5f6f 626a   facies=list_obj
+0003ec30: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+0003ec40: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003ec50: 2069 7265 616c 2069 6e20 7261 6e67 6528   ireal in range(
+0003ec60: 6e72 6561 6c29 3a0d 0a20 2020 2020 2020  nreal):..       
+0003ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec80: 2020 2020 2066 6163 6965 735f 646f 6d61       facies_doma
+0003ec90: 696e 735b 6975 2c20 6972 6561 6c5d 5b6d  ins[iu, ireal][m
+0003eca0: 6173 6b5d 3d66 6163 6965 732e 4944 0d0a  ask]=facies.ID..
+0003ecb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ecc0: 2020 2020 2020 2323 2053 4953 2023 230d        ## SIS ##.
+0003ecd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ece0: 2020 2020 2065 6c69 6620 6d65 7468 6f64       elif method
+0003ecf0: 2e75 7070 6572 2829 203d 3d20 2253 4953  .upper() == "SIS
+0003ed00: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
+0003ed10: 2020 2020 2020 2020 2020 2020 2323 2073              ## s
+0003ed20: 6574 7570 2053 4953 2023 230d 0a0d 0a20  etup SIS ##.... 
+0003ed30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed40: 2020 2020 2020 2069 6620 6d6f 6465 203d         if mode =
+0003ed50: 3d20 2266 6163 6965 7322 3a0d 0a20 2020  = "facies":..   
+0003ed60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed70: 2020 2020 2020 2020 2068 642c 2066 6163           hd, fac
+0003ed80: 6965 7320 3d20 4172 6368 5461 626c 652e  ies = ArchTable.
+0003ed90: 6864 5f66 615f 696e 5f75 6e69 7428 7365  hd_fa_in_unit(se
+0003eda0: 6c66 2c20 6975 3d69 7529 0d0a 2020 2020  lf, iu=iu)..    
+0003edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edc0: 2020 2020 656c 6966 206d 6f64 6520 3d3d      elif mode ==
+0003edd0: 2022 756e 6974 7322 3a0d 0a20 2020 2020   "units":..     
+0003ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edf0: 2020 2020 2020 2068 642c 2066 6163 6965         hd, facie
+0003ee00: 7320 3d20 4172 6368 5461 626c 652e 6864  s = ArchTable.hd
+0003ee10: 5f75 6e5f 696e 5f75 6e69 7428 7365 6c66  _un_in_unit(self
+0003ee20: 2c20 6975 3d69 7529 0d0a 0d0a 2020 2020  , iu=iu)....    
 0003ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee40: 6966 2028 6b77 6172 6773 5b22 5349 535f  if (kwargs["SIS_
-0003ee50: 6f72 6965 6e74 6174 696f 6e22 5d29 203d  orientation"]) =
-0003ee60: 3d20 2266 6f6c 6c6f 775f 7375 7266 6163  = "follow_surfac
-0003ee70: 6573 223a 2023 2069 6620 6f72 6965 6e74  es": # if orient
-0003ee80: 6174 696f 6e73 206d 7573 7420 666f 6c6c  ations must foll
-0003ee90: 6f77 2073 7572 6661 6365 730d 0a20 2020  ow surfaces..   
-0003eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eeb0: 2020 2020 2020 2020 2023 2057 6172 6e69           # Warni
-0003eec0: 6e67 3a20 5468 6973 206f 7074 696f 6e20  ng: This option 
-0003eed0: 6368 616e 6765 7320 616c 7068 6120 616e  changes alpha an
-0003eee0: 6420 6265 7461 2061 6e67 6c65 7320 6173  d beta angles as
-0003eef0: 7375 6d69 6e67 2074 6861 7420 727a 2069  suming that rz i
-0003ef00: 7320 736d 616c 6c65 7220 7468 616e 2072  s smaller than r
-0003ef10: 7820 616e 6420 7279 2e20 4d6f 7265 6f76  x and ry. Moreov
-0003ef20: 6572 2c20 7278 2061 6e64 2072 7920 6d75  er, rx and ry mu
-0003ef30: 7374 2062 6520 7369 6d69 6c61 722e 0d0a  st be similar...
-0003ef40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ef50: 2020 2020 2020 2020 2020 2020 2020 617a                az
-0003ef60: 692c 6469 703d 4172 6368 5461 626c 652e  i,dip=ArchTable.
-0003ef70: 6f72 6965 6e74 6174 696f 6e5f 6d61 7028  orientation_map(
-0003ef80: 7365 6c66 2c20 736d 6f6f 7468 3d35 290d  self, smooth=5).
-0003ef90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003efa0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003efb0: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003efc0: 5f66 5f63 6f76 6d6f 6465 6c3a 2023 2069  _f_covmodel: # i
-0003efd0: 7465 7261 7465 2074 6872 6f75 6768 2061  terate through a
-0003efe0: 6c6c 2066 6163 6965 7320 636f 766d 6f64  ll facies covmod
-0003eff0: 656c 7320 616e 6420 6368 616e 6765 2061  els and change a
-0003f000: 6e67 6c65 730d 0a20 2020 2020 2020 2020  ngles..         
-0003f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f020: 2020 2020 2020 2063 6d2e 616c 7068 613d         cm.alpha=
-0003f030: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
-0003f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f050: 2020 2020 2063 6d2e 6265 7461 3d64 6970       cm.beta=dip
-0003f060: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003f070: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0003f080: 206b 7761 7267 735b 2253 4953 5f6f 7269   kwargs["SIS_ori
-0003f090: 656e 7461 7469 6f6e 225d 3a20 2320 6966  entation"]: # if
-0003f0a0: 2073 6574 2054 7275 652c 2063 6861 6e67   set True, chang
-0003f0b0: 6520 616e 676c 6573 2077 6974 6820 696e  e angles with in
-0003f0c0: 7075 7473 2061 6e67 6c65 730d 0a20 2020  puts angles..   
-0003f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f0e0: 2020 2020 2020 2020 2061 6c3d 6b77 6172           al=kwar
-0003f0f0: 6773 5b22 616c 7068 6122 5d0d 0a20 2020  gs["alpha"]..   
-0003f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f110: 2020 2020 2020 2020 2062 653d 6b77 6172           be=kwar
-0003f120: 6773 5b22 6265 7461 225d 0d0a 2020 2020  gs["beta"]..    
-0003f130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f140: 2020 2020 2020 2020 6761 3d6b 7761 7267          ga=kwarg
-0003f150: 735b 2267 616d 6d61 225d 0d0a 2020 2020  s["gamma"]..    
-0003f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f170: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
-0003f180: 616c 2920 6973 206c 6973 7420 616e 6420  al) is list and 
-0003f190: 7479 7065 2862 6529 2069 7320 6c69 7374  type(be) is list
-0003f1a0: 2061 6e64 2074 7970 6528 6761 2920 6973   and type(ga) is
-0003f1b0: 206c 6973 743a 0d0a 2020 2020 2020 2020   list:..        
-0003f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f1d0: 2020 2020 2369 6620 6861 7361 7474 7228      #if hasattr(
-0003f1e0: 616c 2c22 5f5f 6974 6572 5f5f 2229 2061  al,"__iter__") a
-0003f1f0: 6e64 2068 6173 6174 7472 2862 652c 225f  nd hasattr(be,"_
-0003f200: 5f69 7465 725f 5f22 2920 616e 6420 6861  _iter__") and ha
-0003f210: 7361 7474 7228 6761 2c22 5f5f 6974 6572  sattr(ga,"__iter
-0003f220: 5f5f 2229 3a20 2369 6620 6120 6c69 7374  __"): #if a list
-0003f230: 2069 7320 6769 7665 6e0d 0a20 2020 2020   is given..     
+0003ee40: 2020 2020 6864 203d 206e 702e 6172 7261      hd = np.arra
+0003ee50: 7928 6864 290d 0a20 2020 2020 2020 2020  y(hd)..         
+0003ee60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003ee70: 6163 6965 7320 3d20 6e70 2e61 7272 6179  acies = np.array
+0003ee80: 2866 6163 6965 7329 0d0a 0d0a 2020 2020  (facies)....    
+0003ee90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eea0: 2020 2020 6361 745f 7661 6c75 6573 3d5b      cat_values=[
+0003eeb0: 692e 4944 2066 6f72 2069 2069 6e20 6c69  i.ID for i in li
+0003eec0: 7374 5f6f 626a 5d20 2023 2049 4420 7661  st_obj]  # ID va
+0003eed0: 6c75 6573 0d0a 2020 2020 2020 2020 2020  lues..          
+0003eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eef0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0003ef00: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0003ef10: 6f72 6965 6e74 6174 696f 6e20 6d61 7020  orientation map 
+0003ef20: 2323 2320 202d 3e20 746f 206d 6f64 6966  ###  -> to modif
+0003ef30: 7920 2121 2121 0d0a 2020 2020 2020 2020  y !!!!..        
+0003ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef50: 6966 2028 6b77 6172 6773 5b22 5349 535f  if (kwargs["SIS_
+0003ef60: 6f72 6965 6e74 6174 696f 6e22 5d29 203d  orientation"]) =
+0003ef70: 3d20 2266 6f6c 6c6f 775f 7375 7266 6163  = "follow_surfac
+0003ef80: 6573 223a 2023 2069 6620 6f72 6965 6e74  es": # if orient
+0003ef90: 6174 696f 6e73 206d 7573 7420 666f 6c6c  ations must foll
+0003efa0: 6f77 2073 7572 6661 6365 730d 0a20 2020  ow surfaces..   
+0003efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003efc0: 2020 2020 2020 2020 2023 2057 6172 6e69           # Warni
+0003efd0: 6e67 3a20 5468 6973 206f 7074 696f 6e20  ng: This option 
+0003efe0: 6368 616e 6765 7320 616c 7068 6120 616e  changes alpha an
+0003eff0: 6420 6265 7461 2061 6e67 6c65 7320 6173  d beta angles as
+0003f000: 7375 6d69 6e67 2074 6861 7420 727a 2069  suming that rz i
+0003f010: 7320 736d 616c 6c65 7220 7468 616e 2072  s smaller than r
+0003f020: 7820 616e 6420 7279 2e20 4d6f 7265 6f76  x and ry. Moreov
+0003f030: 6572 2c20 7278 2061 6e64 2072 7920 6d75  er, rx and ry mu
+0003f040: 7374 2062 6520 7369 6d69 6c61 722e 0d0a  st be similar...
+0003f050: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f060: 2020 2020 2020 2020 2020 2020 2020 617a                az
+0003f070: 692c 6469 703d 4172 6368 5461 626c 652e  i,dip=ArchTable.
+0003f080: 6f72 6965 6e74 6174 696f 6e5f 6d61 7028  orientation_map(
+0003f090: 7365 6c66 2c20 736d 6f6f 7468 3d35 290d  self, smooth=5).
+0003f0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f0b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003f0c0: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003f0d0: 5f66 5f63 6f76 6d6f 6465 6c3a 2023 2069  _f_covmodel: # i
+0003f0e0: 7465 7261 7465 2074 6872 6f75 6768 2061  terate through a
+0003f0f0: 6c6c 2066 6163 6965 7320 636f 766d 6f64  ll facies covmod
+0003f100: 656c 7320 616e 6420 6368 616e 6765 2061  els and change a
+0003f110: 6e67 6c65 730d 0a20 2020 2020 2020 2020  ngles..         
+0003f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f130: 2020 2020 2020 2063 6d2e 616c 7068 613d         cm.alpha=
+0003f140: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
+0003f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f160: 2020 2020 2063 6d2e 6265 7461 3d64 6970       cm.beta=dip
+0003f170: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003f180: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+0003f190: 206b 7761 7267 735b 2253 4953 5f6f 7269   kwargs["SIS_ori
+0003f1a0: 656e 7461 7469 6f6e 225d 3a20 2320 6966  entation"]: # if
+0003f1b0: 2073 6574 2054 7275 652c 2063 6861 6e67   set True, chang
+0003f1c0: 6520 616e 676c 6573 2077 6974 6820 696e  e angles with in
+0003f1d0: 7075 7473 2061 6e67 6c65 730d 0a20 2020  puts angles..   
+0003f1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f1f0: 2020 2020 2020 2020 2061 6c3d 6b77 6172           al=kwar
+0003f200: 6773 5b22 616c 7068 6122 5d0d 0a20 2020  gs["alpha"]..   
+0003f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f220: 2020 2020 2020 2020 2062 653d 6b77 6172           be=kwar
+0003f230: 6773 5b22 6265 7461 225d 0d0a 2020 2020  gs["beta"]..    
 0003f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f250: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-0003f260: 7420 6c65 6e28 616c 2920 3d3d 206c 656e  t len(al) == len
-0003f270: 2862 6529 203d 3d20 6c65 6e28 6761 292c  (be) == len(ga),
-0003f280: 2022 4572 726f 723a 206e 756d 6265 7220   "Error: number 
-0003f290: 6f66 2067 6976 656e 2076 616c 7565 732f  of given values/
-0003f2a0: 6172 7261 7973 2069 6e20 616c 7068 612c  arrays in alpha,
-0003f2b0: 2062 6574 6120 616e 6420 6761 6d6d 6120   beta and gamma 
-0003f2c0: 6d75 7374 2062 6520 7468 6520 7361 6d65  must be the same
-0003f2d0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-0003f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2f0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0003f300: 6528 6c65 6e28 616c 2929 3a20 2320 6c6f  e(len(al)): # lo
-0003f310: 6f70 206f 7665 720d 0a20 2020 2020 2020  op over..       
-0003f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f330: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003f340: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003f350: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
-0003f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f380: 2020 2020 2020 2020 2020 636d 2e61 6c70            cm.alp
-0003f390: 6861 3d61 6c5b 695d 0d0a 2020 2020 2020  ha=al[i]..      
-0003f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3c0: 2020 2020 2020 636d 2e62 6574 613d 6265        cm.beta=be
-0003f3d0: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-0003f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f250: 2020 2020 2020 2020 6761 3d6b 7761 7267          ga=kwarg
+0003f260: 735b 2267 616d 6d61 225d 0d0a 2020 2020  s["gamma"]..    
+0003f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f280: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+0003f290: 616c 2920 6973 206c 6973 7420 616e 6420  al) is list and 
+0003f2a0: 7479 7065 2862 6529 2069 7320 6c69 7374  type(be) is list
+0003f2b0: 2061 6e64 2074 7970 6528 6761 2920 6973   and type(ga) is
+0003f2c0: 206c 6973 743a 0d0a 2020 2020 2020 2020   list:..        
+0003f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f2e0: 2020 2020 2369 6620 6861 7361 7474 7228      #if hasattr(
+0003f2f0: 616c 2c22 5f5f 6974 6572 5f5f 2229 2061  al,"__iter__") a
+0003f300: 6e64 2068 6173 6174 7472 2862 652c 225f  nd hasattr(be,"_
+0003f310: 5f69 7465 725f 5f22 2920 616e 6420 6861  _iter__") and ha
+0003f320: 7361 7474 7228 6761 2c22 5f5f 6974 6572  sattr(ga,"__iter
+0003f330: 5f5f 2229 3a20 2369 6620 6120 6c69 7374  __"): #if a list
+0003f340: 2069 7320 6769 7665 6e0d 0a20 2020 2020   is given..     
+0003f350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f360: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0003f370: 7420 6c65 6e28 616c 2920 3d3d 206c 656e  t len(al) == len
+0003f380: 2862 6529 203d 3d20 6c65 6e28 6761 292c  (be) == len(ga),
+0003f390: 2022 4572 726f 723a 206e 756d 6265 7220   "Error: number 
+0003f3a0: 6f66 2067 6976 656e 2076 616c 7565 732f  of given values/
+0003f3b0: 6172 7261 7973 2069 6e20 616c 7068 612c  arrays in alpha,
+0003f3c0: 2062 6574 6120 616e 6420 6761 6d6d 6120   beta and gamma 
+0003f3d0: 6d75 7374 2062 6520 7468 6520 7361 6d65  must be the same
+0003f3e0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
 0003f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f400: 2063 6d2e 6761 6d6d 613d 6761 5b69 5d0d   cm.gamma=ga[i].
-0003f410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f420: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0003f430: 653a 2023 2069 6620 6f6e 6c79 2061 206e  e: # if only a n
-0003f440: 6461 7272 6179 206f 7220 6120 7661 6c75  darray or a valu
-0003f450: 6520 6172 6520 6769 7665 6e0d 0a20 2020  e are given..   
-0003f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f470: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003f480: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
-0003f490: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
-0003f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f400: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0003f410: 6528 6c65 6e28 616c 2929 3a20 2320 6c6f  e(len(al)): # lo
+0003f420: 6f70 206f 7665 720d 0a20 2020 2020 2020  op over..       
+0003f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f440: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003f450: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003f460: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
+0003f470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f490: 2020 2020 2020 2020 2020 636d 2e61 6c70            cm.alp
+0003f4a0: 6861 3d61 6c5b 695d 0d0a 2020 2020 2020  ha=al[i]..      
 0003f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f4c0: 2020 636d 2e61 6c70 6861 3d61 6c0d 0a20    cm.alpha=al.. 
-0003f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f4f0: 2020 2063 6d2e 6265 7461 3d62 650d 0a20     cm.beta=be.. 
+0003f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4d0: 2020 2020 2020 636d 2e62 6574 613d 6265        cm.beta=be
+0003f4e0: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
+0003f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f520: 2020 2063 6d2e 6761 6d6d 613d 6761 0d0a     cm.gamma=ga..
-0003f530: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003f540: 2020 2020 2020 2020 2020 2020 234d 6f64              #Mod
-0003f550: 6966 7920 7369 6c6c 206f 6620 636f 766d  ify sill of covm
-0003f560: 6f64 656c 2069 6620 7468 6572 6520 6973  odel if there is
-0003f570: 206f 6e6c 7920 6f6e 650d 0a20 2020 2020   only one..     
-0003f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f590: 2020 2069 6620 6c65 6e28 7365 6c66 2e6c     if len(self.l
-0003f5a0: 6973 745f 665f 636f 766d 6f64 656c 2920  ist_f_covmodel) 
-0003f5b0: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+0003f510: 2063 6d2e 6761 6d6d 613d 6761 5b69 5d0d   cm.gamma=ga[i].
+0003f520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f530: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0003f540: 653a 2023 2069 6620 6f6e 6c79 2061 206e  e: # if only a n
+0003f550: 6461 7272 6179 206f 7220 6120 7661 6c75  darray or a valu
+0003f560: 6520 6172 6520 6769 7665 6e0d 0a20 2020  e are given..   
+0003f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f580: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003f590: 2063 6d20 696e 2073 656c 662e 6c69 7374   cm in self.list
+0003f5a0: 5f66 5f63 6f76 6d6f 6465 6c3a 0d0a 2020  _f_covmodel:..  
+0003f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f5d0: 2020 2069 6620 4172 6368 5461 626c 652e     if ArchTable.
-0003f5e0: 7665 7262 6f73 653a 0d0a 2020 2020 2020  verbose:..      
+0003f5d0: 2020 636d 2e61 6c70 6861 3d61 6c0d 0a20    cm.alpha=al.. 
+0003f5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f600: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0003f610: 224f 6e6c 7920 6f6e 6520 6661 6369 6573  "Only one facies
-0003f620: 2063 6f76 6d6f 6465 6c73 2066 6f72 206d   covmodels for m
-0003f630: 756c 7469 706c 6573 2066 6163 6965 732c  ultiples facies,
-0003f640: 2061 6461 7074 2073 696c 6c20 746f 2072   adapt sill to r
-0003f650: 6967 6874 2070 726f 706f 7274 696f 6e73  ight proportions
-0003f660: 2229 0d0a 0d0a 2020 2020 2020 2020 2020  ")....          
-0003f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f680: 2020 636d 3d73 656c 662e 6c69 7374 5f66    cm=self.list_f
-0003f690: 5f63 6f76 6d6f 6465 6c5b 305d 0d0a 0d0a  _covmodel[0]....
-0003f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6b0: 2020 2020 2020 2020 2020 2020 7369 6c6c              sill
-0003f6c0: 3d63 6d2e 7369 6c6c 2829 2023 6765 7420  =cm.sill() #get 
-0003f6d0: 7369 6c6c 0d0a 0d0a 2020 2020 2020 2020  sill....        
-0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6f0: 2020 2020 7365 6c66 2e6c 6973 745f 665f      self.list_f_
-0003f700: 636f 766d 6f64 656c 3d5b 5d20 2372 6573  covmodel=[] #res
-0003f710: 6574 206c 6973 740d 0a0d 0a20 2020 2020  et list....     
-0003f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f730: 2020 2020 2020 2069 6661 3d30 0d0a 2020         ifa=0..  
-0003f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f750: 2020 2020 2020 2020 2020 666f 7220 6661            for fa
-0003f760: 2069 6e20 6c69 7374 5f6f 626a 3a20 236c   in list_obj: #l
-0003f770: 6f6f 7020 6f76 6572 2066 6163 6965 730d  oop over facies.
-0003f780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
-0003f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7c0: 2020 2063 6d5f 636f 7079 3d63 6f70 792e     cm_copy=copy.
-0003f7d0: 6465 6570 636f 7079 2863 6d29 2023 6d61  deepcopy(cm) #ma
-0003f7e0: 6b65 2061 2063 6f70 790d 0a0d 0a20 2020  ke a copy....   
+0003f600: 2020 2063 6d2e 6265 7461 3d62 650d 0a20     cm.beta=be.. 
+0003f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f630: 2020 2063 6d2e 6761 6d6d 613d 6761 0d0a     cm.gamma=ga..
+0003f640: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+0003f650: 2020 2020 2020 2020 2020 2020 2320 4d6f              # Mo
+0003f660: 6469 6679 2073 696c 6c20 6f66 2063 6f76  dify sill of cov
+0003f670: 6d6f 6465 6c20 6966 2074 6865 7265 2069  model if there i
+0003f680: 7320 6f6e 6c79 206f 6e65 0d0a 2020 2020  s only one..    
+0003f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6a0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+0003f6b0: 6c69 7374 5f66 5f63 6f76 6d6f 6465 6c29  list_f_covmodel)
+0003f6c0: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
+0003f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6e0: 2020 2020 6966 2041 7263 6854 6162 6c65      if ArchTable
+0003f6f0: 2e76 6572 626f 7365 3a0d 0a20 2020 2020  .verbose:..     
+0003f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f710: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0003f720: 2822 4f6e 6c79 206f 6e65 2066 6163 6965  ("Only one facie
+0003f730: 7320 636f 766d 6f64 656c 7320 666f 7220  s covmodels for 
+0003f740: 6d75 6c74 6970 6c65 7320 6661 6369 6573  multiples facies
+0003f750: 2c20 6164 6170 7420 7369 6c6c 2074 6f20  , adapt sill to 
+0003f760: 7269 6768 7420 7072 6f70 6f72 7469 6f6e  right proportion
+0003f770: 7322 290d 0a0d 0a20 2020 2020 2020 2020  s")....         
+0003f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f790: 2020 2063 6d3d 7365 6c66 2e6c 6973 745f     cm=self.list_
+0003f7a0: 665f 636f 766d 6f64 656c 5b30 5d0d 0a0d  f_covmodel[0]...
+0003f7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f7c0: 2020 2020 2020 2020 2020 2020 2073 696c               sil
+0003f7d0: 6c3d 636d 2e73 696c 6c28 2920 2367 6574  l=cm.sill() #get
+0003f7e0: 2073 696c 6c0d 0a0d 0a20 2020 2020 2020   sill....       
 0003f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f800: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0003f810: 2270 726f 6261 6269 6c69 7479 2220 696e  "probability" in
-0003f820: 206b 7761 7267 732e 6b65 7973 2829 3a0d   kwargs.keys():.
-0003f830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f850: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
-0003f860: 7072 6f62 6162 696c 6974 7922 5d20 6973  probability"] is
-0003f870: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
-0003f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8a0: 2020 2020 7020 3d20 6b77 6172 6773 5b22      p = kwargs["
-0003f8b0: 7072 6f62 6162 696c 6974 7922 5d5b 6966  probability"][if
-0003f8c0: 615d 0d0a 2020 2020 2020 2020 2020 2020  a]..            
-0003f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0003f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f800: 2020 2020 2073 656c 662e 6c69 7374 5f66       self.list_f
+0003f810: 5f63 6f76 6d6f 6465 6c3d 5b5d 2023 7265  _covmodel=[] #re
+0003f820: 7365 7420 6c69 7374 0d0a 0d0a 2020 2020  set list....    
+0003f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f840: 2020 2020 2020 2020 6966 613d 300d 0a20          ifa=0.. 
+0003f850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f860: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
+0003f870: 6120 696e 206c 6973 745f 6f62 6a3a 2023  a in list_obj: #
+0003f880: 6c6f 6f70 206f 7665 7220 6661 6369 6573  loop over facies
+0003f890: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8b0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0003f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8d0: 2020 2020 636d 5f63 6f70 793d 636f 7079      cm_copy=copy
+0003f8e0: 2e64 6565 7063 6f70 7928 636d 2920 236d  .deepcopy(cm) #m
+0003f8f0: 616b 6520 6120 636f 7079 0d0a 0d0a 2020  ake a copy....  
 0003f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f910: 2020 2020 2020 2070 3d6e 702e 7375 6d28         p=np.sum(
-0003f920: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
-0003f930: 2f6c 656e 2866 6163 6965 7320 3d3d 2066  /len(facies == f
-0003f940: 612e 4944 2920 2363 616c 6375 6c61 7465  a.ID) #calculate
-0003f950: 2070 726f 706f 7274 696f 6e20 6f66 2066   proportion of f
-0003f960: 6163 6965 730d 0a20 2020 2020 2020 2020  acies..         
-0003f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f980: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003f910: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003f920: 206c 656e 2868 6429 203e 2030 3a0d 0a0d   len(hd) > 0:...
+0003f930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f950: 2020 2020 2069 6620 2270 726f 6261 6269       if "probabi
+0003f960: 6c69 7479 2220 696e 206b 7761 7267 732e  lity" in kwargs.
+0003f970: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+0003f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9b0: 2020 703d 6e70 2e73 756d 2866 6163 6965    p=np.sum(facie
-0003f9c0: 7320 3d3d 2066 612e 4944 292f 6c65 6e28  s == fa.ID)/len(
-0003f9d0: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
-0003f9e0: 2023 6361 6c63 756c 6174 6520 7072 6f70   #calculate prop
-0003f9f0: 6f72 7469 6f6e 206f 6620 6661 6369 6573  ortion of facies
-0003fa00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-0003fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa20: 2020 2020 6966 2070 203e 2030 3a0d 0a20      if p > 0:.. 
-0003fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa50: 2020 2076 6172 3d70 2a28 312d 7029 2023     var=p*(1-p) #
-0003fa60: 7661 7269 616e 6365 0d0a 2020 2020 2020  variance..      
-0003fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa80: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0003fa90: 7469 6f3d 7661 722f 7369 6c6c 2020 2372  tio=var/sill  #r
-0003faa0: 6174 696f 2062 7477 2063 6f76 6d6f 6465  atio btw covmode
-0003fab0: 6c20 616e 6420 7265 616c 2076 6172 6961  l and real varia
-0003fac0: 6e63 650d 0a0d 0a20 2020 2020 2020 2020  nce....         
+0003f9a0: 2069 6620 6b77 6172 6773 5b22 7072 6f62   if kwargs["prob
+0003f9b0: 6162 696c 6974 7922 5d20 6973 206e 6f74  ability"] is not
+0003f9c0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0003f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f9f0: 2020 2020 7020 3d20 6b77 6172 6773 5b22      p = kwargs["
+0003fa00: 7072 6f62 6162 696c 6974 7922 5d5b 6966  probability"][if
+0003fa10: 615d 0d0a 2020 2020 2020 2020 2020 2020  a]..            
+0003fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa30: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003fa40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0003fa70: 3d6e 702e 7375 6d28 6661 6369 6573 203d  =np.sum(facies =
+0003fa80: 3d20 6661 2e49 4429 2f6c 656e 2866 6163  = fa.ID)/len(fac
+0003fa90: 6965 7320 3d3d 2066 612e 4944 2920 2363  ies == fa.ID) #c
+0003faa0: 616c 6375 6c61 7465 2070 726f 706f 7274  alculate proport
+0003fab0: 696f 6e20 6f66 2066 6163 6965 730d 0a20  ion of facies.. 
+0003fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fae0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0003faf0: 2069 6e20 636d 5f63 6f70 792e 656c 656d   in cm_copy.elem
-0003fb00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb20: 2020 2020 2020 2020 2020 2065 5b31 5d5b             e[1][
-0003fb30: 2277 225d 202a 3d20 7261 7469 6f0d 0a20  "w"] *= ratio.. 
-0003fb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003fb60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0003fae0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0003faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fb10: 2020 703d 6e70 2e73 756d 2866 6163 6965    p=np.sum(facie
+0003fb20: 7320 3d3d 2066 612e 4944 292f 6c65 6e28  s == fa.ID)/len(
+0003fb30: 6661 6369 6573 203d 3d20 6661 2e49 4429  facies == fa.ID)
+0003fb40: 2023 6361 6c63 756c 6174 6520 7072 6f70   #calculate prop
+0003fb50: 6f72 7469 6f6e 206f 6620 6661 6369 6573  ortion of facies
+0003fb60: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
 0003fb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb80: 2020 2020 2020 2020 2020 666f 7220 6520            for e 
-0003fb90: 696e 2063 6d5f 636f 7079 2e65 6c65 6d3a  in cm_copy.elem:
-0003fba0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003fbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fbc0: 2020 2020 2020 2020 2020 655b 315d 5b22            e[1]["
-0003fbd0: 7722 5d20 2a3d 2031 0d0a 2020 2020 2020  w"] *= 1..      
+0003fb80: 2020 2020 2020 2020 6966 2070 203e 2030          if p > 0
+0003fb90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbb0: 2020 2020 2020 2020 2020 2076 6172 3d70             var=p
+0003fbc0: 2a28 312d 7029 2023 7661 7269 616e 6365  *(1-p) #variance
+0003fbd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 0003fbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fbf0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
-0003fc00: 6973 745f 665f 636f 766d 6f64 656c 2e61  ist_f_covmodel.a
-0003fc10: 7070 656e 6428 636d 5f63 6f70 7929 0d0a  ppend(cm_copy)..
-0003fc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc40: 6966 6120 2b3d 2031 0d0a 0d0a 2020 2020  ifa += 1....    
-0003fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc60: 2020 2020 2323 2053 696d 756c 6174 696f      ## Simulatio
-0003fc70: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-0003fc80: 2020 2020 2020 2020 2020 2073 696d 7573             simus
-0003fc90: 203d 2067 6369 2e73 696d 756c 6174 6549   = gci.simulateI
-0003fca0: 6e64 6963 6174 6f72 3344 2863 6174 5f76  ndicator3D(cat_v
-0003fcb0: 616c 7565 732c 2073 656c 662e 6c69 7374  alues, self.list
-0003fcc0: 5f66 5f63 6f76 6d6f 6465 6c2c 2064 696d  _f_covmodel, dim
-0003fcd0: 656e 7369 6f6e 732c 2073 7061 6369 6e67  ensions, spacing
-0003fce0: 2c20 6f72 6967 696e 2c0d 0a20 2020 2020  , origin,..     
+0003fbf0: 2020 2020 2020 2020 2020 7261 7469 6f3d            ratio=
+0003fc00: 7661 722f 7369 6c6c 2020 2372 6174 696f  var/sill  #ratio
+0003fc10: 2062 7477 2063 6f76 6d6f 6465 6c20 616e   btw covmodel an
+0003fc20: 6420 7265 616c 2076 6172 6961 6e63 650d  d real variance.
+0003fc30: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+0003fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc50: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0003fc60: 2069 6e20 636d 5f63 6f70 792e 656c 656d   in cm_copy.elem
+0003fc70: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0003fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003fca0: 5b31 5d5b 2277 225d 202a 3d20 7261 7469  [1]["w"] *= rati
+0003fcb0: 6f0d 0a20 2020 2020 2020 2020 2020 2020  o..             
+0003fcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fcd0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0003fce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003fcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd20: 2020 206e 7265 616c 3d6e 7265 616c 2c20     nreal=nreal, 
-0003fd30: 6d65 7468 6f64 3d22 7369 6d70 6c65 5f6b  method="simple_k
-0003fd40: 7269 6769 6e67 222c 2078 3d68 642c 2076  riging", x=hd, v
-0003fd50: 3d66 6163 6965 732c 206d 6173 6b3d 6d61  =facies, mask=ma
-0003fd60: 736b 2c0d 0a20 2020 2020 2020 2020 2020  sk,..           
-0003fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd90: 2020 2020 2020 2020 2020 2020 2073 6561               sea
-0003fda0: 7263 6852 6164 6975 7352 656c 6174 6976  rchRadiusRelativ
-0003fdb0: 653d 6b77 6172 6773 5b22 7222 5d2c 206e  e=kwargs["r"], n
-0003fdc0: 6e65 6967 6862 6f72 4d61 783d 6b77 6172  neighborMax=kwar
-0003fdd0: 6773 5b22 6e65 6967 225d 2c0d 0a20 2020  gs["neig"],..   
-0003fde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd00: 2020 2020 2020 666f 7220 6520 696e 2063        for e in c
+0003fd10: 6d5f 636f 7079 2e65 6c65 6d3a 0d0a 2020  m_copy.elem:..  
+0003fd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd40: 2020 2020 2020 2020 2020 655b 315d 5b22            e[1]["
+0003fd50: 7722 5d20 2a3d 2031 0d0a 0d0a 2020 2020  w"] *= 1....    
+0003fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0003fd80: 2e6c 6973 745f 665f 636f 766d 6f64 656c  .list_f_covmodel
+0003fd90: 2e61 7070 656e 6428 636d 5f63 6f70 7929  .append(cm_copy)
+0003fda0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fdc0: 2020 6966 6120 2b3d 2031 0d0a 0d0a 2020    ifa += 1....  
+0003fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fde0: 2020 2020 2020 6966 206c 656e 2868 6429        if len(hd)
+0003fdf0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
 0003fe00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fe10: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
-0003fe20: 3d6b 7761 7267 735b 2270 726f 6261 6269  =kwargs["probabi
-0003fe30: 6c69 7479 225d 2c20 7665 7262 6f73 653d  lity"], verbose=
-0003fe40: 7665 7262 6f73 652c 206e 7468 7265 6164  verbose, nthread
-0003fe50: 7320 3d20 4172 6368 5461 626c 652e 6e63  s = ArchTable.nc
-0003fe60: 7075 2c20 7365 6564 3d73 6565 642b 6975  pu, seed=seed+iu
-0003fe70: 295b 2269 6d61 6765 225d 2e76 616c 0d0a  )["image"].val..
-0003fe80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003fe90: 2020 2020 2020 2020 2020 2323 2320 7265            ### re
-0003fea0: 6172 7261 6e67 6520 6461 7461 2069 6e74  arrange data int
-0003feb0: 6f20 6120 3244 2061 7272 6179 206f 6620  o a 2D array of 
-0003fec0: 7468 6520 7369 6d75 6c61 7469 6f6e 2067  the simulation g
-0003fed0: 7269 6420 7369 7a65 2023 2323 0d0a 2020  rid size ###..  
-0003fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fef0: 2020 2020 2020 666f 7220 6972 6561 6c20        for ireal 
-0003ff00: 696e 2072 616e 6765 286e 7265 616c 293a  in range(nreal):
-0003ff10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ff20: 2020 2020 2020 2020 2020 2020 2020 6772                gr
-0003ff30: 6964 3d73 696d 7573 5b69 7265 616c 5d0d  id=simus[ireal].
-0003ff40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ff50: 2020 2020 2020 2020 2020 2020 2067 7269               gri
-0003ff60: 645b 6772 6964 3d3d 305d 3d6e 702e 6e61  d[grid==0]=np.na
-0003ff70: 6e0d 0a20 2020 2020 2020 2020 2020 2020  n..             
-0003ff80: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-0003ff90: 7269 645b 6d61 736b 3d3d 305d 3d6e 702e  rid[mask==0]=np.
-0003ffa0: 6e61 6e20 2023 2065 7874 7261 6374 206f  nan  # extract o
-0003ffb0: 6e6c 7920 7468 6520 7061 7274 206f 6e20  nly the part on 
-0003ffc0: 7468 6520 7265 616c 2064 6f6d 6169 6e0d  the real domain.
-0003ffd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ffe0: 2020 2020 2020 2020 2020 2020 2066 6163               fac
-0003fff0: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
-00040000: 6972 6561 6c5d 5b6d 6173 6b5d 3d67 7269  ireal][mask]=gri
-00040010: 645b 6d61 736b 5d0d 0a0d 0a20 2020 2020  d[mask]....     
-00040020: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00040030: 6c69 6620 6d65 7468 6f64 2e75 7070 6572  lif method.upper
-00040040: 2829 203d 3d20 224d 5053 223a 0d0a 2020  () == "MPS":..  
-00040050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040060: 2020 2020 2020 2323 2061 7373 6572 7469        ## asserti
-00040070: 6f6e 7320 2323 0d0a 2020 2020 2020 2020  ons ##..        
+0003fe10: 2020 2068 643d 6e70 2e61 7272 6179 2868     hd=np.array(h
+0003fe20: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+0003fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe40: 6661 6369 6573 3d6e 702e 6172 7261 7928  facies=np.array(
+0003fe50: 6661 6369 6573 290d 0a20 2020 2020 2020  facies)..       
+0003fe60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe70: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0003fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe90: 2020 2020 6864 3d4e 6f6e 650d 0a20 2020      hd=None..   
+0003fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003feb0: 2020 2020 2020 2020 2066 6163 6965 733d           facies=
+0003fec0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+0003fed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fee0: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
+0003fef0: 2020 2020 2020 2020 2020 2020 2323 2053              ## S
+0003ff00: 696d 756c 6174 696f 6e0d 0a20 2020 2020  imulation..     
+0003ff10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ff20: 2020 2073 696d 7573 203d 2067 6369 2e73     simus = gci.s
+0003ff30: 696d 756c 6174 6549 6e64 6963 6174 6f72  imulateIndicator
+0003ff40: 3344 2863 6174 5f76 616c 7565 732c 2073  3D(cat_values, s
+0003ff50: 656c 662e 6c69 7374 5f66 5f63 6f76 6d6f  elf.list_f_covmo
+0003ff60: 6465 6c2c 2064 696d 656e 7369 6f6e 732c  del, dimensions,
+0003ff70: 2073 7061 6369 6e67 2c20 6f72 6967 696e   spacing, origin
+0003ff80: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0003ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ffb0: 2020 2020 2020 2020 2020 206e 7265 616c             nreal
+0003ffc0: 3d6e 7265 616c 2c20 6d65 7468 6f64 3d22  =nreal, method="
+0003ffd0: 7369 6d70 6c65 5f6b 7269 6769 6e67 222c  simple_kriging",
+0003ffe0: 2078 3d68 642c 2076 3d66 6163 6965 732c   x=hd, v=facies,
+0003fff0: 206d 6173 6b3d 6d61 736b 2c0d 0a20 2020   mask=mask,..   
+00040000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040030: 2020 2020 2073 6561 7263 6852 6164 6975       searchRadiu
+00040040: 7352 656c 6174 6976 653d 6b77 6172 6773  sRelative=kwargs
+00040050: 5b22 7222 5d2c 206e 6e65 6967 6862 6f72  ["r"], nneighbor
+00040060: 4d61 783d 6b77 6172 6773 5b22 6e65 6967  Max=kwargs["neig
+00040070: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
 00040080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040090: 6173 7365 7274 2020 6973 696e 7374 616e  assert  isinstan
-000400a0: 6365 2873 656c 662e 665f 5449 2c20 6765  ce(self.f_TI, ge
-000400b0: 6f6e 652e 696d 672e 496d 6729 2c20 2254  one.img.Img), "T
-000400c0: 4920 6973 206e 6f74 2061 2067 656f 6e65  I is not a geone
-000400d0: 2069 6d61 6765 206f 626a 6563 7422 0d0a   image object"..
-000400e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000400f0: 2020 2020 2020 2020 2020 236c 6f61 6420            #load 
-00040100: 7061 7261 6d65 7465 7273 0d0a 2020 2020  parameters..    
-00040110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040120: 2020 2020 5449 3d73 656c 662e 665f 5449      TI=self.f_TI
-00040130: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00040140: 2020 2020 2020 2020 2020 2020 2366 6163              #fac
-00040150: 6965 7320 4944 730d 0a20 2020 2020 2020  ies IDs..       
-00040160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040170: 2049 4473 3d6e 702e 756e 6971 7565 2854   IDs=np.unique(T
-00040180: 492e 7661 6c29 0d0a 2020 2020 2020 2020  I.val)..        
-00040190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000401a0: 6e63 6c61 7373 3d6c 656e 2849 4473 290d  nclass=len(IDs).
-000401b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000401c0: 2020 2020 2020 2020 2063 6c61 7373 496e           classIn
-000401d0: 7465 7276 616c 3d5b 5d0d 0a20 2020 2020  terval=[]..     
+00040090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000400a0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+000400b0: 6261 6269 6c69 7479 3d6b 7761 7267 735b  bability=kwargs[
+000400c0: 2270 726f 6261 6269 6c69 7479 225d 2c20  "probability"], 
+000400d0: 7665 7262 6f73 653d 7665 7262 6f73 652c  verbose=verbose,
+000400e0: 206e 7468 7265 6164 7320 3d20 4172 6368   nthreads = Arch
+000400f0: 5461 626c 652e 6e63 7075 2c20 7365 6564  Table.ncpu, seed
+00040100: 3d73 6565 642b 6975 295b 2269 6d61 6765  =seed+iu)["image
+00040110: 225d 2e76 616c 0d0a 0d0a 2020 2020 2020  "].val....      
+00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040130: 2020 2323 2320 7265 6172 7261 6e67 6520    ### rearrange 
+00040140: 6461 7461 2069 6e74 6f20 6120 3244 2061  data into a 2D a
+00040150: 7272 6179 206f 6620 7468 6520 7369 6d75  rray of the simu
+00040160: 6c61 7469 6f6e 2067 7269 6420 7369 7a65  lation grid size
+00040170: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
+00040180: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00040190: 7220 6972 6561 6c20 696e 2072 616e 6765  r ireal in range
+000401a0: 286e 7265 616c 293a 0d0a 2020 2020 2020  (nreal):..      
+000401b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000401c0: 2020 2020 2020 6772 6964 3d73 696d 7573        grid=simus
+000401d0: 5b69 7265 616c 5d0d 0a20 2020 2020 2020  [ireal]..       
 000401e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000401f0: 2020 2066 6f72 2063 2069 6e20 4944 733a     for c in IDs:
-00040200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040210: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00040220: 6173 7349 6e74 6572 7661 6c2e 6170 7065  assInterval.appe
-00040230: 6e64 285b 632d 302e 352c 2063 2b30 2e35  nd([c-0.5, c+0.5
-00040240: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
-00040250: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00040260: 6578 7472 6163 7420 6861 7264 2064 6174  extract hard dat
-00040270: 610d 0a20 2020 2020 2020 2020 2020 2020  a..             
-00040280: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
-00040290: 2e6f 6e65 7328 5b34 2c20 315d 290d 0a20  .ones([4, 1]).. 
-000402a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402b0: 2020 2020 2020 2066 6f72 2066 6120 696e         for fa in
-000402c0: 206c 6973 745f 6f62 6a3a 2023 6661 6369   list_obj: #faci
-000402d0: 6573 2062 7920 6661 6369 6573 2069 6e20  es by facies in 
-000402e0: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
-000402f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040300: 2020 6661 5f78 3d6e 702e 6172 7261 7928    fa_x=np.array(
-00040310: 6661 2e78 290d 0a20 2020 2020 2020 2020  fa.x)..         
-00040320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040330: 2020 2066 615f 793d 6e70 2e61 7272 6179     fa_y=np.array
-00040340: 2866 612e 7929 0d0a 2020 2020 2020 2020  (fa.y)..        
-00040350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040360: 2020 2020 6661 5f7a 3d6e 702e 6172 7261      fa_z=np.arra
-00040370: 7928 6661 2e7a 290d 0a20 2020 2020 2020  y(fa.z)..       
+000401f0: 2020 2020 2067 7269 645b 6772 6964 3d3d       grid[grid==
+00040200: 305d 3d6e 702e 6e61 6e0d 0a20 2020 2020  0]=np.nan..     
+00040210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040220: 2020 2020 2020 2067 7269 645b 6d61 736b         grid[mask
+00040230: 3d3d 305d 3d6e 702e 6e61 6e20 2023 2065  ==0]=np.nan  # e
+00040240: 7874 7261 6374 206f 6e6c 7920 7468 6520  xtract only the 
+00040250: 7061 7274 206f 6e20 7468 6520 7265 616c  part on the real
+00040260: 2064 6f6d 6169 6e0d 0a20 2020 2020 2020   domain..       
+00040270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040280: 2020 2020 2066 6163 6965 735f 646f 6d61       facies_doma
+00040290: 696e 735b 6975 2c20 6972 6561 6c5d 5b6d  ins[iu, ireal][m
+000402a0: 6173 6b5d 3d67 7269 645b 6d61 736b 5d0d  ask]=grid[mask].
+000402b0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+000402c0: 2020 2020 2020 2065 6c69 6620 6d65 7468         elif meth
+000402d0: 6f64 2e75 7070 6572 2829 203d 3d20 224d  od.upper() == "M
+000402e0: 5053 223a 0d0a 2020 2020 2020 2020 2020  PS":..          
+000402f0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00040300: 2061 7373 6572 7469 6f6e 7320 2323 0d0a   assertions ##..
+00040310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040320: 2020 2020 2020 2020 6173 7365 7274 2020          assert  
+00040330: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+00040340: 665f 5449 2c20 6765 6f6e 652e 696d 672e  f_TI, geone.img.
+00040350: 496d 6729 2c20 2254 4920 6973 206e 6f74  Img), "TI is not
+00040360: 2061 2067 656f 6e65 2069 6d61 6765 206f   a geone image o
+00040370: 626a 6563 7422 0d0a 0d0a 2020 2020 2020  bject"....      
 00040380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040390: 2020 2020 2068 6469 3d6e 702e 7a65 726f       hdi=np.zero
-000403a0: 7328 5b34 2c20 6661 5f78 2e73 6861 7065  s([4, fa_x.shape
-000403b0: 5b30 5d5d 290d 0a20 2020 2020 2020 2020  [0]])..         
-000403c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000403d0: 2020 2068 6469 5b30 5d3d 2066 615f 780d     hdi[0]= fa_x.
-000403e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000403f0: 2020 2020 2020 2020 2020 2020 2068 6469               hdi
-00040400: 5b31 5d3d 6661 5f79 0d0a 2020 2020 2020  [1]=fa_y..      
-00040410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040420: 2020 2020 2020 6864 695b 325d 3d66 615f        hdi[2]=fa_
-00040430: 7a0d 0a20 2020 2020 2020 2020 2020 2020  z..             
-00040440: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00040450: 6469 5b33 5d3d 6e70 2e6f 6e65 7328 6661  di[3]=np.ones(fa
-00040460: 5f78 2e73 6861 7065 292a 6661 2e49 440d  _x.shape)*fa.ID.
-00040470: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040480: 2020 2020 2020 2020 2020 2020 2068 643d               hd=
-00040490: 6e70 2e63 6f6e 6361 7465 6e61 7465 285b  np.concatenate([
-000404a0: 6864 2c20 6864 695d 2c20 6178 6973 3d31  hd, hdi], axis=1
-000404b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000404c0: 2020 2020 2020 2020 2020 2068 643d 6e70             hd=np
-000404d0: 2e64 656c 6574 6528 6864 2c20 302c 2061  .delete(hd, 0, a
-000404e0: 7869 733d 3129 2023 2072 656d 6f76 6520  xis=1) # remove 
-000404f0: 3173 7420 706f 696e 7420 2849 2064 6964  1st point (I did
-00040500: 6e27 7420 6669 6e64 2061 2063 6c65 7665  n't find a cleve
-00040510: 7220 7761 7920 746f 2064 6f20 6974 2e2e  r way to do it..
-00040520: 2e29 0d0a 2020 2020 2020 2020 2020 2020  .)..            
-00040530: 2020 2020 2020 2020 2020 2020 7074 3d69              pt=i
-00040540: 6d67 2e50 6f69 6e74 5365 7428 6e70 743d  mg.PointSet(npt=
-00040550: 6864 2e73 6861 7065 5b31 5d2c 206e 763d  hd.shape[1], nv=
-00040560: 342c 2076 616c 3d68 6429 0d0a 2020 2020  4, val=hd)..    
-00040570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040580: 2020 2020 7074 2e73 6574 5f76 6172 6e61      pt.set_varna
-00040590: 6d65 2822 636f 6465 2229 0d0a 0d0a 2020  me("code")....  
-000405a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405b0: 2020 2020 2020 2320 6175 746f 6d61 7469        # automati
-000405c0: 6320 696e 6665 7265 6e63 6520 6f66 206f  c inference of o
-000405d0: 7269 656e 7461 7469 6f6e 730d 0a20 2020  rientations..   
+00040390: 2020 236c 6f61 6420 7061 7261 6d65 7465    #load paramete
+000403a0: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
+000403b0: 2020 2020 2020 2020 2020 2020 5449 3d73              TI=s
+000403c0: 656c 662e 665f 5449 0d0a 0d0a 2020 2020  elf.f_TI....    
+000403d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403e0: 2020 2020 2366 6163 6965 7320 4944 730d      #facies IDs.
+000403f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040400: 2020 2020 2020 2020 2049 4473 3d6e 702e           IDs=np.
+00040410: 756e 6971 7565 2854 492e 7661 6c29 0d0a  unique(TI.val)..
+00040420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040430: 2020 2020 2020 2020 6e63 6c61 7373 3d6c          nclass=l
+00040440: 656e 2849 4473 290d 0a20 2020 2020 2020  en(IDs)..       
+00040450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040460: 2063 6c61 7373 496e 7465 7276 616c 3d5b   classInterval=[
+00040470: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00040480: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+00040490: 2069 6e20 4944 733a 0d0a 2020 2020 2020   in IDs:..      
+000404a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404b0: 2020 2020 2020 636c 6173 7349 6e74 6572        classInter
+000404c0: 7661 6c2e 6170 7065 6e64 285b 632d 302e  val.append([c-0.
+000404d0: 352c 2063 2b30 2e35 5d29 0d0a 0d0a 2020  5, c+0.5])....  
+000404e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404f0: 2020 2020 2020 2320 6578 7472 6163 7420        # extract 
+00040500: 6861 7264 2064 6174 610d 0a20 2020 2020  hard data..     
+00040510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040520: 2020 2068 643d 6e70 2e6f 6e65 7328 5b34     hd=np.ones([4
+00040530: 2c20 315d 290d 0a20 2020 2020 2020 2020  , 1])..         
+00040540: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00040550: 6f72 2066 6120 696e 206c 6973 745f 6f62  or fa in list_ob
+00040560: 6a3a 2023 6661 6369 6573 2062 7920 6661  j: #facies by fa
+00040570: 6369 6573 2069 6e20 756e 6974 0d0a 2020  cies in unit..  
+00040580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040590: 2020 2020 2020 2020 2020 6661 5f78 3d6e            fa_x=n
+000405a0: 702e 6172 7261 7928 6661 2e78 290d 0a20  p.array(fa.x).. 
+000405b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405c0: 2020 2020 2020 2020 2020 2066 615f 793d             fa_y=
+000405d0: 6e70 2e61 7272 6179 2866 612e 7929 0d0a  np.array(fa.y)..
 000405e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000405f0: 2020 2020 2069 6620 6b77 6172 6773 5b22       if kwargs["
-00040600: 726f 7441 7a69 225d 203d 3d20 2269 6e66  rotAzi"] == "inf
-00040610: 6572 656e 6365 2220 616e 6420 6b77 6172  erence" and kwar
-00040620: 6773 5b22 726f 7444 6970 225d 203d 3d20  gs["rotDip"] == 
-00040630: 2269 6e66 6572 656e 6365 223a 2020 2320  "inference":  # 
-00040640: 6f6e 6c79 2069 6620 7468 6573 6520 7477  only if these tw
-00040650: 6f20 6172 6520 7365 7420 6f6e 2069 6e66  o are set on inf
-00040660: 6572 656e 6365 0d0a 2020 2020 2020 2020  erence..        
-00040670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040680: 2020 2020 617a 692c 2064 6970 3d41 7263      azi, dip=Arc
-00040690: 6854 6162 6c65 2e6f 7269 656e 7461 7469  hTable.orientati
-000406a0: 6f6e 5f6d 6170 2873 656c 662c 2061 7a69  on_map(self, azi
-000406b0: 5f74 6f70 203d 206b 7761 7267 735b 2261  _top = kwargs["a
-000406c0: 7a69 5f74 6f70 225d 2c20 2064 6970 5f74  zi_top"],  dip_t
-000406d0: 6f70 3d20 6b77 6172 6773 5b22 6469 705f  op= kwargs["dip_
-000406e0: 746f 7022 5d2c 0d0a 2020 2020 2020 2020  top"],..        
-000406f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405f0: 2020 2020 2020 2020 2020 2020 6661 5f7a              fa_z
+00040600: 3d6e 702e 6172 7261 7928 6661 2e7a 290d  =np.array(fa.z).
+00040610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040620: 2020 2020 2020 2020 2020 2020 2068 6469               hdi
+00040630: 3d6e 702e 7a65 726f 7328 5b34 2c20 6661  =np.zeros([4, fa
+00040640: 5f78 2e73 6861 7065 5b30 5d5d 290d 0a20  _x.shape[0]]).. 
+00040650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040660: 2020 2020 2020 2020 2020 2068 6469 5b30             hdi[0
+00040670: 5d3d 2066 615f 780d 0a20 2020 2020 2020  ]= fa_x..       
+00040680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040690: 2020 2020 2068 6469 5b31 5d3d 6661 5f79       hdi[1]=fa_y
+000406a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000406b0: 2020 2020 2020 2020 2020 2020 2020 6864                hd
+000406c0: 695b 325d 3d66 615f 7a0d 0a20 2020 2020  i[2]=fa_z..     
+000406d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000406e0: 2020 2020 2020 2068 6469 5b33 5d3d 6e70         hdi[3]=np
+000406f0: 2e6f 6e65 7328 6661 5f78 2e73 6861 7065  .ones(fa_x.shape
+00040700: 292a 6661 2e49 440d 0a20 2020 2020 2020  )*fa.ID..       
 00040710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040720: 2020 2020 2020 2061 7a69 5f62 6f74 3d6b         azi_bot=k
-00040730: 7761 7267 735b 2261 7a69 5f62 6f74 225d  wargs["azi_bot"]
-00040740: 2c20 6469 705f 626f 743d 6b77 6172 6773  , dip_bot=kwargs
-00040750: 5b22 6469 705f 626f 7422 5d2c 2073 6d6f  ["dip_bot"], smo
-00040760: 6f74 683d 3229 2020 2320 6765 7420 617a  oth=2)  # get az
-00040770: 696d 7574 6820 616e 6420 6469 700d 0a0d  imuth and dip...
-00040780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040790: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-000407a0: 7267 735b 2272 6f74 417a 6922 5d20 3d20  rgs["rotAzi"] = 
-000407b0: 617a 690d 0a20 2020 2020 2020 2020 2020  azi..           
+00040720: 2020 2020 2068 643d 6e70 2e63 6f6e 6361       hd=np.conca
+00040730: 7465 6e61 7465 285b 6864 2c20 6864 695d  tenate([hd, hdi]
+00040740: 2c20 6178 6973 3d31 290d 0a20 2020 2020  , axis=1)..     
+00040750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040760: 2020 2068 643d 6e70 2e64 656c 6574 6528     hd=np.delete(
+00040770: 6864 2c20 302c 2061 7869 733d 3129 2023  hd, 0, axis=1) #
+00040780: 2072 656d 6f76 6520 3173 7420 706f 696e   remove 1st poin
+00040790: 7420 2849 2064 6964 6e27 7420 6669 6e64  t (I didn't find
+000407a0: 2061 2063 6c65 7665 7220 7761 7920 746f   a clever way to
+000407b0: 2064 6f20 6974 2e2e 2e29 0d0a 2020 2020   do it...)..    
 000407c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000407d0: 206b 7761 7267 735b 2272 6f74 4469 7022   kwargs["rotDip"
-000407e0: 5d20 3d20 6469 700d 0a20 2020 2020 2020  ] = dip..       
-000407f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040800: 2020 2020 206b 7761 7267 735b 2272 6f74       kwargs["rot
-00040810: 417a 694c 6f63 225d 203d 2054 7275 650d  AziLoc"] = True.
-00040820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040830: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
-00040840: 7267 735b 2272 6f74 4469 704c 6f63 225d  rgs["rotDipLoc"]
-00040850: 203d 2054 7275 650d 0a0d 0a20 2020 2020   = True....     
-00040860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040870: 2020 2023 4453 2072 6573 6561 7263 680d     #DS research.
-00040880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040890: 2020 2020 2020 2020 2073 6e70 3d64 7369           snp=dsi
-000408a0: 2e53 6561 7263 684e 6569 6768 626f 7268  .SearchNeighborh
-000408b0: 6f6f 6450 6172 616d 6574 6572 7328 0d0a  oodParameters(..
-000408c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000408d0: 2020 2020 2020 2020 2020 2020 7261 6469              radi
-000408e0: 7573 4d6f 6465 3d6b 7761 7267 735b 2272  usMode=kwargs["r
-000408f0: 6164 6975 734d 6f64 6522 5d2c 2072 783d  adiusMode"], rx=
-00040900: 6b77 6172 6773 5b22 7278 225d 2c20 7279  kwargs["rx"], ry
-00040910: 3d6b 7761 7267 735b 2272 7922 5d2c 2072  =kwargs["ry"], r
-00040920: 7a3d 6b77 6172 6773 5b22 727a 225d 2c0d  z=kwargs["rz"],.
-00040930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040940: 2020 2020 2020 2020 2020 2020 2061 6e69               ani
-00040950: 736f 7472 6f70 7952 6174 696f 4d6f 6465  sotropyRatioMode
-00040960: 3d6b 7761 7267 735b 2261 6e69 736f 7472  =kwargs["anisotr
-00040970: 6f70 7952 6174 696f 4d6f 6465 225d 2c20  opyRatioMode"], 
-00040980: 6178 3d6b 7761 7267 735b 2261 7822 5d2c  ax=kwargs["ax"],
-00040990: 2061 793d 6b77 6172 6773 5b22 6179 225d   ay=kwargs["ay"]
-000409a0: 2c20 617a 3d6b 7761 7267 735b 2261 7a22  , az=kwargs["az"
-000409b0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-000409c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409d0: 616e 676c 6531 3d6b 7761 7267 735b 2261  angle1=kwargs["a
-000409e0: 6e67 6c65 3122 5d2c 2061 6e67 6c65 323d  ngle1"], angle2=
-000409f0: 6b77 6172 6773 5b22 616e 676c 6532 225d  kwargs["angle2"]
-00040a00: 2c20 616e 676c 6533 3d6b 7761 7267 735b  , angle3=kwargs[
-00040a10: 2261 6e67 6c65 3322 5d29 0d0a 0d0a 2020  "angle3"])....  
+000407d0: 2020 2020 7074 3d69 6d67 2e50 6f69 6e74      pt=img.Point
+000407e0: 5365 7428 6e70 743d 6864 2e73 6861 7065  Set(npt=hd.shape
+000407f0: 5b31 5d2c 206e 763d 342c 2076 616c 3d68  [1], nv=4, val=h
+00040800: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+00040810: 2020 2020 2020 2020 2020 2020 7074 2e73              pt.s
+00040820: 6574 5f76 6172 6e61 6d65 2822 636f 6465  et_varname("code
+00040830: 2229 0d0a 0d0a 2020 2020 2020 2020 2020  ")....          
+00040840: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00040850: 6175 746f 6d61 7469 6320 696e 6665 7265  automatic infere
+00040860: 6e63 6520 6f66 206f 7269 656e 7461 7469  nce of orientati
+00040870: 6f6e 730d 0a20 2020 2020 2020 2020 2020  ons..           
+00040880: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00040890: 6b77 6172 6773 5b22 726f 7441 7a69 225d  kwargs["rotAzi"]
+000408a0: 203d 3d20 2269 6e66 6572 656e 6365 2220   == "inference" 
+000408b0: 616e 6420 6b77 6172 6773 5b22 726f 7444  and kwargs["rotD
+000408c0: 6970 225d 203d 3d20 2269 6e66 6572 656e  ip"] == "inferen
+000408d0: 6365 223a 2020 2320 6f6e 6c79 2069 6620  ce":  # only if 
+000408e0: 7468 6573 6520 7477 6f20 6172 6520 7365  these two are se
+000408f0: 7420 6f6e 2069 6e66 6572 656e 6365 0d0a  t on inference..
+00040900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040910: 2020 2020 2020 2020 2020 2020 617a 692c              azi,
+00040920: 2064 6970 3d41 7263 6854 6162 6c65 2e6f   dip=ArchTable.o
+00040930: 7269 656e 7461 7469 6f6e 5f6d 6170 2873  rientation_map(s
+00040940: 656c 662c 2061 7a69 5f74 6f70 203d 206b  elf, azi_top = k
+00040950: 7761 7267 735b 2261 7a69 5f74 6f70 225d  wargs["azi_top"]
+00040960: 2c20 2064 6970 5f74 6f70 3d20 6b77 6172  ,  dip_top= kwar
+00040970: 6773 5b22 6469 705f 746f 7022 5d2c 0d0a  gs["dip_top"],..
+00040980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000409c0: 7a69 5f62 6f74 3d6b 7761 7267 735b 2261  zi_bot=kwargs["a
+000409d0: 7a69 5f62 6f74 225d 2c20 6469 705f 626f  zi_bot"], dip_bo
+000409e0: 743d 6b77 6172 6773 5b22 6469 705f 626f  t=kwargs["dip_bo
+000409f0: 7422 5d2c 2073 6d6f 6f74 683d 3229 2020  t"], smooth=2)  
+00040a00: 2320 6765 7420 617a 696d 7574 6820 616e  # get azimuth an
+00040a10: 6420 6469 700d 0a0d 0a20 2020 2020 2020  d dip....       
 00040a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a30: 2020 2020 2020 736e 705f 6c20 3d20 5b5d        snp_l = []
-00040a40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040a50: 2020 2020 2020 2020 2020 666f 7220 6976            for iv
-00040a60: 2069 6e20 7261 6e67 6528 6b77 6172 6773   in range(kwargs
-00040a70: 5b22 6e76 225d 293a 0d0a 2020 2020 2020  ["nv"]):..      
-00040a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a90: 2020 2020 2020 736e 705f 6c2e 6170 7065        snp_l.appe
-00040aa0: 6e64 2873 6e70 290d 0a0d 0a20 2020 2020  nd(snp)....     
-00040ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ac0: 2020 2023 4453 2073 6f66 7470 726f 6261     #DS softproba
-00040ad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040ae0: 2020 2020 2020 2020 2020 7370 3d64 7369            sp=dsi
-00040af0: 2e53 6f66 7450 726f 6261 6269 6c69 7479  .SoftProbability
-00040b00: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00040b10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00040b20: 726f 6261 6269 6c69 7479 436f 6e73 7472  robabilityConstr
-00040b30: 6169 6e74 5573 6167 653d 6b77 6172 6773  aintUsage=kwargs
-00040b40: 5b22 7072 6f62 6155 7361 6765 225d 2c20  ["probaUsage"], 
-00040b50: 2020 2320 7072 6f62 6162 696c 6974 7920    # probability 
-00040b60: 636f 6e73 7472 6169 6e74 7320 6d65 7468  constraints meth
-00040b70: 6f64 2028 3120 666f 7220 676c 6f62 612c  od (1 for globa,
-00040b80: 2032 2066 6f72 206c 6f63 616c 290d 0a20   2 for local).. 
-00040b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ba0: 2020 2020 2020 2020 2020 206e 636c 6173             nclas
-00040bb0: 733d 6e63 6c61 7373 2c20 2020 2020 2020  s=nclass,       
-00040bc0: 2020 2020 2020 2020 2020 2023 206e 756d             # num
-00040bd0: 6265 7220 6f66 2063 6c61 7373 6573 206f  ber of classes o
-00040be0: 6620 7661 6c75 6573 0d0a 2020 2020 2020  f values..      
-00040bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c00: 2020 2020 2020 636c 6173 7349 6e74 6572        classInter
-00040c10: 7661 6c3d 636c 6173 7349 6e74 6572 7661  val=classInterva
-00040c20: 6c2c 2020 2320 6c69 7374 206f 6620 636c  l,  # list of cl
-00040c30: 6173 7365 730d 0a20 2020 2020 2020 2020  asses..         
-00040c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c50: 2020 206c 6f63 616c 5064 663d 206b 7761     localPdf= kwa
-00040c60: 7267 735b 226c 6f63 616c 5064 6622 5d2c  rgs["localPdf"],
-00040c70: 2020 2020 2020 2020 2020 2020 2023 206c               # l
-00040c80: 6f63 616c 2074 6172 6765 7420 5044 460d  ocal target PDF.
-00040c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040ca0: 2020 2020 2020 2020 2020 2020 2067 6c6f               glo
-00040cb0: 6261 6c50 6466 3d6b 7761 7267 735b 2267  balPdf=kwargs["g
-00040cc0: 6c6f 6261 6c50 6466 225d 2c0d 0a20 2020  lobalPdf"],..   
-00040cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ce0: 2020 2020 2020 2020 206c 6f63 616c 5064           localPd
-00040cf0: 6653 7570 706f 7274 5261 6469 7573 3d6b  fSupportRadius=k
-00040d00: 7761 7267 735b 226c 6f63 616c 5064 6652  wargs["localPdfR
-00040d10: 6164 6975 7322 5d2c 2020 2020 2020 2320  adius"],      # 
-00040d20: 7375 7070 6f72 7420 7261 6469 7573 0d0a  support radius..
-00040d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d40: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-00040d50: 6172 696e 6750 6466 4d65 7468 6f64 3d35  aringPdfMethod=5
-00040d60: 2c20 2020 2020 2020 2020 2020 2320 6d65  ,           # me
-00040d70: 7468 6f64 2066 6f72 2063 6f6d 7061 7269  thod for compari
-00040d80: 6e67 2050 4446 2773 2028 7365 6520 646f  ng PDF's (see do
-00040d90: 633a 2068 656c 7028 6765 6f6e 652e 6465  c: help(geone.de
-00040da0: 6573 7365 696e 7465 7266 6163 652e 536f  esseinterface.So
-00040db0: 6674 5072 6f62 6162 696c 6974 7929 290d  ftProbability)).
-00040dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040dd0: 2020 2020 2020 2020 2020 2020 2064 6561               dea
-00040de0: 6374 6976 6174 696f 6e44 6973 7461 6e63  ctivationDistanc
-00040df0: 653d 6b77 6172 6773 5b22 6465 6163 7469  e=kwargs["deacti
-00040e00: 7661 7469 6f6e 4469 7374 616e 6365 225d  vationDistance"]
-00040e10: 2c20 2020 2020 2020 2320 6465 6163 7469  ,       # deacti
-00040e20: 7661 7469 6f6e 2064 6973 7461 6e63 6520  vation distance 
-00040e30: 2863 6865 636b 696e 6720 5044 4620 6973  (checking PDF is
-00040e40: 2064 6561 6374 6976 6174 6564 2066 6f72   deactivated for
-00040e50: 206e 6172 726f 7720 7061 7474 6572 6e73   narrow patterns
-00040e60: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00040e70: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00040e80: 6f6e 7374 616e 7454 6872 6573 686f 6c64  onstantThreshold
-00040e90: 3d6b 7761 7267 735b 2263 6f6e 7374 616e  =kwargs["constan
-00040ea0: 7454 6872 6573 686f 6c64 225d 2920 2020  tThreshold"])   
-00040eb0: 2020 2020 2023 2061 6363 6570 7461 7469       # acceptati
-00040ec0: 6f6e 2074 6872 6573 686f 6c64 0d0a 0d0a  on threshold....
+00040a30: 2020 2020 206b 7761 7267 735b 2272 6f74       kwargs["rot
+00040a40: 417a 6922 5d20 3d20 617a 690d 0a20 2020  Azi"] = azi..   
+00040a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a60: 2020 2020 2020 2020 206b 7761 7267 735b           kwargs[
+00040a70: 2272 6f74 4469 7022 5d20 3d20 6469 700d  "rotDip"] = dip.
+00040a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040a90: 2020 2020 2020 2020 2020 2020 206b 7761               kwa
+00040aa0: 7267 735b 2272 6f74 417a 694c 6f63 225d  rgs["rotAziLoc"]
+00040ab0: 203d 2054 7275 650d 0a20 2020 2020 2020   = True..       
+00040ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ad0: 2020 2020 206b 7761 7267 735b 2272 6f74       kwargs["rot
+00040ae0: 4469 704c 6f63 225d 203d 2054 7275 650d  DipLoc"] = True.
+00040af0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00040b00: 2020 2020 2020 2020 2020 2023 4453 2072             #DS r
+00040b10: 6573 6561 7263 680d 0a20 2020 2020 2020  esearch..       
+00040b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b30: 2073 6e70 3d64 7369 2e53 6561 7263 684e   snp=dsi.SearchN
+00040b40: 6569 6768 626f 7268 6f6f 6450 6172 616d  eighborhoodParam
+00040b50: 6574 6572 7328 0d0a 2020 2020 2020 2020  eters(..        
+00040b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b70: 2020 2020 7261 6469 7573 4d6f 6465 3d6b      radiusMode=k
+00040b80: 7761 7267 735b 2272 6164 6975 734d 6f64  wargs["radiusMod
+00040b90: 6522 5d2c 2072 783d 6b77 6172 6773 5b22  e"], rx=kwargs["
+00040ba0: 7278 225d 2c20 7279 3d6b 7761 7267 735b  rx"], ry=kwargs[
+00040bb0: 2272 7922 5d2c 2072 7a3d 6b77 6172 6773  "ry"], rz=kwargs
+00040bc0: 5b22 727a 225d 2c0d 0a20 2020 2020 2020  ["rz"],..       
+00040bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040be0: 2020 2020 2061 6e69 736f 7472 6f70 7952       anisotropyR
+00040bf0: 6174 696f 4d6f 6465 3d6b 7761 7267 735b  atioMode=kwargs[
+00040c00: 2261 6e69 736f 7472 6f70 7952 6174 696f  "anisotropyRatio
+00040c10: 4d6f 6465 225d 2c20 6178 3d6b 7761 7267  Mode"], ax=kwarg
+00040c20: 735b 2261 7822 5d2c 2061 793d 6b77 6172  s["ax"], ay=kwar
+00040c30: 6773 5b22 6179 225d 2c20 617a 3d6b 7761  gs["ay"], az=kwa
+00040c40: 7267 735b 2261 7a22 5d2c 0d0a 2020 2020  rgs["az"],..    
+00040c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c60: 2020 2020 2020 2020 616e 676c 6531 3d6b          angle1=k
+00040c70: 7761 7267 735b 2261 6e67 6c65 3122 5d2c  wargs["angle1"],
+00040c80: 2061 6e67 6c65 323d 6b77 6172 6773 5b22   angle2=kwargs["
+00040c90: 616e 676c 6532 225d 2c20 616e 676c 6533  angle2"], angle3
+00040ca0: 3d6b 7761 7267 735b 2261 6e67 6c65 3322  =kwargs["angle3"
+00040cb0: 5d29 0d0a 0d0a 2020 2020 2020 2020 2020  ])....          
+00040cc0: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+00040cd0: 705f 6c20 3d20 5b5d 0d0a 2020 2020 2020  p_l = []..      
+00040ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040cf0: 2020 666f 7220 6976 2069 6e20 7261 6e67    for iv in rang
+00040d00: 6528 6b77 6172 6773 5b22 6e76 225d 293a  e(kwargs["nv"]):
+00040d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00040d20: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+00040d30: 705f 6c2e 6170 7065 6e64 2873 6e70 290d  p_l.append(snp).
+00040d40: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00040d50: 2020 2020 2020 2020 2020 2023 4453 2073             #DS s
+00040d60: 6f66 7470 726f 6261 0d0a 2020 2020 2020  oftproba..      
+00040d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040d80: 2020 7370 3d64 7369 2e53 6f66 7450 726f    sp=dsi.SoftPro
+00040d90: 6261 6269 6c69 7479 280d 0a20 2020 2020  bability(..     
+00040da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040db0: 2020 2020 2020 2070 726f 6261 6269 6c69         probabili
+00040dc0: 7479 436f 6e73 7472 6169 6e74 5573 6167  tyConstraintUsag
+00040dd0: 653d 6b77 6172 6773 5b22 7072 6f62 6155  e=kwargs["probaU
+00040de0: 7361 6765 225d 2c20 2020 2320 7072 6f62  sage"],   # prob
+00040df0: 6162 696c 6974 7920 636f 6e73 7472 6169  ability constrai
+00040e00: 6e74 7320 6d65 7468 6f64 2028 3120 666f  nts method (1 fo
+00040e10: 7220 676c 6f62 612c 2032 2066 6f72 206c  r globa, 2 for l
+00040e20: 6f63 616c 290d 0a20 2020 2020 2020 2020  ocal)..         
+00040e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e40: 2020 206e 636c 6173 733d 6e63 6c61 7373     nclass=nclass
+00040e50: 2c20 2020 2020 2020 2020 2020 2020 2020  ,               
+00040e60: 2020 2023 206e 756d 6265 7220 6f66 2063     # number of c
+00040e70: 6c61 7373 6573 206f 6620 7661 6c75 6573  lasses of values
+00040e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00040e90: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00040ea0: 6173 7349 6e74 6572 7661 6c3d 636c 6173  assInterval=clas
+00040eb0: 7349 6e74 6572 7661 6c2c 2020 2320 6c69  sInterval,  # li
+00040ec0: 7374 206f 6620 636c 6173 7365 730d 0a20  st of classes.. 
 00040ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ee0: 2020 2020 2020 2020 7370 5f6c 203d 205b          sp_l = [
-00040ef0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00040f00: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00040f10: 7620 696e 2072 616e 6765 286b 7761 7267  v in range(kwarg
-00040f20: 735b 226e 7622 5d29 3a0d 0a20 2020 2020  s["nv"]):..     
+00040ee0: 2020 2020 2020 2020 2020 206c 6f63 616c             local
+00040ef0: 5064 663d 206b 7761 7267 735b 226c 6f63  Pdf= kwargs["loc
+00040f00: 616c 5064 6622 5d2c 2020 2020 2020 2020  alPdf"],        
+00040f10: 2020 2020 2023 206c 6f63 616c 2074 6172       # local tar
+00040f20: 6765 7420 5044 460d 0a20 2020 2020 2020  get PDF..       
 00040f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f40: 2020 2020 2020 2073 705f 6c2e 6170 7065         sp_l.appe
-00040f50: 6e64 2873 7029 0d0a 0d0a 2020 2020 2020  nd(sp)....      
-00040f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f70: 2020 2344 5320 696e 7075 740d 0a20 2020    #DS input..   
-00040f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f90: 2020 2020 2064 6565 7373 655f 696e 7075       deesse_inpu
-00040fa0: 743d 6473 692e 4465 6573 7365 496e 7075  t=dsi.DeesseInpu
-00040fb0: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
-00040fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040fd0: 6e78 3d6e 782c 206e 793d 6e79 2c20 6e7a  nx=nx, ny=ny, nz
-00040fe0: 3d6e 7a2c 2020 2020 2020 2023 2064 696d  =nz,       # dim
-00040ff0: 656e 7369 6f6e 206f 6620 7468 6520 7369  ension of the si
-00041000: 6d75 6c61 7469 6f6e 2067 7269 6420 286e  mulation grid (n
-00041010: 756d 6265 7220 6f66 2063 656c 6c73 290d  umber of cells).
-00041020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041030: 2020 2020 2020 2020 2020 2020 2073 783d               sx=
-00041040: 7378 2c20 7379 3d73 792c 2073 7a3d 737a  sx, sy=sy, sz=sz
-00041050: 2c20 2020 2020 2320 6365 6c6c 7320 756e  ,     # cells un
-00041060: 6974 7320 696e 2074 6865 2073 696d 756c  its in the simul
-00041070: 6174 696f 6e20 6772 6964 2028 6865 7265  ation grid (here
-00041080: 2061 7265 2074 6865 2064 6566 6175 6c74   are the default
-00041090: 2076 616c 7565 7329 0d0a 2020 2020 2020   values)..      
-000410a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000410b0: 2020 2020 2020 6f78 3d6f 782c 206f 793d        ox=ox, oy=
-000410c0: 6f79 2c20 6f7a 3d6f 7a2c 2020 2020 2023  oy, oz=oz,     #
-000410d0: 206f 7269 6769 6e20 6f66 2074 6865 2073   origin of the s
-000410e0: 696d 756c 6174 696f 6e20 6772 6964 2028  imulation grid (
-000410f0: 6865 7265 2061 7265 2074 6865 2064 6566  here are the def
-00041100: 6175 6c74 2076 616c 7565 7329 0d0a 2020  ault values)..  
-00041110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041120: 2020 2020 2020 2020 2020 6e76 3d6b 7761            nv=kwa
-00041130: 7267 735b 226e 7622 5d2c 2076 6172 6e61  rgs["nv"], varna
-00041140: 6d65 3d6b 7761 7267 735b 2276 6172 6e61  me=kwargs["varna
-00041150: 6d65 225d 2c20 2020 2020 2020 2320 6e75  me"],       # nu
-00041160: 6d62 6572 206f 6620 7661 7269 6162 6c65  mber of variable
-00041170: 2873 292c 206e 616d 6520 6f66 2074 6865  (s), name of the
-00041180: 2076 6172 6961 626c 6528 7329 0d0a 2020   variable(s)..  
+00040f40: 2020 2020 2067 6c6f 6261 6c50 6466 3d6b       globalPdf=k
+00040f50: 7761 7267 735b 2267 6c6f 6261 6c50 6466  wargs["globalPdf
+00040f60: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
+00040f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f80: 206c 6f63 616c 5064 6653 7570 706f 7274   localPdfSupport
+00040f90: 5261 6469 7573 3d6b 7761 7267 735b 226c  Radius=kwargs["l
+00040fa0: 6f63 616c 5064 6652 6164 6975 7322 5d2c  ocalPdfRadius"],
+00040fb0: 2020 2020 2020 2320 7375 7070 6f72 7420        # support 
+00040fc0: 7261 6469 7573 0d0a 2020 2020 2020 2020  radius..        
+00040fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fe0: 2020 2020 636f 6d70 6172 696e 6750 6466      comparingPdf
+00040ff0: 4d65 7468 6f64 3d35 2c20 2020 2020 2020  Method=5,       
+00041000: 2020 2020 2320 6d65 7468 6f64 2066 6f72      # method for
+00041010: 2063 6f6d 7061 7269 6e67 2050 4446 2773   comparing PDF's
+00041020: 2028 7365 6520 646f 633a 2068 656c 7028   (see doc: help(
+00041030: 6765 6f6e 652e 6465 6573 7365 696e 7465  geone.deesseinte
+00041040: 7266 6163 652e 536f 6674 5072 6f62 6162  rface.SoftProbab
+00041050: 696c 6974 7929 290d 0a20 2020 2020 2020  ility))..       
+00041060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041070: 2020 2020 2064 6561 6374 6976 6174 696f       deactivatio
+00041080: 6e44 6973 7461 6e63 653d 6b77 6172 6773  nDistance=kwargs
+00041090: 5b22 6465 6163 7469 7661 7469 6f6e 4469  ["deactivationDi
+000410a0: 7374 616e 6365 225d 2c20 2020 2020 2020  stance"],       
+000410b0: 2320 6465 6163 7469 7661 7469 6f6e 2064  # deactivation d
+000410c0: 6973 7461 6e63 6520 2863 6865 636b 696e  istance (checkin
+000410d0: 6720 5044 4620 6973 2064 6561 6374 6976  g PDF is deactiv
+000410e0: 6174 6564 2066 6f72 206e 6172 726f 7720  ated for narrow 
+000410f0: 7061 7474 6572 6e73 290d 0a20 2020 2020  patterns)..     
+00041100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041110: 2020 2020 2020 2063 6f6e 7374 616e 7454         constantT
+00041120: 6872 6573 686f 6c64 3d6b 7761 7267 735b  hreshold=kwargs[
+00041130: 2263 6f6e 7374 616e 7454 6872 6573 686f  "constantThresho
+00041140: 6c64 225d 2920 2020 2020 2020 2023 2061  ld"])        # a
+00041150: 6363 6570 7461 7469 6f6e 2074 6872 6573  cceptation thres
+00041160: 686f 6c64 0d0a 0d0a 2020 2020 2020 2020  hold....        
+00041170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041180: 7370 5f6c 203d 205b 5d0d 0a20 2020 2020  sp_l = []..     
 00041190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000411a0: 2020 2020 2020 2020 2020 6e54 493d 312c            nTI=1,
-000411b0: 2054 493d 5449 2c20 2020 2020 2020 2020   TI=TI,         
-000411c0: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
-000411d0: 5449 2873 292c 2054 4920 2863 6c61 7373  TI(s), TI (class
-000411e0: 2064 7369 2e49 6d67 290d 0a20 2020 2020   dsi.Img)..     
-000411f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041200: 2020 2020 2020 2064 6174 6150 6f69 6e74         dataPoint
-00041210: 5365 743d 7074 2c20 2020 2020 2020 2020  Set=pt,         
-00041220: 2020 2023 2068 6172 6420 6461 7461 2028     # hard data (
-00041230: 6f70 7469 6f6e 616c 290d 0a20 2020 2020  optional)..     
-00041240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041250: 2020 2020 2020 2064 6174 6149 6d61 6765         dataImage
-00041260: 203d 206b 7761 7267 735b 2264 6174 6149   = kwargs["dataI
-00041270: 6d61 6765 225d 2c0d 0a20 2020 2020 2020  mage"],..       
-00041280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041290: 2020 2020 206f 7574 7075 7456 6172 466c       outputVarFl
-000412a0: 6167 203d 206b 7761 7267 735b 226f 7574  ag = kwargs["out
-000412b0: 7075 7456 6172 466c 6167 225d 2c0d 0a20  putVarFlag"],.. 
+000411a0: 2020 2066 6f72 2069 7620 696e 2072 616e     for iv in ran
+000411b0: 6765 286b 7761 7267 735b 226e 7622 5d29  ge(kwargs["nv"])
+000411c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000411d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000411e0: 705f 6c2e 6170 7065 6e64 2873 7029 0d0a  p_l.append(sp)..
+000411f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041200: 2020 2020 2020 2020 2020 2344 5320 696e            #DS in
+00041210: 7075 740d 0a20 2020 2020 2020 2020 2020  put..           
+00041220: 2020 2020 2020 2020 2020 2020 2064 6565               dee
+00041230: 7373 655f 696e 7075 743d 6473 692e 4465  sse_input=dsi.De
+00041240: 6573 7365 496e 7075 7428 0d0a 2020 2020  esseInput(..    
+00041250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041260: 2020 2020 2020 2020 6e78 3d6e 782c 206e          nx=nx, n
+00041270: 793d 6e79 2c20 6e7a 3d6e 7a2c 2020 2020  y=ny, nz=nz,    
+00041280: 2020 2023 2064 696d 656e 7369 6f6e 206f     # dimension o
+00041290: 6620 7468 6520 7369 6d75 6c61 7469 6f6e  f the simulation
+000412a0: 2067 7269 6420 286e 756d 6265 7220 6f66   grid (number of
+000412b0: 2063 656c 6c73 290d 0a20 2020 2020 2020   cells)..       
 000412c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000412d0: 2020 2020 2020 2020 2020 2064 6973 7461             dista
-000412e0: 6e63 6554 7970 6520 3d20 6b77 6172 6773  nceType = kwargs
-000412f0: 5b22 6469 7374 616e 6365 5479 7065 225d  ["distanceType"]
-00041300: 2c20 2023 2064 6973 7461 6e63 6520 7479  ,  # distance ty
-00041310: 7065 3a20 7072 6f70 6f72 7469 6f6e 206f  pe: proportion o
-00041320: 6620 6d69 736d 6174 6368 696e 6720 6e6f  f mismatching no
-00041330: 6465 7320 2863 6174 6567 6f72 6963 616c  des (categorical
-00041340: 2076 6172 2e2c 2064 6566 6175 6c74 290d   var., default).
-00041350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041360: 2020 2020 2020 2020 2020 2020 2073 6f66               sof
-00041370: 7450 726f 6261 6269 6c69 7479 3d73 705f  tProbability=sp_
-00041380: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-00041390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000413a0: 7365 6172 6368 4e65 6967 6862 6f72 686f  searchNeighborho
-000413b0: 6f64 5061 7261 6d65 7465 7273 3d73 6e70  odParameters=snp
-000413c0: 5f6c 2c0d 0a20 2020 2020 2020 2020 2020  _l,..           
-000413d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000413e0: 2068 6f6d 6f74 6865 7479 5573 6167 653d   homothetyUsage=
-000413f0: 6b77 6172 6773 5b22 686f 6d6f 5f75 7361  kwargs["homo_usa
-00041400: 6765 225d 2c0d 0a20 2020 2020 2020 2020  ge"],..         
-00041410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041420: 2020 2068 6f6d 6f74 6865 7479 584c 6f63     homothetyXLoc
-00041430: 616c 3d6b 7761 7267 735b 2278 6c6f 6322  al=kwargs["xloc"
-00041440: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00041450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041460: 686f 6d6f 7468 6574 7958 5261 7469 6f3d  homothetyXRatio=
-00041470: 6b77 6172 6773 5b22 7872 225d 2c0d 0a20  kwargs["xr"],.. 
-00041480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041490: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
-000414a0: 6865 7479 594c 6f63 616c 3d6b 7761 7267  hetyYLocal=kwarg
-000414b0: 735b 2279 6c6f 6322 5d2c 0d0a 2020 2020  s["yloc"],..    
-000414c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000414d0: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
-000414e0: 7959 5261 7469 6f3d 6b77 6172 6773 5b22  yYRatio=kwargs["
-000414f0: 7972 225d 2c0d 0a20 2020 2020 2020 2020  yr"],..         
-00041500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041510: 2020 2068 6f6d 6f74 6865 7479 5a4c 6f63     homothetyZLoc
-00041520: 616c 3d6b 7761 7267 735b 227a 6c6f 6322  al=kwargs["zloc"
-00041530: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00041540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041550: 686f 6d6f 7468 6574 795a 5261 7469 6f3d  homothetyZRatio=
-00041560: 6b77 6172 6773 5b22 7a72 225d 2c0d 0a20  kwargs["zr"],.. 
-00041570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041580: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
-00041590: 696f 6e55 7361 6765 3d6b 7761 7267 735b  ionUsage=kwargs[
-000415a0: 2272 6f74 5f75 7361 6765 225d 2c20 2020  "rot_usage"],   
-000415b0: 2020 2020 2020 2020 2023 2074 6f6c 6572           # toler
-000415c0: 616e 6365 206f 7220 6e6f 740d 0a20 2020  ance or not..   
-000415d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000415e0: 2020 2020 2020 2020 2072 6f74 6174 696f           rotatio
-000415f0: 6e41 7a69 6d75 7468 4c6f 6361 6c3d 6b77  nAzimuthLocal=kw
-00041600: 6172 6773 5b22 726f 7441 7a69 4c6f 6322  args["rotAziLoc"
-00041610: 5d2c 2023 2020 2020 726f 7461 7469 6f6e  ], #    rotation
-00041620: 2061 6363 6f72 6469 6e67 2074 6f20 617a   according to az
-00041630: 696d 7574 683a 2067 6c6f 6261 6c0d 0a20  imuth: global.. 
-00041640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041650: 2020 2020 2020 2020 2020 2072 6f74 6174             rotat
-00041660: 696f 6e41 7a69 6d75 7468 3d6b 7761 7267  ionAzimuth=kwarg
-00041670: 735b 2272 6f74 417a 6922 5d2c 0d0a 2020  s["rotAzi"],..  
-00041680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041690: 2020 2020 2020 2020 2020 726f 7461 7469            rotati
-000416a0: 6f6e 4469 704c 6f63 616c 3d6b 7761 7267  onDipLocal=kwarg
-000416b0: 735b 2272 6f74 4469 704c 6f63 225d 2c0d  s["rotDipLoc"],.
-000416c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000416d0: 2020 2020 2020 2020 2020 2020 2072 6f74               rot
-000416e0: 6174 696f 6e44 6970 3d6b 7761 7267 735b  ationDip=kwargs[
-000416f0: 2272 6f74 4469 7022 5d2c 0d0a 2020 2020  "rotDip"],..    
-00041700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041710: 2020 2020 2020 2020 726f 7461 7469 6f6e          rotation
-00041720: 506c 756e 6765 4c6f 6361 6c3d 6b77 6172  PlungeLocal=kwar
-00041730: 6773 5b22 726f 7450 6c75 6e67 654c 6f63  gs["rotPlungeLoc
-00041740: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
-00041750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041760: 2072 6f74 6174 696f 6e50 6c75 6e67 653d   rotationPlunge=
-00041770: 6b77 6172 6773 5b22 726f 7450 6c75 6e67  kwargs["rotPlung
-00041780: 6522 5d2c 0d0a 2020 2020 2020 2020 2020  e"],..          
+000412d0: 2020 2020 2073 783d 7378 2c20 7379 3d73       sx=sx, sy=s
+000412e0: 792c 2073 7a3d 737a 2c20 2020 2020 2320  y, sz=sz,     # 
+000412f0: 6365 6c6c 7320 756e 6974 7320 696e 2074  cells units in t
+00041300: 6865 2073 696d 756c 6174 696f 6e20 6772  he simulation gr
+00041310: 6964 2028 6865 7265 2061 7265 2074 6865  id (here are the
+00041320: 2064 6566 6175 6c74 2076 616c 7565 7329   default values)
+00041330: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041340: 2020 2020 2020 2020 2020 2020 2020 6f78                ox
+00041350: 3d6f 782c 206f 793d 6f79 2c20 6f7a 3d6f  =ox, oy=oy, oz=o
+00041360: 7a2c 2020 2020 2023 206f 7269 6769 6e20  z,     # origin 
+00041370: 6f66 2074 6865 2073 696d 756c 6174 696f  of the simulatio
+00041380: 6e20 6772 6964 2028 6865 7265 2061 7265  n grid (here are
+00041390: 2074 6865 2064 6566 6175 6c74 2076 616c   the default val
+000413a0: 7565 7329 0d0a 2020 2020 2020 2020 2020  ues)..          
+000413b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000413c0: 2020 6e76 3d6b 7761 7267 735b 226e 7622    nv=kwargs["nv"
+000413d0: 5d2c 2076 6172 6e61 6d65 3d6b 7761 7267  ], varname=kwarg
+000413e0: 735b 2276 6172 6e61 6d65 225d 2c20 2020  s["varname"],   
+000413f0: 2020 2020 2320 6e75 6d62 6572 206f 6620      # number of 
+00041400: 7661 7269 6162 6c65 2873 292c 206e 616d  variable(s), nam
+00041410: 6520 6f66 2074 6865 2076 6172 6961 626c  e of the variabl
+00041420: 6528 7329 0d0a 2020 2020 2020 2020 2020  e(s)..          
+00041430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041440: 2020 6e54 493d 312c 2054 493d 5449 2c20    nTI=1, TI=TI, 
+00041450: 2020 2020 2020 2020 2020 2020 2320 6e75              # nu
+00041460: 6d62 6572 206f 6620 5449 2873 292c 2054  mber of TI(s), T
+00041470: 4920 2863 6c61 7373 2064 7369 2e49 6d67  I (class dsi.Img
+00041480: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00041490: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000414a0: 6174 6150 6f69 6e74 5365 743d 7074 2c20  ataPointSet=pt, 
+000414b0: 2020 2020 2020 2020 2020 2023 2068 6172             # har
+000414c0: 6420 6461 7461 2028 6f70 7469 6f6e 616c  d data (optional
+000414d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000414e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000414f0: 6174 6149 6d61 6765 203d 206b 7761 7267  ataImage = kwarg
+00041500: 735b 2264 6174 6149 6d61 6765 225d 2c0d  s["dataImage"],.
+00041510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041520: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00041530: 7075 7456 6172 466c 6167 203d 206b 7761  putVarFlag = kwa
+00041540: 7267 735b 226f 7574 7075 7456 6172 466c  rgs["outputVarFl
+00041550: 6167 225d 2c0d 0a20 2020 2020 2020 2020  ag"],..         
+00041560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041570: 2020 2064 6973 7461 6e63 6554 7970 6520     distanceType 
+00041580: 3d20 6b77 6172 6773 5b22 6469 7374 616e  = kwargs["distan
+00041590: 6365 5479 7065 225d 2c20 2023 2064 6973  ceType"],  # dis
+000415a0: 7461 6e63 6520 7479 7065 3a20 7072 6f70  tance type: prop
+000415b0: 6f72 7469 6f6e 206f 6620 6d69 736d 6174  ortion of mismat
+000415c0: 6368 696e 6720 6e6f 6465 7320 2863 6174  ching nodes (cat
+000415d0: 6567 6f72 6963 616c 2076 6172 2e2c 2064  egorical var., d
+000415e0: 6566 6175 6c74 290d 0a20 2020 2020 2020  efault)..       
+000415f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041600: 2020 2020 2073 6f66 7450 726f 6261 6269       softProbabi
+00041610: 6c69 7479 3d73 705f 6c2c 0d0a 2020 2020  lity=sp_l,..    
+00041620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041630: 2020 2020 2020 2020 7365 6172 6368 4e65          searchNe
+00041640: 6967 6862 6f72 686f 6f64 5061 7261 6d65  ighborhoodParame
+00041650: 7465 7273 3d73 6e70 5f6c 2c0d 0a20 2020  ters=snp_l,..   
+00041660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041670: 2020 2020 2020 2020 2068 6f6d 6f74 6865           homothe
+00041680: 7479 5573 6167 653d 6b77 6172 6773 5b22  tyUsage=kwargs["
+00041690: 686f 6d6f 5f75 7361 6765 225d 2c0d 0a20  homo_usage"],.. 
+000416a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000416b0: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
+000416c0: 6865 7479 584c 6f63 616c 3d6b 7761 7267  hetyXLocal=kwarg
+000416d0: 735b 2278 6c6f 6322 5d2c 0d0a 2020 2020  s["xloc"],..    
+000416e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000416f0: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
+00041700: 7958 5261 7469 6f3d 6b77 6172 6773 5b22  yXRatio=kwargs["
+00041710: 7872 225d 2c0d 0a20 2020 2020 2020 2020  xr"],..         
+00041720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041730: 2020 2068 6f6d 6f74 6865 7479 594c 6f63     homothetyYLoc
+00041740: 616c 3d6b 7761 7267 735b 2279 6c6f 6322  al=kwargs["yloc"
+00041750: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00041760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041770: 686f 6d6f 7468 6574 7959 5261 7469 6f3d  homothetyYRatio=
+00041780: 6b77 6172 6773 5b22 7972 225d 2c0d 0a20  kwargs["yr"],.. 
 00041790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000417a0: 2020 6e6e 6569 6768 626f 7269 6e67 4e6f    nneighboringNo
-000417b0: 6465 3d6b 7761 7267 735b 226e 6569 6722  de=kwargs["neig"
-000417c0: 5d2c 2020 2020 2020 2020 2320 6d61 782e  ],        # max.
-000417d0: 206e 756d 6265 7220 6f66 206e 6569 6768   number of neigh
-000417e0: 626f 7273 2028 666f 7220 7468 6520 7061  bors (for the pa
-000417f0: 7474 6572 6e73 290d 0a20 2020 2020 2020  tterns)..       
-00041800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041810: 2020 2020 2064 6973 7461 6e63 6554 6872       distanceThr
-00041820: 6573 686f 6c64 3d6b 7761 7267 735b 2274  eshold=kwargs["t
-00041830: 6872 6573 6822 5d2c 2020 2020 2023 2061  hresh"],     # a
-00041840: 6363 6570 7461 7469 6f6e 2074 6872 6573  cceptation thres
-00041850: 686f 6c64 2028 666f 7220 6469 7374 616e  hold (for distan
-00041860: 6365 2062 6574 7765 656e 2070 6174 7465  ce between patte
-00041870: 726e 7329 0d0a 2020 2020 2020 2020 2020  rns)..          
-00041880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041890: 2020 6d61 7853 6361 6e46 7261 6374 696f    maxScanFractio
-000418a0: 6e3d 6b77 6172 6773 5b22 6d61 7873 6361  n=kwargs["maxsca
-000418b0: 6e22 5d2c 2020 2020 2020 2023 206d 6178  n"],       # max
-000418c0: 2e20 7363 616e 6e65 6420 6672 6163 7469  . scanned fracti
-000418d0: 6f6e 206f 6620 7468 6520 5449 2028 666f  on of the TI (fo
-000418e0: 7220 7369 6d75 6c61 7469 6f6e 206f 6620  r simulation of 
-000418f0: 6561 6368 2063 656c 6c29 0d0a 2020 2020  each cell)..    
-00041900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041910: 2020 2020 2020 2020 6e70 6f73 7450 726f          npostPro
-00041920: 6365 7373 696e 6750 6174 684d 6178 3d6b  cessingPathMax=k
-00041930: 7761 7267 735b 226e 706f 7374 225d 2c20  wargs["npost"], 
-00041940: 2020 2320 6e75 6d62 6572 206f 6620 706f    # number of po
-00041950: 7374 2d70 726f 6365 7373 696e 6720 7061  st-processing pa
-00041960: 7468 2873 290d 0a20 2020 2020 2020 2020  th(s)..         
-00041970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041980: 2020 2073 6565 643d 7365 6564 2c20 2020     seed=seed,   
-00041990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419a0: 2320 7365 6564 2028 696e 6974 6961 6c69  # seed (initiali
-000419b0: 7a61 7469 6f6e 206f 6620 7468 6520 7261  zation of the ra
-000419c0: 6e64 6f6d 206e 756d 6265 7220 6765 6e65  ndom number gene
-000419d0: 7261 746f 7229 0d0a 2020 2020 2020 2020  rator)..        
+000417a0: 2020 2020 2020 2020 2020 2068 6f6d 6f74             homot
+000417b0: 6865 7479 5a4c 6f63 616c 3d6b 7761 7267  hetyZLocal=kwarg
+000417c0: 735b 227a 6c6f 6322 5d2c 0d0a 2020 2020  s["zloc"],..    
+000417d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000417e0: 2020 2020 2020 2020 686f 6d6f 7468 6574          homothet
+000417f0: 795a 5261 7469 6f3d 6b77 6172 6773 5b22  yZRatio=kwargs["
+00041800: 7a72 225d 2c0d 0a20 2020 2020 2020 2020  zr"],..         
+00041810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041820: 2020 2072 6f74 6174 696f 6e55 7361 6765     rotationUsage
+00041830: 3d6b 7761 7267 735b 2272 6f74 5f75 7361  =kwargs["rot_usa
+00041840: 6765 225d 2c20 2020 2020 2020 2020 2020  ge"],           
+00041850: 2023 2074 6f6c 6572 616e 6365 206f 7220   # tolerance or 
+00041860: 6e6f 740d 0a20 2020 2020 2020 2020 2020  not..           
+00041870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041880: 2072 6f74 6174 696f 6e41 7a69 6d75 7468   rotationAzimuth
+00041890: 4c6f 6361 6c3d 6b77 6172 6773 5b22 726f  Local=kwargs["ro
+000418a0: 7441 7a69 4c6f 6322 5d2c 2023 2020 2020  tAziLoc"], #    
+000418b0: 726f 7461 7469 6f6e 2061 6363 6f72 6469  rotation accordi
+000418c0: 6e67 2074 6f20 617a 696d 7574 683a 2067  ng to azimuth: g
+000418d0: 6c6f 6261 6c0d 0a20 2020 2020 2020 2020  lobal..         
+000418e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000418f0: 2020 2072 6f74 6174 696f 6e41 7a69 6d75     rotationAzimu
+00041900: 7468 3d6b 7761 7267 735b 2272 6f74 417a  th=kwargs["rotAz
+00041910: 6922 5d2c 0d0a 2020 2020 2020 2020 2020  i"],..          
+00041920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041930: 2020 726f 7461 7469 6f6e 4469 704c 6f63    rotationDipLoc
+00041940: 616c 3d6b 7761 7267 735b 2272 6f74 4469  al=kwargs["rotDi
+00041950: 704c 6f63 225d 2c0d 0a20 2020 2020 2020  pLoc"],..       
+00041960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041970: 2020 2020 2072 6f74 6174 696f 6e44 6970       rotationDip
+00041980: 3d6b 7761 7267 735b 2272 6f74 4469 7022  =kwargs["rotDip"
+00041990: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+000419a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000419b0: 726f 7461 7469 6f6e 506c 756e 6765 4c6f  rotationPlungeLo
+000419c0: 6361 6c3d 6b77 6172 6773 5b22 726f 7450  cal=kwargs["rotP
+000419d0: 6c75 6e67 654c 6f63 225d 2c0d 0a20 2020  lungeLoc"],..   
 000419e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419f0: 2020 2020 6e72 6561 6c69 7a61 7469 6f6e      nrealization
-00041a00: 3d6e 7265 616c 2c20 2020 2020 2020 2020  =nreal,         
-00041a10: 2320 6e75 6d62 6572 206f 6620 7265 616c  # number of real
-00041a20: 697a 6174 696f 6e28 7329 0d0a 2020 2020  ization(s)..    
-00041a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a40: 2020 2020 2020 2020 6d61 736b 3d6d 6173          mask=mas
-00041a50: 6b29 2020 2020 2020 2020 2020 2020 2020  k)              
-00041a60: 2020 2023 206e 6370 750d 0a0d 0a20 2020     # ncpu....   
-00041a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041a80: 2020 2020 2064 6565 7373 655f 6f75 7470       deesse_outp
-00041a90: 7574 3d64 7369 2e64 6565 7373 6552 756e  ut=dsi.deesseRun
-00041aa0: 2864 6565 7373 655f 696e 7075 742c 206e  (deesse_input, n
-00041ab0: 7468 7265 6164 733d 4172 6368 5461 626c  threads=ArchTabl
-00041ac0: 652e 6e63 7075 2c20 7665 7262 6f73 653d  e.ncpu, verbose=
-00041ad0: 7665 7262 6f73 6529 0d0a 0d0a 2020 2020  verbose)....    
-00041ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041af0: 2020 2020 7369 6d75 733d 6465 6573 7365      simus=deesse
-00041b00: 5f6f 7574 7075 745b 2273 696d 225d 0d0a  _output["sim"]..
+000419f0: 2020 2020 2020 2020 2072 6f74 6174 696f           rotatio
+00041a00: 6e50 6c75 6e67 653d 6b77 6172 6773 5b22  nPlunge=kwargs["
+00041a10: 726f 7450 6c75 6e67 6522 5d2c 0d0a 2020  rotPlunge"],..  
+00041a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041a30: 2020 2020 2020 2020 2020 6e6e 6569 6768            nneigh
+00041a40: 626f 7269 6e67 4e6f 6465 3d6b 7761 7267  boringNode=kwarg
+00041a50: 735b 226e 6569 6722 5d2c 2020 2020 2020  s["neig"],      
+00041a60: 2020 2320 6d61 782e 206e 756d 6265 7220    # max. number 
+00041a70: 6f66 206e 6569 6768 626f 7273 2028 666f  of neighbors (fo
+00041a80: 7220 7468 6520 7061 7474 6572 6e73 290d  r the patterns).
+00041a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041aa0: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+00041ab0: 7461 6e63 6554 6872 6573 686f 6c64 3d6b  tanceThreshold=k
+00041ac0: 7761 7267 735b 2274 6872 6573 6822 5d2c  wargs["thresh"],
+00041ad0: 2020 2020 2023 2061 6363 6570 7461 7469       # acceptati
+00041ae0: 6f6e 2074 6872 6573 686f 6c64 2028 666f  on threshold (fo
+00041af0: 7220 6469 7374 616e 6365 2062 6574 7765  r distance betwe
+00041b00: 656e 2070 6174 7465 726e 7329 0d0a 2020  en patterns)..  
 00041b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041b20: 2020 2020 2020 2020 666f 7220 6972 6561          for irea
-00041b30: 6c20 696e 2072 616e 6765 286e 7265 616c  l in range(nreal
-00041b40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00041b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041b60: 7369 6d3d 7369 6d75 735b 6972 6561 6c5d  sim=simus[ireal]
-00041b70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00041b80: 2020 2020 2020 2020 2020 2020 2020 2373                #s
-00041b90: 656c 662e 6661 6369 6573 5f64 6f6d 6169  elf.facies_domai
-00041ba0: 6e73 5b69 752c 2069 7265 616c 5d3d 7369  ns[iu, ireal]=si
-00041bb0: 6d2e 7661 6c5b 305d 2023 6f75 7470 7574  m.val[0] #output
-00041bc0: 2069 6e20 6661 6369 6573 5f64 6f6d 6169   in facies_domai
-00041bd0: 6e73 0d0a 2020 2020 2020 2020 2020 2020  ns..            
-00041be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041bf0: 6661 6369 6573 5f64 6f6d 6169 6e73 5b69  facies_domains[i
-00041c00: 752c 2069 7265 616c 5d5b 6d61 736b 5d3d  u, ireal][mask]=
-00041c10: 7369 6d2e 7661 6c5b 305d 5b6d 6173 6b5d  sim.val[0][mask]
-00041c20: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00041c30: 2020 2020 2020 2020 656c 6966 206d 6574          elif met
-00041c40: 686f 6420 3d3d 2022 5450 4773 223a 2023  hod == "TPGs": #
-00041c50: 7472 756e 6361 7465 6420 2870 6c75 7269  truncated (pluri
-00041c60: 2967 6175 7373 6961 6e0d 0a0d 0a20 2020  )gaussian....   
+00041b20: 2020 2020 2020 2020 2020 6d61 7853 6361            maxSca
+00041b30: 6e46 7261 6374 696f 6e3d 6b77 6172 6773  nFraction=kwargs
+00041b40: 5b22 6d61 7873 6361 6e22 5d2c 2020 2020  ["maxscan"],    
+00041b50: 2020 2023 206d 6178 2e20 7363 616e 6e65     # max. scanne
+00041b60: 6420 6672 6163 7469 6f6e 206f 6620 7468  d fraction of th
+00041b70: 6520 5449 2028 666f 7220 7369 6d75 6c61  e TI (for simula
+00041b80: 7469 6f6e 206f 6620 6561 6368 2063 656c  tion of each cel
+00041b90: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+00041ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041bb0: 6e70 6f73 7450 726f 6365 7373 696e 6750  npostProcessingP
+00041bc0: 6174 684d 6178 3d6b 7761 7267 735b 226e  athMax=kwargs["n
+00041bd0: 706f 7374 225d 2c20 2020 2320 6e75 6d62  post"],   # numb
+00041be0: 6572 206f 6620 706f 7374 2d70 726f 6365  er of post-proce
+00041bf0: 7373 696e 6720 7061 7468 2873 290d 0a20  ssing path(s).. 
+00041c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041c10: 2020 2020 2020 2020 2020 2073 6565 643d             seed=
+00041c20: 7365 6564 2c20 2020 2020 2020 2020 2020  seed,           
+00041c30: 2020 2020 2020 2020 2320 7365 6564 2028          # seed (
+00041c40: 696e 6974 6961 6c69 7a61 7469 6f6e 206f  initialization o
+00041c50: 6620 7468 6520 7261 6e64 6f6d 206e 756d  f the random num
+00041c60: 6265 7220 6765 6e65 7261 746f 7229 0d0a  ber generator)..
 00041c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041c80: 2020 2020 2023 6c6f 6164 2070 6172 616d       #load param
-00041c90: 7323 0d0a 2020 2020 2020 2020 2020 2020  s#..            
-00041ca0: 2020 2020 2020 2020 2020 2020 666c 6167              flag
-00041cb0: 3d73 656c 662e 666c 6167 0d0a 2020 2020  =self.flag..    
-00041cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041cd0: 2020 2020 475f 636d 3d73 656c 662e 475f      G_cm=self.G_
-00041ce0: 636d 0d0a 2020 2020 2020 2020 2020 2020  cm..            
-00041cf0: 2020 2020 2020 2020 2020 2020 2323 2064              ## d
-00041d00: 6174 6120 666f 726d 6174 2023 230d 0a20  ata format ##.. 
-00041d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041d20: 2020 2020 2020 2023 2064 6174 613d 2878         # data=(x
-00041d30: 2c20 792c 207a 2c20 6731 2c20 6732 2c20  , y, z, g1, g2, 
-00041d40: 7629 2c20 7768 6572 6520 782c 2079 2c20  v), where x, y, 
-00041d50: 7a20 6172 6520 7468 6520 6361 7274 6573  z are the cartes
-00041d60: 6961 6e20 636f 6f72 6469 6e61 7465 732c  ian coordinates,
-00041d70: 2067 3120 616e 6420 6732 2061 7265 2074   g1 and g2 are t
-00041d80: 6865 2076 616c 7565 7320 6f66 200d 0a20  he values of .. 
-00041d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041da0: 2020 2020 2020 2023 2066 6972 7374 2f73         # first/s
-00041db0: 6563 6f6e 6420 6761 7573 7369 616e 2066  econd gaussian f
-00041dc0: 6965 6c64 7320 616e 6420 7620 6973 2074  ields and v is t
-00041dd0: 6865 2066 6163 6965 7320 7661 6c75 650d  he facies value.
-00041de0: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00041df0: 2020 2020 2020 2020 2020 2023 2320 7365             ## se
-00041e00: 7475 7020 616e 6420 6765 7420 6861 7264  tup and get hard
-00041e10: 2064 6174 610d 0a20 2020 2020 2020 2020   data..         
-00041e20: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00041e30: 643d 6e70 2e61 7272 6179 285b 5d29 0d0a  d=np.array([])..
-00041e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e50: 2020 2020 2020 2020 666f 7220 6661 2069          for fa i
-00041e60: 6e20 6c69 7374 5f6f 626a 3a0d 0a20 2020  n list_obj:..   
+00041c80: 2020 2020 2020 2020 2020 2020 6e72 6561              nrea
+00041c90: 6c69 7a61 7469 6f6e 3d6e 7265 616c 2c20  lization=nreal, 
+00041ca0: 2020 2020 2020 2020 2320 6e75 6d62 6572          # number
+00041cb0: 206f 6620 7265 616c 697a 6174 696f 6e28   of realization(
+00041cc0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
+00041cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041ce0: 6d61 736b 3d6d 6173 6b29 2020 2020 2020  mask=mask)      
+00041cf0: 2020 2020 2020 2020 2020 2023 206e 6370             # ncp
+00041d00: 750d 0a0d 0a20 2020 2020 2020 2020 2020  u....           
+00041d10: 2020 2020 2020 2020 2020 2020 2064 6565               dee
+00041d20: 7373 655f 6f75 7470 7574 3d64 7369 2e64  sse_output=dsi.d
+00041d30: 6565 7373 6552 756e 2864 6565 7373 655f  eesseRun(deesse_
+00041d40: 696e 7075 742c 206e 7468 7265 6164 733d  input, nthreads=
+00041d50: 4172 6368 5461 626c 652e 6e63 7075 2c20  ArchTable.ncpu, 
+00041d60: 7665 7262 6f73 653d 7665 7262 6f73 6529  verbose=verbose)
+00041d70: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00041d80: 2020 2020 2020 2020 2020 2020 7369 6d75              simu
+00041d90: 733d 6465 6573 7365 5f6f 7574 7075 745b  s=deesse_output[
+00041da0: 2273 696d 225d 0d0a 2020 2020 2020 2020  "sim"]..        
+00041db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041dc0: 666f 7220 6972 6561 6c20 696e 2072 616e  for ireal in ran
+00041dd0: 6765 286e 7265 616c 293a 0d0a 2020 2020  ge(nreal):..    
+00041de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041df0: 2020 2020 2020 2020 7369 6d3d 7369 6d75          sim=simu
+00041e00: 735b 6972 6561 6c5d 0d0a 2020 2020 2020  s[ireal]..      
+00041e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041e20: 2020 2020 2020 2373 656c 662e 6661 6369        #self.faci
+00041e30: 6573 5f64 6f6d 6169 6e73 5b69 752c 2069  es_domains[iu, i
+00041e40: 7265 616c 5d3d 7369 6d2e 7661 6c5b 305d  real]=sim.val[0]
+00041e50: 2023 6f75 7470 7574 2069 6e20 6661 6369   #output in faci
+00041e60: 6573 5f64 6f6d 6169 6e73 0d0a 2020 2020  es_domains..    
 00041e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e80: 2020 2020 2020 2020 2023 6e64 6172 7261           #ndarra
-00041e90: 790d 0a20 2020 2020 2020 2020 2020 2020  y..             
-00041ea0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00041eb0: 643d 6c65 6e28 6661 2e78 290d 0a20 2020  d=len(fa.x)..   
+00041e80: 2020 2020 2020 2020 6661 6369 6573 5f64          facies_d
+00041e90: 6f6d 6169 6e73 5b69 752c 2069 7265 616c  omains[iu, ireal
+00041ea0: 5d5b 6d61 736b 5d3d 7369 6d2e 7661 6c5b  ][mask]=sim.val[
+00041eb0: 305d 5b6d 6173 6b5d 0d0a 0d0a 2020 2020  0][mask]....    
 00041ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041ed0: 2020 2020 2020 2020 2066 615f 783d 6e70           fa_x=np
-00041ee0: 2e61 7272 6179 2866 612e 7829 0d0a 2020  .array(fa.x)..  
-00041ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f00: 2020 2020 2020 2020 2020 6661 5f79 3d6e            fa_y=n
-00041f10: 702e 6172 7261 7928 6661 2e79 290d 0a20  p.array(fa.y).. 
-00041f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f30: 2020 2020 2020 2020 2020 2066 615f 7a3d             fa_z=
-00041f40: 6e70 2e61 7272 6179 2866 612e 7a29 0d0a  np.array(fa.z)..
-00041f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041f60: 2020 2020 2020 2020 2020 2020 6661 6369              faci
-00041f70: 6573 3d66 612e 4944 2a6e 702e 6f6e 6573  es=fa.ID*np.ones
-00041f80: 286e 6429 2320 6170 7065 6e64 2066 6163  (nd)# append fac
-00041f90: 6965 7320 4944 730d 0a0d 0a20 2020 2020  ies IDs....     
-00041fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041fb0: 2020 2020 2020 2068 643d 6e70 2e63 6f6e         hd=np.con
-00041fc0: 6361 7465 6e61 7465 285b 6864 2e72 6573  catenate([hd.res
-00041fd0: 6861 7065 282d 312c 2036 292c 206e 702e  hape(-1, 6), np.
-00041fe0: 636f 6e63 6174 656e 6174 6528 5b5b 6661  concatenate([[fa
-00041ff0: 5f78 5d2c 205b 6661 5f79 5d2c 205b 6661  _x], [fa_y], [fa
-00042000: 5f7a 5d2c 205b 6e70 2e7a 6572 6f73 286e  _z], [np.zeros(n
-00042010: 6429 5d2c 205b 6e70 2e7a 6572 6f73 286e  d)], [np.zeros(n
-00042020: 6429 5d2c 205b 6661 6369 6573 5d5d 2c20  d)], [facies]], 
-00042030: 6178 6973 3d30 292e 545d 2920 2320 6170  axis=0).T]) # ap
-00042040: 7065 6e64 2064 6174 6120 666f 7220 696e  pend data for in
-00042050: 7075 7420 5450 4773 0d0a 0d0a 2020 2020  put TPGs....    
-00042060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042070: 2020 2020 6966 2068 642e 7368 6170 655b      if hd.shape[
-00042080: 305d 203d 3d20 303a 0d0a 2020 2020 2020  0] == 0:..      
-00042090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420a0: 2020 2020 2020 6864 3d4e 6f6e 650d 0a20        hd=None.. 
+00041ed0: 656c 6966 206d 6574 686f 6420 3d3d 2022  elif method == "
+00041ee0: 5450 4773 223a 2023 7472 756e 6361 7465  TPGs": #truncate
+00041ef0: 6420 2870 6c75 7269 2967 6175 7373 6961  d (pluri)gaussia
+00041f00: 6e0d 0a0d 0a20 2020 2020 2020 2020 2020  n....           
+00041f10: 2020 2020 2020 2020 2020 2020 2023 6c6f               #lo
+00041f20: 6164 2070 6172 616d 7323 0d0a 2020 2020  ad params#..    
+00041f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f40: 2020 2020 666c 6167 3d73 656c 662e 666c      flag=self.fl
+00041f50: 6167 0d0a 2020 2020 2020 2020 2020 2020  ag..            
+00041f60: 2020 2020 2020 2020 2020 2020 475f 636d              G_cm
+00041f70: 3d73 656c 662e 475f 636d 0d0a 2020 2020  =self.G_cm..    
+00041f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041f90: 2020 2020 2323 2064 6174 6120 666f 726d      ## data form
+00041fa0: 6174 2023 230d 0a20 2020 2020 2020 2020  at ##..         
+00041fb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00041fc0: 2064 6174 613d 2878 2c20 792c 207a 2c20   data=(x, y, z, 
+00041fd0: 6731 2c20 6732 2c20 7629 2c20 7768 6572  g1, g2, v), wher
+00041fe0: 6520 782c 2079 2c20 7a20 6172 6520 7468  e x, y, z are th
+00041ff0: 6520 6361 7274 6573 6961 6e20 636f 6f72  e cartesian coor
+00042000: 6469 6e61 7465 732c 2067 3120 616e 6420  dinates, g1 and 
+00042010: 6732 2061 7265 2074 6865 2076 616c 7565  g2 are the value
+00042020: 7320 6f66 200d 0a20 2020 2020 2020 2020  s of ..         
+00042030: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00042040: 2066 6972 7374 2f73 6563 6f6e 6420 6761   first/second ga
+00042050: 7573 7369 616e 2066 6965 6c64 7320 616e  ussian fields an
+00042060: 6420 7620 6973 2074 6865 2066 6163 6965  d v is the facie
+00042070: 7320 7661 6c75 650d 0a0d 0a20 2020 2020  s value....     
+00042080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042090: 2020 2023 2320 7365 7475 7020 616e 6420     ## setup and 
+000420a0: 6765 7420 6861 7264 2064 6174 610d 0a20  get hard data.. 
 000420b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000420c0: 2020 2020 2020 2073 696d 7573 3d72 756e         simus=run
-000420d0: 5f74 7067 7328 6e72 6561 6c2c 2078 672c  _tpgs(nreal, xg,
-000420e0: 2079 672c 207a 672c 2068 642c 2047 5f63   yg, zg, hd, G_c
-000420f0: 6d2c 2066 6c61 672c 206e 6d61 783d 6b77  m, flag, nmax=kw
-00042100: 6172 6773 5b22 6e65 6967 225d 2c20 6772  args["neig"], gr
-00042110: 665f 6d65 7468 6f64 3d6b 7761 7267 735b  f_method=kwargs[
-00042120: 2267 7266 5f6d 6574 686f 6422 5d2c 206d  "grf_method"], m
-00042130: 6173 6b3d 6d61 736b 290d 0a20 2020 2020  ask=mask)..     
-00042140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042150: 2020 2066 6f72 2069 7265 616c 2069 6e20     for ireal in 
-00042160: 7261 6e67 6528 6e72 6561 6c29 3a0d 0a20  range(nreal):.. 
-00042170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042180: 2020 2020 2020 2020 2020 2067 7269 643d             grid=
-00042190: 7369 6d75 735b 6972 6561 6c5d 0d0a 2020  simus[ireal]..  
-000421a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000421b0: 2020 2020 2020 2020 2020 6772 6964 5b6d            grid[m
-000421c0: 6173 6b3d 3d30 5d3d 6e70 2e6e 616e 2020  ask==0]=np.nan  
-000421d0: 2320 6578 7472 6163 7420 6f6e 6c79 2074  # extract only t
-000421e0: 6865 2070 6172 7420 6f6e 2074 6865 2072  he part on the r
-000421f0: 6561 6c20 646f 6d61 696e 0d0a 2020 2020  eal domain..    
-00042200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042210: 2020 2020 2020 2020 6661 6369 6573 5f64          facies_d
-00042220: 6f6d 6169 6e73 5b69 752c 2069 7265 616c  omains[iu, ireal
-00042230: 5d5b 6d61 736b 5d3d 6772 6964 5b6d 6173  ][mask]=grid[mas
-00042240: 6b5d 0d0a 0d0a 2020 2020 2020 2020 2020  k]....          
-00042250: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
-00042260: 6574 686f 6420 3d3d 2022 6e65 6172 6573  ethod == "neares
-00042270: 7422 3a0d 0a20 2020 2020 2020 2020 2020  t":..           
-00042280: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00042290: 4172 6368 5461 626c 652e 7665 7262 6f73  ArchTable.verbos
-000422a0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000422b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000422c0: 7072 696e 7428 223c 3d3d 3d4e 6561 7265  print("<===Neare
-000422d0: 7374 206e 6569 6768 626f 7273 2069 6e74  st neighbors int
-000422e0: 6572 706f 6c61 7469 6f6e 3d3d 3d3e 2229  erpolation===>")
+000420c0: 2020 2020 2020 2068 643d 6e70 2e61 7272         hd=np.arr
+000420d0: 6179 285b 5d29 0d0a 2020 2020 2020 2020  ay([])..        
+000420e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000420f0: 666f 7220 6661 2069 6e20 6c69 7374 5f6f  for fa in list_o
+00042100: 626a 3a0d 0a20 2020 2020 2020 2020 2020  bj:..           
+00042110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042120: 2023 6e64 6172 7261 790d 0a20 2020 2020   #ndarray..     
+00042130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042140: 2020 2020 2020 206e 643d 6c65 6e28 6661         nd=len(fa
+00042150: 2e78 290d 0a20 2020 2020 2020 2020 2020  .x)..           
+00042160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042170: 2066 615f 783d 6e70 2e61 7272 6179 2866   fa_x=np.array(f
+00042180: 612e 7829 0d0a 2020 2020 2020 2020 2020  a.x)..          
+00042190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000421a0: 2020 6661 5f79 3d6e 702e 6172 7261 7928    fa_y=np.array(
+000421b0: 6661 2e79 290d 0a20 2020 2020 2020 2020  fa.y)..         
+000421c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000421d0: 2020 2066 615f 7a3d 6e70 2e61 7272 6179     fa_z=np.array
+000421e0: 2866 612e 7a29 0d0a 2020 2020 2020 2020  (fa.z)..        
+000421f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042200: 2020 2020 6661 6369 6573 3d66 612e 4944      facies=fa.ID
+00042210: 2a6e 702e 6f6e 6573 286e 6429 2320 6170  *np.ones(nd)# ap
+00042220: 7065 6e64 2066 6163 6965 7320 4944 730d  pend facies IDs.
+00042230: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00042240: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00042250: 643d 6e70 2e63 6f6e 6361 7465 6e61 7465  d=np.concatenate
+00042260: 285b 6864 2e72 6573 6861 7065 282d 312c  ([hd.reshape(-1,
+00042270: 2036 292c 206e 702e 636f 6e63 6174 656e   6), np.concaten
+00042280: 6174 6528 5b5b 6661 5f78 5d2c 205b 6661  ate([[fa_x], [fa
+00042290: 5f79 5d2c 205b 6661 5f7a 5d2c 205b 6e70  _y], [fa_z], [np
+000422a0: 2e7a 6572 6f73 286e 6429 5d2c 205b 6e70  .zeros(nd)], [np
+000422b0: 2e7a 6572 6f73 286e 6429 5d2c 205b 6661  .zeros(nd)], [fa
+000422c0: 6369 6573 5d5d 2c20 6178 6973 3d30 292e  cies]], axis=0).
+000422d0: 545d 2920 2320 6170 7065 6e64 2064 6174  T]) # append dat
+000422e0: 6120 666f 7220 696e 7075 7420 5450 4773  a for input TPGs
 000422f0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00042300: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00042310: 2073 6b6c 6561 726e 2e6e 6569 6768 626f   sklearn.neighbo
-00042320: 7273 2069 6d70 6f72 7420 4e65 6172 6573  rs import Neares
-00042330: 744e 6569 6768 626f 7273 0d0a 0d0a 2020  tNeighbors....  
-00042340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042350: 2020 2020 2020 5820 3d20 6e70 2e6f 6e65        X = np.one
-00042360: 7328 5b6e 7a2c 206e 792c 206e 785d 292a  s([nz, ny, nx])*
-00042370: 2041 7263 6854 6162 6c65 2e78 6763 0d0a   ArchTable.xgc..
-00042380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042390: 2020 2020 2020 2020 5920 3d20 6e70 2e6f          Y = np.o
-000423a0: 6e65 7328 5b6e 7a2c 206e 792c 206e 785d  nes([nz, ny, nx]
-000423b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000423c0: 2020 2020 2020 2020 2020 2059 5b3a 5d20             Y[:] 
-000423d0: 3d20 6e70 2e6f 6e65 7328 5b6e 782c 206e  = np.ones([nx, n
-000423e0: 795d 292e 5420 2a20 4172 6368 5461 626c  y]).T * ArchTabl
-000423f0: 652e 7967 632e 7265 7368 6170 6528 2d31  e.ygc.reshape(-1
-00042400: 2c20 3129 0d0a 2020 2020 2020 2020 2020  , 1)..          
-00042410: 2020 2020 2020 2020 2020 2020 2020 5a20                Z 
-00042420: 3d20 6e70 2e6f 6e65 7328 5b6e 7a2c 206e  = np.ones([nz, n
-00042430: 792c 206e 785d 290d 0a20 2020 2020 2020  y, nx])..       
+00042300: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+00042310: 642e 7368 6170 655b 305d 203d 3d20 303a  d.shape[0] == 0:
+00042320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042330: 2020 2020 2020 2020 2020 2020 2020 6864                hd
+00042340: 3d4e 6f6e 650d 0a20 2020 2020 2020 2020  =None..         
+00042350: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00042360: 696d 7573 3d72 756e 5f74 7067 7328 6e72  imus=run_tpgs(nr
+00042370: 6561 6c2c 2078 672c 2079 672c 207a 672c  eal, xg, yg, zg,
+00042380: 2068 642c 2047 5f63 6d2c 2066 6c61 672c   hd, G_cm, flag,
+00042390: 206e 6d61 783d 6b77 6172 6773 5b22 6e65   nmax=kwargs["ne
+000423a0: 6967 225d 2c20 6772 665f 6d65 7468 6f64  ig"], grf_method
+000423b0: 3d6b 7761 7267 735b 2267 7266 5f6d 6574  =kwargs["grf_met
+000423c0: 686f 6422 5d2c 206d 6173 6b3d 6d61 736b  hod"], mask=mask
+000423d0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000423e0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+000423f0: 7265 616c 2069 6e20 7261 6e67 6528 6e72  real in range(nr
+00042400: 6561 6c29 3a0d 0a20 2020 2020 2020 2020  eal):..         
+00042410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042420: 2020 2067 7269 643d 7369 6d75 735b 6972     grid=simus[ir
+00042430: 6561 6c5d 0d0a 2020 2020 2020 2020 2020  eal]..          
 00042440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042450: 205a 5b3a 2c20 3a5d 203d 2820 6e70 2e6f   Z[:, :] =( np.o
-00042460: 6e65 7328 5b6e 7a2c 206e 785d 2920 2a20  nes([nz, nx]) * 
-00042470: 4172 6368 5461 626c 652e 7a67 632e 7265  ArchTable.zgc.re
-00042480: 7368 6170 6528 2d31 2c20 3129 292e 7265  shape(-1, 1)).re
-00042490: 7368 6170 6528 6e7a 2c20 312c 206e 7829  shape(nz, 1, nx)
-000424a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000424b0: 2020 2020 2020 2020 2020 7875 3344 203d            xu3D =
-000424c0: 206e 702e 6172 7261 7928 5b58 2e66 6c61   np.array([X.fla
-000424d0: 7474 656e 2829 2c20 592e 666c 6174 7465  tten(), Y.flatte
-000424e0: 6e28 292c 205a 2e66 6c61 7474 656e 2829  n(), Z.flatten()
-000424f0: 5d29 2e54 0d0a 0d0a 2020 2020 2020 2020  ]).T....        
-00042500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042510: 2320 6765 7420 6861 7264 2064 6174 610d  # get hard data.
-00042520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042530: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-00042540: 203d 3d20 2266 6163 6965 7322 3a0d 0a20   == "facies":.. 
-00042550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042560: 2020 2020 2020 2020 2020 2068 642c 2066             hd, f
-00042570: 6163 6965 7320 3d20 4172 6368 5461 626c  acies = ArchTabl
-00042580: 652e 6864 5f66 615f 696e 5f75 6e69 7428  e.hd_fa_in_unit(
-00042590: 7365 6c66 2c20 6975 3d69 7529 0d0a 2020  self, iu=iu)..  
-000425a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000425b0: 2020 2020 2020 656c 6966 206d 6f64 6520        elif mode 
-000425c0: 3d3d 2022 756e 6974 7322 3a0d 0a20 2020  == "units":..   
-000425d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000425e0: 2020 2020 2020 2020 2068 642c 2066 6163           hd, fac
-000425f0: 6965 7320 3d20 4172 6368 5461 626c 652e  ies = ArchTable.
-00042600: 6864 5f75 6e5f 696e 5f75 6e69 7428 7365  hd_un_in_unit(se
-00042610: 6c66 2c20 6975 3d69 7529 0d0a 0d0a 2020  lf, iu=iu)....  
+00042450: 2020 6772 6964 5b6d 6173 6b3d 3d30 5d3d    grid[mask==0]=
+00042460: 6e70 2e6e 616e 2020 2320 6578 7472 6163  np.nan  # extrac
+00042470: 7420 6f6e 6c79 2074 6865 2070 6172 7420  t only the part 
+00042480: 6f6e 2074 6865 2072 6561 6c20 646f 6d61  on the real doma
+00042490: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
+000424a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000424b0: 6661 6369 6573 5f64 6f6d 6169 6e73 5b69  facies_domains[i
+000424c0: 752c 2069 7265 616c 5d5b 6d61 736b 5d3d  u, ireal][mask]=
+000424d0: 6772 6964 5b6d 6173 6b5d 0d0a 0d0a 2020  grid[mask]....  
+000424e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000424f0: 2020 656c 6966 206d 6574 686f 6420 3d3d    elif method ==
+00042500: 2022 6e65 6172 6573 7422 3a0d 0a20 2020   "nearest":..   
+00042510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042520: 2020 2020 2069 6620 4172 6368 5461 626c       if ArchTabl
+00042530: 652e 7665 7262 6f73 653a 0d0a 2020 2020  e.verbose:..    
+00042540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042550: 2020 2020 2020 2020 7072 696e 7428 223c          print("<
+00042560: 3d3d 3d4e 6561 7265 7374 206e 6569 6768  ===Nearest neigh
+00042570: 626f 7273 2069 6e74 6572 706f 6c61 7469  bors interpolati
+00042580: 6f6e 3d3d 3d3e 2229 0d0a 0d0a 2020 2020  on===>")....    
+00042590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000425a0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+000425b0: 2e6e 6569 6768 626f 7273 2069 6d70 6f72  .neighbors impor
+000425c0: 7420 4e65 6172 6573 744e 6569 6768 626f  t NearestNeighbo
+000425d0: 7273 0d0a 0d0a 2020 2020 2020 2020 2020  rs....          
+000425e0: 2020 2020 2020 2020 2020 2020 2020 5820                X 
+000425f0: 3d20 6e70 2e6f 6e65 7328 5b6e 7a2c 206e  = np.ones([nz, n
+00042600: 792c 206e 785d 292a 2041 7263 6854 6162  y, nx])* ArchTab
+00042610: 6c65 2e78 6763 0d0a 2020 2020 2020 2020  le.xgc..        
 00042620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042630: 2020 2020 2020 6864 3d6e 702e 6172 7261        hd=np.arra
-00042640: 7928 6864 290d 0a20 2020 2020 2020 2020  y(hd)..         
-00042650: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00042660: 6163 6965 733d 6e70 2e61 7272 6179 2866  acies=np.array(f
-00042670: 6163 6965 7329 0d0a 0d0a 2020 2020 2020  acies)....      
-00042680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042690: 2020 585f 6669 7420 3d20 6864 0d0a 2020    X_fit = hd..  
+00042630: 5920 3d20 6e70 2e6f 6e65 7328 5b6e 7a2c  Y = np.ones([nz,
+00042640: 206e 792c 206e 785d 290d 0a20 2020 2020   ny, nx])..     
+00042650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042660: 2020 2059 5b3a 5d20 3d20 6e70 2e6f 6e65     Y[:] = np.one
+00042670: 7328 5b6e 782c 206e 795d 292e 5420 2a20  s([nx, ny]).T * 
+00042680: 4172 6368 5461 626c 652e 7967 632e 7265  ArchTable.ygc.re
+00042690: 7368 6170 6528 2d31 2c20 3129 0d0a 2020  shape(-1, 1)..  
 000426a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000426b0: 2020 2020 2020 795f 6669 7420 3d20 6661        y_fit = fa
-000426c0: 6369 6573 0d0a 0d0a 2020 2020 2020 2020  cies....        
-000426d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000426e0: 585f 7072 6564 203d 2078 7533 445b 6d61  X_pred = xu3D[ma
-000426f0: 736b 2e66 6c61 7474 656e 2829 5d0d 0a0d  sk.flatten()]...
-00042700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042710: 2020 2020 2020 2020 2023 2066 6974 0d0a           # fit..
-00042720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042730: 2020 2020 2020 2020 6e6e 203d 204e 6561          nn = Nea
-00042740: 7265 7374 4e65 6967 6862 6f72 7328 6e5f  restNeighbors(n_
-00042750: 6e65 6967 6862 6f72 733d 3129 2e66 6974  neighbors=1).fit
-00042760: 2858 5f66 6974 290d 0a0d 0a20 2020 2020  (X_fit)....     
-00042770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042780: 2020 2023 7072 6564 0d0a 2020 2020 2020     #pred..      
+000426b0: 2020 2020 2020 5a20 3d20 6e70 2e6f 6e65        Z = np.one
+000426c0: 7328 5b6e 7a2c 206e 792c 206e 785d 290d  s([nz, ny, nx]).
+000426d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000426e0: 2020 2020 2020 2020 205a 5b3a 2c20 3a5d           Z[:, :]
+000426f0: 203d 2820 6e70 2e6f 6e65 7328 5b6e 7a2c   =( np.ones([nz,
+00042700: 206e 785d 2920 2a20 4172 6368 5461 626c   nx]) * ArchTabl
+00042710: 652e 7a67 632e 7265 7368 6170 6528 2d31  e.zgc.reshape(-1
+00042720: 2c20 3129 292e 7265 7368 6170 6528 6e7a  , 1)).reshape(nz
+00042730: 2c20 312c 206e 7829 0d0a 2020 2020 2020  , 1, nx)..      
+00042740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042750: 2020 7875 3344 203d 206e 702e 6172 7261    xu3D = np.arra
+00042760: 7928 5b58 2e66 6c61 7474 656e 2829 2c20  y([X.flatten(), 
+00042770: 592e 666c 6174 7465 6e28 292c 205a 2e66  Y.flatten(), Z.f
+00042780: 6c61 7474 656e 2829 5d29 2e54 0d0a 0d0a  latten()]).T....
 00042790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000427a0: 2020 7265 7320 3d20 6e6e 2e6b 6e65 6967    res = nn.kneig
-000427b0: 6862 6f72 7328 585f 7072 6564 2c20 7265  hbors(X_pred, re
-000427c0: 7475 726e 5f64 6973 7461 6e63 653d 4661  turn_distance=Fa
-000427d0: 6c73 652c 206e 5f6e 6569 6768 626f 7273  lse, n_neighbors
-000427e0: 3d31 290d 0a0d 0a20 2020 2020 2020 2020  =1)....         
-000427f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00042800: 2061 7373 6967 6e0d 0a20 2020 2020 2020   assign..       
-00042810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042820: 2079 5f70 7265 6420 3d20 795f 6669 745b   y_pred = y_fit[
-00042830: 7265 735d 0d0a 2020 2020 2020 2020 2020  res]..          
-00042840: 2020 2020 2020 2020 2020 2020 2020 7369                si
-00042850: 6d75 7320 3d20 6e70 2e7a 6572 6f73 285b  mus = np.zeros([
-00042860: 6e7a 2c20 6e79 2c20 6e78 5d29 0d0a 2020  nz, ny, nx])..  
+000427a0: 2020 2020 2020 2020 2320 6765 7420 6861          # get ha
+000427b0: 7264 2064 6174 610d 0a20 2020 2020 2020  rd data..       
+000427c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000427d0: 2069 6620 6d6f 6465 203d 3d20 2266 6163   if mode == "fac
+000427e0: 6965 7322 3a0d 0a20 2020 2020 2020 2020  ies":..         
+000427f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042800: 2020 2068 642c 2066 6163 6965 7320 3d20     hd, facies = 
+00042810: 4172 6368 5461 626c 652e 6864 5f66 615f  ArchTable.hd_fa_
+00042820: 696e 5f75 6e69 7428 7365 6c66 2c20 6975  in_unit(self, iu
+00042830: 3d69 7529 0d0a 2020 2020 2020 2020 2020  =iu)..          
+00042840: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00042850: 6966 206d 6f64 6520 3d3d 2022 756e 6974  if mode == "unit
+00042860: 7322 3a0d 0a20 2020 2020 2020 2020 2020  s":..           
 00042870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042880: 2020 2020 2020 7369 6d75 735b 6d61 736b        simus[mask
-00042890: 5d20 3d20 795f 7072 6564 5b3a 2c20 305d  ] = y_pred[:, 0]
-000428a0: 2020 2320 7265 6173 7369 676e 2076 616c    # reassign val
-000428b0: 7565 730d 0a0d 0a20 2020 2020 2020 2020  ues....         
-000428c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000428d0: 6f72 2069 7265 616c 2069 6e20 7261 6e67  or ireal in rang
-000428e0: 6528 6e72 6561 6c29 3a0d 0a20 2020 2020  e(nreal):..     
-000428f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042900: 2020 2020 2020 2066 6163 6965 735f 646f         facies_do
-00042910: 6d61 696e 735b 6975 2c20 6972 6561 6c5d  mains[iu, ireal]
-00042920: 5b6d 6173 6b5d 3d73 696d 7573 5b6d 6173  [mask]=simus[mas
-00042930: 6b5d 0d0a 0d0a 0d0a 2020 2020 2020 2020  k]......        
-00042940: 2020 2020 2020 2020 6966 206d 6f64 6520          if mode 
-00042950: 3d3d 2022 6661 6369 6573 223a 0d0a 2020  == "facies":..  
+00042880: 2068 642c 2066 6163 6965 7320 3d20 4172   hd, facies = Ar
+00042890: 6368 5461 626c 652e 6864 5f75 6e5f 696e  chTable.hd_un_in
+000428a0: 5f75 6e69 7428 7365 6c66 2c20 6975 3d69  _unit(self, iu=i
+000428b0: 7529 0d0a 0d0a 2020 2020 2020 2020 2020  u)....          
+000428c0: 2020 2020 2020 2020 2020 2020 2020 6864                hd
+000428d0: 3d6e 702e 6172 7261 7928 6864 290d 0a20  =np.array(hd).. 
+000428e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000428f0: 2020 2020 2020 2066 6163 6965 733d 6e70         facies=np
+00042900: 2e61 7272 6179 2866 6163 6965 7329 0d0a  .array(facies)..
+00042910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042920: 2020 2020 2020 2020 2020 585f 6669 7420            X_fit 
+00042930: 3d20 6864 0d0a 2020 2020 2020 2020 2020  = hd..          
+00042940: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+00042950: 6669 7420 3d20 6661 6369 6573 0d0a 0d0a  fit = facies....
 00042960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042970: 2020 4172 6368 5461 626c 652e 4765 6f6c    ArchTable.Geol
-00042980: 2e66 6163 6965 735f 646f 6d61 696e 735b  .facies_domains[
-00042990: 6975 2c3a 2c20 6d61 736b 5d3d 6661 6369  iu,:, mask]=faci
-000429a0: 6573 5f64 6f6d 6169 6e73 5b69 752c 3a2c  es_domains[iu,:,
-000429b0: 206d 6173 6b5d 2020 2320 7374 6f72 6520   mask]  # store 
-000429c0: 7265 7375 6c74 730d 0a20 2020 2020 2020  results..       
-000429d0: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
-000429e0: 6465 203d 3d20 2275 6e69 7473 223a 0d0a  de == "units":..
-000429f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042a00: 2020 2020 4172 6368 5461 626c 652e 4765      ArchTable.Ge
-00042a10: 6f6c 2e75 6e69 7473 5f64 6f6d 6169 6e73  ol.units_domains
-00042a20: 5b69 752c 206d 6173 6b5d 203d 2066 6163  [iu, mask] = fac
-00042a30: 6965 735f 646f 6d61 696e 735b 6975 2c20  ies_domains[iu, 
-00042a40: 302c 206d 6173 6b5d 2020 2320 7374 6f72  0, mask]  # stor
-00042a50: 6520 7265 7375 6c74 730d 0a20 2020 2020  e results..     
-00042a60: 2020 2065 6c69 6620 6d65 7468 6f64 203d     elif method =
-00042a70: 3d20 2253 7562 5069 6c65 223a 2023 2048  = "SubPile": # H
-00042a80: 6965 7261 7263 6869 6361 6c20 6669 6c6c  ierarchical fill
-00042a90: 696e 670d 0a20 2020 2020 2020 2020 2020  ing..           
-00042aa0: 2069 6620 4172 6368 5461 626c 652e 7665   if ArchTable.ve
-00042ab0: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00042ac0: 2020 2020 2020 2020 7072 696e 7428 2253          print("S
-00042ad0: 7562 5069 6c65 2066 696c 6c69 6e67 206d  ubPile filling m
-00042ae0: 6574 686f 642c 206e 6f74 6869 6e67 2068  ethod, nothing h
-00042af0: 6170 7065 6e65 6422 290d 0a20 2020 2020  appened")..     
-00042b00: 2020 2020 2020 2070 6173 730d 0a0d 0a63         pass....c
-00042b10: 6c61 7373 2053 7572 6661 6365 2829 3a0d  lass Surface():.
-00042b20: 0a0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
-00042b30: 436c 6173 7320 5375 7266 6163 652c 206d  Class Surface, m
-00042b40: 7573 7420 6265 206c 696e 6b65 6420 746f  ust be linked to
-00042b50: 2061 203a 636c 6173 733a 6055 6e69 7460   a :class:`Unit`
-00042b60: 206f 626a 6563 740d 0a0d 0a20 2020 2050   object....    P
-00042b70: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-00042b80: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e  ---------..    n
-00042b90: 616d 6520 3a20 7374 7269 6e67 0d0a 2020  ame : string..  
-00042ba0: 2020 2020 2020 746f 2069 6465 6e74 6966        to identif
-00042bb0: 7920 7468 6520 7375 7266 6163 6520 666f  y the surface fo
-00042bc0: 7220 6465 6275 6767 696e 6720 7075 7270  r debugging purp
-00042bd0: 6f73 650d 0a20 2020 2063 6f6e 7461 6374  ose..    contact
-00042be0: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
-00042bf0: 2020 206f 6e6c 6170 206f 7220 6572 6f64     onlap or erod
-00042c00: 652e 204f 6e6c 6170 2069 6e64 6963 6174  e. Onlap indicat
-00042c10: 6573 2074 6861 7420 7468 6973 2073 7572  es that this sur
-00042c20: 6661 6365 2063 616e 6e6f 7420 6572 6f64  face cannot erod
-00042c30: 6520 6f6c 6465 7220 7375 7266 6163 6573  e older surfaces
-00042c40: 2c0d 0a20 2020 2020 2020 206f 6e20 636f  ,..        on co
-00042c50: 6e74 7261 7279 2074 6f20 6572 6f64 6520  ntrary to erode 
-00042c60: 7375 7266 6163 6573 0d0a 2020 2020 6469  surfaces..    di
-00042c70: 635f 7375 7266 203a 2064 6963 740d 0a20  c_surf : dict.. 
-00042c80: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-00042c90: 7320 666f 7220 7375 7266 6163 6520 696e  s for surface in
-00042ca0: 7465 7270 6f6c 6174 696f 6e3a 0d0a 0d0a  terpolation:....
-00042cb0: 2020 2020 2020 2020 2020 2020 2d20 696e              - in
-00042cc0: 745f 6d65 7468 6f64 203a 2073 7472 696e  t_method : strin
-00042cd0: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-00042ce0: 2020 206d 6574 686f 6420 6f66 2069 6e74     method of int
-00042cf0: 6572 706f 6c61 7469 6f6e 2c20 706f 7373  erpolation, poss
-00042d00: 6962 6c65 206d 6574 686f 6473 2061 7265  ible methods are
-00042d10: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00042d20: 2020 206b 7269 6769 6e67 2c20 4d50 532c     kriging, MPS,
-00042d30: 2067 7266 2c20 6772 665f 696e 6571 2c20   grf, grf_ineq, 
-00042d40: 6c69 6e65 6172 2c20 6e65 6172 6573 742c  linear, nearest,
-00042d50: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00042d60: 636f 766d 6f64 656c 203a 2073 7472 696e  covmodel : strin
-00042d70: 670d 0a20 2020 2020 2020 2020 2020 2020  g..             
-00042d80: 2020 2067 656f 6e65 2063 6f76 6172 6961     geone covaria
-00042d90: 6e63 6520 6d6f 6465 6c20 2873 6565 2064  nce model (see d
-00042da0: 6f63 2047 656f 6e65 2066 6f72 206d 6f72  oc Geone for mor
-00042db0: 6520 696e 666f 726d 6174 696f 6e29 0d0a  e information)..
-00042dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042dd0: 6966 2061 206d 756c 7469 2d67 6175 7373  if a multi-gauss
-00042de0: 6961 6e20 6d65 7468 6f64 2069 7320 7573  ian method is us
-00042df0: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00042e00: 2d20 4e5f 7472 616e 7366 6f20 3a20 626f  - N_transfo : bo
-00042e10: 6f6c 0d0a 2020 2020 2020 2020 2020 2020  ol..            
-00042e20: 2020 2020 4e6f 726d 616c 2d73 636f 7265      Normal-score
-00042e30: 2074 7261 6e73 666f 726d 2e20 466c 6167   transform. Flag
-00042e40: 2074 6f20 6170 706c 7920 6f72 206e 6f74   to apply or not
-00042e50: 2061 204e 6f72 6d61 6c20 5363 6f72 6520   a Normal Score 
-00042e60: 6f6e 2074 6865 2064 6174 6120 666f 7220  on the data for 
-00042e70: 7468 6520 696e 7465 7270 6f6c 6174 696f  the interpolatio
-00042e80: 6e0d 0a20 2020 2020 2020 2020 2020 202d  n..            -
-00042e90: 2055 6e69 7473 206b 7761 7267 7320 2028   Units kwargs  (
-00042ea0: 7061 7373 6564 2069 6e20 6469 635f 7375  passed in dic_su
-00042eb0: 7266 2064 6972 6563 746c 7929 3a0d 0a0d  rf directly):...
-00042ec0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00042ed0: 2074 6865 2073 6561 7263 6820 656c 6c69   the search elli
-00042ee0: 7073 6f69 6420 286b 7269 6769 6e67 2c20  psoid (kriging, 
-00042ef0: 6772 662c 202e 2e2e 293a 0d0a 2020 2020  grf, ...):..    
-00042f00: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00042f10: 2020 2020 2020 2020 2020 2d20 722c 2072            - r, r
-00042f20: 656c 6174 6976 6520 2874 6f20 636f 7661  elative (to cova
-00042f30: 7269 616e 6365 206d 6f64 656c 2920 7261  riance model) ra
-00042f40: 6469 7573 206f 6620 7265 7365 6172 6368  dius of research
-00042f50: 2028 6465 6661 756c 7420 6973 2031 290d   (default is 1).
-00042f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042f70: 202d 206e 6569 672c 206e 756d 6265 7220   - neig, number 
-00042f80: 6f66 206e 6569 6768 626f 7572 730d 0a20  of neighbours.. 
-00042f90: 2020 2020 2020 2020 2020 2020 2020 202d                 -
-00042fa0: 206b 7269 675f 7479 7065 3a20 7374 7269   krig_type: stri
-00042fb0: 6e67 2c20 6b72 6967 696e 6720 6d65 7468  ng, kriging meth
-00042fc0: 6f64 2028 6f72 6469 6e61 7279 5f6b 7269  od (ordinary_kri
-00042fd0: 6769 6e67 2c20 7369 6d70 6c65 5f6b 7269  ging, simple_kri
-00042fe0: 6769 6e67 290d 0a20 2020 2020 2020 2020  ging)..         
-00042ff0: 2020 2066 6f72 204d 5053 3a0d 0a20 2020     for MPS:..   
-00043000: 2020 2020 2020 2020 200d 0a20 2020 2020           ..     
-00043010: 2020 2020 2020 2020 2020 202d 2054 490d             - TI.
-00043020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043030: 202d 2076 6172 696f 7573 204d 5053 2070   - various MPS p
-00043040: 6172 616d 6574 6572 732c 2073 6565 2067  arameters, see g
-00043050: 656f 6e65 2064 6f63 756d 656e 7461 7469  eone documentati
-00043060: 6f6e 0d0a 0d0a 2020 2020 2222 220d 0a0d  on....    """...
-00043070: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00043080: 5f28 7365 6c66 2c20 6e61 6d65 3d22 5375  _(self, name="Su
-00043090: 7266 6163 655f 3122 2c0d 0a20 2020 2020  rface_1",..     
-000430a0: 2020 2020 2020 2020 2020 2064 6963 5f73             dic_s
-000430b0: 7572 663d 7b22 696e 745f 6d65 7468 6f64  urf={"int_method
-000430c0: 223a 2022 6e65 6172 6573 7422 2c20 2263  ": "nearest", "c
-000430d0: 6f76 6d6f 6465 6c22 3a20 4e6f 6e65 2c20  ovmodel": None, 
-000430e0: 224e 5f74 7261 6e73 666f 223a 2046 616c  "N_transfo": Fal
-000430f0: 7365 7d2c 0d0a 2020 2020 2020 2020 2020  se},..          
-00043100: 2020 2020 2020 636f 6e74 6163 743d 226f        contact="o
-00043110: 6e6c 6170 2229 3a0d 0a0d 0a20 2020 2020  nlap"):....     
-00043120: 2020 2061 7373 6572 7420 636f 6e74 6163     assert contac
-00043130: 7420 696e 205b 2265 726f 6465 222c 2022  t in ["erode", "
-00043140: 6f6e 6c61 7022 2c20 2263 6f6d 6622 5d2c  onlap", "comf"],
-00043150: 2022 636f 6e74 6163 7420 6d75 7374 2062   "contact must b
-00043160: 6520 6572 6f64 6520 6f72 206f 6e6c 6170  e erode or onlap
-00043170: 206f 7220 636f 6d66 220d 0a20 2020 2020   or comf"..     
-00043180: 2020 2061 7373 6572 7420 6469 635f 7375     assert dic_su
-00043190: 7266 5b22 696e 745f 6d65 7468 6f64 225d  rf["int_method"]
-000431a0: 2069 7320 6e6f 7420 4e6f 6e65 2c20 2241   is not None, "A
-000431b0: 6e20 696e 7465 7270 6f6c 6174 696f 6e20  n interpolation 
-000431c0: 6d65 7468 6f64 206d 7573 7420 6265 2070  method must be p
-000431d0: 726f 7669 6465 6422 0d0a 2020 2020 2020  rovided"..      
-000431e0: 2020 6173 7365 7274 2064 6963 5f73 7572    assert dic_sur
-000431f0: 665b 2269 6e74 5f6d 6574 686f 6422 5d20  f["int_method"] 
-00043200: 696e 205b 226c 696e 6561 7222 2c20 2263  in ["linear", "c
-00043210: 7562 6963 222c 2022 6e65 6172 6573 7422  ubic", "nearest"
-00043220: 2c20 226b 7269 6769 6e67 222c 2022 6772  , "kriging", "gr
-00043230: 6622 2c20 2267 7266 5f69 6e65 7122 2c20  f", "grf_ineq", 
-00043240: 224d 5053 225d 2c20 2255 6e6b 6e6f 776e  "MPS"], "Unknown
-00043250: 2069 6e74 6572 706f 6c61 7469 6f6e 206d   interpolation m
-00043260: 6574 686f 6422 0d0a 0d0a 2020 2020 2020  ethod"....      
-00043270: 2020 2364 6566 6175 6c74 2076 616c 7565    #default value
-00043280: 7320 6469 6320 7375 7266 0d0a 2020 2020  s dic surf..    
-00043290: 2020 2020 6b77 6172 6773 5f64 6566 5f73      kwargs_def_s
-000432a0: 7572 6661 6365 3d7b 2263 6f76 6d6f 6465  urface={"covmode
-000432b0: 6c22 3a20 4e6f 6e65 2c20 224e 5f74 7261  l": None, "N_tra
-000432c0: 6e73 666f 223a 2046 616c 7365 2c20 2262  nsfo": False, "b
-000432d0: 616e 6477 6964 7468 5f6d 756c 7422 3a20  andwidth_mult": 
-000432e0: 312c 2022 7461 7522 3a20 307d 0d0a 2020  1, "tau": 0}..  
-000432f0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-00043300: 6e20 6b77 6172 6773 5f64 6566 5f73 7572  n kwargs_def_sur
-00043310: 6661 6365 2e69 7465 6d73 2829 3a0d 0a20  face.items():.. 
-00043320: 2020 2020 2020 2020 2020 2069 6620 6b20             if k 
-00043330: 6e6f 7420 696e 2064 6963 5f73 7572 662e  not in dic_surf.
-00043340: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
-00043350: 2020 2020 2020 2020 2064 6963 5f73 7572           dic_sur
-00043360: 665b 6b5d 3d76 0d0a 0d0a 2020 2020 2020  f[k]=v....      
-00043370: 2020 7365 6c66 2e6e 616d 653d 6e61 6d65    self.name=name
-00043380: 0d0a 2020 2020 2020 2020 7365 6c66 2e78  ..        self.x
-00043390: 3d5b 5d0d 0a20 2020 2020 2020 2073 656c  =[]..        sel
-000433a0: 662e 793d 5b5d 0d0a 2020 2020 2020 2020  f.y=[]..        
-000433b0: 7365 6c66 2e7a 3d5b 5d0d 0a20 2020 2020  self.z=[]..     
-000433c0: 2020 2073 656c 662e 696e 6571 3d5b 5d0d     self.ineq=[].
-000433d0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-000433e0: 745f 6d65 7468 6f64 3d64 6963 5f73 7572  t_method=dic_sur
-000433f0: 665b 2269 6e74 5f6d 6574 686f 6422 5d0d  f["int_method"].
-00043400: 0a20 2020 2020 2020 2073 656c 662e 4e5f  .        self.N_
-00043410: 7472 616e 7366 6f3d 6469 635f 7375 7266  transfo=dic_surf
-00043420: 5b22 4e5f 7472 616e 7366 6f22 5d0d 0a20  ["N_transfo"].. 
-00043430: 2020 2020 2020 2073 656c 662e 636f 766d         self.covm
-00043440: 6f64 656c 3d64 6963 5f73 7572 665b 2263  odel=dic_surf["c
-00043450: 6f76 6d6f 6465 6c22 5d0d 0a20 2020 2020  ovmodel"]..     
-00043460: 2020 2073 656c 662e 636f 6e74 6163 743d     self.contact=
-00043470: 636f 6e74 6163 740d 0a0d 0a20 2020 2020  contact....     
-00043480: 2020 2023 6368 6563 6b20 696e 7075 7473     #check inputs
-00043490: 2066 6f72 2073 7572 6661 6365 206d 6574   for surface met
-000434a0: 686f 6473 0d0a 2020 2020 2020 2020 6966  hods..        if
-000434b0: 2073 656c 662e 696e 745f 6d65 7468 6f64   self.int_method
-000434c0: 2069 6e20 5b22 6b72 6967 696e 6722 2c20   in ["kriging", 
-000434d0: 2267 7266 222c 2022 6772 665f 696e 6571  "grf", "grf_ineq
-000434e0: 225d 3a0d 0a20 2020 2020 2020 2020 2020  "]:..           
-000434f0: 2073 656c 662e 6765 745f 7375 7266 6163   self.get_surfac
-00043500: 655f 636f 766d 6f64 656c 2829 0d0a 0d0a  e_covmodel()....
-00043510: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00043520: 636f 766d 6f64 656c 2069 7320 6e6f 7420  covmodel is not 
-00043530: 4e6f 6e65 2061 6e64 2073 656c 662e 4e5f  None and self.N_
-00043540: 7472 616e 7366 6f20 616e 6420 7365 6c66  transfo and self
-00043550: 2e69 6e74 5f6d 6574 686f 6420 696e 205b  .int_method in [
-00043560: 226b 7269 6769 6e67 222c 2022 6772 6622  "kriging", "grf"
-00043570: 2c20 2267 7266 5f69 6e65 7122 5d3a 0d0a  , "grf_ineq"]:..
-00043580: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00043590: 656c 662e 6765 745f 7375 7266 6163 655f  elf.get_surface_
-000435a0: 636f 766d 6f64 656c 2829 2e73 696c 6c28  covmodel().sill(
-000435b0: 2920 213d 2031 3a0d 0a20 2020 2020 2020  ) != 1:..       
-000435c0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-000435d0: 556e 6974 207b 7d3a 2021 2120 4e6f 726d  Unit {}: !! Norm
-000435e0: 616c 2074 7261 6e73 666f 726d 6174 696f  al transformatio
-000435f0: 6e20 6973 2061 7070 6c69 6564 2062 7574  n is applied but
-00043600: 2074 6865 2076 6172 6961 6e63 6520 6f66   the variance of
-00043610: 2074 6865 2043 6f76 6172 6961 6e63 6520   the Covariance 
-00043620: 6d6f 6465 6c20 6973 206e 6f74 2065 7175  model is not equ
-00043630: 616c 2074 6f20 3120 2121 222e 666f 726d  al to 1 !!".form
-00043640: 6174 2873 656c 662e 6e61 6d65 2929 0d0a  at(self.name))..
-00043650: 0d0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
-00043660: 6963 5f73 7572 663d 6469 635f 7375 7266  ic_surf=dic_surf
-00043670: 0d0a 0d0a 2020 2020 6465 6620 636f 7079  ....    def copy
-00043680: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00043690: 2072 6574 7572 6e20 636f 7079 2e64 6565   return copy.dee
-000436a0: 7063 6f70 7928 7365 6c66 290d 0a0d 0a20  pcopy(self).... 
-000436b0: 2020 2064 6566 2073 6574 5f63 6f76 6d6f     def set_covmo
-000436c0: 6465 6c28 7365 6c66 2c20 636f 766d 6f64  del(self, covmod
-000436d0: 656c 2c20 7662 3d30 293a 0d0a 0d0a 2020  el, vb=0):....  
-000436e0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000436f0: 2020 2063 6861 6e67 6520 6f72 2061 6464     change or add
-00043700: 2061 2063 6f76 6d6f 6465 6c20 666f 7220   a covmodel for 
-00043710: 7375 7266 6163 6520 696e 7465 7270 6f6c  surface interpol
-00043720: 6174 696f 6e20 6f66 2073 656c 6620 756e  ation of self un
-00043730: 6974 2e0d 0a0d 0a20 2020 2020 2020 2050  it.....        P
-00043740: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00043750: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00043760: 2020 2020 2020 2063 6f76 6d6f 6465 6c20         covmodel 
-00043770: 3a20 6765 6f6e 652e 636f 764d 6f64 656c  : geone.covModel
-00043780: 2e43 6f76 4d6f 6465 6c32 440d 0a20 2020  .CovModel2D..   
-00043790: 2020 2020 2020 2020 2063 6f76 6172 6961           covaria
-000437a0: 6e63 6520 6d6f 6465 6c20 746f 2062 6520  nce model to be 
-000437b0: 7573 6564 2066 6f72 2073 7572 6661 6365  used for surface
-000437c0: 2069 6e74 6572 706f 6c61 7469 6f6e 0d0a   interpolation..
-000437d0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-000437e0: 6865 2063 686f 7365 6e20 6d65 7468 6f64  he chosen method
-000437f0: 2069 7320 6772 662c 2067 7266 2069 6e65   is grf, grf ine
-00043800: 7120 6f72 206b 7269 6769 6e67 0d0a 2020  q or kriging..  
-00043810: 2020 2020 2020 2222 220d 0a0d 0a20 2020        """....   
-00043820: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00043830: 6365 2863 6f76 6d6f 6465 6c2c 2067 656f  ce(covmodel, geo
-00043840: 6e65 2e63 6f76 4d6f 6465 6c2e 436f 764d  ne.covModel.CovM
-00043850: 6f64 656c 3244 293a 0d0a 2020 2020 2020  odel2D):..      
-00043860: 2020 2020 2020 7365 6c66 2e63 6f76 6d6f        self.covmo
-00043870: 6465 6c3d 636f 766d 6f64 656c 0d0a 2020  del=covmodel..  
-00043880: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-00043890: 6963 5f73 7572 665b 2263 6f76 6d6f 6465  ic_surf["covmode
-000438a0: 6c22 5d3d 636f 766d 6f64 656c 0d0a 2020  l"]=covmodel..  
-000438b0: 2020 2020 2020 2020 2020 6966 2076 623a            if vb:
-000438c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000438d0: 2020 7072 696e 7428 2253 7572 6661 6365    print("Surface
-000438e0: 207b 7d3a 2063 6f76 6d6f 6465 6c20 6164   {}: covmodel ad
-000438f0: 6465 6422 2e66 6f72 6d61 7428 7365 6c66  ded".format(self
-00043900: 2e6e 616d 6529 290d 0a20 2020 2020 2020  .name))..       
-00043910: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00043920: 2020 2020 6966 2076 623a 0d0a 2020 2020      if vb:..    
-00043930: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00043940: 7428 2253 7572 6661 6365 207b 7d3a 2063  t("Surface {}: c
-00043950: 6f76 6d6f 6465 6c20 6e6f 7420 6120 6765  ovmodel not a ge
-00043960: 6f6e 6520 3244 2063 6f76 6d6f 6465 6c22  one 2D covmodel"
-00043970: 2e66 6f72 6d61 7428 7365 6c66 2e6e 616d  .format(self.nam
-00043980: 6529 290d 0a0d 0a20 2020 2064 6566 2067  e))....    def g
-00043990: 6574 5f73 7572 6661 6365 5f63 6f76 6d6f  et_surface_covmo
-000439a0: 6465 6c28 7365 6c66 2c20 7662 3d31 293a  del(self, vb=1):
-000439b0: 0d0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000439c0: 662e 636f 766d 6f64 656c 2069 7320 4e6f  f.covmodel is No
-000439d0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-000439e0: 2069 6620 7662 3a0d 0a20 2020 2020 2020   if vb:..       
-000439f0: 2020 2020 2020 2020 2070 7269 6e74 2028           print (
-00043a00: 2257 6172 6e69 6e67 3a20 556e 6974 2027  "Warning: Unit '
-00043a10: 7b7d 2720 6861 7665 206e 6f20 436f 766d  {}' have no Covm
-00043a20: 6f64 656c 2066 6f72 2073 7572 6661 6365  odel for surface
-00043a30: 2069 6e74 6572 706f 6c61 7469 6f6e 222e   interpolation".
-00043a40: 666f 726d 6174 2873 656c 662e 6e61 6d65  format(self.name
-00043a50: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00043a60: 7265 7475 726e 204e 6f6e 650d 0a20 2020  return None..   
-00043a70: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00043a80: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00043a90: 656c 662e 636f 766d 6f64 656c 0d0a 2020  elf.covmodel..  
-00043aa0: 2020 0d0a 2020 2020 6465 6620 7365 745f    ..    def set_
-00043ab0: 636f 6e74 6163 7428 7365 6c66 2c20 636f  contact(self, co
-00043ac0: 6e74 6163 7429 3a0d 0a20 2020 2020 2020  ntact):..       
-00043ad0: 2061 7373 6572 7420 636f 6e74 6163 7420   assert contact 
-00043ae0: 696e 205b 2265 726f 6465 222c 2022 6f6e  in ["erode", "on
-00043af0: 6c61 7022 2c20 2263 6f6d 6622 5d2c 2022  lap", "comf"], "
-00043b00: 636f 6e74 6163 7420 6d75 7374 2062 6520  contact must be 
-00043b10: 6572 6f64 6520 6f72 206f 6e6c 6170 206f  erode or onlap o
-00043b20: 7220 636f 6d66 220d 0a20 2020 2020 2020  r comf"..       
-00043b30: 2073 656c 662e 636f 6e74 6163 743d 636f   self.contact=co
-00043b40: 6e74 6163 740d 0a20 2020 2020 2020 2073  ntact..        s
-00043b50: 656c 662e 6268 735f 7072 6f63 6573 7365  elf.bhs_processe
-00043b60: 643d 300d 0a0d 0a20 2020 2064 6566 2073  d=0....    def s
-00043b70: 6574 5f64 6963 5f73 7572 6628 7365 6c66  et_dic_surf(self
-00043b80: 2c20 6469 635f 7375 7266 293a 0d0a 2020  , dic_surf):..  
-00043b90: 2020 2020 2020 7365 6c66 2e64 6963 5f73        self.dic_s
-00043ba0: 7572 663d 6469 635f 7375 7266 0d0a 0d0a  urf=dic_surf....
-00043bb0: 636c 6173 7320 4661 6369 6573 2829 3a0d  class Facies():.
-00043bc0: 0a0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
-00043bd0: 636c 6173 7320 666f 7220 6661 6369 6573  class for facies
-00043be0: 2028 326e 6420 6c65 7665 6c20 6f66 2068   (2nd level of h
-00043bf0: 6965 7261 7263 6879 290d 0a0d 0a20 2020  ierarchy)....   
-00043c00: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
-00043c10: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00043c20: 2049 4420 3a20 696e 740d 0a20 2020 2020   ID : int..     
-00043c30: 2020 2066 6163 6965 7320 4944 2074 6861     facies ID tha
-00043c40: 7420 6973 2075 7365 6420 696e 2074 6865  t is used in the
-00043c50: 2072 6573 756c 7473 0d0a 2020 2020 6e61   results..    na
-00043c60: 6d65 203a 2073 7472 696e 670d 0a20 2020  me : string..   
-00043c70: 2020 2020 2066 6163 6965 7320 6e61 6d65       facies name
-00043c80: 2c20 7573 6564 2061 7320 616e 2069 6465  , used as an ide
-00043c90: 6e74 6966 6965 720d 0a20 2020 2063 6f6c  ntifier..    col
-00043ca0: 6f72 203a 2073 7472 696e 670d 0a20 2020  or : string..   
-00043cb0: 2020 2020 2063 6f6c 6f72 206f 6620 7468       color of th
-00043cc0: 6520 6661 6369 6573 2c20 7573 6564 2066  e facies, used f
-00043cd0: 6f72 2070 6c6f 7474 696e 670d 0a20 2020  or plotting..   
-00043ce0: 2022 2222 0d0a 0d0a 2020 2020 6465 6620   """....    def 
-00043cf0: 5f5f 696e 6974 5f5f 2873 656c 662c 2049  __init__(self, I
-00043d00: 442c 206e 616d 652c 2063 6f6c 6f72 293a  D, name, color):
-00043d10: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
-00043d20: 2e78 3d5b 5d0d 0a20 2020 2020 2020 2073  .x=[]..        s
-00043d30: 656c 662e 793d 5b5d 0d0a 2020 2020 2020  elf.y=[]..      
-00043d40: 2020 7365 6c66 2e7a 3d5b 5d0d 0a20 2020    self.z=[]..   
-00043d50: 2020 2020 2069 6620 4944 2021 3d20 303a       if ID != 0:
-00043d60: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00043d70: 6c66 2e49 443d 4944 0d0a 2020 2020 2020  lf.ID=ID..      
-00043d80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00043d90: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00043da0: 4572 726f 7228 2249 4420 6661 6369 6573  Error("ID facies
-00043db0: 2063 616e 6e6f 7420 6265 2065 7175 616c   cannot be equal
-00043dc0: 2074 6f20 3022 290d 0a20 2020 2020 2020   to 0")..       
-00043dd0: 2073 656c 662e 6e61 6d65 3d6e 616d 650d   self.name=name.
-00043de0: 0a20 2020 2020 2020 2073 656c 662e 633d  .        self.c=
-00043df0: 636f 6c6f 720d 0a0d 0a20 2020 2064 6566  color....    def
-00043e00: 205f 5f65 715f 5f28 7365 6c66 2c20 6f74   __eq__(self, ot
-00043e10: 6865 7229 3a0d 0a20 2020 2020 2020 2069  her):..        i
-00043e20: 6620 2873 656c 662e 6e61 6d65 203d 3d20  f (self.name == 
-00043e30: 6f74 6865 722e 6e61 6d65 2920 2620 2873  other.name) & (s
-00043e40: 656c 662e 4944 203d 3d20 6f74 6865 722e  elf.ID == other.
-00043e50: 4944 293a 0d0a 2020 2020 2020 2020 2020  ID):..          
-00043e60: 2020 7265 7475 726e 2054 7275 650d 0a20    return True.. 
-00043e70: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00043e80: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00043e90: 2046 616c 7365 0d0a 0d0a 2020 2020 6465   False....    de
-00043ea0: 6620 5f5f 7374 725f 5f28 7365 6c66 293a  f __str__(self):
-00043eb0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00043ec0: 2073 656c 662e 6e61 6d65 0d0a 0d0a 2020   self.name....  
-00043ed0: 2020 6465 6620 5f5f 7265 7072 5f5f 2873    def __repr__(s
-00043ee0: 656c 6629 3a0d 0a20 2020 2020 2020 2072  elf):..        r
-00043ef0: 6574 7572 6e20 7365 6c66 2e6e 616d 650d  eturn self.name.
-00043f00: 0a0d 0a63 6c61 7373 2050 726f 7028 293a  ...class Prop():
-00043f10: 0d0a 0d0a 2020 2020 2222 220d 0a20 2020  ....    """..   
-00043f20: 2043 6c61 7373 2066 6f72 2064 6566 696e   Class for defin
-00043f30: 696e 6720 6120 7072 6f70 7269 6574 7920  ing a propriety 
-00043f40: 746f 2073 696d 756c 6174 6520 2833 7264  to simulate (3rd
-00043f50: 206c 6576 656c 290d 0a0d 0a20 2020 2050   level)....    P
-00043f60: 6172 616d 6574 6572 730d 0a20 2020 202d  arameters..    -
-00043f70: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e  ---------..    n
-00043f80: 616d 6520 3a20 7374 7269 6e67 0d0a 2020  ame : string..  
-00043f90: 2020 2020 2020 5072 6f70 6572 7479 206e        Property n
-00043fa0: 616d 650d 0a20 2020 2066 6163 6965 7320  ame..    facies 
-00043fb0: 3a20 6c69 7374 206f 6620 3a63 6c61 7373  : list of :class
-00043fc0: 3a60 4661 6369 6573 6020 6f62 6a65 6374  :`Facies` object
-00043fd0: 730d 0a20 2020 2020 2020 2066 6163 6965  s..        facie
-00043fe0: 7320 696e 2077 6869 6368 2077 6520 7761  s in which we wa
-00043ff0: 6e74 2074 6f20 7369 6d75 6c61 7465 2074  nt to simulate t
-00044000: 6865 2070 726f 7065 7274 790d 0a20 2020  he property..   
-00044010: 2020 2020 2028 696e 2074 6865 206f 7468       (in the oth
-00044020: 6572 7320 7468 6520 7072 6f70 7269 6574  ers the propriet
-00044030: 7920 7769 6c6c 2062 6520 7365 7420 686f  y will be set ho
-00044040: 6d6f 6765 6e6f 7573 2077 6974 6820 6120  mogenous with a 
-00044050: 6465 6661 756c 7420 7661 6c75 6529 0d0a  default value)..
-00044060: 2020 2020 636f 766d 6f64 656c 7320 3a20      covmodels : 
-00044070: 6c69 7374 206f 6620 3a63 6c61 7373 3a60  list of :class:`
-00044080: 6765 6f6e 652e 636f 764d 6f64 656c 2e43  geone.covModel.C
-00044090: 6f76 4d6f 6465 6c32 4460 206f 626a 6563  ovModel2D` objec
-000440a0: 7473 0d0a 2020 2020 2020 2020 636f 766d  ts..        covm
-000440b0: 6f64 656c 7320 666f 7220 7468 6520 7369  odels for the si
-000440c0: 6d75 6c61 7469 6f6e 2028 7361 6d65 2073  mulation (same s
-000440d0: 697a 6520 6f66 2066 6163 6965 7320 6f72  ize of facies or
-000440e0: 206f 6e6c 7920 3129 0d0a 2020 2020 6d65   only 1)..    me
-000440f0: 616e 7320 3a20 6c69 7374 206f 6620 666c  ans : list of fl
-00044100: 6f61 7473 0d0a 2020 2020 2020 2020 6d65  oats..        me
-00044110: 616e 206f 6620 7468 6520 7072 6f70 6572  an of the proper
-00044120: 7479 2069 6e20 6561 6368 2066 6163 6965  ty in each facie
-00044130: 7320 2873 616d 6520 7369 7a65 206f 6620  s (same size of 
-00044140: 6661 6369 6573 290d 0a20 2020 2069 6e74  facies)..    int
-00044150: 5f6d 6574 686f 6420 3a20 7374 7269 6e67  _method : string
-00044160: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
-00044170: 206f 6620 696e 7465 7270 6f6c 6174 696f   of interpolatio
-00044180: 6e2c 2070 6f73 7369 626c 6520 6d65 7468  n, possible meth
-00044190: 6f64 7320 6172 653a 0d0a 2020 2020 2020  ods are:..      
-000441a0: 2020 2d20 7367 732c 2064 6566 6175 6c74    - sgs, default
-000441b0: 0d0a 2020 2020 2020 2020 2d20 6666 740d  ..        - fft.
-000441c0: 0a20 2020 2020 2020 202d 2068 6f6d 6f67  .        - homog
-000441d0: 656e 6f75 730d 0a20 2020 2064 6566 5f6d  enous..    def_m
-000441e0: 6561 6e20 3a20 666c 6f61 740d 0a20 2020  ean : float..   
-000441f0: 2020 2020 2064 6566 6175 6c74 206d 6561       default mea
-00044200: 6e20 746f 2075 7365 6420 6966 206e 6f6e  n to used if non
-00044210: 6520 6973 2070 6173 7365 6420 696e 206d  e is passed in m
-00044220: 6561 6e73 2061 7272 6179 0d0a 2020 2020  eans array..    
-00044230: 766d 696e 2c20 766d 6178 203a 2066 6c6f  vmin, vmax : flo
-00044240: 6174 0d0a 2020 2020 2020 2020 6d69 6e20  at..        min 
-00044250: 7265 7370 2e20 6d61 7820 7661 6c75 6520  resp. max value 
-00044260: 6f66 2074 6865 2070 726f 7065 7274 790d  of the property.
-00044270: 0a20 2020 2078 203a 206e 6461 7272 6179  .    x : ndarray
-00044280: 206f 6620 7369 7a65 2028 6e2c 2032 202d   of size (n, 2 -
-00044290: 2d3e 2078 2c20 7929 0d0a 2020 2020 2020  -> x, y)..      
-000442a0: 2020 706f 7369 7469 6f6e 206f 6620 6861    position of ha
-000442b0: 7264 2064 6174 6120 0d0a 2020 2020 7620  rd data ..    v 
-000442c0: 3a20 6e64 6172 7261 7920 6f66 2073 697a  : ndarray of siz
-000442d0: 6520 286e 2c20 3120 2d2d 3e20 7661 6c75  e (n, 1 --> valu
-000442e0: 6529 0d0a 2020 2020 2020 2020 7661 6c75  e)..        valu
-000442f0: 6520 6f66 2068 6172 6420 6461 7461 0d0a  e of hard data..
-00044300: 2020 2020 2222 220d 0a0d 0a20 2020 2064      """....    d
-00044310: 6566 205f 5f69 6e69 745f 5f28 7365 6c66  ef __init__(self
-00044320: 2c20 6e61 6d65 2c20 6661 6369 6573 2c20  , name, facies, 
-00044330: 636f 766d 6f64 656c 732c 206d 6561 6e73  covmodels, means
-00044340: 2c20 696e 745f 6d65 7468 6f64 3d22 7367  , int_method="sg
-00044350: 7322 2c20 783d 4e6f 6e65 2c20 763d 204e  s", x=None, v= N
-00044360: 6f6e 652c 2064 6566 5f6d 6561 6e3d 312c  one, def_mean=1,
-00044370: 2076 6d69 6e3d 4e6f 6e65 2c20 766d 6178   vmin=None, vmax
-00044380: 3d4e 6f6e 6529 3a0d 0a0d 0a0d 0a20 2020  =None):......   
-00044390: 2020 2020 2061 7373 6572 7420 6973 696e       assert isin
-000443a0: 7374 616e 6365 2866 6163 6965 732c 206c  stance(facies, l
-000443b0: 6973 7429 2c20 2246 6163 6965 7320 6d75  ist), "Facies mu
-000443c0: 7374 2062 6520 6120 6c69 7374 206f 6620  st be a list of 
-000443d0: 6661 6369 6573 2c20 6576 656e 2074 6865  facies, even the
-000443e0: 7265 2069 7320 6f6e 6c79 206f 6e65 220d  re is only one".
-000443f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00044400: 6973 696e 7374 616e 6365 2876 6d69 6e2c  isinstance(vmin,
-00044410: 2066 6c6f 6174 2920 6f72 2069 7369 6e73   float) or isins
-00044420: 7461 6e63 6528 766d 696e 2c20 696e 7429  tance(vmin, int)
-00044430: 206f 7220 766d 696e 2069 7320 4e6f 6e65   or vmin is None
-00044440: 2c20 2256 6d69 6e20 6572 726f 7222 0d0a  , "Vmin error"..
-00044450: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00044460: 7369 6e73 7461 6e63 6528 766d 6178 2c20  sinstance(vmax, 
-00044470: 666c 6f61 7429 206f 7220 6973 696e 7374  float) or isinst
-00044480: 616e 6365 2876 6d61 782c 2069 6e74 2920  ance(vmax, int) 
-00044490: 6f72 2076 6d61 7820 6973 204e 6f6e 652c  or vmax is None,
-000444a0: 2022 566d 6178 2065 7272 6f72 220d 0a0d   "Vmax error"...
-000444b0: 0a20 2020 2020 2020 2073 656c 662e 6e61  .        self.na
-000444c0: 6d65 3d6e 616d 650d 0a20 2020 2020 2020  me=name..       
-000444d0: 2073 656c 662e 6661 6369 6573 3d66 6163   self.facies=fac
-000444e0: 6965 730d 0a20 2020 2020 2020 206e 5f66  ies..        n_f
-000444f0: 6163 6965 733d 6c65 6e28 6661 6369 6573  acies=len(facies
-00044500: 290d 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00044510: 6e5f 6661 6369 6573 3d6e 5f66 6163 6965  n_facies=n_facie
-00044520: 730d 0a0d 0a20 2020 2020 2020 2073 656c  s....        sel
-00044530: 662e 766d 696e 3d76 6d69 6e0d 0a20 2020  f.vmin=vmin..   
-00044540: 2020 2020 2073 656c 662e 766d 6178 3d76       self.vmax=v
-00044550: 6d61 780d 0a20 2020 2020 2020 2073 656c  max..        sel
-00044560: 662e 783d 780d 0a20 2020 2020 2020 2073  f.x=x..        s
-00044570: 656c 662e 763d 760d 0a0d 0a20 2020 2020  elf.v=v....     
-00044580: 2020 2023 636f 766d 6f64 656c 730d 0a20     #covmodels.. 
-00044590: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-000445a0: 2020 2020 2020 2020 2066 6f72 2063 6d20           for cm 
-000445b0: 696e 2063 6f76 6d6f 6465 6c73 3a0d 0a20  in covmodels:.. 
-000445c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000445d0: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-000445e0: 2073 656c 662e 636f 766d 6f64 656c 733d   self.covmodels=
-000445f0: 636f 766d 6f64 656c 730d 0a20 2020 2020  covmodels..     
-00044600: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00044610: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00044620: 7461 6e63 6528 636f 766d 6f64 656c 732c  tance(covmodels,
-00044630: 2067 636d 2e43 6f76 4d6f 6465 6c33 4429   gcm.CovModel3D)
-00044640: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00044650: 2020 2073 656c 662e 636f 766d 6f64 656c     self.covmodel
-00044660: 733d 5b63 6f76 6d6f 6465 6c73 5d2a 6e5f  s=[covmodels]*n_
-00044670: 6661 6369 6573 0d0a 2020 2020 2020 2020  facies..        
-00044680: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00044690: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000446a0: 2056 616c 7565 4572 726f 7228 227b 7d20   ValueError("{} 
-000446b0: 6973 206e 6f74 2061 2076 616c 6964 2043  is not a valid C
-000446c0: 6f76 4d6f 6465 6c33 4422 2e66 6f72 6d61  ovModel3D".forma
-000446d0: 7428 636d 2929 0d0a 0d0a 2020 2020 2020  t(cm))....      
-000446e0: 2020 236d 6561 6e73 0d0a 2020 2020 2020    #means..      
-000446f0: 2020 7365 6c66 2e6d 6561 6e73 3d6d 6561    self.means=mea
-00044700: 6e73 0d0a 2020 2020 2020 2020 7472 793a  ns..        try:
-00044710: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-00044720: 7220 6d20 696e 206d 6561 6e73 3a0d 0a20  r m in means:.. 
-00044730: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00044740: 6173 730d 0a20 2020 2020 2020 2065 7863  ass..        exc
-00044750: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00044760: 2020 7365 6c66 2e6d 6561 6e73 3d5b 6d65    self.means=[me
-00044770: 616e 735d 2a6e 5f66 6163 6965 730d 0a0d  ans]*n_facies...
-00044780: 0a20 2020 2020 2020 2023 696e 7465 7270  .        #interp
-00044790: 6f6c 6174 696f 6e20 6d65 7468 6f64 730d  olation methods.
-000447a0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-000447b0: 743d 696e 745f 6d65 7468 6f64 0d0a 2020  t=int_method..  
-000447c0: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-000447d0: 2020 2020 2020 2020 666f 7220 695f 6d65          for i_me
-000447e0: 7468 6f64 2069 6e20 696e 745f 6d65 7468  thod in int_meth
-000447f0: 6f64 3a0d 0a20 2020 2020 2020 2020 2020  od:..           
-00044800: 2020 2020 2069 6620 695f 6d65 7468 6f64       if i_method
-00044810: 2069 6e20 2822 7367 7322 2c20 2266 6674   in ("sgs", "fft
-00044820: 222c 2022 686f 6d6f 6765 6e6f 7573 222c  ", "homogenous",
-00044830: 2022 6d70 7322 2c20 2268 6f6d 6f67 656e   "mps", "homogen
-00044840: 6f75 735f 756e 6966 6f72 6d22 293a 0d0a  ous_uniform"):..
-00044850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044860: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
-00044870: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00044880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044890: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000448a0: 4572 726f 7228 227b 7d20 6973 206e 6f74  Error("{} is not
-000448b0: 2061 2076 616c 6964 2069 6e74 6570 726f   a valid intepro
-000448c0: 6c61 7469 6f6e 206d 6574 686f 6422 2e66  lation method".f
-000448d0: 6f72 6d61 7428 695f 6d65 7468 6f64 2929  ormat(i_method))
-000448e0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-000448f0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00044900: 6620 696e 745f 6d65 7468 6f64 2069 6e20  f int_method in 
-00044910: 2822 7367 7322 2c20 2266 6674 222c 2022  ("sgs", "fft", "
-00044920: 686f 6d6f 6765 6e6f 7573 222c 2022 6d70  homogenous", "mp
-00044930: 7322 2c22 686f 6d6f 6765 6e6f 7573 5f75  s","homogenous_u
-00044940: 6e69 666f 726d 2229 3a0d 0a20 2020 2020  niform"):..     
-00044950: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00044960: 696e 743d 5b69 6e74 5f6d 6574 686f 645d  int=[int_method]
-00044970: 2a6e 5f66 6163 6965 730d 0a20 2020 2020  *n_facies..     
-00044980: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00044990: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000449a0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-000449b0: 7b7d 2069 7320 6e6f 7420 6120 7661 6c69  {} is not a vali
-000449c0: 6420 696e 7465 7072 6f6c 6174 696f 6e20  d inteprolation 
-000449d0: 6d65 7468 6f64 222e 666f 726d 6174 2869  method".format(i
-000449e0: 5f6d 6574 686f 6429 290d 0a0d 0a20 2020  _method))....   
-000449f0: 2020 2020 2073 656c 662e 6465 665f 6d65       self.def_me
-00044a00: 616e 3d64 6566 5f6d 6561 6e0d 0a0d 0a20  an=def_mean.... 
-00044a10: 2020 2020 2020 2064 6566 205f 5f65 715f         def __eq_
-00044a20: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0d  _(self, other):.
-00044a30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00044a40: 2873 656c 662e 6e61 6d65 203d 3d20 6f74  (self.name == ot
-00044a50: 6865 722e 6e61 6d65 293a 0d0a 2020 2020  her.name):..    
-00044a60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00044a70: 726e 2054 7275 650d 0a20 2020 2020 2020  rn True..       
-00044a80: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00044a90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00044aa0: 726e 2046 616c 7365 0d0a 0d0a 2020 2020  rn False....    
-00044ab0: 2020 2020 6465 6620 5f5f 7265 7072 5f5f      def __repr__
-00044ac0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-00044ad0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00044ae0: 2e6e 616d 650d 0a0d 0a0d 0a20 2020 2064  .name......    d
-00044af0: 6566 2061 6464 5f68 6428 7365 6c66 2c20  ef add_hd(self, 
-00044b00: 782c 7629 3a0d 0a0d 0a20 2020 2020 2020  x,v):....       
-00044b10: 2022 2222 0d0a 2020 2020 2020 2020 6164   """..        ad
-00044b20: 6420 6861 7264 2064 6174 6120 746f 2074  d hard data to t
-00044b30: 6865 2070 726f 7065 7274 790d 0a0d 0a20  he property.... 
-00044b40: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00044b50: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00044b60: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2078  -----..        x
-00044b70: 203a 206e 6461 7272 6179 206f 6620 7369   : ndarray of si
-00044b80: 7a65 2028 6e2c 2032 202d 2d3e 2078 2c20  ze (n, 2 --> x, 
-00044b90: 7929 0d0a 2020 2020 2020 2020 2020 2020  y)..            
-00044ba0: 706f 7369 7469 6f6e 206f 6620 6861 7264  position of hard
-00044bb0: 2064 6174 610d 0a20 2020 2020 2020 2076   data..        v
-00044bc0: 203a 206e 6461 7272 6179 206f 6620 7369   : ndarray of si
-00044bd0: 7a65 2028 6e2c 2031 202d 2d3e 2076 616c  ze (n, 1 --> val
-00044be0: 7565 290d 0a20 2020 2020 2020 2020 2020  ue)..           
-00044bf0: 2076 616c 7565 206f 6620 6861 7264 2064   value of hard d
-00044c00: 6174 610d 0a20 2020 2020 2020 2022 2222  ata..        """
-00044c10: 0d0a 0d0a 2020 2020 2020 2020 6173 7365  ....        asse
-00044c20: 7274 2078 2e73 6861 7065 5b31 5d20 3d3d  rt x.shape[1] ==
-00044c30: 2033 2c20 2269 6e76 616c 6964 2073 6861   3, "invalid sha
-00044c40: 7065 2066 6f72 2068 6420 706f 7369 7469  pe for hd positi
-00044c50: 6f6e 2028 7829 2c20 6d75 7374 2062 6520  on (x), must be 
-00044c60: 286e 6461 7461 2c20 3329 220d 0a20 2020  (ndata, 3)"..   
-00044c70: 2020 2020 2061 7373 6572 7420 762e 7368       assert v.sh
-00044c80: 6170 655b 305d 203d 3d20 782e 7368 6170  ape[0] == x.shap
-00044c90: 655b 305d 2c20 2269 6e76 616c 6964 206e  e[0], "invalid n
-00044ca0: 756d 6265 7220 6f66 2064 6174 6120 706f  umber of data po
-00044cb0: 696e 7473 2062 6574 7765 656e 2076 2061  ints between v a
-00044cc0: 6e64 2078 220d 0a0d 0a20 2020 2020 2020  nd x"....       
-00044cd0: 2073 656c 662e 783d 780d 0a20 2020 2020   self.x=x..     
-00044ce0: 2020 2073 656c 662e 763d 760d 0a0d 0a0d     self.v=v.....
-00044cf0: 0a63 6c61 7373 2062 6f72 6568 6f6c 6528  .class borehole(
-00044d00: 293a 0d0a 0d0a 2020 2020 2222 220d 0a20  ):....    """.. 
-00044d10: 2020 2043 6c61 7373 2074 6f20 6372 6561     Class to crea
-00044d20: 7465 2061 2062 6f72 6568 6f6c 6520 6f62  te a borehole ob
-00044d30: 6a65 6374 2e20 0d0a 2020 2020 426f 7265  ject. ..    Bore
-00044d40: 686f 6c65 2061 7265 2075 7365 6420 746f  hole are used to
-00044d50: 2064 6566 696e 6520 7468 6520 6c69 7468   define the lith
-00044d60: 6f6c 6f67 7920 616e 6420 6164 6420 636f  ology and add co
-00044d70: 6e64 6974 696f 6e69 6e67 2064 6174 6120  nditioning data 
-00044d80: 696e 746f 2041 7263 6850 7920 6d6f 6465  into ArchPy mode
-00044d90: 6c73 0d0a 0d0a 2020 2020 5061 7261 6d65  ls....    Parame
-00044da0: 7465 7273 0d0a 2020 2020 2d2d 2d2d 2d2d  ters..    ------
-00044db0: 2d2d 2d2d 0d0a 2020 2020 6e61 6d65 203a  ----..    name :
-00044dc0: 2073 7472 696e 670d 0a20 2020 2020 2020   string..       
-00044dd0: 206e 616d 6520 6f66 2074 6865 2062 6f72   name of the bor
-00044de0: 6568 6f6c 652c 206e 6f74 2075 7365 640d  ehole, not used.
-00044df0: 0a20 2020 2049 4420 3a20 696e 740d 0a20  .    ID : int.. 
-00044e00: 2020 2020 2020 2049 4420 6f66 2074 6865         ID of the
-00044e10: 2062 6f72 6568 6f6c 650d 0a20 2020 2078   borehole..    x
-00044e20: 2c20 792c 207a 203a 2066 6c6f 6174 0d0a  , y, z : float..
-00044e30: 2020 2020 2020 2020 782c 2079 2c20 7a20          x, y, z 
-00044e40: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
-00044e50: 6865 2074 6f70 206f 6620 7468 6520 626f  he top of the bo
-00044e60: 7265 686f 6c65 0d0a 2020 2020 6465 7074  rehole..    dept
-00044e70: 6820 3a20 666c 6f61 740d 0a20 2020 2020  h : float..     
-00044e80: 2020 2064 6570 7468 206f 6620 7468 6520     depth of the 
-00044e90: 626f 7265 686f 6c65 0d0a 2020 2020 6c6f  borehole..    lo
-00044ea0: 675f 7374 7261 7469 203a 206c 6973 7420  g_strati : list 
-00044eb0: 6f66 2074 7570 6c65 730d 0a20 2020 2020  of tuples..     
-00044ec0: 2020 206c 6f67 5f73 7472 6174 6920 636f     log_strati co
-00044ed0: 6e74 6169 6e73 2074 6865 2067 656f 6c6f  ntains the geolo
-00044ee0: 6769 6361 6c20 696e 666f 726d 6174 696f  gical informatio
-00044ef0: 6e20 6162 6f75 7420 7468 6520 756e 6974  n about the unit
-00044f00: 7320 696e 2074 6865 2062 6f72 6568 6f6c  s in the borehol
-00044f10: 650d 0a20 2020 2020 2020 2069 6e66 6f72  e..        infor
-00044f20: 6d61 7469 6f6e 2069 7320 6769 7665 6e20  mation is given 
-00044f30: 6279 2069 6e74 6572 7661 6c73 206f 6620  by intervals of 
-00044f40: 7468 6520 666f 726d 2028 7374 7261 7469  the form (strati
-00044f50: 2c20 746f 7029 2077 6865 7265 2073 7472  , top) where str
-00044f60: 6174 6920 6973 2061 203a 636c 6173 733a  ati is a :class:
-00044f70: 6055 6e69 7460 206f 626a 6563 740d 0a20  `Unit` object.. 
-00044f80: 2020 2020 2020 2061 6e64 2074 6f70 2069         and top i
-00044f90: 7320 7468 6520 746f 7020 616c 7469 7475  s the top altitu
-00044fa0: 6465 206f 6620 756e 6974 2069 6e74 6572  de of unit inter
-00044fb0: 7661 6c0d 0a20 2020 206c 6f67 5f66 6163  val..    log_fac
-00044fc0: 6965 7320 3a20 6c69 7374 206f 6620 7475  ies : list of tu
-00044fd0: 706c 6573 0d0a 2020 2020 2020 2020 6c6f  ples..        lo
-00044fe0: 675f 6661 6369 6573 2063 6f6e 7461 696e  g_facies contain
-00044ff0: 7320 7468 6520 6661 6369 6573 2069 6e66  s the facies inf
-00045000: 6f72 6d61 7469 6f6e 2061 626f 7574 2074  ormation about t
-00045010: 6865 2062 6f72 6568 6f6c 650d 0a20 2020  he borehole..   
-00045020: 2020 2020 2069 6e66 6f72 6d61 7469 6f6e       information
-00045030: 2069 7320 6769 7665 6e20 6279 2069 6e74   is given by int
-00045040: 6572 7661 6c73 206f 6620 7468 6520 666f  ervals of the fo
-00045050: 726d 2028 6661 6369 6573 2c20 746f 7029  rm (facies, top)
-00045060: 2077 6865 7265 2066 6163 6965 7320 6973   where facies is
-00045070: 2061 203a 636c 6173 733a 6046 6163 6965   a :class:`Facie
-00045080: 7360 206f 626a 6563 740d 0a20 2020 2020  s` object..     
-00045090: 2020 2061 6e64 2074 6f70 2069 7320 7468     and top is th
-000450a0: 6520 746f 7020 616c 7469 7475 6465 206f  e top altitude o
-000450b0: 6620 6661 6369 6573 2069 6e74 6572 7661  f facies interva
-000450c0: 6c0d 0a20 2020 2022 2222 0d0a 0d0a 2020  l..    """....  
-000450d0: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
-000450e0: 656c 662c 206e 616d 652c 2049 442c 2078  elf, name, ID, x
-000450f0: 2c20 792c 207a 2c20 6465 7074 682c 206c  , y, z, depth, l
-00045100: 6f67 5f73 7472 6174 692c 206c 6f67 5f66  og_strati, log_f
-00045110: 6163 6965 733d 4e6f 6e65 293a 0d0a 0d0a  acies=None):....
-00045120: 2020 2020 2020 2020 7365 6c66 2e6e 616d          self.nam
-00045130: 653d 6e61 6d65 2020 2320 6e61 6d65 206f  e=name  # name o
-00045140: 6620 6c69 7468 6f6c 6f67 790d 0a20 2020  f lithology..   
-00045150: 2020 2020 2073 656c 662e 4944 3d49 4420       self.ID=ID 
-00045160: 2023 2049 4420 6f66 2074 6865 2062 6f72   # ID of the bor
-00045170: 6568 6f6c 6573 0d0a 2020 2020 2020 2020  eholes..        
-00045180: 7365 6c66 2e78 3d78 2020 2320 7820 636f  self.x=x  # x co
-00045190: 6f72 6469 6e61 7465 206f 6620 626f 7265  ordinate of bore
-000451a0: 686f 6c65 0d0a 2020 2020 2020 2020 7365  hole..        se
-000451b0: 6c66 2e79 3d79 2020 2320 7920 636f 6f72  lf.y=y  # y coor
-000451c0: 6469 6e61 7465 206f 6620 626f 7265 686f  dinate of boreho
-000451d0: 6c65 0d0a 2020 2020 2020 2020 7365 6c66  le..        self
-000451e0: 2e7a 3d7a 2020 2320 616c 7469 7475 6465  .z=z  # altitude
-000451f0: 206f 6620 7468 6520 6268 2028 63c3 b474   of the bh (c..t
-00045200: 6520 7465 7272 6169 6e29 0d0a 2020 2020  e terrain)..    
-00045210: 2020 2020 7365 6c66 2e64 6570 7468 3d64      self.depth=d
-00045220: 6570 7468 0d0a 2020 2020 2020 2020 7365  epth..        se
-00045230: 6c66 2e6c 6f67 5f73 7472 6174 693d 6c6f  lf.log_strati=lo
-00045240: 675f 7374 7261 7469 0d0a 2020 2020 2020  g_strati..      
-00045250: 2020 7365 6c66 2e6c 6f67 5f66 6163 6965    self.log_facie
-00045260: 733d 6c6f 675f 6661 6369 6573 0d0a 2020  s=log_facies..  
-00045270: 2020 2020 2020 7365 6c66 2e6c 6f67 5f72        self.log_r
-00045280: 6177 203d 204e 6f6e 650d 0a0d 0a20 2020  aw = None....   
-00045290: 2020 2020 2069 6620 6c6f 675f 7374 7261       if log_stra
-000452a0: 7469 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ti is not None:.
-000452b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000452c0: 662e 6c69 7374 5f73 7472 6174 6973 3d5b  f.list_stratis=[
-000452d0: 7320 666f 7220 732c 2064 2069 6e20 7365  s for s, d in se
-000452e0: 6c66 2e6c 6f67 5f73 7472 6174 695d 0d0a  lf.log_strati]..
-000452f0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-00045300: 656e 2873 656c 662e 6c69 7374 5f73 7472  en(self.list_str
-00045310: 6174 6973 2920 3d3d 2030 3a0d 0a20 2020  atis) == 0:..   
-00045320: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00045330: 662e 6c6f 675f 7374 7261 7469 3d4e 6f6e  f.log_strati=Non
-00045340: 650d 0a0d 0a20 2020 2020 2020 2069 6620  e....        if 
-00045350: 6c6f 675f 6661 6369 6573 2069 7320 6e6f  log_facies is no
-00045360: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
-00045370: 2020 2020 2073 656c 662e 6c69 7374 5f66       self.list_f
-00045380: 6163 6965 7320 3d5b 7320 666f 7220 732c  acies =[s for s,
-00045390: 2064 2069 6e20 7365 6c66 2e6c 6f67 5f66   d in self.log_f
-000453a0: 6163 6965 735d 0d0a 2020 2020 2020 2020  acies]..        
-000453b0: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
-000453c0: 6c6f 675f 6661 6369 6573 2920 3d3d 2030  log_facies) == 0
-000453d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000453e0: 2020 2073 656c 662e 6c6f 675f 6661 6369     self.log_faci
-000453f0: 6573 3d4e 6f6e 650d 0a0d 0a0d 0a20 2020  es=None......   
-00045400: 2064 6566 2067 6574 5f6c 6973 745f 7374   def get_list_st
-00045410: 7261 7469 7328 7365 6c66 293a 0d0a 2020  ratis(self):..  
-00045420: 2020 2020 2020 7365 6c66 2e6c 6973 745f        self.list_
-00045430: 7374 7261 7469 733d 5b73 2066 6f72 2073  stratis=[s for s
-00045440: 2c20 6420 696e 2073 656c 662e 6c6f 675f  , d in self.log_
-00045450: 7374 7261 7469 5d0d 0a20 2020 2020 2020  strati]..       
-00045460: 2072 6574 7572 6e20 7365 6c66 2e6c 6973   return self.lis
-00045470: 745f 7374 7261 7469 730d 0a0d 0a20 2020  t_stratis....   
-00045480: 2064 6566 2067 6574 5f6c 6973 745f 6661   def get_list_fa
-00045490: 6369 6573 2873 656c 6629 3a0d 0a20 2020  cies(self):..   
-000454a0: 2020 2020 2073 656c 662e 6c69 7374 5f66       self.list_f
-000454b0: 6163 6965 7320 3d5b 7320 666f 7220 732c  acies =[s for s,
-000454c0: 2064 2069 6e20 7365 6c66 2e6c 6f67 5f66   d in self.log_f
-000454d0: 6163 6965 735d 0d0a 2020 2020 2020 2020  acies]..        
-000454e0: 7265 7475 726e 2073 656c 662e 6c69 7374  return self.list
-000454f0: 5f66 6163 6965 730d 0a0d 0a20 2020 2064  _facies....    d
-00045500: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
-00045510: 6f74 6865 7229 3a0d 0a20 2020 2020 2020  other):..       
-00045520: 2069 6620 2028 7365 6c66 2e49 4420 3d3d   if  (self.ID ==
-00045530: 206f 7468 6572 2e49 4429 2026 205c 0d0a   other.ID) & \..
-00045540: 2020 2020 2020 2020 2873 656c 662e 7820          (self.x 
-00045550: 3d3d 206f 7468 6572 2e78 2920 2620 2873  == other.x) & (s
-00045560: 656c 662e 7920 3d3d 206f 7468 6572 2e79  elf.y == other.y
-00045570: 2920 2620 2873 656c 662e 7a20 3d3d 206f  ) & (self.z == o
-00045580: 7468 6572 2e7a 293a 0d0a 2020 2020 2020  ther.z):..      
-00045590: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-000455a0: 650d 0a20 2020 2020 2020 2065 6c73 653a  e..        else:
-000455b0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-000455c0: 7475 726e 2046 616c 7365 0d0a 0d0a 2020  turn False....  
-000455d0: 2020 6465 6620 7365 745f 6c6f 675f 7374    def set_log_st
-000455e0: 7261 7469 2873 656c 662c 206c 6f67 5f73  rati(self, log_s
-000455f0: 7472 6174 6929 3a0d 0a20 2020 2020 2020  trati):..       
-00045600: 2073 656c 662e 6c6f 675f 7374 7261 7469   self.log_strati
-00045610: 3d6c 6f67 5f73 7472 6174 690d 0a0d 0a20  =log_strati.... 
-00045620: 2020 2064 6566 2073 6574 5f6c 6f67 5f66     def set_log_f
-00045630: 6163 6965 7328 7365 6c66 2c20 6c6f 675f  acies(self, log_
-00045640: 6661 6369 6573 293a 0d0a 2020 2020 2020  facies):..      
-00045650: 2020 7365 6c66 2e6c 6f67 5f66 6163 6965    self.log_facie
-00045660: 733d 6c6f 675f 6661 6369 6573 0d0a 0d0a  s=log_facies....
-00045670: 2020 2020 6465 6620 7072 6f70 5f75 6e69      def prop_uni
-00045680: 7473 2873 656c 6629 3a0d 0a0d 0a20 2020  ts(self):....   
-00045690: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000456a0: 2020 5265 7475 726e 2061 2064 6963 7469    Return a dicti
-000456b0: 6f6e 6e61 7279 206f 6620 7468 6520 7072  onnary of the pr
-000456c0: 6f70 6f72 7469 6f6e 206f 6620 7468 6520  oportion of the 
-000456d0: 756e 6974 7320 696e 2074 6865 2062 6f72  units in the bor
-000456e0: 6568 6f6c 650d 0a20 2020 2020 2020 2022  ehole..        "
-000456f0: 2222 0d0a 0d0a 2020 2020 2020 2020 6420  ""....        d 
-00045700: 3d20 7b7d 0d0a 0d0a 2020 2020 2020 2020  = {}....        
-00045710: 616c 745f 7072 6576 203d 2073 656c 662e  alt_prev = self.
-00045720: 7a0d 0a20 2020 2020 2020 2075 6e69 745f  z..        unit_
-00045730: 7072 6576 203d 204e 6f6e 650d 0a20 2020  prev = None..   
-00045740: 2020 2020 2066 6f72 2073 2069 6e20 7365       for s in se
-00045750: 6c66 2e6c 6f67 5f73 7472 6174 693a 0d0a  lf.log_strati:..
-00045760: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00045770: 5b30 5d20 6973 206e 6f74 204e 6f6e 653a  [0] is not None:
-00045780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045790: 2020 6966 2073 5b30 5d2e 6e61 6d65 206e    if s[0].name n
-000457a0: 6f74 2069 6e20 642e 6b65 7973 2829 3a0d  ot in d.keys():.
-000457b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000457c0: 2020 2020 2064 5b73 5b30 5d2e 6e61 6d65       d[s[0].name
-000457d0: 5d20 3d20 300d 0a20 2020 2020 2020 2020  ] = 0..         
-000457e0: 2020 2020 2020 200d 0a20 2020 2020 2020         ..       
-000457f0: 2020 2020 2020 2020 2069 6620 756e 6974           if unit
-00045800: 5f70 7265 7620 6973 206e 6f74 204e 6f6e  _prev is not Non
-00045810: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00045820: 2020 2020 2020 2020 7468 6b20 3d20 756e          thk = un
-00045830: 6974 5f70 7265 765b 315d 202d 2073 5b31  it_prev[1] - s[1
-00045840: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00045850: 2020 2020 2020 2064 5b75 6e69 745f 7072         d[unit_pr
-00045860: 6576 5b30 5d2e 6e61 6d65 5d20 2b3d 2074  ev[0].name] += t
-00045870: 686b 0d0a 2020 2020 2020 2020 2020 2020  hk..            
-00045880: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00045890: 2020 2020 2020 2020 2020 756e 6974 5f70            unit_p
-000458a0: 7265 7620 3d20 730d 0a20 2020 2020 2020  rev = s..       
-000458b0: 2074 686b 203d 2075 6e69 745f 7072 6576   thk = unit_prev
-000458c0: 5b31 5d20 2d20 2873 656c 662e 7a20 2d20  [1] - (self.z - 
-000458d0: 7365 6c66 2e64 6570 7468 290d 0a20 2020  self.depth)..   
-000458e0: 2020 2020 2064 5b75 6e69 745f 7072 6576       d[unit_prev
-000458f0: 5b30 5d2e 6e61 6d65 5d20 2b3d 2074 686b  [0].name] += thk
-00045900: 200d 0a0d 0a20 2020 2020 2020 2066 6f72   ....        for
-00045910: 206b 2c76 2069 6e20 642e 6974 656d 7328   k,v in d.items(
-00045920: 293a 2020 2320 6d65 616e 0d0a 2020 2020  ):  # mean..    
-00045930: 2020 2020 2020 2020 645b 6b5d 202f 3d20          d[k] /= 
-00045940: 7365 6c66 2e64 6570 7468 0d0a 0d0a 2020  self.depth....  
-00045950: 2020 2020 2020 7265 7475 726e 2064 0d0a        return d..
-00045960: 0d0a 2020 2020 6465 6620 6578 7472 6163  ..    def extrac
-00045970: 7428 7365 6c66 2c20 7a2c 2076 623d 3129  t(self, z, vb=1)
-00045980: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
-00045990: 6578 7472 6163 7420 7468 6520 756e 6974  extract the unit
-000459a0: 7320 616e 6420 6661 6369 6573 2069 6e66  s and facies inf
-000459b0: 6f72 6d61 7469 6f6e 2061 7420 7370 6563  ormation at spec
-000459c0: 6966 6965 6420 616c 7469 7475 6465 207a  ified altitude z
-000459d0: 2222 220d 0a0d 0a20 2020 2020 2020 206c  """....        l
-000459e0: 733d 4661 6c73 650d 0a20 2020 2020 2020  s=False..       
-000459f0: 206c 663d 4661 6c73 650d 0a20 2020 2020   lf=False..     
-00045a00: 2020 2075 6e69 743d 4e6f 6e65 0d0a 2020     unit=None..  
-00045a10: 2020 2020 2020 6661 6369 6573 3d4e 6f6e        facies=Non
-00045a20: 650d 0a0d 0a20 2020 2020 2020 2069 6620  e....        if 
-00045a30: 7a20 3e20 7365 6c66 2e7a 206f 7220 7a20  z > self.z or z 
-00045a40: 3c20 7365 6c66 2e7a 202d 2073 656c 662e  < self.z - self.
-00045a50: 6465 7074 683a 0d0a 2020 2020 2020 2020  depth:..        
-00045a60: 2020 2020 6966 2076 623a 0d0a 2020 2020      if vb:..    
-00045a70: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00045a80: 7428 2262 6f72 6568 6f6c 6520 6861 7665  t("borehole have
-00045a90: 206e 6f20 696e 666f 726d 6174 696f 6e20   no information 
-00045aa0: 6174 2074 6869 7320 616c 7469 7475 6465  at this altitude
-00045ab0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-00045ac0: 7265 7475 726e 204e 6f6e 650d 0a0d 0a20  return None.... 
-00045ad0: 2020 2020 2020 2069 6620 7365 6c66 2e6c         if self.l
-00045ae0: 6f67 5f73 7472 6174 6920 6973 206e 6f74  og_strati is not
-00045af0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00045b00: 2020 2020 6c73 3d54 7275 650d 0a20 2020      ls=True..   
-00045b10: 2020 2020 2020 2020 2066 6f72 2069 2069           for i i
-00045b20: 6e20 7261 6e67 6528 6c65 6e28 7365 6c66  n range(len(self
-00045b30: 2e6c 6f67 5f73 7472 6174 6929 293a 0d0a  .log_strati)):..
-00045b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b50: 6966 2069 203c 206c 656e 2873 656c 662e  if i < len(self.
-00045b60: 6c6f 675f 7374 7261 7469 2920 2d20 313a  log_strati) - 1:
-00045b70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045b80: 2020 2020 2020 7331 203d 2073 656c 662e        s1 = self.
-00045b90: 6c6f 675f 7374 7261 7469 5b69 5d0d 0a20  log_strati[i].. 
-00045ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045bb0: 2020 2073 3220 3d20 7365 6c66 2e6c 6f67     s2 = self.log
-00045bc0: 5f73 7472 6174 695b 692b 315d 0d0a 2020  _strati[i+1]..  
-00045bd0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00045be0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00045bf0: 2020 2020 2020 2020 2073 3120 3d20 7365           s1 = se
-00045c00: 6c66 2e6c 6f67 5f73 7472 6174 695b 695d  lf.log_strati[i]
-00045c10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045c20: 2020 2020 2020 7332 203d 2028 4e6f 6e65        s2 = (None
-00045c30: 2c20 7365 6c66 2e7a 202d 2073 656c 662e  , self.z - self.
-00045c40: 6465 7074 6829 0d0a 2020 2020 2020 2020  depth)..        
-00045c50: 2020 2020 2020 2020 6966 2073 315b 315d          if s1[1]
-00045c60: 203e 3d20 7a20 616e 6420 7332 5b31 5d20   >= z and s2[1] 
-00045c70: 3c20 7a3a 0d0a 2020 2020 2020 2020 2020  < z:..          
-00045c80: 2020 2020 2020 2020 2020 756e 6974 3d73            unit=s
-00045c90: 315b 305d 0d0a 2020 2020 2020 2020 2020  1[0]..          
-00045ca0: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
-00045cb0: 0a0d 0a0d 0a20 2020 2020 2020 2069 6620  .....        if 
-00045cc0: 7365 6c66 2e6c 6f67 5f66 6163 6965 7320  self.log_facies 
-00045cd0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00045ce0: 2020 2020 2020 2020 2020 6c66 3d54 7275            lf=Tru
-00045cf0: 650d 0a20 2020 2020 2020 2020 2020 2066  e..            f
-00045d00: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00045d10: 6e28 7365 6c66 2e6c 6f67 5f66 6163 6965  n(self.log_facie
-00045d20: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
-00045d30: 2020 2020 2020 6966 2069 203c 206c 656e        if i < len
-00045d40: 2873 656c 662e 6c6f 675f 6661 6369 6573  (self.log_facies
-00045d50: 2920 2d20 313a 0d0a 2020 2020 2020 2020  ) - 1:..        
-00045d60: 2020 2020 2020 2020 2020 2020 6631 203d              f1 =
-00045d70: 2073 656c 662e 6c6f 675f 6661 6369 6573   self.log_facies
-00045d80: 5b69 5d0d 0a20 2020 2020 2020 2020 2020  [i]..           
-00045d90: 2020 2020 2020 2020 2066 3220 3d20 7365           f2 = se
-00045da0: 6c66 2e6c 6f67 5f66 6163 6965 735b 692b  lf.log_facies[i+
-00045db0: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
-00045dc0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00045dd0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00045de0: 3120 3d20 7365 6c66 2e6c 6f67 5f66 6163  1 = self.log_fac
-00045df0: 6965 735b 695d 0d0a 2020 2020 2020 2020  ies[i]..        
-00045e00: 2020 2020 2020 2020 2020 2020 6632 203d              f2 =
-00045e10: 2028 4e6f 6e65 2c20 7365 6c66 2e7a 202d   (None, self.z -
-00045e20: 2073 656c 662e 6465 7074 6829 0d0a 2020   self.depth)..  
-00045e30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00045e40: 2066 315b 315d 203e 3d20 7a20 616e 6420   f1[1] >= z and 
-00045e50: 6632 5b31 5d20 3c20 7a3a 0d0a 2020 2020  f2[1] < z:..    
-00045e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e70: 6661 6369 6573 3d66 315b 305d 0d0a 2020  facies=f1[0]..  
+00042970: 2020 2020 2020 2020 585f 7072 6564 203d          X_pred =
+00042980: 2078 7533 445b 6d61 736b 2e66 6c61 7474   xu3D[mask.flatt
+00042990: 656e 2829 5d0d 0a0d 0a20 2020 2020 2020  en()]....       
+000429a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000429b0: 2023 2066 6974 0d0a 2020 2020 2020 2020   # fit..        
+000429c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000429d0: 6e6e 203d 204e 6561 7265 7374 4e65 6967  nn = NearestNeig
+000429e0: 6862 6f72 7328 6e5f 6e65 6967 6862 6f72  hbors(n_neighbor
+000429f0: 733d 3129 2e66 6974 2858 5f66 6974 290d  s=1).fit(X_fit).
+00042a00: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
+00042a10: 2020 2020 2020 2020 2020 2023 7072 6564             #pred
+00042a20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042a30: 2020 2020 2020 2020 2020 7265 7320 3d20            res = 
+00042a40: 6e6e 2e6b 6e65 6967 6862 6f72 7328 585f  nn.kneighbors(X_
+00042a50: 7072 6564 2c20 7265 7475 726e 5f64 6973  pred, return_dis
+00042a60: 7461 6e63 653d 4661 6c73 652c 206e 5f6e  tance=False, n_n
+00042a70: 6569 6768 626f 7273 3d31 290d 0a0d 0a20  eighbors=1).... 
+00042a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042a90: 2020 2020 2020 2023 2061 7373 6967 6e0d         # assign.
+00042aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042ab0: 2020 2020 2020 2020 2079 5f70 7265 6420           y_pred 
+00042ac0: 3d20 795f 6669 745b 7265 735d 0d0a 2020  = y_fit[res]..  
+00042ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042ae0: 2020 2020 2020 7369 6d75 7320 3d20 6e70        simus = np
+00042af0: 2e7a 6572 6f73 285b 6e7a 2c20 6e79 2c20  .zeros([nz, ny, 
+00042b00: 6e78 5d29 0d0a 2020 2020 2020 2020 2020  nx])..          
+00042b10: 2020 2020 2020 2020 2020 2020 2020 7369                si
+00042b20: 6d75 735b 6d61 736b 5d20 3d20 795f 7072  mus[mask] = y_pr
+00042b30: 6564 5b3a 2c20 305d 2020 2320 7265 6173  ed[:, 0]  # reas
+00042b40: 7369 676e 2076 616c 7565 730d 0a0d 0a20  sign values.... 
+00042b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042b60: 2020 2020 2020 2066 6f72 2069 7265 616c         for ireal
+00042b70: 2069 6e20 7261 6e67 6528 6e72 6561 6c29   in range(nreal)
+00042b80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00042b90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00042ba0: 6163 6965 735f 646f 6d61 696e 735b 6975  acies_domains[iu
+00042bb0: 2c20 6972 6561 6c5d 5b6d 6173 6b5d 3d73  , ireal][mask]=s
+00042bc0: 696d 7573 5b6d 6173 6b5d 0d0a 0d0a 0d0a  imus[mask]......
+00042bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042be0: 6966 206d 6f64 6520 3d3d 2022 6661 6369  if mode == "faci
+00042bf0: 6573 223a 0d0a 2020 2020 2020 2020 2020  es":..          
+00042c00: 2020 2020 2020 2020 2020 4172 6368 5461            ArchTa
+00042c10: 626c 652e 4765 6f6c 2e66 6163 6965 735f  ble.Geol.facies_
+00042c20: 646f 6d61 696e 735b 6975 2c3a 2c20 6d61  domains[iu,:, ma
+00042c30: 736b 5d3d 6661 6369 6573 5f64 6f6d 6169  sk]=facies_domai
+00042c40: 6e73 5b69 752c 3a2c 206d 6173 6b5d 2020  ns[iu,:, mask]  
+00042c50: 2320 7374 6f72 6520 7265 7375 6c74 730d  # store results.
+00042c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042c70: 2065 6c69 6620 6d6f 6465 203d 3d20 2275   elif mode == "u
+00042c80: 6e69 7473 223a 0d0a 2020 2020 2020 2020  nits":..        
+00042c90: 2020 2020 2020 2020 2020 2020 4172 6368              Arch
+00042ca0: 5461 626c 652e 4765 6f6c 2e75 6e69 7473  Table.Geol.units
+00042cb0: 5f64 6f6d 6169 6e73 5b69 752c 206d 6173  _domains[iu, mas
+00042cc0: 6b5d 203d 2066 6163 6965 735f 646f 6d61  k] = facies_doma
+00042cd0: 696e 735b 6975 2c20 302c 206d 6173 6b5d  ins[iu, 0, mask]
+00042ce0: 2020 2320 7374 6f72 6520 7265 7375 6c74    # store result
+00042cf0: 730d 0a20 2020 2020 2020 2065 6c69 6620  s..        elif 
+00042d00: 6d65 7468 6f64 203d 3d20 2253 7562 5069  method == "SubPi
+00042d10: 6c65 223a 2023 2048 6965 7261 7263 6869  le": # Hierarchi
+00042d20: 6361 6c20 6669 6c6c 696e 670d 0a20 2020  cal filling..   
+00042d30: 2020 2020 2020 2020 2069 6620 4172 6368           if Arch
+00042d40: 5461 626c 652e 7665 7262 6f73 653a 0d0a  Table.verbose:..
+00042d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042d60: 7072 696e 7428 2253 7562 5069 6c65 2066  print("SubPile f
+00042d70: 696c 6c69 6e67 206d 6574 686f 642c 206e  illing method, n
+00042d80: 6f74 6869 6e67 2068 6170 7065 6e65 6422  othing happened"
+00042d90: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00042da0: 6173 730d 0a0d 0a63 6c61 7373 2053 7572  ass....class Sur
+00042db0: 6661 6365 2829 3a0d 0a0d 0a20 2020 2022  face():....    "
+00042dc0: 2222 0d0a 2020 2020 436c 6173 7320 5375  ""..    Class Su
+00042dd0: 7266 6163 652c 206d 7573 7420 6265 206c  rface, must be l
+00042de0: 696e 6b65 6420 746f 2061 203a 636c 6173  inked to a :clas
+00042df0: 733a 6055 6e69 7460 206f 626a 6563 740d  s:`Unit` object.
+00042e00: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00042e10: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00042e20: 2d0d 0a20 2020 206e 616d 6520 3a20 7374  -..    name : st
+00042e30: 7269 6e67 0d0a 2020 2020 2020 2020 746f  ring..        to
+00042e40: 2069 6465 6e74 6966 7920 7468 6520 7375   identify the su
+00042e50: 7266 6163 6520 666f 7220 6465 6275 6767  rface for debugg
+00042e60: 696e 6720 7075 7270 6f73 650d 0a20 2020  ing purpose..   
+00042e70: 2063 6f6e 7461 6374 203a 2073 7472 696e   contact : strin
+00042e80: 670d 0a20 2020 2020 2020 206f 6e6c 6170  g..        onlap
+00042e90: 206f 7220 6572 6f64 652e 204f 6e6c 6170   or erode. Onlap
+00042ea0: 2069 6e64 6963 6174 6573 2074 6861 7420   indicates that 
+00042eb0: 7468 6973 2073 7572 6661 6365 2063 616e  this surface can
+00042ec0: 6e6f 7420 6572 6f64 6520 6f6c 6465 7220  not erode older 
+00042ed0: 7375 7266 6163 6573 2c0d 0a20 2020 2020  surfaces,..     
+00042ee0: 2020 206f 6e20 636f 6e74 7261 7279 2074     on contrary t
+00042ef0: 6f20 6572 6f64 6520 7375 7266 6163 6573  o erode surfaces
+00042f00: 0d0a 2020 2020 6469 635f 7375 7266 203a  ..    dic_surf :
+00042f10: 2064 6963 740d 0a20 2020 2020 2020 2070   dict..        p
+00042f20: 6172 616d 6574 6572 7320 666f 7220 7375  arameters for su
+00042f30: 7266 6163 6520 696e 7465 7270 6f6c 6174  rface interpolat
+00042f40: 696f 6e3a 0d0a 0d0a 2020 2020 2020 2020  ion:....        
+00042f50: 2020 2020 2d20 696e 745f 6d65 7468 6f64      - int_method
+00042f60: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
+00042f70: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00042f80: 6420 6f66 2069 6e74 6572 706f 6c61 7469  d of interpolati
+00042f90: 6f6e 2c20 706f 7373 6962 6c65 206d 6574  on, possible met
+00042fa0: 686f 6473 2061 7265 3a0d 0a20 2020 2020  hods are:..     
+00042fb0: 2020 2020 2020 2020 2020 206b 7269 6769             krigi
+00042fc0: 6e67 2c20 4d50 532c 2067 7266 2c20 6772  ng, MPS, grf, gr
+00042fd0: 665f 696e 6571 2c20 6c69 6e65 6172 2c20  f_ineq, linear, 
+00042fe0: 6e65 6172 6573 742c 0d0a 2020 2020 2020  nearest,..      
+00042ff0: 2020 2020 2020 2d20 636f 766d 6f64 656c        - covmodel
+00043000: 203a 2073 7472 696e 670d 0a20 2020 2020   : string..     
+00043010: 2020 2020 2020 2020 2020 2067 656f 6e65             geone
+00043020: 2063 6f76 6172 6961 6e63 6520 6d6f 6465   covariance mode
+00043030: 6c20 2873 6565 2064 6f63 2047 656f 6e65  l (see doc Geone
+00043040: 2066 6f72 206d 6f72 6520 696e 666f 726d   for more inform
+00043050: 6174 696f 6e29 0d0a 2020 2020 2020 2020  ation)..        
+00043060: 2020 2020 2020 2020 6966 2061 206d 756c          if a mul
+00043070: 7469 2d67 6175 7373 6961 6e20 6d65 7468  ti-gaussian meth
+00043080: 6f64 2069 7320 7573 6564 0d0a 2020 2020  od is used..    
+00043090: 2020 2020 2020 2020 2d20 4e5f 7472 616e          - N_tran
+000430a0: 7366 6f20 3a20 626f 6f6c 0d0a 2020 2020  sfo : bool..    
+000430b0: 2020 2020 2020 2020 2020 2020 4e6f 726d              Norm
+000430c0: 616c 2d73 636f 7265 2074 7261 6e73 666f  al-score transfo
+000430d0: 726d 2e20 466c 6167 2074 6f20 6170 706c  rm. Flag to appl
+000430e0: 7920 6f72 206e 6f74 2061 204e 6f72 6d61  y or not a Norma
+000430f0: 6c20 5363 6f72 6520 6f6e 2074 6865 2064  l Score on the d
+00043100: 6174 6120 666f 7220 7468 6520 696e 7465  ata for the inte
+00043110: 7270 6f6c 6174 696f 6e0d 0a20 2020 2020  rpolation..     
+00043120: 2020 2020 2020 202d 2055 6e69 7473 206b         - Units k
+00043130: 7761 7267 7320 2028 7061 7373 6564 2069  wargs  (passed i
+00043140: 6e20 6469 635f 7375 7266 2064 6972 6563  n dic_surf direc
+00043150: 746c 7929 3a0d 0a0d 0a20 2020 2020 2020  tly):....       
+00043160: 2020 2020 2066 6f72 2074 6865 2073 6561       for the sea
+00043170: 7263 6820 656c 6c69 7073 6f69 6420 286b  rch ellipsoid (k
+00043180: 7269 6769 6e67 2c20 6772 662c 202e 2e2e  riging, grf, ...
+00043190: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000431a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000431b0: 2020 2d20 722c 2072 656c 6174 6976 6520    - r, relative 
+000431c0: 2874 6f20 636f 7661 7269 616e 6365 206d  (to covariance m
+000431d0: 6f64 656c 2920 7261 6469 7573 206f 6620  odel) radius of 
+000431e0: 7265 7365 6172 6368 2028 6465 6661 756c  research (defaul
+000431f0: 7420 6973 2031 290d 0a20 2020 2020 2020  t is 1)..       
+00043200: 2020 2020 2020 2020 202d 206e 6569 672c           - neig,
+00043210: 206e 756d 6265 7220 6f66 206e 6569 6768   number of neigh
+00043220: 626f 7572 730d 0a20 2020 2020 2020 2020  bours..         
+00043230: 2020 2020 2020 202d 206b 7269 675f 7479         - krig_ty
+00043240: 7065 3a20 7374 7269 6e67 2c20 6b72 6967  pe: string, krig
+00043250: 696e 6720 6d65 7468 6f64 2028 6f72 6469  ing method (ordi
+00043260: 6e61 7279 5f6b 7269 6769 6e67 2c20 7369  nary_kriging, si
+00043270: 6d70 6c65 5f6b 7269 6769 6e67 290d 0a20  mple_kriging).. 
+00043280: 2020 2020 2020 2020 2020 2066 6f72 204d             for M
+00043290: 5053 3a0d 0a20 2020 2020 2020 2020 2020  PS:..           
+000432a0: 200d 0a20 2020 2020 2020 2020 2020 2020   ..             
+000432b0: 2020 202d 2054 490d 0a20 2020 2020 2020     - TI..       
+000432c0: 2020 2020 2020 2020 202d 2076 6172 696f           - vario
+000432d0: 7573 204d 5053 2070 6172 616d 6574 6572  us MPS parameter
+000432e0: 732c 2073 6565 2067 656f 6e65 2064 6f63  s, see geone doc
+000432f0: 756d 656e 7461 7469 6f6e 0d0a 0d0a 2020  umentation....  
+00043300: 2020 2222 220d 0a0d 0a20 2020 2064 6566    """....    def
+00043310: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
+00043320: 6e61 6d65 3d22 5375 7266 6163 655f 3122  name="Surface_1"
+00043330: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00043340: 2020 2064 6963 5f73 7572 663d 7b22 696e     dic_surf={"in
+00043350: 745f 6d65 7468 6f64 223a 2022 6e65 6172  t_method": "near
+00043360: 6573 7422 2c20 2263 6f76 6d6f 6465 6c22  est", "covmodel"
+00043370: 3a20 4e6f 6e65 2c20 224e 5f74 7261 6e73  : None, "N_trans
+00043380: 666f 223a 2046 616c 7365 7d2c 0d0a 2020  fo": False},..  
+00043390: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000433a0: 6e74 6163 743d 226f 6e6c 6170 2229 3a0d  ntact="onlap"):.
+000433b0: 0a0d 0a20 2020 2020 2020 2061 7373 6572  ...        asser
+000433c0: 7420 636f 6e74 6163 7420 696e 205b 2265  t contact in ["e
+000433d0: 726f 6465 222c 2022 6f6e 6c61 7022 2c20  rode", "onlap", 
+000433e0: 2263 6f6d 6622 5d2c 2022 636f 6e74 6163  "comf"], "contac
+000433f0: 7420 6d75 7374 2062 6520 6572 6f64 6520  t must be erode 
+00043400: 6f72 206f 6e6c 6170 206f 7220 636f 6d66  or onlap or comf
+00043410: 220d 0a20 2020 2020 2020 2061 7373 6572  "..        asser
+00043420: 7420 6469 635f 7375 7266 5b22 696e 745f  t dic_surf["int_
+00043430: 6d65 7468 6f64 225d 2069 7320 6e6f 7420  method"] is not 
+00043440: 4e6f 6e65 2c20 2241 6e20 696e 7465 7270  None, "An interp
+00043450: 6f6c 6174 696f 6e20 6d65 7468 6f64 206d  olation method m
+00043460: 7573 7420 6265 2070 726f 7669 6465 6422  ust be provided"
+00043470: 0d0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00043480: 2064 6963 5f73 7572 665b 2269 6e74 5f6d   dic_surf["int_m
+00043490: 6574 686f 6422 5d20 696e 205b 226c 696e  ethod"] in ["lin
+000434a0: 6561 7222 2c20 2263 7562 6963 222c 2022  ear", "cubic", "
+000434b0: 6e65 6172 6573 7422 2c20 226b 7269 6769  nearest", "krigi
+000434c0: 6e67 222c 2022 6772 6622 2c20 2267 7266  ng", "grf", "grf
+000434d0: 5f69 6e65 7122 2c20 224d 5053 225d 2c20  _ineq", "MPS"], 
+000434e0: 2255 6e6b 6e6f 776e 2069 6e74 6572 706f  "Unknown interpo
+000434f0: 6c61 7469 6f6e 206d 6574 686f 6422 0d0a  lation method"..
+00043500: 0d0a 2020 2020 2020 2020 2364 6566 6175  ..        #defau
+00043510: 6c74 2076 616c 7565 7320 6469 6320 7375  lt values dic su
+00043520: 7266 0d0a 2020 2020 2020 2020 6b77 6172  rf..        kwar
+00043530: 6773 5f64 6566 5f73 7572 6661 6365 3d7b  gs_def_surface={
+00043540: 2263 6f76 6d6f 6465 6c22 3a20 4e6f 6e65  "covmodel": None
+00043550: 2c20 224e 5f74 7261 6e73 666f 223a 2046  , "N_transfo": F
+00043560: 616c 7365 2c20 2262 616e 6477 6964 7468  alse, "bandwidth
+00043570: 5f6d 756c 7422 3a20 312c 2022 7461 7522  _mult": 1, "tau"
+00043580: 3a20 307d 0d0a 2020 2020 2020 2020 666f  : 0}..        fo
+00043590: 7220 6b2c 2076 2069 6e20 6b77 6172 6773  r k, v in kwargs
+000435a0: 5f64 6566 5f73 7572 6661 6365 2e69 7465  _def_surface.ite
+000435b0: 6d73 2829 3a0d 0a20 2020 2020 2020 2020  ms():..         
+000435c0: 2020 2069 6620 6b20 6e6f 7420 696e 2064     if k not in d
+000435d0: 6963 5f73 7572 662e 6b65 7973 2829 3a0d  ic_surf.keys():.
+000435e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000435f0: 2064 6963 5f73 7572 665b 6b5d 3d76 0d0a   dic_surf[k]=v..
+00043600: 0d0a 2020 2020 2020 2020 7365 6c66 2e6e  ..        self.n
+00043610: 616d 653d 6e61 6d65 0d0a 2020 2020 2020  ame=name..      
+00043620: 2020 7365 6c66 2e78 3d5b 5d0d 0a20 2020    self.x=[]..   
+00043630: 2020 2020 2073 656c 662e 793d 5b5d 0d0a       self.y=[]..
+00043640: 2020 2020 2020 2020 7365 6c66 2e7a 3d5b          self.z=[
+00043650: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+00043660: 696e 6571 3d5b 5d0d 0a20 2020 2020 2020  ineq=[]..       
+00043670: 2073 656c 662e 696e 745f 6d65 7468 6f64   self.int_method
+00043680: 3d64 6963 5f73 7572 665b 2269 6e74 5f6d  =dic_surf["int_m
+00043690: 6574 686f 6422 5d0d 0a20 2020 2020 2020  ethod"]..       
+000436a0: 2073 656c 662e 4e5f 7472 616e 7366 6f3d   self.N_transfo=
+000436b0: 6469 635f 7375 7266 5b22 4e5f 7472 616e  dic_surf["N_tran
+000436c0: 7366 6f22 5d0d 0a20 2020 2020 2020 2073  sfo"]..        s
+000436d0: 656c 662e 636f 766d 6f64 656c 3d64 6963  elf.covmodel=dic
+000436e0: 5f73 7572 665b 2263 6f76 6d6f 6465 6c22  _surf["covmodel"
+000436f0: 5d0d 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+00043700: 636f 6e74 6163 743d 636f 6e74 6163 740d  contact=contact.
+00043710: 0a0d 0a20 2020 2020 2020 2023 6368 6563  ...        #chec
+00043720: 6b20 696e 7075 7473 2066 6f72 2073 7572  k inputs for sur
+00043730: 6661 6365 206d 6574 686f 6473 0d0a 2020  face methods..  
+00043740: 2020 2020 2020 6966 2073 656c 662e 696e        if self.in
+00043750: 745f 6d65 7468 6f64 2069 6e20 5b22 6b72  t_method in ["kr
+00043760: 6967 696e 6722 2c20 2267 7266 222c 2022  iging", "grf", "
+00043770: 6772 665f 696e 6571 225d 3a0d 0a20 2020  grf_ineq"]:..   
+00043780: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
+00043790: 745f 7375 7266 6163 655f 636f 766d 6f64  t_surface_covmod
+000437a0: 656c 2829 0d0a 0d0a 2020 2020 2020 2020  el()....        
+000437b0: 6966 2073 656c 662e 636f 766d 6f64 656c  if self.covmodel
+000437c0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+000437d0: 2073 656c 662e 4e5f 7472 616e 7366 6f20   self.N_transfo 
+000437e0: 616e 6420 7365 6c66 2e69 6e74 5f6d 6574  and self.int_met
+000437f0: 686f 6420 696e 205b 226b 7269 6769 6e67  hod in ["kriging
+00043800: 222c 2022 6772 6622 2c20 2267 7266 5f69  ", "grf", "grf_i
+00043810: 6e65 7122 5d3a 0d0a 2020 2020 2020 2020  neq"]:..        
+00043820: 2020 2020 6966 2073 656c 662e 6765 745f      if self.get_
+00043830: 7375 7266 6163 655f 636f 766d 6f64 656c  surface_covmodel
+00043840: 2829 2e73 696c 6c28 2920 213d 2031 3a0d  ().sill() != 1:.
+00043850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043860: 2070 7269 6e74 2822 556e 6974 207b 7d3a   print("Unit {}:
+00043870: 2021 2120 4e6f 726d 616c 2074 7261 6e73   !! Normal trans
+00043880: 666f 726d 6174 696f 6e20 6973 2061 7070  formation is app
+00043890: 6c69 6564 2062 7574 2074 6865 2076 6172  lied but the var
+000438a0: 6961 6e63 6520 6f66 2074 6865 2043 6f76  iance of the Cov
+000438b0: 6172 6961 6e63 6520 6d6f 6465 6c20 6973  ariance model is
+000438c0: 206e 6f74 2065 7175 616c 2074 6f20 3120   not equal to 1 
+000438d0: 2121 222e 666f 726d 6174 2873 656c 662e  !!".format(self.
+000438e0: 6e61 6d65 2929 0d0a 0d0a 2020 2020 2020  name))....      
+000438f0: 2020 7365 6c66 2e64 6963 5f73 7572 663d    self.dic_surf=
+00043900: 6469 635f 7375 7266 0d0a 0d0a 2020 2020  dic_surf....    
+00043910: 6465 6620 636f 7079 2873 656c 6629 3a0d  def copy(self):.
+00043920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00043930: 636f 7079 2e64 6565 7063 6f70 7928 7365  copy.deepcopy(se
+00043940: 6c66 290d 0a0d 0a20 2020 2064 6566 2073  lf)....    def s
+00043950: 6574 5f63 6f76 6d6f 6465 6c28 7365 6c66  et_covmodel(self
+00043960: 2c20 636f 766d 6f64 656c 2c20 7662 3d30  , covmodel, vb=0
+00043970: 293a 0d0a 0d0a 2020 2020 2020 2020 2222  ):....        ""
+00043980: 220d 0a20 2020 2020 2020 2063 6861 6e67  "..        chang
+00043990: 6520 6f72 2061 6464 2061 2063 6f76 6d6f  e or add a covmo
+000439a0: 6465 6c20 666f 7220 7375 7266 6163 6520  del for surface 
+000439b0: 696e 7465 7270 6f6c 6174 696f 6e20 6f66  interpolation of
+000439c0: 2073 656c 6620 756e 6974 2e0d 0a0d 0a20   self unit..... 
+000439d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000439e0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000439f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
+00043a00: 6f76 6d6f 6465 6c20 3a20 6765 6f6e 652e  ovmodel : geone.
+00043a10: 636f 764d 6f64 656c 2e43 6f76 4d6f 6465  covModel.CovMode
+00043a20: 6c32 440d 0a20 2020 2020 2020 2020 2020  l2D..           
+00043a30: 2063 6f76 6172 6961 6e63 6520 6d6f 6465   covariance mode
+00043a40: 6c20 746f 2062 6520 7573 6564 2066 6f72  l to be used for
+00043a50: 2073 7572 6661 6365 2069 6e74 6572 706f   surface interpo
+00043a60: 6c61 7469 6f6e 0d0a 2020 2020 2020 2020  lation..        
+00043a70: 2020 2020 6966 2074 6865 2063 686f 7365      if the chose
+00043a80: 6e20 6d65 7468 6f64 2069 7320 6772 662c  n method is grf,
+00043a90: 2067 7266 2069 6e65 7120 6f72 206b 7269   grf ineq or kri
+00043aa0: 6769 6e67 0d0a 2020 2020 2020 2020 2222  ging..        ""
+00043ab0: 220d 0a0d 0a20 2020 2020 2020 2069 6620  "....        if 
+00043ac0: 6973 696e 7374 616e 6365 2863 6f76 6d6f  isinstance(covmo
+00043ad0: 6465 6c2c 2067 656f 6e65 2e63 6f76 4d6f  del, geone.covMo
+00043ae0: 6465 6c2e 436f 764d 6f64 656c 3244 293a  del.CovModel2D):
+00043af0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00043b00: 6c66 2e63 6f76 6d6f 6465 6c3d 636f 766d  lf.covmodel=covm
+00043b10: 6f64 656c 0d0a 2020 2020 2020 2020 2020  odel..          
+00043b20: 2020 7365 6c66 2e64 6963 5f73 7572 665b    self.dic_surf[
+00043b30: 2263 6f76 6d6f 6465 6c22 5d3d 636f 766d  "covmodel"]=covm
+00043b40: 6f64 656c 0d0a 2020 2020 2020 2020 2020  odel..          
+00043b50: 2020 6966 2076 623a 0d0a 2020 2020 2020    if vb:..      
+00043b60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00043b70: 2253 7572 6661 6365 207b 7d3a 2063 6f76  "Surface {}: cov
+00043b80: 6d6f 6465 6c20 6164 6465 6422 2e66 6f72  model added".for
+00043b90: 6d61 7428 7365 6c66 2e6e 616d 6529 290d  mat(self.name)).
+00043ba0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00043bb0: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00043bc0: 623a 0d0a 2020 2020 2020 2020 2020 2020  b:..            
+00043bd0: 2020 2020 7072 696e 7428 2253 7572 6661      print("Surfa
+00043be0: 6365 207b 7d3a 2063 6f76 6d6f 6465 6c20  ce {}: covmodel 
+00043bf0: 6e6f 7420 6120 6765 6f6e 6520 3244 2063  not a geone 2D c
+00043c00: 6f76 6d6f 6465 6c22 2e66 6f72 6d61 7428  ovmodel".format(
+00043c10: 7365 6c66 2e6e 616d 6529 290d 0a0d 0a20  self.name)).... 
+00043c20: 2020 2064 6566 2067 6574 5f73 7572 6661     def get_surfa
+00043c30: 6365 5f63 6f76 6d6f 6465 6c28 7365 6c66  ce_covmodel(self
+00043c40: 2c20 7662 3d31 293a 0d0a 2020 2020 2020  , vb=1):..      
+00043c50: 2020 6966 2073 656c 662e 636f 766d 6f64    if self.covmod
+00043c60: 656c 2069 7320 4e6f 6e65 3a0d 0a20 2020  el is None:..   
+00043c70: 2020 2020 2020 2020 2069 6620 7662 3a0d           if vb:.
+00043c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043c90: 2070 7269 6e74 2028 2257 6172 6e69 6e67   print ("Warning
+00043ca0: 3a20 556e 6974 2027 7b7d 2720 6861 7665  : Unit '{}' have
+00043cb0: 206e 6f20 436f 766d 6f64 656c 2066 6f72   no Covmodel for
+00043cc0: 2073 7572 6661 6365 2069 6e74 6572 706f   surface interpo
+00043cd0: 6c61 7469 6f6e 222e 666f 726d 6174 2873  lation".format(s
+00043ce0: 656c 662e 6e61 6d65 2929 0d0a 2020 2020  elf.name))..    
+00043cf0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00043d00: 6f6e 650d 0a20 2020 2020 2020 2065 6c73  one..        els
+00043d10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00043d20: 7265 7475 726e 2073 656c 662e 636f 766d  return self.covm
+00043d30: 6f64 656c 0d0a 2020 2020 0d0a 2020 2020  odel..    ..    
+00043d40: 6465 6620 7365 745f 636f 6e74 6163 7428  def set_contact(
+00043d50: 7365 6c66 2c20 636f 6e74 6163 7429 3a0d  self, contact):.
+00043d60: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00043d70: 636f 6e74 6163 7420 696e 205b 2265 726f  contact in ["ero
+00043d80: 6465 222c 2022 6f6e 6c61 7022 2c20 2263  de", "onlap", "c
+00043d90: 6f6d 6622 5d2c 2022 636f 6e74 6163 7420  omf"], "contact 
+00043da0: 6d75 7374 2062 6520 6572 6f64 6520 6f72  must be erode or
+00043db0: 206f 6e6c 6170 206f 7220 636f 6d66 220d   onlap or comf".
+00043dc0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+00043dd0: 6e74 6163 743d 636f 6e74 6163 740d 0a20  ntact=contact.. 
+00043de0: 2020 2020 2020 2073 656c 662e 6268 735f         self.bhs_
+00043df0: 7072 6f63 6573 7365 643d 300d 0a0d 0a20  processed=0.... 
+00043e00: 2020 2064 6566 2073 6574 5f64 6963 5f73     def set_dic_s
+00043e10: 7572 6628 7365 6c66 2c20 6469 635f 7375  urf(self, dic_su
+00043e20: 7266 293a 0d0a 2020 2020 2020 2020 7365  rf):..        se
+00043e30: 6c66 2e64 6963 5f73 7572 663d 6469 635f  lf.dic_surf=dic_
+00043e40: 7375 7266 0d0a 0d0a 636c 6173 7320 4661  surf....class Fa
+00043e50: 6369 6573 2829 3a0d 0a0d 0a20 2020 2022  cies():....    "
+00043e60: 2222 0d0a 2020 2020 636c 6173 7320 666f  ""..    class fo
+00043e70: 7220 6661 6369 6573 2028 326e 6420 6c65  r facies (2nd le
+00043e80: 7665 6c20 6f66 2068 6965 7261 7263 6879  vel of hierarchy
+00043e90: 290d 0a0d 0a20 2020 2050 6172 616d 6574  )....    Paramet
+00043ea0: 6572 730d 0a20 2020 202d 2d2d 2d2d 2d2d  ers..    -------
+00043eb0: 2d2d 2d0d 0a20 2020 2049 4420 3a20 696e  ---..    ID : in
+00043ec0: 740d 0a20 2020 2020 2020 2066 6163 6965  t..        facie
+00043ed0: 7320 4944 2074 6861 7420 6973 2075 7365  s ID that is use
+00043ee0: 6420 696e 2074 6865 2072 6573 756c 7473  d in the results
+00043ef0: 0d0a 2020 2020 6e61 6d65 203a 2073 7472  ..    name : str
+00043f00: 696e 670d 0a20 2020 2020 2020 2066 6163  ing..        fac
+00043f10: 6965 7320 6e61 6d65 2c20 7573 6564 2061  ies name, used a
+00043f20: 7320 616e 2069 6465 6e74 6966 6965 720d  s an identifier.
+00043f30: 0a20 2020 2063 6f6c 6f72 203a 2073 7472  .    color : str
+00043f40: 696e 670d 0a20 2020 2020 2020 2063 6f6c  ing..        col
+00043f50: 6f72 206f 6620 7468 6520 6661 6369 6573  or of the facies
+00043f60: 2c20 7573 6564 2066 6f72 2070 6c6f 7474  , used for plott
+00043f70: 696e 670d 0a20 2020 2022 2222 0d0a 0d0a  ing..    """....
+00043f80: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00043f90: 2873 656c 662c 2049 442c 206e 616d 652c  (self, ID, name,
+00043fa0: 2063 6f6c 6f72 293a 0d0a 0d0a 2020 2020   color):....    
+00043fb0: 2020 2020 7365 6c66 2e78 3d5b 5d0d 0a20      self.x=[].. 
+00043fc0: 2020 2020 2020 2073 656c 662e 793d 5b5d         self.y=[]
+00043fd0: 0d0a 2020 2020 2020 2020 7365 6c66 2e7a  ..        self.z
+00043fe0: 3d5b 5d0d 0a20 2020 2020 2020 2069 6620  =[]..        if 
+00043ff0: 4944 2021 3d20 303a 0d0a 2020 2020 2020  ID != 0:..      
+00044000: 2020 2020 2020 7365 6c66 2e49 443d 4944        self.ID=ID
+00044010: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00044020: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00044030: 7365 2056 616c 7565 4572 726f 7228 2249  se ValueError("I
+00044040: 4420 6661 6369 6573 2063 616e 6e6f 7420  D facies cannot 
+00044050: 6265 2065 7175 616c 2074 6f20 3022 290d  be equal to 0").
+00044060: 0a20 2020 2020 2020 2073 656c 662e 6e61  .        self.na
+00044070: 6d65 3d6e 616d 650d 0a20 2020 2020 2020  me=name..       
+00044080: 2073 656c 662e 633d 636f 6c6f 720d 0a0d   self.c=color...
+00044090: 0a20 2020 2064 6566 205f 5f65 715f 5f28  .    def __eq__(
+000440a0: 7365 6c66 2c20 6f74 6865 7229 3a0d 0a20  self, other):.. 
+000440b0: 2020 2020 2020 2069 6620 2873 656c 662e         if (self.
+000440c0: 6e61 6d65 203d 3d20 6f74 6865 722e 6e61  name == other.na
+000440d0: 6d65 2920 2620 2873 656c 662e 4944 203d  me) & (self.ID =
+000440e0: 3d20 6f74 6865 722e 4944 293a 0d0a 2020  = other.ID):..  
+000440f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00044100: 2054 7275 650d 0a20 2020 2020 2020 2065   True..        e
+00044110: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00044120: 2020 7265 7475 726e 2046 616c 7365 0d0a    return False..
+00044130: 0d0a 2020 2020 6465 6620 5f5f 7374 725f  ..    def __str_
+00044140: 5f28 7365 6c66 293a 0d0a 2020 2020 2020  _(self):..      
+00044150: 2020 7265 7475 726e 2073 656c 662e 6e61    return self.na
+00044160: 6d65 0d0a 0d0a 2020 2020 6465 6620 5f5f  me....    def __
+00044170: 7265 7072 5f5f 2873 656c 6629 3a0d 0a20  repr__(self):.. 
+00044180: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00044190: 6c66 2e6e 616d 650d 0a0d 0a63 6c61 7373  lf.name....class
+000441a0: 2050 726f 7028 293a 0d0a 0d0a 2020 2020   Prop():....    
+000441b0: 2222 220d 0a20 2020 2043 6c61 7373 2066  """..    Class f
+000441c0: 6f72 2064 6566 696e 696e 6720 6120 7072  or defining a pr
+000441d0: 6f70 7269 6574 7920 746f 2073 696d 756c  opriety to simul
+000441e0: 6174 6520 2833 7264 206c 6576 656c 290d  ate (3rd level).
+000441f0: 0a0d 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00044200: 730d 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  s..    ---------
+00044210: 2d0d 0a20 2020 206e 616d 6520 3a20 7374  -..    name : st
+00044220: 7269 6e67 0d0a 2020 2020 2020 2020 5072  ring..        Pr
+00044230: 6f70 6572 7479 206e 616d 650d 0a20 2020  operty name..   
+00044240: 2066 6163 6965 7320 3a20 6c69 7374 206f   facies : list o
+00044250: 6620 3a63 6c61 7373 3a60 4661 6369 6573  f :class:`Facies
+00044260: 6020 6f62 6a65 6374 730d 0a20 2020 2020  ` objects..     
+00044270: 2020 2066 6163 6965 7320 696e 2077 6869     facies in whi
+00044280: 6368 2077 6520 7761 6e74 2074 6f20 7369  ch we want to si
+00044290: 6d75 6c61 7465 2074 6865 2070 726f 7065  mulate the prope
+000442a0: 7274 790d 0a20 2020 2020 2020 2028 696e  rty..        (in
+000442b0: 2074 6865 206f 7468 6572 7320 7468 6520   the others the 
+000442c0: 7072 6f70 7269 6574 7920 7769 6c6c 2062  propriety will b
+000442d0: 6520 7365 7420 686f 6d6f 6765 6e6f 7573  e set homogenous
+000442e0: 2077 6974 6820 6120 6465 6661 756c 7420   with a default 
+000442f0: 7661 6c75 6529 0d0a 2020 2020 636f 766d  value)..    covm
+00044300: 6f64 656c 7320 3a20 6c69 7374 206f 6620  odels : list of 
+00044310: 3a63 6c61 7373 3a60 6765 6f6e 652e 636f  :class:`geone.co
+00044320: 764d 6f64 656c 2e43 6f76 4d6f 6465 6c32  vModel.CovModel2
+00044330: 4460 206f 626a 6563 7473 0d0a 2020 2020  D` objects..    
+00044340: 2020 2020 636f 766d 6f64 656c 7320 666f      covmodels fo
+00044350: 7220 7468 6520 7369 6d75 6c61 7469 6f6e  r the simulation
+00044360: 2028 7361 6d65 2073 697a 6520 6f66 2066   (same size of f
+00044370: 6163 6965 7320 6f72 206f 6e6c 7920 3129  acies or only 1)
+00044380: 0d0a 2020 2020 6d65 616e 7320 3a20 6c69  ..    means : li
+00044390: 7374 206f 6620 666c 6f61 7473 0d0a 2020  st of floats..  
+000443a0: 2020 2020 2020 6d65 616e 206f 6620 7468        mean of th
+000443b0: 6520 7072 6f70 6572 7479 2069 6e20 6561  e property in ea
+000443c0: 6368 2066 6163 6965 7320 2873 616d 6520  ch facies (same 
+000443d0: 7369 7a65 206f 6620 6661 6369 6573 290d  size of facies).
+000443e0: 0a20 2020 2069 6e74 5f6d 6574 686f 6420  .    int_method 
+000443f0: 3a20 7374 7269 6e67 0d0a 2020 2020 2020  : string..      
+00044400: 2020 6d65 7468 6f64 206f 6620 696e 7465    method of inte
+00044410: 7270 6f6c 6174 696f 6e2c 2070 6f73 7369  rpolation, possi
+00044420: 626c 6520 6d65 7468 6f64 7320 6172 653a  ble methods are:
+00044430: 0d0a 2020 2020 2020 2020 2d20 7367 732c  ..        - sgs,
+00044440: 2064 6566 6175 6c74 0d0a 2020 2020 2020   default..      
+00044450: 2020 2d20 6666 740d 0a20 2020 2020 2020    - fft..       
+00044460: 202d 2068 6f6d 6f67 656e 6f75 730d 0a20   - homogenous.. 
+00044470: 2020 2064 6566 5f6d 6561 6e20 3a20 666c     def_mean : fl
+00044480: 6f61 740d 0a20 2020 2020 2020 2064 6566  oat..        def
+00044490: 6175 6c74 206d 6561 6e20 746f 2075 7365  ault mean to use
+000444a0: 6420 6966 206e 6f6e 6520 6973 2070 6173  d if none is pas
+000444b0: 7365 6420 696e 206d 6561 6e73 2061 7272  sed in means arr
+000444c0: 6179 0d0a 2020 2020 766d 696e 2c20 766d  ay..    vmin, vm
+000444d0: 6178 203a 2066 6c6f 6174 0d0a 2020 2020  ax : float..    
+000444e0: 2020 2020 6d69 6e20 7265 7370 2e20 6d61      min resp. ma
+000444f0: 7820 7661 6c75 6520 6f66 2074 6865 2070  x value of the p
+00044500: 726f 7065 7274 790d 0a20 2020 2078 203a  roperty..    x :
+00044510: 206e 6461 7272 6179 206f 6620 7369 7a65   ndarray of size
+00044520: 2028 6e2c 2032 202d 2d3e 2078 2c20 7929   (n, 2 --> x, y)
+00044530: 0d0a 2020 2020 2020 2020 706f 7369 7469  ..        positi
+00044540: 6f6e 206f 6620 6861 7264 2064 6174 6120  on of hard data 
+00044550: 0d0a 2020 2020 7620 3a20 6e64 6172 7261  ..    v : ndarra
+00044560: 7920 6f66 2073 697a 6520 286e 2c20 3120  y of size (n, 1 
+00044570: 2d2d 3e20 7661 6c75 6529 0d0a 2020 2020  --> value)..    
+00044580: 2020 2020 7661 6c75 6520 6f66 2068 6172      value of har
+00044590: 6420 6461 7461 0d0a 2020 2020 2222 220d  d data..    """.
+000445a0: 0a0d 0a20 2020 2064 6566 205f 5f69 6e69  ...    def __ini
+000445b0: 745f 5f28 7365 6c66 2c20 6e61 6d65 2c20  t__(self, name, 
+000445c0: 6661 6369 6573 2c20 636f 766d 6f64 656c  facies, covmodel
+000445d0: 732c 206d 6561 6e73 2c20 696e 745f 6d65  s, means, int_me
+000445e0: 7468 6f64 3d22 7367 7322 2c20 783d 4e6f  thod="sgs", x=No
+000445f0: 6e65 2c20 763d 204e 6f6e 652c 2064 6566  ne, v= None, def
+00044600: 5f6d 6561 6e3d 312c 2076 6d69 6e3d 4e6f  _mean=1, vmin=No
+00044610: 6e65 2c20 766d 6178 3d4e 6f6e 6529 3a0d  ne, vmax=None):.
+00044620: 0a0d 0a0d 0a20 2020 2020 2020 2061 7373  .....        ass
+00044630: 6572 7420 6973 696e 7374 616e 6365 2866  ert isinstance(f
+00044640: 6163 6965 732c 206c 6973 7429 2c20 2246  acies, list), "F
+00044650: 6163 6965 7320 6d75 7374 2062 6520 6120  acies must be a 
+00044660: 6c69 7374 206f 6620 6661 6369 6573 2c20  list of facies, 
+00044670: 6576 656e 2074 6865 7265 2069 7320 6f6e  even there is on
+00044680: 6c79 206f 6e65 220d 0a20 2020 2020 2020  ly one"..       
+00044690: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
+000446a0: 6365 2876 6d69 6e2c 2066 6c6f 6174 2920  ce(vmin, float) 
+000446b0: 6f72 2069 7369 6e73 7461 6e63 6528 766d  or isinstance(vm
+000446c0: 696e 2c20 696e 7429 206f 7220 766d 696e  in, int) or vmin
+000446d0: 2069 7320 4e6f 6e65 2c20 2256 6d69 6e20   is None, "Vmin 
+000446e0: 6572 726f 7222 0d0a 2020 2020 2020 2020  error"..        
+000446f0: 6173 7365 7274 2069 7369 6e73 7461 6e63  assert isinstanc
+00044700: 6528 766d 6178 2c20 666c 6f61 7429 206f  e(vmax, float) o
+00044710: 7220 6973 696e 7374 616e 6365 2876 6d61  r isinstance(vma
+00044720: 782c 2069 6e74 2920 6f72 2076 6d61 7820  x, int) or vmax 
+00044730: 6973 204e 6f6e 652c 2022 566d 6178 2065  is None, "Vmax e
+00044740: 7272 6f72 220d 0a0d 0a20 2020 2020 2020  rror"....       
+00044750: 2073 656c 662e 6e61 6d65 3d6e 616d 650d   self.name=name.
+00044760: 0a20 2020 2020 2020 2073 656c 662e 6661  .        self.fa
+00044770: 6369 6573 3d66 6163 6965 730d 0a20 2020  cies=facies..   
+00044780: 2020 2020 206e 5f66 6163 6965 733d 6c65       n_facies=le
+00044790: 6e28 6661 6369 6573 290d 0a20 2020 2020  n(facies)..     
+000447a0: 2020 2073 656c 662e 6e5f 6661 6369 6573     self.n_facies
+000447b0: 3d6e 5f66 6163 6965 730d 0a0d 0a20 2020  =n_facies....   
+000447c0: 2020 2020 2073 656c 662e 766d 696e 3d76       self.vmin=v
+000447d0: 6d69 6e0d 0a20 2020 2020 2020 2073 656c  min..        sel
+000447e0: 662e 766d 6178 3d76 6d61 780d 0a20 2020  f.vmax=vmax..   
+000447f0: 2020 2020 2073 656c 662e 783d 780d 0a20       self.x=x.. 
+00044800: 2020 2020 2020 2073 656c 662e 763d 760d         self.v=v.
+00044810: 0a0d 0a20 2020 2020 2020 2023 636f 766d  ...        #covm
+00044820: 6f64 656c 730d 0a20 2020 2020 2020 2074  odels..        t
+00044830: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00044840: 2066 6f72 2063 6d20 696e 2063 6f76 6d6f   for cm in covmo
+00044850: 6465 6c73 3a0d 0a20 2020 2020 2020 2020  dels:..         
+00044860: 2020 2020 2020 2070 6173 730d 0a20 2020         pass..   
+00044870: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
+00044880: 766d 6f64 656c 733d 636f 766d 6f64 656c  vmodels=covmodel
+00044890: 730d 0a20 2020 2020 2020 2065 7863 6570  s..        excep
+000448a0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+000448b0: 6966 2069 7369 6e73 7461 6e63 6528 636f  if isinstance(co
+000448c0: 766d 6f64 656c 732c 2067 636d 2e43 6f76  vmodels, gcm.Cov
+000448d0: 4d6f 6465 6c33 4429 3a0d 0a20 2020 2020  Model3D):..     
+000448e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000448f0: 636f 766d 6f64 656c 733d 5b63 6f76 6d6f  covmodels=[covmo
+00044900: 6465 6c73 5d2a 6e5f 6661 6369 6573 0d0a  dels]*n_facies..
+00044910: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00044920: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00044930: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00044940: 726f 7228 227b 7d20 6973 206e 6f74 2061  ror("{} is not a
+00044950: 2076 616c 6964 2043 6f76 4d6f 6465 6c33   valid CovModel3
+00044960: 4422 2e66 6f72 6d61 7428 636d 2929 0d0a  D".format(cm))..
+00044970: 0d0a 2020 2020 2020 2020 236d 6561 6e73  ..        #means
+00044980: 0d0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
+00044990: 6561 6e73 3d6d 6561 6e73 0d0a 2020 2020  eans=means..    
+000449a0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+000449b0: 2020 2020 2020 666f 7220 6d20 696e 206d        for m in m
+000449c0: 6561 6e73 3a0d 0a20 2020 2020 2020 2020  eans:..         
+000449d0: 2020 2020 2020 2070 6173 730d 0a20 2020         pass..   
+000449e0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+000449f0: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
+00044a00: 6561 6e73 3d5b 6d65 616e 735d 2a6e 5f66  eans=[means]*n_f
+00044a10: 6163 6965 730d 0a0d 0a20 2020 2020 2020  acies....       
+00044a20: 2023 696e 7465 7270 6f6c 6174 696f 6e20   #interpolation 
+00044a30: 6d65 7468 6f64 730d 0a20 2020 2020 2020  methods..       
+00044a40: 2073 656c 662e 696e 743d 696e 745f 6d65   self.int=int_me
+00044a50: 7468 6f64 0d0a 2020 2020 2020 2020 7472  thod..        tr
+00044a60: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00044a70: 666f 7220 695f 6d65 7468 6f64 2069 6e20  for i_method in 
+00044a80: 696e 745f 6d65 7468 6f64 3a0d 0a20 2020  int_method:..   
+00044a90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00044aa0: 695f 6d65 7468 6f64 2069 6e20 2822 7367  i_method in ("sg
+00044ab0: 7322 2c20 2266 6674 222c 2022 686f 6d6f  s", "fft", "homo
+00044ac0: 6765 6e6f 7573 222c 2022 6d70 7322 2c20  genous", "mps", 
+00044ad0: 2268 6f6d 6f67 656e 6f75 735f 756e 6966  "homogenous_unif
+00044ae0: 6f72 6d22 293a 0d0a 2020 2020 2020 2020  orm"):..        
+00044af0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00044b00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00044b10: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00044b20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00044b30: 7365 2056 616c 7565 4572 726f 7228 227b  se ValueError("{
+00044b40: 7d20 6973 206e 6f74 2061 2076 616c 6964  } is not a valid
+00044b50: 2069 6e74 6570 726f 6c61 7469 6f6e 206d   inteprolation m
+00044b60: 6574 686f 6422 2e66 6f72 6d61 7428 695f  ethod".format(i_
+00044b70: 6d65 7468 6f64 2929 0d0a 2020 2020 2020  method))..      
+00044b80: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+00044b90: 2020 2020 2020 2069 6620 696e 745f 6d65         if int_me
+00044ba0: 7468 6f64 2069 6e20 2822 7367 7322 2c20  thod in ("sgs", 
+00044bb0: 2266 6674 222c 2022 686f 6d6f 6765 6e6f  "fft", "homogeno
+00044bc0: 7573 222c 2022 6d70 7322 2c22 686f 6d6f  us", "mps","homo
+00044bd0: 6765 6e6f 7573 5f75 6e69 666f 726d 2229  genous_uniform")
+00044be0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00044bf0: 2020 2073 656c 662e 696e 743d 5b69 6e74     self.int=[int
+00044c00: 5f6d 6574 686f 645d 2a6e 5f66 6163 6965  _method]*n_facie
+00044c10: 730d 0a20 2020 2020 2020 2020 2020 2065  s..            e
+00044c20: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00044c30: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00044c40: 6545 7272 6f72 2822 7b7d 2069 7320 6e6f  eError("{} is no
+00044c50: 7420 6120 7661 6c69 6420 696e 7465 7072  t a valid intepr
+00044c60: 6f6c 6174 696f 6e20 6d65 7468 6f64 222e  olation method".
+00044c70: 666f 726d 6174 2869 5f6d 6574 686f 6429  format(i_method)
+00044c80: 290d 0a0d 0a20 2020 2020 2020 2073 656c  )....        sel
+00044c90: 662e 6465 665f 6d65 616e 3d64 6566 5f6d  f.def_mean=def_m
+00044ca0: 6561 6e0d 0a0d 0a20 2020 2020 2020 2064  ean....        d
+00044cb0: 6566 205f 5f65 715f 5f28 7365 6c66 2c20  ef __eq__(self, 
+00044cc0: 6f74 6865 7229 3a0d 0a20 2020 2020 2020  other):..       
+00044cd0: 2020 2020 2069 6620 2873 656c 662e 6e61       if (self.na
+00044ce0: 6d65 203d 3d20 6f74 6865 722e 6e61 6d65  me == other.name
+00044cf0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00044d00: 2020 2020 7265 7475 726e 2054 7275 650d      return True.
+00044d10: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00044d20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00044d30: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+00044d40: 0d0a 0d0a 2020 2020 2020 2020 6465 6620  ....        def 
+00044d50: 5f5f 7265 7072 5f5f 2873 656c 6629 3a0d  __repr__(self):.
+00044d60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00044d70: 7572 6e20 7365 6c66 2e6e 616d 650d 0a0d  urn self.name...
+00044d80: 0a0d 0a20 2020 2064 6566 2061 6464 5f68  ...    def add_h
+00044d90: 6428 7365 6c66 2c20 782c 7629 3a0d 0a0d  d(self, x,v):...
+00044da0: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00044db0: 2020 2020 2020 6164 6420 6861 7264 2064        add hard d
+00044dc0: 6174 6120 746f 2074 6865 2070 726f 7065  ata to the prope
+00044dd0: 7274 790d 0a0d 0a20 2020 2020 2020 2050  rty....        P
+00044de0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00044df0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00044e00: 2020 2020 2020 2078 203a 206e 6461 7272         x : ndarr
+00044e10: 6179 206f 6620 7369 7a65 2028 6e2c 2032  ay of size (n, 2
+00044e20: 202d 2d3e 2078 2c20 7929 0d0a 2020 2020   --> x, y)..    
+00044e30: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00044e40: 206f 6620 6861 7264 2064 6174 610d 0a20   of hard data.. 
+00044e50: 2020 2020 2020 2076 203a 206e 6461 7272         v : ndarr
+00044e60: 6179 206f 6620 7369 7a65 2028 6e2c 2031  ay of size (n, 1
+00044e70: 202d 2d3e 2076 616c 7565 290d 0a20 2020   --> value)..   
+00044e80: 2020 2020 2020 2020 2076 616c 7565 206f           value o
+00044e90: 6620 6861 7264 2064 6174 610d 0a20 2020  f hard data..   
+00044ea0: 2020 2020 2022 2222 0d0a 0d0a 2020 2020       """....    
+00044eb0: 2020 2020 6173 7365 7274 2078 2e73 6861      assert x.sha
+00044ec0: 7065 5b31 5d20 3d3d 2033 2c20 2269 6e76  pe[1] == 3, "inv
+00044ed0: 616c 6964 2073 6861 7065 2066 6f72 2068  alid shape for h
+00044ee0: 6420 706f 7369 7469 6f6e 2028 7829 2c20  d position (x), 
+00044ef0: 6d75 7374 2062 6520 286e 6461 7461 2c20  must be (ndata, 
+00044f00: 3329 220d 0a20 2020 2020 2020 2061 7373  3)"..        ass
+00044f10: 6572 7420 762e 7368 6170 655b 305d 203d  ert v.shape[0] =
+00044f20: 3d20 782e 7368 6170 655b 305d 2c20 2269  = x.shape[0], "i
+00044f30: 6e76 616c 6964 206e 756d 6265 7220 6f66  nvalid number of
+00044f40: 2064 6174 6120 706f 696e 7473 2062 6574   data points bet
+00044f50: 7765 656e 2076 2061 6e64 2078 220d 0a0d  ween v and x"...
+00044f60: 0a20 2020 2020 2020 2073 656c 662e 783d  .        self.x=
+00044f70: 780d 0a20 2020 2020 2020 2073 656c 662e  x..        self.
+00044f80: 763d 760d 0a0d 0a0d 0a63 6c61 7373 2062  v=v......class b
+00044f90: 6f72 6568 6f6c 6528 293a 0d0a 0d0a 2020  orehole():....  
+00044fa0: 2020 2222 220d 0a20 2020 2043 6c61 7373    """..    Class
+00044fb0: 2074 6f20 6372 6561 7465 2061 2062 6f72   to create a bor
+00044fc0: 6568 6f6c 6520 6f62 6a65 6374 2e20 0d0a  ehole object. ..
+00044fd0: 2020 2020 426f 7265 686f 6c65 2061 7265      Borehole are
+00044fe0: 2075 7365 6420 746f 2064 6566 696e 6520   used to define 
+00044ff0: 7468 6520 6c69 7468 6f6c 6f67 7920 616e  the lithology an
+00045000: 6420 6164 6420 636f 6e64 6974 696f 6e69  d add conditioni
+00045010: 6e67 2064 6174 6120 696e 746f 2041 7263  ng data into Arc
+00045020: 6850 7920 6d6f 6465 6c73 0d0a 0d0a 2020  hPy models....  
+00045030: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00045040: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00045050: 2020 6e61 6d65 203a 2073 7472 696e 670d    name : string.
+00045060: 0a20 2020 2020 2020 206e 616d 6520 6f66  .        name of
+00045070: 2074 6865 2062 6f72 6568 6f6c 652c 206e   the borehole, n
+00045080: 6f74 2075 7365 640d 0a20 2020 2049 4420  ot used..    ID 
+00045090: 3a20 696e 740d 0a20 2020 2020 2020 2049  : int..        I
+000450a0: 4420 6f66 2074 6865 2062 6f72 6568 6f6c  D of the borehol
+000450b0: 650d 0a20 2020 2078 2c20 792c 207a 203a  e..    x, y, z :
+000450c0: 2066 6c6f 6174 0d0a 2020 2020 2020 2020   float..        
+000450d0: 782c 2079 2c20 7a20 636f 6f72 6469 6e61  x, y, z coordina
+000450e0: 7465 7320 6f66 2074 6865 2074 6f70 206f  tes of the top o
+000450f0: 6620 7468 6520 626f 7265 686f 6c65 0d0a  f the borehole..
+00045100: 2020 2020 6465 7074 6820 3a20 666c 6f61      depth : floa
+00045110: 740d 0a20 2020 2020 2020 2064 6570 7468  t..        depth
+00045120: 206f 6620 7468 6520 626f 7265 686f 6c65   of the borehole
+00045130: 0d0a 2020 2020 6c6f 675f 7374 7261 7469  ..    log_strati
+00045140: 203a 206c 6973 7420 6f66 2074 7570 6c65   : list of tuple
+00045150: 730d 0a20 2020 2020 2020 206c 6f67 5f73  s..        log_s
+00045160: 7472 6174 6920 636f 6e74 6169 6e73 2074  trati contains t
+00045170: 6865 2067 656f 6c6f 6769 6361 6c20 696e  he geological in
+00045180: 666f 726d 6174 696f 6e20 6162 6f75 7420  formation about 
+00045190: 7468 6520 756e 6974 7320 696e 2074 6865  the units in the
+000451a0: 2062 6f72 6568 6f6c 650d 0a20 2020 2020   borehole..     
+000451b0: 2020 2069 6e66 6f72 6d61 7469 6f6e 2069     information i
+000451c0: 7320 6769 7665 6e20 6279 2069 6e74 6572  s given by inter
+000451d0: 7661 6c73 206f 6620 7468 6520 666f 726d  vals of the form
+000451e0: 2028 7374 7261 7469 2c20 746f 7029 2077   (strati, top) w
+000451f0: 6865 7265 2073 7472 6174 6920 6973 2061  here strati is a
+00045200: 203a 636c 6173 733a 6055 6e69 7460 206f   :class:`Unit` o
+00045210: 626a 6563 740d 0a20 2020 2020 2020 2061  bject..        a
+00045220: 6e64 2074 6f70 2069 7320 7468 6520 746f  nd top is the to
+00045230: 7020 616c 7469 7475 6465 206f 6620 756e  p altitude of un
+00045240: 6974 2069 6e74 6572 7661 6c0d 0a20 2020  it interval..   
+00045250: 206c 6f67 5f66 6163 6965 7320 3a20 6c69   log_facies : li
+00045260: 7374 206f 6620 7475 706c 6573 0d0a 2020  st of tuples..  
+00045270: 2020 2020 2020 6c6f 675f 6661 6369 6573        log_facies
+00045280: 2063 6f6e 7461 696e 7320 7468 6520 6661   contains the fa
+00045290: 6369 6573 2069 6e66 6f72 6d61 7469 6f6e  cies information
+000452a0: 2061 626f 7574 2074 6865 2062 6f72 6568   about the boreh
+000452b0: 6f6c 650d 0a20 2020 2020 2020 2069 6e66  ole..        inf
+000452c0: 6f72 6d61 7469 6f6e 2069 7320 6769 7665  ormation is give
+000452d0: 6e20 6279 2069 6e74 6572 7661 6c73 206f  n by intervals o
+000452e0: 6620 7468 6520 666f 726d 2028 6661 6369  f the form (faci
+000452f0: 6573 2c20 746f 7029 2077 6865 7265 2066  es, top) where f
+00045300: 6163 6965 7320 6973 2061 203a 636c 6173  acies is a :clas
+00045310: 733a 6046 6163 6965 7360 206f 626a 6563  s:`Facies` objec
+00045320: 740d 0a20 2020 2020 2020 2061 6e64 2074  t..        and t
+00045330: 6f70 2069 7320 7468 6520 746f 7020 616c  op is the top al
+00045340: 7469 7475 6465 206f 6620 6661 6369 6573  titude of facies
+00045350: 2069 6e74 6572 7661 6c0d 0a20 2020 2022   interval..    "
+00045360: 2222 0d0a 0d0a 2020 2020 6465 6620 5f5f  ""....    def __
+00045370: 696e 6974 5f5f 2873 656c 662c 206e 616d  init__(self, nam
+00045380: 652c 2049 442c 2078 2c20 792c 207a 2c20  e, ID, x, y, z, 
+00045390: 6465 7074 682c 206c 6f67 5f73 7472 6174  depth, log_strat
+000453a0: 692c 206c 6f67 5f66 6163 6965 733d 4e6f  i, log_facies=No
+000453b0: 6e65 293a 0d0a 0d0a 2020 2020 2020 2020  ne):....        
+000453c0: 7365 6c66 2e6e 616d 653d 6e61 6d65 2020  self.name=name  
+000453d0: 2320 6e61 6d65 206f 6620 6c69 7468 6f6c  # name of lithol
+000453e0: 6f67 790d 0a20 2020 2020 2020 2073 656c  ogy..        sel
+000453f0: 662e 4944 3d49 4420 2023 2049 4420 6f66  f.ID=ID  # ID of
+00045400: 2074 6865 2062 6f72 6568 6f6c 6573 0d0a   the boreholes..
+00045410: 2020 2020 2020 2020 7365 6c66 2e78 3d78          self.x=x
+00045420: 2020 2320 7820 636f 6f72 6469 6e61 7465    # x coordinate
+00045430: 206f 6620 626f 7265 686f 6c65 0d0a 2020   of borehole..  
+00045440: 2020 2020 2020 7365 6c66 2e79 3d79 2020        self.y=y  
+00045450: 2320 7920 636f 6f72 6469 6e61 7465 206f  # y coordinate o
+00045460: 6620 626f 7265 686f 6c65 0d0a 2020 2020  f borehole..    
+00045470: 2020 2020 7365 6c66 2e7a 3d7a 2020 2320      self.z=z  # 
+00045480: 616c 7469 7475 6465 206f 6620 7468 6520  altitude of the 
+00045490: 6268 2028 63c3 b474 6520 7465 7272 6169  bh (c..te terrai
+000454a0: 6e29 0d0a 2020 2020 2020 2020 7365 6c66  n)..        self
+000454b0: 2e64 6570 7468 3d64 6570 7468 0d0a 2020  .depth=depth..  
+000454c0: 2020 2020 2020 7365 6c66 2e6c 6f67 5f73        self.log_s
+000454d0: 7472 6174 693d 6c6f 675f 7374 7261 7469  trati=log_strati
+000454e0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000454f0: 6f67 5f66 6163 6965 733d 6c6f 675f 6661  og_facies=log_fa
+00045500: 6369 6573 0d0a 2020 2020 2020 2020 7365  cies..        se
+00045510: 6c66 2e6c 6f67 5f72 6177 203d 204e 6f6e  lf.log_raw = Non
+00045520: 650d 0a0d 0a20 2020 2020 2020 2069 6620  e....        if 
+00045530: 6c6f 675f 7374 7261 7469 2069 7320 6e6f  log_strati is no
+00045540: 7420 4e6f 6e65 3a0d 0a20 2020 2020 2020  t None:..       
+00045550: 2020 2020 2073 656c 662e 6c69 7374 5f73       self.list_s
+00045560: 7472 6174 6973 3d5b 7320 666f 7220 732c  tratis=[s for s,
+00045570: 2064 2069 6e20 7365 6c66 2e6c 6f67 5f73   d in self.log_s
+00045580: 7472 6174 695d 0d0a 2020 2020 2020 2020  trati]..        
+00045590: 2020 2020 6966 206c 656e 2873 656c 662e      if len(self.
+000455a0: 6c69 7374 5f73 7472 6174 6973 2920 3d3d  list_stratis) ==
+000455b0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+000455c0: 2020 2020 2073 656c 662e 6c6f 675f 7374       self.log_st
+000455d0: 7261 7469 3d4e 6f6e 650d 0a0d 0a20 2020  rati=None....   
+000455e0: 2020 2020 2069 6620 6c6f 675f 6661 6369       if log_faci
+000455f0: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0d  es is not None:.
+00045600: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00045610: 662e 6c69 7374 5f66 6163 6965 7320 3d5b  f.list_facies =[
+00045620: 7320 666f 7220 732c 2064 2069 6e20 7365  s for s, d in se
+00045630: 6c66 2e6c 6f67 5f66 6163 6965 735d 0d0a  lf.log_facies]..
+00045640: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00045650: 656e 2873 656c 662e 6c6f 675f 6661 6369  en(self.log_faci
+00045660: 6573 2920 3d3d 2030 3a0d 0a20 2020 2020  es) == 0:..     
+00045670: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00045680: 6c6f 675f 6661 6369 6573 3d4e 6f6e 650d  log_facies=None.
+00045690: 0a0d 0a0d 0a20 2020 2064 6566 2067 6574  .....    def get
+000456a0: 5f6c 6973 745f 7374 7261 7469 7328 7365  _list_stratis(se
+000456b0: 6c66 293a 0d0a 2020 2020 2020 2020 7365  lf):..        se
+000456c0: 6c66 2e6c 6973 745f 7374 7261 7469 733d  lf.list_stratis=
+000456d0: 5b73 2066 6f72 2073 2c20 6420 696e 2073  [s for s, d in s
+000456e0: 656c 662e 6c6f 675f 7374 7261 7469 5d0d  elf.log_strati].
+000456f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00045700: 7365 6c66 2e6c 6973 745f 7374 7261 7469  self.list_strati
+00045710: 730d 0a0d 0a20 2020 2064 6566 2067 6574  s....    def get
+00045720: 5f6c 6973 745f 6661 6369 6573 2873 656c  _list_facies(sel
+00045730: 6629 3a0d 0a20 2020 2020 2020 2073 656c  f):..        sel
+00045740: 662e 6c69 7374 5f66 6163 6965 7320 3d5b  f.list_facies =[
+00045750: 7320 666f 7220 732c 2064 2069 6e20 7365  s for s, d in se
+00045760: 6c66 2e6c 6f67 5f66 6163 6965 735d 0d0a  lf.log_facies]..
+00045770: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00045780: 656c 662e 6c69 7374 5f66 6163 6965 730d  elf.list_facies.
+00045790: 0a0d 0a20 2020 2064 6566 205f 5f65 715f  ...    def __eq_
+000457a0: 5f28 7365 6c66 2c20 6f74 6865 7229 3a0d  _(self, other):.
+000457b0: 0a20 2020 2020 2020 2069 6620 2028 7365  .        if  (se
+000457c0: 6c66 2e49 4420 3d3d 206f 7468 6572 2e49  lf.ID == other.I
+000457d0: 4429 2026 205c 0d0a 2020 2020 2020 2020  D) & \..        
+000457e0: 2873 656c 662e 7820 3d3d 206f 7468 6572  (self.x == other
+000457f0: 2e78 2920 2620 2873 656c 662e 7920 3d3d  .x) & (self.y ==
+00045800: 206f 7468 6572 2e79 2920 2620 2873 656c   other.y) & (sel
+00045810: 662e 7a20 3d3d 206f 7468 6572 2e7a 293a  f.z == other.z):
+00045820: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00045830: 7475 726e 2054 7275 650d 0a20 2020 2020  turn True..     
+00045840: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00045850: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+00045860: 7365 0d0a 0d0a 2020 2020 6465 6620 7365  se....    def se
+00045870: 745f 6c6f 675f 7374 7261 7469 2873 656c  t_log_strati(sel
+00045880: 662c 206c 6f67 5f73 7472 6174 6929 3a0d  f, log_strati):.
+00045890: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+000458a0: 675f 7374 7261 7469 3d6c 6f67 5f73 7472  g_strati=log_str
+000458b0: 6174 690d 0a0d 0a20 2020 2064 6566 2073  ati....    def s
+000458c0: 6574 5f6c 6f67 5f66 6163 6965 7328 7365  et_log_facies(se
+000458d0: 6c66 2c20 6c6f 675f 6661 6369 6573 293a  lf, log_facies):
+000458e0: 0d0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000458f0: 6f67 5f66 6163 6965 733d 6c6f 675f 6661  og_facies=log_fa
+00045900: 6369 6573 0d0a 0d0a 2020 2020 6465 6620  cies....    def 
+00045910: 7072 6f70 5f75 6e69 7473 2873 656c 6629  prop_units(self)
+00045920: 3a0d 0a0d 0a20 2020 2020 2020 2022 2222  :....        """
+00045930: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00045940: 2061 2064 6963 7469 6f6e 6e61 7279 206f   a dictionnary o
+00045950: 6620 7468 6520 7072 6f70 6f72 7469 6f6e  f the proportion
+00045960: 206f 6620 7468 6520 756e 6974 7320 696e   of the units in
+00045970: 2074 6865 2062 6f72 6568 6f6c 650d 0a20   the borehole.. 
+00045980: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00045990: 2020 2020 2020 6420 3d20 7b7d 0d0a 0d0a        d = {}....
+000459a0: 2020 2020 2020 2020 616c 745f 7072 6576          alt_prev
+000459b0: 203d 2073 656c 662e 7a0d 0a20 2020 2020   = self.z..     
+000459c0: 2020 2075 6e69 745f 7072 6576 203d 204e     unit_prev = N
+000459d0: 6f6e 650d 0a20 2020 2020 2020 2066 6f72  one..        for
+000459e0: 2073 2069 6e20 7365 6c66 2e6c 6f67 5f73   s in self.log_s
+000459f0: 7472 6174 693a 0d0a 2020 2020 2020 2020  trati:..        
+00045a00: 2020 2020 6966 2073 5b30 5d20 6973 206e      if s[0] is n
+00045a10: 6f74 204e 6f6e 653a 0d0a 2020 2020 2020  ot None:..      
+00045a20: 2020 2020 2020 2020 2020 6966 2073 5b30            if s[0
+00045a30: 5d2e 6e61 6d65 206e 6f74 2069 6e20 642e  ].name not in d.
+00045a40: 6b65 7973 2829 3a0d 0a20 2020 2020 2020  keys():..       
+00045a50: 2020 2020 2020 2020 2020 2020 2064 5b73               d[s
+00045a60: 5b30 5d2e 6e61 6d65 5d20 3d20 300d 0a20  [0].name] = 0.. 
+00045a70: 2020 2020 2020 2020 2020 2020 2020 200d                 .
+00045a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045a90: 2069 6620 756e 6974 5f70 7265 7620 6973   if unit_prev is
+00045aa0: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00045ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045ac0: 7468 6b20 3d20 756e 6974 5f70 7265 765b  thk = unit_prev[
+00045ad0: 315d 202d 2073 5b31 5d0d 0a20 2020 2020  1] - s[1]..     
+00045ae0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00045af0: 5b75 6e69 745f 7072 6576 5b30 5d2e 6e61  [unit_prev[0].na
+00045b00: 6d65 5d20 2b3d 2074 686b 0d0a 2020 2020  me] += thk..    
+00045b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00045b30: 2020 756e 6974 5f70 7265 7620 3d20 730d    unit_prev = s.
+00045b40: 0a20 2020 2020 2020 2074 686b 203d 2075  .        thk = u
+00045b50: 6e69 745f 7072 6576 5b31 5d20 2d20 2873  nit_prev[1] - (s
+00045b60: 656c 662e 7a20 2d20 7365 6c66 2e64 6570  elf.z - self.dep
+00045b70: 7468 290d 0a20 2020 2020 2020 2064 5b75  th)..        d[u
+00045b80: 6e69 745f 7072 6576 5b30 5d2e 6e61 6d65  nit_prev[0].name
+00045b90: 5d20 2b3d 2074 686b 200d 0a0d 0a20 2020  ] += thk ....   
+00045ba0: 2020 2020 2066 6f72 206b 2c76 2069 6e20       for k,v in 
+00045bb0: 642e 6974 656d 7328 293a 2020 2320 6d65  d.items():  # me
+00045bc0: 616e 0d0a 2020 2020 2020 2020 2020 2020  an..            
+00045bd0: 645b 6b5d 202f 3d20 7365 6c66 2e64 6570  d[k] /= self.dep
+00045be0: 7468 0d0a 0d0a 2020 2020 2020 2020 7265  th....        re
+00045bf0: 7475 726e 2064 0d0a 0d0a 2020 2020 6465  turn d....    de
+00045c00: 6620 6578 7472 6163 7428 7365 6c66 2c20  f extract(self, 
+00045c10: 7a2c 2076 623d 3129 3a0d 0a0d 0a20 2020  z, vb=1):....   
+00045c20: 2020 2020 2022 2222 6578 7472 6163 7420       """extract 
+00045c30: 7468 6520 756e 6974 7320 616e 6420 6661  the units and fa
+00045c40: 6369 6573 2069 6e66 6f72 6d61 7469 6f6e  cies information
+00045c50: 2061 7420 7370 6563 6966 6965 6420 616c   at specified al
+00045c60: 7469 7475 6465 207a 2222 220d 0a0d 0a20  titude z""".... 
+00045c70: 2020 2020 2020 206c 733d 4661 6c73 650d         ls=False.
+00045c80: 0a20 2020 2020 2020 206c 663d 4661 6c73  .        lf=Fals
+00045c90: 650d 0a20 2020 2020 2020 2075 6e69 743d  e..        unit=
+00045ca0: 4e6f 6e65 0d0a 2020 2020 2020 2020 6661  None..        fa
+00045cb0: 6369 6573 3d4e 6f6e 650d 0a0d 0a20 2020  cies=None....   
+00045cc0: 2020 2020 2069 6620 7a20 3e20 7365 6c66       if z > self
+00045cd0: 2e7a 206f 7220 7a20 3c20 7365 6c66 2e7a  .z or z < self.z
+00045ce0: 202d 2073 656c 662e 6465 7074 683a 0d0a   - self.depth:..
+00045cf0: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00045d00: 623a 0d0a 2020 2020 2020 2020 2020 2020  b:..            
+00045d10: 2020 2020 7072 696e 7428 2262 6f72 6568      print("boreh
+00045d20: 6f6c 6520 6861 7665 206e 6f20 696e 666f  ole have no info
+00045d30: 726d 6174 696f 6e20 6174 2074 6869 7320  rmation at this 
+00045d40: 616c 7469 7475 6465 2229 0d0a 2020 2020  altitude")..    
+00045d50: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00045d60: 6f6e 650d 0a0d 0a20 2020 2020 2020 2069  one....        i
+00045d70: 6620 7365 6c66 2e6c 6f67 5f73 7472 6174  f self.log_strat
+00045d80: 6920 6973 206e 6f74 204e 6f6e 653a 0d0a  i is not None:..
+00045d90: 2020 2020 2020 2020 2020 2020 6c73 3d54              ls=T
+00045da0: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
+00045db0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00045dc0: 6c65 6e28 7365 6c66 2e6c 6f67 5f73 7472  len(self.log_str
+00045dd0: 6174 6929 293a 0d0a 2020 2020 2020 2020  ati)):..        
+00045de0: 2020 2020 2020 2020 6966 2069 203c 206c          if i < l
+00045df0: 656e 2873 656c 662e 6c6f 675f 7374 7261  en(self.log_stra
+00045e00: 7469 2920 2d20 313a 0d0a 2020 2020 2020  ti) - 1:..      
+00045e10: 2020 2020 2020 2020 2020 2020 2020 7331                s1
+00045e20: 203d 2073 656c 662e 6c6f 675f 7374 7261   = self.log_stra
+00045e30: 7469 5b69 5d0d 0a20 2020 2020 2020 2020  ti[i]..         
+00045e40: 2020 2020 2020 2020 2020 2073 3220 3d20             s2 = 
+00045e50: 7365 6c66 2e6c 6f67 5f73 7472 6174 695b  self.log_strati[
+00045e60: 692b 315d 0d0a 2020 2020 2020 2020 2020  i+1]..          
+00045e70: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
 00045e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e90: 2020 6272 6561 6b0d 0a20 2020 2020 2020    break..       
-00045ea0: 2020 2020 200d 0a0d 0a20 2020 2020 2020       ....       
-00045eb0: 2069 6620 6c73 2061 6e64 206c 663a 0d0a   if ls and lf:..
-00045ec0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00045ed0: 726e 2028 756e 6974 2c20 6661 6369 6573  rn (unit, facies
-00045ee0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-00045ef0: 6c73 3a0d 0a20 2020 2020 2020 2020 2020  ls:..           
-00045f00: 2072 6574 7572 6e20 756e 6974 0d0a 2020   return unit..  
-00045f10: 2020 2020 2020 656c 6966 206c 663a 0d0a        elif lf:..
-00045f20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00045f30: 726e 2066 6163 6965 730d 0a0d 0a20 2020  rn facies....   
-00045f40: 2064 6566 2063 7265 6174 655f 7468 6963   def create_thic
-00045f50: 6b6e 6573 735f 6c6f 6728 7365 6c66 2c20  kness_log(self, 
-00045f60: 7069 6c65 5f72 6566 293a 0d0a 2020 2020  pile_ref):..    
-00045f70: 2020 2020 0d0a 2020 2020 2020 2020 2222      ..        ""
-00045f80: 220d 0a20 2020 2020 2020 2043 7265 6174  "..        Creat
-00045f90: 6520 7468 6520 7468 6963 6b6e 6573 7320  e the thickness 
-00045fa0: 6c6f 6720 6261 7365 6420 6f6e 2074 6865  log based on the
-00045fb0: 2070 696c 6520 7265 6665 7265 6e63 6520   pile reference 
-00045fc0: 616e 6420 7468 6520 7261 7720 6c6f 670d  and the raw log.
-00045fd0: 0a20 2020 2020 2020 2022 2222 0d0a 0d0a  .        """....
-00045fe0: 2020 2020 2020 2020 6c6f 6720 3d20 7365          log = se
-00045ff0: 6c66 2e6c 6f67 5f72 6177 0d0a 2020 2020  lf.log_raw..    
-00046000: 2020 2020 6c6f 675f 7468 6b20 3d20 6c69      log_thk = li
-00046010: 7374 286e 702e 7a65 726f 7328 6c65 6e28  st(np.zeros(len(
-00046020: 7069 6c65 5f72 6566 2929 290d 0a20 2020  pile_ref)))..   
-00046030: 2020 2020 2070 6f73 203d 2030 0d0a 2020       pos = 0..  
-00046040: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00046050: 616e 6765 286c 656e 2870 696c 655f 7265  ange(len(pile_re
-00046060: 6629 293a 0d0a 2020 2020 2020 2020 2020  f)):..          
-00046070: 2020 0d0a 2020 2020 2020 2020 2020 2020    ..            
-00046080: 756e 6974 203d 206c 6f67 5b70 6f73 5d5b  unit = log[pos][
-00046090: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
-000460a0: 6966 2069 7369 6e73 7461 6e63 6528 756e  if isinstance(un
-000460b0: 6974 2c20 4172 6368 5079 2e62 6173 652e  it, ArchPy.base.
-000460c0: 556e 6974 293a 0d0a 2020 2020 2020 2020  Unit):..        
-000460d0: 2020 2020 2020 2020 755f 6e61 6d65 203d          u_name =
-000460e0: 2075 6e69 742e 6e61 6d65 0d0a 2020 2020   unit.name..    
-000460f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00046100: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00046110: 5f6e 616d 6520 3d20 756e 6974 0d0a 2020  _name = unit..  
-00046120: 2020 2020 2020 2020 2020 6966 2070 696c            if pil
-00046130: 655f 7265 665b 695d 203d 3d20 755f 6e61  e_ref[i] == u_na
-00046140: 6d65 3a0d 0a0d 0a20 2020 2020 2020 2020  me:....         
-00046150: 2020 2020 2020 2069 6620 706f 7320 3d3d         if pos ==
-00046160: 206c 656e 286c 6f67 2920 2d20 313a 0d0a   len(log) - 1:..
-00046170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046180: 2020 2020 6c6f 675f 7468 6b5b 695d 203d      log_thk[i] =
-00046190: 206c 6f67 5b70 6f73 5d5b 315d 202d 2028   log[pos][1] - (
-000461a0: 7365 6c66 2e7a 202d 2073 656c 662e 6465  self.z - self.de
-000461b0: 7074 6829 0d0a 2020 2020 2020 2020 2020  pth)..          
-000461c0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000461d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000461e0: 206c 6f67 5f74 686b 5b69 5d20 3d20 6c6f   log_thk[i] = lo
-000461f0: 675b 706f 735d 5b31 5d20 2d20 6c6f 675b  g[pos][1] - log[
-00046200: 706f 7320 2b20 315d 5b31 5d0d 0a20 2020  pos + 1][1]..   
-00046210: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
-00046220: 202b 3d20 310d 0a20 2020 2020 2020 2020   += 1..         
-00046230: 2020 2020 2020 2069 6620 706f 7320 3d3d         if pos ==
-00046240: 206c 656e 286c 6f67 293a 0d0a 2020 2020   len(log):..    
-00046250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046260: 6272 6561 6b0d 0a20 2020 2020 2020 2020  break..         
-00046270: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00046280: 2020 2020 2020 2020 2020 6c6f 675f 7468            log_th
-00046290: 6b5b 695d 203d 2030 0d0a 0d0a 2020 2020  k[i] = 0....    
-000462a0: 2020 2020 7365 6c66 2e6c 6f67 5f74 686b      self.log_thk
-000462b0: 203d 206c 6f67 5f74 686b 0d0a 0d0a 2020   = log_thk....  
-000462c0: 2020 6465 6620 7365 745f 7468 6963 6b6e    def set_thickn
-000462d0: 6573 735f 6c6f 6728 7365 6c66 2c20 6c6f  ess_log(self, lo
-000462e0: 675f 7468 6b29 3a0d 0a0d 0a20 2020 2020  g_thk):....     
-000462f0: 2020 2073 656c 662e 6c6f 675f 7468 6b20     self.log_thk 
-00046300: 3d20 6c6f 675f 7468 6b0d 0a0d 0a63 6c61  = log_thk....cla
-00046310: 7373 2047 656f 6c28 293a 0d0a 0d0a 2020  ss Geol():....  
-00046320: 2020 2222 220d 0a20 2020 2041 7263 6850    """..    ArchP
-00046330: 7920 6f75 7470 7574 2063 6c61 7373 2077  y output class w
-00046340: 6869 6368 2063 6f6e 7461 696e 2074 6865  hich contain the
-00046350: 2072 6573 756c 7473 2066 6f72 2074 6865   results for the
-00046360: 2067 656f 6c6f 6769 6361 6c20 7369 6d75   geological simu
-00046370: 6c61 7469 6f6e 730d 0a20 2020 2022 2222  lations..    """
-00046380: 0d0a 0d0a 2020 2020 6465 6620 5f5f 696e  ....    def __in
-00046390: 6974 5f5f 2873 656c 6629 3a0d 0a0d 0a20  it__(self):.... 
-000463a0: 2020 2020 2020 2073 656c 662e 7375 7266         self.surf
-000463b0: 6163 6573 3d4e 6f6e 650d 0a20 2020 2020  aces=None..     
-000463c0: 2020 2073 656c 662e 7375 7266 6163 6573     self.surfaces
-000463d0: 5f62 6f74 3d4e 6f6e 650d 0a20 2020 2020  _bot=None..     
-000463e0: 2020 2073 656c 662e 6f72 675f 7375 7266     self.org_surf
-000463f0: 6163 6573 3d4e 6f6e 650d 0a20 2020 2020  aces=None..     
-00046400: 2020 2073 656c 662e 7375 7266 6163 6573     self.surfaces
-00046410: 5f62 795f 7069 6c65 733d 7b7d 0d0a 2020  _by_piles={}..  
-00046420: 2020 2020 2020 7365 6c66 2e73 7572 6661        self.surfa
-00046430: 6365 735f 626f 745f 6279 5f70 696c 6573  ces_bot_by_piles
-00046440: 3d7b 7d0d 0a20 2020 2020 2020 2073 656c  ={}..        sel
-00046450: 662e 6f72 675f 7375 7266 6163 6573 5f62  f.org_surfaces_b
-00046460: 795f 7069 6c65 733d 7b7d 0d0a            y_piles={}..
+00045e90: 2073 3120 3d20 7365 6c66 2e6c 6f67 5f73   s1 = self.log_s
+00045ea0: 7472 6174 695b 695d 0d0a 2020 2020 2020  trati[i]..      
+00045eb0: 2020 2020 2020 2020 2020 2020 2020 7332                s2
+00045ec0: 203d 2028 4e6f 6e65 2c20 7365 6c66 2e7a   = (None, self.z
+00045ed0: 202d 2073 656c 662e 6465 7074 6829 0d0a   - self.depth)..
+00045ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045ef0: 6966 2073 315b 315d 203e 3d20 7a20 616e  if s1[1] >= z an
+00045f00: 6420 7332 5b31 5d20 3c20 7a3a 0d0a 2020  d s2[1] < z:..  
+00045f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f20: 2020 756e 6974 3d73 315b 305d 0d0a 2020    unit=s1[0]..  
+00045f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045f40: 2020 6272 6561 6b0d 0a0d 0a0d 0a20 2020    break......   
+00045f50: 2020 2020 2069 6620 7365 6c66 2e6c 6f67       if self.log
+00045f60: 5f66 6163 6965 7320 6973 206e 6f74 204e  _facies is not N
+00045f70: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00045f80: 2020 6c66 3d54 7275 650d 0a20 2020 2020    lf=True..     
+00045f90: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00045fa0: 7261 6e67 6528 6c65 6e28 7365 6c66 2e6c  range(len(self.l
+00045fb0: 6f67 5f66 6163 6965 7329 293a 0d0a 2020  og_facies)):..  
+00045fc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00045fd0: 2069 203c 206c 656e 2873 656c 662e 6c6f   i < len(self.lo
+00045fe0: 675f 6661 6369 6573 2920 2d20 313a 0d0a  g_facies) - 1:..
+00045ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046000: 2020 2020 6631 203d 2073 656c 662e 6c6f      f1 = self.lo
+00046010: 675f 6661 6369 6573 5b69 5d0d 0a20 2020  g_facies[i]..   
+00046020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046030: 2066 3220 3d20 7365 6c66 2e6c 6f67 5f66   f2 = self.log_f
+00046040: 6163 6965 735b 692b 315d 0d0a 2020 2020  acies[i+1]..    
+00046050: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00046060: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00046070: 2020 2020 2020 2066 3120 3d20 7365 6c66         f1 = self
+00046080: 2e6c 6f67 5f66 6163 6965 735b 695d 0d0a  .log_facies[i]..
+00046090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000460a0: 2020 2020 6632 203d 2028 4e6f 6e65 2c20      f2 = (None, 
+000460b0: 7365 6c66 2e7a 202d 2073 656c 662e 6465  self.z - self.de
+000460c0: 7074 6829 0d0a 2020 2020 2020 2020 2020  pth)..          
+000460d0: 2020 2020 2020 6966 2066 315b 315d 203e        if f1[1] >
+000460e0: 3d20 7a20 616e 6420 6632 5b31 5d20 3c20  = z and f2[1] < 
+000460f0: 7a3a 0d0a 2020 2020 2020 2020 2020 2020  z:..            
+00046100: 2020 2020 2020 2020 6661 6369 6573 3d66          facies=f
+00046110: 315b 305d 0d0a 2020 2020 2020 2020 2020  1[0]..          
+00046120: 2020 2020 2020 2020 2020 6272 6561 6b0d            break.
+00046130: 0a20 2020 2020 2020 2020 2020 200d 0a0d  .            ...
+00046140: 0a20 2020 2020 2020 2069 6620 6c73 2061  .        if ls a
+00046150: 6e64 206c 663a 0d0a 2020 2020 2020 2020  nd lf:..        
+00046160: 2020 2020 7265 7475 726e 2028 756e 6974      return (unit
+00046170: 2c20 6661 6369 6573 290d 0a20 2020 2020  , facies)..     
+00046180: 2020 2065 6c69 6620 6c73 3a0d 0a20 2020     elif ls:..   
+00046190: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000461a0: 756e 6974 0d0a 2020 2020 2020 2020 656c  unit..        el
+000461b0: 6966 206c 663a 0d0a 2020 2020 2020 2020  if lf:..        
+000461c0: 2020 2020 7265 7475 726e 2066 6163 6965      return facie
+000461d0: 730d 0a0d 0a20 2020 2064 6566 2063 7265  s....    def cre
+000461e0: 6174 655f 7468 6963 6b6e 6573 735f 6c6f  ate_thickness_lo
+000461f0: 6728 7365 6c66 2c20 7069 6c65 5f72 6566  g(self, pile_ref
+00046200: 293a 0d0a 2020 2020 2020 2020 0d0a 2020  ):..        ..  
+00046210: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
+00046220: 2020 2043 7265 6174 6520 7468 6520 7468     Create the th
+00046230: 6963 6b6e 6573 7320 6c6f 6720 6261 7365  ickness log base
+00046240: 6420 6f6e 2074 6865 2070 696c 6520 7265  d on the pile re
+00046250: 6665 7265 6e63 6520 616e 6420 7468 6520  ference and the 
+00046260: 7261 7720 6c6f 670d 0a20 2020 2020 2020  raw log..       
+00046270: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+00046280: 6c6f 6720 3d20 7365 6c66 2e6c 6f67 5f72  log = self.log_r
+00046290: 6177 0d0a 2020 2020 2020 2020 6c6f 675f  aw..        log_
+000462a0: 7468 6b20 3d20 6c69 7374 286e 702e 7a65  thk = list(np.ze
+000462b0: 726f 7328 6c65 6e28 7069 6c65 5f72 6566  ros(len(pile_ref
+000462c0: 2929 290d 0a20 2020 2020 2020 2070 6f73  )))..        pos
+000462d0: 203d 2030 0d0a 2020 2020 2020 2020 666f   = 0..        fo
+000462e0: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+000462f0: 2870 696c 655f 7265 6629 293a 0d0a 2020  (pile_ref)):..  
+00046300: 2020 2020 2020 2020 2020 0d0a 2020 2020            ..    
+00046310: 2020 2020 2020 2020 756e 6974 203d 206c          unit = l
+00046320: 6f67 5b70 6f73 5d5b 305d 0d0a 2020 2020  og[pos][0]..    
+00046330: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00046340: 7461 6e63 6528 756e 6974 2c20 4172 6368  tance(unit, Arch
+00046350: 5079 2e62 6173 652e 556e 6974 293a 0d0a  Py.base.Unit):..
+00046360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046370: 755f 6e61 6d65 203d 2075 6e69 742e 6e61  u_name = unit.na
+00046380: 6d65 0d0a 2020 2020 2020 2020 2020 2020  me..            
+00046390: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000463a0: 2020 2020 2020 2075 5f6e 616d 6520 3d20         u_name = 
+000463b0: 756e 6974 0d0a 2020 2020 2020 2020 2020  unit..          
+000463c0: 2020 6966 2070 696c 655f 7265 665b 695d    if pile_ref[i]
+000463d0: 203d 3d20 755f 6e61 6d65 3a0d 0a0d 0a20   == u_name:.... 
+000463e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000463f0: 6620 706f 7320 3d3d 206c 656e 286c 6f67  f pos == len(log
+00046400: 2920 2d20 313a 0d0a 2020 2020 2020 2020  ) - 1:..        
+00046410: 2020 2020 2020 2020 2020 2020 6c6f 675f              log_
+00046420: 7468 6b5b 695d 203d 206c 6f67 5b70 6f73  thk[i] = log[pos
+00046430: 5d5b 315d 202d 2028 7365 6c66 2e7a 202d  ][1] - (self.z -
+00046440: 2073 656c 662e 6465 7074 6829 0d0a 2020   self.depth)..  
+00046450: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00046460: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00046470: 2020 2020 2020 2020 206c 6f67 5f74 686b           log_thk
+00046480: 5b69 5d20 3d20 6c6f 675b 706f 735d 5b31  [i] = log[pos][1
+00046490: 5d20 2d20 6c6f 675b 706f 7320 2b20 315d  ] - log[pos + 1]
+000464a0: 5b31 5d0d 0a20 2020 2020 2020 2020 2020  [1]..           
+000464b0: 2020 2020 2070 6f73 202b 3d20 310d 0a20       pos += 1.. 
+000464c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000464d0: 6620 706f 7320 3d3d 206c 656e 286c 6f67  f pos == len(log
+000464e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+000464f0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
+00046500: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00046510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00046520: 2020 6c6f 675f 7468 6b5b 695d 203d 2030    log_thk[i] = 0
+00046530: 0d0a 0d0a 2020 2020 2020 2020 7365 6c66  ....        self
+00046540: 2e6c 6f67 5f74 686b 203d 206c 6f67 5f74  .log_thk = log_t
+00046550: 686b 0d0a 0d0a 2020 2020 6465 6620 7365  hk....    def se
+00046560: 745f 7468 6963 6b6e 6573 735f 6c6f 6728  t_thickness_log(
+00046570: 7365 6c66 2c20 6c6f 675f 7468 6b29 3a0d  self, log_thk):.
+00046580: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00046590: 6c6f 675f 7468 6b20 3d20 6c6f 675f 7468  log_thk = log_th
+000465a0: 6b0d 0a0d 0a63 6c61 7373 2047 656f 6c28  k....class Geol(
+000465b0: 293a 0d0a 0d0a 2020 2020 2222 220d 0a20  ):....    """.. 
+000465c0: 2020 2041 7263 6850 7920 6f75 7470 7574     ArchPy output
+000465d0: 2063 6c61 7373 2077 6869 6368 2063 6f6e   class which con
+000465e0: 7461 696e 2074 6865 2072 6573 756c 7473  tain the results
+000465f0: 2066 6f72 2074 6865 2067 656f 6c6f 6769   for the geologi
+00046600: 6361 6c20 7369 6d75 6c61 7469 6f6e 730d  cal simulations.
+00046610: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
+00046620: 6465 6620 5f5f 696e 6974 5f5f 2873 656c  def __init__(sel
+00046630: 6629 3a0d 0a0d 0a20 2020 2020 2020 2073  f):....        s
+00046640: 656c 662e 7375 7266 6163 6573 3d4e 6f6e  elf.surfaces=Non
+00046650: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+00046660: 7375 7266 6163 6573 5f62 6f74 3d4e 6f6e  surfaces_bot=Non
+00046670: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+00046680: 6f72 675f 7375 7266 6163 6573 3d4e 6f6e  org_surfaces=Non
+00046690: 650d 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+000466a0: 7375 7266 6163 6573 5f62 795f 7069 6c65  surfaces_by_pile
+000466b0: 733d 7b7d 0d0a 2020 2020 2020 2020 7365  s={}..        se
+000466c0: 6c66 2e73 7572 6661 6365 735f 626f 745f  lf.surfaces_bot_
+000466d0: 6279 5f70 696c 6573 3d7b 7d0d 0a20 2020  by_piles={}..   
+000466e0: 2020 2020 2073 656c 662e 6f72 675f 7375       self.org_su
+000466f0: 7266 6163 6573 5f62 795f 7069 6c65 733d  rfaces_by_piles=
+00046700: 7b7d 0d0a                                {}..
```

### Comparing `Geoarchpy-1.0.4/ArchPy/data_transfo.py` & `Geoarchpy-1.0.5/ArchPy/data_transfo.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/ineq.py` & `Geoarchpy-1.0.5/ArchPy/ineq.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/infer.py` & `Geoarchpy-1.0.5/ArchPy/infer.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/inputs.py` & `Geoarchpy-1.0.5/ArchPy/inputs.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/parallel.py` & `Geoarchpy-1.0.5/ArchPy/parallel.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/tpgs.py` & `Geoarchpy-1.0.5/ArchPy/tpgs.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/ArchPy/x_valid.py` & `Geoarchpy-1.0.5/ArchPy/x_valid.py`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/Geoarchpy.egg-info/PKG-INFO` & `Geoarchpy-1.0.5/Geoarchpy.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Geoarchpy
-Version: 1.0.4
+Version: 1.0.5
 Summary: Simpler geological and property models
 Home-page: https://github.com/randlab/ArchPy
 Author: Ludovic Schorpp
 Author-email: ludovic.schorpp@unine.ch
 License:                     GNU GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
         
@@ -687,19 +687,19 @@
 Requires-Dist: pyvista==0.40.0
 Requires-Dist: trame
 Requires-Dist: scipy
 Requires-Dist: scikit-learn
 Requires-Dist: scikit-image
 Requires-Dist: pyyaml
 Requires-Dist: pandas
-Requires-Dist: shapely<2.0
+Requires-Dist: shapely
 Requires-Dist: rasterio
 Requires-Dist: geopandas
 Requires-Dist: ipywidgets
-Requires-Dist: tornado==6.1
+Requires-Dist: tornado
 Requires-Dist: notebook
 
 # ArchPy
 [![Documentation Status](https://readthedocs.org/projects/archpy/badge/?version=latest)](https://archpy.readthedocs.io/en/latest/?badge=latest)
 ![logo](./sphinx_build/source/figures/logo_web.png)
 
 A hierarchical stochastic geological modeling tool in Python
@@ -723,31 +723,31 @@
 
 Alternatively, it is possible to add ArchPy path directly in the python script with sys :
 ```
 sys.path.append("path where ArchPy is") 
 ```
 and then import ArchPy.
 
-:warning: **Issues with widgets**: For some reasons, widgets does not work properly with recent version of jupyter-server due to recent versions of tornardo. Ensure to have tornado==6.1 if you plan to use widgets and interactive functions with the matplotlib notebook backend. 
+:warning: **Issues with widgets**: For some reasons, widgets does not work properly, probably due to the recent version of jupyter-server. For now these issues are not solved and widgets are not working, except partially with inline backend. 
 
 ## Requirements
 
 Works and tested with 3.8 <= python <= 3.11
 
 The following python packages are absolutely necessary:
    - [Geone](https://github.com/randlab/geone)
    - matplotlib
    - numpy (tested with 1.23.5)
    - SciPy
    - sklearn
    - pandas
-   - shapely < 2.0 (will be adapted to shapely 2.0 soon)
+   - shapely
    - scikit-learn
 
-These are not required but highly recommanded.
+These are not required but highly recommanded. They are installed with ArchPy by default.
    - PyVista
    - pyyaml (for export uses)
    - Rasterio (to use rasters)
    - Geopandas (to use shapefile)
    - ipywidgets
    
  ## Examples
@@ -755,16 +755,16 @@
  - 01_basic : a folder where simple and basics ArchPy functionnalities are described 
  - 02_3D_ArchPy : a complete 3D ArchPy model example
  - 03_Article_example : a synthetical example shown in ArchPy article
  - 04_hierarchies : an exemple with many hierarchical units to test ArchPy capabilities
  - 05_mps_surfaces : an example how to use MPS to simulate the units surfaces
  - 06_cross_validation : a notebook that present how to perform a cross-validation directly with ArchPy
  - 07_geological_map : this notebook presents how to integrate and use a geological in an ArchPy model
- - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to unkown issues with ipywidgets.
- - 09_interface : little exemple of an interface to call an preexisting archpy model.
+ - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to incompatibilities issues with ipywidgets.
+ - 09_interface : little exemple of an interface to call an preexisting archpy model as well as drawing a new model extension.
  
  ## Paper
  A paper was published on the ArchPy concept and its different capabilities.
  The paper was written with the version 0.1 of ArchPy.
  It is available with the following [link](https://www.frontiersin.org/articles/10.3389/feart.2022.884075/).
 
  ## Contact
```

### Comparing `Geoarchpy-1.0.4/LICENSE` & `Geoarchpy-1.0.5/LICENSE`

 * *Files identical despite different names*

### Comparing `Geoarchpy-1.0.4/PKG-INFO` & `Geoarchpy-1.0.5/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: Geoarchpy
-Version: 1.0.4
+Version: 1.0.5
 Summary: Simpler geological and property models
 Home-page: https://github.com/randlab/ArchPy
 Author: Ludovic Schorpp
 Author-email: ludovic.schorpp@unine.ch
 License:                     GNU GENERAL PUBLIC LICENSE
                                Version 3, 29 June 2007
         
@@ -687,19 +687,19 @@
 Requires-Dist: pyvista==0.40.0
 Requires-Dist: trame
 Requires-Dist: scipy
 Requires-Dist: scikit-learn
 Requires-Dist: scikit-image
 Requires-Dist: pyyaml
 Requires-Dist: pandas
-Requires-Dist: shapely<2.0
+Requires-Dist: shapely
 Requires-Dist: rasterio
 Requires-Dist: geopandas
 Requires-Dist: ipywidgets
-Requires-Dist: tornado==6.1
+Requires-Dist: tornado
 Requires-Dist: notebook
 
 # ArchPy
 [![Documentation Status](https://readthedocs.org/projects/archpy/badge/?version=latest)](https://archpy.readthedocs.io/en/latest/?badge=latest)
 ![logo](./sphinx_build/source/figures/logo_web.png)
 
 A hierarchical stochastic geological modeling tool in Python
@@ -723,31 +723,31 @@
 
 Alternatively, it is possible to add ArchPy path directly in the python script with sys :
 ```
 sys.path.append("path where ArchPy is") 
 ```
 and then import ArchPy.
 
-:warning: **Issues with widgets**: For some reasons, widgets does not work properly with recent version of jupyter-server due to recent versions of tornardo. Ensure to have tornado==6.1 if you plan to use widgets and interactive functions with the matplotlib notebook backend. 
+:warning: **Issues with widgets**: For some reasons, widgets does not work properly, probably due to the recent version of jupyter-server. For now these issues are not solved and widgets are not working, except partially with inline backend. 
 
 ## Requirements
 
 Works and tested with 3.8 <= python <= 3.11
 
 The following python packages are absolutely necessary:
    - [Geone](https://github.com/randlab/geone)
    - matplotlib
    - numpy (tested with 1.23.5)
    - SciPy
    - sklearn
    - pandas
-   - shapely < 2.0 (will be adapted to shapely 2.0 soon)
+   - shapely
    - scikit-learn
 
-These are not required but highly recommanded.
+These are not required but highly recommanded. They are installed with ArchPy by default.
    - PyVista
    - pyyaml (for export uses)
    - Rasterio (to use rasters)
    - Geopandas (to use shapefile)
    - ipywidgets
    
  ## Examples
@@ -755,16 +755,16 @@
  - 01_basic : a folder where simple and basics ArchPy functionnalities are described 
  - 02_3D_ArchPy : a complete 3D ArchPy model example
  - 03_Article_example : a synthetical example shown in ArchPy article
  - 04_hierarchies : an exemple with many hierarchical units to test ArchPy capabilities
  - 05_mps_surfaces : an example how to use MPS to simulate the units surfaces
  - 06_cross_validation : a notebook that present how to perform a cross-validation directly with ArchPy
  - 07_geological_map : this notebook presents how to integrate and use a geological in an ArchPy model
- - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to unkown issues with ipywidgets.
- - 09_interface : little exemple of an interface to call an preexisting archpy model.
+ - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to incompatibilities issues with ipywidgets.
+ - 09_interface : little exemple of an interface to call an preexisting archpy model as well as drawing a new model extension.
  
  ## Paper
  A paper was published on the ArchPy concept and its different capabilities.
  The paper was written with the version 0.1 of ArchPy.
  It is available with the following [link](https://www.frontiersin.org/articles/10.3389/feart.2022.884075/).
 
  ## Contact
```

### Comparing `Geoarchpy-1.0.4/README.md` & `Geoarchpy-1.0.5/README.md`

 * *Files 18% similar despite different names*

```diff
@@ -23,31 +23,31 @@
 
 Alternatively, it is possible to add ArchPy path directly in the python script with sys :
 ```
 sys.path.append("path where ArchPy is") 
 ```
 and then import ArchPy.
 
-:warning: **Issues with widgets**: For some reasons, widgets does not work properly with recent version of jupyter-server due to recent versions of tornardo. Ensure to have tornado==6.1 if you plan to use widgets and interactive functions with the matplotlib notebook backend. 
+:warning: **Issues with widgets**: For some reasons, widgets does not work properly, probably due to the recent version of jupyter-server. For now these issues are not solved and widgets are not working, except partially with inline backend. 
 
 ## Requirements
 
 Works and tested with 3.8 <= python <= 3.11
 
 The following python packages are absolutely necessary:
    - [Geone](https://github.com/randlab/geone)
    - matplotlib
    - numpy (tested with 1.23.5)
    - SciPy
    - sklearn
    - pandas
-   - shapely < 2.0 (will be adapted to shapely 2.0 soon)
+   - shapely
    - scikit-learn
 
-These are not required but highly recommanded.
+These are not required but highly recommanded. They are installed with ArchPy by default.
    - PyVista
    - pyyaml (for export uses)
    - Rasterio (to use rasters)
    - Geopandas (to use shapefile)
    - ipywidgets
    
  ## Examples
@@ -55,16 +55,16 @@
  - 01_basic : a folder where simple and basics ArchPy functionnalities are described 
  - 02_3D_ArchPy : a complete 3D ArchPy model example
  - 03_Article_example : a synthetical example shown in ArchPy article
  - 04_hierarchies : an exemple with many hierarchical units to test ArchPy capabilities
  - 05_mps_surfaces : an example how to use MPS to simulate the units surfaces
  - 06_cross_validation : a notebook that present how to perform a cross-validation directly with ArchPy
  - 07_geological_map : this notebook presents how to integrate and use a geological in an ArchPy model
- - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to unkown issues with ipywidgets.
- - 09_interface : little exemple of an interface to call an preexisting archpy model.
+ - 08_inference : little guide how to use archpy inference tools to estimate surface parameters (no facies parameters for now) --> Note that for now, the interface is not working due to incompatibilities issues with ipywidgets.
+ - 09_interface : little exemple of an interface to call an preexisting archpy model as well as drawing a new model extension.
  
  ## Paper
  A paper was published on the ArchPy concept and its different capabilities.
  The paper was written with the version 0.1 of ArchPy.
  It is available with the following [link](https://www.frontiersin.org/articles/10.3389/feart.2022.884075/).
 
  ## Contact
```

### Comparing `Geoarchpy-1.0.4/setup.py` & `Geoarchpy-1.0.5/setup.py`

 * *Files 7% similar despite different names*

```diff
@@ -22,18 +22,18 @@
                       'pyvista==0.40.0',
                       'trame',
                       'scipy',
                       'scikit-learn',
                       'scikit-image',
                       'pyyaml',
                       'pandas',
-                      'shapely < 2.0',
+                      'shapely',
                       'rasterio',
                       'geopandas',
                       'ipywidgets',
-                      'tornado==6.1',
+                      'tornado',
                       'notebook'],  # download geone
     packages=setuptools.find_packages(),
     include_package_data=True,
     #data_files=[("lib\\site-packages\\ArchPy\\libraries", ["ArchPy\\libraries\\cov_facies.dll"])],
     license=open('LICENSE', encoding='utf-8').read()
 )
```

